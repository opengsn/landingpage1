(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{JZqd:function(t,i,e){"use strict";var s,o=e("AIVH");function h(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function n(){var t=p(['\n\n    <div class="hotspot-fullscreen-wrapper invisible">\n        <div class="center-table">\n            <div class="center-cell">\n\n            </div>\n        </div>\n    </div>\n\n']);return n=function(){return t},t}function a(){var t=p(['\n\n    <div class="common-hotspot">\n\n\t    <div class="pin"></div>\n\n    </div>\n\n']);return a=function(){return t},t}function p(t,i){return i||(i=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(i)}}))}i.a=(h(s={},"template-common-hotspot-widget",Object(o.a)(a())),h(s,"template-common-hotspot-widget-mobile-wrapper",Object(o.a)(n())),s)},cBBe:function(t,i,e){"use strict";var s=e("xi34"),o=e("q1z7"),h=e.n(o),n=e("rFsW"),a=e("JZqd"),p=e("OTSC"),r=h.a.View.extend({TIP_GAP:15,initialize:function(t){t&&(n.a.bindAll(this),this.block=t.block,this.model=t.model,this.$container=t.$container,this.environment=t.environment,this.mag=t.mag,this.template=a.a["template-common-hotspot-widget"],this.render())},render:function(){this.setElement(Object(s.a)(this.template({data:this.model}))),"viewer"===this.environment&&(this.apply_tip_container_size({width:this.model.tip_w,height:this.model.tip_h}),this.apply_tip_position(this.model)),this.$el.appendTo(this.$container)},apply_tip_container_size:function(t){t&&0===t.height&&(t.height=120),t&&this.$(".tip").css(t)},apply_tip_bg_color:function(t){this.$(".blocks-wrapper").css("background-color",p.default.getRGBA(t["tip_background-color"],t["tip_background-color-opacity"]/100))},apply_tip_border_radius:function(t){this.$(".blocks-wrapper").add(this.$(".tip")).css("border-radius",t["tip_border-radius"]+"px")},apply_tip_box_shadow:function(t){this.$(".tip").toggleClass("box-shadow",!!t["tip_box-shadow"])},apply_tip_position:function(t){var i,e=this.$(".tip"),s=t.tip_pos,o=t.tip_w,h=t.tip_h||120,n=t.w,a=t.h,p="",r="",c=this.TIP_GAP;return"top"===s?(p=-(c+h),r=n/2-o/2):"right"===s?(p=a/2-h/2,r=n+c):"bottom"===s?(p=a+c,r=n/2-o/2):"left"===s&&(p=a/2-h/2,r=-(c+o)),i={top:p,left:r},e.css(i),i},destroy:function(){this.remove()}});i.a=r},uHXJ:function(t,i,e){"use strict";e.r(i);var s=e("xi34"),o=e("rFsW"),h=e("ROz4"),n=e("OTSC"),a=e("JZqd"),p=e("z79a"),r=e("cBBe"),c=e("QNiq"),d=e("oBKw"),l=e("SF2O"),u=e("O5Jf"),g=e("I0kf"),b=h.a.extend(p.a.prototype).extend({DO_NOT_WAIT_FOR_PRELOAD:!0,PHONE_TIP_WIDTH:280,MOUSE_LEAVE_TIMEOUT:100,EDGE_GAP:16,events:{"click .pin":"onPinClick",mouseenter:"onMouseenter",mouseleave:"onMouseleave"},render:function(){var t;if(this.makeBox("widget-hotspot"),this.rendered=!0,this.phoneTipWrapperTemplate=a.a["template-common-hotspot-widget-mobile-wrapper"],this.isPreview=!(!RM.constructorRouter||!RM.constructorRouter.preview),t={model:this,$container:this.$el,environment:"viewer",mag:this.page&&this.page.mag,block:null},this.hotspotWidget=new r.a(t),this.$pin=this.$(".pin").addClass("viewer"),this.started&&this.renderTip(),"icon"===this.pin_type){if(this.$el.addClass("icon"),!this.rasterUrl)return this.widgetIsLoaded(),this;var i=Object(s.a)("<img>");i.on("load",o.a.bind((function(){this.$(".pin").html(i),this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded),i.attr("src",this.raster3xUrl||this.raster2xUrl||this.rasterUrl||"")}else this.renderPinShape(),this.widgetIsLoaded();return this},renderPinShape:function(){var t,i=new Backbone.Model(this);i.id=this._id,t=this.generateShapeSVG("viewer",i,this.w,this.h),this.$pin.html(t)},renderTip:function(){this.isTipRendered||(this.$tip=Object(s.a)('<div class="tip viewer invisible"></div>'),this.$tip.toggleClass("box-shadow",this["tip_box-shadow"]),this.$tip.css({"border-radius":this["tip_border-radius"]}),this.$blocksWrapper=Object(s.a)('<div class="blocks-wrapper"></div>'),this.$blocksWrapper.appendTo(this.$tip),this.$blocksWrapper.css({"background-color":n.default.getRGBA(this["tip_background-color"],this["tip_background-color-opacity"]/100),"border-radius":this["tip_border-radius"]}),this.$(".common-hotspot").append(this.$tip),this.pictureData=o.a.findWhere(this.wids||[],{type:"picture"}),this.textData=o.a.findWhere(this.wids||[],{type:"text"}),this.hasPictureWidget=!(!this.pictureData||this.pictureData.hidden),this.hasTextWidget=!(!this.textData||this.textData.hidden),this.hasPictureWidget&&(this.pictureData.insideHotspot=!0,this.pictureWidget=new d.default(this.pictureData,this.page,this.$blocksWrapper),this.pictureWidget.isValid()?(this.pictureData.w=Math.min(this.tip_w,this.pictureData.w),this.pictureWidget.render()):(this.tip_h-=this.pictureWidget.h||0,this.textData&&(this.textData.y=0),this.pictureWidget=null,this.hasPictureWidget=!1)),this.hasTextWidget&&(this.textData.insideHotspot=!0,this.textData.hasGlobalParent=this.is_global,Object(g.a)("constructor.textv3")&&3===this.textData.version?this.textWidget=new u.default(this.textData,this.page,this.$blocksWrapper):this.textWidget=new l.default(this.textData,this.page,this.$blocksWrapper),this.textWidget.w=Math.min(this.tip_w,this.textWidget.w),this.textWidget.render()),this.hasPictureWidget||this.hasTextWidget?(this.$closeButton=Object(s.a)('<div class="hotspot-phone-close"></div>'),this.$tip.append(this.$closeButton),this.isTipRendered=!0):this.$tip.remove())},updatePage:function(t){h.a.prototype.updatePage.apply(this,arguments),this.textWidget&&this.textWidget.updatePage(t)},start:function(){return this.started=!0,this.rendered&&!this.destroyed&&this.renderTip(),this},stop:function(){return this.started=!1,this.isTipVisible&&this.hideTip(),this},applyTipPosition:function(){var t,i,e,s,h,n,a,p=this.calcDistsToPageVisibleBounds(),r=this.w,c=this.h,d=this.$tip.width(),l=this.$tip.height(),u=this.hotspotWidget.TIP_GAP,g=this.tip_pos,b=o.a.pick(this,"w","h","tip_w","tip_h","tip_pos"),T=!1,f=!1;function m(t){var i,e,s,o;switch(t){case"top":i=p.top-c/2-u-l,s=p.bottom+c/2+u,o=p.left-d/2,e=p.right-d/2;break;case"right":i=p.top-l/2,s=p.bottom-l/2,o=p.left+r/2+u,e=p.right-r/2-u-d;break;case"bottom":i=p.bottom+c/2+u,s=p.bottom-c/2-u-l,o=p.left-d/2,e=p.right-d/2;break;case"left":i=p.top-l/2,s=p.bottom-l/2,o=p.left-r/2-u-d,e=p.right+r/2+u}return{top:i,left:o,bottom:s,right:e}}e=this.tip_pos,h=e,n=-1/0,a=!1,o.a.each(["top","right","bottom","left"],(function(t){if(!a){var i=m(t);s=o.a.min(i),t===e&&i[t]>0?(h=t,a=!0):s>n&&i[t]>=0&&(n=s,h=t)}})),g=h,b.tip_pos=g,i=this.hotspotWidget.apply_tip_position(b),t=m(g),o.a.each(t,function(t,e){if(t<0)switch(e){case"top":i.top-=t-this.EDGE_GAP,T=!0;break;case"bottom":T||(i.top+=t-this.EDGE_GAP);break;case"left":i.left-=t-this.EDGE_GAP,f=!0;break;case"right":f||(i.left+=t-this.EDGE_GAP)}}.bind(this)),this.$tip.css(i)},adjustPictureSize:function(){var t,i=this.tip_w/this.PHONE_TIP_WIDTH;this.pictureWidget&&(t=this.isPhone()?{width:this.PHONE_TIP_WIDTH,height:this.pictureData.h/i}:{width:this.pictureData.w,height:this.pictureData.h},this.pictureWidget.$el.css(t))},onPinClick:function(){this.isHoverable()||(this.isTipVisible?this.hideTip():this.isTipRendered&&this.showTip(),RM.analytics&&this.isTipVisible&&RM.analytics.sendEvent("Hotspot Click"))},onMouseenter:function(){this.isHoverable()&&this.isTipRendered&&(clearTimeout(this.mouseLeaveTimeout),this.isTipVisible||this.showTip(),RM.analytics&&RM.analytics.sendEvent("Hotspot Hover"))},onMouseleave:function(){this.isHoverable()&&(clearTimeout(this.mouseLeaveTimeout),this.mouseLeaveTimeout=setTimeout(function(){this.hideTip()}.bind(this),this.MOUSE_LEAVE_TIMEOUT))},showTip:function(){this.isTipRendered&&(this.adjustPictureSize(),this.isPhone()?(this.$phoneTipWrapper=this.$phoneTipWrapper||Object(s.a)(this.phoneTipWrapperTemplate()),this.$phoneTipWrapper.toggleClass("preview",this.isPreview),this.$phoneTipWrapper.detach().appendTo(this.isPreview?".mag-pages-container":"body"),this.$phoneTipWrapper.on("touchstart",this.onTipTouchStart),this.$phoneTipWrapper.on("touchmove",this.onTipTouchMove),this.$tipParent=this.$tip.parent(),this.$tip.detach().appendTo(this.$phoneTipWrapper.find(".center-cell")),o.a.defer(function(){this.$phoneTipWrapper.removeClass("invisible")}.bind(this)),this.$phoneTipWrapper.on("click",function(t){Object(s.a)(t.target).closest(".tip").is(this.$tip)||(this.hideTip(),this.$phoneTipWrapper.off())}.bind(this)),this.$closeButton.on("click",this.onCloseButtonClick)):(this.hotspotWidget.apply_tip_container_size({width:this.tip_w,height:this.tip_h}),this.applyTipPosition(),this.$tip.removeClass("invisible"),this.BringToTopZ(),this.page.mag.router.$mags_container.on("mousedown touchstart",this.onGlobalMouseDown),this.isHoverable()||Object(s.a)("body").on("keydown",this.onBodyKeyDown)),this.listenTo(this.page.mag,"change:viewport",this.onMagViewportBeforeChange),this.isTipVisible=!0)},hideTip:function(){this.isTipVisible&&(this.isTipVisible=!1,clearTimeout(this.mouseLeaveTimeout),this.isPhone()?(this.$phoneTipWrapper.addClass("invisible"),this.$phoneTipWrapper.off("touchstart",this.onTipTouchStart),this.$phoneTipWrapper.off("touchmove",this.onTipTouchMove),o.a.delay(function(){this.$tip.detach().appendTo(this.$tipParent),this.$phoneTipWrapper&&this.$phoneTipWrapper.detach()}.bind(this),200)):(this.$tip.addClass("invisible"),this.BackToNormalZ(),Object(s.a)("body").off("keydown",this.onBodyKeyDown)),this.stopListening(this.page.mag,"change:viewport"))},onTipTouchStart:function(t){this.tipScrollY=t.originalEvent.touches.item(0).clientY},onTipTouchMove:function(t){t.stopPropagation();var i=Object(s.a)(t.currentTarget),e=this.tipScrollY-t.originalEvent.touches.item(0).clientY;(e<0&&i.scrollTop()<=0||e>0&&i.scrollTop()+i.height()>=i[0].scrollHeight)&&t.preventDefault(),this.tipScrollY=t.originalEvent.touches.item(0).clientY},onCloseButtonClick:function(){this.$closeButton.off("click",this.onCloseButtonClick),this.hideTip()},onMagViewportBeforeChange:function(){this.hideTip()},onGlobalMouseDown:function(t){var i=Object(s.a)(t.target),e=i.closest(".pin"),o=i.closest(".tip");e.is(this.$pin)||o.is(this.$tip)||(this.page.mag.router.$mags_container.off("mousedown touchstart",this.onGlobalMouseDown),this.hideTip())},isPhone:function(){return c.a.isPhone||this.isPreview&&"phone_portrait"===this.page.mag.viewport},isHoverable:function(){return"hover"===this.tip_show_on&&c.a.isDesktop&&!this.isPhone()&&"tablet_portrait"!==this.page.mag.viewport},onBodyKeyDown:function(t){t.keyCode===s.a.keycodes.esc&&this.hideTip()},destroy:function(){return this.hotspotWidget&&this.hotspotWidget.destroy(),this.hotspotWidget=null,h.a.prototype.destroy.apply(this,arguments)}});i.default=b}}]);
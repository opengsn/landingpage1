/*! For license information please see 8.cd34d8228a805a2092d2.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"+/R+":function(t,e,i){"use strict";var n=i("2EI4");i.n(n).a},"+EJ4":function(t,e,i){},"+Xeu":function(t,e,i){"use strict";var n=i("cx/9");i.n(n).a},"+teE":function(module,exports){module.exports={"template-constructor-control-text_typography":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Typography" data-alt-pos="left" data-alt-offset="9"></div>\n\t<div class="panel">\n\n\t\t<div class="font-size-wrapper">\n\t\t\t<div class="multiple-layer">&bull;&bull;&bull;</div>\n\t\t\t<input class="font-size" title="Font Size" spellcheck="false" data-class="font-size" type="text" value=""/>\n\t\t</div>\n\n\t\t<div class="line-height-wrapper">\n\t\t\t<div class="multiple-layer">&bull;&bull;&bull;</div>\n\t\t\t<input class="line-height" title="Line Height" spellcheck="false" data-class="line-height" type="text" value=""/>\n\t\t</div>\n\n\t\t<div class="gauge">\n\t\t\t<div class="font-size-gauge"></div>\n\t\t\t<div class="line-height-gauge"></div>\n\t\t</div>\n\n\t\t<div class="pictograms">\n\t\t\t<div class="linked active" title="Unbind Font Size and Line Height"></div>\n\t\t</div>\n\n\t\t<div class="letter-spacing-wrapper">\n\t\t\t<div class="block-layer"></div>\n\t\t\t<div class="multiple-layer"><span>&bull;&bull;&bull;</span></div>\n\t\t\t<input class="letter-spacing"  title="Tracking" spellcheck="false" type="text" value=""/>\n\t\t</div>\n\n\t\t<div class="font-style-popup">\n\t\t\t<div class="popup-caption"></div>\n\t\t\t<div class="arrow-icon"></div>\n\t\t</div>\n\n\t\t<div class="font-family-popup">\n\t\t\t<div class="popup-caption"></div>\n\t\t\t<div class="arrow-icon"></div>\n\t\t</div>\n\n\t\t<div class="font-style">\n\t\t\t<div class="font-style-wrapper">\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p}}},"+uCx":function(module,exports){module.exports={"template-constructor-control-text_bius":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon" data-alt="Font Style" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t\t<div class="all-caps" title="All Caps"></div>\n\t\t<div class="bold" title="Bold"></div>\n\t\t<div class="italic" title="Italic"></div>\n\t\t<div class="underline" title="Underline"></div>\n\t\t<div class="strike" title="Strike"></div>\n\t</div>\n';return __p}}},"/0Qt":function(t,e,i){"use strict";var n=i("etQA");i.n(n).a},"/Sry":function(t,e,i){"use strict";i.d(e,"a",(function(){return o})),i.d(e,"d",(function(){return b})),i.d(e,"b",(function(){return y})),i.d(e,"c",(function(){return _}));var n,o,a=i("q1tI"),r=i.n(a),s=i("31/U"),l=i("b1Nn"),c=i("I0kf"),d=i("QuYs");function h(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){m(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return v(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t[t.No=0]="No",t[t.Triggered=1]="Triggered",t[t.Showed=2]="Showed",t[t.Closed=3]="Closed"}(n||(n={})),function(t){t.AutolayoutIconHovered="autolayoutIconHovered",t.BundleDragHovered="bundleDragHovered",t.CountAnimatedWidgetCreated="countAnimatedWidgetCreated",t.CountFixedWidgetCreated="countFixedWidgetCreated",t.CountTextWidgetCreated="countTextWidgetCreated",t.CountWidgetCreated="countWidgetCreated",t.CreatedWidgetsCount="createdWidgetsCount",t.FixedWidgetUsed="fixedWidgetUsed",t.GuidesTurnOn="guidesTurnOn",t.OnAllPagesWidgetUsed="onAllPagesWidgetUsed",t.ParagraphStyleCreated="paragraphStyleCreated",t.SizesToolTurnOn="sizesToolTurnOn",t.ViewportIconHovered="viewportIconHovered",t.WidgetbarOpened="widgetbarOpened",t.WidgetDeletedOnMobile="widgetDeletedOnMobile",t.WidgetsGrouped="widgetsGrouped",t.WidgetRenamed="widgetRenamed",t.WidgetResized="widgetResized",t.WidgetSlightlyResized="widgetSlightlyResized"}(o||(o={}));var b={eduTipUseViewportsIcon:{viewportIconHovered:!0},eduTipOnDeleteMobileWidget:{widgetDeletedOnMobile:!0},eduTipUseBundleDragTriangle:{bundleDragHovered:!0},eduTipUseShortcutToChangeSizes:{widgetSlightlyResized:!0},eduTipUseShortcutToMoveText:{countTextWidgetCreated:9},eduTipUseShortcutToCopyAnimation:{countAnimatedWidgetCreated:2},eduTipUseShortcutToEnableGuides:{countWidgetCreated:3,guidesTurnOn:void 0},eduTipUseShortcutToEnableSizes:{widgetResized:!0,sizesToolTurnOn:void 0},eduTipUseFix:{countWidgetCreated:10,fixedWidgetUsed:void 0},eduTipUseAbovePages:{countFixedWidgetCreated:3,onAllPagesWidgetUsed:void 0},eduTipUseStylesForText:{countTextWidgetCreated:5,paragraphStyleCreated:void 0},eduTipUseShortcutForGroup:{countWidgetCreated:16,widgetbarOpened:!0,widgetsGrouped:void 0},eduTipSetNamesForWidgets:{countWidgetCreated:15,widgetbarOpened:!0,widgetRenamed:void 0},eduTipUseResrtorePanel:{autolayoutIconHovered:!0}},y=r.a.createContext({}),_=function(t){var e=t.children,i=t.router,o=g(Object(a.useState)({}),2),u=o[0],m=o[1],f=g(Object(a.useState)([]),2),v=(f[0],f[1]),_=Object(a.useContext)(l.d),w=function(t,e){if(i.me){var n=i.me.get("edu_tips_state")||{};n[t]=e,i.me.save({edu_tips_state:n},{patch:!0})}},k={setNoticeMessage:function(t){m((function(e){return p(p({},e),{},{message:t})}))},showNotice:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.canBeClosed,n=void 0!==i&&i;m((function(e){return p(p({},e),{},{message:t,canBeClosed:n,visible:!0,isTipType:!1,needShowHelpIcon:!1})}))},onNoticeClose:function(){m((function(t){return t.visible&&t.message?(w(t.message,n.Closed),p(p({},t),{},{visible:!1})):t}))},openHelp:function(){_.isSettingsOpened&&!_.isHelpPanelOpen||_.dispatch({type:l.c.ToggleSettingsSidebar}),_.dispatch({type:l.c.ToggleHelpPanel,open:!0})},triggerEduTip:function(t){m((function(e){if(i.me)switch((i.me.get("edu_tips_state")||{})[t]||n.No){case n.Closed:case n.Showed:break;case n.Triggered:S(t);break;case n.No:return w(t,n.Triggered),d.d.sendEvent(d.b.EditorTips,{eventLabel:x(t)}),p(p({},e),{},{visible:!0,message:t,canBeClosed:!0,needShowHelpIcon:!0,isTipType:!0})}return e}))},hideNotice:Object(a.useCallback)((function(){m((function(t){return t.visible?p(p({},t),{},{visible:!1}):t}))}),[]),triggerMetrics:function(t,e){if(Object(c.a)("constructor.eduTips")&&i&&i.me&&i.me.get("constructor_show_tips")){var n=function(t,e){if(!i.me)return{};var n=i.me.get("behavior_metrics")||{},o=t.includes("count"),a=n[t];return n[t]=o&&void 0===e?"number"==typeof a?a+1:1:void 0===e||e,i.me.save({behavior_metrics:n},{patch:!0}),n}(t,e),o=i.me.get("edu_tips_state")||{},a=function(t,e){for(var i in e)if(e.hasOwnProperty(i)){if("number"==typeof e[i]&&"number"==typeof t[i]&&e[i]>t[i])return!1;if(e[i]!==t[i])return!1}return!0};for(var r in b)if(b.hasOwnProperty(r)&&!o[r]){var s=b[r];("function"==typeof s?s(n):a(n,s))&&j(r)}}}},S=function(t){v((function(e){return e.includes(t)?e:[].concat(h(e),[t])}))},x=function(t){switch(t){case s.b.EduTipUseViewportsIcon:return"Viewports icon";case s.b.EduTipOnDeleteMobileWidget:return"Deleting in mobile";case s.b.EduTipUseBundleDragTriangle:return"Bundle drag";case s.b.EduTipUseShortcutToChangeSizes:return"Sizes changing shortcut";case s.b.EduTipUseShortcutToMoveText:return"Line breaking";case s.b.EduTipUseShortcutToCopyAnimation:return"Animation copy";case s.b.EduTipUseShortcutToEnableGuides:return"Guides shortcut";case s.b.EduTipUseShortcutToEnableSizes:return"Sizes enabled";case s.b.EduTipUseFix:return"Fixed widgets";case s.b.EduTipUseAbovePages:return"Above pages";case s.b.EduTipUseStylesForText:return"Text styles";case s.b.EduTipUseShortcutForGroup:return"Group widgets";case s.b.EduTipSetNamesForWidgets:return"Renaming widgets";case s.b.EduTipUseResrtorePanel:return"Restore panel";default:return"Ooops! Something went wrong."}},C=function(t,e){k.showNotice(t,e)},O=function(){k.hideNotice()},j=function(t){k.triggerEduTip(t)},P=function(t,e){k.triggerMetrics(t,e)};return Object(a.useEffect)((function(){return i.on("notice:show",C),i.on("notice:hide",O),i.on("notice:triggerEduTip",j),i.on("notice:triggerMetrics",P),function(){i.off("notice:show",C),i.off("notice:hide",O),i.off("notice:triggerEduTip",j),i.off("notice:triggerMetrics",P)}}),[]),r.a.createElement(y.Provider,{value:p(p({},u),k)},e)}},"0DSZ":function(t,e,i){"use strict";var n=i("xi34"),o=i("rFsW"),a={props:{onPanelScroll:{type:Function,default:function(){}},onScrollRecalc:{type:Function,default:function(){}},scrollGapStart:{type:Number,default:16},scrollGapEnd:{type:Number,default:16},systemScroll:{type:Boolean,default:!1},savedScrollPosition:{type:Number,default:void 0}},mounted:function(){this.resizableScroll=Object(n.a)(this.$refs.scrollWrapper).RMScroll({$container:Object(n.a)(this.$refs.contentWrapper),$content:Object(n.a)(this.$refs.content),$handle:Object(n.a)(this.$refs.scroll),wheelScrollSpeed:.4,gap_start:this.scrollGapStart,gap_end:this.scrollGapEnd,systemScroll:this.systemScroll,onScroll:this.onPanelScroll,savedScrollPosition:this.savedScrollPosition}).data("scroll"),this.__scrollRecalc_debounced=o.a.debounce(o.a.bind((function(){this.resizableScroll.recalc(),this.onScrollRecalc("control-resize")}),this),300)},beforeUpdate:function(){0===this.savedScrollPosition&&this.resizableScroll.clearScroll()},methods:{recalcScroll:function(){this.__scrollRecalc_debounced()}}},r=i("KHd+"),s=Object(r.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"scrollWrapper",staticClass:"resizable-scroll-wrapper"},[e("div",{ref:"contentWrapper",staticClass:"resizable-content-wrapper"},[e("div",{ref:"content",staticClass:"resizable-content"},[this._t("default")],2)]),this._v(" "),e("div",{ref:"scroll",staticClass:"resizable-scroll"})])}),[],!1,null,null,null);e.a=s.exports},"0HwJ":function(t,e,i){"use strict";var n=i("uYpM");i.n(n).a},"0KJJ":function(t,e,i){},"0NDv":function(t,e,i){"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var s=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,i){var n,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e,o({headers:{"Content-Type":"application/json"}},i));case 2:if(a=t.sent,!(null===(n=a.headers.get("content-type"))||void 0===n?void 0:n.includes("application/json"))){t.next=9;break}return t.next=6,a.json();case 6:t.t0=t.sent,t.next=12;break;case 9:return t.next=11,a.text();case 11:t.t0=t.sent;case 12:if(r=t.t0,!a.ok){t.next=17;break}return t.abrupt("return",r);case 17:throw{message:r&&"string"!=typeof r?r.message:r,statusCode:a.status};case 18:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function s(t){r(a,n,o,s,l,"next",t)}function l(t){r(a,n,o,s,l,"throw",t)}s(void 0)}))});return function(t,i){return e.apply(this,arguments)}}();e.a={get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object.keys(e).map((function(t){var i=e[t];return Array.isArray(i)?i.map((function(e){return"".concat(encodeURIComponent("".concat(t,"[]")),"=").concat(encodeURIComponent(e))})).join("&"):"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(i))})).join("&");return s("".concat(t).concat(n?"?".concat(n):""),i)},post:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(t,o({method:"POST",body:JSON.stringify(e)},i))},patch:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(t,o({method:"PATCH",body:JSON.stringify(e)},i))},put:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(t,o({method:"PUT",body:JSON.stringify(e)},i))},delete:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s(t,o({method:"DELETE",body:e?JSON.stringify(e):void 0},i))}}},"0SXY":function(module,exports){module.exports={"template-constructor-control-gmaps_edit":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Edit map" data-alt-pos="left" data-alt-offset="9"></div>\n';return __p}}},"0zSa":function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("X7yJ"),l=a.a.View.extend({pictures:[],domPictures:[],preloadPictures:[],currentSlide:null,nextSlide:null,selectedSlide:null,defaultDelay:4,defaultCrossfade:.5,isAnimationRunning:!1,cursor:0,rendered:!1,lastSlideshowAnimationStart:null,initialize:function(t){this.initSlideshowData(t.data),this.$container=t.container,this.$preloadContainer=t.preloadContainer},initSlideshowData:function(t){this.pictures=t&&t.pictures?r.a.sortBy(t.pictures,"num"):[],this.delay=t&&"number"==typeof t.delay?t.delay:this.defaultDelay,this.crossfade=t&&"number"==typeof t.crossfade?t.crossfade:this.defaultCrossfade,this.name=t&&t.name?t.name:"slideshow"+(new Date).getTime(),this.domPictures=[],this.preloadPictures=[],this.currentSlide=null,this.nextSlide=null,this.selectedSlide=null,this.isAnimationRunning=!1,this.cursor=0},render:function(t){RM.screenshot?this.pictures.length?this.addPicture(this.pictures[0]):this.trigger("loaded"):this.loadPictures(),this.isAnimationRunning||t||this.startAnimationLoop(),this.rendered=!0},rerender:function(t){this.stopAnimationLoop(),this.initSlideshowData(t),this.removePictures(),this.render(!0)},runAnimation:function(){this.isAnimationRunning||(this.rendered?this.startAnimationLoop():this.render())},setDelay:function(t){t<this.crossfade?console.error("delay mast be longer than crossfade"):this.delay=t},setCrossfade:function(t){t>this.delay?console.error("delay mast be longer than crossfade"):(this.crossfade=t,this.updateCrossfade())},updateCrossfade:function(){this.domPictures.forEach(function(t){t.css({"transition-duration":this.crossfade+"s"})}.bind(this))},updatePicture:function(t){var e=r.a.findIndex(this.pictures,(function(e){return e.uuid===t.uuid}));this.pictures[e]=t,this.domPictures[e].css({"background-image":'url("'.concat(this.getPoorUrl(t),'")')}),s.a.useLqipUrl(t)&&this.domPictures[e].addClass("lqip"),this.loadFullSizePicture(t)},updatePicturePosition:function(t){this.destroy(),this.initSlideshowData({pictures:t,delay:this.delay,crossfade:this.crossfade}),this.render()},addPicture:function(t){var e=this.domPictures.length===this.cursor+1,i=0===this.domPictures.length?2:e?1:0,o=0===this.domPictures.length||e?"block":"none";this.pictures.push(t),this.domPictures.push(Object(n.a)("<div>").addClass("slideshow-image fade-in".concat(s.a.useLqipUrl(t)?" lqip":"")).css({"z-index":i,display:o,"background-image":'url("'.concat(this.getPoorUrl(t),'")'),"transition-property":"opacity","transition-duration":this.crossfade+"s","transition-timing-function":"linear"}).appendTo(this.$container)),this.loadFullSizePicture(t)},selectSlide:function(t){if(t){var e=this.pictures.findIndex((function(e){return e.uuid===t}));if(-1!==e){if(this.currentSlide&&this.selectedSlide!==this.domPictures[e]&&(this.isAnimationRunning&&this.stopAnimationLoop(),this.currentSlide!==this.domPictures[e])){var i=this.cursor;this.nextSlide&&this.nextSlide.css({"z-index":0,display:"none"}),this.domPictures[e].css({"z-index":1,display:"block"}),this.currentSlide=this.domPictures[e],this.cursor=e,this.selectedSlide=this.domPictures[e],this.domPictures.length>1?this.domPictures[e+1]?this.nextSlide=this.domPictures[e+1]:this.nextSlide=this.domPictures[0]:this.nextSlide=null,this.domPictures[i].css({"transition-duration":"0.3s"}),this.domPictures[i].removeClass("fade-in").addClass("fade-out"),setTimeout(function(){this.domPictures[i].css({"z-index":0,"transition-duration":"0s",display:"none"}).removeClass("fade-out").addClass("fade-in").css({"transition-duration":this.crossfade+"s"}),this.currentSlide.css({"z-index":2}),this.nextSlide&&this.nextSlide.css({"z-index":1,display:"block"})}.bind(this),310)}}else console.warn("Did't find slide for uuid:",t)}},removePictures:function(){this.domPictures=[],this.preloadPictures=[],this.$container.empty(),this.$preloadContainer.empty()},removePicture:function(t){if(t){var e=this.pictures.findIndex((function(e){return e.uuid===t}));if(this.domPictures[e]===this.currentSlide&&1!==this.domPictures.length&&this.selectedSlide!==this.domPictures[e]){var i=1e3*this.crossfade+1e3*this.delay+50;i=this.lastSlideshowAnimationStart?Math.abs(i-((new Date).getTime()-this.lastSlideshowAnimationStart.getTime())):i,setTimeout(function(){this.cursor&&(this.cursor-=1);var e=this.pictures.findIndex((function(e){return e.uuid===t}));this.domPictures[e].remove(),this.domPictures.splice(e,1),this.pictures.splice(e,1)}.bind(this),i)}else{if(this.domPictures[e]===this.nextSlide&&1!==this.domPictures.length&&(this.domPictures[e+1]?(this.domPictures[e+1].css({"z-index":1,display:"block"}),this.nextSlide=this.domPictures[e+1]):(this.domPictures[0].css({"z-index":1,display:"block"}),this.nextSlide=this.domPictures[0])),this.selectedSlide===this.domPictures[e]&&this.nextSlide){var n=this.domPictures.findIndex(function(t){return t===this.nextSlide}.bind(this));this.currentSlide=this.domPictures[n],this.cursor=n,this.selectedSlide=null,this.currentSlide.css({"z-index":2}),this.domPictures.length>2?this.domPictures[this.cursor+1]?this.nextSlide=this.domPictures[this.cursor+1]:this.nextSlide=this.domPictures[0]:this.nextSlide=null,this.nextSlide&&this.nextSlide.css({"z-index":1,display:"block"}),setTimeout(function(){this.startAnimationLoop()}.bind(this),0)}this.domPictures[e].remove(),this.domPictures.splice(e,1),this.pictures.splice(e,1)}}},getThumbnailUrl:function(t){return t?s.a.useLambdaUrl(t)?s.a.getThumbnailUrl(t):t.thumbUrl:""},getPictureUrl:function(t){return s.a.useLambdaUrl(t)||s.a.useLambdaUrlOldProjects(t,"background")?s.a.getLambdaUrl(t):t.url},getPoorUrl:function(t){return s.a.useLqipUrl(t)?s.a.getLqipUrl(t):t.poorUrl},loadPictures:function(){this.pictures.forEach(function(t,e){this.domPictures[e]=Object(n.a)("<div>").addClass("slideshow-image fade-in".concat(s.a.useLqipUrl(t)?" lqip":"")).css({"z-index":0===e?2:1===e?1:0,display:0===e||1===e?"block":"none","background-image":'url("'.concat(this.getPoorUrl(t),'")'),"transition-property":"opacity","transition-duration":this.crossfade+"s","transition-timing-function":"linear"}).appendTo(this.$container)}.bind(this)),this.loadFullSizePictures()},loadFullSizePictures:function(){function t(t,e,i){this.domPictures[e].css({"background-image":'url("'.concat(t,'")')}),this.domPictures[e].removeClass("lqip"),this.preloadPictures[e].remove(),0===e&&this.trigger("loaded")}function e(t,e){this.domPictures[t].removeClass("lqip"),0===t&&this.trigger("loaded"),RM.screenshot||this.preloadPictures[t].remove()}this.preloadPictures=[],this.pictures.forEach(function(i,o){var a=this.getPictureUrl(i);this.preloadPictures[o]=Object(n.a)("<img>").addClass("preload-slideshow-image").appendTo(this.$preloadContainer).attr("src",a).on("load",t.bind(this,a,o)).on("error",e.bind(this,o))}.bind(this))},loadFullSizePicture:function(t){var e=Object(n.a)("<img>").addClass("preload-slideshow-image").appendTo(this.$preloadContainer).attr("src",this.getPictureUrl(t)).on("load",function(i){var n=r.a.findIndex(this.pictures,(function(e){return t.uuid===e.uuid}));this.domPictures[n].css({"background-image":'url("'.concat(this.getPictureUrl(t),'")')}),this.domPictures[n].removeClass("lqip"),e.remove(),this.trigger("loaded")}.bind(this)).on("error",function(i){var n=r.a.findIndex(this.pictures,(function(e){return t.uuid===e.uuid}));this.domPictures[n].removeClass("lqip"),e.remove(),this.trigger("loaded"),RM.screenshot||e.remove()}.bind(this))},initCursor:function(){this.cursor=0,this.currentSlide=this.domPictures[this.cursor],this.domPictures[this.cursor+1]&&(this.nextSlide=this.domPictures[this.cursor+1])},startAnimationLoop:function(){this.isAnimationRunning=!0,this.selectedSlide=null,this.currentSlide||this.initCursor(),this.slideshowLouncher=setTimeout(function t(){this.fadeAnimation(),this.slideshowLouncher=setTimeout(t.bind(this),1e3*this.delay)}.bind(this),1e3*this.delay)},fadeAnimation:function(){var t;this.lastSlideshowAnimationStart=new Date,this.domPictures.length<2||(this.currentSlide&&this.nextSlide||this.initCursor(),this.cursor+1<this.domPictures.length?(this.currentSlide.removeClass("fade-in").addClass("fade-out"),t=this.cursor,setTimeout(function(){this.domPictures[t]&&this.domPictures[t].css({"z-index":0,"transition-duration":"0s",display:"none"}).removeClass("fade-out").addClass("fade-in").css({"transition-duration":this.crossfade+"s"}),this.domPictures[t+1].css({"z-index":2}),this.domPictures[t+2]?this.domPictures[t+2].css({"z-index":1,display:"block"}):this.domPictures[0].css({"z-index":1,display:"block"})}.bind(this),1e3*this.crossfade),this.cursor+=1,this.currentSlide=this.domPictures[this.cursor],this.domPictures[this.cursor+1]?this.nextSlide=this.domPictures[this.cursor+1]:this.nextSlide=this.domPictures[0]):(this.currentSlide.removeClass("fade-in").addClass("fade-out"),t=this.cursor,setTimeout(function(){this.domPictures[t]&&this.domPictures[t].css({"z-index":0,"transition-duration":"0s",display:"none"}).removeClass("fade-out").addClass("fade-in").css({"transition-duration":this.crossfade+"s"}),this.domPictures[0].css({"z-index":2}),this.domPictures[1].css({"z-index":1,display:"block"})}.bind(this),1e3*this.crossfade),this.cursor=0,this.currentSlide=this.domPictures[this.cursor],this.nextSlide=this.domPictures[this.cursor+1]))},stopAnimationLoop:function(t){this.isAnimationRunning=!1,clearTimeout(this.slideshowLouncher),t&&"function"==typeof t&&t()},destroy:function(){this.rendered=!1,this.stopAnimationLoop(this.removePictures.bind(this))}});e.a=l},1:function(t,e){},"1cLU":function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("lU33"),l=i("8AXF"),c=i("f3SV"),d=i("za5s");function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var u,p,m=(u=r.Tb,p=1,function(t){if(Array.isArray(t))return t}(u)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}}(u,p)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?h(t,e):void 0}}(u,p)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],g=Object(n.e)(r.Cb).withConfig({displayName:"RmFooter___StyledText"})(["display:inline-block;text-decoration:none;font-style:normal;&:hover{color:",";}"],(function(t){return t._css})),f=function(t){var e=t.label,i=t.url,n=t.showComma,o=t.isMobile;return(a.a.createElement(a.a.Fragment,null,a.a.createElement(g,{as:"a",fontFamily:"Graphik",color:"darkGray",fontWeight:400,fontSize:12,letterSpacing:-.04,lineHeight:o?"1":"24px",href:i,_css:Object(d.themeGet)("colors.orange")},e),n&&a.a.createElement(r.Cb,{fontFamily:"Graphik",color:"darkGray",fontWeight:400,fontSize:12,letterSpacing:-.04,lineHeight:o?"1":"24px"},","," ")))},v=Object(n.e)(r.Cb).withConfig({displayName:"RmFooter___StyledText2"})(["font-style:normal;"]),b=Object(n.e)(r.m).withConfig({displayName:"RmFooter___StyledBox"})(["",""],(function(t){return t._css2})),y=Object(n.e)(r.Cb).withConfig({displayName:"RmFooter___StyledText3"})(["display:inline-block;text-decoration:none;font-style:normal;&:hover{color:",";}"],(function(t){return t._css3})),_=function(t){var e=t.items,i=t.width,n=t.title,o=t.isMobile;return(a.a.createElement(r.m,{width:i},a.a.createElement(r.m,{borderBottom:"1px solid rgba(128, 128, 128, 0.24)",pb:"6px",mb:"16px"},a.a.createElement(v,{fontFamily:"Graphik",fontWeight:400,fontSize:16,letterSpacing:-.04,lineHeight:"24px",color:"darkGray"},n)),a.a.createElement(b,{_css2:e.length>1&&!o?"display: flex; align-items: flex-start; justify-content: space-between;":""},e.map((function(t,i){return a.a.createElement(r.m,{key:"ul-".concat(i),mb:o&&t.mobileSeparator?36:void 0},t.items.map((function(t,n){return a.a.createElement(r.m,{mr:e.length-1!==i||o?void 0:30,key:"ul-".concat(i,"-li-").concat(n)},a.a.createElement(y,{as:"a",href:t.url,color:"white",fontFamily:"Graphik",fontWeight:400,fontSize:16,letterSpacing:-.04,lineHeight:"24px",_css3:Object(d.themeGet)("colors.orange")},t.label))})))})))))},w=Object(n.e)(r.m).withConfig({displayName:"RmFooter___StyledBox2"})([""," ",""],(function(t){return t._css4}),(function(t){return t._css5})),k=Object(n.e)(r.B).withConfig({displayName:"RmFooter___StyledFlex"})(["",""],(function(t){return t._css6})),S=Object(n.e)(r.B).withConfig({displayName:"RmFooter___StyledFlex2"})(["",""],(function(t){return t._css7}));e.a=function(){var t=c.a.readymag_host,e=Object(o.useContext)(l.BackboneContext).model;return a.a.createElement(s.a,{query:"(min-width: ".concat(m,")")},(function(i){var n=e&&e.isMobileViewport||!i;return(a.a.createElement(w,{bg:"rgb(40, 40, 40)",height:"100%",width:"100%",_css4:e&&e.transform?"padding: 0 !important; transform: ".concat(e.transform,";"):"",_css5:e&&e.zoom?"zoom: ".concat(e.zoom,";"):""},a.a.createElement(r.m,{m:"0 auto",width:n?"100%":1024,height:"100%",p:"58px 20px 16px"},a.a.createElement(k,{alignItems:"flex-start",justifyContent:"space-between",mb:n?76:38,_css6:n?"display: block":""},a.a.createElement(_,{title:"Company",isMobile:n,width:n?"100%":230,items:[{mobileSeparator:!0,items:[{label:"About",url:"".concat(t,"/about/")},{label:"R/masters",url:"".concat(t,"/examples/r-masters")}]}]}),a.a.createElement(_,{title:"News",isMobile:n,width:n?"100%":482,items:[{mobileSeparator:!0,items:[{label:"Product updates",url:"".concat(t,"/readymag/product-updates/")},{label:"Subscribe to newsletter",url:"http://subscribe.readymag.com/"},{label:"Medium",url:"https://medium.com/@readymag"}]},{mobileSeparator:!1,items:[{label:"Facebook",url:"https://www.facebook.com/readymag"},{label:"Twitter",url:"https://twitter.com/readymag"},{label:"Are.na",url:"https://www.are.na/readymag"}]},{mobileSeparator:!0,items:[{label:"Dribbble",url:"https://dribbble.com/readymag"},{label:"Instagram",url:"https://www.instagram.com/readymag/"},{label:"Pinterest",url:"https://www.pinterest.ru/readymagpins/boards/"}]}]}),a.a.createElement(_,{title:"Support",isMobile:n,width:n?"100%":230,items:[{items:[{label:"Templates",url:"".concat(t,"/templates")},{label:"Help",url:"https://help.readymag.com/"},{label:"support@readymag.com",url:"mailto:support@readymag.com"}]}]})),a.a.createElement(S,{alignItems:"flex-start",_css7:n?"display: block;":""},a.a.createElement(r.m,{width:n?"100%":252},a.a.createElement(r.Cb,{fontFamily:"Graphik",color:"darkGray",fontWeight:400,fontSize:12,letterSpacing:-.04,lineHeight:n?"1":"24px"},"© ",(new Date).getFullYear()," Readymag Inc.")),a.a.createElement(r.m,{width:n?"100%":""},a.a.createElement(f,{label:"Terms of service",url:"".concat(t,"/readymag/terms-and-privacy/"),showComma:!0,isMobile:n}),a.a.createElement(f,{label:"Privacy policy",url:"".concat(t,"/readymag/terms-and-privacy/2/"),isMobile:n}))))))}))}},"1ljF":function(module,exports){module.exports={"template-constructor-workspace-inside-block-widget-selector":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n    <div class="widget-selector">\n\n        <div class="widget" data-block-type="picture">\n\t    \t<div class="icon"></div>\n\t        <div class="caption">Image</div>\n        </div>\n\n\n\t    <div class="widget" data-block-type="text">\n\t\t    <div class="icon"></div>\n\t\t    <div class="caption">Text</div>\n\t    </div>\n\n    </div>\n\n';return __p}}},"1wfi":function(module,exports){module.exports={"template-constructor-help-panel":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="help-panel-items">\n\t\t<div class="help-panel-item take-a-tour">Take a Tour<div class="help-panel-item-icon"></div></div>\n\t\t<div class="help-panel-item shortcuts">Learn Shortcuts<div class="help-panel-item-icon"></div></div>\n\t\t<a class="help-panel-item read-manual" target="_blank" href="https://readymag.com/learn">Learn Readymag<div class="help-panel-item-icon"></div></a>\n\t</div>\n';return __p},"template-constructor-help-shortcuts":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="container">\n\t\t<div class="tabs">\n\t\t\t<span class="title">Shortcuts</span>\n\t\t\t<ul>\n\t\t\t\t<li class="single" data-tab="single">\n\t\t\t\t\t<div class="single-key"><span>single key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="control" data-tab="control">\n\t\t\t\t\t<div class="control-key"><span>ctrl</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="command" data-tab="command">\n\t\t\t\t\t<div class="command-key"><span>⌘</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="alt_command" data-tab="alt_command">\n\t\t\t\t\t<div class="alt-key"><span>alt</span></div>\n\t\t\t\t\t<div class="command-key"><span>⌘</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="control_alt" data-tab="control_alt">\n\t\t\t\t\t<div class="control-key"><span>ctrl</span></div>\n\t\t\t\t\t<div class="alt-key"><span>alt</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="shift_command" data-tab="shift_command">\n\t\t\t\t\t<div class="shift-key"><span>shift</span></div>\n\t\t\t\t\t<div class="command-key"><span>⌘</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="shift_control" data-tab="shift_control">\n\t\t\t\t\t<div class="shift-key"><span>shift</span></div>\n\t\t\t\t\t<div class="control-key"><span>ctrl</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\t\t\t\t<li class="alt" data-tab="alt">\n\t\t\t\t\t<div class="alt-key"><span>alt</span></div>\n\t\t\t\t\t<div><span>key</span></div>\n\t\t\t\t</li>\n\n\t\t\t</ul>\n\t\t\t<a class="full-list" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360020647532-Shortcuts">Full list of shortcuts\n\t\t\t\t<div class="arrow">\n\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="keyboard single">\n\t\t\t<div class="back"><div class="keyboard-corner"></div></div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-help-tip-bottom-blocks-to-move":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="help-tip bottom-blocks-to-move">\n\t\t<div class="message">While moving a widget, press <span class="shortcut">V</span> key to preserve distances between elements below.</div>\n\t\t<a class="learn-more" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360020527072-Operations-with-widgets">Learn more</a>\n\t\t<div class="close"></div>\n\t</div>\n';return __p},"template-constructor-help-tip-animation-trigger-removed":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="help-tip help-tip-animation-trigger-removed">\n\t\t<div class="message">\n\t\t\tYou’ve just deleted the trigger for an animated widget.\n\t\t\t<a class="js-action">Undo</a>\n\t\t</div>\n\t\t<div class="close"></div>\n\t</div>\n';return __p},"template-constructor-help-tip-animation-trigger-unlinked":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="help-tip help-tip-animation-trigger-unlinked">\n\t\t<div class="message">Some animation triggers were unlinked.</div>\n\t\t<div class="close"></div>\n\t</div>\n';return __p}}},"2EI4":function(t,e,i){},"2d4q":function(module,exports){module.exports={"template-constructor-control-shape_1x1":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Equilateral" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t</div>\n';return __p}}},"31/U":function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return g}));var n,o=i("vOnD"),a=i("q1tI"),r=i.n(a),s=i("jIIB"),l=i("/Sry"),c=i("iC7s"),d=i("wEEd");!function(t){t.UpgradeAccountToUse="upgradeAccountToUse",t.EcommHasInvalidAddToCartWidget="ecommHasInvalidAddToCartWidget",t.EduTipUseViewportsIcon="eduTipUseViewportsIcon",t.EduTipOnDeleteMobileWidget="eduTipOnDeleteMobileWidget",t.EduTipUseBundleDragTriangle="eduTipUseBundleDragTriangle",t.EduTipUseShortcutToChangeSizes="eduTipUseShortcutToChangeSizes",t.EduTipUseShortcutToMoveText="eduTipUseShortcutToMoveText",t.EduTipUseShortcutToCopyAnimation="eduTipUseShortcutToCopyAnimation",t.EduTipUseShortcutToEnableGuides="eduTipUseShortcutToEnableGuides",t.EduTipUseShortcutToEnableSizes="eduTipUseShortcutToEnableSizes",t.EduTipUseFix="eduTipUseFix",t.EduTipUseAbovePages="eduTipUseAbovePages",t.EduTipUseStylesForText="eduTipUseStylesForText",t.EduTipUseShortcutForGroup="eduTipUseShortcutForGroup",t.EduTipSetNamesForWidgets="eduTipSetNamesForWidgets",t.EduTipUseResrtorePanel="eduTipUseResrtorePanel"}(n||(n={}));var h=Object(o.e)(c.ub).withConfig({displayName:"ConstructorNotice___StyledStyledLink"})(["&:hover{opacity:0.8;}"]),u=function(t){switch(t){case n.UpgradeAccountToUse:return r.a.createElement(c.Cb,{color:"black"},r.a.createElement(h,{as:"a",color:"tomato",href:"/settings#change-plan",target:"_blank"},"Upgrade your account")," ","to make the widget visible after publishing.");case n.EcommHasInvalidAddToCartWidget:return"Some of the Add to cart buttons don't have attached products.";case n.EduTipUseViewportsIcon:return"Click on the icon to see how your widget looks in different viewports.";case n.EduTipOnDeleteMobileWidget:return"Note that the widget was not deleted from the desktop version of your project.";case n.EduTipUseBundleDragTriangle:return"Use the triangle icon under the widget to move the widget and everything below it.";case n.EduTipUseShortcutToChangeSizes:return"Press Cmd + Arrow key to smoothly adjust widget size.";case n.EduTipUseShortcutToMoveText:return"Press Shift + Enter to move text without creating a new paragraph.";case n.EduTipUseShortcutToCopyAnimation:return"Press Cmd + C / V to copy and paste animations.";case n.EduTipUseShortcutToEnableGuides:return"Use the H button to disable Guides.";case n.EduTipUseShortcutToEnableSizes:return"Use the X button to enable Sizes for greater precision.";case n.EduTipUseFix:return"‘Fix’ any widget to the edge of your page at the corners or center of the screen.";case n.EduTipUseAbovePages:return"Use the Above Pages toggle to make any global widget float over pages.";case n.EduTipUseStylesForText:return"Use styles to lay out text more quickly.";case n.EduTipUseShortcutForGroup:return"To create a group of widgets, select them and press Cmd + G / Ctrl + G.";case n.EduTipSetNamesForWidgets:return"Set names for widgets to make work easier.";case n.EduTipUseResrtorePanel:return"To undo changes and return to the desktop or mobile auto-layout, use the Restore panel.";default:return"Ooops! Something went wrong."}},p=function(t){switch(t){case n.EduTipUseShortcutToEnableGuides:return"https://help.readymag.com/hc/en-us/articles/360022086071-Grid-and-guides";case n.EduTipUseShortcutToEnableSizes:return"https://help.readymag.com/hc/en-us/articles/360020527072-Operations-with-widgets";case n.EduTipUseAbovePages:return"https://help.readymag.com/hc/en-us/articles/360022086611-Global-widgets-On-all-pages-";case n.EduTipUseStylesForText:return"https://help.readymag.com/hc/en-us/articles/360018417451-Text";case n.EduTipUseFix:return"https://help.readymag.com/hc/en-us/articles/360020527132-Fixed-and-positioned-widgets"}},m=Object(o.e)(d.a.div).withConfig({displayName:"ConstructorNotice___StyledAnimatedDiv"})(["display:flex;"]),g=function(){var t=Object(a.useContext)(l.b),e=t.message,i=t.visible,n=t.onNoticeClose,o=t.openHelp,c=t.canBeClosed,h=t.needShowHelpIcon,g=t.isTipType,f=Object(d.d)(i,null,{from:{transform:"translate3d(0,0%,0)"},leave:{opacity:0}});return r.a.createElement(r.a.Fragment,null,f.map((function(t){var a=t.item,l=t.key,d=t.props;return a&&r.a.createElement(m,{key:l,style:d},e&&r.a.createElement(s.a,{message:u(e),closeBtn:c,visible:i,helpBtn:h,isTip:g,moreLink:p(e),onClose:n,onSettingsClick:o}))})))}},"38JW":function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("secl"),l=i.n(s),c=i("Zuws"),d=i.n(c),h=i("OTSC"),u=i("X7yJ"),p=i("pFlR"),m=i("roQd"),g=i("HwMs"),f=i("DqjY"),v=i("WoDZ"),b=i("v92f"),y=i("rVpV"),_=i("G3+Z"),w=i("gdoY"),k=i("QNiq");i("I0kf");function S(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function x(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function C(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?x(Object(i),!0).forEach((function(e){O(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):x(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function O(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var j=C(C({},l.a),d.a),P=a.a.View.extend({template:j["template-viewer-page"],initialize:function(t){return r.a.bindAll(this),this.mag=t.mag,this.router=t.router,this.$container=t.$container,this.viewerType=t.viewerType,this.totalPages=t.totalPages,this.isStickyVerticalViewer=t.isStickyVerticalViewer,this.widgetsData=t.pageData.wids,r.a.defaults(t.pageData,{title:"",width:this.mag.getViewportWidth(t.mag.viewport),height:this.mag.getViewportSetting("min_height")}),r.a.extend(this,r.a.omit(t.pageData,["wids","widgets"])),this.contentPosition={left:0,top:0},this},render:function(){return this.setElement(this.template({isStickyVerticalViewer:this.isStickyVerticalViewer})),this.$el.appendTo(this.$container),RM.screenshot||Modernizr.csspositionsticky||Object(n.a)(".polyfill-sticky").Stickyfill(),this.zIndex=this.totalPages-this.num+2,"vertical"==this.viewerType&&this.$el.css("z-index",this.zIndex),this.$content=this.$(".page-content-container"),this.$scrollWrapper=this.$(".content-scroll-wrapper"),this.$scrollWrapper.one("scroll",this.fixSafariScroll),this.$fixedBgContainer=this.$(".page-fixed-bg-container"),this.$fixedPositionContainer=this.$(".fixed-position-container"),this.$fixedPositionContainerTop=this.$(".fixed-position-container-top"),this.$contentBounds=this.$(".content-bounds"),this.pageViewport=this.getPageViewport(),"horizontal"==this.viewerType&&this.$scrollWrapper.bind("scroll",this.onScroll),this.createLQBackground(),RM.screenshot==this._id&&(this.$el.css({overflow:"hidden",height:Math.max(this.height,672),width:this.mag.getViewportWidth(b.a.Default),position:"relative"}),"true"===h.default.queryUrlGetParam("pdf")&&(this.$fixedPositionContainer.css({height:"100%"}),this.$fixedPositionContainerTop.css({height:"100%"})),this.onResize(),this.on("pageLoaded",(function(){this.mag.router.sendReadyEvent({page:this})}),this)),this},show:function(){return this.shown||(this.$el.removeClass("hidden"),this.shown=!0,"horizontal"==this.viewerType&&this.onResize(),this.widgets&&this.lastViewportUsedForWidgetsCreation==this.pageViewport||this.createWidgetsForCurrentViewport()),this},start:function(t){if(!this.started||t&&t.forceStart)return this.started=!0,this.trigger("started"),t=t||{},r.a.each(this.widgets,(function(e){(!t||!t.widgetTypes||r.a.indexOf(t.widgetTypes,e.type)>=0)&&e.start()})),this.focusPage(),this.$scrollWrapper.addClass("accelerated-scroll"),this.animations&&this.animations.start(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.start(),this},stop:function(t){if(this.started)return t=t||{},this.started=!1,this.trigger("stopped"),this.$scrollWrapper.removeClass("accelerated-scroll"),r.a.each(this.widgets,(function(e){(!t||!t.widgetTypes||r.a.indexOf(t.widgetTypes,e.type)>=0)&&e.stop()})),this.animations&&this.animations.stop(),this.mag.aboveGlobalAnimations&&this.mag.aboveGlobalAnimations.stop(),this},getUrl:function(){return window.location.protocol+"//"+window.location.hostname+"/p"+this.num_id+"/"},setPosition:function(t,e){this.lastPosition==t&&this.lastNeighbour==e||(this.$el.removeClass("center-page prev-page next-page neighbour").addClass(t+"-page "+(e?"neighbour":"")),this.lastPosition=t,this.lastNeighbour=e)},getScroll:function(){return this.visibleWidgetsCoords.scrollTop},scrollOnVerticalMode:function(t){this.hasScrollOnVerticalMode=!0;var e,i,n=this.pageHeight-this.pageBgHeight;t<0?(e=-t,i=0):n>=t?(e=0,i=-t):(e=n-t,i=-n),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=-i,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),this.trigger("page scroll",this.getScroll()),this.isStickyVerticalViewer||(this.$el.css("top",0),h.default.applyTransform(this.$el,e?"translateY("+e+"px) translateZ(0)":""),this.hasFixedWidgets?this.$contentBounds.css("top",i):h.default.applyTransform(this.$contentBounds,i?"translateY("+i+"px)":""))},resetScrollOnVerticalMode:function(t){this.hasScrollOnVerticalMode&&(this.hasScrollOnVerticalMode=!1,this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=0,this.animations&&this.animations.onScroll({forceApply:!this.isStickyVerticalViewer}),this.isStickyVerticalViewer||(this.$el.css("top",""),h.default.applyTransform(this.$el,""),this.hasFixedWidgets?this.$contentBounds.css("top",0):h.default.applyTransform(this.$contentBounds,"")))},hide:function(){return this.shown&&(this.$el.addClass("hidden"),this.shown=!1),this},destroyAllWidgets:function(t){this.loaded=!1,this.videoBGStarted=!1,r.a.each(this.widgets,function(e,i){var n=this.widgetsData.some((function(t){var i=m.a.normalizeAnimations(t.animation),n=t._id===e._id&&Boolean(i.find((function(t){return!m.a.isEmpty(t)}))),o=t._id===e._id&&(t.viewport_default&&t.viewport_default.hidden||t.viewport_tablet_portrait&&t.viewport_tablet_portrait.hidden||t.viewport_phone_portrait&&t.viewport_phone_portrait.hidden||t.hidden);return n||o}));t&&t.includes(e.type)&&!n||(e.destroy(),e.off(),delete this.widgets[i])}.bind(this)),this.animations&&this.animations.destroy(),delete this.animations,clearTimeout(this.fireReadyTimeout)},destroy:function(){return this.retargetScroll&&this.retargetScroll.restore&&this.retargetScroll.restore(),this.resetWaitForAnimationEnd(),this.destroyLQBackground({animate:!1}),this.destroyAllWidgets(),this.remove()},onFormFocus:function(t){!Modernizr.safari&&k.a.isDesktop||(t=r.a.isUndefined(t)?this.$scrollWrapper&&this.$scrollWrapper.scrollTop():t,this.$fixedBgContainer.css({top:t}))},onFormBlur:function(){!Modernizr.safari&&k.a.isDesktop||this.$fixedBgContainer.css({top:0})},onScrollWithFormInFocus:function(t){!Modernizr.safari&&k.a.isDesktop||(t=r.a.isUndefined(t)?this.$scrollWrapper&&this.$scrollWrapper.scrollTop():t,this.$fixedBgContainer.css({top:t}))},isSwipeInProgress:function(){return this.$el.hasClass("swiping")},getPageZIndex:function(){return this.zIndex||1},getImmediatePack:function(){return r.a.filter(this.widgets,(function(t){return t.canRenderImmediately()&&!t.rendered}))},getWidgetsPacks:function(){if(!this.widgets)return[];var t,e,i,n=this.visibleWidgetsCoords,o=(n.top+(n.scrollTop||0))/n.scale,a=(n.bottom+(n.scrollTop||0))/n.scale-o,r=[],s=[];if(!this.BGWidget||this.BGWidget.rendered||this.BGWidget.loaded||s.push(this.BGWidget),this.fixedWidgets&&this.fixedWidgets.length)for(t=0;t<this.fixedWidgets.length;t++)(i=this.fixedWidgets[t]).rendered||i.loaded||i.canRenderImmediately()||s.push(i);var l,c,d=[],h=99999,u=-99999,p=!1;for(t=0;t<this.widgets.length;t++)(e=this.widgets[t]).rendered||e.loaded||"background"==e.type||e.fixed_position||(l=(c=P.getScreenIndex(e,o,a,!0)).index,h=Math.min(c.start,h),u=Math.max(c.end,u),e.screenIndex=l,l!==1/0&&(d[l]=d[l]||[],d[l].push(e)),p=!0);if(p){for(d[0]&&r.push(d[0]),d[1]&&r.push(d[1]),d[-1]&&r.push(d[-1]),t=2;t<=u;t++)d[t]&&r.push(d[t]);for(t=-2;t>=h;t--)d[t]&&r.push(d[t])}return s.length&&(r.length?r[0]=s.concat(r[0]):r=[s]),r},loadWidgetsPack:function(t,e){var i,n=0,o=0,a=0;for(i=0;i<t.length;i++){var r=t[i];r.rendered||r.loaded||r.destroyed||(r.canRenderImmediately()||(n++,r.on("loaded destroyed",s,r)),a++,r.render())}function s(){o++,n==o&&e()}a||e(),n==o&&e()},loadForScreenshotMode:function(){r.a.each(this.widgets,function(){var t,e=(t=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.render();case 2:t.sent.start();case 4:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){S(a,n,o,r,s,"next",t)}function s(t){S(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}())},createWidgetsForCurrentViewport:function(){this.destroyAllWidgets(["video"]),this.BGWidget=null,this.fixedWidgets=[];var t=this.pageViewport,e=[],i=[],n=99999,o=this,a=this;r.a.each(this.widgetsData,function(e){var o=a.getWidgetViewportData(e,t),r=!this.mag.isPreview&&m.a.hasExpired(o);!w.a[o.type]||o.hidden||r||(!o.fixed_position&&o.z&&"background"!=o.type&&(n=Math.min(n,o.z)),i.push(o))}.bind(this)),99999==n&&(n=0),r.a.each(i,function(i){var r=p.a.isOn(t,this.mag.getViewportWidth(t),this.mag.viewOpts)&&p.a.isCSSTransform();i.fixed_position&&(i.z<n||k.a.isDesktop&&!this.mag.isStickyVerticalViewer&&!r)?i.$fixedContainer=a.$fixedPositionContainer:i.$fixedContainer=a.$fixedPositionContainerTop;var s=null;this.widgets&&this.widgets.length&&(s=this.widgets.find((function(t){return!!t&&t._id===i._id})));var l=s||new w.a[i.type](i,o);"video"===l.type&&(l.updateWidgetData(i,o),l.applyBoxStyle(),l.updateVideoFrameSize(i.w,i.h)),"background"==l.type&&(a.BGWidget=l,a.hasVideoBG=l.hasVideoBG()),l.isValid()&&(l.fixed_position&&a.fixedWidgets.push(l),e.push(l))}.bind(this)),this.animations=new g.a({page:this,widgets:e}),this.widgets=r.a.sortBy(e,"y"),this.signalOnLoading(),this._onFontsLoad=[],this._widgetsWithFontsToLoad=[],this._fontLoaderCalled=0,this._widgetsWithFontsCount=r.a.reduce(this.widgets,(function(t,e){return t+(e.hasFontsToLoad()?1:0)}),0),this._widgetsWithLoadAnimation=r.a.reduce(this.widgets,(function(t,e){return t+(e.hasLoadAnimation()?1:0)}),0),this.hasFixedWidgets=!!this.fixedWidgets.length;var s=p.a.isOn(t,this.mag.getViewportWidth(t),this.mag.viewOpts)&&p.a.isCSSTransform();this.$el.removeClass("page-with-fixeds-desktop page-with-fixeds-sticky-or-mobile").toggleClass("page-with-fixeds-desktop",this.hasFixedWidgets&&k.a.isDesktop).toggleClass("page-with-fixeds-sticky-or-mobile",!(!this.hasFixedWidgets||!this.isStickyVerticalViewer&&k.a.isDesktop&&!s)),this.hasFixedWidgets&&!this.retargetScroll&&"horizontal"==this.viewerType&&k.a.isDesktop&&(this.retargetScroll=_.a&&Object(_.a)(this.$fixedPositionContainerTop.get(0),this.$scrollWrapper.get(0)),_.a&&Object(_.a)(this.$fixedPositionContainer.get(0),this.$scrollWrapper.get(0))),this.lastViewportUsedForWidgetsCreation=t},getWidgetViewportData:function(t,e){var i=r.a.clone(t),n={},o=["text_w","text_h","em_w","anchor_link_pos","font-size","font-style","font-weight","font-family","color","color-opacity","letter-spacing","hover-color","hover-color-opacity","current-font-size","current-font-style","current-font-weight","current-font-family","current-color","current-color-opacity","current-letter-spacing","background-color","background-color-opacity","hover-background-color","hover-background-color-opacity","current-background-color","current-background-color-opacity","border-radius","border-width","border-color","border-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","current-border-radius","current-border-width","current-border-color","current-border-color-opacity"];return"default"!=e&&t["viewport_"+e]&&(r.a.each(b.b.viewport_fields[t.type]||b.b.viewport_fields_common,(function(i){if(("shape"!=t.type||"borders"!=i&&"weight"!=i&&"bg_color"!=i)&&!("background"==t.type&&"picture"==i||"text"===t.type&&3===t.version&&"blocks"===i)){if(n[i]=void 0,y.a.isGlobalKey(i)){var a=y.a.getGlobalPrefixedKey(i);n[a]=void 0}n[i]="button"===t.type&&!r.a.has(t["viewport_"+e],i)&&o.includes(i)?t[i]:void 0}})),r.a.extend(i,n,r.a.omit(t["viewport_"+e],["_id","modelType"]))),t.is_global&&y.a.fillUniqueValues(i,this._id,{}),i},getWidgetById:function(t){return r.a.findWhere(this.widgets,{_id:t})},getWidgetDataById:function(t){return r.a.findWhere(this.widgetsData,{_id:t})},signalOnLoading:function(){var t=this.widgets.length,e=this,i={};function n(){t--,clearTimeout(i[this._id]),"background"==this.type&&e.destroyLQBackground({animate:!0}),this.hasLoadAnimation()&&(e._widgetsWithLoadAnimation--,e._widgetsWithLoadAnimation||(e.loadAnimationsReady=!0,e.trigger("loadAnimationsReady"))),t||(e.fireReadyTimeout=setTimeout(o,200)),e.trigger("loaded"+this._id)}function o(){e.loaded=!0,e.trigger("pageLoaded")}r.a.each(this.widgets,(function(t){RM.screenshot&&(i[t._id]=setTimeout((function(){t.widgetIsLoaded()}),2e4)),t.on("loaded",n,t)}),this),this.BGWidget&&this.hasVideoBG&&this.BGWidget.on("videoBGStarted",(function(){e.videoBGStarted=!0,r.a.delay((function(){e.trigger("videoBGStarted")}),1300)}),this.BGWidget),0==t&&(this.fireReadyTimeout=setTimeout(o,200))},getFontsVariations:function(t,e){var i=f.a.getUsedFontsFromWidgetsModels({includeCustom:!0,customList:r.a.filter(this.mag.edit_params.fonts,{provider:"custom"}),models:t,excludeUnusedDefault:e,activeViewports:[this.getPageViewport()]}),n=[];return r.a.each(i,(function(t){for(var e=0;e<t.used_variations.length;e++)n.push({fontFamily:t.css_name,fontWeight:100*(t.used_variations[e].substr(1,1)-0),fontStyle:"n"==t.used_variations[e].substr(0,1)?"normal":"italic"})})),n},addFontsToLoad:function(t,e){if(this._widgetsWithFontsToLoad.push(t),this._onFontsLoad.push(e),this._fontLoaderCalled++,this._fontLoaderCalled==this._widgetsWithFontsCount){var i=this.getFontsVariations(this._widgetsWithFontsToLoad);if(r.a.isEmpty(i))return void this.onAllFontsLoad();this._fontsToLoadLeft=i.length,r.a.each(i,r.a.bind((function(t){f.a.exactWaitForFontLoad(t.fontFamily,t.fontWeight,t.fontStyle,this.onOneFontLoad)}),this))}},onOneFontLoad:function(t,e,i,n){this._fontsToLoadLeft--,0==this._fontsToLoadLeft&&r.a.delay(this.onAllFontsLoad,500)},onAllFontsLoad:function(){r.a.each(this._onFontsLoad,(function(t){t&&t()}))},updateViewport:function(){var t=this.getPageViewport();t!=this.pageViewport&&(this.pageViewport=t,this.createLQBackground(),this.shown&&(this.loadAnimationsReady=!1,this.createWidgetsForCurrentViewport(),this.started&&(this.started=!1,this.start())))},waitForAnimationEnd:function(t){this.resetWaitHook=h.default.waitForTransitionEnd(this.$el,this.mag.getPageTransitionTime()+1e3,"transform",t)},resetWaitForAnimationEnd:function(){this.resetWaitHook&&this.resetWaitHook()},backToTop:function(){this.scrollTo(0)},scrollTo:function(t){this.$scrollWrapper.finish(),this.$scrollWrapper&&this.$scrollWrapper.animate({scrollTop:t},500)},focusPage:function(){k.a.isDesktop&&"vertical"!=this.viewerType&&0==this.$el[0].getBoundingClientRect().left&&(this.$content.focus(),this.mag.$el.scrollTop(0))},markAsLast:function(){this.lastPage=!0,this.$el.addClass("last")},isLastPage:function(){return!!this.lastPage},isBottomArrowVisible:function(){return!this.wasScrolled&&this.scrollable},scrollPageALittle:function(){this.$scrollWrapper.animate({scrollTop:Object(n.a)(window).height()/2},500)},getPageViewport:function(){var t=this.mag.viewport,e=this;if("default"==t||RM.screenshot)return"default";if(this["viewport_"+t]&&this["viewport_"+t].enabled)return t;var i=r.a.findWhere(b.b.viewports,{name:t}).width,n=r.a.reduce(b.b.viewports,(function(t,n,o){return("default"==n.name||e["viewport_"+n.name]&&e["viewport_"+n.name].enabled)&&Math.abs(n.width-i)<=Math.abs(b.b.viewports[t].width-i)?o:t}),0);return b.b.viewports[n].name},onResize:function(t){if(t=t||{},this.shown||"horizontal"!=this.viewerType){var e=this.mag.getContainerSizeCached(),i=this.mag.getViewportWidth(this.pageViewport),n=b.b.dictionary[this.pageViewport].width,o=this.mag.getScale(this.pageViewport),a=this["viewport_"+this.pageViewport]&&this["viewport_"+this.pageViewport].height||this.height,r={width:n,height:a,scaledWidth:Math.round(i*o),scaledHeight:Math.round(a*o),scale:o},s=RM.screenshot&&"true"===h.default.queryUrlGetParam("pdf"),l=Math.min(r.scaledWidth,e.width),c=r.scaledHeight,d=s?0:Math.max(((RM.screenshot?672:e.height)-c)/2,0),u=Math.max(((RM.screenshot?1024:e.width)-l)/2,0)+(i-n)/2,m={width:r.width,height:r.height,top:d/(p.a.isCSSZoom()&&p.a.isDesktopDefault(this.pageViewport)?p.a.downscaleEnabled?o:Math.max(o,1):1),left:u};if((o>=1||p.a.downscaleEnabled)&&p.a.isOn(this.pageViewport,i,this.mag.opts)&&p.a.isCSSZoom()&&(m.zoom=o,m.left=(i-n)/2),this.$content.removeAttr("style"),this.$content.css(m),this.contentPosition={left:u,top:d},1===p.a.normalize(o,"transform",this.pageViewport,i,this.mag.viewOpts)?h.default.applyTransform(this.$content,""):(h.default.applyTransform(this.$content,"scale("+r.scale+")"),p.a.isDesktopDefault(this.pageViewport)?this.$content.css({left:Math.max((e.width-l)/2,0)+(i-n)/2*r.scale}):this.$content.css({left:(i-n)/2*r.scale})),this.contentHeight=a,this.pageHeight=Math.max(e.height,Math.round(a*o)),this.pageBgHeight=e.height,this.pageWidth=i,"vertical"==this.viewerType&&this.isStickyVerticalViewer&&this.$el.css({height:this.pageHeight,top:t.absolutePosition}),this.scale=o,this.$contentBounds.css({width:e.width,height:this.pageHeight}),null!=this.prevScale&&this.prevScale!=this.scale){if(this.animations){var g,f=null===(g=this.animations.animations)||void 0===g?void 0:g.filter((function(t){return w.a.video.findPlayingVideo(t.widgets)}));this.animations.updateTimelines(f.map((function(t){return t.animation.UUID})))}p.a.isOnForRatio(this.pageViewport,this.scale,this.mag.opts)&&this.animations&&(this.animations.resetStarted(),this.animations.start.__debounced())}return this.animations&&this.animations.onResize(),this.trigger("resize",{containerSize:e,contentPosition:this.contentPosition}),this.scrollable=Math.round(a*o)-this.mag.SCROLLABLE_TRESHOLD>e.height,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.top=-d,this.visibleWidgetsCoords.bottom=-d+e.height,this.visibleWidgetsCoords.scale=o,this.resizeLQBackground(),this.prevScale=this.scale,this.pageHeight}},onScroll:function(){this.wasScrolled=!0,this.mag.recalcBottomArrowState(this),this.visibleWidgetsCoords=this.visibleWidgetsCoords||{},this.visibleWidgetsCoords.scrollTop=this.$scrollWrapper.scrollTop(),this.mag.onCurrentPageScroll(this,this.visibleWidgetsCoords.scrollTop),this.animations&&this.animations.onScroll(),this.trigger("page scroll",this.visibleWidgetsCoords.scrollTop)},isCurrent:function(){return this.num===this.mag.currentPage.num},createLQBackground:function(){if(!RM.screenshot){var t=this.getWidgetViewportData(r.a.findWhere(this.widgetsData,{type:"background"}),this.pageViewport);if(this.LQBG){if("picture"===t.selectedType&&"picture"===this.LQBG.selectedType&&t.picture&&this.LQBG.picture&&t.picture.poorUrl===this.LQBG.picture.poorUrl||"video"===t.selectedType&&"video"===this.LQBG.selectedType&&t.video&&this.LQBG.video&&t.video.thumbnail_url===this.LQBG.video.thumbnail_url)return void this.resizeLQBackground();this.destroyLQBackground({animate:!1})}if(this.$fixedBgContainer.css("background-color","#"+t.color),t.picture&&"picture"===t.selectedType&&(t.picture.poorUrl||u.a.useLambdaUrl(t.picture))||t.video&&"video"===t.selectedType&&t.video.thumbnail_url){this.LQBG=r.a.extend({},t);var e=j["template-viewer-widget-background"];if(this.LQBG.$el=Object(n.a)(e({data:t})),this.LQBG.$el.addClass("low-quality").appendTo(this.$fixedBgContainer),"picture"===this.LQBG.selectedType){var i=this.LQBG.picture.poorUrl;u.a.useLqipUrl(t.picture)&&(i=u.a.getLqipUrl(this.LQBG.picture),this.LQBG.$el.addClass("lqip").appendTo(this.$fixedBgContainer)),Object(n.a)("<img/>").on("load",r.a.bind((function(){this.LQBG&&this.LQBG.$el.find(".picture-background").css({"background-image":"url(".concat(i,")")})}),this)).attr("src",i)}if("video"===this.LQBG.selectedType){var o=this.LQBG.video.thumbnail_url.replace("http://","https://"),a=Object(n.a)("<img/>").addClass("poster").css("opacity",0).appendTo(this.LQBG.$el.find(".video-background .video-container"));a.on("load",r.a.bind((function(){a.css({width:"",height:""}).css("opacity",1);var t=a[0].width,e=a[0].height;this.LQBG&&!this.LQBG.video.aspect_poster&&(this.LQBG.video.aspect_poster=t/e),this.resizeLQBackground()}),this)).attr("src",o)}}}},resizeLQBackground:function(){!RM.screenshot&&this.LQBG&&"video"===this.LQBG.selectedType&&v.a.setVideoPosition({mag:this.mag,$container:this.LQBG.$el.find(".video-background .video-container"),$media:this.LQBG.$el.find(".video-background .video-container .poster"),provider:this.LQBG.video.provider_name,aspect_poster:this.LQBG.video.aspect_poster,aspect_real:this.LQBG.video.aspect_real,controls_remove:!0})},destroyLQBackground:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!RM.screenshot&&this.LQBG){t.animate=t.animate&&"picture"===this.LQBG.selectedType&&this.started;var e=this.LQBG.$el;this.LQBG=null,t.animate?(e.css("opacity",0),setTimeout((function(){e.remove()}),400)):e.remove()}},fixSafariScroll:function(t){Modernizr.safari&&k.a.isDesktop&&(0!==this.$scrollWrapper.scrollTop()&&this.$scrollWrapper.scrollTop(0))}},{getScreenIndex:function(t,e,i,n){var o,a=Math.floor((t.y-e)/i),r=Math.ceil((t.y+t.h-e)/i)-1;return n&&t.canRenderImmediately()?o=1/0:t.hasLoadAnimation()||a<=0&&r>=0?o=0:a>0?o=a:r<0&&(o=r),{start:a,end:r!==1/0?r:0,index:o}}});e.a=P},"38uW":function(t,e,i){"use strict";i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return s})),i.d(e,"b",(function(){return l}));var n=i("fueH"),o=i("w5C2"),a="lineHeight",r=function(t){var e=t.editorState,i=t.block,o=n.a.getBlockData({editorState:e,block:i,key:a});return"number"==typeof o?o:void 0},s=function(t){var e=t.block,i=t.editorState,o=t.lineHeight;return n.a.setBlockData({editorState:i,block:e,key:a,value:o})},l=function(t){var e=t.editorState,i=t.method,n=r({editorState:e}),a="number"==typeof n?n:o.b.lineHeight;if(8!==n)return"increase"===i?s({editorState:e,lineHeight:a+1}):"decrease"===i?s({editorState:e,lineHeight:Math.max(8,a-1)}):void 0}},"3ES5":function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("w5C2"),l=i("8Tds"),c=i("za5s"),d=i("ICos"),h=i("pFlR"),u=i("v92f"),p=Object(n.e)(r.B).withConfig({displayName:"TextBase___StyledFlex"})(["--editor-border-color:",";direction:",";overflow:",";"," & > div{","}.public-DraftEditor-content{white-space:normal !important;overflow-wrap:break-word;}.text-viewer{overflow-wrap:break-word;white-space:normal;}"," & div[data-contents='true'],.text-viewer{font-feature-settings:'liga' 0,'rlig' 0,'dlig' 0,'hlig' 0,'smcp' 0;font-family:",";font-weight:",";font-style:",";font-size:","px;line-height:","px;-webkit-nbsp-mode:normal;-webkit-line-break:after-white-space;white-space:pre-wrap;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5}),(function(t){return t._css6}),(function(t){return t._css7}),(function(t){return t._css8}),(function(t){return t._css9}),(function(t){return t._css10}),(function(t){return t._css11})),m=function(t,e){var i=t.textDirection,n=t.autosize,o=t.columns,r=t.verticalAlign,m=t.bgColor,g=t.shouldShowSelectionBorder,f=t.scale,v=t.viewport,b=t.viewerOptions,y=t.children,_=t.useBaseline,w=m?Object(d.f)(m):void 0,k=w?"rgba(".concat(w.r,", ").concat(w.g,", ").concat(w.b,", ").concat(w.a,")"):void 0;return a.a.createElement(p,{ref:e,height:!n||o&&o.count>1?"100%":"auto",flexDirection:"column",justifyContent:r&&r!==l.d.top?"flex-end":"flex-start",bg:k,_css:g?Object(c.themeGet)("colors.blue"):"transparent",_css2:i,_css3:o&&o.count>1||!n?"hidden":"visible",_css4:f&&h.a.isOnForRatio(v||u.a.Default,f,b||{})&&h.a.isCSSZoom()?"\n              width: ".concat("".concat(1/f*100,"%"),";\n              height: ","".concat(1/f*100,"%"),";\n              zoom: ",1/f,";\n              transform: ","scale(".concat(f,")"),";\n              transform-origin: left top;\n            "):"",_css5:o&&o.count>1&&"\n            min-height: 100%;\n            column-fill: auto;\n            column-count: ".concat(o.count,";\n            column-gap: ").concat(o.gap,"px;\n          "),_css6:_?"":"\n          .text-viewer span,\n          .text-viewer a,\n          & div[data-contents='true'] span,\n          & div[data-contents='true'] a {\n            line-height: inherit;\n            vertical-align: top;\n          }\n        ",_css7:s.b.fontFamily,_css8:s.b.fontWeight,_css9:s.b.fontStyle,_css10:s.b.fontSize,_css11:s.b.lineHeight},y)};e.a=a.a.forwardRef(m)},"3Qzt":function(t,e,i){"use strict";e.a={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}}},"3TY3":function(t,e,i){"use strict";i.r(e);var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("zn5y"),l=i.n(s),c=i("8AXF"),d=i("xG9w");function h(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=window.requestIdleCallback||function(t){Object(d.defer)(t)},m=function(){function t(e,i){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.imageInstances=[],this.imagesLoaded=0,this.isLoading=!1,this.areAllImagesLoaded=!1,this.seekCallbackData=void 0,Object(d.range)(1,i+1).map((function(t){return function(t,e){return"".concat(t,"/").concat(e.toString().padStart(6,"0"),".jpg")}(e,t)})).forEach((function(t){n.imageInstances.push({image:new Image,isLoaded:!1,url:t})}))}var e,i,n,o,a;return e=t,(i=[{key:"preloadFirstImage",value:function(){this.loadImage(0)}},{key:"loadImage",value:function(t){var e=this,i=this.imageInstances[t];i&&!i.isLoaded&&(i.image.onload=function(){i.isLoaded=!0,e.imagesLoaded++,e.imageInstances.length===e.imagesLoaded&&(e.areAllImagesLoaded=!0,e.isLoading=!1,console.log("All ".concat(e.imageInstances.length," images loaded."))),e.seekCallbackData&&e.seekCallbackData.index===t&&(e.seekCallbackData.callback(i.image),e.seekCallbackData=void 0)},p((function(){i.image.src=i.url})))}},{key:"startLoad",value:function(){var t=this;if(!this.isLoading){this.areAllImagesLoaded=!1,this.isLoading=!0;for(var e=[0],i=Math.ceil(Math.log(this.imageInstances.length)/Math.log(2)),n=1;n<=i;n++)for(var o=Math.pow(2,n),a=Math.ceil(this.imageInstances.length/o),r=1;r<=o;r++){var s=r*a;e.push(s)}(e=Object(d.uniq)(e).filter((function(e){return e<t.imageInstances.length}))).forEach((function(e){return t.loadImage(e)}))}}},{key:"stopLoad",value:function(){this.isLoading&&(this.imageInstances.forEach((function(t){t.isLoaded||p((function(){t.image.onload=null,t.image.src=""}))})),this.isLoading=!1)}},{key:"seekImageByIndex",value:(o=regeneratorRuntime.mark((function t(e){var i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.seekCallbackData&&(this.seekCallbackData.callback(void 0),this.seekCallbackData=void 0),i=e,t.abrupt("return",new Promise((function(t){e>n.imageInstances.length-1&&(i=n.imageInstances.length-1),e<0&&(i=0);var o=n.imageInstances[i];if(o.isLoaded)return t(o.image);n.seekCallbackData={index:i,callback:t}})));case 3:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(i,n){var a=o.apply(t,e);function r(t){h(a,i,n,r,s,"next",t)}function s(t){h(a,i,n,r,s,"throw",t)}r(void 0)}))},function(t){return a.apply(this,arguments)})},{key:"getImageIndexByTimelinePercent",value:function(t){return Math.floor(this.imageInstances.length*t)}},{key:"getNumberOfImages",value:function(){return this.imageInstances.length}}])&&u(e.prototype,i),n&&u(e,n),t}(),g=i("fEUr"),f=i("LDvm"),v=i("f3SV"),b=i("QuYs"),y=i("tf3M"),_=i("3Qzt");function w(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var k,S=Math.floor(25);!function(t){t[t.Precise=0]="Precise",t[t.Lazy=1]="Lazy"}(k||(k={}));var x=window.requestAnimationFrame||function(t){Object(d.defer)(t)},C=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.easingType=k.Lazy,this.lastEasingCallTime=0,this.lastTargetIndex=0,this.canvas=e,this.imageLoader=i,this.easingType=n}var e,i,n;return e=t,(i=[{key:"drawImageByIndex",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return i?this.startEasingSequence(t):this.imageLoader.seekImageByIndex(t).then((function(i){return e.drawImage(i,t)}))}},{key:"drawImageByTimelinePercent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.imageLoader.getImageIndexByTimelinePercent(t);return this.drawImageByIndex(i,e)}},{key:"drawImage",value:function(t,e){var i=this;return new Promise((function(n,o){if(!t||e===i.lastDrawnFrameIndex)return n();var a,r,s=i.canvas.getContext("2d");if(!s)return o(new Error("Cannot find context to paint on"));var l=0,c=0,d=t.height/t.width;i.canvas.height/i.canvas.width>d?(a=i.canvas.height/d,r=i.canvas.height,l=(i.canvas.width-a)/2):(a=i.canvas.width,r=i.canvas.width*d,c=(i.canvas.height-r)/2),x((function(){s.drawImage(t,0,0,t.width,t.height,l,c,a,r),i.lastDrawnFrameIndex=e,n()}))}))}},{key:"startEasingSequence",value:function(t){var e=this;clearInterval(this.easingSequenceId);var i=this.lastDrawnFrameIndex||0;return new Promise((function(n){var o=Date.now(),a=o-e.lastEasingCallTime,r=Math.abs(e.lastTargetIndex-t)/a,s=Math.round(r/a*e.imageLoader.getNumberOfImages()*2),l=Math.min(Math.round(.05*e.imageLoader.getNumberOfImages()),S,e.easingType===k.Precise?s:Math.ceil(400/a));e.lastEasingCallTime=o,e.lastTargetIndex=t;var c=t-i,d=t-Math.sign(c)*Math.min(l,Math.abs(t-i)),h=t-d,u=o,p=u+400;e.drawImageByIndex(d),e.easingSequenceId=setInterval((function(){var t=Date.now();if(t>p)return clearInterval(e.easingSequenceId),e.easingSequenceId=void 0,n();var i=(t-u)/400,o=_.a.easeOutCubic(i),a=Math.round(h*o)+d;e.drawImageByIndex(a)}),16)}))}}])&&w(e.prototype,i),n&&w(e,n),t}();function O(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function j(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function P(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function E(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return I(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return I(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var T=window.devicePixelRatio||1,M={top:1,center:.5,bottom:0},$=a.a.createContext({model:{pageScale:1,pageContentTop:0,magContainerHeight:0,widgetBoxTop:0,isStarted:!1,canBeUsed:!0,isSelected:!1}}),A=[{},function(){}],R=Object(n.e)(r.v).withConfig({displayName:"Shots___StyledCover"})(["background-repeat:no-repeat;label{position:absolute;cursor:default;z-index:1001;width:100%;height:100%;}"]),D=Object(n.e)(r.A).withConfig({displayName:"Shots___StyledFileInput"})(["position:absolute;z-index:1001;"]),B=Object(n.e)(r.B).withConfig({displayName:"Shots___StyledFlex"})(["transform:translate(-50%,-50%);"]),L=Object(n.e)("canvas").withConfig({displayName:"Shots___StyledCanvas"})({objectFit:"cover"}),z=function(t){var e=Object(o.useContext)(c.BackboneContext),i=e.model,n=i._id,s=i.w,d=i.h,h=i.basePath,u=i.numberOfImages,p=i.scrollSpeed,_=void 0===p?1:p,w=i.imageWidth,S=void 0===w?0:w,x=i.imageHeight,I=void 0===x?0:x,z=i.fixed_position,F=i.scrollStartPoint,U=void 0===F?g.c.bottom:F,N=i.playbackType,H=i.startPointOffset,V=i.scrollDelay,W=i.is_full_width,G=i.is_full_height,q=i.useEasing,K=void 0!==q&&q,Y=e.modelSave,X=Object(o.useContext)($),Z=X.model,J=Z.currentScrollOffset,Q=Z.hoverPercent,tt=Z.pageScale,et=void 0===tt?1:tt,it=Z.viewport,nt=Z.canDirectLinkBeUsed,ot=Z.pageContentTop,at=void 0===ot?0:ot,rt=Z.magContainerHeight,st=void 0===rt?0:rt,lt=Z.widgetBoxTop,ct=void 0===lt?0:lt,dt=Z.isStarted,ht=void 0!==dt&&dt,ut=(Z.canBeUsed,Z.isSelected,X.model),pt=E(t.useSharedState?t.useSharedState():A,2),mt=pt[0],gt=mt.isUploading,ft=mt.videoFile,vt=mt.url,bt=pt[1],yt="viewer"===t.mode,_t=E(Object(o.useState)(!1),2),wt=_t[0],kt=_t[1],St=Object(o.useRef)(null),xt=Object(o.useRef)(null),Ct=xt.current,Ot=Object(o.useRef)(null),jt=Ot.current,Pt=Object(o.useRef)(null),Et=Object(r.Yb)(Pt);Et.width,Et.height;Object(o.useEffect)((function(){h&&u&&(xt.current=new m(h,yt?u:1),xt.current.preloadFirstImage(),Ot.current=new C(St.current,xt.current,N===g.b.hover?k.Lazy:k.Precise),Ot.current.drawImageByIndex(0).then((function(){t.onFirstFrameLoaded&&t.onFirstFrameLoaded()})))}),[h]);var It=E(Object(o.useState)(null),2),Tt=It[0],Mt=It[1];return Object(o.useEffect)((function(){if(Tt){Y(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?j(Object(i),!0).forEach((function(e){P(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({basePath:Tt.basePath,imageWidth:Tt.imageWidth,imageHeight:Tt.imageHeight,numberOfImages:Tt.numberOfImages,totalSize:Tt.totalSize},function(t,e){return t===y.default.prototype.defaults.w&&e===y.default.prototype.defaults.h}(s,d)?function(t,e){if(W||G)return{w:s,h:d};var i=t<=480?t:Math.round(480*t/t);return{w:i,h:e*i/t}}(Tt.imageWidth||s,Tt.imageHeight||s):{}))}}),[Tt]),Object(o.useEffect)((function(){var t=function(){var t,e=(t=regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,vt&&vt.length?Object(f.W)(vt,n):Object(f.V)(ft,n);case 3:(e=t.sent)&&e.basePath&&e.imageHeight&&e.imageWidth&&e.numberOfImages&&e.totalSize&&!ut.isDestroyed&&!wt?(Mt({basePath:e.basePath,imageWidth:e.imageWidth,imageHeight:e.imageHeight,numberOfImages:e.numberOfImages,totalSize:e.totalSize}),bt({isUploading:!1}),b.d.sendEvent(b.b.ShotsWidgetActions,{eventLabel:"Video ".concat(vt&&vt.length?"link pasted":"file uploaded")})):bt({isUploading:!1,uploadError:"Error uploading video"}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),bt({isUploading:!1,uploadError:"Error uploading video"});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){O(a,n,o,r,s,"next",t)}function s(t){O(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(){return e.apply(this,arguments)}}();gt&&!ut.isDestroyed&&t()}),[gt]),Object(o.useEffect)((function(){yt&&xt.current&&(ht?xt.current.startLoad():xt.current.stopLoad())}),[ht]),Object(o.useEffect)((function(){var t;if(Ct)if(yt)if(void 0!==J)t=function(t){var e=t.currentScrollOffset,i=t.pageContentTop,n=t.pageScale,o=t.magContainerHeight,a=t.widgetBoxTop,r=t.scrollStartPoint,s=t.startPointOffset,l=t.scrollSpeed,c=t.scrollDelay,d=i/n,h=o/n,u=e/n;if(t.isFixed)return Math.round((u-c)*l/10);var p=a+d,m=p-h,g=M[r]*(p-m)+m+s;return Math.round((u-g)*l/10)}({currentScrollOffset:J,pageContentTop:at,pageScale:et,magContainerHeight:st,widgetBoxTop:ct,scrollStartPoint:U,startPointOffset:H,scrollSpeed:_,scrollDelay:V,isFixed:!!z}),null==jt||jt.drawImageByIndex(t,K);else{if(void 0===Q)return;null==jt||jt.drawImageByTimelinePercent(Q,K)}else null==jt||jt.drawImageByIndex(0)}),[J,it,s,d,Q]),Object(o.useEffect)((function(){return bt({canDirectLinkBeUsed:nt}),t.onFirstRender&&t.onFirstRender(),function(){kt(!0)}}),[]),a.a.createElement(R,{alignItems:"center",justifyContent:"center",bg:"constructor"!==t.mode||h?"transparent":"lightGray",backgroundImage:h?"":"constructor"===t.mode?"url(".concat(l.a,")"):"",width:"100%",height:"100%",backgroundPosition:"center",ref:Pt},"constructor"===t.mode&&a.a.createElement(D,{id:"rm-shots-widget-file-upload-".concat(n),onClick:function(t){t.preventDefault()},readFileData:!1,onChange:function(t){t.size<=v.a.UPLOAD_SHOTS_SIZE_LIMIT&&bt({videoFile:t,isUploading:!0})},dropFile:!gt,accept:"video/*,.mkv"}),gt&&a.a.createElement(B,{position:"absolute",top:"50%",left:"50%",cursor:"default"},a.a.createElement(r.Q,{bgColor:"gray",size:"big"})),a.a.createElement(L,{id:n,width:"constructor"===t.mode?S:Math.min(S,Math.floor(s*T)),height:"constructor"===t.mode?I:Math.min(I,Math.floor(d*T)),ref:St,style:{userSelect:"none",width:"100%",height:"100%"}},"Your browser does not support Canvas element")," ")};i.d(e,"Shots",(function(){return z})),i.d(e,"ShotsStateContext",(function(){return $}))},"3XvJ":function(module,exports){module.exports={"template-viewer-widget-button":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <div class="text">'+(null==(__t=data.text)?"":_.escape(__t))+"</div>\n";return __p}}},"3dGj":function(t,e,i){"use strict";var n=i("rH4x");i.n(n).a},"3uGt":function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("xi34"),s=i("iC7s"),l=i("za5s"),c=i("lU33"),d=i("T6+y"),h=i.n(d),u=i("OTSC"),p=i("f3SV"),m=function(t){var e=t.activeLink,i=t.size;return(a.a.createElement("svg",{width:"80",height:"80",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 80 80",preserveAspectRatio:"xMidYMid meet",style:{height:"".concat(i,"px"),width:"".concat(i,"px")}},a.a.createElement("g",{fill:"none",fillRule:"evenodd"},a.a.createElement("circle",{fill:e?"#000000":"#ec520b",fillRule:"nonzero",cx:"40",cy:"40",r:"40"}),a.a.createElement("path",{d:"M57.746 59.179v-6.216c0-1.24-.678-1.863-1.801-1.863-1.334 0-2.433.99-2.48 2.191v5.88h-2.254v-6.215c0-1.24-.678-1.864-1.801-1.864-1.334 0-2.433.99-2.48 2.191v5.88h-2.254v-9.717h2.028l.226.827.11.101.108-.101c.453-.624 1.576-1.037 2.48-1.037 1.622 0 2.792.64 3.385 1.653l.561-.624c.562-.624 1.692-1.037 2.59-1.037 2.48 0 3.836 1.45 3.836 3.517v6.418h-2.254v.016zM23.442 28.913h-.414v6.707h-2.215V20h5.381c2.418 0 4.539 1.606 4.539 4.383 0 2.674-2.262 4.382-4.68 4.382l4.976 6.418v.43h-2.526l-5.061-6.7zm2.877-2.214c1.217 0 2.332-.85 2.332-2.23s-1.115-2.23-2.332-2.23h-3.244v4.46h3.244z",stroke:"#FFF",strokeWidth:".2",fill:"#FFF"}),a.a.createElement("path",{d:"M20.116 58.672l38.23-38.23 1.213 1.211-38.23 38.23-1.213-1.211z",stroke:"#FFF",strokeWidth:".6",fill:"#FFF"}))))},g=i("8AXF"),f=i("I0kf");function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var y=v(s.Tb,1)[0],_=p.a.readymag_host,w=p.a.readymag_auth_host,k=Object(n.e)(s.m).withConfig({displayName:"HeaderMobile___StyledBox"})(["display:block;text-decoration:none;pointer-events:",";"],(function(t){return t._css})),S=Object(n.e)(s.Cb).withConfig({displayName:"HeaderMobile___StyledText"})(["&:hover{color:",";}"],(function(t){return t._css2})),x=function(t){var e=t.label,i=t.url,n=t.active;return(a.a.createElement(k,{as:"a",mb:40,href:i,_css:n?"none":"all"},a.a.createElement(S,{lineHeight:"1",letterSpacing:"-2.4px",fontFamily:"Graphik",fontWeight:400,fontSize:32,color:n?"tomato":"#000",_css2:Object(l.themeGet)("colors.tomato")},e)))},C=Object(n.e)(s.m).withConfig({displayName:"HeaderMobile___StyledBox2"})([".constructor:not(.preview) &{display:none !important;}"]),O=Object(n.e)(s.B).withConfig({displayName:"HeaderMobile___StyledFlex"})(["transform:translateX(",");transition:transform 0.3s ease-in-out;overflow:scroll;-webkit-overflow-scrolling:touch;"],(function(t){return t._css3})),j=function(t){var e=t.activeLink,i=t.isAuthorized,n=v(Object(o.useState)(!1),2),r=n[0],l=n[1];return a.a.createElement(c.a,{query:"(min-width: ".concat(y,")")},(function(t){return t?a.a.createElement(a.a.Fragment,null):a.a.createElement(C,null,a.a.createElement(s.m,{position:"fixed",top:"0",right:"0",m:"6px 6px",zIndex:99999999},a.a.createElement(s.m,{as:"button",width:48,height:48,bg:"#fff",borderRadius:"50%",border:"none",p:"0",display:"inline-block",onClick:function(){return l(!r)}},a.a.createElement(s.B,{justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},a.a.createElement(s.Hb,null)))),a.a.createElement(O,{alignItems:"center",width:"100vw",height:"100vh",position:"fixed",zIndex:9999999,top:"0",left:"0",bg:"#fff",_css3:r?"0":"100%"},a.a.createElement(s.m,{width:"100%",p:"68px 20px"},a.a.createElement(x,{label:"Features",url:"".concat(_,"/features"),active:e===I.features}),a.a.createElement(x,{label:"Pricing",url:"".concat(_,"/pricing"),active:e===I.pricing}),a.a.createElement(x,{label:"Examples",url:"".concat(_,"/examples"),active:e===I.examples||e===I.explore}),a.a.createElement(x,{label:"Learn",url:"".concat(_,"/learn"),active:e===I.learn}),i?a.a.createElement(x,{label:"Log out",url:Object(f.a)("authorization.newFlow")?"".concat(w,"/auth/logout"):"".concat(w,"/logout")}):a.a.createElement(x,{label:"Join or Log in",url:"".concat(_,"/join")}))))}))};function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return E(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return E(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}i.d(e,"b",(function(){return T})),i.d(e,"a",(function(){return I}));var I,T=a.a.createContext({}),M=Object(n.e)(s.Cb).withConfig({displayName:"Header___StyledText"})(["text-decoration:none;&:hover{color:",";}.text-on-dark &{color:#fff;&:hover,&.active{color:",";}}.white-theme.scrolled &{color:#000 !important;&:hover,&.active{color:"," !important;}}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3})),$=function(t){var e=t.label,i=t.url,n=t.active,o=t.last;return(a.a.createElement(s.m,{mr:o?void 0:16,display:"inline-block"},a.a.createElement(M,{as:"a",href:i,fontFamily:"Graphik",fontWeight:400,fontSize:16,lineHeight:"24px",letterSpacing:"-0.1px",color:n?"tomato":"#000",onClick:function(t){window.location.href.replace(/\/$/,"")===i.replace(/\/$/,"")&&(t.preventDefault(),Object(r.a)("html").animate({scrollTop:0},300))},_css:Object(l.themeGet)("colors.tomato"),_css2:Object(l.themeGet)("colors.tomato"),_css3:Object(l.themeGet)("colors.tomato")},e)))},A=Object(n.e)(s.m).withConfig({displayName:"Header___StyledBox"})(["display:inline-flex;outline:none;text-decoration:none;&:hover{color:#fff;background-color:",";}"],(function(t){return t._css4})),R=function(t){var e=t.label,i=t.url,n=t.onClick;return(a.a.createElement(A,{as:"a",onClick:n,bg:"rgba(244, 244, 244, 0.96)",borderRadius:200,href:i,width:100,height:40,textAlign:"center",color:"#000",alignItems:"center",justifyContent:"center",_css4:Object(l.themeGet)("colors.tomato")},a.a.createElement(s.Cb,{fontFamily:"Graphik",fontSize:16,fontWeight:400,letterSpacing:"-0.1px"},e)))},D=[64,96,128,192,256],B=function(t,e){var i=t.split(".").pop(),n=function(t){var e=2*t;return D.reduce((function(t,i){return e<=i&&e>t?i:t}),D[0])}(e);return t&&n?t.replace(".".concat(i),"_".concat(n,".").concat(i)):""},L=P(s.Tb,1)[0];!function(t){t.features="features",t.pricing="pricing",t.explore="explore",t.examples="examples",t.learn="learn"}(I||(I={}));var z=Object(n.e)(s.B).withConfig({displayName:"Header___StyledFlex"})(["cursor:default;"]),F=Object(n.e)(s.v).withConfig({displayName:"Header___StyledCover"})(["background-repeat:no-repeat;text-decoration:none;"]),U=Object(n.e)(s.Cb).withConfig({displayName:"Header___StyledText2"})(["text-transform:uppercase;"]),N=Object(n.e)(s.m).withConfig({displayName:"Header___StyledBox2"})(["font-size:0;"]);e.c=function(t){var e=t.activeLink,i=p.a.readymag_host,n=p.a.readymag_auth_host,r=Object(o.useContext)(g.BackboneContext).model,l=Object(o.useContext)(T).model,d=r?r.activeLink:e,v=h()({bindTo:document&&document.getElementById("rm-header-mobile-portal")}).Portal,b=P(Object(o.useState)(!1),2),y=b[0],_=b[1],w=P(Object(o.useState)(""),2),k=w[0],S=w[1],x=P(Object(o.useState)(""),2),C=x[0],O=x[1];Object(o.useEffect)((function(){u.default.loadLoggedUser((function(t){t&&Object.keys(t).length&&(_(!0),S(t.name),t.pic&&O(B(t.pic,48)))}))}),[]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(c.a,{query:"(min-width: ".concat(L,")")},(function(t){var e=l?l.isDesktop:t;return(a.a.createElement(s.m,{position:"fixed",width:"100%",zIndex:99999},a.a.createElement(z,{height:"100%",width:"100%",alignItems:"center",justifyContent:"space-between",p:e?16:"6px 6px"},y?a.a.createElement(s.m,{height:e?40:48,width:e?"100%":"auto",display:"inline-block"},a.a.createElement(F,{as:"a",href:n,alignItems:"center",justifyContent:"center",bg:C?"transparent":"lightGray",height:e?40:48,width:e?40:48,backgroundImage:C?"url(".concat(C,")"):void 0,borderRadius:"50%",backgroundSize:"cover",backgroundPosition:"center","aria-label":"Profile"},a.a.createElement(U,{fontWeight:400,fontSize:16,lineHeight:1.25,letterSpacing:"-0.04px",fontFamily:"Graphik"},C?"":function(){if(!k)return"";var t=P(k.split(" "),2),e=t[0],i=t[1];return i?e[0]+i[0]:e[0]}()))):a.a.createElement(s.m,{height:e?40:48,width:"100%"},a.a.createElement(s.m,{as:"a",href:i,height:e?40:48,display:"inline-block"},a.a.createElement(m,{size:e?40:48,activeLink:!!d}))),e&&a.a.createElement(a.a.Fragment,null,a.a.createElement(s.m,{textAlign:"center",width:"100%"},a.a.createElement($,{label:"Features",url:"".concat(i,"/features"),active:d===I.features}),a.a.createElement($,{label:"Pricing",url:"".concat(i,"/pricing"),active:d===I.pricing}),a.a.createElement($,{label:"Examples",url:"".concat(i,"/examples"),active:d===I.explore||d===I.examples}),a.a.createElement($,{label:"Learn",url:"".concat(i,"/learn"),active:d===I.learn,last:!0})),a.a.createElement(N,{textAlign:"right",width:"100%"},y?a.a.createElement(R,{label:"Log out",url:Object(f.a)("authorization.newFlow")?"".concat(n,"/auth/logout"):"".concat(n,"/logout")}):a.a.createElement(a.a.Fragment,null,a.a.createElement(R,{label:"Join",url:Object(f.a)("authorization.newFlow")?"".concat(i,"/auth/join"):"".concat(i,"/join"),onClick:function(t){if(!Object(f.a)("authorization.newFlow"))return!0;t.preventDefault(),u.default.saveJoinData();var e=t.currentTarget;window.location.href=e.href}}),a.a.createElement(R,{label:"Log in",url:Object(f.a)("authorization.newFlow")?"".concat(i,"/auth/login"):"".concat(i,"/login")})))))))})),a.a.createElement(v,null,a.a.createElement(j,{activeLink:d,isAuthorized:y})))}},"4BoS":function(t,e,i){},"4m+J":function(module,exports){module.exports={"template-viewer-widget":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="rmwidget" data-id="'+(null==(__t=id)?"":_.escape(__t))+'"></div>\n';return __p}}},"4nGE":function(t,e,i){},"5BZr":function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("OTSC"),l=i("Fi5S"),c=a.a.View.extend({saveOnDeselect:!1,saveOnDestroy:!1,disabled:!1,initialize:function(t){this.initControl(t)},initControl:function(t){r.a.extend(this,t),r.a.bindAll(this),this.blocks&&(this.block=this.blocks[0])},render:function(){if(!this.rendered){if(this.rendered=!0,this.$container.append(this.$el),this.appearanceAnimation&&s.default.vueTransitionsShow(this.$el,"control"),this.$el.css("top",this.y),this.fromY!==this.y&&(this.$el.css({top:this.fromY}),window.requestAnimationFrame(r.a.bind((function(){this.$el.css({top:this.y})}),this))),this.template){var t=this.template({options:this.options});this.$el.append(t),this.$icon=this.$(".icon"),this.$panel=this.$(".panel"),this.$icon.on("click",this.onClick.bind(this))}return this.bindLogic(),Object(n.a)(window).on("keyup",this.onWindowKeyUp),this.setControlsStatusByBlockData(),this.block&&this.block.on("disabledControls:changed",this.onDisabledControlsChanged.bind(this)),this}},moveToNewPos:function(t){this.$el.css("top",t)},bindLogic:function(){},unBindLogic:function(){},onClick:function(){this.isOnClickDisabled()||(this.selected?this.master.deselect():this.$el.hasClass("disabled")||this.master.select(this))},makeModelSnapshot:function(){this._oldAttrs&&this._oldAttrs._id===this.model.attributes._id||(this._oldAttrs=this.model&&r.a.cloneWithObjects(this.model.attributes))},clearModelSnapshot:function(t){this.saveOnDeselect&&t&&this.canSave()&&this.save(),delete this._oldAttrs},select:function(){this.selected||(this.makeModelSnapshot(),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls")})),this.selected=!0,this.faded=!1,this.$el.removeClass("fade"),this.$el.addClass("checked"),this.showPanel(),this.$icon.addClass("rmalttext-disable"))},showPanel:function(){s.default.vueTransitionsShow(this.$panel,"panel"),l.a.trigger("panel:showed",this.name)},hidePanel:function(){var t=this;return s.default.vueTransitionsHide(this.$panel,"panel").then((function(){l.a.trigger("panel:hidden",t.name)}))},setEnabled:function(){this.$el.removeClass("disabled"),this.disabled=!1},setDisabled:function(){this.$el.addClass("disabled"),this.disabled=!0,this.selected&&this.master.deselect()},onDisabledControlsChanged:function(){this.setControlsStatusByBlockData()},setControlsStatusByBlockData:function(){this.block&&this.block.disabledControls&&(-1!==this.block.disabledControls.indexOf(this.name)?this.setDisabled():this.setEnabled())},isOnClickDisabled:function(){return this.disabled},fade:function(){this.deselect(),this.faded=!0,this.$el.addClass("fade")},removeFade:function(){this.faded=!1,this.$el.removeClass("fade")},deselect:function(){var t=this.selected;this.selected=!1,this.faded=!1,this.$el.removeClass("fade"),this.$panel&&(this.hidePanel().then(function(){this.$el.removeClass("checked")}.bind(this)),this.$icon.removeClass("rmalttext-disable"),this.clearModelSnapshot(t))},canSave:function(){return this.model&&this._oldAttrs&&!r.a.isEqual(this.model.attributes,this._oldAttrs)&&this.block&&(this.model.isGlobal()||!this.block.destroyed)},onEscKey:function(){this.selected&&this.master.deselect()},onEnterKey:function(){},onWindowKeyUp:function(t){t.keyCode===n.a.keycodes.esc&&this.onEscKey(),t.keyCode===n.a.keycodes.enter&&this.onEnterKey()},destroy:function(t){this.saveOnDestroy&&this.canSave()&&this.save(),this.unBindLogic(),Object(n.a)(window).off("keyup",this.onWindowKeyUp),this.block&&this.block.off("disabledControls:changed",this.onDisabledControlsChanged),this.$panel&&this.$panel.remove(),t?s.default.vueTransitionsHide(this.$el,"control").then(function(){this.$el.remove()}.bind(this)):this.$el.remove(),this.destroyed=!0},canControlBeClosed:function(){return!!this.selected&&(this.master.deselect(),!0)},getControlParam:function(t){var e=RM.constructorRouter.mag.edit_params.get("controls");if(e)return e[this.name]&&e[this.name][t]},saveControlParam:function(t){var e=RM.constructorRouter.mag.edit_params.get("controls"),i={};i[this.name]=t,e&&r.a.isEqual(e[this.name],t)||(this.paramsSaveXHR=RM.constructorRouter.mag.edit_params.save("controls",r.a.extend({},e,i)))},updatePanelVerticalPosition:function(){if(this.$panel||!this.$panel.length){var t=this.master.getControlsHeight(),e=this.$panel.height(),i=this.master.getControlRelativePosition(this),n=this.$el.height(),o="";e>=t?o=-Math.ceil((e-t)/2)-i:e/2>i?o=-i:e/2>t-i+n/2&&(o=t-i-e),this.$panel.css("top",o)}},save:function(){}});e.a=c},"5DNN":function(module,exports){module.exports={"template-constructor-block-text":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="margins-wrapper">\n\t\t<div class="margins-wrapper-inner">\n\t\t</div>\n\t</div>\n\n\t<div class="columns-wrapper">\n\t\t<div class="columns-wrapper-inner">\n\t\t</div>\n\t</div>\n\n\t<textarea id="textarea_'+(null==(__t=_id)?"":__t)+'" style="display: none; width:'+(null==(__t=w)?"":__t)+"px;height:"+(null==(__t=h)?"":__t)+'px">'+(null==(__t=text)?"":_.escape(__t))+'</textarea>\n\t<div class="text-preview" style="-webkit-nbsp-mode:normal; -webkit-line-break:after-white-space;">'+(null==(__t=text)?"":__t)+'</div>\n\t<div class="text-mask"></div>\n\n';return __p},"template-constructor-block-text-margins":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="margin-handle hidden inactive">\n\t\t<div class="margin-handle-label-wrapper">\n\t\t\t<div class="margin-handle-label">\n\t\t\t\t<input class="margin-input" type="text"  spellcheck="false" value="0" data-mouseSpeed="2" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n';return __p},"template-constructor-block-text-bg":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="bg"></div>\n';return __p}}},"5EAR":function(t,e,i){"use strict";var n=i("n1zk");i.n(n).a},"5KMv":function(module,exports){module.exports={"template-common-export-pdf":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="export-pdf-popup">\n\t\t<div class="panel-wrapper">\n\t\t\t<div class="close"></div>\n\n\t\t\t<div class="panel">\n\t\t\t\t<div class="header">Export to PDF</div>\n\n\t\t\t\t<div class="initial-block">\n\t\t\t\t\t<div class="radio-group">\n\t\t\t\t\t\t<div class="input-wrapper">\n\t\t\t\t\t\t\t<input type="radio" id="export-pdf-all" name="export-pdf-type" value="all" checked><label for="export-pdf-all" class="caption">All Pages</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="input-wrapper">\n\t\t\t\t\t\t\t<input type="radio" id="export-pdf-custom" name="export-pdf-type" value="custom"><label for="export-pdf-custom" class="caption"><input type="text" required="required" placeholder="e.g. 1-8, 11"></label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="errors"></div>\n\n\t\t\t\t\t<div class="create-pdf">Create PDF</div>\n\n\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t<div class="typekit-issue">Please note that if your projects contains Typekit web fonts they will be replaced by alternatives due to license restrictions.</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="done-block">\n\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t<div class="message">Your project is being converted.<br/>We will send you the download link to '+(null==(__t=email)?"":_.escape(__t))+' when it’s ready.</div>\n\n\t\t\t\t\t<div class="done">Done</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p}}},"5Rpd":function(t,e,i){"use strict";i.r(e);var n=i("xi34"),o=i("rFsW"),a=i("f3SV"),r=i("BVsp"),s=i("YqYG"),l=i("QNiq"),c=i("I0kf"),d=i("OTSC"),h=function(t){if(o.a.bindAll(this),o.a.extend(this,t),!RM.common.magCreationInProgress)if(this.analytics=this.router&&this.router.analytics,this.router?this.router==RM.viewerRouter?this.routerName="viewer":this.router==RM.collectorRouter?this.routerName="collector":this.router==RM.homepageRouter?this.routerName="homepage":this.router==RM.constructorRouter?this.routerName="constructor":this.routerName="unknown":this.routerName="error",this.analytics&&!this.noCreateRequestTracking&&this.analytics.sendEvent("Create Mag Request",{_tp:this.tp+"_"+(this.templateID?"template":"blank")+"_"+this.routerName+"_"+(this.me?"has-me":"no-me"),_template_id:this.templateID}),l.a.isDesktop)if(Modernizr.msie||Modernizr.msie11)this.showIEPopupWarning();else if(this.me){var e="function"==typeof this.me.get?this.me.get("permissions"):this.me.permissions;e&&e.can_create_mag?this.innerCreateMag():this.showCreatePopupWarning()}else this.showJoinForm();else this.showMobilePopupWarning()};h.prototype.innerCreateMag=function(){var t={};this.analytics&&(this.analytics.sendEvent("Create Mag",{_tp:this.tp+"_"+(this.templateID?"template":"blank")+"_"+this.routerName,_template_id:this.templateID}),this.templateID&&this.analytics.sendEvent("Templates action",{eventLabel:"From templates page",category:"Process Actions"})),this.currentFolderId&&(t.folder=this.currentFolderId),this.sharedUser&&(t.user=this.sharedUser),RM.common.magCreationInProgress=!0,n.a.ajax({url:a.a.readymag_auth_host+(this.templateID?"/api/magFromTemplate/"+this.templateID:"/api/mag/"),type:"POST",data:t,success:o.a.bind((function(t){"function"==typeof this.success&&this.success(),RM.common.magCreationInProgress=!1,window.location.href=a.a.readymag_auth_host+"/edit/"+t.num_id+"/contents/"}),this),error:o.a.bind((function(){if("function"==typeof this.error&&this.error(),RM.common.magCreationInProgress=!1,console.log(arguments),alert("Creating project problem. Contact tech support, please: "+a.a.SUPPORT_MAIL),this.me){var t="function"==typeof this.me.get?this.me.get("uri"):this.me.uri;t&&(window.location.href=a.a.readymag_auth_host+"/"+t)}}),this)})},h.prototype.showCreatePopupWarning=function(){s.default&&new s.default({$parent:Object(n.a)("body > .popups"),router:this.router,opts:{type:"type-create"},alert_source:"create mag"}).render()},h.prototype.showMobilePopupWarning=function(){s.default&&new s.default({$parent:Object(n.a)("body > .popups"),router:this.router,opts:{type:"type-switch-desktop-create"},alert_source:"create mag mobile"}).render()},h.prototype.showIEPopupWarning=function(){s.default&&new s.default({$parent:Object(n.a)("body > .popups"),router:this.router,opts:{type:"type-browsers"}}).render()},h.prototype.showJoinForm=function(){if(Object(c.a)("authorization.newFlow"))return d.default.saveJoinData(),void(window.location.href="".concat(a.a.readymag_host,"/auth/join").concat(this.templateID?"?template="+this.templateID:""));var t=new r.default({router:this.router,useNavigate:!1,$container:Object(n.a)("body")});t.render(),t.$el.css("z-index",9999),t.createMagParams={templateID:this.templateID,tp:this.tp,noCreateRequestTracking:!0},o.a.delay(o.a.bind((function(){t.switchTo("join"),t.show()}),this),100)},e.default=h},"5bt+":function(t,e,i){t.exports=i.p+"img/constructor/controls/add_to_cart_settings/layout-vertical.svg"},"5jX/":function(module,exports){module.exports={"template-constructor-control-picture_fwpos":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Crop" data-alt-pos="left" data-alt-offset="9"></div>\n';return __p}}},"5ta/":function(t,e,i){(function(t){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=i("xG9w"),o=void 0!==e(t)&&t.exports;function a(t,e){var i=t.split(".");return i.length>1?(i[i.length-2]+="_"+e,i.join(".")):t+"_"+e}var r="Built with Readymag—a tool to design anything on the web.";function s(t,e){return t?e&&-1===t.indexOf("://")?e+t:t:""}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=o?e.host:window.location.protocol+"//"+window.location.host,n=t&&t.screenshot;return n?s(a(n,1024),i):""}function c(t){var e=t.prefix+t.val+t.suffix;if(t.minLength=t.minLength||1,e.length>116){var i=Math.max(t.val.length-(e.length-116+1),t.minLength);e=t.prefix+t.val.substring(0,i)+"…"+t.suffix}return e}function d(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.isEmpty(e)||!n.isObject(e))return{};var o=e.emptyTitle?"":e.title,a=t?t.seo&&t.seo.title?t.seo.title:t.title?t.title:"":"",s="",d=e.description||(i.customDomain?"":r),h="";i.customDomain?s=i.forProject?o||"Project":(o?o+" — ":"")+(a||"Page "+t.num):(i.forProject||(s=(a?"‘"+a+"’":"Page "+t.num)+" from "),s+=(o?"‘"+o+"’":"Project")+" by "+e.user.name,i.forProject&&e.description&&(s+=" | Readymag")),h=i.forProject?l(n.findWhere(e.pages,{num:1}),i):l(t,i);var u="";return i.customDomain?i.forProject?u=o?c({prefix:"",val:o,suffix:""}):"Project":o||a?!o&&a?u=c({prefix:"",val:a,suffix:""}):o&&!a?u=c({prefix:"",val:o,suffix:" — Page "+t.num}):o&&a&&(u=c({prefix:"",val:o,suffix:" — "+a,minLength:20})).length>116&&(u=a).length>116&&(u=c({prefix:"",val:a,suffix:""})):u="Page "+t.num:i.forProject?u=o?c({prefix:"‘",val:o,suffix:"’ by "+e.user.name}):"Project by "+e.user.name:o||a?!o&&a?u=c({prefix:"‘",val:a,suffix:"’ from Project by "+e.user.name}):o&&!a?u=c({prefix:"Page "+t.num+" from ‘",val:o,suffix:"’ by "+e.user.name}):o&&a&&(u=c({prefix:"‘"+a+"’ from ‘",val:o,suffix:"’ by "+e.user.name,minLength:20})).length>116&&(u="‘"+a+"’ by "+e.user.name).length>116&&(u=c({prefix:"‘",val:a,suffix:"’ by "+e.user.name})):u="Page "+t.num+" from Project by "+e.user.name,{image:h,title:s||"",description:d||"",tweet:u}}function h(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.isEmpty(e)||!n.isObject(e))return{};var o=d(t,e,i),a=e.master_share_pid&&n.find(e.pages,(function(t){return t._id.toString()===e.master_share_pid.toString()})),r=i.forProject?n.findWhere(e.pages,{num:1}):t,s=a||r,c=s.custom_shares;return n.isEmpty(c)||(o.title=c.title||"",o.description=c.description||"",o.tweet=c.tweet||"",c.image?o.image=c.image:s.screenshot?o.image=l(s,i):o.image=""),o}function u(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.isEmpty(e)||!n.isObject(e))return{};var o=e.emptyTitle?"":e.title,a="",s="";return i.customDomain?t&&t.num>1?a=(o?o+" — ":"")+(t.title||"Page "+t.num):(a=o||"Project",s=e.description||""):(t&&t.num>1?a=(t.title?"‘"+t.title+"’":"Page "+t.num)+" from ":s=e.description||r,a=o||"Project"),{title:a||"",description:s||"",keywords:""}}function p(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:626,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:436;window.open(t,"sharer","width="+e+",height="+i+",toolbar=0,status=0")}t.exports={SUPPORT_MAIL:"support@readymag.com",addFilenameComponent:a,defaultDescription:r,maxTweetLen:116,addOrigin:s,removeFilenameComponent:function(t){var e=t.split(".");if(e.length>1){var i=e[e.length-2].split("_");if(i.length>1&&!isNaN(Number(i[i.length-1]))){i.pop();var n=i.join("_");return e[e.length-2]=n,e.join(".")}}return t},getPageScreenshot:l,getDefaultShare:d,getDefaultSEO:u,getFinalShare:h,getFinalSEO:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n.isEmpty(e)||!n.isObject(e))return{};var o=u(t,e,i);return o.title=t.seo&&t.seo.title||o.title,o.description=t.seo&&t.seo.description||o.description,o.keywords=t.seo&&t.seo.keywords||o.keywords,o},share:function(t){var e,i=h(t.page,t.mag,{forProject:t.forProject,customDomain:t.customDomain}),n=t.mag.emptyTitle?"":t.mag.title;if(/^https?:\/\//i.test(t.host)||(t.host="http://"+t.host),t.exportBasePath&&(t.host+=t.exportBasePath),/\/$/i.test(t.host)||(t.host+="/"),e=t.forProject?"".concat(t.host).concat(t.customDomain&&!t.customDomainProfile?"":"".concat(t.mag.num_id,"/")):t.exportBasePath?"".concat(t.host).concat(t.page.uri||t.page.num,"/"):"".concat(t.host,"p").concat(t.page.num_id,"/"),t.publishedVersion){var o;if("facebook"===t.tp&&p("http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e)),"twitter"===t.tp)o=n?c({prefix:"I’ve just published a project ‘",val:n,suffix:"’"}):"I’ve just published a Project",p("https://twitter.com/share?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(o));if("email"===t.tp){var a=encodeURIComponent((t.mag.is_private?"private ":"")+(n?"project ‘"+n+"’":"Project")),r="Check out my "+a,s="Hey, check out my new "+a+": "+e+(t.mag.is_private?encodeURIComponent("\n")+"Password: "+t.mag.pass:"");window.location.href="mailto:?subject="+r+"&body="+s}}else{if("facebook"===t.tp&&p("http://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e)),"twitter"===t.tp&&p("https://twitter.com/share?url="+encodeURIComponent(e)+"&text="+encodeURIComponent(i.tweet)),"gplus"===t.tp&&p("https://plus.google.com/share?url="+encodeURIComponent(e)),"pinterest"===t.tp&&p("http://pinterest.com/pin/create/button/?url="+encodeURIComponent(e)+"&media="+encodeURIComponent(i.image)+"&description="+encodeURIComponent(i.title)),"linkedin"===t.tp&&p("http://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(e)+"&title="+encodeURIComponent(i.title)+(i.description?"&summary="+encodeURIComponent(i.description):""),552,460),"email"===t.tp){var l="Check out "+encodeURIComponent(i.title),d=l+encodeURIComponent("\n\n")+e+(t.mag.is_private?encodeURIComponent("\n")+"Password: "+t.mag.pass:"");window.location.href="mailto:?subject="+l+"&body="+d}if("report"===t.tp){var u="Report "+encodeURIComponent(e),m=encodeURIComponent("Please tell us why are you reporting this: ");window.location.href="mailto:support@readymag.com?subject="+u+"&body="+m}}if("report"!==t.tp){var g=t.source+" / "+t.tp+" ("+(t.forProject?"project":"page")+") / "+i.title+" ("+e+")";t.analytics&&t.analytics.sendEvent("Share",g)}}}}).call(this,i("YuTi")(t))},"60Nw":function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("8CCW"),l=i.n(s),c=i("OTSC"),d=i("f3SV"),h=i("3eHG"),u=i("WoDZ"),p=i("zWgA"),m=i.n(p);function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var f={},v={findPlugin:function(t){var e=m()(t.code,t);return r.a.find(f,(function(t,i){return i.toLowerCase()===e}))}},b=a.a.View.extend({embed_type:null,containerSelector:null,resizable:!0,proportional:!1,forceFrameSize:!1,initialize:function(t){this.block=t.block,this.widget=t.widget,r.a.bindAll(this),this.isInViewer=RM.viewerRouter||RM.constructorRouter&&RM.constructorRouter.preview},parse:function(t,e){return e(t)},sanitize:function(t){return Object(n.a)(t)},draw:function(t){t()}});function y(t,e){if(t){var i=["allow-top-navigation","allow-top-navigation-by-user-activation","allow-modals","allow-popups","allow-popups-to-escape-sandbox"],n=e&&Array.isArray(e)?e.filter((function(t){return!r.a.contains(i,t.toLowerCase())})):["allow-scripts","allow-forms","allow-same-origin"];t.attr("sandbox",n.join(" "))}}v.instagramEmbedCallbacks=[],v.initInstagram=function(t){if(window.instgrm&&window.instgrm.Embeds&&r.a.isFunction(window.instgrm.Embeds.process))return instgrm.Embeds.process(),t();v.instagramEmbedCallbacks.push(t),v.instagramInitXhr&&v.instagramInitXhr.abort(),Object(n.a)('body > script[src^="//platform.instagram.com"]').remove(),v.instagramInitXhr=n.a.ajax({url:c.default.selectProtocol("//platform.instagram.com/en_US/embeds.js"),dataType:"script",cache:!0,success:function(){r.a.each(v.instagramEmbedCallbacks,(function(t){r.a.isFunction(t)&&t()}))}})},f.Instagram=b.extend({embed_type:"instagram",containerSelector:"iframe",resizable:!0,initialize:function(t){b.prototype.initialize.apply(this,arguments),this.block&&r.a.extend(this.block.frame,{minwidth:164,minheight:264})},parse:function(t,e){return e(t.replace(/<script.*script>/i,""))},draw:function(t,e,i){var n,o,a,r,s,l=0,c=!1;e.html(t),v.initInstagram(function(){s=setInterval(function(){if(l++,n=e.children(this.containerSelector),(o=n.height())||l>20){if(o||l>50)return o&&"constructor"===RM.common.mode&&(a=n.width(),r=n.height()),clearInterval(s),void i(a,r);if(c)return;c=!0,i()}}.bind(this),100)}.bind(this))},customResizeHandler:function(t,e,i){return t}}),v.pinterestEmbedCallbacks=[],v.initPinterest=function(t){var e,i=0;if(r.a.isFunction(window.parsePinBtns))return t();v.pinterestEmbedCallbacks.push(t),Object(n.a)('body > script[src^="assets.pinterest.com/js/pinit.js"]').remove(),Object(n.a)("body").prepend(Object(n.a)('<script defer src="//assets.pinterest.com/js/pinit.js" data-pin-build="parsePinBtns"><\/script>')),e=setInterval((function(){i++,(r.a.isFunction(window.parsePinBtns)||i>20)&&(clearInterval(e),t())}),100)},f.Pinterest=b.extend({embed_type:"pinterest",containerSelector:"a",resizable:!1,forceFrameSize:!0,containerSelectors:{buttonPin:"span",buttonFollow:"span",embedPin:"span",embedUser:"span",embedBoard:"span"},parse:function(t,e){var i=t.match(/data-pin-do=\"(\S+)\"/);return r.a.isArray(i)&&i[1]&&(this.pinterestType=i[1],this.containerSelector=this.containerSelectors[this.pinterestType]||this.containerSelector),e&&e(t.replace(/<script.*script>/i,""))},draw:function(t,e,i){v.initPinterest(function(){var n,o,a,r,s,l,c=0,d=!1;e.html(t),this.pinterestType||this.parse(t[0].outerHTML),this.pinterestType&&e.addClass(this.pinterestType),window.parsePinBtns(e.get(0)),s=setInterval(function(){if(c++,n=e.children(this.containerSelector).filter((function(){return/PIN_\d+/.test(this.className)})),(o=n.height())||c>20){if(o||c>50)return o&&"constructor"===RM.common.mode&&(a=n.outerWidth(!0),r=n.outerHeight(!0),"buttonFollow"==this.pinterestType&&(l=n.children("i")).length&&(a+=(l.outerWidth()||1)-1)),clearInterval(s),void i(a,r);if(d)return;d=!0,i()}}.bind(this),100)}.bind(this))}}),f.FacebookVideo=b.extend({embed_type:"fbvideo",containerSelector:"iframe",resizable:!0,proportional:!0,forceFrameSize:!0,initialize:function(t){b.prototype.initialize.apply(this,arguments),this.block&&r.a.extend(this.block.frame,{minwidth:220,minheight:124})},parse:function(t,e){return e(t.replace(/<script.*script>/gi,"").replace(/<div\s+id=(\'|\")fb-root(\'|\")><\/div>/gi,""))},draw:function(t,e,i){var n,o,a;e.html(t),h.a.initFacebookAPI(function(){window.FB.XFBML.parse(e.get(0),function(){n=e.find(this.containerSelector),o=n.width(),a=n.height(),i(o,a)}.bind(this))}.bind(this))}}),v.readymagEmbedCallbacks=[],v.initReadymag=function(t){if(RM.common.isReadymagEmbedInited&&r.a.isFunction(window.RM_EMBED_parse))return t();v.readymagEmbedCallbacks.push(t),window.RM_EMBED_initAsync=function(){RM.common.isReadymagEmbedInited=!0,r.a.each(v.readymagEmbedCallbacks,(function(t,e){r.a.isFunction(t)&&t()})),v.readymagEmbedCallbacks=[]},v.readymagInitXhr||(Object(n.a)('body > script[src~="RM_EMBED_"]').remove(),v.readymagInitXhr=n.a.ajax({url:d.a.EMBED_SCRIPT_MAIN,dataType:"script"}))},f.Readymag=b.extend({embed_type:"readymag",containerSelector:"iframe",resizable:!0,initialize:function(t){b.prototype.initialize.apply(this,arguments),this.block&&this.block.frame&&r.a.extend(this.block.frame,{minwidth:288,minheight:236,maxwidth:512,maxheight:383})},parse:function(t,e){return e(t.replace(/<script.*script>/i,""))},draw:function(t,e,i){e.html(t),v.initReadymag(function(){window.RM_EMBED_parse(function(){var t=e.find(this.containerSelector),n=t.width(),o=t.height();i(n+2,o)}.bind(this))}.bind(this))}}),f.IFrame=b.extend({embed_type:"simple-iframe",containerSelector:"iframe",resizable:!0,parse:function(t,e){var i;return(i=t.match(/[\s\S]*?(\<iframe[\s\S]*?\>)[\s\S]*?(\<\/iframe\>)[\s\S]*?/i))&&i[1]&&i[2]?e(i[1]+i[2]):e(null)},sanitize:function(t){var e=Object(n.a)(t);if("object"!==g(e)||!e.length)return e;var i,o=Object(n.a)("<iframe></iframe>"),a=e.get(0).attributes,s=["allowtransparency","allowfullscreen","height","name","sandbox","scrolling","seamless","src","width","allow"];return Object(r.a)(a).each((function(t){if("object"===g(t)&&t.specified&&r.a.contains(s,t.name.toLowerCase())){var e=t.name.toLowerCase(),n=t.value;"src"==e&&"https:"==window.location.protocol&&(n=n.replace(/^http(s?):\/\//i,"//")),"sandbox"===e&&(i=n.split(" ")),o.attr(e,n)}})),this.isInViewer||y(o,i),o},draw:function(t,e,i){var n=t[0].src;if(n&&n.trim())if(RM.screenshot&&u.a.getVideoProvider(n))this.setPosterInsteadOfVideo(n,e,i);else{e.html(t);var o,a,r,s,l,c=0,d=!1;l=setInterval(function(){if(c++,o=e.children(this.containerSelector),(a=o.height())||c>20){if(a||c>50)return a&&"constructor"===RM.common.mode&&(r=o.width(),s=o.height()),clearInterval(l),void i(r,s);if(d)return;d=!0,i()}}.bind(this),100)}else i()},setPosterInsteadOfVideo:function(t,e,i){var o=u.a.getVideoProvider(t),a=Object(n.a)("<img/>");u.a.getEmbedData(t,(function(t){u.a.getHighResVideoThumbnail({provider:o,thumbnail_url:t.thumbnail_url}).then(r.a.bind((function(t){!function(t){a[0].src=t,e.css({"background-color":"#000"}),a.css({position:"absolute",top:0,bottom:0,margin:"auto",width:"100%",height:"auto"}),e.append(a)}(t)}),this))}),(function(){"function"==typeof i&&i()}))}}),f.CodeInjection=b.extend({embed_type:"code-injection",containerSelector:"rm-code-injection",resizable:!0,HEAD_PASSTHROUGH_SELECTOR:"",parse:function(t,e){return e(t)},sanitize:function(t){return n.a.parseHTML(t,document,!0)},draw:function(t,e,i){var o=Object(n.a)(document).find("head"),a="<head>",r='<body style="padding:0; margin: 0; width: 100%; height: 100%; min-width: initial; min-height: auto;">',s=o.find(this.HEAD_PASSTHROUGH_SELECTOR),c=Object(n.a)('<iframe seamless style="width: 100%; height: 100%;"></iframe>'),d=Object(n.a)("<div></div>");if(!this.isInViewer||this.block&&this.block.model.get("use_iframe")||this.widget&&this.widget.use_iframe){this.isInViewer||y(c),s.each((function(){a+=this.outerHTML})),a+='<script src="https://unpkg.com/jquery@2.2.3/dist/jquery.min.js"><\/script>',a+="</head>",d.html(t),r+=d[0].innerHTML+"</body>";var h='<!DOCTYPE html><html style="width: 100%; height: 100%; min-width: initial; min-height: auto;">'+a+r+"</html>";return e.html(c),c[0].contentWindow.document.open(),c[0].contentWindow.document.write(h),c[0].contentWindow.document.close(),i(c.width(),c.height())}t=Object(n.a)(t),d.html(t),d.find("script").each((function(){var t;this.src&&this.text&&((t=document.createElement("script")).text=this.text,this.text="",Object(n.a)(t).insertAfter(Object(n.a)(this)))})),l()(e,d[0].innerHTML,{done:function(){return i(null,null)}}),e.css({"font-family":"initial","font-weight":"initial"})},loadNodeWithScripts:function(t,e,i){var o,a=Object(n.a)('<div id="fake"></div>'),s=[];a.html(e),(o=a.find("script")).each((function(){this.src&&this.text?(s.push({src:this.src}),s.push({text:this.text})):s.push({src:this.src,text:this.text})}));var l=r.a.find(s,(function(t){return!!t.src}));if(!s.length||!l||s<2)t.html(a[0].innerHTML);else{o.remove();var c=0;t.html(a[0].innerHTML),function e(){var n,o,a,r=s[c];if(!r)return i();c++,n=document.createElement("script"),r.src&&(n.src=r.src);r.text&&(n.text=r.text);if(!r.src)return t[0].appendChild(n),e();r.src&&(n.onload=function(){clearInterval(o),e()},a=0,o=setInterval((function(){++a>10&&(n.onload=null,e())}),1e3),t[0].appendChild(n))}()}}}),f.Ecommerce=f.CodeInjection.extend({embed_type:"ecommerce"}),f.Gdpr=f.CodeInjection.extend({embed_type:"gdpr"}),f.Video=f.CodeInjection.extend({embed_type:"html5-video"}),e.a=v},"6auq":function(t,e,i){},"6ouf":function(t,e,i){"use strict";var n=i("0KJJ");i.n(n).a},"6st4":function(t,e,i){},"6z1P":function(t,e,i){"use strict";var n=i("skB9");i.n(n).a},"7E8S":function(module,exports){module.exports={"template-constructor-control-text_autosize":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon text_autosize-icon" data-alt="Auto-size" data-alt-pos="left" data-alt-offset="9"></div>\n';return __p}}},"7TSX":function(module,exports){module.exports={"template-constructor-control-hotspot_add":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="icon noarrow"\n\t     data-alt="Add Pin"\n\t     data-alt-pos="left"\n\t     data-alt-offset="9"></div>\n\n';return __p}}},"896M":function(t,e,i){"use strict";var n=i("TxgR");i.n(n).a},"8AXF":function(t,e,i){"use strict";i.r(e),i.d(e,"BackboneContext",(function(){return p})),i.d(e,"BackboneContextProvider",(function(){return m})),i.d(e,"BackboneCollectionContextProvider",(function(){return g})),i.d(e,"CreateContextProvider",(function(){return f})),i.d(e,"renderReact",(function(){return v}));var n=i("q1tI"),o=i.n(n),a=i("i8i4"),r=i.n(a),s=i("iC7s");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var p=o.a.createContext({}),m=function(t){var e=t.domElement,i=t.model,a=t.children,s=t.context,l={modelSet:function(t,e){return i.set(t,e)},modelUnset:function(t,e){return i.unset(t,e)},modelSave:function(t,e){return i.save(t,e)},destroy:function(){e&&(r.a.unmountComponentAtNode(e),e&&e.parentNode&&e.parentNode.removeChild(e))}},d=h(Object(n.useState)({model:i.attributes}),2),u=d[0],p=d[1],m=function(t){p(c(c({},u),{},{model:t.attributes}))};return Object(n.useEffect)((function(){return i.on("change",m),function(){i.off("change",m)}}),[i]),o.a.createElement(s.Provider,{value:c(c({},u),l)},a)},g=function(t){var e=t.domElement,i=t.collection,a=t.children,s=t.context,l={elementSet:function(t,e,n){var o=i.get(t);if(!o)throw new Error("Element not found");return o.set(e,n)},elementUnset:function(t,e,n){var o=i.get(t);if(!o)throw new Error("Element not found");return o.unset(e,n)},elementSave:function(t,e,n){var o=i.get(t);if(!o)throw new Error("Element not found");return o.save(e,n)},destroy:function(){e&&(r.a.unmountComponentAtNode(e),e&&e.parentNode&&e.parentNode.removeChild(e))}},d=h(Object(n.useState)({collection:i.map((function(t){return t.attributes}))}),2),u=d[0],p=d[1],m=function(t){var e=t.get("_id");p((function(i){var n=i.collection.findIndex((function(t){return t._id===e}));if(-1===n)return{collection:i.collection};var o=i.collection.splice(0);return o[n]=t.attributes,{collection:o}}))},g=function(t){p((function(e){var i=e.collection.splice(0);return i.push(t.attributes),{collection:i}}))},f=function(t){var e=t.get("_id");p((function(t){var i=t.collection.findIndex((function(t){return t._id===e}));if(-1===i)return{collection:t.collection};var n=t.collection.splice(0);return n.splice(i,1),{collection:n}}))};return Object(n.useEffect)((function(){return i.on("change",m),i.on("add",g),i.on("remove",f),function(){i.off("change",m),i.off("add",g),i.on("off",f)}}),[i]),o.a.createElement(s.Provider,{value:c(c({},u),l)},a)},f=function(t){var e=t.model,i=t.collection,n=t.domElement,a=t.context,r=t.children;return e?o.a.createElement(m,{model:e,domElement:n,context:a},r):i?o.a.createElement(g,{collection:i,domElement:n,context:a},r):o.a.createElement(o.a.Fragment,null,r)},v=function(t){var e=t.component,i=t.domElement,n=t.model;n?r.a.render(o.a.createElement(s.Db,null,o.a.createElement(f,{model:n,domElement:i,context:p},o.a.createElement(e,null))),i):r.a.render(o.a.createElement(e,null),i)}},"8RDp":function(t,e,i){"use strict";i.d(e,"b",(function(){return d}));var n=i("q1tI"),o=i.n(n),a=i("ICos"),r=i("8Tds");function s(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function l(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach((function(e){c(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var d=function(t){var e=t||{},i=e.type,n=void 0===i?r.a.None:i,o=e.color,s=void 0===o?"00000064":o,c=e.size,d=void 0===c?1:c,h=e.padding,u=void 0===h?0:h,p=Object(a.f)(s),m=p.r,g=p.g,f=p.b,v=p.a,b="rgba(".concat(m,", ").concat(g,", ").concat(f,", ").concat(v,")"),y=d+u,_=y>0?"0 100%":"0 ".concat(100+y,"%"),w={textDecoration:"none",paddingBottom:Math.max(0,y)};switch(n){case r.a.Solid:return l(l({},w),{},{background:"linear-gradient(to right, ".concat(b," 0%, ").concat(b," 100%) ").concat(_,"/1px ").concat(d,"px ").concat("repeat-x")});case r.a.Dotted:return l(l({},w),{},{background:"linear-gradient(to right, ".concat(b," 0%, ").concat(b," 50%, transparent 50%, transparent 100%) ").concat(_,"/").concat(2*d,"px ").concat(d,"px ").concat("repeat-x")});case r.a.Dashed:return l(l({},w),{},{background:"linear-gradient(to right, ".concat(b," 0%, ").concat(b," 66.6666%, transparent 66.6666%, transparent 100%) ").concat(_,"/").concat(3*d,"px ").concat(d,"px ").concat("repeat-x")});default:return l(l({},w),{},{background:"none"})}};e.a=function(t){if(!t)return o.a.createElement("div",{style:{width:"100%"}});var e=Object(n.useMemo)((function(){return d(t)}),[t.type,t.size,t.color,t.padding]);return(o.a.createElement("div",{style:l(l({},e),{},{width:"100%"})}))}},"8Tds":function(t,e,i){"use strict";var n,o,a,r;i.d(e,"d",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return r})),function(t){t.top="top",t.bottom="bottom"}(n||(n={})),function(t){t.LTR="LTR",t.RTL="RTL"}(o||(o={})),function(t){t.global="global",t.project="project"}(a||(a={})),function(t){t.None="None",t.Solid="Solid",t.Dotted="Dotted",t.Dashed="Dashed"}(r||(r={}))},"8by/":function(t,e,i){"use strict";i.d(e,"d",(function(){return p})),i.d(e,"b",(function(){return m})),i.d(e,"a",(function(){return g})),i.d(e,"c",(function(){return f}));var n=i("jcqt"),o=i("LDvm");function a(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return d(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var h={favourites:[],regular:[]},u=c(Object(n.a)({global:s({},h),project:s({},h)}),3),p=u[0],m=u[1],g=u[2],f=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var i,n,a,r,s,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.projectId,n=e.userId,t.next=3,Promise.all([Object(o.h)(n),Object(o.m)(i)]);case 3:a=t.sent,r=c(a,2),s=r[0].data,(l=r[1].data)&&(l.favourites.length||l.regular.length)?m({global:s,project:l}):(d={favourites:window.ServerData.editParams.fav_colors,regular:window.ServerData.editParams.swatches},m({global:s,project:d}),Object(o.z)({projectId:i,colors:d}));case 8:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var r=t.apply(e,i);function s(t){a(r,n,o,s,l,"next",t)}function l(t){a(r,n,o,s,l,"throw",t)}s(void 0)}))});return function(t){return e.apply(this,arguments)}}()},"8nfS":function(t,e,i){},"9GTV":function(t,e,i){!function(t,e){var n={update_playing_element:function(t,e,i){var n="rgba("+i.r+", "+i.g+", "+i.b+", "+.2*i.a+")",o="rgba("+i.r+", "+i.g+", "+i.b+", "+.1*i.a+")";t.style.cssText+="background: -webkit-linear-gradient(left, "+n+e+"%, "+o+(e+.1)+"%);background: linear-gradient(to right, "+n+e+"%, "+o+(e+.1)+"%);"}};for(var o in t.SOUNDCITE_CONFIG)n[o]=t.SOUNDCITE_CONFIG[o];var a=t.soundcite={};/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?a.mobile=!0:a.mobile=!1;var r,s,l=e.head||e.getElementsByTagName("head").item(0)||e.documentElement.childNodes[0],c=[],d="none",h="none",u=[],p=[];function m(t){var i={r:0,g:0,b:0,a:1};if(e.defaultView&&e.defaultView.getComputedStyle){var n=e.defaultView.getComputedStyle(t,null);if(n){var o=n.getPropertyValue("color").toLowerCase(),a=o.match(/\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*/)||o.match(/\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d+|\d*\.\d+)\s*\)\s*/);a?i={r:a[1]-0,g:a[2]-0,b:a[3]-0,a:void 0!==a[4]?a[4]-0:1}:(o=o.replace("#",""),i={r:parseInt(o.substring(0,2),16),g:parseInt(o.substring(2,4),16),b:parseInt(o.substring(4,6),16),a:1})}}return i}var g=function(t,e){var i=Array.prototype.slice,n=i.call(arguments,2);return function(){return t.apply(e,n.concat(i.call(arguments)))}};function f(i,n){var o,a=t.SC;if(d="loading",!a||!a.Dialog||function(t,e){for(var i=t.split("."),n=e.split("."),o=0;o<Math.min(i.length,n.length);o++){var a=parseInt(i[o])-parseInt(n[o]);if(a)return a}return i.length-n.length}(i,a._version)>0||n(a,d="loaded")){var r=e.createElement("script");r.type="text/javascript",r.src="//connect.soundcloud.com/sdk-2.0.0.js",r.onload=r.onreadystatechange=function(){"loading"!=d||(o=this.readyState)&&"loaded"!=o&&"complete"!=o||(n(t.SC,d="loaded"),l.removeChild(r))},l.appendChild(r)}}function v(t,e){for(var i=t.className,n=0,o=e.match(/\S+/g);n<o.length;n++)i=i.replace(new RegExp("(?:^|\\s)"+o[n]+"(?!\\S)"),"");t.className=i}function b(t,e){for(var i=t.className,n=0,o=e.match(/\S+/g);n<o.length;n++)i.match(new RegExp("(?:^|\\s)"+o[n]+"(?!\\S)"))||(i+=" "+o[n]);t.className=i}function y(t){this.el=t,this.start=t.hasAttribute("data-start")?t.getAttribute("data-start"):0,this.end=t.hasAttribute("data-end")?t.getAttribute("data-end"):null,this.plays=t.hasAttribute("data-plays")?parseInt(t.getAttribute("data-plays")):1,this.plays_left=this.plays,this.playing=!1,this.sound=null,this.click_handler_binded=g(this.click_handler,this),c.push(this)}function _(t){y.apply(this,Array.prototype.slice.call(arguments)),this.id=t.getAttribute("data-id"),"initialized"!==d&&(r.initialize({client_id:"5ba7fd66044a60db41a97cb9d924996a"}),d="initialized"),r.stream(this.id,g((function(t){this.destroyed?t._player.kill&&t._player.kill():(this.sound=t,this.sound._player.on("positionChange",g((function(t){this.track_progress(),this.playing&&(t<this.start&&this.sound.seek(this.start),t>=this.end&&(this.plays?(this.plays_left--,this.plays_left>0?this.play():this.stop()):this.play(),this.track_progress()),this.prevPos=t)}),this)),null===this.end&&(this.end=this.sound.getDuration()),this.sound_loaded())}),this))}function w(t){y.apply(this,Array.prototype.slice.call(arguments)),this.id="soundcite-audio-"+this.generateUUID(),this.url=t.getAttribute("data-url"),this.start=Math.floor(this.start/1e3),null!==this.end&&(this.end=Math.floor(this.end/1e3)),"initialized"!=h&&(a.audio_container=e.createElement("div"),b(a.audio_container,"soundcite-audio"),e.getElementsByTagName("body")[0].appendChild(a.audio_container),h="initialized"),this.audio=e.createElement("audio"),this.audio.id=this.id,this.audio.setAttribute("src",this.url),this.audio.setAttribute("preload","none"),a.mobile=!0,a.audio_container.appendChild(this.audio),this.sound=s("#"+this.id,{frameAnimation:!0}),this.sound.on("loadeddata",g((function(){null===this.end&&(this.end=this.sound.duration()),a.mobile||this.sound_loaded()}),this)),(a.mobile||this.sound.readyState()>1)&&this.sound_loaded()}y.prototype.generateUUID=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)}))},y.prototype.sound_loaded=function(){this.el.addEventListener("click",this.click_handler_binded),v(this.el,"soundcite-initializing"),this.el.style.display="none",this.el.offsetHeight,this.el.style.display="",b(this.el,"soundcite-loaded soundcite-play")},y.prototype.pause=function(){v(this.el,"soundcite-pause"),b(this.el,"soundcite-play"),this.playing=!1,this.pause_sound()},y.prototype.stop=function(){v(this.el,"soundcite-pause"),b(this.el,"soundcite-play"),this.playing=!1,this.plays_left=this.plays,this.stop_sound()},y.prototype.track_progress=function(){var t=this.end-this.start,e=100*(this.sound_position()-this.start)/t;this.color||(this.color=m(this.el)),n.update_playing_element(this.el,e,this.color)},y.prototype.click_handler=function(t){t.preventDefault(),function(t){for(var e=0;e<c.length;e++)c[e].playing&&(t&&t.el===c[e].el||c[e].pause())}(this),this.playing?this.pause():this.play()},y.prototype.destroy=function(t){this.destroyed=!0,this.playing&&this.pause(),this.el&&v(this.el,"soundcite-loaded soundcite-initializing soundcite-loading soundcite-play soundcite-pause"),this.el&&this.el.removeEventListener("click",this.click_handler_binded)},_.prototype=Object.create(y.prototype),_.prototype.sound_position=function(){return this.sound.getCurrentPosition()},_.prototype.pause_sound=function(){this.sound.pause()},_.prototype.stop_sound=function(){this.sound.stop()},_.prototype.play=function(){var t=this.sound_position();(t<this.start||t>=this.end)&&this.sound.seek(this.start),v(this.el,"soundcite-play"),b(this.el,"soundcite-pause"),this.sound.play(),this.playing=!0,this.prevPos=-1},_.prototype.destroy=function(){this.sound&&this.sound._player.kill&&this.sound._player.kill(),y.prototype.destroy.apply(this,arguments)},w.prototype=Object.create(y.prototype),w.prototype.sound_position=function(){return this.sound.currentTime()},w.prototype.pause_sound=function(){this.sound.pause(),this.sound.off("timeupdate")},w.prototype.stop_sound=function(){this.sound.off("timeupdate"),this.sound.pause()},w.prototype._play_sound=function(){v(this.el,"soundcite-loading soundcite-play"),b(this.el,"soundcite-pause"),this.sound.play(),this.playing=!0,this.sound.on("timeupdate",g((function(){this.track_progress(),this.playing&&this.sound.currentTime()>=this.end&&(this.plays?(this.plays_left--,this.plays_left>0?this.play_sound():this.stop()):this.play_sound(),this.track_progress())}),this))},w.prototype.play_sound=function(){var t=this.sound.currentTime();t<this.start||t>=this.end?(this.sound.on("seeked",g((function(){this.sound.off("seeked"),this._play_sound()}),this)),this.sound.currentTime(this.start)):this._play_sound()},w.prototype.play=function(){/soundcite\-loading/.test(this.el.className)||(a.mobile?(v(this.el,"soundcite-play"),b(this.el,"soundcite-loading"),this.startedLoading?this.play_sound():(this.sound.on("canplaythrough",g((function(){this.play_sound()}),this)),e.getElementById(this.id).load()),this.startedLoading=!0):this.play_sound())},w.prototype.destroy=function(){this.sound&&s.destroy(this.sound),this.audio&&a.audio_container.removeChild(this.audio),y.prototype.destroy.apply(this,arguments)},a.createPlayer=function(e){b(e,"soundcite-initializing"),b(e,"soundcite-force-bg-color"),n.update_playing_element(e,0,m(e)),e.getAttribute("data-url")&&("none"==h?(p.push(e),i.e(14).then(i.bind(null,"+qCX")).then((function(e){(0,e.default)(t,t.document),s=t.Popcorn;for(var i=0;i<p.length;i++)new w(p[i])}))):"loading"==h?p.push(e):new w(e)),e.getAttribute("data-id")&&("none"==d?(u.push(e),f("2.0.0",(function(t){r=t;for(var e=0;e<u.length;e++)new _(u[e])}))):"loading"==d?u.push(e):new _(e))},a.destroyPlayer=function(t){for(var e=c.length-1;e>=0;e--)c[e].el==t&&(c[e].destroy(),c.splice(e,1));for(e=p.length-1;e>=0;e--)p[e]==t&&p.splice(e,1);for(e=u.length-1;e>=0;e--)u[e]==t&&u.splice(e,1)},a.pausePlayer=function(t){for(var e=0;e<c.length;e++)t==c[e].el&&c[e].playing&&c[e].pause()},a.setElementsColor=function(t){n.update_playing_element(t,0,m(t))}}(window,document)},"9Tqx":function(t,e,i){},A9VP:function(t,e,i){"use strict";var n,o,a=i("fueH"),r=i("ICos");function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return c(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.LetterSpacing="LETTER_SPACING",t.Color="COLOR",t.FontFeature="FONT_FEATURE",t.Stroke="STROKE",t.FontSize="FONT_SIZE",t.FontFamily="FONT_FAMILY",t.FontWeight="FONT_WEIGHT",t.FontStyle="FONT_STYLE",t.FontVariable="FONT_VARIABLE",t.IsLinkedFontSize="IS_LINKED_FONT_SIZE",t.IsLinkedLetterSpacing="IS_LINKED_LETTER_SPACING",t.Decoration="DECORATION",t.Transform="TRANSFORM",t.Features="FEATURES",t.FontKerning="FONT_KERNING"}(o||(o={}));var d=(s(n={},o.LetterSpacing,{name:"letterSpacing",value:function(t){return"".concat(t,"px")}}),s(n,o.FontFamily,{name:"fontFamily",value:function(t){return t}}),s(n,o.FontStyle,{name:"fontStyle",value:function(t){return t}}),s(n,o.FontWeight,{name:"fontWeight",value:function(t){return t}}),s(n,o.FontSize,{name:"fontSize",value:function(t){return"".concat(t,"px")}}),s(n,o.Color,{name:"color",value:function(t){var e=Object(r.f)(t),i=e.r,n=e.g,o=e.b,a=e.a;return"rgba(".concat(i,", ").concat(n,", ").concat(o,", ").concat(a,")")}}),s(n,o.FontFeature,{name:"fontFeatureSettings",value:function(t){return t.split(a.a.INLINE_STYLE_DELIMITER).filter((function(t){return t})).map((function(t){return'"'.concat(t,'"')})).join(", ")}}),s(n,o.FontVariable,{name:"fontVariationSettings",value:function(t){return t.split(a.a.INLINE_STYLE_DELIMITER).filter((function(t){return t})).map((function(t){var e=l(t.split("|"),2),i=e[0],n=e[1];return"'".concat(i,"' ").concat(n)})).join(", ")}}),s(n,o.Stroke,{styleFn:function(t){var e=l(t.split(a.a.INLINE_STYLE_DELIMITER),2),i=e[0],n=e[1],o=Object(r.f)(n),s=o.r,c=o.g,d=o.b,h=o.a,u="rgba(".concat(s,", ").concat(c,", ").concat(d,", ").concat(h,")"),p="".concat(i,"px ").concat(u);return{WebkitTextStroke:p,textStroke:p}}}),s(n,o.Decoration,{name:"textDecoration",value:function(t){return t}}),s(n,o.Transform,{name:"textTransform",value:function(t){return t}}),s(n,o.Features,{styleFn:function(t){switch(t){case"superscript":return{verticalAlign:"baseline",position:"relative",top:"-0.4em",fontSize:"smaller"};case"subscript":return{verticalAlign:"baseline",position:"relative",top:"0.4em",fontSize:"smaller"};default:return{}}}}),s(n,o.FontKerning,{styleFn:function(t){return"none"===t?{}:{fontKerning:"auto",WebkitFontKerning:"auto"}}}),n);function h(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function u(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?h(Object(i),!0).forEach((function(e){p(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function p(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,"b",(function(){return m})),i.d(e,"a",(function(){return o}));var m=function(t){return Object.keys(d).reduce((function(e,i){var n=t.filter((function(t){return!!t&&t.startsWith(i)})).first();if(n){var o=n.replace("".concat(i).concat(a.a.INLINE_STYLE_DELIMITER),""),r=d[i];if(r.styleFn)return u(u({},e),r.styleFn(o));if(r.name&&r.value)return u(u({},e),{},p({},r.name,r.value(o)))}return e}),{})}},BVsp:function(t,e,i){"use strict";i.r(e);var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("aCH8"),l=i.n(s),c=i("OTSC"),d=i("f3SV"),h=i("MgHC"),u=i.n(h),p=i("5Rpd"),m=i("QNiq"),g=(i("I0kf"),a.a.View.extend({events:{"click .link":"link","click .close-popup":"closePopup","input .login.ljr-panel input.password-input":"onPasswordInput","keydown .login.ljr-panel input":"loginInputKey","click .login.ljr-panel .go":"tryLogin","submit .login.ljr-panel #login_form":"onLoginFormSubmit","click .login.ljr-panel .social-auth":"socialAuth","input .join.ljr-panel input.password-input":"onPasswordInput","keydown .join.ljr-panel input":"joinInputKey","click .join.ljr-panel .go":"createAccount","click .join.ljr-panel .social-auth":"socialAuth","click .join.ljr-panel label .checkmark":"changeCheckboxState","keyup .join.ljr-panel input.for-validate":"validateForm","click .recover.ljr-panel .go":"sendRecoverRequest","click .recover.ljr-panel .go-back":"backFromRecover","input .reset.ljr-panel input":"onPasswordInput","click .reset.ljr-panel .go":"resetPassword","click .login-popup-wrapper":"closeOutsideClick",touchstart:"onTouchStart",touchmove:"onTouchMove"},ERROR_MESSAGES:{invalid_email:"Not a valid email",min:"At least 8 characters long",letters:"Password must include letters",oneOf:"The same as email",password_dont_match:"Passwords don't match"},defaultErrorMessageHTML:'An error has occured. Please contact our support: <a href="mailto:'.concat(d.a.SUPPORT_MAIL,'">').concat(d.a.SUPPORT_MAIL,"</a>."),initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),r.a.extend(this.ERROR_MESSAGES,this.errorMessages),this.template=u.a["template-common-login"],this.template_button_preloader=u.a["template-common-login-preloader"],this.logged=!1,this.animationSpeed=0,this.disableAnimations||r.a.delay(r.a.bind((function(){this.animationSpeed=300}),this),100),this.enableCors(),Object(n.a)(window).on("message",this.processLoginMessages)},render:function(){this.setElement(this.$node||Object(n.a)(this.template({})).appendTo(this.$container)),this.disableScrollWatcher=!!this.$node,this.setElement(this.$el),this.rendered=!0,this.$nameInput=this.$(".join.ljr-panel .fullname-input"),this.$emailInput=this.$(".join.ljr-panel .email-input"),this.$pswInput=this.$(".join.ljr-panel .password-input"),this.$termsCheckbox=this.$(".join.ljr-panel .terms-checkbox"),this.$joinButton=this.$(".join.ljr-panel .go");var t=c.default.queryUrlGetParam("email");t&&this.$(".email-input").val(t)},showError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultErrorMessageHTML;this.$(".join.ljr-panel .error").html(t)},clearErrors:function(){this.$(".join.ljr-panel .error").html("")},link:function(t){if(t.stopPropagation(),2!==t.which&&!t.metaKey&&!t.ctrlKey){var e=Object(n.a)(t.currentTarget).attr("href");if(!e)return!1;if(!this.useNavigate)return/login/i.test(e)&&this.switchTo("login"),/join/i.test(e)&&this.switchTo("join"),/recover/i.test(e)&&this.switchTo("recover"),!1;this.router.navigate(e,{trigger:!0}),t.preventDefault()}},closePopup:function(){Object(n.a)("#homepage-main-project__root-link")&&Object(n.a)("#homepage-main-project__root-link")[0]&&Object(n.a)("#homepage-main-project__root-link")[0].click()},changeCheckboxState:function(t){var e=Object(n.a)(t.target).siblings("input[type='checkbox']");e.is(":checked")?e.prop("checked",!1):e.prop("checked",!0),Object(n.a)(t.target).toggleClass("checked"),Object(n.a)(t.target).parent().siblings("p").toggleClass("checked"),this.validateForm(),t.preventDefault()},validateForm:function(){""!==this.$nameInput.val()&&this.$pswInput.is(":valid")&&this.$emailInput.is(":valid")&&this.$termsCheckbox.is(":checked")?this.$joinButton.addClass("active"):this.$joinButton.removeClass("active")},closeOutsideClick:function(t){m.a.isDesktop&&Object(n.a)(t.target).hasClass("login-popup-wrapper")&&this.closePopup()},show:function(t){this.shown||(Object(n.a)("body").addClass("disable-scroll"),this.urlToBack=t,0===this.animationSpeed&&this.$el.flashClass("no-animation",15),this.$el.removeClass("hidden"),this.trigger("shown"),this.shown=!0,Object(n.a)("body").on("keyup",this.onBodyKeyUp),this.onResize())},hide:function(t){this.shown&&(this.$el.addClass("hidden"),r.a.delay((function(){Object(n.a)("body").removeClass("disable-scroll")}),this.animationSpeed),this.trigger("hidden",t),this.shown=!1,Object(n.a)("body").off("keyup",this.onBodyKeyUp),this.onResize())},onBodyKeyUp:function(t){27===t.keyCode&&this.closePopup()},switchTo:function(t){var e=this.$(".ljr-panel."+t),i=window.matchMedia("(max-width: 768px)").matches,n=e.siblings(".ljr-panel"),o=("recover"===t||"login"===t)&&".dop-container-join"===this.$el.selector&&i;"recover"===t&&this.$(".recover.ljr-panel .email-input").val(this.$(".login.ljr-panel .email-input").val()),e.removeClass("hidden"),m.a.isDesktop&&setTimeout((function(){e.find("input").eq(0).focus()}),0),this.disableAnimations?(n.addClass("hidden"),o&&RM.viewerRouter.mag.onResize()):r.a.delay((function(){n.addClass("hidden"),o&&RM.viewerRouter.mag.onResize()}),this.animationSpeed/4),this.onResize()},onResize:function(){Object(n.a)(window).width()<=768&&this.$(".login").hasClass("hidden")&&this.$(".login-popup-wrapper").css("height",652),Object(n.a)(window).width()<=768&&this.$(".join").hasClass("hidden")&&this.$(".login-popup-wrapper").css("height",466)},showButtonPreloader:function(t){var e,i,o,a=t.width(),r=t.height();e=Object(n.a)(this.template_button_preloader()),t.append(e),t.css({color:"transparent","background-image":"none"}),t.addClass("processing"),i=e.width(),o=e.height(),e.css({left:Math.floor((a-i)/2),top:Math.floor((r-o)/2)})},hideButtonPreloader:function(t){t.find(".rmpreloader").remove(),t.css({color:"","background-image":""}),t.removeClass("processing")},loginInputKey:function(t){13===t.keyCode&&this.tryLogin()},tryLogin:function(){var t=this,e=n.a.trim(this.$(".login.ljr-panel .email-input").val()),i=this.$(".login.ljr-panel .password-input").val(),o=this.$(".login.ljr-panel .go"),a=c.default.queryUrlGetParam("redirect");o.hasClass("processing")||""!==e&&""!==i&&(this.showButtonPreloader(o),this.requestLogin(e,i,(function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Please check that you have entered your login and password correctly.";if(e&&e.redirect)return window.location.href=e.redirect;if(e){if(a)return window.location.href=d.a.readymag_auth_host+a;if(t.logged=!0,c.default.saveJoinData("native"),t.createMagParams)return t.redirectAfterJoin(e.uri);var n=Modernizr.sessionstorage&&window.sessionStorage.getItem("rm.loginReturnUrl",window.location.pathname);Modernizr.sessionstorage&&window.sessionStorage.removeItem("rm.loginReturnUrl"),t.$('.login.ljr-panel #login_form input[name="url"]').val(d.a.readymag_auth_host+(n||"/"+e.uri)),t.$(".login.ljr-panel #login_form").submit()}else t.hideButtonPreloader(o),clearTimeout(t.wrongTimeout),t.$(".login.ljr-panel").addClass("wrong-login"),t.$(".login.ljr-panel .error").html(i),t.wrongTimeout=setTimeout(r.a.bind((function(){this.$(".login.ljr-panel").removeClass("wrong-login")}),t),3500),t.isdesktop||t.$el.scrollTop(9999)})))},requestLogin:function(t,e,i){var o,a=this,r={pass:l()(e)};return r[t.match(/@/)?"email":"uri"]=t,this.clearErrors(),o=d.a.readymag_auth_host+"/api/user/?timestamp="+(new Date).getTime(),n.a.post(o,r,(function(t){i&&i(t)})).error((function(t){i&&i(null,404===t.status?void 0:a.defaultErrorMessageHTML)})),!1},onLoginFormSubmit:function(){return this.logged},showErrors:function(t){clearTimeout(this.wrongTimeout),this.$(".join.ljr-panel").addClass("wrong-join"),this.showError(Array.isArray(t)?t.join(" <br/>"):t),this.wrongTimeout=setTimeout(r.a.bind((function(){this.$(".join.ljr-panel").removeClass("wrong-join")}),this),2e3)},redirectHandler:function(t,e,i){if(t)return window.location.href=t,!0;this.redirectAfterJoin(e.uri,i)},createAccount:function(){var t=this;if(!this.$(".join.ljr-panel input").hasClass("err")&&this.$joinButton.hasClass("active")){var e,i,o,a,s={email:this.$emailInput.val(),name:n.a.trim(this.$(".join.ljr-panel .fullname-input").val()),pass:this.$pswInput.val(),page:window.location.pathname,subscribe:this.$(".join.ljr-panel .subscribe-checkbox").is(":checked")},h=this.$joinButton,u=c.default.queryUrlGetParam("redirect");if(this.clearErrors(),!h.hasClass("processing")&&""!==s.name&&""!==s.email&&""!==s.pass){c.default.isValidEmail(s.email)||(e=!0,o=s.email,this.$emailInput.prop("type","text").addClass("err").val(this.ERROR_MESSAGES.invalid_email));var p=this.getPasswordErrors(s.pass,[s.email]);if(p.length&&(i=!0,a=s.pass,this.$pswInput.prop("type","text").addClass("err").val(this.ERROR_MESSAGES[p[0]])),(e||i)&&(clearTimeout(this.showErrorTimeout),this.showErrorTimeout=setTimeout(r.a.bind((function(){e&&this.$emailInput.removeClass("err").prop("type","email").val(o),i&&this.$pswInput.removeClass("err").prop("type","password").val(a)}),this),3e3)),!e&&!i){this.showButtonPreloader(h),this.router.analytics.sendEvent("Join","General"),s.pass=l()(s.pass);var m=d.a.readymag_auth_host+"/api/register";n.a.ajax({type:"POST",data:s,url:m,success:function(e){c.default.saveJoinData("native"),t.redirectHandler(u,e,h)},error:function(e){var i;t.hideButtonPreloader(h),403===e.status?i="User with email ".concat(s.email," already exists. Forgot your password?"):406===e.status&&(i="Name must not contain links."),t.showError(i)}})}}}},joinInputKey:function(t){13===t.keyCode&&this.createAccount()},sendRecoverRequest:function(){var t=this.$(".recover.ljr-panel .email-input").val(),e=this.$(".recover.ljr-panel .go");e.hasClass("processing")||c.default.isValidEmail(t)&&(this.showButtonPreloader(e),this.requestRecover(t,r.a.bind((function(t){this.hideButtonPreloader(e),this.$(".recover.ljr-panel").addClass("request-sended")}),this)))},requestRecover:function(t,e){var i;this.clearErrors(),i=d.a.readymag_auth_host+"/api/recoverypass",n.a.post(i,{email:t},e).error((function(t){404===t.status?e&&e():this.showError()}))},backFromRecover:function(){this.useNavigate?this.router.navigate("login/",{trigger:!0}):this.switchTo("login")},resetPassword:function(){var t=this,e=n.a.trim(this.$(".reset.ljr-panel .new-password-input").val()),i=n.a.trim(this.$(".reset.ljr-panel .verify-password-input").val()),o=window.ServerData.recover,a=[],s=this.$(".reset.ljr-panel .go");if(!s.hasClass("processing")&&""!==e&&""!==i){if(e!==i&&a.push(this.ERROR_MESSAGES.password_dont_match),this.getPasswordErrors(e).forEach((function(e){return a.push(t.ERROR_MESSAGES[e])})),a.length)return clearTimeout(this.wrongTimeout),this.$(".reset.ljr-panel").addClass("wrong-reset"),this.$(".reset.ljr-panel .error").html(a.join(" <br/>")),void(this.wrongTimeout=setTimeout(r.a.bind((function(){this.$(".reset.ljr-panel").removeClass("wrong-reset")}),this),2e3));o&&o.recover_code&&o.email&&(this.showButtonPreloader(s),n.a.ajax({type:"POST",data:{email:o.email,pass:l()(e),code:o.recover_code},url:d.a.readymag_auth_host+"/api/changepass",success:function(){window.location.href="/login/"},error:r.a.bind((function(){this.hideButtonPreloader(s),this.showError()}),this)}))}},onPasswordInput:function(t){var e=Object(n.a)(t.currentTarget);c.default.filterNonAscii(e)&&(e.addClass("error-input"),r.a.defer(r.a.bind((function(){e.removeClass("error-input")}),this)))},socialAuth:function(t){var e=this;this.$button=Object(n.a)(t.currentTarget);var i=this.$button.attr("data-provider"),o=d.a.readymag_auth_host+"/api/auth/"+i;if(!this.$button.hasClass("processing")){this.showButtonPreloader(this.$button),this.$button.closest(".join.ljr-panel").length&&this.router.analytics&&this.router.analytics.sendEvent("Join","General ".concat(i));var a=screen.width,r=screen.height,s=Math.min(1e3,a),l=Math.min(700,r-40),c=Math.ceil((a-s)/2),h=Math.ceil((r-l)/2);this.socialAuthWindow=window.open(o,"_blank",["toolbar=no","location="+(window.opera?"no":"yes"),"directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no","width="+s,"height="+l,"top="+h,"left="+c].join()),this.authInProgress=!0,this.popupCheckInterval=setInterval((function(){e.socialAuthWindow&&!e.socialAuthWindow.closed||(e.authInProgress=!1,clearInterval(e.popupCheckInterval),e.hideButtonPreloader(e.$button))}),100)}},handleSocialAuthResult:function(t){var e,i=this;if(this.authInProgress=!1,!t||t.error||!t.user||!t.user.uri)return this.hideButtonPreloader(this.$button),t.error&&(this.$el.scrollTop(this.$el[0].scrollHeight-this.$el.outerHeight()),this.showErrors(["Something went wrong"]),clearTimeout(this.showSocialErrorTimeout),this.showSocialErrorTimeout=setTimeout((function(){i.clearErrors()}),4e3)),void(t.user&&t.user.name&&(this.switchTo("join"),this.$(".join.ljr-panel .fullname-input").val(t.user.name),this.$(".join.ljr-panel .email-input").focus()));if(t.user.createdViaFacebook&&(e="facebook"),t.user.createdViaGoogle&&(e="google"),e)c.default.saveJoinData(e),this.redirectAfterJoin(t.user.uri,this.$button);else{var n=c.default.queryUrlGetParam("redirect");if(n)return window.location.href=d.a.readymag_auth_host+n;window.location.href=d.a.readymag_auth_host+"/"+t.user.uri}},processLoginMessages:function(t){if(this.authInProgress){var e=t.originalEvent||{};if(e.origin===d.a.readymag_auth_host){var i=JSON.parse(decodeURIComponent(e.data));i&&"social-auth"===i.event&&(clearInterval(this.popupCheckInterval),this.socialAuthWindow&&this.socialAuthWindow.close(),this.handleSocialAuthResult(i.message))}}},redirectAfterJoin:function(t){var e=r.a.isFunction(this.joinCallback)?500:0;r.a.isFunction(this.joinCallback)&&this.joinCallback();var i=c.default.queryUrlGetParam("redirect");if(i)return window.location.href=d.a.readymag_auth_host+i;setTimeout(r.a.bind((function(){var e=d.a.readymag_auth_host+"/"+t+"/";if(!m.a.isDesktop||Modernizr.msie||Modernizr.msie11)window.location.href=e;else{var i=Modernizr.sessionstorage&&window.sessionStorage.getItem("rm.loginReturnUrl",window.location.pathname);if(Modernizr.sessionstorage&&window.sessionStorage.removeItem("rm.loginReturnUrl"),i)return window.location.href=d.a.readymag_auth_host+i;var n=this.createMagParams,o=n&&n.templateID,a=n&&n.tp?n.tp+"-join-form":"join-form";new p.default({router:this.router,me:{permissions:{can_create_mag:!0},uri:t},tp:a,templateID:o,noCreateRequestTracking:n&&n.noCreateRequestTracking,error:r.a.bind((function(){this.hideButtonPreloader(this.$button)}),this)})}}),this),e)},enableCors:function(){n.a.ajaxPrefilter((function(t,e,i){-1!==t.url.indexOf(d.a.readymag_auth_host)&&(t.xhrFields={withCredentials:!0})}))},onTouchStart:function(t){this.disableScrollWatcher||(this.scrollY=t.originalEvent.touches.item(0).clientY)},onTouchMove:function(t){if(!this.disableScrollWatcher){var e=Object(n.a)(t.currentTarget),i=this.scrollY-t.originalEvent.touches.item(0).clientY;(i<0&&e.scrollTop()<=0||i>0&&e.scrollTop()+e.height()>=e[0].scrollHeight)&&t.preventDefault(),this.scrollY=t.originalEvent.touches.item(0).clientY}},destroy:function(){this.hide(),Object(n.a)(window).off("message",this.processLoginMessages),setTimeout(r.a.bind((function(){this.$el.remove()}),this),400)},getPasswordErrors:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return t.length<8&&i.push("min"),e.includes(t)&&i.push("oneOf"),/[a-zA-Z]+/.test(t)||i.push("letters"),i}}));e.default=g},BrCd:function(module,exports){module.exports={"template-viewer-cart-sidebar":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n  <div id="cart-sidebar" class="cart-sidebar',isViewer&&(__p+=" cart-in-viewer"),__p+="",isMobile&&(__p+=" cart-is-mobile"),__p+='">\n    <div class="close-button" data-alt="Close cart" data-alt-pos="bottom" data-alt-offset="9">\n      <div class="line-1"></div>\n      <div class="line-3"></div>\n    </div>\n\n    <div class="text-size-calc-container"></div>\n\n    <div class="cart-sidebar-wrapper">\n      <div class="cart-sidebar-tabs">\n\n        <div class="cart-sidebar-tab tab-items active">\n          <div class="sidebar-header">\n            <div class="sidebar-title">\n              <input\n                  type="text"\n                  class="cart-text-input cart-title-input"\n                  name="title"\n                  placeholder="Cart"\n                  maxlength="32"\n                  translate="no"\n                  autocomplete="off"\n                  autocorrect="off"\n                  spellcheck="false"\n                  ',isViewer&&(__p+="readonly"),__p+='\n                />\n            </div>\n            <div class="sidebar-settings-container"></div>\n          </div>\n\n          <div class="sidebar-body">\n            <div class="cart-items-list"></div>\n            <div class="sidebar-btn сheck-out-btn" data-tab="tab-inputs" aria-labelledby="cart-sidebar-checkout-button">\n              <input\n                type="text"\n                class="cart-text-input cart-checkout-input"\n                name="checkout"\n                placeholder="Check out"\n                maxlength="32"\n                translate="no"\n                autoComplete="off"\n                autocorrect="off"\n                spellcheck="false"\n                ',isViewer&&(__p+="readonly"),__p+='\n              />\n              <img class="btn-icon-right svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/viewer/cart-sidebar/sidebar-right-arrow.svg" />\n            </div>\n            <div class="empty-cart">\n              <div class="empty-cart-title">\n                <input\n                  type="text"\n                  class="cart-text-input empty-cart-title-input"\n                  name="emptyСartTitle"\n                  placeholder="Cart is empty"\n                  maxlength="32"\n                  translate="no"\n                  autoComplete="off"\n                  autocorrect="off"\n                  spellcheck="false"\n                  ',isViewer&&(__p+="readonly"),__p+='\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="cart-sidebar-tab tab-inputs">\n          <div class="sidebar-header">\n            <div class="sidebar-btn go-back" data-tab="tab-items">\n                <img class="btn-icon-center svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/viewer/cart-sidebar/sidebar-left-arrow.svg" />\n            </div>\n            <div class="sidebar-btn go-forward" data-tab="tab-order">\n              Summary\n              <img class="btn-icon-right svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/viewer/cart-sidebar/sidebar-right-arrow.svg" />\n            </div>\n          </div>\n          <div class="sidebar-body">\n            <div class="order-details-form shipping-form">\n              <div class="form-title">Shipping address</div>\n              <div class="form-row">\n                <div class="form-error country-error hidden"></div>\n                <div class="countries-select"></div>\n              </div>\n              <div class="form-row">\n                <div class="form-error name-error hidden"></div>\n                <input type="text" class="form-input name-input" name="name" placeholder="Customer name" />\n              </div>\n              <div class="form-row">\n                <div class="form-error line1-error hidden"></div>\n                <input type="text" class="form-input line1-input" name="line1" placeholder="Address" />\n              </div>\n              <div class="form-row">\n                <input type="text" class="form-input line2-input" name="line2" placeholder="Apt, unit, building, floor…" />\n              </div>\n              <div class="form-row">\n                <div class="form-error city-error hidden"></div>\n                <input type="text" class="form-input city-input" name="city" placeholder="City" />\n              </div>\n              <div class="form-row">\n                <input type="text" class="form-input state-input" name="state" placeholder="State/Region" />\n              </div>\n              <div class="form-row">\n                <input type="text" class="form-input postal_code-input" name="postal_code" placeholder="Zip/Postal code" />\n              </div>\n              <div class="form-row">\n                <div class="form-error phone-error hidden"></div>\n                <input type="text" class="form-input phone-input" name="phone" placeholder="Phone" />\n              </div>\n            </div>\n            <div class="order-details-form">\n              <div class="form-title">Email</div>\n              <div class="form-row">\n                <div class="form-error email-error hidden"></div>\n                <input type="text" class="form-input email-input" name="email" placeholder="address@sample.com" />\n              </div>\n            </div>\n            <div class="order-details-form">\n              <div class="form-title">Note</div>\n              <div class="form-row">\n                <textarea class="form-input note-input" rows="4" name="note" placeholder="Add shipping details"></textarea>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="cart-sidebar-tab tab-order">\n          <div class="sidebar-header">\n            <div class="sidebar-btn go-back" data-tab="tab-inputs">\n                <img class="btn-icon-center svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/viewer/cart-sidebar/sidebar-left-arrow.svg" />\n            </div>\n            <div class="sidebar-btn go-forward cart-pay-btn hidden" data-tab="tab-checkout">\n              Pay\n              <img class="btn-icon-right svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/viewer/cart-sidebar/sidebar-right-arrow.svg" />\n            </div>\n            <div class="preloader">\n              <div class="svg-wrap">\n              <svg width="14px" height="26px" viewBox="0 0 14 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n                      <g transform="translate(-1094.000000, -34.000000)" fill-rule="nonzero" stroke="#FFFFFF" stroke-width="2">\n                          <g transform="translate(1070.000000, 22.000000)">\n                              <path d="M25,37 C31.627417,37 37,31.627417 37,25 C37,18.372583 31.627417,13 25,13" id="Path"></path>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n              </div>\n            </div>\n          </div>\n\n          <div class="sidebar-body">\n            <div class="order-details">\n              <div class="order-items-block order-row">\n                <div class="order-title-row summary-title">Order summary</div>\n                <div class="order-items-list order-info-block"></div>\n              </div>\n              <div class="order-id-container order-row">\n                  <div class="order-title-row">Order ID</div>\n                  <div class="order-id order-info-block"></div>\n              </div>\n              <div class="shipping-details">\n                <div class="shipping-address order-row">\n                  <div class="order-title-row">Shipping address</div>\n                  <div class="order-shipping-address order-info-block"></div>\n                </div>\n                <div class="shipping-method order-row">\n                    <div class="order-title-row">Shipping method</div>\n                    <div class="order-shipping-method order-info-block"></div>\n                </div>\n              </div>\n              <div class="shipping-tax-size order-row">\n                <div class="order-title-row">Order tax</div>\n                <div class="order-tax order-info-block"></div>\n              </div>\n              <div class="shipping-email order-row hidden">\n                    <div class="order-title-row">Email</div>\n                    <div class="order-shipping-email order-info-block"></div>\n              </div>\n              <div class="shipping-phone order-row hidden">\n                    <div class="order-title-row">Phone</div>\n                    <div class="order-shipping-phone order-info-block"></div>\n              </div>\n              <div class="shipping-total-price order-row">\n                <div class="order-title-row">Grand total</div>\n                <div class="order-total-price order-info-block"></div>\n              </div>\n            </div>\n          </div>\n          <div class="order-error hidden">\n            <div class="order-error-container">\n              <div class="order-error-title">\n                Error\n              </div>\n              <div class="order-error-message">\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class="cart-sidebar-tab tab-checkout">\n          <div class="sidebar-header">\n            <div class="sidebar-btn go-back" data-tab="tab-order">\n                <img class="btn-icon-center svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/viewer/cart-sidebar/sidebar-left-arrow.svg" />\n            </div>\n            <div class="preloader">\n              <div class="svg-wrap">\n              <svg width="14px" height="26px" viewBox="0 0 14 26" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n                      <g transform="translate(-1094.000000, -34.000000)" fill-rule="nonzero" stroke="#FFFFFF" stroke-width="2">\n                          <g transform="translate(1070.000000, 22.000000)">\n                              <path d="M25,37 C31.627417,37 37,31.627417 37,25 C37,18.372583 31.627417,13 25,13" id="Path"></path>\n                          </g>\n                      </g>\n                  </g>\n              </svg>\n              </div>\n            </div>\n          </div>\n\n          <div class="sidebar-body">\n            <div class="payment-title">Pay with card</div>\n            <form action="/charge" method="post" id="payment-form">\n              <div class="form-row">\n                <div class="form-error card-number-error hidden"></div>\n                <div id="card-number-element" class="payment-input">\n                </div>\n              </div>\n              <div class="form-row">\n                <div class="form-error card-expiry-error hidden"></div>\n                <div id="card-expiry-element" class="payment-input">\n                </div>\n              </div>\n              <div class="form-row">\n                <div class="form-error card-name-error hidden"></div>\n                <input type="text" class="payment-input card-name-input hidden" name="name" placeholder="Name on card" />\n              </div>\n              <div class="form-row">\n                <div class="form-error card-cvc-error hidden"></div>\n                <div id="card-cvc-element" class="payment-input">\n                </div>\n              </div>\n\n              \x3c!-- Used to display Element errors. --\x3e\n              <div id="card-number-errors" role="alert"></div>\n              <div id="card-expiry-errors" role="alert"></div>\n              <div id="card-name-errors" role="alert"></div>\n              <div id="card-cvc-errors" role="alert"></div>\n\n              <div id="payment-failed-msg">\n                <div class="failed-msg-content">\n                  <div class="error-icon">\n                    <svg width="4px" height="27px" viewBox="0 0 4 27" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n                      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                          <g transform="translate(-1010.000000, -261.000000)" fill="#FFFFFF" fill-rule="nonzero">\n                              <g transform="translate(1010.000000, 261.000000)">\n                                  <g>\n                                      <path d="M2,0 C3.05322259,-1.93473851e-16 3.90702819,0.853805605 3.90702819,1.90702819 C3.90702819,1.93727706 3.90630849,1.96752165 3.9048697,1.99773628 L3.04535404,20.0475651 C3.01996411,20.5807536 2.58027854,21 2.0464859,21 L1.9535141,21 C1.41972146,21 0.980035886,20.5807536 0.954645959,20.0475651 L0.0951302988,1.99773628 C0.045033609,0.945705789 0.857261433,0.0522551831 1.90929192,0.00215849327 C1.93950655,0.000719701408 1.96975113,5.55662667e-18 2,0 Z"></path>\n                                      <circle cx="2" cy="25" r="2"></circle>\n                                  </g>\n                              </g>\n                          </g>\n                      </g>\n                    </svg>\n                  </div>\n                  <div class="error-message"></div>\n                </div>\n              </div>\n\n              <button class="sidebar-btn cart-payment-btn">Pay</button>\n            </form>\n            <div id="payment-request-button"></div>\n            <div class="cart-cancel-btn">Cancel order</div>\n          </div>\n          <div id="payment-success-msg">\n            <div class="success-msg-content">\n              <div class="title">Payment completed</div>\n              <div class="description">Check your email for details</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n';return __p}}},C84a:function(t,e,i){"use strict";var n={props:{width:{default:40},height:{default:40}}},o=(i("tkcp"),i("KHd+")),a=Object(o.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:this.width,height:this.height,viewBox:"0 0 40 40"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20 32C26.6274 32 32 26.6274 32 20C32 13.3726 26.6274 8 20 8C13.3726 8 8 13.3726 8 20C8 26.6274 13.3726 32 20 32ZM25.9497 14.0503C26.3403 14.4408 26.3403 15.0739 25.9497 15.4645L21.4142 20L25.9497 24.5355C26.3403 24.9261 26.3403 25.5592 25.9497 25.9497C25.5592 26.3403 24.9261 26.3403 24.5355 25.9497L20 21.4142L15.4645 25.9497C15.0739 26.3403 14.4408 26.3403 14.0503 25.9497C13.6597 25.5592 13.6597 24.9261 14.0503 24.5355L18.5858 20L14.0503 15.4645C13.6597 15.0739 13.6597 14.4408 14.0503 14.0503C14.4408 13.6597 15.0739 13.6597 15.4645 14.0503L20 18.5858L24.5355 14.0503C24.9261 13.6597 25.5592 13.6597 25.9497 14.0503Z"}})])}),[],!1,null,"56560eec",null);e.a=a.exports},CXd4:function(module,exports){module.exports={"template-viewer-navigation":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="navigation">\n\t\t<div class="navigation-arrow left offscreen"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div></div>\n\t\t<div class="navigation-arrow right offscreen"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div></div>\n\t\t<div class="navigation-arrow bottom offscreen"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+"')\"></div></div>\n\t</div>\n\n";return __p}}},Cmem:function(t,e,i){t.exports=i.p+"img/constructor/controls/add_to_cart_settings/color-disabled.svg"},CsnC:function(module,exports){module.exports={"template-constructor-pages-panel-settings-privacy":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="privacy-caption">Password Protection</div>\n\t<div class="switcher-password"></div>\n\t<div class="input-pass-wrapper">\n\t\t<input class="input password" spellcheck="false" value="'+(null==(__t=mag.pass||"")?"":_.escape(__t))+'"/>\n\t\t<div class="save-password">Save</div>\n\t</div>\n\t<div class="password-status"></div>\n    <div class="background">\n      <div class="caption">Background image</div>\n      <div class="upload-button">\n        <span>Clear</span>\n        <input class="bg-uploader" type="file" name="upload" data-url="/api/upload"/>\n        <div class="bg-preloader">\n          <div class="rmpreloader">\n            <div class="arc"></div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n\t',is_contributor?__p+='\n\t<div class="expired-subscription-message hidden">Please upgrade owner’s account to use password protection.\n\t<div><a class="pricing-link" href="mailto:'+(null==(__t=owner_email)?"":__t)+'">Contact owner</a></div>\n\t</div>\n\t':__p+='\n\t<div class="expired-subscription-message hidden">Please <a class="link" href="/settings#change-plan">upgrade</a> your account<br/>to use password protection.\n\t<div><a class="pricing-link" href="/pricing" target="_blank">See the pricing</a></div>\n\t</div>\n\t',__p+='\n\n\n\t\x3c!--__magterm--\x3e\n\t<div class="privacy-description">Password-protected project will be hidden from your profile page and only people with the link and password can view it.</div>\n\t<div class="noback-message error invisible">Please note that if you remove the password, you won’t be able to set it back again as your current subscription plan doesn’t support password protection.</div>\n\t<div class="privacy-opts-block opt-allowindex">\n\t\t\x3c!--__magterm--\x3e\n\t\t<div class="caption">Search engine optimization</div>\n\t\t<div class="desc">Visible for ​search engines</div>\n\t\t<div class="switcher allowindex"></div>\n\t</div>\n\t<div class="privacy-opts-block opt-hide">\n\t\t\x3c!--__magterm--\x3e\n\t\t<div class="caption">Show this project on my profile page</div>\n\t\t<div class="switcher hide"></div>\n\t</div>\n';return __p}}},D12m:function(t,e,i){"use strict";var n=i("xi34"),o=i("rFsW"),a=function(){};a.prototype={text_viewport_attributes:["style","class","data-size-leading-linked","data-size-leading-ratio","data-anchor-link-pos"],switchTextToViewport:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;if("default"===e)return t;var i=Object(n.a)("<div>").html(t),a=this.text_viewport_attributes,r=this;i.find("*").each((function(){var t=Object(n.a)(this);o.a.each(a,(function(i){var n=r.getViewportAttributeName(i,e),o=r.getViewportAttributeName(i,"default"),a=t.attr(n),s=t.attr(i);t.removeAttr(o),s&&t.attr(o,s),a&&("empty"===a?t.removeAttr(i):t.attr(i,a))}))}));var s=i.html();return i.empty().remove(),s},getViewportAttributeName:function(t,e){var i=t+"-"+e;return/^data/.test(i)||(i="data-"+i),i}},e.a=a},DA8H:function(module,exports){module.exports={"template-constructor-control-text_columns":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Columns" data-alt-pos="left" data-alt-offset="9"></div>\n\t<div class="panel">\n\t\t<div class="substract"></div>\n\t\t<div class="add"></div>\n\t\t<div class="number">1</div>\n\n\t\t<div class="separator"></div>\n\n\t\t<div class="bg-color" title="Background Color">\n\t\t\t<div class="color"></div>\n\t\t\t<div class="arrow-icon"></div>\n\t\t</div>\n\n\t\t<div class="gutter">\n\t\t\t<div class="grid"></div>\n\t\t\t<input class="gap" type="text" spellcheck="false" value="" title="Column Gap"/>\n\t\t</div>\n\n\t\t<div class="colorbox_container"></div>\n\t</div>\n';return __p}}},Da6b:function(t,e,i){"use strict";var n=i("tb9p");i.n(n).a},DiDd:function(module,exports){module.exports={"template-common-add-to-cart-wrap":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="add-to-cart-wrap">\n\t\t<div class="add-to-cart-attributes"></div>\n\t\t<div class="button-wrap">\n\t\t\t<div class="add-to-cart-button">\n\t\t\t\t<div class="add-to-cart-error-block"></div>\n\t\t\t\t<div class="button-icon"></div>\n\t\t\t\t<input type="text" class="button-text" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" readonly="readonly"/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="sizes-calculating-block"></div>\n\t</div>\n';return __p}}},DqjY:function(t,e,i){"use strict";var n=i("xi34"),o=i("rFsW"),a=i("f3SV"),r=i("OTSC"),s=i("v92f"),l=i("wAEK"),c=i.n(l),d=i("I0kf"),h=i("fueH"),u={STYLE_PREFIXES:{paragraph:{viewer:[".used-fonts-test p",".rmwidget.text div p"],editor:["p"],constructor:[".used-fonts-test p",".block.block-text .text-preview p",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h1":{viewer:[".used-fonts-test h1",".rmwidget.text div h1"],editor:["h1"],constructor:[".used-fonts-test h1",".block.block-text .text-preview h1",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h2":{viewer:[".used-fonts-test h2",".rmwidget.text div h2"],editor:["h2"],constructor:[".used-fonts-test h2",".block.block-text .text-preview h2",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h3":{viewer:[".used-fonts-test h3",".rmwidget.text div h3"],editor:["h3"],constructor:[".used-fonts-test h3",".block.block-text .text-preview h3",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},"header-h4":{viewer:[".used-fonts-test h4",".rmwidget.text div h4"],editor:["h4"],constructor:[".used-fonts-test h4",".block.block-text .text-preview h4",".controls .control.text_styles .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .paragraph-style .style-caption"]},link:{viewer:[".rmwidget.text div a"],editor:["a"],constructor:[".block.block-text .text-preview a",".controls .control.text_link .panel .resizable-scroll-wrapper .resizable-content-wrapper .resizable-content .link-style .style-caption"]}},fontsShortList:{},generateStylesStr:function(t){var e,i,n,o="",a=t.style,s=t.indentation?"\t":"",l=";"+(t.lineBreaks?"\n":""),c=t.attrPrefix||"";return"paragraph"==t.tp&&(o+=s+"font-family: "+d("font-family")+l,o+=s+"font-style: "+d("font-style")+l,o+=s+"font-weight: "+d("font-weight")+l,o+=s+"font-size: "+h(d("font-size"))+l,o+=s+"letter-spacing: "+h(d("letter-spacing"))+l,o+=s+"line-height: "+h(d("line-height"))+l,o+=s+"text-align: "+d("text-align")+l,o+=s+"text-decoration: "+d("text-decoration")+l,o+=s+"text-transform: "+d("text-transform")+l,o+=s+"color: "+r.default.getRGBA(d("color"),d("opacity")/100)+l,o+=s+"padding-top: "+h(d("padding-top"))+l,o+=s+"padding-right: "+h(d("padding-right"))+l,o+=s+"padding-bottom: "+h(d("padding-bottom"))+l,o+=s+"padding-left: "+h(d("padding-left"))+l),"link"==t.tp&&(o+=s+"text-decoration: none"+l,o+=s+"color: "+r.default.getRGBA(d("color"),d("opacity")/100)+l,"none"!=d("u-style")?(e=r.default.getRGBA(d("u-color"),d("u-opacity")/100),i=parseInt(d("u-size"),10),n=parseInt(d("u-offset"),10)+i,o+=s+"padding-bottom: "+h(Math.max(n,0))+l,"solid"==d("u-style")&&(o+=s+"background: linear-gradient(to right, "+e+" 0%, "+e+" 100%)"+l,o+=s+"background-size: 1px "+h(i)+l),"dotted"==d("u-style")&&(o+=s+"background: linear-gradient(to right, "+e+" 0%, "+e+" 50%, transparent 50%,transparent 100%)"+l,o+=s+"background-size: "+h(2*i)+" "+h(i)+l),"dashed"==d("u-style")&&(o+=s+"background: linear-gradient(to right, "+e+" 0%, "+e+" 66.6666%, transparent 66.6666%,transparent 100%)"+l,o+=s+"background-size: "+h(3*i)+" "+h(i)+l),o+=n<0?s+"background-position: 0 "+(100+n)+"%"+l:s+"background-position: 0 100%"+l,o+=s+"background-repeat: repeat-x"+l):o+=s+"background: none"+l),o;function d(t){var e=a[c+t];return"inherit"==e&&c&&(e=a[t]),e}function h(t){return t+(/px/i.test(t)?"":"px")}},generateCSS:function(t,e,i,r,s){if(r){var l=this.STYLE_PREFIXES[t][e],c=(s=s||{},this),d="";o.a.each(r,(function(i){if("paragraph"==t&&(i.tag&&"p"!==i.tag&&a.a.AVAILABLE_TEXT_TAGS.includes(i.tag)&&(l=[].concat(c.STYLE_PREFIXES["header-"+i.tag][e],c.STYLE_PREFIXES[t][e]).filter((function(t,e,i){return i.indexOf(t)===e}))),d+=o.a.map(l,(function(t){return t+"."+i._name})).join(",\n")+" {\n",d+=c.generateStylesStr({tp:t,style:i,indentation:!0,lineBreaks:!0}),d+="}\n\n"),"link"==t){if(s.forcePseudoState&&s.forcePseudoClass==i._name)d+=o.a.map(l,(function(t){return t+"."+i._name})).join(",\n")+" {\n",d+=c.generateStylesStr({tp:t,style:i,attrPrefix:s.forcePseudoState+"-",indentation:!0,lineBreaks:!0}),d+="}\n\n";else d+=o.a.map(l,(function(t){return t+"."+i._name})).join(",\n")+" {\n",d+=c.generateStylesStr({tp:t,style:i,indentation:!0,lineBreaks:!0}),d+="}\n\n",o.a.find(o.a.keys(i),(function(t){return/^current/.test(t)}))&&(d+=o.a.map(l,(function(t){return t+".current."+i._name})).join(",\n")+" {\n",d+=c.generateStylesStr({tp:t,style:i,attrPrefix:"current-",indentation:!0,lineBreaks:!0}),d+="}\n\n"),d+=o.a.map(l,(function(t){return t+".hovered."+i._name})).join(",\n")+" {\n",d+=c.generateStylesStr({tp:t,style:i,attrPrefix:"hover-",indentation:!0,lineBreaks:!0}),d+="}\n\n";d+=o.a.map(l,(function(t){return t+"."+i._name+" *"})).join(",\n")+" {\n",d+="\tcolor: inherit !important;\n",d+="\ttext-decoration: none !important;\n",d+="}\n\n"}})),i=i||document;var h="text_styles_"+t+"_"+e;Object(n.a)("#"+h,i).remove();var u=i.createElement("style");u.type="text/css",u.id=h,u.className="text_styles",u.appendChild(i.createTextNode(d)),i.getElementsByTagName("head")[0].appendChild(u)}},appendFontsCssToDocument:function(t,e){window.TypekitPreview&&window.TypekitPreview.setup&&window.TypekitPreview.setup({auth_id:a.a.TYPEKIT_ID,auth_token:a.a.TYPEKIT_TOKEN,default_subset:"all"});var i,s=Object(n.a)("link.fonts, style.fonts"),l=[],c=[],d={};s.each((function(){var t=Object(n.a)(this),e=t.attr("data-provider"),i=t.attr("data-fonts-and-variations").split("||");o.a.each(i,(function(t){l.push(e+"|"+t)}))})),o.a.each(t.fonts,(function(t){o.a.each(t.used_variations||t.variations,(function(e){c.push(t.provider+"|"+t.css_name+"|"+e)}))})),i=o.a.difference(c,l);var h={};o.a.each(i,(function(t){var e=t.split("|"),i=e[0],n=e[1],o=e[2],a=i+"|"+n;h[a]=h[a]||[],h[a].push(o)}));var u=[];o.a.each(h,(function(t,e){var i=e.split("|"),n=i[0],o=i[1],a=t;u.push({provider:n,css_name:o,variations:a})})),o.a.each(u,(function(e){var i,a=e.provider,r=e.css_name+"|"+e.variations.join("||"+e.css_name+"|");if(d[a]||(d[a]=[]),"google"==a){var s=n.a.map(e.variations,(function(t){return 100*(t.substr(1,1)-0)+("n"==t.substr(0,1)?"":"italic")}));i={fontAndVariations:r,data:e.css_name.split(" ").join("+")+":"+s.join(",")}}if("webtype"==a&&(i={fontAndVariations:r,data:e.css_name+":"+e.variations.join(",")}),"typetoday"==a&&(i={fontAndVariations:r,data:e.css_name+":"+e.variations.join(",")}),"custom"==a){var l=o.a.findWhere(t.fonts,{provider:"custom",css_name:e.css_name});l&&l.css_url&&(i={fontAndVariations:r,data:{css_name:e.css_name,css_url:l.css_url,signed_css_url:l.signed_css_url}})}"typekit"==a&&(i={fontAndVariations:r,data:{id:e.css_name,variations:e.variations}}),i&&d[a].push(i)}));var p=RM.screenshot&&"true"==r.default.queryUrlGetParam("pdf");p&&this.loadTypekitSubstitutionFonts(d.typekit);var m=o.a.has(d,"custom");function g(t){var e=Object(n.a)("<link>").attr("type","text/css").attr("rel","stylesheet").attr("href",t);Object(n.a)("head").append(e)}o.a.each(d,(function(i,s){var l,c,d,h,u,m,f="custom"==s?1:"google"==s?22:i.length,v=Math.ceil(i.length/f),b=0,y=function(){if(c=l*f,d=Math.min((l+1)*f,i.length),h=i.slice(c,d),u=o.a.pluck(h,"data"),m=o.a.pluck(h,"fontAndVariations"),Object(n.a)("link, style").addClass("existing"),"google"==s&&(w=(a.a.IS_FILE_PROTOCOL?"http://":"//")+"fonts.googleapis.com/css?family=",_=u.join("%7C"),"&subset=latin,vietnamese,khmer,cyrillic-ext,greek-ext,greek,devanagari,latin-ext,cyrillic",g(w+_+"&subset=latin,vietnamese,khmer,cyrillic-ext,greek-ext,greek,devanagari,latin-ext,cyrillic")),"typekit"==s){if("edit"==t.version&&!p)try{window.TypekitPreview&&window.TypekitPreview.load(u)}catch(t){}"published"==t.version&&t.typekit_url&&("undefined"!=typeof Typekit&&(Typekit=void 0),Object(n.a)("style.typekit-kit").remove(),n.a.getScript(t.typekit_url,(function(t,e,i){try{Typekit.load({active:function(){var t=Object(n.a)("style").filter((function(t,e){return/typekit/i.test(e.innerHTML)}));t.addClass("typekit-kit"),y(t)}})}catch(t){}})))}var v;function y(t){t.addClass("fonts").attr("data-id",r.default.generateUUID()).attr("data-provider",s).attr("data-fonts-and-variations",m.join("||"))}"webtype"==s&&(w=RM.common.isDownloadedSource?a.a.readymag_host:"",Object(n.a)('link.fonts[data-provider="webtype"]').length||(k=window.ServerData&&window.ServerData.fonts&&window.ServerData.fonts.webtype,g(w+k))),"typetoday"!=s||p||(w=RM.common.isDownloadedSource?a.a.readymag_host:"",Object(n.a)('link.fonts[data-provider="typetoday"]').length||(k=window.ServerData&&window.ServerData.fonts&&window.ServerData.fonts.typetoday,g(w+k))),"custom"==s&&(S=u[0].signed_css_url||u[0].css_url,/^\/api\/fonts\//i.test(S)?(v=Object(n.a)("<style>").attr("type","text/css"),Object(n.a)("head").append(v),n.a.get(S,(function(t){v.text(t),++b>=i.length&&o.a.isFunction(e)&&e()}))):g(S)),y(Object(n.a)("link:not(.existing), style:not(.existing)")),Object(n.a)("link, style").removeClass("existing")};for(l=0;l<v;l++){var _,w,k,S;y()}})),!m&&o.a.isFunction(e)&&e()},loadTypekitSubstitutionFonts:function(t){t&&t.length&&o.a.each(t,(function(t){var e,i=t.data.id,a=(t.data.variations,{"sans-serif":"news-gothic",decorative:"news-gothic",handmade:"news-gothic",blackletter:"news-gothic",script:"news-gothic","slab-serif":"news-gothic",serif:"georgia-pro",monospaced:"nitti"}),r="template-export-pdf-typekit-substitution-"+(a[(e=(e=(e=o.a.findWhere(u.fontsShortList.typekit,{id:i}))&&e.browse_info)&&e.classification)&&e.length&&e[0]||"sans-serif"]||a["sans-serif"]),s=(0,c.a[r])({id:i});Object(n.a)("head").append(s)}))},appendFontsCssToIFrame:function(t){var e=Object(n.a)("link.fonts, style.fonts"),i=Object(n.a)("link.fonts, style.fonts",t),o={},a=Object(n.a)("head",t);i.each((function(){o[Object(n.a)(this).attr("data-id")]=!0})),e.each((function(){var t=Object(n.a)(this),e=this.href;if(!o[t.attr("data-id")]){var i=t.clone();e&&Modernizr.safari&&i.attr("href",e+"&edit_mode=true"),i.appendTo(a)}}))},isFastFontLoadCheckAvailable:function(){return Boolean(document.fonts&&window.Promise)},fastWaitForFontLoad:function(t,e,i){var n;if(document.fonts){var o=i+" "+e+" 12px "+t,a=Object(d.a)("viewer.simpleFontLoadCheck")?document.fonts.load(o):document.fonts.load(o).then(function(){return document.fonts.check(o)?o:this.fontLoadedTimeoutCheck(o)}.bind(this)),r=new window.Promise((function(t,e){setTimeout(e.bind(null,o),3500)}));n=window.Promise.race([a,r])}else n=window.Promise.reject();return n},exactWaitForFontLoad:function(t,e,i,o){var a=i+" "+e+" 12px "+t+", Arial",r=i+" "+e+" 12px Arial",s=Object(n.a)('<canvas width="20" height="20"></canvas>'),l=s[0],c=l.getContext("2d"),d="",h="",u=+new Date;s.appendTo("body").css({position:"absolute",left:0,top:"-999px"}),function n(){var p=+new Date-u>1e4,m=function(){var t=a;c.clearRect(0,0,20,20),d||(d=l.toDataURL("image/png"),t=r);c.font=t,c.fillStyle="000",c.fillText("a1-&q",0,20);var e=l.toDataURL("image/png");h||(h=e);return e!=d&&e!=h}();if(m||p)return c=void 0,s.remove(),void o(m,t,e,i);setTimeout(n,100)}()},fontLoadedTimeoutCheck:function(t){var e=Date.now();return new window.Promise((function(i,n){!function i(n,o){var a=Date.now()-e;document.fonts.check(t)?n(t):a<3500?setTimeout(i.bind(null,n,o),100):o(t)}(i,n)}))},getHotspotTextModels:function(t){var e=[];return t.widgets_collection&&t.widgets_collection.length&&(e=t.widgets_collection.filter((function(e){return"text"==e.get("type")&&t.get("wids").indexOf(e.get("_id"))>-1}))),t._nestedWidgetsJSON&&t._nestedWidgetsJSON.length?e=o.a.filter(t._nestedWidgetsJSON,(function(t){return"text"==t.type})):t.wids&&t.wids.length&&(e=o.a.filter(t.wids,(function(t){return"text"==t.type}))),e},getUsedFontsFromWidgetsModels:function(t){var e={},i={},n={},r={},l={},c={},d=t.models;function p(t,e){return"function"==typeof t.get?t.get(e):t[e]}for(var m=0;m<d.length;m++){var g=d[m];if("slideshow"==p(g,"type")&&p(g,"text_style")){var f=p(g,"text_style");f["font-family"]&&f["font-weight"]&&f["font-style"]&&(i[f["font-family"]+"|"+f["font-style"]+"|"+f["font-weight"]]=1)}if("button"==p(g,"type")){p(g,"font-family")&&p(g,"font-weight")&&p(g,"font-style")&&(n[p(g,"font-family")+"|"+p(g,"font-style")+"|"+p(g,"font-weight")]=1);for(var v=0;v<s.b.viewports.length;v++){var b=g["viewport_"+s.b.viewports[v].name];b&&(n[b["font-family"]+"|"+b["font-style"]+"|"+b["font-weight"]]=1)}}if(p(g,"type")===a.a.ecommerceCartBlockName&&p(g,"font-family")&&p(g,"font-weight")&&p(g,"font-style")&&(l[p(g,"font-family")+"|"+p(g,"font-style")+"|"+p(g,"font-weight")]=1),p(g,"type")===a.a.addToCartBlockName&&(p(g,"font-family")&&p(g,"font-weight")&&p(g,"font-style")&&(c[p(g,"font-family")+"|"+p(g,"font-style")+"|"+p(g,"font-weight")]=1),p(g,"attrs-font-family")&&p(g,"attrs-font-weight")&&p(g,"attrs-font-style")&&(c[p(g,"attrs-font-family")+"|"+p(g,"attrs-font-style")+"|"+p(g,"attrs-font-weight")]=1)),"form"==p(g,"type")){var y=p(g,"style-"+p(g,"style")+"-fields"),_=o.a.clone(p(g,"style-"+p(g,"style")+"-button-default"));o.a.isEmpty(_)||(_["font-family"]="inherit"==_["font-family"]?y["font-family"]:_["font-family"],_["font-style"]="inherit"==_["font-style"]?y["font-style"]:_["font-style"],_["font-weight"]="inherit"==_["font-weight"]?y["font-weight"]:_["font-weight"]),r[y["font-family"]+"|"+y["font-style"]+"|"+y["font-weight"]]=1,_&&(r[_["font-family"]+"|"+_["font-style"]+"|"+_["font-weight"]]=1);for(var w=0;w<s.b.viewports.length;w++){var k=g["viewport_"+s.b.viewports[w].name];k&&(y=k["style-"+k.style+"-fields"],_=o.a.clone(k["style-"+k.style+"-button-default"]),o.a.isEmpty(_)||(_["font-family"]="inherit"==_["font-family"]?y["font-family"]:_["font-family"],_["font-style"]="inherit"==_["font-style"]?y["font-style"]:_["font-style"],_["font-weight"]="inherit"==_["font-weight"]?y["font-weight"]:_["font-weight"]),y&&(r[y["font-family"]+"|"+y["font-style"]+"|"+y["font-weight"]]=1),_&&(r[_["font-family"]+"|"+_["font-style"]+"|"+_["font-weight"]]=1))}}"text"===p(g,"type")&&3===p(g,"version")&&o.a.extend(e,h.a.getTextWidgetFontsList(g)),"text"===p(g,"type")&&p(g,"text")&&3!==p(g,"version")&&o.a.extend(e,this.scanTextForFontsAndVariationsRaw(p(g,"text"),p(g,"version"),t.excludeUnusedDefault,t.activeViewports)),"hotspot"==p(g,"type")&&o.a.each(this.getHotspotTextModels(g),o.a.bind((function(i){var n=p(i,"text");n&&o.a.extend(e,this.scanTextForFontsAndVariationsRaw(n,p(i,"version"),t.excludeUnusedDefault))}),this))}var S=o.a.extend({},e,i,n,r,l,c),x={},C={bold:700,normal:400};o.a.each(S,(function(t,e){var i=e.split("|"),n=i[0],o=i[1].toLowerCase(),a=i[2].toLowerCase(),r=a in C?C[a]:a;x[n]=x[n]||[],x[n].push("variable"===r?"v":("italic"===o?"i":"n")+Math.floor(r/100))}));var O,j=[],P=this;return o.a.each(x,(function(e,i){(O=o.a.findWhere(u.fontsShortList.webtype,{name:i}))?j.push({provider:"webtype",css_name:O.name,name:O.name,variations:O.variations,used_variations:P.calcBrowserUsedVariation(e,O.variations)}):(O=o.a.findWhere(u.fontsShortList.typetoday,{name:i}))?j.push({provider:"typetoday",css_name:O.name,name:O.name,variations:O.variations,used_variations:P.calcBrowserUsedVariation(e,O.variations)}):(O=o.a.findWhere(u.fontsShortList.google,{family:i}))?j.push({provider:"google",css_name:O.family,name:O.family,variations:O.variations,used_variations:P.calcBrowserUsedVariation(e,O.variations)}):(O=o.a.findWhere(u.fontsShortList.typekit,{id:i}))?j.push({provider:"typekit",css_name:O.id,name:O.name,variations:O.variations,used_variations:P.calcBrowserUsedVariation(e,O.variations)}):t.includeCustom&&(O=o.a.findWhere(t.customList,{css_name:i}))&&j.push({provider:"custom",css_name:O.css_name,css_url:O.css_url,name:O.name,variations:O.variations,used_variations:P.calcBrowserUsedVariation(e,O.variations)})})),j.filter((function(t){return t.used_variations&&t.used_variations.length>0}))},getUsedParagraphStylesFromWidgetsModels:function(t){var e,i,n="";for(e=0;e<t.length;e++)"text"==l(i=t[e],"type")&&l(i,"text")&&(n+=l(i,"text")),"hotspot"==l(i,"type")&&o.a.each(this.getHotspotTextModels(i),o.a.bind((function(t){n+=l(t,"text")||""}),this));var a=[],r=RM.constructorRouter.workspace.mag.edit_params.get("paragraph_styles");if(n)for(e=0;e<r.length;e++){var s=r[e];n.indexOf(s._name)>=0&&a.push(s)}function l(t,e){return"function"==typeof t.get?t.get(e):t[e]}return a},getUsedLinkStylesFromWidgetsModels:function(t){var e,i,n="";for(e=0;e<t.length;e++)"text"==l(i=t[e],"type")&&l(i,"text")&&(n+=l(i,"text")),"hotspot"==l(i,"type")&&o.a.each(this.getHotspotTextModels(i),o.a.bind((function(t){n+=l(t,"text")||""}),this));var a=[],r=RM.constructorRouter.workspace.mag.edit_params.get("link_styles");if(n)for(e=0;e<r.length;e++){var s=r[e];n.indexOf(s._name)>=0&&a.push(s)}function l(t,e){return"function"==typeof t.get?t.get(e):t[e]}return a},sortFontsByProvider:function(t){var e=[],i=[],n={};return o.a.each(t,(function(t){"typekit"===t.provider&&e.push({id:t.css_name,variations:t.used_variations}),"custom"===t.provider&&i.push(t.css_name);var o="used_"+t.provider+"_fonts";n[o]=n[o]||[],"custom"===t.provider?n[o].push(t.css_name):n[o].push({id:t.css_name,variations:t.used_variations})})),{typekit:e,custom:i,dictionary:n}},scanTextForFontsAndVariationsRaw:function(t,e,i,a){var r,l,c,d,h,u,p,m,g,f,v={},b={},y=[],_=document.defaultView.getComputedStyle;for(r=0;r<s.b.viewports.length;r++)if(t.split("-"+s.b.viewports[r].name).length>1){if(a&&-1===a.indexOf(s.b.viewports[r].name))continue;y.push(s.b.viewports[r].name)}(c=Object(n.a)(".used-fonts-test")).length||(c=Object(n.a)("<div>").addClass("used-fonts-test").css({position:"absolute",display:"none !important",left:-9999,width:999}).appendTo("body")),c.removeClass("v1 v2").addClass("v"+(e||1)),(l=c[0]).innerHTML=t,u=(h=l.querySelectorAll("span,p,a")).length;var w,k=(d=_(l,null)).fontFamily+"|"+d.fontStyle+"|"+d.fontWeight;v[k]=1;for(var S=!1,x=function(t){return-1!==o.a.findIndex(t.childNodes,(function(t){return t.nodeType===Node.TEXT_NODE&&t.textContent.replace(/\r?\n/g,"").length}))},C=o.a.filter(h,x),O=0;O<C.length;O++)w=(d=_(C[O],null)).fontFamily+"|"+d.fontStyle+"|"+d.fontWeight,S=S||w===k,v[d.fontFamily+"|"+d.fontStyle+"|"+d.fontWeight]=1;var j=x(l);for(r=0;r<y.length;r++)if("default"!=(g=y[r])){for(O=0;O<u;O++)(p=(f=h[O]).getAttribute("data-style-"+g))&&("empty"==p?f.removeAttribute("style"):f.setAttribute("style",p)),(m=f.getAttribute("data-class-"+g))&&("empty"==m?f.removeAttribute("class"):f.setAttribute("class",m)),x(f)&&(w=(d=_(f,null)).fontFamily+"|"+d.fontStyle+"|"+d.fontWeight,S=S||w===k,v[w]=1);r<y.length-1&&(l.innerHTML=t,u=(h=l.querySelectorAll("span,p,a")).length)}return!i||S||j||delete v[k],o.a.each(v,(function(t,e){var i=e.split("|"),n=i[0],o=i[1].toLowerCase(),a=i[2].toLowerCase();n=(n=n.split(",")[0]).replace(/'|"/g,""),a=(a=(a=a.replace(/normal/g,"400")).replace(/regular/g,"400")).replace(/bold/g,"700"),b[n+"|"+o+"|"+a]=1})),b},calcBrowserUsedVariation:function(t,e){for(var i={},n=0;n<t.length;n++){for(var a,r,s,l=t[n],c=l.substr(1,1),d=l.substr(0,1),h=99999,u="",p=0;p<e.length;p++)a=e[p].substr(1,1)-0,r=e[p].substr(0,1),c<4&&(s=10*Math.abs(a-c)+(r==d?0:1e3)+(a<=c?0:100)),c>5&&(s=10*Math.abs(a-c)+(r==d?0:1e3)+(a>=c?0:100)),4==c&&(s=5==a?0+(r==d?0:1e3)+0:10*Math.abs(a-c)+(r==d?0:1e3)+(a<=c?0:100)),5==c&&(s=10*Math.abs(a-c)+(r==d?0:1e3)+(a<=c?0:100)),c==a&&d==r&&(s=0),s<h&&(h=s,u=e[p]);i[u]=1}return o.a.keys(i).filter((function(t){return!!t}))},getVeryShortList:function(t){var e={google:[],typekit:[],webtype:[],typetoday:[]};return o.a.each(t,(function(t){var i,n=t.provider;switch(n){case"google":i={provider:n,family:t.name,variations:t.variations};break;case"typekit":i={provider:n,id:t.css_name,name:t.name,variations:t.variations};break;case"webtype":case"typetoday":i={provider:n,name:t.name,variations:t.variations}}e[n]&&e[n].push(i)})),e},getCustomVariationNameByFVD:function(t,e){return(u.fontCustomVariationNames[t]||{})[e]},setShortList:function(t){u.fontsShortList=t||{},u.fontCustomVariationNames={},o.a.each(u.fontsShortList,(function(t,e){o.a.each(t,(function(t){if(t.custom_variation_names){var i;switch(e){case"google":i=t.family;break;case"typekit":case"webtype":case"typetoday":i=t.name}u.fontCustomVariationNames[i]=t.custom_variation_names}}))}))}};window.fontsShortListCallback=function(t){u.setShortList(t)},e.a=u},DwEc:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return r}));var n=i("q1tI"),o=i.n(n),a=o.a.createContext({}),r=o.a.createContext({})},E913:function(t,e,i){},EvVy:function(t,e,i){"use strict";var n=i("4BoS");i.n(n).a},"F+PN":function(t,e,i){"use strict";var n=i("j/3K");i.n(n).a},Fts9:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("u1Rx"),l=i.n(s),c=i("Fi5S"),d=i("I0kf"),h=i("LDvm"),u=i("iC7s"),p=i("8by/"),m=i("q1tI"),g=i.n(m),f=i("i8i4"),v=i.n(f),b=i("ICos"),y=i("KiFh"),_=i("8AXF");function w(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function k(){return(k=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function S(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var x,C,O=function(t){var e=t.userId,i=(t.children,S(t,["userId","children"])),n=Object(m.useContext)(_.BackboneContext).model,o=n.color,a=n.opacity,r=n.update,s=Object(m.useMemo)((function(){return Object(b.b)(o||"000000",a)}),[o,a]);return g.a.createElement(y.a,k({"aria-labelledby":"colorbox-panel-color",type:"picker",userId:e,setColor:function(t){r("color",Object(b.g)(t)),r("opacity",t.a)},color:s},i))},j=a.a.View.extend({initialize:function(t){var e=this;this.props=t,this.container=this.props.$parent instanceof n.a?this.props.$parent[0]:this.props.$parent,this.propsModel=new a.a.Model({color:t.color,opacity:t.opacity,update:function(t,i){if(e.propsModel.set(t,i),"color"===t){var n=Object(b.c)(i),o=n.r,a=n.g,r=n.b;e.trigger("colorchange",o,a,r,e.propsModel.get("opacity"))}else if("opacity"===t){var s=Object(b.c)(e.propsModel.get("color")),l=s.r,c=s.g,d=s.b;e.trigger("opacitychange",l,c,d,i)}}}),this.projectId=window.RM.constructorRouter.mag.get("_id"),this.userId=window.RM.constructorRouter.mag.user.get("_id"),this.render()},render:(x=regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,i("8AXF").renderReact)({component:function(){return g.a.createElement(O,{projectId:e.projectId,userId:e.userId,width:e.props.width||168,height:e.props.height||240,showAlpha:e.props.show_opacity,borderRadius:e.props.borderRadius,regularInRow:e.props.swatches_per_line,regularRowsMin:e.props.swatches_min&&e.props.swatches_per_line?e.props.swatches_min/e.props.swatches_per_line:void 0,favouriteInRow:e.props.favourites_per_line,favouriteRows:e.props.favourites_max&&e.props.favourites_per_line?e.props.favourites_max/e.props.favourites_per_line:void 0,favouriteGap:e.props.favourite_gap})},domElement:this.container,model:this.propsModel}),t.abrupt("return",this);case 4:case"end":return t.stop()}}),t,this)})),C=function(){var t=this,e=arguments;return new Promise((function(i,n){var o=x.apply(t,e);function a(t){w(o,i,n,a,r,"next",t)}function r(t){w(o,i,n,a,r,"throw",t)}a(void 0)}))},function(){return C.apply(this,arguments)}),setOpacity:function(t){this.propsModel.set("opacity",t)},setColor:function(t){this.propsModel.set("color",t)},onSetColor:function(t){this.propsModel.set("color",Object(b.g)(t)),this.propsModel.set("opacity",t.a)},rgb2hex:function(t){if(!t||t.some((function(t){return void 0===t})))return"";var e=t[0].toString(16),i=t[1].toString(16),n=t[2].toString(16);return(1===e.length?"0"+e:e)+(1===i.length?"0"+i:i)+(1===n.length?"0"+n:n)},areColorsClose:function(t,e){var i=this.rgb2hsb(t),n=this.rgb2hsb(e);return Math.abs(i[0]-n[0])<=5&&Math.abs(i[1]-n[1])<=33&&Math.abs(i[2]-n[2])<=5&&Math.abs(t[3]-e[3])<=.06},hex2rgb:function(t){return[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)]},rgb2hsb:function(t){var e=[t[0],t[1],t[2]];e[0]/=255,e[1]/=255,e[2]/=255;var i=Math.min(e[0],e[1],e[2]),n=Math.max(e[0],e[1],e[2]);if(i===n)return[180,0,100*n];var o=e[0]===i?e[1]-e[2]:e[1]===i?e[2]-e[0]:e[0]-e[1],a=e[0]===i?3:e[1]===i?5:1;return[Math.floor(60*(a-o/(n-i)))%360,Math.floor((n-i)/n*100),n=Math.floor(100*n)]},destroy:function(){this.container&&(v.a.unmountComponentAtNode(this.container)&&this.container.parentNode.removeChild(this.container))}});function P(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function E(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){P(a,n,o,r,s,"next",t)}function s(t){P(a,n,o,r,s,"throw",t)}r(void 0)}))}}function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach((function(e){M(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var $,A,R,D,B=a.a.View.extend({name:"Colorbox",settings_vertical:{width:168,height:240,bottom_panel_height:72,hue_width:0,hue_width_opened:0,hue_height:24,color:"6CD632",opacity:1,swatches_max:60,swatches_min:10,favourites_max:6,favourites_per_line:3,swatches_per_line:5,fav_switch_speed:300,show_opacity:!1},settings_big:{width:208,height:240,bottom_panel_height:40,hue_width:9,hue_width_opened:20,color:"6CD632",opacity:1,swatches_max:60,swatches_min:10,favourites_max:6,favourites_per_line:3,swatches_per_line:5,fav_switch_speed:300,show_opacity:!1},settings_small:{width:152,height:240,bottom_panel_height:96,hue_width:9,hue_width_opened:16,color:"6CD632",opacity:1,swatches_max:60,swatches_min:15,favourites_max:6,favourites_per_line:3,swatches_per_line:5,fav_switch_speed:300,show_opacity:!0},initialize:function(t){this.model=RM.constructorRouter.mag.edit_params,this.projectId=window.RM.constructorRouter.mag.get("_id"),this.colorDragData={},this.scrollDragData={},this.scrollData={height:0,percent:0,container_h:0,inner_h:0},this.settings={},this.RGB=[],this.HSB=[],this.section="color",r.a.bindAll(this),this["settings_"+t.type]?r.a.extend(this.settings,this["settings_"+t.type]):r.a.extend(this.settings,this.settings_big),r.a.extend(this.settings,t),"string"==typeof this.settings.color&&6==this.settings.color.length||(console.log("Error, wrong color set to colorbox: ",this.settings.color),this.settings.color=this.settings_big.color),this.RGB=this.hex2rgb(this.settings.color),this.HSB=this.rgb2hsb(this.RGB),this.settings.map_width=this.settings.width-("vertical"!=t.type?this.settings.hue_width:0),this.settings.map_height=this.settings.height-this.settings.bottom_panel_height,this.settings.hue_height=this.settings.hue_height||this.settings.height,this.settings.placeholdes_height=this.settings.map_height-22,this.settings.placeholdes_width=this.settings.width,"small"==this.settings.type&&(this.settings.placeholdes_height=166),this.template=l.a["template-constructor-helpers-colorbox"],this.create()},create:function(){if(Object(d.a)("constructor.newColorpicker")){var t=Object(p.a)();t&&t.project?(this.favourites=t.project.favourites||[],this.swatches=t.project.regular||[]):(this.favourites=[],this.swatches=[])}else this.favourites=this.model&&r.a.clone(this.model.get("fav_colors")),this.swatches=this.model&&r.a.clone(this.model.get("swatches"));this.render(),this.model&&this.model.attributes.colorbox_state&&this.section!==this.model.attributes.colorbox_state&&this.switchBetweenSwatchesAndColorsBridge(),!this.model||this.favourites.length||this.swatches.length||"swatches"!==this.section||this.switchBetweenSwatchesAndColorsBridge()},render:function(){if(Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("colorbox")})),this.setElement(Object(n.a)(this.template(this.settings)).appendTo(this.settings.$parent).addClass("rmcolorbox-type-"+this.settings.type)),this.$rmcolorbox_swatches_placeholdes=this.$(".rmcolorbox-swatches-placeholdes"),this.$rmcolorbox_swatches_placeholdes_wrapper=this.$(".rmcolorbox-swatches-placeholdes-wrapper"),this.$rmcolorbox_swatches_colors=this.$(".rmcolorbox-swatches-colors"),this.$rmcolorbox_swatches=this.$(".rmcolorbox-swatches"),this.$swatches_button=this.$(".rmcolorbox-swatches-button"),this.$add_to_swatches_button=this.$(".rmcolorbox-add-to-swatches-button"),this.$remove_from_swatches_button=this.$(".rmcolorbox-remove-from-swatches-button"),this.model||(this.$rmcolorbox_swatches.remove(),this.$swatches_button.remove(),this.$add_to_swatches_button.remove()),this.$scroll_handle=this.$(".rmcolorbox-swatches-scroll-handle"),this.$map_block=this.$(".rmcolorbox-map"),this.$map_handle=this.$map_block.find(".rmcolorbox-map-handle"),this.map_ctx=this.$map_block.find("canvas")[0].getContext("2d"),this.$rmcolorbox_color=this.$(".rmcolorbox-color"),this.$animation_box=this.$(".rmcolorbox-animation-box"),this.$animation_canvas=this.$animation_box.find("canvas"),this.animation_ctx=this.$animation_canvas[0].getContext("2d"),this.$hue_block=this.$(".rmcolorbox-hue"),this.hue_ctx1=this.$hue_block.find(".rmcolorbox-hue-canvas1")[0].getContext("2d"),"vertical"!=this.settings.type?(this.hue_ctx2=this.$hue_block.find(".rmcolorbox-hue-canvas2")[0].getContext("2d"),this.map_under_arrow_ctx=this.$(".rmcolorbox-map-under-arrow canvas")[0].getContext("2d")):this.$hueLine=this.$(".hue-line"),this.$opacity_block=this.$(".rmcolorbox-opacity"),this.$opacity_handle=this.$(".rmcolorbox-opacity-handle"),this.$input_rgb=this.$(".rmcolorbox-rgb-block-input"),this.$input_r=this.$(".rmcolorbox-r-block-input"),this.$input_g=this.$(".rmcolorbox-g-block-input"),this.$input_b=this.$(".rmcolorbox-b-block-input"),this.$input_r_g_b=this.$input_r.add(this.$input_g).add(this.$input_b),this.$hue_block.RMDrag({start:this.startHueDrag,move:this.startHueDrag,end:this.stopHueDrag,silent:!0,preventDefault:!0}),this.$map_block.RMDrag({start:this.startMapDrag,move:this.startMapDrag,silent:!0,preventDefault:!0}),this.$opacity_block.RMDrag({start:this.startOpacityDrag,move:this.startOpacityDrag,end:this.stopOpacityDrag,silent:!0,preventDefault:!0}),this.$scroll_handle.RMDrag({start:this.startScrollDrag,move:this.moveScrollDrag,end:this.stopScrollDrag,silent:!0,preventDefault:!0}),this.$rmcolorbox_swatches_placeholdes_wrapper.mousewheel(this.onScrollMouseWheel),this.$input_rgb.on("paste",this.rgbPaste).on("keyup keydown",this.rgbKeyPressed).on("blur",this.rgbBlur).on("focus",this.rgbFocus),this.$input_r_g_b.on("keyup keydown",this.r_g_bKeyPressed).on("blur",this.r_g_bBlur).on("focus",this.r_g_bFocus),this.$swatches_button.on("click",this.switchBetweenSwatchesAndColors),this.$add_to_swatches_button.on("click",this.addToSwatches),this.$remove_from_swatches_button.on("click",this.deleteColor),this.changeColor(void 0,void 0,void 0,!0),this.favourites&&this.swatches&&this.createFSPlaceholdes(!0),"small"===this.settings.type&&this.setOpacity(this.settings.opacity),this.favourites)for(var t=0;t<this.favourites.length;t++)this.favourites[t]&&this.addFavouritesColor(t,!0);if(this.swatches)for(t=0;t<this.swatches.length;t++)this.swatches[t]&&this.addSwatchesColor(t,!0);this.model&&this.model.on("change:swatches",this.onModelSwatchesChange),this.model&&this.model.on("change:fav_colors",this.onModelFavouritesChange),c.a.on("panel:showed",this.setCurrentSelectedColor)},onModelSwatchesChange:function(t,e){if(!Object(d.a)("constructor.newColorpicker"))if(this.thisModelChangeInitiator)this.thisModelChangeInitiator=!1;else{this.thisModelChangeInitiator=!1,this.swatches=r.a.clone(e),this.createFSPlaceholdes(!0),this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-small").remove();for(var i=0;i<this.swatches.length;i++)this.swatches[i]&&this.addSwatchesColor(i,!0);this.$remove_from_swatches_button.removeClass("active")}},onModelFavouritesChange:function(t,e){if(!Object(d.a)("constructor.newColorpicker"))if(this.thisModelChangeInitiator)this.thisModelChangeInitiator=!1;else{this.thisModelChangeInitiator=!1,this.favourites=r.a.clone(e),this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-big").remove();for(var i=0;i<this.favourites.length;i++)this.favourites[i]&&this.addFavouritesColor(i,!0);this.$remove_from_swatches_button.removeClass("active")}},toggleOpacity:function(t){this.$el.toggleClass("without-opacity",!t)},oldOnSwatchesChange:function(){this.thisModelChangeInitiator=!0,this.model.save({swatches:r.a.clone(this.swatches)})},oldOnFavouritesChange:function(){this.thisModelChangeInitiator=!0,this.model.save({fav_colors:r.a.clone(this.favourites)})},updateSwatches:function(t){Object(p.b)(T(T({},Object(p.a)()),{},{project:t})),this.favourites=t.favourites,this.swatches=t.regular},onColorAdd:(D=E(regeneratorRuntime.mark((function t(e){var i,n,o,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.color,n=e.index,o=e.section,t.next=3,Object(h.O)({projectId:this.projectId,color:i,index:n,type:o});case 3:a=t.sent,r=a.data,this.updateSwatches(r);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return D.apply(this,arguments)}),onColorDelete:(R=E(regeneratorRuntime.mark((function t(e){var i,n,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.index,n=e.section,t.next=3,Object(h.O)({projectId:this.projectId,color:void 0,index:i,type:n});case 3:o=t.sent,a=o.data,this.updateSwatches(a);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return R.apply(this,arguments)}),onColorMove:(A=E(regeneratorRuntime.mark((function t(e){var i,n,o,a,r,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.color,n=e.from,o=e.to,a=e.newIndex,r=e.oldIndex,t.next=3,Object(h.x)({projectId:this.projectId,from:n,to:o,color:i,newIndex:a,oldIndex:r});case 3:s=t.sent,l=s.data,this.updateSwatches(l);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return A.apply(this,arguments)}),changeColor:function(t,e,i,n){n&&!t&&(t=this.HSB),n&&!e&&(e=this.RGB),"hue"==i||"sb"==i?e=this.hsb2rgb(t):t=this.rgb2hsb(e),(t[0]!=this.HSB[0]||n)&&(this.fillHue(t[0]),this.fillMap(t[0])),(t[1]!=this.HSB[1]||t[2]!=this.HSB[2]||n)&&this.$map_handle.css({left:Math.round(this.settings.map_width*t[1]/100)+"px",top:Math.round(this.settings.map_height*(100-t[2])/100)+"px"}),(e[0]!=this.RGB[0]||e[1]!=this.RGB[1]||e[2]!=this.RGB[2]||n)&&("input-rgb"!=i&&(this.$input_rgb.val(this.rgb2hex(e)),this.setInputSize(this.$input_rgb)),"vertical"!=this.settings.type&&("input-r"!=i&&(this.$input_r.val(e[0]),this.setInputSize(this.$input_r)),"input-g"!=i&&(this.$input_g.val(e[1]),this.setInputSize(this.$input_g)),"input-b"!=i&&(this.$input_b.val(e[2]),this.setInputSize(this.$input_b)))),e[0]==this.RGB[0]&&e[1]==this.RGB[1]&&e[2]==this.RGB[2]||"swatches"==i||this.unSelectColor();var o=!1;e[0]==this.RGB[0]&&e[1]==this.RGB[1]&&e[2]==this.RGB[2]&&"swatches"!=i||n||(o=!0),this.$opacity_block.css("background-color","#"+this.rgb2hex(e)),this.HSB=t,this.RGB=e,o&&this.trigger("colorchange",e[0],e[1],e[2],this.settings.opacity)},setColor:function(t){(t=this.hex2rgb(t))[0]==this.RGB[0]&&t[1]==this.RGB[1]&&t[2]==this.RGB[2]||this.changeColor(void 0,t,void 0,!0)},fillHue:function(t){if("vertical"==this.settings.type){for(var e=this.hue_ctx1.getImageData(0,0,this.settings.width,this.settings.hue_height),i=0,n=0;n<this.settings.width;n++){for(var o=360*(1-n/this.settings.width),a=this.hsb2rgb([o,100,100]),r=0;r<this.settings.hue_height;r++)e.data[i+r*this.settings.width*4]=a[0],e.data[i+1+r*this.settings.width*4]=a[1],e.data[i+2+r*this.settings.width*4]=a[2],e.data[i+3+r*this.settings.width*4]=255;i+=4}this.hue_ctx1.putImageData(e,0,0)}else{for(e=this.hue_ctx1.getImageData(0,0,this.settings.hue_width_opened-3,this.settings.hue_height),i=0,r=0;r<this.settings.hue_height;r++)for(o=360*(1-r/this.settings.hue_height),a=this.hsb2rgb([o,100,100]),n=0;n<this.settings.hue_width_opened-3;n++)e.data[i++]=a[0],e.data[i++]=a[1],e.data[i++]=a[2],e.data[i++]=255;this.hue_ctx1.putImageData(e,0,0),e=this.hue_ctx2.getImageData(0,0,3,this.settings.hue_height),i=0;for(r=0;r<this.settings.hue_height;r++)for(o=360*(1-r/this.settings.hue_height),a=this.hsb2rgb([o,100,100]),n=0;n<3;n++)e.data[i++]=a[0],e.data[i++]=a[1],e.data[i++]=a[2],e.data[i++]=255;for(var s=Math.round(this.settings.hue_height*(360-t)/360)-1,l=[1,1,2,1,2,3,2,1,1],c=[2,1,1,0,0,0,-1,-1,-2],d=0;d<l.length;d++)e.data[3*(s-c[d])*4+4*(3-l[d])+3]=0;this.hue_ctx2.putImageData(e,0,0)}},fillMap:function(t){for(var e=this.map_ctx.getImageData(0,0,this.settings.map_width,this.settings.map_height),i=0,n=this.hsb2rgb([t,100,100]),o=0;o<this.settings.map_height;o++)for(var a=1-o/(this.settings.map_height-1),r=[255*a,255*a,255*a],s=[n[0]*a,n[1]*a,n[2]*a],l=0;l<this.settings.map_width;l++)a=l/(this.settings.map_width-1),e.data[i++]=r[0]+(s[0]-r[0])*a,e.data[i++]=r[1]+(s[1]-r[1])*a,e.data[i++]=r[2]+(s[2]-r[2])*a,e.data[i++]=255;this.map_ctx.putImageData(e,0,0),this.fillMapUnderArrow(t),"vertical"==this.settings.type&&this.moveHueLine(t)},fillMapUnderArrow:function(t){if("vertical"!=this.settings.type){for(var e=this.map_under_arrow_ctx.getImageData(0,0,this.settings.hue_width,this.settings.map_height),i=0,n=0;n<this.settings.map_height;n++)for(var o=1-n/(this.settings.map_height-1),a=0;a<this.settings.hue_width;a++)e.data[i++]=255*o,e.data[i++]=255*o,e.data[i++]=255*o,e.data[i++]=255;this.map_under_arrow_ctx.putImageData(e,0,0)}},addToSwatches:($=E(regeneratorRuntime.mark((function t(e){var i,n,o,a,r,s,l,c,h,p,m,g,f,v,b,y,_,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(w=function(t,e,i){b.animation_ctx.beginPath(),b.animation_ctx.arc(t,e,5.5,0,2*Math.PI,!0),b.animation_ctx.closePath(),b.animation_ctx.lineWidth=1.2,b.animation_ctx.strokeStyle="#fff",b.animation_ctx.fillStyle=i,b.animation_ctx.fill()},_=function(){v.clearRect(0,0,b.$animation_canvas[0].width,b.$animation_canvas[0].height),v.globalAlpha=.8,v.drawImage(b.$animation_canvas[0],0,0),b.animation_ctx.clearRect(0,0,b.$animation_canvas[0].width,b.$animation_canvas[0].height),b.animation_ctx.globalAlpha=1,b.animation_ctx.drawImage(f[0],0,0)},y=function(t){if(t>h+25)return b.$animation_box.addClass("hidden"),void f.remove();_(),t<=h&&w(r+p*t,s+m*t,g),setTimeout((function(){y(t+6)}),10)},e&&(e.stopPropagation(),e.preventDefault()),i=-1,n=-1,o=0;o<this.swatches.length;o++)this.swatches[o]?i=o:-1==n&&(n=o);if(a=this.rgb2hex(this.RGB),!(i+1<this.settings.swatches_max)){t.next=19;break}if(this.swatches[i+1]=a,!Object(d.a)("constructor.newColorpicker")){t.next=15;break}return t.next=13,this.onColorAdd({color:a,index:i+1,section:u.xb.regular});case 13:t.next=16;break;case 15:this.oldOnSwatchesChange();case 16:this.addSwatchesColor(i+1),t.next=31;break;case 19:if(!(n>=0)){t.next=30;break}if(this.swatches[n]=a,!Object(d.a)("constructor.newColorpicker")){t.next=26;break}return t.next=24,this.onColorAdd({color:a,index:n,section:u.xb.regular});case 24:t.next=27;break;case 26:this.oldOnSwatchesChange();case 27:this.addSwatchesColor(n),t.next=31;break;case 30:return t.abrupt("return");case 31:r=this.$map_handle.position().left+this.$map_block.position().left,s=this.$map_handle.position().top+this.$map_block.position().top,l=this.$swatches_button.position().left+this.$swatches_button.width()/2,c=this.$swatches_button.position().top+this.$swatches_button.height()/2,this.$animation_box.removeClass("hidden"),h=Math.round(Math.sqrt(Math.pow(r-l,2)+Math.pow(s-c,2))),p=(l-r)/h,m=(c-s)/h,g="#"+this.rgb2hex(this.RGB),f=this.$animation_canvas.clone(),v=f[0].getContext("2d"),b=this,this.animation_ctx.clearRect(0,0,this.$animation_canvas[0].width,this.$animation_canvas[0].height),y(0);case 39:case"end":return t.stop()}}),t,this)}))),function(t){return $.apply(this,arguments)}),switchBetweenSwatchesAndColors:function(t){t&&(t.stopPropagation(),t.preventDefault()),this.switchBetweenSwatchesAndColorsBridge(this.settings.fav_switch_speed),this.model&&this.model.attributes.colorbox_state!==this.section&&this.model.save({colorbox_state:this.section}),"swatches"==this.section&&this.setCurrentSelectedColor()},switchBetweenSwatchesAndColorsBridge:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.$swatches_button.toggleClass("active"),this.$rmcolorbox_color.fadeToggle(t),this.$rmcolorbox_swatches.fadeToggle(t),this.$add_to_swatches_button.fadeToggle(t),this.$remove_from_swatches_button.fadeToggle(t),this.$(".rmcolorbox-color-input-blocker").fadeToggle(t),this.$swatches_button.hasClass("active")?this.$swatches_button.attr("title","Hide Swatches"):this.$swatches_button.attr("title","Swatches"),this.section="color"==this.section?"swatches":"color"},rgbPaste:function(t){if((t=t&&t.originalEvent)&&t.clipboardData&&t.clipboardData.getData&&/text\/plain/.test(t.clipboardData.types)){var e=t.clipboardData.getData("text/plain");e.indexOf("#")+1&&(t.preventDefault(),document.execCommand("insertText",!1,e.substr(1)))}},rgbKeyPressed:function(t){this.setInputSize(Object(n.a)(t.currentTarget));var e=Object(n.a)(t.currentTarget).val();for(e=e.replace(/[^0-9a-fA-F]/g,"");e.length<6;)e="0"+e;var i=this.hex2rgb(e);this.changeColor(void 0,i,"input-rgb"),t&&"keydown"==t.type&&13==t.keyCode&&Object(n.a)(t.currentTarget).blur()},rgbFocus:function(){this.$(".rmcolorbox-rgb-block").addClass("editing")},rgbBlur:function(t){this.$(".rmcolorbox-rgb-block").removeClass("editing"),Object(n.a)(t.currentTarget).val(this.rgb2hex(this.RGB)),this.setInputSize(Object(n.a)(t.currentTarget))},r_g_bKeyPressed:function(t){this.setInputSize(Object(n.a)(t.currentTarget));var e=Object(n.a)(t.currentTarget).data("param"),i=Object(n.a)(t.currentTarget).val();if(i=i.replace(/[^0-9]/g,""),i=parseInt(i,10),i=Math.max(Math.min(i,255),0),isNaN(i)&&(i=0),"r"==e)var o=[i,this.RGB[1],this.RGB[2]];if("g"==e)o=[this.RGB[0],i,this.RGB[2]];if("b"==e)o=[this.RGB[0],this.RGB[1],i];if(this.changeColor(void 0,o,"input-"+e),t&&"keydown"==t.type&&(13==t.keyCode&&"r"==e&&(this.$input_r.blur(),this.$input_g.focus()),13==t.keyCode&&"g"==e&&(this.$input_g.blur(),this.$input_b.focus()),13==t.keyCode&&"b"==e&&this.$input_b.blur(),38==t.keyCode||40==t.keyCode)){t.preventDefault();var a=t.shiftKey?10:1;i+=38==t.keyCode?a:-a,i=Math.max(Math.min(i,255),0),Object(n.a)(t.currentTarget).val(i),t.keyCode=0,this.r_g_bKeyPressed(t)}},r_g_bFocus:function(){this.$(".rmcolorbox-r-g-b-block").addClass("editing")},r_g_bBlur:function(t){this.$(".rmcolorbox-r-g-b-block").removeClass("editing");var e=Object(n.a)(t.currentTarget).data("param");"r"==e&&Object(n.a)(t.currentTarget).val(this.RGB[0]),"g"==e&&Object(n.a)(t.currentTarget).val(this.RGB[1]),"b"==e&&Object(n.a)(t.currentTarget).val(this.RGB[2]),this.setInputSize(Object(n.a)(t.currentTarget))},setInputSize:function(t){var e=Object(n.a)('<div style="position:absolute; top:-999px; left:-999px; width:900px; height:200px" class="rmcolorbox"></div>').appendTo("body"),i=Object(n.a)('<div style="position:absolute; width:auto"></div>').appendTo(e);i[0].className=t[0].className,i.text(t.val()+"0"),t.width(i.width()),e.remove()},startHueDrag:function(t){if("color"==this.section||"vertical"==this.settings.type)if("vertical"==this.settings.type){var e=t.pageX-this.$hue_block.offset().left;e=Math.min(Math.max(e,0),this.settings.width-1),e=360-Math.round(360*e/(this.settings.width-1)),this.changeColor([e,this.HSB[1],this.HSB[2]],void 0,"hue"),this.$hue_block.addClass("dragging")}else e=t.pageY-this.$hue_block.offset().top,e=Math.min(Math.max(e,0),this.settings.hue_height-1),e=360-Math.round(360*e/(this.settings.hue_height-1)),this.changeColor([e,this.HSB[1],this.HSB[2]],void 0,"hue"),this.$hue_block.addClass("dragging")},stopHueDrag:function(t){this.$hue_block.removeClass("dragging")},moveHueLine:function(t){if("color"==this.section||"vertical"==this.settings.type){var e=t/360*this.settings.width;e=Math.max(Math.min(this.settings.width-2,e),-1),this.$hueLine.css({right:e})}},startMapDrag:function(t){var e=t.pageX-this.$map_block.offset().left;e=Math.min(Math.max(e,0),this.settings.map_width-1),e=Math.round(100*e/(this.settings.map_width-1));var i=t.pageY-this.$map_block.offset().top;i=Math.min(Math.max(i,0),this.settings.map_height-1),i=100-Math.round(100*i/(this.settings.map_height-1)),this.changeColor([this.HSB[0],e,i],void 0,"sb")},startOpacityDrag:function(t){var e=t.pageX-this.$opacity_block.offset().left,i=this.$opacity_block.width(),n=this.$opacity_handle.width()/2,o=n,a=i-n;(e=Math.min(Math.max(e,0),i-1))>a&&(e=a),e<o&&(e=o);var r=((e-o)/(a-o)).toFixed(2);this.$opacity_handle.css({left:e}),this.$opacity_handle.find(".rmcolorbox-opacity-val").text(Math.round(100*r)+"%").addClass("dragging"),Math.abs(this.settings.opacity-r)>.001&&this.trigger("opacitychange",this.RGB[0],this.RGB[1],this.RGB[2],r-0),this.settings.opacity=r-0},stopOpacityDrag:function(t){this.$opacity_handle.find(".rmcolorbox-opacity-val").removeClass("dragging")},setOpacity:function(t,e){var i=this.$opacity_block.width(),n=this.$opacity_handle.width()/2,o=(i-n-n)*t+n,a=this.$opacity_handle.find(".rmcolorbox-opacity-val");if(e){a.addClass("dragging");var r=this.$opacity_handle.position().left,s=this.settings.opacity;r!=o&&this.$opacity_handle.stop().animate({left:o},{duration:1200,step:function(e,i){var n=s+(e-r)/(o-r)*(t-s);a.text(Math.round(100*n)+"%")},complete:function(){a.removeClass("dragging")}})}else this.$opacity_handle.css({left:o}),a.text(Math.round(100*t)+"%");this.settings.opacity=t},getFavouritesCoords:function(t){if("small"==this.settings.type){var e=32,i=18;return[e+t%this.settings.favourites_per_line*44,i+40*Math.floor(t/this.settings.favourites_per_line)]}return"big"==this.settings.type?(i=25,[(e=46)+t%this.settings.favourites_per_line*58,i+52*Math.floor(t/this.settings.favourites_per_line)]):"vertical"==this.settings.type?(i=20,[(e=36)+t%this.settings.favourites_per_line*48,i+48*Math.floor(t/this.settings.favourites_per_line)]):void 0},getSwatchesCoords:function(t){if("small"==this.settings.type){var e=25,i=95;return[Math.floor(e+t%this.settings.swatches_per_line*25),i+27*Math.floor(t/this.settings.swatches_per_line)]}return"big"==this.settings.type?(e=38,i=126,[Math.floor(e+t%this.settings.swatches_per_line*33),i+35*Math.floor(t/this.settings.swatches_per_line)]):"vertical"==this.settings.type?(i=104,[(e=28)+t%this.settings.swatches_per_line*28,i+28*Math.floor(t/this.settings.swatches_per_line)]):void 0},addFavouritesColor:function(t,e){var i=this.favourites[t],o=this.getFavouritesCoords(t),a=Object(n.a)('<div data-tp="big" data-ind="'+t+'" class="rmcolorbox-swatches-color-big" style="background:#'+i+";left:"+o[0]+"px;top:"+o[1]+'px"></div>');return this.$rmcolorbox_swatches_colors.append(a),a.RMDrag({start:this.startColorDrag,move:this.moveColorDrag,end:this.endColorDrag,silent:!0,preventDefault:!0,threshold:3}),e||this.createFSPlaceholdes(),a},addSwatchesColor:function(t,e){var i=this.swatches[t],o=this.getSwatchesCoords(t),a=Object(n.a)('<div data-tp="small" data-ind="'+t+'" class="rmcolorbox-swatches-color-small" style="background:#'+i+";left:"+o[0]+"px;top:"+o[1]+'px"></div>');return this.$rmcolorbox_swatches_colors.append(a),a.RMDrag({start:this.startColorDrag,move:this.moveColorDrag,end:this.endColorDrag,silent:!0,preventDefault:!0,threshold:3}),e||this.createFSPlaceholdes(),a},startColorDrag:function(t){var e=Object(n.a)(t.currentTarget);e.removeClass("rmcolorbox-swatches-color-moving"),e.css("z-index",9999),this.colorDragData={$target:e,mx:t.pageX,my:t.pageY,cx:e.position().left,cy:e.position().top,left:e.width()/2+3,top:e.height()/2+3,right:this.$rmcolorbox_swatches_colors.width()-e.width()/2-3,bottom:this.$rmcolorbox_swatches_colors.height()-e.height()/2-4,container_top:this.$rmcolorbox_swatches_placeholdes_wrapper.offset().top,container_height:this.$rmcolorbox_swatches_placeholdes_wrapper.height(),orig_inner_top:this.$rmcolorbox_swatches_colors.position().top,cur_inner_top:this.$rmcolorbox_swatches_colors.position().top,wasMovement:!1,fillExEy:function(t,e){this.ex=this.cx+t-this.mx,this.ey=this.cy+e-this.my+(this.orig_inner_top-this.cur_inner_top),this.ex=Math.min(Math.max(this.ex,this.left),this.right),this.ey=Math.min(Math.max(this.ey,this.top),this.bottom)}}},moveColorDrag:function(t){this.colorDragData.wasMovement=!0,this.colorDragData.fillExEy(t.pageX,t.pageY),this.colorDragData.$target.css({left:this.colorDragData.ex+"px",top:this.colorDragData.ey+"px"}),this.checkAutoScroll(t.pageY)},checkAutoScroll:function(t){var e=t-this.colorDragData.container_top,i=this.colorDragData.container_top+this.colorDragData.container_height-t;e<20&&this.scrollBy(-2),i<20&&this.scrollBy(2),this.colorDragData.cur_inner_top=this.$rmcolorbox_swatches_colors.position().top},unSelectColor:function(){this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-big").removeClass("selected"),this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-small").removeClass("selected"),this.$remove_from_swatches_button.removeClass("active")},selectColor:function(t){if(this.$remove_from_swatches_button.addClass("active"),t.addClass("selected"),"small"==t.attr("data-tp"))var e=this.hex2rgb(this.swatches[t.attr("data-ind")]);"big"==t.attr("data-tp")&&(e=this.hex2rgb(this.favourites[t.attr("data-ind")])),this.changeColor(void 0,e,"swatches")},deleteColor:function(t){if(Object(n.a)(t.currentTarget).hasClass("active")){var e=this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-big.selected, .rmcolorbox-swatches-color-small.selected");if(1==e.length){e.addClass("rmcolorbox-swatches-color-removing");var i=this;setTimeout((function(){"small"==e.attr("data-tp")&&(i.swatches[e.attr("data-ind")]=void 0,Object(d.a)("constructor.newColorpicker")?i.onColorDelete({index:e.attr("data-ind"),section:u.xb.regular}):i.oldOnSwatchesChange()),"big"==e.attr("data-tp")&&(i.favourites[e.attr("data-ind")]=void 0,Object(d.a)("constructor.newColorpicker")?i.onColorDelete({index:e.attr("data-ind"),section:u.xb.favourites}):i.oldOnFavouritesChange()),e.remove(),i.createFSPlaceholdes()}),300)}this.unSelectColor()}},endColorDrag:function(t){if(this.colorDragData.$target.css("z-index","auto"),!this.colorDragData.wasMovement){var e=this.colorDragData.$target.hasClass("selected");return this.unSelectColor(),void(e||this.selectColor(this.colorDragData.$target))}this.colorDragData.$target.addClass("rmcolorbox-swatches-color-moving"),this.colorDragData.fillExEy(t.pageX,t.pageY),this.colorDragData.$target.css({left:this.colorDragData.ex+"px",top:this.colorDragData.ey+"px"});for(var i=0;i<this.settings.favourites_max;i++){var n=this.getFavouritesCoords(i);if(Math.round(Math.sqrt(Math.pow(n[0]-this.colorDragData.ex,2)+Math.pow(n[1]-this.colorDragData.ey,2)))<=20)break}for(var o=0;o<this.settings.swatches_max;o++){n=this.getSwatchesCoords(o);if(Math.round(Math.sqrt(Math.pow(n[0]-this.colorDragData.ex,2)+Math.pow(n[1]-this.colorDragData.ey,2)))<=13)break}var a=this.colorDragData.$target.attr("data-tp"),r=this.colorDragData.$target.attr("data-ind"),s=a,l=r;i<this.settings.favourites_max&&(s="big",l=i),o<this.settings.swatches_max&&(s="small",l=o);var c=this.$rmcolorbox_swatches_placeholdes_wrapper.offset().top,d=this.$rmcolorbox_swatches_placeholdes_wrapper.offset().top+this.$rmcolorbox_swatches_placeholdes_wrapper.height();(t.pageY<c||t.pageY>=d)&&(s=a,l=r),this.moveColorToInd(this.colorDragData.$target[0],a,r,s,l)},moveColorToInd:function(t,e,i,o,a){if(e!=o||i!=a){if("big"==e)var r=this.$(".rmcolorbox-swatches-color-big[data-ind="+i+"]").removeClass("rmcolorbox-swatches-color-big"),s=this.getFavouritesCoords(i),l=this.favourites;else r=this.$(".rmcolorbox-swatches-color-small[data-ind="+i+"]").removeClass("rmcolorbox-swatches-color-small"),s=this.getSwatchesCoords(i),l=this.swatches;if("big"==o)var c=this.$(".rmcolorbox-swatches-color-big[data-ind="+a+"]").removeClass("rmcolorbox-swatches-color-big"),h=this.getFavouritesCoords(a),p=this.favourites;else c=this.$(".rmcolorbox-swatches-color-small[data-ind="+a+"]").removeClass("rmcolorbox-swatches-color-small"),h=this.getSwatchesCoords(a),p=this.swatches;r.css({left:h[0]+"px",top:h[1]+"px"}).addClass("rmcolorbox-swatches-color-"+o).addClass("rmcolorbox-swatches-color-moving").attr("data-tp",o).attr("data-ind",a),c.css({left:s[0]+"px",top:s[1]+"px"}).addClass("rmcolorbox-swatches-color-"+e).addClass("rmcolorbox-swatches-color-moving").attr("data-tp",e).attr("data-ind",i);var m=l[i],g=p[a];p[a]=l[i],l[i]=g,l!=this.favourites&&p!=this.favourites||(Object(d.a)("constructor.newColorpicker")?this.onColorMove({color:m,from:"big"===e?u.xb.favourites:u.xb.regular,to:"big"===o?u.xb.favourites:u.xb.regular,oldIndex:Number(i),newIndex:Number(a)}):this.oldOnFavouritesChange()),l!=this.swatches&&p!=this.swatches||(Object(d.a)("constructor.newColorpicker")?this.onColorMove({color:m,from:"big"===e?u.xb.favourites:u.xb.regular,to:"big"===o?u.xb.favourites:u.xb.regular,oldIndex:Number(i),newIndex:Number(a)}):this.oldOnSwatchesChange()),this.createFSPlaceholdes()}else{if("big"==e)var f=this.getFavouritesCoords(i);if("small"==e)f=this.getSwatchesCoords(i);Object(n.a)(t).css({left:f[0]+"px",top:f[1]+"px"})}},createFSPlaceholdes:function(t){this.$rmcolorbox_swatches_placeholdes.empty();for(var e=0;e<this.settings.favourites_max;e++){var i=this.getFavouritesCoords(e);this.$rmcolorbox_swatches_placeholdes.append('<div class="rmcolorbox-swatches-placeholder-big" style="left:'+i[0]+"px;top:"+i[1]+'px"></div>')}var n=0;for(e=0;e<this.swatches.length;e++)this.swatches[e]&&(n=e);n+=this.settings.swatches_per_line,n=Math.max(Math.min(n,this.settings.swatches_max-1),this.settings.swatches_min-1),n=Math.floor(n/this.settings.swatches_per_line)*this.settings.swatches_per_line+this.settings.swatches_per_line;var o=0;for(e=0;e<n;e++)(i=this.getSwatchesCoords(e))[1]>o&&(o=i[1]),this.$rmcolorbox_swatches_placeholdes.append('<div class="rmcolorbox-swatches-placeholder-small" style="left:'+i[0]+"px;top:"+i[1]+'px"></div>');var a=this.$rmcolorbox_swatches_colors.height(),r=o+("vertical"!=this.settings.type?17:14);this.$rmcolorbox_swatches_placeholdes.height(r),this.$rmcolorbox_swatches_colors.height(r),r!=a&&this.recalcScrollhandle(t)},recalcScrollhandle:function(t){this.scrollData.container_h=this.$rmcolorbox_swatches_placeholdes_wrapper.height(),this.scrollData.inner_h=this.$rmcolorbox_swatches_colors.height(),this.$scroll_handle.toggleClass("hidden",this.scrollData.inner_h<=this.scrollData.container_h),this.scrollData.height=this.scrollData.container_h/2*(this.scrollData.container_h/this.scrollData.inner_h),this.scrollData.height=Math.max(this.scrollData.height,20)+2,this.scrollTo(t?0:1,!0)},scrollTo:function(t,e,i){i=i||50,t=Math.max(Math.min(t,1),0),this.scrollData.percent=t;var n=t*(this.scrollData.container_h-this.scrollData.height),o=-t*(this.scrollData.inner_h-this.scrollData.container_h);e?(this.$scroll_handle.stop().animate({top:n+"px",height:this.scrollData.height-2+"px"},i,"linear"),this.$rmcolorbox_swatches_colors.stop().animate({top:o+"px"},i,"linear"),this.$rmcolorbox_swatches_placeholdes.stop().animate({top:o+"px"},i,"linear")):(this.$scroll_handle.css({top:n+"px",height:this.scrollData.height-2+"px"}),this.$rmcolorbox_swatches_colors.css("top",o+"px"),this.$rmcolorbox_swatches_placeholdes.css("top",o+"px"))},scrollBy:function(t,e,i){if(!(this.scrollData.inner_h<=this.scrollData.container_h)){var n=1/(this.scrollData.inner_h-this.scrollData.container_h);this.scrollTo(this.scrollData.percent+n*t,e,i)}},onScrollMouseWheel:function(t,e){return t.preventDefault(),this.scrollBy(-e/4,!0,50),!1},startScrollDrag:function(t){var e=Object(n.a)(t.currentTarget);e.addClass("dragging"),this.scrollDragData={$target:e,my:t.pageY,cy:e.position().top,top:0,bottom:this.scrollData.container_h-this.scrollData.height-2,fillEy:function(t){this.ey=this.cy+t-this.my,this.ey=Math.min(Math.max(this.ey,this.top),this.bottom),this.percent=(this.ey-this.top)/(this.bottom-this.top)}}},moveScrollDrag:function(t){this.scrollDragData.fillEy(t.pageY),this.scrollTo(this.scrollDragData.percent,!1)},stopScrollDrag:function(t){this.scrollDragData.$target.removeClass("dragging")},destroy:function(){this.model&&this.model.off("change:swatches",this.onModelSwatchesChange),this.model&&this.model.off("change:fav_colors",this.onModelFavouritesChange),c.a.off("panel:showed",this.setCurrentSelectedColor),this.$el.remove()},areColorsClose:function(t,e){var i=this.rgb2hsb(t),n=this.rgb2hsb(e);return Math.abs(i[0]-n[0])<=5&&Math.abs(i[1]-n[1])<=33&&Math.abs(i[2]-n[2])<=5&&Math.abs(t[3]-e[3])<=.06},hex2rgb:function(t){return[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)]},rgb2hex:function(t){var e=t[0].toString(16),i=t[1].toString(16),n=t[2].toString(16);return(1==e.length?"0"+e:e)+(1==i.length?"0"+i:i)+(1==n.length?"0"+n:n)},hsb2rgb:function(t){var e,i,n,o,a,r,s,l,c=[t[0],t[1],t[2]];return c[0]%=360,0==c[2]?[0,0,0]:(c[1]/=100,c[2]/=100,c[0]/=60,o=Math.floor(c[0]),a=c[0]-o,r=c[2]*(1-c[1]),s=c[2]*(1-c[1]*a),l=c[2]*(1-c[1]*(1-a)),0==o?(e=c[2],i=l,n=r):1==o?(e=s,i=c[2],n=r):2==o?(e=r,i=c[2],n=l):3==o?(e=r,i=s,n=c[2]):4==o?(e=l,i=r,n=c[2]):5==o&&(e=c[2],i=r,n=s),[e=Math.floor(255*e),i=Math.floor(255*i),n=Math.floor(255*n)])},rgb2hsb:function(t){var e,i,n,o,a=[t[0],t[1],t[2]];return a[0]/=255,a[1]/=255,a[2]/=255,(e=Math.min(a[0],a[1],a[2]))==(o=Math.max(a[0],a[1],a[2]))?[180,0,100*o]:(i=a[0]==e?a[1]-a[2]:a[1]==e?a[2]-a[0]:a[0]-a[1],n=a[0]==e?3:a[1]==e?5:1,[Math.floor(60*(n-i/(o-e)))%360,Math.floor((o-e)/o*100),o=Math.floor(100*o)])},setCurrentSelectedColor:function(){var t=this.rgb2hex(this.RGB),e=this.favourites.indexOf(t),i=this.swatches.indexOf(t),n=null;e>-1&&(n=this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-big[data-ind='".concat(e,"']"))),i>-1&&(n=this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-small[data-ind='".concat(i,"']"))),n&&(this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-big").removeClass("selected"),this.$rmcolorbox_swatches_colors.find(".rmcolorbox-swatches-color-small").removeClass("selected"),n.addClass("selected"))}});e.a=Object(d.a)("constructor.newColorpicker")?j:B},"G3+Z":function(t,e,i){"use strict";var n=["DOMMouseScroll","mousewheel"];e.a=function(t,e,i,o){t||(t=document),e||(e=window),"boolean"!=typeof i&&(i=!0);var a,r,s,l=function(t){!function(t,e,i,n){i&&(t.preventDefault?t.preventDefault():event.returnValue=!1);var o=t.detail||-t.wheelDelta/40;o*=19,"number"!=typeof n||isNaN(n)||(o*=n),e.scrollBy?e.scrollBy(0,o):e.scrollTop+=o}(t=t||window.event,e,i,o)};return(a=t.addEventListener)?(a.call(t,n[0],l,!1),a.call(t,n[1],l,!1)):(a=t.attachEvent)&&a.call(t,"on"+n[1],l),(r=t.removeEventListener)?s=function(){r.call(t,n[0],l,!1),r.call(t,n[1],l,!1)}:(r=t.detachEvent)&&(s=function(){r.call(t,"on"+n[1],l)}),{restore:s}}},G50q:function(module,exports){module.exports={"template-constructor-control-common_pack":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Group" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t</div>\n';return __p}}},Gw2y:function(module,exports){module.exports={"template-viewer-final-page":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="final-page offscreen hidden '+(null==(__t=isStickyVerticalViewer?"":"has-vertical-scroll")?"":__t)+'">\n\t\t<div class="final-page-wrapper tp-'+(null==(__t=tp)?"":_.escape(__t))+'">\n\t\t\t<div class="final-page-container">\n\n\t\t\t\t<div class="dop-container-text">\n\t\t\t\t\t<div class="main-container">\n\t\t\t\t\t\t<a class="made-with" href="'+(null==(__t=Constants.readymag_host)?"":__t)+'">Made with <div class="logo"></div></a>\n\t\t\t\t\t\t<p class="bottom-text">Design from scratch and publish online, immediately.</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="dop-container-join">\n\t\t\t\t\t\t<div class="join ljr-panel ">\n\t\t\t\t\t\t\t<div class="header"><span>Join</span> or <a href="/login/" class="link">Log in</a></div>\n\t\t\t\t\t\t\t<input autocapitalize="on"  autocorrect="off" required="required" class="fullname-input input-template for-validate"  maxlength="24" type="text"     spellcheck="false" value="" placeholder="Name" />\n\t\t\t\t\t\t\t<input autocapitalize="off" autocorrect="off" required="required" class="email-input input-template for-validate"     type="email"    spellcheck="false" value="" placeholder="Email" />\n\t\t\t\t\t\t\t<input autocapitalize="off" autocorrect="off" required="required" class="password-input input-template for-validate"  type="password" spellcheck="false" value="" placeholder="Password" />\n\n\t\t\t\t\t\t\t<div class="checkbox-container">\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type="checkbox" class="terms-checkbox for-validate" required="required">\n\t\t\t\t\t\t\t\t\t<span class="checkmark"></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<p>I accept Readymag\n\t\t\t\t\t\t\t\t\t<a href="https://readymag.com/readymag/terms-and-privacy/" target="_blank">Terms & Privacy Policy</a>\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\t<div class="checkbox-container second">\n\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t<input type="checkbox" class="subscribe-checkbox">\n\t\t\t\t\t\t\t\t\t<span class="checkmark"></span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<p>Keep me updated on new features</p>\n\t\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\t<div class="go">Join</div>\n\n\t\t\t\t\t\t\t<div class="social-caption">Sign up with</div>\n\t\t\t\t\t\t\t<div class="social-auth" data-provider=\'facebook\'>\n\t\t\t\t\t\t\t\t<span class="icon"></span>\n\t\t\t\t\t\t\t\t<span class="buttonText">Facebook</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="social-auth" data-provider=\'google\'>\n\t\t\t\t\t\t\t\t<span class="icon"></span>\n\t\t\t\t\t\t\t\t<span class="buttonText">Google</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="error"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="login ljr-panel hidden">\n            <div class="header"><a href="/join/" class="link">Join</a> or <span>Log in</span></div>\n\t\t\t\t\t\t<form method="post" action="/api/redirect" id="login_form">\n\t\t\t\t\t\t\t<input name="username" autocapitalize="off" autocorrect="off" required="required" class="email-input input-template"  autocomplete="on" type="email" spellcheck="false" value="" placeholder="Email"/>\n\t\t\t\t\t\t\t<input name="password" autocapitalize="off" autocorrect="off" required="required" class="password-input input-template" autocomplete="on"  type="password" spellcheck="false" value=""  placeholder="Password" />\n\t\t\t\t\t\t\t<input name="url" type="hidden" value="" />\n\t\t\t\t\t\t\t<div class="go">Log in</div>\n\t\t\t\t\t\t</form>\n            <div class="social-caption">Log in with</div>\n            <div class="social-auth" data-provider=\'facebook\'>\n              <span class="icon"></span>\n              <span class="buttonText">Facebook</span>\n            </div>\n            <div class="social-auth" data-provider=\'google\'>\n              <span class="icon"></span>\n              <span class="buttonText">Google</span>\n            </div>\n\t\t\t\t\t\t<a href="/recover/" class="link forgot">Forgot password?</a>\n\t\t\t\t\t\t<div class="error">Invalid email or password</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="recover ljr-panel hidden">\n\t\t\t\t\t\t<div class="header"><span>Reset password</span></div>\n\t\t\t\t\t\t<div class="wrapper">\n\t\t\t\t\t\t\t<input name="username" autocapitalize="off" autocorrect="off" required="required" class="email-input input-template"  autocomplete="on" type="email" spellcheck="false" value="" placeholder="What’s your email?"/>\n\t\t\t\t\t\t\t<div class="go">Submit</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="send-message">We sent a message to <span class="recover-email">emailaddress@gmail.com</span><br/>so you can set a new password.</div>\n\t\t\t\t\t\t<div class="go-back">Go back</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n';return __p}}},HIJs:function(module,exports){module.exports={"template-constructor-control-common_unpack":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Ungroup" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t</div>\n';return __p}}},HOx4:function(t,e,i){"use strict";var n=i("+EJ4");i.n(n).a},HW3E:function(module,exports){module.exports={"template-constructor-control-common_animation":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Animation" data-alt-pos="left" data-alt-offset="9" data-name="animation-control-icon"></div>\n\n\t<div class="panel" data-name="animation-panel">\n\t\t<div class="panel-caption">Animation</div>\n\n\t\t<div class="mixed-types">\n\t\t\t<div class="message-text">Nope, you can’t mix fixed, full width, full height, sticky and normal widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-fixeds">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple fixed widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-stickeds">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple sticky widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-fullwidths">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple full width widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-fullheights">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple full height widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="non-animatable">\n\t\t\t<div class="message-text">Nope, you can’t animate Facebook or Twitter widgets.</div>\n\t\t</div>\n\n\t\t<div class="multiple-animations">\n\t\t\t<div class="message-text">There’re different animations in this selection. Merge them?</div>\n\t\t\t<div class="unite-button">Yes</div>\n\t\t</div>\n\n\t\t<div class="requires-trigger">\n\t\t\t<div class="message-text">A video widget can be&nbsp;animated on&nbsp;click only with&nbsp;another widget as&nbsp;a&nbsp;trigger.</div>\n\t\t</div>\n\n\t\t<div class="cannot-use-with-picture-preview">\n\t\t\t<div class="message-text">Oops, you can’t currently add this animation since Lightbox is enabled</div>\n\t\t</div>\n\n\t\t<div class="top-block js-top-block">\n\t\t\t'+(null==(__t=renderInitialTypePopup())?"":__t)+'\n\t\t</div>\n\n\t\t<div class="step-selector js-step-selector">\n\t\t\t<div class="prev-step js-prev-step"></div>\n\t\t\t<div class="step-caption js-step-caption"></div>\n\t\t\t<div class="next-step js-next-step"></div>\n\n\t\t\t<div class="step-popup js-step-popup">\n\t\t\t\t<div class="step-popup-content js-step-popup-content"></div>\n\t\t\t\t<div class="corner-wrapper">\n\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="resizable-scroll-wrapper">\n\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t<div class="resizable-content">\n\n\t\t\t\t\t<div class="effects-presets-wrapper">\n\t\t\t\t\t\t<div class="effects-caption">Choose Effect</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_move">Move</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_opacity">Opacity</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_rotate">Rotate</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_scale">Scale</div>\n\n\t\t\t\t\t\t<div class="presets-caption">Presets</div>\n\t\t\t\t\t\t<div class="presets-item" data-value="fade-and-scale">Fade&Scale<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="fade-in">Fade In<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="scale-big">Scale Big<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="move-and-fade">Move&Fade<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="pulse">Pulse<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="rotate">Rotate<div class="preview"></div></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="resizable-scroll"></div>\n\t\t</div>\n\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\n\n\t\t<div class="bottom-block">\n\t\t\t<div class="add-effect">\n\t\t\t\t<span>Add Effect</span>\n\t\t\t\t<div class="effect-popup">\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_move">Move</div>\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_opacity">Opacity</div>\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_rotate">Rotate</div>\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_scale">Scale</div>\n\t\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="loop-types js-loop-types">\n\t\t\t\t<div class="loop-type loop-type-swing js-loop-swing" data-value="swing" data-alt="Reverse">\n\t\t\t\t\t<svg class="loop-type-swing-icon" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M23 4H7V1.124A1 1 0 005.309.401L1.257 4.277a1 1 0 000 1.446L5.31 9.599A1 1 0 007 8.876V6h16v2.876a1 1 0 001.691.723l4.052-3.876a1 1 0 000-1.446L24.69.401A1 1 0 0023 1.124V4z" fill-rule="nonzero"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\tLoop\n\t\t\t\t<div class="loop-type loop-type-repeat js-loop-repeat" data-value="repeat" data-alt="Cycle">\n\t\t\t\t\t<svg class="loop-type-repeat-icon" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M12 6v2.876a1 1 0 001.691.723l4.052-3.876a1 1 0 000-1.446L13.69.401A1 1 0 0012 1.124V4H5a5 5 0 00-.217 9.995L5 14h18a5 5 0 00.217-9.995L23 4h-3a1 1 0 00-.117 1.993L20 6h3a3 3 0 01.176 5.995L23 12H5a3 3 0 01-.176-5.995L5 6h7z" fill-rule="nonzero"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="play-once">\n\t\t\t\t<div class="play-once-title js-play-once">Once per user</div>\n\t\t\t\t<div class="help">\n\t\t\t\t\t<div class="help-popup">\n\t\t\t\t\t\t<div class="help-body-wrapper">\n\t\t\t\t\t\t\t<div class="help-body">\n\t\t\t\t\t\t\t\t<span class="help-text">Plays animation once to&nbsp;each person.<br />Hides animated blocks on&nbsp;consequent refreshes. <br/><a href="http://help.readymag.com/hc/en-us/articles/360021875712-Settings" target="_blank">Learn more</a></span>\n\t\t\t\t\t\t\t\t<div class="help-popup-corner">\n\t\t\t\t\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="hover-spacer"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="preview">Preview</div>\n\t\t</div>\n\n\t\t<div class="animation-add js-add-animation">\n\t\t\tAdd\n\t\t\t'+(null==(__t=renderAddTypePopup())?"":__t)+"\n\t\t</div>\n\n\t</div>\n";return __p},"template-constructor-control-common_animation-trigger":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="trigger js-trigger-button" data-id="'+(null==(__t=id)?"":__t)+'">\n\t\t',"onOtherPage"===status?__p+='\n\t\t\t<div class="trigger-other-page">\n\t\t\t\t<div class="trigger-name js-trigger-name">\n\t\t\t\t\tTrigger on p. '+(null==(__t=pageNumber)?"":__t)+'\n\t\t\t\t</div>\n\t\t\t\t<svg class="trigger-remove-button js-remove-trigger" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M6 4.467l4.15-4.15a1.084 1.084 0 011.533 1.533L7.533 6l4.15 4.15a1.084 1.084 0 11-1.533 1.533L6 7.533l-4.15 4.15A1.084 1.084 0 01.317 10.15L4.467 6 .317 1.85A1.084 1.084 0 111.85.317L6 4.467z" fill-rule="evenodd"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t':"pending"===status?__p+='\n\t\t\t<div class="trigger-pending">\n\t\t\t\tChoose Trigger\n\t\t\t\t<svg class="trigger-remove-button js-cancel-trigger" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M6 4.467l4.15-4.15a1.084 1.084 0 011.533 1.533L7.533 6l4.15 4.15a1.084 1.084 0 11-1.533 1.533L6 7.533l-4.15 4.15A1.084 1.084 0 01.317 10.15L4.467 6 .317 1.85A1.084 1.084 0 111.85.317L6 4.467z" fill-rule="evenodd"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t':"active"===status?__p+='\n\t\t\t<div class="trigger-active js-trigger-active">\n\t\t\t\t<div class="trigger-name js-trigger-name">\n\t\t\t\t\t'+(null==(__t=isSelf?"Self":triggerBlockName||"Trigger")?"":__t)+'\n\t\t\t\t</div>\n\t\t\t\t<svg class="trigger-remove-button js-remove-trigger" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M6 4.467l4.15-4.15a1.084 1.084 0 011.533 1.533L7.533 6l4.15 4.15a1.084 1.084 0 11-1.533 1.533L6 7.533l-4.15 4.15A1.084 1.084 0 01.317 10.15L4.467 6 .317 1.85A1.084 1.084 0 111.85.317L6 4.467z" fill-rule="evenodd"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t':__p+='\n\t\t\t<div class="trigger-none">\n\t\t\t\t<div class="trigger-none-caption">Add Trigger</div>\n\t\t\t\t<div class="trigger-arrow"></div>\n\t\t\t</div>\n\t\t',__p+="\n\t</div>\n";return __p},"template-constructor-control-common_animation-step":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="step">\n\n\t\t<div class="param-wrapper start-block">\n\t\t\t<div class="caption">Start Point</div>\n\t\t\t<div class="start-value">'+(null==(__t=start_point)?"":__t)+'</div>\n\t\t\t<div class="start-popup">\n\t\t\t\t<div class="start-popup-item" data-value="top">Top<div class="point"></div></div>\n\t\t\t\t<div class="start-popup-item" data-value="center">Center<div class="point"></div></div>\n\t\t\t\t<div class="start-popup-item" data-value="bottom">Bottom<div class="point"></div></div>\n\t\t\t\t<div class="start-popup-caption">Offset</div>\n\n\t\t\t\t<div class="input-wrapper">\n\t\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="start_offset" data-min="-9999" data-max="9999" data-mouseSpeed="1" type="text"/>\n\t\t\t\t\t<div class="units">px</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="start-preview">\n\t\t\t\t\t<div class="start-point"></div>\n\t\t\t\t\t<div class="start-dist"></div>\n\t\t\t\t\t<div class="start-offset"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper delay-block">\n\t\t\t<div class="bg"></div>\n\t\t\t<div class="caption">Delay</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">s</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="delay" data-min="0" data-max="99" data-useFloat="true" data-shiftStep="1" data-step="0.1" data-mouseSpeed="5" data-labelSelector="<.param-wrapper" type="text"/>\n\t\t\t\t<div class="units">s</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper duration-block">\n\t\t\t<div class="bg"></div>\n\t\t\t<div class="caption">Durat.</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">s</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="duration" data-min="0" data-max="99" data-useFloat="true" data-shiftStep="1" data-step="0.1" data-mouseSpeed="5" data-labelSelector="<.param-wrapper" type="text"/>\n\t\t\t\t<div class="units">s</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper delay_px-block">\n\t\t\t<div class="bg"></div>\n\t\t\t<div class="caption">Delay</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">px</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="delay_px" data-min="0" data-max="9999" data-mouseSpeed="1" data-labelSelector="<.param-wrapper" type="text"/>\n\t\t\t\t<div class="units">px</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t',0===index&&(__p+='\n\t\t\t<div class="param-wrapper start-condition-block">\n\t\t\t\t<div class="caption">Start when in view</div>\n\t\t\t\t<div class="switcher start-when-in-view-switcher js-start-when-in-view-switcher"></div>\n\t\t\t</div>\n\t\t'),__p+='\n\n\t\t<div class="param-wrapper speed-block">\n\t\t\t<div class="caption">Speed</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">×</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="speed"  data-min="0.01" data-floatDigits="2" data-max="999" data-useFloat="true" data-shiftStep="0.1" data-step="0.01" data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="units">×</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper move-block">\n\t\t\t<div class="remove-effect" data-value="use_move"></div>\n\t\t\t<div class="caption">Move</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="dx" data-min="-99999" data-max="99999" data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator move-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="dy" data-min="-99999" data-max="99999" data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper opacity-block">\n\t\t\t<div class="remove-effect" data-value="use_opacity"></div>\n\t\t\t<div class="caption">Opacity</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="from_opacity" data-min="0" data-max="100"  data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator from-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="opacity" data-min="0" data-max="100"  data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t\t',isSwitcherVisible&&(__p+='\n\t\t\t\t<div class="param-wrapper hide-in-editor-switcher-wrapper">\n\t\t\t\t\t<div class="caption">Hide in Editor</div>\n\t\t\t\t\t<div class="switcher hide-in-editor-switcher js-hide-in-editor-switcher"></div>\n\t\t\t\t</div>\n\t\t\t'),__p+='\n\t\t</div>\n\n\t\t<div class="param-wrapper rotate-block">\n\t\t\t<div class="remove-effect" data-value="use_rotate"></div>\n\t\t\t<div class="caption">Rotate</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="from_rotate" data-min="-9999" data-max="9999"  data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator from-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="rotate" data-min="-9999" data-max="9999"  data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper scale-block">\n\t\t\t<div class="remove-effect" data-value="use_scale"></div>\n\t\t\t<div class="caption">Scale</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="from_scale" data-min="0" data-max="9999" data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator from-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="scale" data-min="0" data-max="9999" data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper acceleration-block">\n\t\t\t<div class="caption">Acceleration</div>\n\t\t\t<div class="acceleration-value">'+(null==(__t=acceleration)?"":__t)+'</div>\n\t\t\t<div class="acceleration-popup">\n\t\t\t\t<div class="acceleration-popup-preview"><div class="ball"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="none">None<div class="point"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="ease-in">Ease In<div class="point"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="ease-out">Ease Out<div class="point"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="ease-both">Ease Both<div class="point"></div></div>\n\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-common_animation-step-popup-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="step-popup-item js-step-popup-item '+(null==(__t=isSelected?"selected":"")?"":__t)+" "+(null==(__t=isInLoop?"looped":"")?"":__t)+'" data-ind="'+(null==(__t=index)?"":__t)+'">'+(null==(__t=text)?"":__t)+"</div>\n";return __p},"template-constructor-control-common_animation-type-popup":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="type-popup '+(null==(__t=isInitial?"initial":"")?"":__t)+" "+(null==(__t=uuid?"":"new")?"":__t)+" "+(null==(__t=cssClass)?"":__t)+'">\n\t\t',isInitial&&(__p+='\n\t\t\t<div class="type-popup-header">Animate</div>\n\t\t'),__p+='\n\t\t<div class="type-popup-content">\n\t\t\t',uuid&&(__p+='\n\t\t\t\t<div class="type-popup-item js-type-popup-item none" data-value="none" data-uuid="'+(null==(__t=uuid)?"":__t)+'">\n\t\t\t\t\t<div class="type-popup-text">none</div>\n\t\t\t\t</div>\n\t\t\t'),__p+="\n\t\t\t",_.each(availableTypes,(function(t){__p+="\n\t\t\t\t",(uuid||t!==currentType)&&(__p+='\n\t\t\t\t\t<div class="type-popup-item js-type-popup-item '+(null==(__t=t===currentType?"current":"")?"":__t)+'" data-value="'+(null==(__t=t)?"":__t)+'" data-uuid="'+(null==(__t=uuid)?"":__t)+'">\n\t\t\t\t\t\t',!isInitial&&uuid||(__p+='\n\t\t\t\t\t\t\t<div class="type-popup-prefix">'+(null==(__t=isInitial?"on":uuid?"":"Add")?"":__t)+"</div>\n\t\t\t\t\t\t"),__p+='\n\t\t\t\t\t\t<div class="type-popup-text">'+(null==(__t=t)?"":__t)+"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"),__p+="\n\t\t\t"})),__p+="\n\t\t</div>\n\t</div>\n";return __p},"template-constructor-control-common_animation-type":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="animation-type js-animation-type '+(null==(__t=animation.UUID===currentUuid?"current":"")?"":__t)+" "+(null==(__t="none"===animation.type?"none":"")?"":__t)+" "+(null==(__t=allowTriggers(animation)||"none"===animation.type?"has-extra":"")?"":__t)+" "+(null==(__t=0===index?"first":index===total-1?"last":"")?"":__t)+'" data-type="'+(null==(__t=animation.type)?"":__t)+'">\n\t\t<div class="animation-type-header">\n\t\t\t<div class="animation-type-caption '+(null==(__t=animation.UUID===currentUuid?"js-change-type":"js-change-animation")?"":__t)+'" data-uuid="'+(null==(__t=animation.UUID)?"":__t)+'">\n\t\t\t\t<div class="animation-type-text">\n\t\t\t\t\t'+(null==(__t=animation.type)?"":__t)+"\n\t\t\t\t</div>\n\t\t\t\t",animation.UUID===currentUuid&&(__p+='\n\t\t\t\t\t<svg class="animation-type-dropdown-arrow" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M3.206 5.46L.257 1.609A1 1 0 011.051 0H6.95a1 1 0 01.794 1.608L4.794 5.46a1 1 0 01-1.588 0z" fill-rule="evenodd"/>\n\t\t\t\t\t</svg>\n\t\t\t\t'),__p+="\n\t\t\t</div>\n\n\t\t\t","none"===animation.type&&animation.UUID===currentUuid&&(__p+='\n\t\t\t\t<div class="animation-none-controls">\n\t\t\t\t\t<div class="animation-remove js-remove-animation" data-uuid="'+(null==(__t=animation.UUID)?"":__t)+'">Delete</div>\n\t\t\t\t</div>\n\t\t\t'),__p+="\n\t\t\t",animation.UUID===currentUuid&&(__p+="\n\t\t\t\t"+(null==(__t=renderTypePopup({type:animation.type,isInitial:!1,uuid:animation.UUID,cssClass:"js-change-type-popup"}))?"":__t)+"\n\t\t\t"),__p+="\n\t\t</div>\n\t\t",animation.UUID===currentUuid&&allowTriggers(animation)&&(__p+='\n\t\t\t<div class="trigger-buttons-container js-trigger-buttons-container"></div>\n\t\t'),__p+="\n\t</div>\n";return __p}}},HjzJ:function(t,e,i){"use strict";i.d(e,"h",(function(){return m})),i.d(e,"i",(function(){return g})),i.d(e,"a",(function(){return p})),i.d(e,"g",(function(){return f})),i.d(e,"f",(function(){return v})),i.d(e,"c",(function(){return b})),i.d(e,"b",(function(){return y})),i.d(e,"e",(function(){return _})),i.d(e,"d",(function(){return w})),i.d(e,"j",(function(){return S}));var n,o=i("q1tI"),a=i.n(o),r=i("sn3M"),s=i("fueH");function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function c(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function d(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?d(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var p,m="listStyle",g="ordered-key";!function(t){t.Unordered="unordered-list-item",t.Ordered="ordered-list-item"}(p||(p={}));var f=(u(n={},p.Unordered,{element:"li"}),u(n,p.Ordered,{element:"li"}),n),v=h(h({},Object(r.a)({className:p.Unordered,label:"Unordered list",styles:'\n      padding: 0;\n      margin: 0;\n      list-style-type: none;\n\n      div[data-offset-key]:before, & > li:before {\n        content: "• ";\n      }\n    '})),Object(r.a)({className:p.Ordered,label:"Ordered list",styles:"\n      padding: 0;\n      margin: 0;\n      list-style-type: none;\n\n      div[data-offset-key]:before, & > li:before {\n        counter-increment: ".concat(g,";\n        content: counter(").concat(g,')".";\n      }\n    ')})),b=function(t){var e=t.children,i=t.type,n=c(t,["children","type"]);return i===p.Ordered?a.a.createElement("ol",l({style:{counterReset:g}},n),e):a.a.createElement("ul",n,e)},y=function(t){var e=t.children,i=c(t,["children"]);return(a.a.createElement(b,i,a.a.createElement("li",null,e)))},_=function(t){return t===p.Ordered||t===p.Unordered},w=function(t){var e=t.editorState,i=t.block,n=s.a.getBlockData({editorState:e,block:i,key:m});return"string"==typeof n?n:""},k=function(t){var e=t.block,i=t.editorState,n=t.styleName;return s.a.setBlockData({editorState:i,block:e,key:m,value:n})},S=function(t){var e=t.style,i=t.currentStyle,n=t.editorState;return s.a.getSelectedBlocks(n).reduce((function(t,n){var o=t,a=o.getCurrentContent().getBlockForKey(n);return null===e?o=k({editorState:o,block:a,styleName:void 0}):e.name!==i&&(o=k({editorState:o,block:a,styleName:e.name})),o}),n)}},HlXo:function(module,exports){module.exports={"template-constructor-block-audio":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="player-wrapper"></div>\n\t<div class="overlay"></div>\n';return __p}}},HuYI:function(module,exports){module.exports={"template-common-form-button":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="button">\n\t\t<div class="caption"></div>\n\t\t<svg class="error" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34 26"><path d="M17 19.8c-1.4 0-2.6 1.1-2.6 2.6s1.1 2.6 2.6 2.6c1.4 0 2.6-1.1 2.6-2.6S18.4 19.8 17 19.8zM19 0.4h-4L15 17.4h4L19 0.4z"/></svg>\n\t\t<div class="pending"></div>\n\t\t<svg class="show-if-empty-submitted-text" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34 26"><path d="M31.4 3C30.6 2.3 29.4 2.3 28.6 3l0 0L13.1 18.6l-7.8-7.8 0 0c-0.8-0.7-2-0.7-2.7 0 -0.8 0.8-0.8 2 0 2.7l0 0L13.1 24.1l0.4-0.4h0L31.4 5.8l0 0C32.1 5 32.1 3.8 31.4 3z"/></svg>\n\t</div>\n';return __p}}},HwMs:function(t,e,i){"use strict";i("xi34");var n=i("q1z7"),o=i.n(n),a=i("rFsW"),r=i("OTSC"),s=i("roQd"),l=i("pFlR"),c=i("m41J"),d=i("QNiq");i("I0kf");function h(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function u(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function p(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?u(Object(i),!0).forEach((function(e){m(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):u(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function m(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function g(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function v(t){var e;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(e=t[Symbol.asyncIterator]))return e.call(t);if(Symbol.iterator&&null!=(e=t[Symbol.iterator]))return e.call(t)}throw new TypeError("Object is not async iterable")}var b=o.a.View.extend({initialize:function(t){a.a.bindAll(this),a.a.extend(this,t);var e={};a.a.each(this.widgets,a.a.bind((function(t){if(t.hasAnimation()){var i=t.fixed_position||t.is_full_width||t.is_full_height||t.sticked?r.default.generateUUID():s.a.getUuidHash(t.getAnimations())||r.default.generateUUID();e[i]=e[i]||[],e[i].push(t)}}),this)),this.animations=[];var i=!d.a.isDesktop||!Modernizr.safari;a.a.each(e,function(t){this.addAnimation(t,{allowAccelerate:i})}.bind(this)),this.start.__debounced=a.a.debounce(this.start,300)},addAnimation:function(t,e){var i=this;e=e||{},t=a.a.isArray(t)?t:[t];var n=["nonMove","moveOnly"].concat(g(s.a.EVENT_TYPES)).reverse();g(t[0].getAnimations()).map((function(t){return s.a.isMoveOnly(t)?p(p({},t),{},{effects:"moveOnly"}):s.a.isNonMove(t)?p(p({},t),{},{effects:"nonMove"}):t})).sort((function(t,e){return n.indexOf(t.effects||t.type)-n.indexOf(e.effects||e.type)})).filter((function(t){return!s.a.isEmpty(t)})).map((function(n){var o=n.type;if(d.a.isDesktop||"hover"!==o||t[0].getAnimationTriggers(n.UUID).length){var a=t[0].animationObjects,r=Boolean(a&&a.length),s=new y[o]({page:i.page,widgets:t,rawAnimation:n,$container:r?a[a.length-1].$el:void 0,allowAccelerate:e.allowAccelerate,isNested:r,topmostAnimation:r?a[0]:void 0});i.animations.push(s)}}))},removeAnimation:function(t){this.animations=a.a.without(this.animations,t),t&&t.destroy()},start:function(){a.a.each(this.animations,(function(t){t.start()}))},stop:function(){a.a.each(this.animations,(function(t){t.stop()}))},resetStarted:function(){a.a.each(this.animations,(function(t){t.started=!1}))},onScroll:function(t){t=t||{},(this.page.mag.currentPage===this.page||t.forceApply)&&a.a.each(this.animations,(function(e){e.onScroll&&e.onScroll(t)}))},onResize:function(t){a.a.each(this.animations,(function(e){e.onResize(t)}))},updateTimelines:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];a.a.each(this.animations,(function(e){t.includes(e.animation.UUID)||e.createAnimationTimeline()}))},hasScaleUp:function(){return Boolean(a.a.find(this.animations,(function(t){return s.a.isScaleUp(t.animation)})))},destroy:function(){a.a.each(this.animations,(function(t){t.destroy()})),delete this.animations}}),y={},_=o.a.View.extend({visibleHeightPortion:.2,className:"animation-container",scrolledToView:!1,useOnscrollBoundsFallback:!window.IntersectionObserver,initialize:function(t){a.a.bindAll(this),a.a.extend(this,t),a.a.each(this.widgets,a.a.bind((function(t){t.animationObj=this,t.animationObjects=[].concat(g(t.animationObjects||[]),[this])}),this)),this.isFixed=this.widgets[0].fixed_position,this.isFullwidth=this.widgets[0].is_full_width,this.isFullheight=this.widgets[0].is_full_height,this.isSticked=this.widgets[0].sticked,this.isAbove=this.widgets[0].is_above,this.playOnce=!this.page.mag.isPreview&&this.playOnce,this.$container=this.$container||(this.isFixed||this.isAbove?this.widgets[0].$fixedContainer:this.page.$content),this.$el.appendTo(this.$wrapper?this.$wrapper:this.$container),this.createAnimationTimeline(t),this.onResize({updateAll:!0})},createAnimationTimeline:function(t){t=t||{},this.timeline&&this.timeline.destroy(),this.animation=s.a.getNormalizedAnimation(this.rawAnimation,this.isFixed,this.isFullwidth,this.isFullheight,this.page.scale,this.page.pageViewport,this.page.mag.getViewportWidth(this.page.pageViewport),this.page.mag.viewOpts),this.timeline=s.a.createAnimationTimeline({el:this.$el,steps:this.animation.steps,type:this.animation.type,force3d:!1,animationTrigger:this.animation.trigger,selfTriggered:Boolean(a.a.intersection(s.a.normalizeAnimationTriggers(this.animation.trigger),this.widgets.map((function(t){return t._id}))).length),screenshotMode:!!RM.screenshot})},start:function(){this.timeline&&this.paused&&(this.paused=!1,this.timeline.resume())},stop:function(){this.timeline&&this.timeline.active&&(this.isAbove||(this.paused=!0,this.timeline.pause()))},getAnimationContainer:function(){return this.$el},modifyWidgetPosition:function(t){return this.isFixed?(t.dimensions.left="50%",t.dimensions.top="50%",t.dimensions.right="",t.dimensions.bottom="",t.dimensions["margin-left"]=-t.dimensions.width/2,t.dimensions["margin-top"]=-t.dimensions.height/2):(t.dimensions.left-=this.bbox_css.left+(this.isNested?this.topmostAnimation.bbox_css.left:0),t.dimensions.top-=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)),t},onResize:function(t){if((t=t||{}).updateAll||this.isFixed&&this.prevPageScale!==this.page.scale||this.isFullwidth||this.isFullheight||this.isSticked){var e,i={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY,z:0};this.isFixed||this.isFullwidth||this.isFullheight||this.isSticked?this.bbox_css=p(p({},this.widgets[0].calcBoxStyle({calcBBox:!0}).dimensions),this.isNested?{left:0,top:0,"margin-left":0,"margin-top":0}:{}):(a.a.each(this.widgets,(function(t){e=t.calcBoxStyle({calcBBox:!0}).dimensions,i.t=Math.min(i.t,e.top),i.l=Math.min(i.l,e.left),i.b=Math.max(i.b,e.top+e.height),i.r=Math.max(i.r,e.left+e.width),i.z=Math.max(i.z,e["z-index"])}),this),this.bbox_css={left:this.isNested?0:i.l,top:this.isNested?0:i.t,width:i.r-i.l,height:i.b-i.t,"z-index":i.z}),this.$el.css(this.bbox_css)}this.innerContentTop=this.page.contentPosition.top/this.page.scale,this.innerContainerHeight=this.page.mag.getContainerSizeCached().height/this.page.scale,this.prevPageScale=this.page.scale},withTriggerOrElement:function(t){var e,i=this;return(e=regeneratorRuntime.mark((function e(){var n,o,a,r,s,l,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=!0,a=!1,e.prev=3,s=v(i.animation.trigger.filter((function(t){return t})));case 5:return e.next=7,s.next();case 7:return l=e.sent,o=l.done,e.next=11,l.value;case 11:if(c=e.sent,o){e.next=27;break}return d=c,e.prev=14,e.t0=n,e.next=18,i.page.mag.getWidgetById(d,i.page);case 18:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=24;break;case 22:e.prev=22,e.t2=e.catch(14);case 24:o=!0,e.next=5;break;case 27:e.next=33;break;case 29:e.prev=29,e.t3=e.catch(3),a=!0,r=e.t3;case 33:if(e.prev=33,e.prev=34,o||null==s.return){e.next=38;break}return e.next=38,s.return();case 38:if(e.prev=38,!a){e.next=41;break}throw r;case 41:return e.finish(38);case 42:return e.finish(33);case 43:n.forEach((function(e){e.rendered?t(e.$el):i.listenToOnce(e,"rendered",(function(){return t(e.$el)}))})),n.length||t(i.$el);case 45:case"end":return e.stop()}}),e,null,[[3,29,33,43],[14,22],[34,,38,42]])})),function(){var t=this,i=arguments;return new Promise((function(n,o){var a=e.apply(t,i);function r(t){h(a,n,o,r,s,"next",t)}function s(t){h(a,n,o,r,s,"throw",t)}r(void 0)}))})()},getBBScaleFactor:function(){return l.a.isOnForRatio(this.page.pageViewport,this.page.scale,this.page.mag.viewOpts)&&l.a.isCSSZoom()?this.page.scale:1},isInView:function(){var t=c.a.getBoundingBoxOfElements(this.widgets.map((function(t){return t.$el[0]})),this.getBBScaleFactor()),e=this.visibleHeightPortion*t.height;return t.height&&t.bottom>=e&&t.bottom<=window.innerHeight||t.height&&t.top<=window.innerHeight-e&&t.top>0},notifyWhenInOrOutOfView:function(){var t=this;window.requestAnimationFrame((function(){t.isInView()?(t.scrolledToView=!0,t.scrolledOutOfView=!1,t.trigger("scrolledToView")):(t.scrolledToView=!1,t.scrolledOutOfView=!0,t.trigger("scrolledOutOfView"))}))},whenInView:function(){return this.whenInOrOutOfView(!1)},whenOutOfView:function(){return this.whenInOrOutOfView(!0)},whenInOrOutOfView:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!e;if(this.useOnscrollBoundsFallback)return i&&this.isInView()||e&&!this.isInView()?window.Promise.resolve():new window.Promise((function(i){t.listenToOnce(t,e?"scrolledOutOfView":"scrolledToView",i)}));var n=this.widgets.map((function(t){return t.$el[0]})),o=c.a.getBoundingBoxOfElements(n,this.getBBScaleFactor());return new window.Promise((function(a){var r=new window.IntersectionObserver((function(t){return t.forEach((function(t){(i&&t.isIntersecting||e&&!t.isIntersecting)&&(n.forEach((function(t){return r.unobserve(t)})),a())}))}),i?{rootMargin:"-".concat(o.height*t.visibleHeightPortion,"px 0px")}:void 0);n.forEach((function(t){return r.observe(t)}))}))},destroy:function(){this.stop(),this.timeline&&this.timeline.destroy(),this.remove()}});y.scroll=_.extend({onScroll:function(t){if(t=t||{},this.timeline&&(this.page.mag.currentPage===this.page&&!this.isAbove||t.forceApply)){var e=this.isAbove?t.scroll:Math.max(0,this.page.visibleWidgetsCoords.scrollTop||0);if(this.isFixed)this.timeline.seek(e);else{var i=this.animation.steps[0].start_point||"bottom",n=this.bbox_css.top+(this.isNested?this.topmostAnimation.bbox_css.top:0)+this.innerContentTop,o=n-this.innerContainerHeight,a={top:1,center:.5,bottom:0}[i]*(n-o)+o+this.animation.steps[0].start_offset||0;a<=0?this.timeline.seek(e/this.page.scale):this.timeline.seek(Math.max(0,e-a*this.page.scale)/this.page.scale)}}},onResize:function(){_.prototype.onResize.apply(this,arguments),this.onScroll()}}),y.load=_.extend({initialize:function(){_.prototype.initialize.apply(this,arguments);var t=this.animation.steps;this.startWhenInView=t&&t.length&&t[0].startWhenInView,this.notifyWhenInOrOutOfView.__throttled=a.a.throttle(this.notifyWhenInOrOutOfView,100)},start:function(){_.prototype.start.apply(this,arguments),this.isReady().then(function(){this.timeline.play(),this.started=!0}.bind(this)).catch((function(t){t&&console.log(t&&t.stack)}))},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},isReady:function(){var t,e=this;if(RM.screenshot||this.started||r.default.PageVisibilityManager.isPageHidden())t=window.Promise.reject();else{var i=this.widgets[0],n=[],o=window.Promise.all(this.widgets.map((function(t){return t.loaded?window.Promise.resolve():new window.Promise((function(i){return e.listenToOnce(t,"loaded",i)}))})));if(this.isAbove){var a=this.page.mag.aboveAnimationsReady?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page.mag,"aboveAnimationsReady",t)}.bind(this)),s=i.rendered?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(i,"rendered",t)}.bind(this)),l=i.wasHidden?new window.Promise(function(t){this.listenToOnce(i,"shown",t)}.bind(this)):window.Promise.resolve();n=this.startWhenInView?[s,l,o]:[a,s,l,o]}else{var c=this.page.started?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page,"started",t)}.bind(this)),d=this.page.loadAnimationsReady?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page,"loadAnimationsReady",t)}.bind(this)),h=this.page.isCurrent()?window.Promise.resolve():new window.Promise(function(t){this.listenToOnce(this.page,"changedTo",t)}.bind(this)),u=this.startWhenInView?o.then((function(){return e.whenInView()})):window.Promise.resolve();n=this.startWhenInView?[c,h,u]:[d,c]}t=window.Promise.all(n)}return t}}),y.click=_.extend({resetWhenOutOfView:!1,initialize:function(){_.prototype.initialize.apply(this,arguments);var t=function(t){t.on("click",this.onClick),t.css("cursor","pointer")}.bind(this);this.willStopOnEnd=!1,this.lastTimeClick=0,this.withTriggerOrElement(t),this.notifyWhenInOrOutOfView.__throttled=a.a.throttle(this.notifyWhenInOrOutOfView,100)},onClick:function(){var t=this;this.timeline&&(+new Date-this.lastTimeClick<300||(this.lastTimeClick=+new Date,this.timeline.active?(this.willStopOnEnd?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd),this.willStopOnEnd=!this.willStopOnEnd):(this.willStopOnEnd=!1,this.timeline.reversed?this.timeline.reverse():this.timeline.play(),this.setHasPlayed(),a.a.each(this.widgets,(function(e){"video"===e.type&&e.player&&(t.timeline.reversed?e.player.pause():e.player.play())})))))},onScroll:function(){this.useOnscrollBoundsFallback&&this.notifyWhenInOrOutOfView.__throttled()},onCycleEnd:function(){this.willStopOnEnd=!1,this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():(this.timeline.reversed?this.timeline.reverse():this.timeline.play(),this.setHasPlayed())},setHasPlayed:function(){var t=this,e=s.a.getPermanentAnimationId(this.widgets[0],this.animation.UUID);this.animation.playOnce&&!s.a.hasPlayed(e)&&s.a.persistHasPlayed(e),this.animation.resetWhenOutOfView&&this.whenOutOfView().then((function(){t.timeline.applyStepState("initial"),t.timeline.reversed=!1}))},destroy:function(){var t=function(t){t.css("cursor","")};this.withTriggerOrElement(t),_.prototype.destroy.apply(this,arguments)}}),y.hover=_.extend({initialize:function(){if(_.prototype.initialize.apply(this,arguments),d.a.isDesktop){var t=function(t){t.on("mouseenter",this.onMouseEnter),t.on("mouseleave",this.onMouseLeave)}.bind(this);a.a.each(this.widgets,a.a.bind((function(t){-1!==["text","shape","picture","button"].indexOf(t.type)&&(t.hasHoverAnimation=!0)}),this)),this.withTriggerOrElement(t)}},onMouseEnter:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.on("full-cycle-end",this.onCycleEnd):this.timeline.off("full-cycle-end",this.onCycleEnd):!this.timeline.reversed&&this.timeline.play())},onMouseLeave:function(){this.timeline&&(this.timeline.active?!this.timeline.loop&&this.timeline.reversed?this.timeline.off("full-cycle-end",this.onCycleEnd):this.timeline.on("full-cycle-end",this.onCycleEnd):!this.timeline.loop&&this.timeline.reversed&&this.timeline.reverse())},onCycleEnd:function(){this.timeline.off("full-cycle-end",this.onCycleEnd),this.timeline.loop?this.timeline.isFullLoop?this.timeline.stop():this.timeline.reverse():this.timeline.reversed?this.timeline.reverse():this.timeline.play()}}),e.a=b},HwbM:function(module,exports){module.exports={"template-constructor-control-form_captcha":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Lock" data-alt-pos="left" data-alt-offset="9"></div>\n';return __p}}},HxOx:function(module,exports){module.exports={"template-constructor-control-text_link":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Link" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\n\t\t<div class="panel-caption">Link</div>\n\n\t\t<div class="picture-preview-error">\n\t\t\t<div class="message-text">Oops, you can’t add a link to this image since Lightbox is enabled</div>\n    </div>\n\n\t\t<div class="common-wrapper">\n\n\t\t\t<div class="edit-wrapper default-state">\n\n\t\t\t\t<div class="edit-item" data-field="_caption">\n\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="state-switcher-wrapper">\n\t\t\t\t\t<div class="caption-default state-switcher">Link</div>\n\t\t\t\t\t<div class="caption-hover state-switcher">Hover</div>\n\t\t\t\t\t<div class="caption-current state-switcher">Current</div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="params-wrapper clearfix">\n\t\t\t\t\t<div class="params-block params-default">\n\n\t\t\t\t\t\t<div class="edit-item color-click-area" data-field="color"  data-field-dop="opacity">\n\t\t\t\t\t\t\t<div class="caption">Text Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item underline-style-click-area separator" data-field="u-style">\n\t\t\t\t\t\t\t<div class="caption">Underline</div>\n\t\t\t\t\t\t\t<div class="underline-style"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item color-click-area separator" data-field="u-color"  data-field-dop="u-opacity">\n\t\t\t\t\t\t\t<div class="caption">Underline Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="u-size">\n\t\t\t\t\t\t\t<div class="caption">Underline Width</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="u-offset">\n\t\t\t\t\t\t\t<div class="caption">Padding</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\n\n\n\t\t\t\t\t<div class="params-block params-hover">\n\n\t\t\t\t\t\t<div class="edit-item color-click-area" data-field="hover-color"  data-field-dop="hover-opacity">\n\t\t\t\t\t\t\t<div class="caption">Text Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item underline-style-click-area separator" data-field="hover-u-style">\n\t\t\t\t\t\t\t<div class="caption">Underline</div>\n\t\t\t\t\t\t\t<div class="underline-style"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item color-click-area separator" data-field="hover-u-color"  data-field-dop="hover-u-opacity">\n\t\t\t\t\t\t\t<div class="caption">Underline Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="hover-u-size">\n\t\t\t\t\t\t\t<div class="caption">Underline Width</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="hover-u-offset">\n\t\t\t\t\t\t\t<div class="caption">Padding</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="params-block params-current">\n\n\t\t\t\t\t\t<div class="edit-item color-click-area" data-field="current-color"  data-field-dop="current-opacity">\n\t\t\t\t\t\t\t<div class="caption">Text Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item underline-style-click-area separator" data-field="current-u-style">\n\t\t\t\t\t\t\t<div class="caption">Underline</div>\n\t\t\t\t\t\t\t<div class="underline-style"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item color-click-area separator" data-field="current-u-color"  data-field-dop="current-u-opacity">\n\t\t\t\t\t\t\t<div class="caption">Underline Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="current-u-size">\n\t\t\t\t\t\t\t<div class="caption">Underline Width</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="current-u-offset">\n\t\t\t\t\t\t\t<div class="caption">Padding</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t\t<div class="transform-wrapper">\n\n\t\t\t\t<div class="search-wrapper">\n\t\t\t\t\t<input type="text" spellcheck="false"  required="required" value=""/>\n\t\t\t\t\t<div class="placeholder" data-initial="URL, page no., email" data-url="URL" data-page="Page Number (e.g. 8)" data-email="Email" data-phone="e.g. +71234567890" data-anchor="point a place" data-back="Scroll to Top" data-goback="Go Back" data-mailchimp="Mailchimp Popup" data-multiple="Multiple" data-no-page="Page doesn\'t exist"></div>\n\t\t\t\t\t<div class="action-icon hidden"></div>\n\t\t\t\t\t<div class="target-icon"></div>\n\t\t\t\t\t<div class="placeholder-selector hidden">\n\t\t\t\t\t\t<div class="placeholder-popup">\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="url">Website URL</div>\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="page">Jump to Page</div>\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="email">Email</div>\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="phone">Phone Number</div>\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="anchor">Anchor</div>\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="back">Scroll to Top</div>\n\t\t\t\t\t\t\t<div class="placeholder-item" data-type="goback">Go back</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="placeholder-arrow"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t\t<div class="resizable-content">\n\t\t\t\t\t\t\t<div class="styles-wrapper"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="target-wrapper">\n\t\t\t\t\t<div class="caption">Open in new tab</div>\n\t\t\t\t\t<div class="toggle">\n\t\t\t\t\t\t<input type="checkbox">\n\t\t\t\t\t\t<div class="bg"></div>\n\t\t\t\t\t\t<div class="handle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\n\n\n\t\t<div class="add-block">\n\t\t\t<div class="add" title="Create New Link Style"></div>\n\t\t\t<div class="save">Save</div>\n\t\t\t<div class="cancel" title="Cancel Changes"></div>\n\t\t</div>\n\n\n\t\t<div class="colorbox_container"></div>\n\n\t\t<div class="underline_style_container">\n\t\t\t<div class="underline-style-popup">\n\t\t\t\t<div class="underline-style-item" data-type="none">None</div>\n\t\t\t\t<div class="underline-style-item" data-type="solid"></div>\n\t\t\t\t<div class="underline-style-item" data-type="dotted"></div>\n\t\t\t\t<div class="underline-style-item" data-type="dashed"></div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="style-menu transition-enable">\n\t\t\t<div class="edit-button">Edit Style</div>\n\t\t\t<div class="separator s-1"></div>\n\t\t\t<div class="duplicate-button">Duplicate</div>\n\t\t\t<div class="separator s-2"></div>\n\t\t\t<div class="delete-button">Delete</div>\n\n\t        <div class="corner-wrapper">\n\t            <div class="corner"></div>\n\t        </div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-text_link-style":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="link-style" data-id="'+(null==(__t=_name)?"":_.escape(__t))+'">\n\t\t<div class="style-caption '+(null==(__t=_name)?"":_.escape(__t))+'">'+(null==(__t=_caption)?"":_.escape(__t))+'</div>\n\t\t<div class="menu-button"></div>\n\t</div>\n';return __p}}},I0kf:function(t,e,i){"use strict";function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,"a",(function(){return r}));var a=window.ServerData.featureFlags?function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){o(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},window.ServerData.featureFlags):{},r=function(t){return a[t]||!1}},ICos:function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"j",(function(){return c})),i.d(e,"f",(function(){return d})),i.d(e,"c",(function(){return h})),i.d(e,"h",(function(){return u})),i.d(e,"e",(function(){return p})),i.d(e,"g",(function(){return m})),i.d(e,"d",(function(){return g})),i.d(e,"b",(function(){return f})),i.d(e,"i",(function(){return v}));var n=i("aSns"),o=i.n(n),a=i("xeF9");function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var l=function(t){var e=Number(t).toString(16);return e.length<2?"0".concat(e):e},c=function(t){var e=l(t.r),i=l(t.g),n=l(t.b),o=l(parseInt((100*t.a).toFixed(0)));return"".concat(e).concat(i).concat(n).concat(o)},d=function(t){var e=t;if(!e)return{r:0,g:0,b:0,a:1};"#"===e[0]&&(e=e.slice(1));var i=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),o=parseInt(e.substring(4,6),16),a=parseInt(e.substring(6,8),16)/100;return{r:i,g:n,b:o,a:void 0===a||a>1?1:a<0?0:a}},h=function(t){var e=t.replace("#",""),i=r(o()("#".concat(e)).rgb().array(),3);return{r:i[0],g:i[1],b:i[2]}},u=function(t){var e=l(parseInt((100*t.a).toFixed(0))),i=o()({h:t.h,s:t.s,v:t.v}).hex().replace("#","");return"".concat(i).concat(e)},p=function(t){if("string"!=typeof t)return t;var e=t.replace("#",""),i=parseInt(e.substring(6,8),16)/100,n=e.substring(0,6),a=r(o()("#".concat(n)).hsv().array(),3);return{h:a[0],s:a[1],v:a[2],a:void 0===i||i>1?1:i<0?0:i}},m=function(t){return o()({h:t.h,s:t.s,v:t.v}).hex().replace("#","")},g=function(t){if("string"!=typeof t)return t;var e=t;return"#"===e[0]&&(e=e.slice(1)),e.substring(0,6)},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t.replace("#",""),n=o()("#".concat(i)).hsv().array(),a=r(n,3),s=a[0],l=a[1],c=a[2];return{h:s,s:l,v:c,a:e}},v=function(t){var e=Object(a.parseCSSColor)(t);if(e){var i=r(e,4);return{r:i[0],g:i[1],b:i[2],a:i[3]||1}}return{r:0,g:0,b:0,a:1}}},ILQV:function(t,e,i){},Ib1Q:function(t,e,i){"use strict";var n=i("rwzP");i.n(n).a},IrH7:function(t,e,i){"use strict";i.d(e,"c",(function(){return c})),i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return d})),i.d(e,"d",(function(){return h})),i.d(e,"e",(function(){return u}));var n=i("sn3M"),o=i("fueH");function a(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function r(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var l,c="align";!function(t){t.AlignLeft="align-left",t.AlignCenter="align-center",t.AlignRight="align-right",t.AlignJustify="align-justify"}(l||(l={}));var d=r(r(r(r({},Object(n.a)({className:l.AlignLeft,label:"Left",styles:"\n      text-align: left !important;\n    "})),Object(n.a)({className:l.AlignCenter,label:"Center",styles:"\n      text-align: center !important;\n    "})),Object(n.a)({className:l.AlignRight,label:"Right",styles:"\n      text-align: right !important;\n    "})),Object(n.a)({className:l.AlignJustify,label:"Justify",styles:"\n      text-align: justify !important;\n      white-space: normal; // для сафари\n    "})),h=function(t){var e=t.editorState,i=t.block,n=o.a.getBlockData({editorState:e,block:i,key:"align"});return"string"==typeof n?n:""},u=function(t){var e=t.block,i=t.editorState,n=t.align;return o.a.setBlockData({editorState:i,block:e,key:c,value:n})}},IzrY:function(t,e,i){},JW7n:function(t,e,i){"use strict";var n=i("q1tI"),o=i.n(n),a=i("i8i4"),r=i.n(a),s=i("LDvm"),l=i("w5C2"),c=[{name:"style-h1",label:"H1",tag:"h1",cssProperties:{color:"22222264",fontFamily:"Roboto",fontStyle:"normal",textAlign:"left",fontSize:48,fontWeight:700,letterSpacing:0,lineHeight:60,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},{name:"style-h2",label:"H2",tag:"h2",cssProperties:{color:"22222264",fontFamily:"Georgia",fontStyle:"normal",textAlign:"left",fontSize:24,fontWeight:400,letterSpacing:0,lineHeight:30,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},{name:"style-text",label:"Text",tag:"p",cssProperties:{color:"22222264",fontFamily:"Georgia",fontStyle:"normal",textAlign:"left",fontSize:18,fontWeight:400,letterSpacing:0,lineHeight:23,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},{name:"style-caption",label:"Caption",tag:"p",cssProperties:{color:"22222232",fontFamily:"Georgia",fontStyle:"italic",textAlign:"left",fontSize:14,lineHeight:18,letterSpacing:0,fontWeight:400,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}}],d=[{name:"list-style",label:"List item",cssProperties:{color:"22222264",fontFamily:l.b.fontFamily,fontStyle:l.b.fontStyle,textAlign:"left",fontSize:l.b.fontSize,fontWeight:Number(l.b.fontWeight),letterSpacing:0,lineHeight:l.b.lineHeight,paddingRight:0,paddingLeft:0}}],h=i("Wwwp"),u=i("uU7u"),p=i("vOnD"),m=i("Jzj8"),g=i("L2iM"),f=i("a68n"),v=i("8RDp");function b(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||x(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){w(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function k(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  ","\n  ","\n  ","\n  ","\n"]);return k=function(){return t},t}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||x(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){if(t){if("string"==typeof t)return C(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?C(t,e):void 0}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function O(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function j(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){O(a,n,o,r,s,"next",t)}function s(t){O(a,n,o,r,s,"throw",t)}r(void 0)}))}}i.d(e,"b",(function(){return P})),i.d(e,"a",(function(){return I})),i.d(e,"d",(function(){return T})),i.d(e,"c",(function(){return M}));var P=function(){var t=j(regeneratorRuntime.mark((function t(){var e,i,n,o,a,r,l,h,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.RM.constructorRouter.mag.get("_id"),i=window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("_id"),e&&i){t.next=4;break}throw new Error("Cannot load text styles");case 4:return t.next=6,Promise.all([Object(s.n)({projectId:e}),Object(s.t)({userId:i}),Object(s.k)({projectId:e}),Object(s.p)({userId:i}),Object(s.l)({projectId:e}),Object(s.q)({userId:i})]);case 6:return n=t.sent,o=S(n,6),a=o[0].data,r=o[1].data,l=o[2].data,h=o[3].data,p=o[4].data,m=o[5].data,t.abrupt("return",{textStyles:{global:r&&r.length?r:[],project:a&&a.length?a:c},linkStyles:{global:h&&h.length?h:[],project:l&&l.length?l:[u.c]},listStyles:{global:m&&m.length?m:[],project:p&&p.length?p:d}});case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),E=Object(p.c)(k(),(function(t){return t.blockStyles}),(function(t){return t.textStyleSheet}),(function(t){return t.linkStyleSheet}),(function(t){return t.listStyleSheet})),I=function(t){var e=t.mode,i=S(Object(m.k)(),2),a=i[0],r=i[1],l=S(Object(m.i)(),2),p=l[0],y=l[1],k=S(Object(m.j)(),2),x=k[0],C=k[1];Object(n.useEffect)((function(){if("constructor"===e){var t=[];if(!a.global.length&&!a.project.length){var i,n,o=window.ServerData.textStyles,l=c;if(!o||!o.project||!o.project.length){var m,g,f=null===(m=window.ServerData)||void 0===m||null===(g=m.editParams)||void 0===g?void 0:g.paragraph_styles;f&&(l=Object(h.b)(f),t.push(Object(s.P)({styles:l,projectId:window.ServerData.projectId})))}r({global:(null==o||null===(i=o.global)||void 0===i?void 0:i.length)?o.global:[],project:(null==o||null===(n=o.project)||void 0===n?void 0:n.length)?o.project:l})}if(!p.global.length&&!p.project.length){var v,b,_=window.ServerData.linkStyles,w=[u.c];if(!_||!_.project||!_.project.length){var k=window.ServerData.editParams&&window.ServerData.editParams.link_styles;k&&(w=Object(h.a)(k),t.push(Object(s.M)({styles:w,projectId:window.ServerData.projectId})))}y({global:(null==_||null===(v=_.global)||void 0===v?void 0:v.length)?_.global:[],project:(null==_||null===(b=_.project)||void 0===b?void 0:b.length)?_.project:w})}if(!x.global.length&&!x.project.length){var S,O,j=window.ServerData.listStyles;C({global:(null==j||null===(S=j.global)||void 0===S?void 0:S.length)?j.global:[],project:(null==j||null===(O=j.project)||void 0===O?void 0:O.length)?j.project:d})}t.length&&Promise.all(t)}if("viewer"===e||"screenshoter"===e){var P,E,I,T,M,$,A,R,D,B,L,z,F,U,N,H,V,W,G,q,K,Y,X,Z,J,Q,tt="viewer"===e,et=tt?(null===(P=window.ServerData)||void 0===P||null===(E=P.mags)||void 0===E||null===(I=E.mag)||void 0===I?void 0:I.textStyles)||(null===(T=window.RM)||void 0===T||null===(M=T.viewerRouter)||void 0===M||null===($=M.mag)||void 0===$?void 0:$.textStyles):null===(A=window.ServerData)||void 0===A||null===(R=A.mag)||void 0===R?void 0:R.textStyles;if(et)r({global:(null==et||null===(J=et.global)||void 0===J?void 0:J.length)?et.global:[],project:(null==et||null===(Q=et.project)||void 0===Q?void 0:Q.length)?et.project:c});var it,nt,ot=tt?(null===(D=window.ServerData)||void 0===D||null===(B=D.mags)||void 0===B||null===(L=B.mag)||void 0===L?void 0:L.linkStyles)||(null===(z=window.RM)||void 0===z||null===(F=z.viewerRouter)||void 0===F||null===(U=F.mag)||void 0===U?void 0:U.linkStyles):null===(N=window.ServerData)||void 0===N||null===(H=N.mag)||void 0===H?void 0:H.linkStyles;if(ot)y({global:(null==ot||null===(it=ot.global)||void 0===it?void 0:it.length)?ot.global:[],project:(null==ot||null===(nt=ot.project)||void 0===nt?void 0:nt.length)?ot.project:[u.c]});var at,rt,st=tt?(null===(V=window.ServerData)||void 0===V||null===(W=V.mags)||void 0===W||null===(G=W.mag)||void 0===G?void 0:G.listStyles)||(null===(q=window.RM)||void 0===q||null===(K=q.viewerRouter)||void 0===K||null===(Y=K.mag)||void 0===Y?void 0:Y.listStyles):null===(X=window.ServerData)||void 0===X||null===(Z=X.mag)||void 0===Z?void 0:Z.listStyles;if(st)C({global:(null==st||null===(at=st.global)||void 0===at?void 0:at.length)?st.global:[],project:(null==st||null===(rt=st.project)||void 0===rt?void 0:rt.length)?st.project:d})}}),[]);var O=Object(n.useMemo)((function(){return Object.keys(g.a).map((function(t){return g.a[t].style})).join(" ")}),[g.a]),j=Object(n.useMemo)((function(){var t=function(t){var e,i=(e=t.cssProperties,Object.keys(e).reduce((function(t,i){var n=e[i];return"string"==typeof n&&n.includes("(")&&!n.includes(")")&&(n="".concat(n,")")),n&&"opacity"===i&&parseInt(String(n))>1&&(n=parseInt(String(n))/100),_(_({},t),{},w({},i,n))}),{}));return"justify"===(i.textAlign&&String(i.textAlign))&&(i.whiteSpace="normal")," .".concat(t.name," { ").concat(Object(f.a)(i)," } ")},e=a.global.map(t),i=a.project.map(t);return[].concat(b(e),b(i)).join(" ")}),[a]),P=Object(n.useMemo)((function(){var t=function(t){var e=_({},t.cssProperties);return e.display="inline-block"," .".concat(t.name," {\n        &-preview {\n          ").concat(Object(f.a)(t.cssProperties),"\n        }\n\n        div[data-offset-key]:before, & > li:before, &:before {\n          ").concat(Object(f.a)(e),"\n        }\n      } ")},e=x.global.map(t),i=x.project.map(t);return[].concat(b(e),b(i)).join(" ")}),[x]),I=Object(n.useMemo)((function(){var t=function(t){var e,i,n;return" .".concat(t.name," {\n      ").concat((null===(e=t.style)||void 0===e?void 0:e.link)?"\n          // Стиль подчеркивания\n          ".concat(Object(f.a)(Object(v.b)(t.style.link)),"\n          ").concat(Object(f.a)({color:t.style.link.textColor}),"\n          & * {\n            ").concat(Object(f.a)({color:t.style.link.textColor}),"\n          }"):"","\n\n      ").concat((null===(i=t.style)||void 0===i?void 0:i.hover)?"\n          // Стиль подчеркивания при наведении\n          &.hover, &:hover {\n            ".concat(Object(f.a)(Object(v.b)(t.style.hover)),"\n            ").concat(Object(f.a)({color:t.style.hover.textColor},!0),"\n            & * {\n              ").concat(Object(f.a)({color:t.style.hover.textColor},!0),"\n            }\n          }"):"","\n\n      ").concat((null===(n=t.style)||void 0===n?void 0:n.current)?"\n          // Стиль подчеркивания для Current ссылки\n          &.current {\n            ".concat(Object(f.a)(Object(v.b)(t.style.current)),"\n            ").concat(Object(f.a)({color:t.style.current.textColor}),"\n            & * {\n              ").concat(Object(f.a)({color:t.style.current.textColor}),"\n            }\n          }"):"","\n     } ")},e=p.global.map(t),i=p.project.map(t);return[].concat(b(e),b(i)).join(" ")}),[p]);return o.a.createElement(E,{blockStyles:O,textStyleSheet:j,linkStyleSheet:I,listStyleSheet:P})},T=function(t){var e="text-global-styles",i=document.querySelector("#".concat(e));i||((i=document.createElement("div")).id=e,document.body.appendChild(i)),r.a.render(o.a.createElement(I,{mode:t}),i)},M=function(){var t=j(regeneratorRuntime.mark((function t(e){var i,n,o,a,r,l,c,d,h,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.newTextStyles,n=e.newLinkStyles,o=e.newListStyles,t.next=3,P();case 3:a=t.sent,i&&i.length&&(r=i.filter((function(t){return!a.textStyles.project.some((function(e){return e.name===t.name}))}))).length&&(l=[].concat(b(a.textStyles.project),b(r)),Object(m.g)({global:a.textStyles.global,project:l}),Object(s.P)({styles:l,projectId:window.ServerData.projectId})),o&&o.length&&(c=o.filter((function(t){return!a.listStyles.project.some((function(e){return e.name===t.name}))}))).length&&(d=[].concat(b(a.listStyles.project),b(c)),Object(m.f)({global:a.listStyles.global,project:d}),Object(s.N)({styles:d,projectId:window.ServerData.projectId})),n&&n.length&&(h=n.filter((function(t){return!a.linkStyles.project.some((function(e){return e.name===t.name}))}))).length&&(u=[].concat(b(a.linkStyles.project),b(h)),Object(m.e)({global:a.linkStyles.global,project:u}),Object(s.M)({styles:u,projectId:window.ServerData.projectId}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Jzj8:function(t,e,i){"use strict";i.d(e,"k",(function(){return s})),i.d(e,"g",(function(){return l})),i.d(e,"d",(function(){return c})),i.d(e,"i",(function(){return h})),i.d(e,"e",(function(){return u})),i.d(e,"b",(function(){return p})),i.d(e,"j",(function(){return g})),i.d(e,"f",(function(){return f})),i.d(e,"c",(function(){return v})),i.d(e,"h",(function(){return b})),i.d(e,"a",(function(){return y}));var n=i("jcqt");function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var r=o(Object(n.a)({global:[],project:[]}),3),s=r[0],l=r[1],c=r[2],d=o(Object(n.a)({global:[],project:[]}),3),h=d[0],u=d[1],p=d[2],m=o(Object(n.a)({global:[],project:[]}),3),g=m[0],f=m[1],v=m[2],b=o(Object(n.a)({}),1)[0],y=function(t){var e=t.fontFamily,i=t.fontWeight,n=t.fontStyle;return"".concat(e,"_").concat(i,"_").concat(n)}},K6JF:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("1wfi"),l=i.n(s),c=a.a.View.extend({events:{"click .shortcuts":"showShortcuts","click .take-a-tour":"showTour","click .read-manual":"onManualClick","click .help-panel-item":"closeHelpPanel"},initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),this.template=l.a["template-constructor-help-panel"],this.render(),this.shortcuts=new d,this.shortcuts.on("hide",this.onHideShortcuts,this),this.shortcuts.on("show",this.onShowShortcuts,this)},tagName:"div",className:"help-panel",shown:!1,closeTipTimeout:8e3,render:function(){this.$el.html(this.template()),this.$parent.append(this.$el),this.delegateEvents(),this.renderedTips={},Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("help-shortcuts")}))},toggle:function(t){if(!(t&&Object(n.a)(t.target).closest(".help-panel").length>0)){if(this.shortcuts.rendered)return this.shortcuts.hide();this.toggleActiveClass(),this.closeAllTips(),this.shown?Object(n.a)("body").on("click",this.closeHelpPanel):this.closeHelpPanel()}},toggleActiveClass:function(t){var e,i=this.$parent||t,n=RM.constructorRouter.me,o=n.get("behavior_metrics")&&!n.get("behavior_metrics").constructor_help_shown;this.shown=!this.shown,i.toggleClass("active",this.shown),o&&(e=i.parent(),r.a.delay(r.a.bind((function(){e.one("click",this.closeHelpPanel)}),this),30))},showShortcuts:function(){RM.analytics&&RM.analytics.sendEvent("Constructor Help Open","Learn shortcuts"),this.shortcuts.show()},showTour:function(){RM.analytics&&RM.analytics.sendEvent("Constructor Help Open","Tour open"),this.router.pages.once("show",(function(){this.router.pages.openTour(!1)}),this),this.router.pages.show()},onManualClick:function(){RM.analytics&&RM.analytics.sendEvent("Constructor Help Open","Learn R/m")},onHideShortcuts:function(){this.$parent.find(".hot-help-button").removeClass("close-btn")},onShowShortcuts:function(){this.$parent.find(".hot-help-button").addClass("close-btn")},showTip:function(t){var e=this.router.me,i=l.a["template-constructor-help-tip-"+t.name],o=e.get("behavior_metrics")&&e.get("behavior_metrics")["constructor-help-tip-"+t.name+"-shown"],a=function(){this.closeTip(t.name),clearTimeout(this.tipTimeoutHandle)}.bind(this);if(!t.showOnce||!o){this.closeAllTips();var r=this.renderedTips[t.name];r||((r=Object(n.a)(i())).appendTo(this.$el.parent()),this.renderedTips[t.name]=r,r.find(".close").on("click",a),t.action&&r.find(".js-action").on("click",(function(e){e.preventDefault(),t.action(),a()}))),clearTimeout(this.tipTimeoutHandle),this.tipTimeoutHandle=setTimeout(a,this.closeTipTimeout),r.show()}},closeTip:function(t){var e=this.router.me,i=r.a.clone(e.get("behavior_metrics"))||{};i["constructor-help-tip-"+t+"-shown"]=!0,e.save({behavior_metrics:i},{patch:!0}),this.closeAllTips()},closeAllTips:function(){r.a.each(this.renderedTips,(function(t){t.hide()}))},closeHelpPanel:function(t){var e=this.$parent||Object(n.a)(t.currentTarget).find(".help-wrapper.active");t&&Object(n.a)(t.target).closest(".help-wrapper").length>0&&!Object(n.a)(t.currentTarget).hasClass("help-panel-item")||t&&Object(n.a)(t.target).closest(".help-tip").length>0||(e.removeClass("active"),this.shown=!1,Object(n.a)("body").off("click",this.closeHelpPanel))}}),d=a.a.View.extend({events:{"click .tabs li":"onClickTab",click:"tryClose"},initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),this.template=l.a["template-constructor-help-shortcuts"]},className:"help-shortcuts invisible",tagName:"div",render:function(){return this.$el.html(this.template()),this.$el.addClass(Modernizr.mac?"mac":"win"),this.$tabs=this.$(".tabs"),this.changeState(this.currentState||"single"),Object(n.a)("body").append(this.$el),this.delegateEvents(),this.rendered=!0,this},changeState:function(t){this.currentState=t,this.$el.removeClass("single alt command shift_command control shift_control control_alt alt_command"),this.$el.addClass(t)},onClickTab:function(t){var e=Object(n.a)(t.currentTarget).data("tab");e!==this.currentState&&this.changeState(e)},show:function(){this.render(),Object(n.a)(document).on("keydown",this.onGlobalKeyDown),r.a.delay(function(){this.$el.removeClass("invisible")}.bind(this),50),this.trigger("show")},hide:function(){this.$el.addClass("invisible"),Object(n.a)(document).off("keydown",this.onGlobalKeyDown),this.rendered=!1,r.a.delay(this.remove,500),this.trigger("hide")},tryClose:function(t){Object(n.a)(t.target).closest(".tabs").length||Object(n.a)(t.target).closest(".keyboard").length||this.hide()},onGlobalKeyDown:function(t){t.keyCode===n.a.keycodes.esc&&this.hide()}});e.b=c},KiFh:function(t,e,i){"use strict";var n=i("q1tI"),o=i.n(n),a=i("i8i4"),r=i.n(a),s=i("dfNU"),l=i("iC7s"),c=i("WySc"),d=i("ICos"),h=i("IwqK"),u=i("QNie");function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return g(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return g(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function f(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}e.a=function(t){var e=t.title,i=void 0===e?"":e,a=t.projectId,g=t.userId,v=t.color,b=t.setColor,y=t.onChangeComplete,_=t.onColorChange,w=t.container,k=t.width,S=t.height,x=t.type,C=void 0===x?"list-item":x,O=t.showAlpha,j=t.regularInRow,P=t.regularRowsMin,E=t.favouriteInRow,I=t.favouriteRows,T=t.regularGap,M=t.favouriteGap,$=t.borderRadius,A=t["aria-labelledby"],R=f(t,["title","projectId","userId","color","setColor","onChangeComplete","onColorChange","container","width","height","type","showAlpha","regularInRow","regularRowsMin","favouriteInRow","favouriteRows","regularGap","favouriteGap","borderRadius","aria-labelledby"]),D=m(Object(n.useState)(!1),2),B=D[0],L=D[1],z=m(Object(n.useState)(""),2),F=z[0],U=z[1],N=m(Object(n.useState)(null),2),H=N[0],V=N[1],W=m(Object(n.useState)(null),2),G=W[0],q=W[1],K=Object(h.a)(H,G,{placement:"top"}),Y=K.styles,X=K.attributes,Z=Object(n.useContext)(u.a).modelSet,J=function(t){if(B){var e=t.target&&H&&H.contains(t.target);t.target&&Q.current&&Q.current.contains(t.target)||e||(Z({preventClose:!1}),L(!1))}};Object(n.useEffect)((function(){return B?window.addEventListener("click",J):window.removeEventListener("click",J),function(){window.removeEventListener("click",J)}}),[B]),Object(n.useEffect)((function(){if(v){var t=Object(d.g)(v);t!==F&&U(t)}}),[v]),Object(n.useEffect)((function(){return function(){Z({preventClose:!1})}}),[]);var Q=Object(n.useRef)(null),tt=o.a.createElement(l.m,p({position:"relative",zIndex:20,ref:q,style:Y.popper},X.popper),o.a.createElement(l.m,{ref:Q},o.a.createElement(c.b,{width:k,height:S,borderRadius:$,projectId:a,userId:g,color:v||c.c,setColor:b,showAlpha:O,regularInRow:j,regularRowsMin:P,favouriteInRow:E,favouriteRows:I,regularGap:T,favouriteGap:M,onColorChange:_?function(t){t&&(U(Object(d.g)(t)),_(t))}:void 0,onChangeComplete:y?function(t){t&&(U(Object(d.g)(t)),y(t))}:void 0}))),et=o.a.createElement(l.n,{"aria-labelledby":A,onClick:function(){L(!B),Z({preventClose:!B})}},o.a.createElement(c.a,{opacity:null==v?void 0:v.a,hex:F?"#"+F:"#F4F4F4",borderColor:"#DCDCDC"}));return"list-item"===C?o.a.createElement(o.a.Fragment,null,o.a.createElement(s.a,p({},R,{zIndex:10,ref:V}),o.a.createElement(l.B,{justifyContent:"space-between",alignItems:"center"},o.a.createElement(l.m,null,o.a.createElement(l.Cb,{textStyle:"small"},i)),o.a.createElement(l.m,{position:"relative"},et))),B?w?r.a.createPortal(o.a.createElement(l.m,null,tt),w):tt:null):"circle"===C?et:"picker"===C?tt:null}},KiUg:function(t,e,i){"use strict";i.d(e,"b",(function(){return d})),i.d(e,"d",(function(){return u})),i.d(e,"c",(function(){return f})),i.d(e,"a",(function(){return v}));var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("fueH"),l=i("DwEc");function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var d=String.fromCharCode(160),h=String.fromCharCode(8239),u=[{name:"No-break space",char:d},{name:"Narrow no-break space",char:h}],p=function(t){var e=t.children,i=t.space;return(a.a.createElement(r.m,{as:"span",position:"relative",zIndex:-1},i,e))},m=Object(n.e)(r.m).withConfig({displayName:"spaces___StyledBox"})(["transform:translateX(-50%);"]),g=Object(n.e)(r.m).withConfig({displayName:"spaces___StyledBox2"})(["transform:translateX(-50%);"]),f={strategy:function(t,e){s.a.findSubstringIndexes(t,d).forEach((function(t){e(t,t+1)}))},component:function(t){var e=Object(o.useContext)(l.a).model.isEditMode;return(a.a.createElement(p,c({space:a.a.createElement(m,{as:"span",contentEditable:!1,position:"absolute",bottom:0,left:"50%"},a.a.createElement(r.X,{color:e?"blue":"transparent",width:"0.5em",height:"0.5em"}))},t)))}},v={strategy:function(t,e){s.a.findSubstringIndexes(t,h).forEach((function(t){e(t,t+1)}))},component:function(t){var e=Object(o.useContext)(l.a).model.isEditMode;return(a.a.createElement(p,c({space:a.a.createElement(g,{as:"span",contentEditable:!1,position:"absolute",top:0,left:"50%"},a.a.createElement(r.W,{color:e?"blue":"transparent",width:"0.4em",height:"0.4em"}))},t)))}}},"Kx3/":function(module,exports){module.exports={"template-constructor-control-common_layer":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon"data-alt="Arrange" data-alt-pos="left" data-alt-offset="9"></div>\n\n\n\t<div class="panel">\n\t\t<div class="backward-all" title="Send to Back"></div>\n\t\t<div class="backward" title="Send Backward"></div>\n\t\t<div class="forward" title="Bring Forward"></div>\n\t\t<div class="forward-all" title="Send to Front"></div>\n\t</div>\n';return __p}}},L2iM:function(t,e,i){"use strict";var n=i("q1tI"),o=i.n(n),a=i("Mpt7"),r=i("IrH7"),s=i("HjzJ"),l=i("w5C2"),c=i("a68n"),d=i("vOnD"),h=i("Jzj8"),u=i("fueH"),p=i("iC7s"),m=i("ePHO"),g=i("DwEc"),f=i("w+s/"),v=i("38uW"),b=i("vvfI");function y(){return(y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function _(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function w(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_(Object(i),!0).forEach((function(e){k(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function k(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function S(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||C(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||C(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){if(t){if("string"==typeof t)return O(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function j(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var P=Object(d.e)(p.m).withConfig({displayName:"TextConstructorWrapper___StyledBox"})(["padding:0 !important;&:after{content:'';pointer-events:none;box-shadow:1px 0 0 0 ",",0 1px 0 0 ",",1px 1px 0 0 ",",1px 0 0 0 "," inset,0 1px 0 0 "," inset;position:absolute;top:0;left:0;width:calc(100% - 1px);height:100%;}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5})),E=function(t){var e=t.children,i=j(t,["children"]),a=Object(n.useContext)(g.a).model,r=a.isEditMode,s=x((0,a.useTextWidgetStore)({partial:!1}),2),l=s[0],d=s[1],p=x(Object(h.k)(),1)[0],_=Object(n.useMemo)((function(){if(!i["data-offset-key"])return{};var t=i["data-offset-key"].split("-")[0];return{blockKey:t,block:l.getCurrentContent().getBlockForKey(t)}}),[i,l]),k=_.blockKey,C=_.block,O=Object(n.useMemo)((function(){return Object(c.b)({block:C})}),[C]),E=Object(n.useMemo)((function(){return Boolean(k&&u.a.isBlockSelected(l,k))}),[l,k]),I=E?"var(--editor-border-color)":"transparent",T=Object(n.useMemo)((function(){return[].concat(S(p.global),S(p.project)).find((function(t){return t.name===O}))}),[O,p,l]),M=Object(n.useMemo)((function(){var t=Object(f.a)({block:C}),e=T?Object(c.e)(T):{};return{paddings:w(w({left:0,right:0,top:0,bottom:0},e),t),changedPaddings:Object(f.b)({blockPaddings:t,stylePaddings:e})}}),[l,C,T,p]),$=M.paddings,A=M.changedPaddings,R=Object(n.useMemo)((function(){return Object(v.a)({block:C})}),[l,C,p]),D=Object(n.useMemo)((function(){return Object(b.a)({block:C})}),[l,C]),B=r&&E;return o.a.createElement(P,y({},i,{position:"relative",style:{lineHeight:"number"==typeof R?"".concat(R,"px"):void 0,textIndent:"number"==typeof D?"".concat(D,"px"):void 0},_css:I,_css2:I,_css3:I,_css4:I,_css5:I}),o.a.createElement(m.b,{key:k,isVisible:B,top:$.top,left:$.left,bottom:$.bottom,right:$.right,changedPaddings:A,onChange:function(t){var e=u.a.getSelectedBlocks(l),i=l.getCurrentContent(),n=e.reduce((function(e,n){var o=i.getBlockForKey(n);if(o){var a=Object(f.a)({block:o});return Object(f.d)({editorState:e,block:o,paddings:w(w({},a),t)})}return e}),l);d(n)}},e))};function I(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function T(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?I(Object(i),!0).forEach((function(e){M(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):I(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function M(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,"a",(function(){return $})),i.d(e,"b",(function(){return A}));var $=T(T(T({},r.b),s.f),l.c),A=function(){var t=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,e=T(T(T({},Object(c.d)()),l.d),s.g);return a.a.Map(Object.keys(e).reduce((function(i,n){var a=e[n].element,r=t?E:a,l=Object(s.e)(n)?o.a.createElement(s.c,{type:n}):void 0;return T(T({},i),{},M({},n,T(T({},e[n]),{},{element:r,wrapper:l})))}),{}))}},L3tv:function(module,exports){module.exports={"template-constructor-control-common_position":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Position" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\n\t\t<div class="param-caption solid-separator">\n\t\t\t<span>Fix position</span>\n\t\t\t<a href="https://help.readymag.com/hc/en-us/articles/360020527132-Fixed-and-positioned-widgets" target="_blank" class="question-icon">\n\t\t\t\t<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<g fill="none" fill-rule="evenodd">\n\t\t\t\t\t\t<circle cx="12" cy="12" r="12"/>\n\t\t\t\t\t\t<path d="M8 9.259C8.06 7.371 9.294 6 11.542 6 13.615 6 15 7.259 15 9.02c0 1.219-.575 2.072-1.604 2.717-.992.614-1.272 1.02-1.272 1.809V14H10.37l-.008-.542c-.068-1.195.37-1.912 1.415-2.558.939-.597 1.256-1.02 1.256-1.808 0-.83-.635-1.427-1.589-1.427-.976 0-1.604.622-1.665 1.594H8zM11.5 18c-.904 0-1.5-.592-1.5-1.495 0-.913.596-1.505 1.5-1.505.922 0 1.5.592 1.5 1.505 0 .903-.578 1.495-1.5 1.495z"/>\n\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t</a>\n\t\t</div>\n\t\t<div class="param-caption">Browser window</div>\n\n\t\t<ul class="dotted-separator">\n\t\t\t<li class="nw"></li>\n\t\t\t<li class="n"></li>\n\t\t\t<li class="ne"></li>\n\t\t\t<li class="w"></li>\n\t\t\t<li class="c"></li>\n\t\t\t<li class="e"></li>\n\t\t\t<li class="sw"></li>\n\t\t\t<li class="s"></li>\n\t\t\t<li class="se"></li>\n\t\t</ul>\n\n\t\t<div class="position-wrapper solid-separator">\n\t\t\t<div class="param-caption">Page</div>\n\t\t\t<div class="togglers-wrapper">\n\t\t\t\t<div class="sticked-top" data-side="top"></div>\n\t\t\t\t<div class="sticked-left" data-side="left"></div>\n\t\t\t\t<div class="full-width"></div>\n\t\t\t\t<div class="full-height"></div>\n\n\t\t\t\t<div class="sticked-right" data-side="right"></div>\n\t\t\t\t<div class="sticked-bottom" data-side="bottom"></div>\n\t\t\t</div>\n\n\t\t\t<div class="margin-wrapper">\n\t\t\t\t<input class="full-height margin-input" type="text" spellcheck="false" value="" data-min="0" data-max="256" data-mouseDir="v" data-mouseSpeed="8" data-shiftStep="15"/>\n\t\t\t\t<input class="full-width margin-input" type="text" spellcheck="false" value="" data-min="0" data-max="256" data-mouseDir="v" data-mouseSpeed="8" data-shiftStep="15"/>\n\t\t\t</div>\n\t\t</div>\n\n\n\t\t<div class="global-options">\n\t\t\t<div class="option global dotted-separator">\n\t\t\t\t<div class="option-title">\n\t\t\t\t\t<div class="title-wrapper">\n\t\t\t\t\t\t<span class="title-caption">On all pages</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="switcher global rmswitcher"></div>\n\t\t\t</div>\n\t\t\t<div class="option above">\n\t\t\t\t<div class="option-title">\n\t\t\t\t\t<div class="title-wrapper">\n\t\t\t\t\t\t<span class="title-caption">Above pages</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="switcher above rmswitcher"></div>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n';return __p}}},L8ei:function(t,e,i){"use strict";var n=i("ILQV");i.n(n).a},LDvm:function(t,e,i){"use strict";var n=i("0NDv");function o(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var a=function(t){return n.a.get("/api/swatches/project/".concat(t))},r=function(t){var e=t.projectId,i=o(t,["projectId"]);return n.a.put("/api/swatches/project/".concat(e),i)},s=function(t){var e=t.projectId,i=o(t,["projectId"]);return n.a.put("/api/swatches/project/".concat(e,"/move"),i)},l=function(t){var e=t.projectId,i=t.colors;return n.a.put("/api/swatches/project/".concat(e,"/reset"),{colors:i})},c=function(t){return n.a.get("/api/swatches/global/".concat(t))},d=function(t){var e=t.userId,i=o(t,["userId"]);return n.a.put("/api/swatches/global/".concat(e),i)},h=function(t){var e=t.userId,i=o(t,["userId"]);return n.a.put("/api/swatches/global/".concat(e,"/move"),i)};function u(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var p=function(t){return n.a.get("/api/mag/".concat(t,"/trash"))},m=function(t,e){return n.a.patch("/api/mag/".concat(t,"/pages/trash"),{pids:e})},g=function(t,e){return n.a.delete("/api/mag/".concat(t,"/pages/trash"),{pids:e})},f=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,i){var o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.a.get("/api/screenshot/renew/".concat(e,"/").concat(i));case 2:return o=t.sent,a=o.screenshot,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){u(a,n,o,r,s,"next",t)}function s(t){u(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t,i){return e.apply(this,arguments)}}(),v=function(t){return n.a.post("/api/font-features",t)},b=function(t){var e=new FormData;return e.append("upload",t),fetch("/api/upload/font",{method:"post",body:e}).then((function(t){return t.json()}))},y=function(t){return n.a.post("/api/custom-font",t)},_=function(t){return n.a.get("/api/custom-font/".concat(t))},w=function(t,e){return n.a.put("/api/custom-font/".concat(t),e)};function k(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var S=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,i){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new FormData).append("name",e),n.append("upload",i),t.next=5,fetch("/api/upload",{headers:{"cache-control":"no-cache"},method:"post",body:n}).then((function(t){return t.json()}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){k(a,n,o,r,s,"next",t)}function s(t){k(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t,i){return e.apply(this,arguments)}}(),x=function(t){var e=t.userId;return n.a.get("/api/text-styles/global/".concat(e))},C=function(t){var e=t.projectId;return n.a.get("/api/text-styles/project/".concat(e))},O=function(t){var e=t.userId,i=t.styles;return n.a.put("/api/text-styles/global/".concat(e),{styles:i})},j=function(t){var e=t.projectId,i=t.styles;return n.a.put("/api/text-styles/project/".concat(e),{styles:i})},P=function(t){var e=t.userId;return n.a.get("/api/link-styles/global/".concat(e))},E=function(t){var e=t.projectId;return n.a.get("/api/link-styles/project/".concat(e))},I=function(t){var e=t.userId,i=t.styles;return n.a.put("/api/link-styles/global/".concat(e),{styles:i})},T=function(t){var e=t.projectId,i=t.styles;return n.a.put("/api/link-styles/project/".concat(e),{styles:i})},M=function(t){var e=t.userId;return n.a.get("/api/list-styles/global/".concat(e))},$=function(t){var e=t.projectId;return n.a.get("/api/list-styles/project/".concat(e))},A=function(t){var e=t.userId,i=t.styles;return n.a.put("/api/list-styles/global/".concat(e),{styles:i})},R=function(t){var e=t.projectId,i=t.styles;return n.a.put("/api/list-styles/project/".concat(e),{styles:i})},D=function(){return n.a.get("/api/user_templates/")},B=function(t){return n.a.delete("/api/template/",{id:t})},L=function(t,e){return n.a.put("/api/template/",{id:t,name:e})},z=function(t){return n.a.get("/api/projects/".concat(t))},F=function(t){return n.a.post("/api/publish/".concat(t))},U=function(t){return n.a.post("/api/mag/".concat(t,"/revert-version"))},N=function(t){return n.a.post("/api/unpublish/".concat(t))},H=function(t,e,i){return n.a.patch("/api/mag/".concat(t,"?skipChanged=").concat(i),e)},V=function(t,e,i){var o={is_private:e.toString()};return i&&(o.pass=i),n.a.post("/api/mag/privacy/".concat(t),o)},W=function(t){return n.a.get("/api/mag/fbcache/".concat(t))},G=function(t,e){return n.a.post("/api/mag/opts/".concat(t),e)},q=function(t,e){return n.a.post("/api/checkdomain",{num_id:t,domain:e})},K=function(t,e){return n.a.post("/api/mag/domain/".concat(t),{domain:e,status:"on"})},Y=function(t){return n.a.post("/api/mag/domain/".concat(t),{status:"off"})},X=function(t,e){return n.a.get("/api/makepdf/".concat(t),e?{pages:e}:void 0)},Z=function(t,e){return n.a.get("/api/mag/".concat(t,"/export"),{origin:e})},J=i("f3SV");function Q(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var tt=function(){var t,e=(t=regeneratorRuntime.mark((function t(e,i){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new FormData).append("widgetId",i),n.append("upload",e.slice(0,Math.min(e.size,J.a.SHOTS_UPLOAD_SIZE_LIMT))),t.next=5,fetch("/api/shots/upload/video",{method:"post",body:n}).then((function(t){return t.json()}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Q(a,n,o,r,s,"next",t)}function s(t){Q(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t,i){return e.apply(this,arguments)}}(),et=function(t,e){return n.a.post("/api/shots/convert/fromurl",{videoUrl:t,widgetId:e})},it=function(t){return n.a.get("/api/user/".concat(t,"/links"))},nt=function(t){return n.a.post("/api/featured/submit",{url:t})};i.d(e,"m",(function(){return a})),i.d(e,"O",(function(){return r})),i.d(e,"x",(function(){return s})),i.d(e,"z",(function(){return l})),i.d(e,"h",(function(){return c})),i.d(e,"L",(function(){return d})),i.d(e,"w",(function(){return h})),i.d(e,"o",(function(){return p})),i.d(e,"E",(function(){return m})),i.d(e,"c",(function(){return g})),i.d(e,"i",(function(){return f})),i.d(e,"u",(function(){return v})),i.d(e,"U",(function(){return b})),i.d(e,"b",(function(){return y})),i.d(e,"g",(function(){return _})),i.d(e,"J",(function(){return w})),i.d(e,"T",(function(){return S})),i.d(e,"t",(function(){return x})),i.d(e,"n",(function(){return C})),i.d(e,"S",(function(){return O})),i.d(e,"P",(function(){return j})),i.d(e,"p",(function(){return P})),i.d(e,"k",(function(){return E})),i.d(e,"Q",(function(){return I})),i.d(e,"M",(function(){return T})),i.d(e,"q",(function(){return M})),i.d(e,"l",(function(){return $})),i.d(e,"R",(function(){return A})),i.d(e,"N",(function(){return R})),i.d(e,"s",(function(){return D})),i.d(e,"d",(function(){return B})),i.d(e,"D",(function(){return L})),i.d(e,"j",(function(){return z})),i.d(e,"y",(function(){return F})),i.d(e,"A",(function(){return U})),i.d(e,"I",(function(){return N})),i.d(e,"B",(function(){return H})),i.d(e,"G",(function(){return V})),i.d(e,"K",(function(){return W})),i.d(e,"C",(function(){return G})),i.d(e,"a",(function(){return q})),i.d(e,"v",(function(){return K})),i.d(e,"H",(function(){return Y})),i.d(e,"f",(function(){return X})),i.d(e,"e",(function(){return Z})),i.d(e,"V",(function(){return tt})),i.d(e,"W",(function(){return et})),i.d(e,"r",(function(){return it})),i.d(e,"F",(function(){return nt}))},LEh1:function(t,e,i){},LSan:function(t,e,i){"use strict";var n=i("9Tqx");i.n(n).a},LZwC:function(t,e,i){t.exports=i.p+"883d226e79ab6a8bfe0352d3fc092da5.png"},LaNJ:function(module,exports){module.exports={"template-picture-preview-box":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n  <div>\n    <div class="picture-preview-box">\n      <div class="picture-preview-box-overlay" style="background-color: '+(null==(__t=overlayColor)?"":__t)+';"></div>\n      <img class="picture-preview-box-image" srcset="'+(null==(__t=previewSrc)?"":__t)+'" style="'+(null==(__t=Object.keys(originalStyle).map((function(t){return t+":"+originalStyle[t]})).join("; "))?"":__t)+'" />\n    </div>\n  </div>\n';return __p}}},LazK:function(t,e,i){"use strict";var n=i("3uGt");i.d(e,"a",(function(){return n.c}))},M7m1:function(t,e,i){"use strict";i.d(e,"c",(function(){return v})),i.d(e,"b",(function(){return y})),i.d(e,"a",(function(){return S}));var n=i("/5Qy"),o=i("a68n"),a=i("IrH7"),r=i("w+s/"),s=i("38uW"),l=i("A9VP"),c=i("ICos"),d=i("uU7u"),h=i("vvfI"),u=i("fueH"),p=i("w5C2");function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function g(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){f(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var v=function(t){var e=window.RM.constructorRouter,i=e.mag,n=e.getCurrentPageNum,o=t.attributes,a=t.target,r=t.classList,s=t.dataset,l=o.getNamedItem("href"),c=l&&l.value?l.value.toLowerCase():"",h=s.anchorLinkPos?parseInt(s.anchorLinkPos):0,p=s.pid,m={id:u.a.generateRandomKey(),linkStyle:r[0],target:"_blank"===a?"_blank":"_self"};if(c.startsWith("mailto:"))m.url=c.replace("mailto:",""),m.type=d.b.Email;else if(c.startsWith("tel:"))m.url=c.replace("tel:",""),m.type=d.b.Phone;else if("__rm_anchor"===c)m.url="".concat(h,"px"),m.pageNum=n()||void 0,m.type=d.b.Anchor,m.anchorPosition=h;else if("back to top"===c)m.url="",m.type=d.b.ScrollToTop;else if("__rm_goback"===c)m.url="",m.type=d.b.GoBack;else if(p||i.getPageId(c)){var g=i.getPageId(c);m.url=""+(p&&i.getPageUri(p)||g||c);var f=p||g;m.pageNum=f&&i.getPageNum(f)||void 0,m.type=d.b.Page}else m.url=c,m.type=d.b.URL;return m},b=function(t){var e=t.computedStyles,i=t.originalStyles;if(!i||!e)return{};var o=e.getPropertyValue("letter-spacing");return!i.letterSpacing||"normal"===i.letterSpacing||o&&"normal"!==o||(o=i.letterSpacing),["fontSize","fontWeight","fontFamily","fontStyle","letterSpacing","textDecorationLine","textTransform","color","textAlign","paddingLeft","paddingTop","paddingRight","paddingBottom","lineHeight"].reduce((function(t,i){var a=Object(n.a)(String(i)),r=e.getPropertyValue(a);return r?g(g({},t),{},f({},i,"letterSpacing"===i?o:r)):t}),{})},y=function(t,e){var i,n={},l=(null==e?void 0:e.ignore)||{};if(!l.textStyles&&(null===(i=t.classList)||void 0===i?void 0:i.length)){var c=Array.from(t.classList).filter((function(t){return t.startsWith("paragraph")}));n[o.i]=c[0]}if(!l.textAlign&&t.style.textAlign){var d=t.style.textAlign;n[a.c]="right"===d?a.a.AlignRight:"center"===d?a.a.AlignCenter:"justify"===d?a.a.AlignJustify:a.a.AlignLeft}if(!l.paddings){var u={};t.style.paddingLeft&&(u.left=parseInt(t.style.paddingLeft)),t.style.paddingTop&&(u.top=parseInt(t.style.paddingTop)),t.style.paddingRight&&(u.right=parseInt(t.style.paddingRight)),t.style.paddingBottom&&(u.bottom=parseInt(t.style.paddingBottom)),n[r.c]=u}return!l.lineHeight&&t.style.lineHeight&&(n[s.c]=parseInt(t.style.lineHeight)),!l.textIndent&&t.style.textIndent&&(n[h.c]=parseInt(t.style.textIndent)),n},_=function(t){var e=[];return t.forEach((function(t,i){Object.keys(t.styles).forEach((function(n){var o,a,r=(o=n,a=t.styles[n],"fontSize"===o?u.a.getStyleValueString(l.a.FontSize,parseInt(a)):"fontStyle"===o?u.a.getStyleValueString(l.a.FontStyle,a):"fontWeight"===o?u.a.getStyleValueString(l.a.FontWeight,a):"fontFamily"===o?u.a.getStyleValueString(l.a.FontFamily,a.replace(/"/g,"")):"letterSpacing"===o&&"normal"!==a?u.a.getStyleValueString(l.a.LetterSpacing,parseFloat(a)):"color"===o?u.a.getStyleValueString(l.a.Color,Object(c.j)(Object(c.i)(a))):"textDecorationLine"===o?u.a.getStyleValueString(l.a.Decoration,a):"textTransform"===o?u.a.getStyleValueString(l.a.Transform,a):void 0);r&&e.push({offset:i,length:1,style:r})}))})),e},w=function(t,e){var i=e.textContent,n=null==i?void 0:i.length;e.textContent="".concat("<%TAG_POINTER%>").concat(i);var o=t.textContent,a=null==o?void 0:o.indexOf("<%TAG_POINTER%>");return e.textContent=i,{offset:a,length:n}},k=function(t){var e=t.charStyleList,i=t.blockKeys,n=t.entityKeys,o={blocks:[],blocksMeta:[],styles:[],entityMap:{}},a=0;return e.forEach((function(t,e){var n=t.paragraph,r=t.charStyle,s=i&&i.length?i[e]:u.a.generateRandomKey(),l=y(n),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e,n=[],o={};return Array.from(t.querySelectorAll("a")).forEach((function(e){if(e.textContent){var a=w(t,e),r=a.offset,s=a.length;"number"==typeof r&&"number"==typeof s&&(n.push({key:i,offset:r,length:s}),o[i]={mutability:"MUTABLE",type:d.f,data:v(e)},i++)}})),{entityRanges:n,entityMap:o,lastKey:i}}(n,a),h=c.entityMap,m=c.entityRanges,f=c.lastKey;a=f;var b={key:s,text:n.textContent||"",depth:0,entityRanges:m},k={key:s,type:p.a.Unstyled,inlineStyles:u.a.minifyStyles(_(r))},S={key:s,data:l};o.blocks.push(b),o.styles.push(k),o.blocksMeta.push(S),o.entityMap=g(g({},o.entityMap),h)})),(null==n?void 0:n.length)&&Object.keys(o.entityMap).forEach((function(t,e){o.entityMap[t].data=g(g({},o.entityMap[t].data),{},{id:n[e]})})),o},S=function(t){var e,i=t.str,n=t.blockKeys,o=t.entityKeys,a=function(t){var e=document.createElement("div");e.classList.add("block","block-text"),e.style.position="absolute",e.style.left="-9999px",e.style.opacity="0",e.style.visibility="hidden";var i=document.createElement("div");return i.classList.add("text-preview","v2"),i.innerHTML=t,e.append(i),document.body.appendChild(e),e}(i);!function(t){Array.from(t.querySelectorAll("br")).forEach((function(t){var e=document.createTextNode("\n");t.replaceWith(e)}))}(a);var r=function(t){var e=[];return Array.from(t.querySelectorAll("p")).forEach((function(t){for(var i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT),n=[],o=null;o=i.nextNode();)for(var a,r=null===(a=o.parentElement)||void 0===a?void 0:a.style,s=o.parentElement?window.getComputedStyle(o.parentElement):void 0,l=b({computedStyles:s,originalStyles:r}),c=o.textContent||"",d=0;d<c.length;d++){var h=c[d];n.push({symbol:h,styles:l})}e.push({charStyle:n,paragraph:t})})),e}(a),s=k({charStyleList:r,blockKeys:n,entityKeys:o});return null===(e=a.parentNode)||void 0===e||e.removeChild(a),s}},M9xF:function(module,exports){module.exports={"template-constructor-block-button":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n    <input class="text"\n           value="'+(null==(__t=data.text)?"":_.escape(__t))+'"\n           type="text"\n           autocapitalize="off"\n           autocorrect="off"\n           autocomplete="off"\n           spellcheck="false"/>\n\n';return __p}}},MAfP:function(module,exports){module.exports={"template-block-frame":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="frameborder">\n\t\t<div class="dot lt" data-ind="0"></div>\n\t\t<div class="dot t" data-ind="1"></div>\n\t\t<div class="dot rt" data-ind="2"></div>\n\t\t<div class="dot r" data-ind="3"></div>\n\t\t<div class="dot rb" data-ind="4"></div>\n\t\t<div class="dot b" data-ind="5"></div>\n\t\t<div class="dot lb" data-ind="6"></div>\n\t\t<div class="dot l" data-ind="7"></div>\n\t\t<div class="triangle lt" data-ind="0">\n\t\t\t<svg width="19px" height="16.23px" xmlns\t="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle t" data-ind="1">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle rt" data-ind="2">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle r" data-ind="3">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle rb" data-ind="4">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle b" data-ind="5">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle lb" data-ind="6">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t\t<div class="triangle l" data-ind="7">\n\t\t\t<svg width="19px" height="16.23px" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m 10.472022,15.361 c -0.5555223,0.949963 -1.3861334,0.954046 -1.9440437,0 L 0.56229989,1.7394072 C 0.00677768,0.78944449 0.48120359,0 1.5877001,0 H 17.4123 c 1.103146,0 1.58331,0.78536087 1.0254,1.7394072 z" id="Triangle" fill="#0080FF"></path>\n\t\t\t</svg>\n\t\t</div>\n\t</div>\n';return __p}}},MgHC:function(module,exports){module.exports={"template-common-login":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="login-popup hidden">\n\n\t\t<div class="login-popup-wrapper">\n\t\t\t<div class="login ljr-panel hidden">\n        <div class="header"><a href="/join/" class="link">Join</a> or <span>Log in</span></div>\n\t\t\t\t<form method="post" action="/api/redirect" id="login_form">\n\t\t\t\t\t<input name="username" autocapitalize="off" autocorrect="off" required="required" class="email-input input-template"  autocomplete="on" type="email" spellcheck="false" value="" placeholder="Email"/>\n\t\t\t\t\t<input name="password" autocapitalize="off" autocorrect="off" required="required" class="password-input input-template" autocomplete="on"  type="password" spellcheck="false" value=""  placeholder="Password" />\n\t\t\t\t\t<input name="url" type="hidden" value="" />\n\t\t\t\t\t<div class="go">Log in</div>\n\t\t\t\t</form>\n        <div class="social-caption">Log in with</div>\n        <div class="social-auth" data-provider=\'facebook\'>\n          <span class="icon"></span>\n          <span class="buttonText">Facebook</span>\n        </div>\n        <div class="social-auth" data-provider=\'google\'>\n          <span class="icon"></span>\n          <span class="buttonText">Google</span>\n        </div>\n\t\t\t\t<a href="/recover/" class="link forgot">Forgot password?</a>\n\t\t\t\t<div class="error">Invalid email or password</div>\n\t\t\t</div>\n\n\n      <div class="join ljr-panel hidden">\n        <div class="header"><span>Join</span> or <a href="/login/" class="link">Log in</a></div>\n        <input autocapitalize="on"  autocorrect="off" required="required" class="fullname-input input-template for-validate"  maxlength="24" type="text"     spellcheck="false" value="" placeholder="Name" />\n        <input autocapitalize="off" autocorrect="off" required="required" class="email-input input-template for-validate"     type="email"    spellcheck="false" value="" placeholder="Email" />\n        <input autocapitalize="off" autocorrect="off" required="required" class="password-input input-template for-validate"  type="password" spellcheck="false" value="" placeholder="Password" />\n\n        <div class="checkbox-container">\n          <label>\n            <input type="checkbox" class="terms-checkbox for-validate" required="required">\n            <span class="checkmark"></span>\n          </label>\n          <p>I accept Readymag’s\n            <a href="https://readymag.com/readymag/terms-and-privacy/" target="_blank">Terms and Privacy Policy</a>\n          </p>\n        </div>\n\n\n        <div class="checkbox-container">\n          <label>\n            <input type="checkbox" class="subscribe-checkbox">\n            <span class="checkmark"></span>\n          </label>\n          <p>Кeep me updated on news and offers</p>\n        </div>\n\n\n        <div class="go">Join</div>\n\n        <div class="social-caption">Sign up with</div>\n        <div class="social-auth" data-provider=\'facebook\'>\n          <span class="icon"></span>\n          <span class="buttonText">Facebook</span>\n        </div>\n        <div class="social-auth" data-provider=\'google\'>\n          <span class="icon"></span>\n          <span class="buttonText">Google</span>\n        </div>\n      <div class="error"></div>\n\n      </div>\n\n        <div class="recover ljr-panel hidden">\n            <div class="header"><span>Reset Password</span></div>\n            <div class="wrapper">\n                <div class="info">Please enter your email address and we\'ll send you instructions:</div>\n                <input name="username" autocapitalize="off" autocorrect="off" required="required" class="email-input input-template"  autocomplete="on" type="email" spellcheck="false" value="" placeholder="Email"/>\n                <div class="go">Submit</div>\n            </div>\n            <div class="send-message">Done! You should receive an email shortly.</div>\n            <div class="go-back">Go Back</div>\n        </div>\n\n        <div class="reset ljr-panel hidden">\n            <div class="header"><span>Reset Password</span></div>\n            <input autocapitalize="off" autocorrect="off" required="required" class="new-password-input input-template"  type="password" spellcheck="false" value="" placeholder="New Password" />\n            <input autocapitalize="off" autocorrect="off" required="required" class="verify-password-input input-template"  type="password" spellcheck="false" value="" placeholder="Verify Password" />\n            <div class="go">Save</div>\n            <div class="error"></div>\n        </div>\n\n            <div class="forbidden ljr-panel hidden">\n                <div class="header"><span>Login forbidden</span></div>\n                <div class="wrapper">\n                    <div class="info">It seems Readymag is displayed as an embedded page on the third party web site. Login is disabled due to security reasons.<br/><br/>Please <a href="https://readymag.com/login" target="_blank">login or join</a> on the original Readymag page.</div>\n                </div>\n            </div>\n\n\n            <div class="close-popup"></div>\n      <a href="/" class="link go-main"></a>\n\t\t</div>\n\t</div>\n\n';return __p},"template-common-login-preloader":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <div class="rmpreloader button">\n        <div class="arc"></div>\n    </div>\n';return __p}}},MseB:function(module,exports){module.exports={"template-constructor-helpers-typekit-popup":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="typekit-popup">\n\t\t<div class="full-house">Full House</div>\n\t\t<div class="error-message">Sadly, but you cannot store more than 5 of Typekit’s fonts in your font selector. Please remove one and try again.</div>\n\n\t\t<div class="corner-wrapper">\n\t\t\t<div class="corner"></div>\n\t\t</div>\n\t</div>\n\n';return __p}}},NEuE:function(module,exports){module.exports={"template-constructor-control-picture_crop":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon preloader" data-alt="Crop" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t\t<div class="scale">\n\t\t\t<div class="handler">\n\t\t\t\t<div class="helper"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="equilateral button"></div>\n\t\t<div class="fill button">Fill</div>\n\t\t<div class="fit button">Fit</div>\n\t</div>\n';return __p}}},NX5H:function(t,e,i){},Nnyp:function(module,exports){module.exports={"template-common-alert":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="\n\t";var categories={"type-duplicate":"category-upgrade","type-create":"category-upgrade","type-export-pdf":"category-upgrade","type-export-code":"category-upgrade","type-more-pages":"category-upgrade","type-upload-fonts":"category-upgrade","type-custom-seo":"category-upgrade","type-custom-sharing":"category-upgrade","type-code-injection":"category-upgrade","type-widget-shots":"category-upgrade","type-publish-noemail":"category-confirm-email","type-publish-limit":"category-upgrade","type-publish-ecommerce":"category-upgrade","type-switch-desktop-create":"category-mobile","type-switch-desktop-continue":"category-mobile","type-browsers":"category-browsers","type-browsers-viewer":"category-browsers","type-shared-failed":"category-shared-failed","type-shared-unlock-page":"category-shared-unlock-page"},headers={"category-upgrade":"","category-upgrade-skip":"Push the Limits","category-browsers":"Browser Support","category-shared-failed":"Sorry, something<br/>went wrong.","category-confirm-email":"Account Activation"},texts={"type-duplicate":'To duplicate this project you need to upgrade your account. You can find out more about our subscription plans <a href="/pricing" class="learn-more">here</a>.',"type-create":'To create more projects you need to upgrade your account. You can find out more about our subscription plans <a href="/pricing" class="learn-more">here</a>.',"type-publish-noemail":"Please verify your email address<br />to publish this project.","type-publish-limit":"Please upgrade your account<br />to publish more than one project.","type-publish-ecommerce":"Please upgrade your account<br />to publish project with ecommerce.","type-export-pdf":'Please upgrade your account<br/>to export the project to PDF.<br/><a href="/pricing" class="learn-more">See the pricing</a>.',"type-export-code":'Please upgrade your account<br/>in order to export the source<br/>code of your projects.<br/><a href="/pricing" class="learn-more">See the pricing</a>.',"type-more-pages":'Please upgrade your account<br/>to create more pages.<br><a href="/pricing" class="learn-more">See the pricing</a>.',"type-custom-seo":'Please upgrade your account<br/> to customize SEO parameters.<br/><a href="/pricing" class="learn-more">See the pricing</a>.',"type-custom-sharing":'Please upgrade your account<br/>to customize social sharing info.<br/><a href="/pricing" class="learn-more">See the pricing</a>.',"type-code-injection":'Please upgrade your account to<br/>make custom code work after<br/>you publish the project.<br/><a href="/pricing" class="learn-more">See the pricing</a>.',"type-widget-shots":'Please upgrade your account to<br/>make Shots widget work after<br/>you publish the project.<br/><a href="/pricing" class="learn-more">See the pricing</a>.',"type-browsers":"Sorry, our Editor doesn’t support Internet Explorer. This may change in the future, but for now please use Chrome, Firefox or Safari.","type-browsers-viewer":'This site can\'t be displayed in Internet Explorer. Please switch to <a href="https://support.apple.com/en-jo/HT204416">Safari</a>, <a href="https://www.google.com/chrome/">Google Chrome</a>, <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a>, or <a href="https://www.microsoft.com/en-us/windows/microsoft-edge">Microsoft Edge</a>.',"type-switch-desktop-create":"To create a project, please use your laptop or desktop computer.","type-switch-desktop-continue":"To continue, please use your laptop or desktop computer.","type-shared-failed":'Please contact <a href="mailto:support@readymag.com" class="learn-more">support</a>.',"type-upload-fonts":'Please upgrade your account<br/>to upload your own fonts.<br/><a href="/pricing" class="learn-more">See the pricing</a>.'},buttons={"category-upgrade":'<a href="/settings#change-plan" class="button main upgrade">Upgrade</a><div class="cancel-wrapper">or '+(["type-code-injection","type-widget-shots"].includes(opts.type)?'<span class="button cancel" data-type="skip">Skip</span>':'<span class="button cancel">Cancel</span>')+"</div>","category-browsers":'<div class="button main ok">Okay</div>',"category-mobile":'<div class="button main ok">Okay</div>',"category-shared-failed":'<div class="button close">Close</div>',"category-shared-unlock-page":'<div class="button ok">Ok</div>',"category-confirm-email":'<div  class="button main resend">Resend</div><div class="cancel-wrapper">or <span class="button cancel">Cancel</span></div>'},category=categories[opts.type],header=headers[category],text=texts[opts.type]||opts.text,button=buttons[category];opts.is_contributor&&(text="Please upgrade owner’s account<br/>to be able to use this feature.",button='<a href="mailto:'+opts.owner_email+'" class="contact-link">Contact owner</a><div class="cancel-wrapper">'+(["type-code-injection","type-widget-shots"].includes(opts.type)?'or <span class="button cancel" data-type="skip">Skip</span>':'<span class="button cancel">Cancel</span>')+"</div>"),__p+='\n\n\t<div class="alert-popup '+(null==(__t=category)?"":__t)+'">\n\t\t<div class="panel-wrapper">\n\t\t\t<div class="center-table">\n\t\t\t\t<div class="center-cell">\n\t\t\t\t\t<div class="panel">\n\n\t\t\t\t\t\t'+(null==(__t=header?'<div class="header">'+header+"</div>":"")?"":__t)+'\n\n\t\t\t\t\t\t<div class="icon" '+(null==(__t=opts.icon?'style="background-image:url('+opts.icon+')"':"")?"":__t)+'><div class="icon-inner"></div></div>\n\n\t\t\t\t\t\t'+(null==(__t=text?'<div class="text">'+text+"</div>":"")?"":__t)+"\n\n\t\t\t\t\t\t"+(null==(__t="type-browsers-viewer"==opts.type?'<div class="icon additional"></div>':"")?"":__t)+"\n\n\t\t\t\t\t\t"+(null==(__t=button?'<div class="buttons">'+button+"</div>":"")?"":__t)+"\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n"}return __p}}},P6JF:function(module,exports){module.exports={"template-constructor-control-text_align":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon" data-alt="Align" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t\t<div class="left" title="Left Align"></div>\n\t\t<div class="center" title="Center"></div>\n\t\t<div class="right" title="Right Align"></div>\n\t\t<div class="justify" title="Justify"></div>\n\t</div>\n';return __p}}},P89F:function(t,e,i){"use strict";var n=i("TP6R");i.n(n).a},PhV8:function(t,e,i){"use strict";function n(t){return new n.fn.init(t)}var o={},a={};Array.prototype.slice;function r(t,e,i){if(!i.contentWindow.postMessage)return!1;var n=JSON.stringify({method:t,value:e});i.contentWindow.postMessage(n,"*")}function s(t){var e,i;try{i=(e=JSON.parse(t.data)).event||e.method}catch(t){}if(!/^https?:\/\/player.vimeo.com/.test(t.origin))return!1;var n=e.value,r=e.data,s=""===s?null:e.player_id,l=function(t,e){return e?o[e]&&o[e][t]:o[t]}(i,s),c=[];return"ready"!==i||a[s]||(a[s]=!0),!!l&&(void 0!==n&&c.push(n),r&&c.push(r),s&&c.push(s),c.length>0?l.apply(null,c):l.call())}function l(t,e,i){i?(o[i]||(o[i]={}),o[i][t]=e):o[t]=e}function c(t){return!!(t&&t.constructor&&t.call&&t.apply)}n.fn=n.prototype={element:null,init:function(t){return"string"==typeof t&&(t=document.getElementById(t)),this.element=t,this.element?this:null},api:function(t,e){if(!this.element||!t)return!1;var i=this.element,n=""!==i.id?i.id:null,o=c(e)?null:e,a=c(e)?e:null;return a&&l(t,a,n),r(t,o,i),this},addEvent:function(t,e){if(!this.element)return!1;var i=this.element,n=""!==i.id?i.id:null;return l(t,e,n),"ready"!=t?r("addEventListener",t,i):"ready"==t&&a[n]&&e.call(null,n),this},removeEvent:function(t){if(!this.element)return!1;var e=this.element,i=function(t,e){if(e&&o[e]){if(!o[e][t])return!1;o[e][t]=null}else{if(!o[t])return!1;o[t]=null}return!0}(t,""!==e.id?e.id:null);"ready"!=t&&i&&r("removeEventListener",t,e)}},n.fn.init.prototype=n.fn,window.addEventListener?window.addEventListener("message",s,!1):window.attachEvent("onmessage",s),e.a=n},"Q/Wd":function(t,e,i){"use strict";var n=i("c/7M");i.n(n).a},Q6xy:function(t,e,i){},QNie:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i("q1tI"),o=i.n(n),a=i("q1z7"),r=i.n(a),s=i("xi34"),l=i("i8i4"),c=i.n(l),d=i("5BZr"),h=i("8AXF"),u=o.a.createContext({}),p=d.a.extend({name:null,component:null,alt:null,saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d.a.prototype.initialize.apply(this,arguments),this.block=this.blocks[0],this.model=t.models&&t.models.length&&t.models[0],this.workspace=t.master&&t.master.workspace||{},this.page=this.workspace.page,this.project=this.workspace.mag,this.user=this.project.user,this.y=t.y||t.fromY,this.propsModel=new r.a.Model({block:this.block,faded:this.faded||!1,selected:this.selected||!1,disabled:this.disabled||!1,visible:this.visible||!1,y:this.y,alt:this.alt,select:this.setSelected,deselect:this.deselect,removeFade:this.removeFade,appearanceAnimation:this.appearanceAnimation,page:this.page,project:this.project,user:this.user,injectedRefs:{},workspace:this.workspace,controlsManager:this.workspace.controls,useSharedState:this.block.useSharedState,doesUserHaveAccess:this.project.get("doesUserHaveAccess")}),this.propsModel.on("change",this.onPropsModelChanged)},render:function(){var t=this,e=document.querySelector('[data-control-type="'.concat(this.name,'"]'));e&&(c.a.unmountComponentAtNode(e)&&e.remove());if(this.$container.append('<div data-control-type="'.concat(this.name,'">')),this.domElement=document.querySelector('[data-control-type="'.concat(this.name,'"]')),this.domElement){Object(h.renderReact)({component:function(){return o.a.createElement(h.CreateContextProvider,{context:u,model:t.propsModel},o.a.createElement(t.component,{useSharedState:t.block.useSharedState}))},domElement:this.domElement,model:this.model}),setTimeout((function(){t.show(),t.$el=Object(s.a)(t.domElement).find(":first")})),this.setControlsStatusByBlockData(),this.block.on("disabledControls:changed",this.onDisabledControlsChanged.bind(this)),this.bindLogic(),document.addEventListener("keyup",this.onWindowKeyUp)}},updatePropsModel:function(t){this.propsModel&&this.propsModel.set(t)},destroy:function(t){t?this.hide():this.destroyReact(),this.block.off("disabledControls:changed",this.onDisabledControlsChanged),this.unBindLogic(),this.stopListening(this.model,"change"),document.removeEventListener("keyup",this.onWindowKeyUp),this.destroyed=!0},destroyReact:function(){var t=this.$el.parent();t&&t[0]&&(c.a.unmountComponentAtNode(t[0])&&t.remove())},hide:function(){this.updatePropsModel({visible:!1})},show:function(){this.updatePropsModel({visible:!0})},moveToNewPos:function(t){this.y=t,this.domElement&&this.updatePropsModel({y:t})},bindShortcuts:function(){this.shortcutHandler=this.master.select.bind(this.master,this),this.keyboardShortcut&&window.RM.constructorRouter.bindGlobalKeyPress([{key:this.keyboardShortcut,handler:this.shortcutHandler}]),this.onWindowKeyUpBound=this.onWindowKeyUp.bind(this),Object(s.a)(window).on("keyup",this.onWindowKeyUpBound)},unbindShortcuts:function(){this.keyboardShortcut&&window.RM.constructorRouter.unbindGlobalKeyPress(this.keyboardShortcut,this.shortcutHandler),Object(s.a)(window).off("keyup",this.onWindowKeyUpBound)},select:function(){this.makeModelSnapshot(),this.updatePropsModel({selected:!0,faded:!1})},setSelected:function(){this.isOnClickDisabled()||(this.selected||this.disabled?this.master.deselect():this.master.select(this))},deselect:function(){var t=!!this.selected;this.updatePropsModel({selected:!1,faded:!1}),this.clearModelSnapshot(t)},fade:function(){this.deselect(),this.updatePropsModel({faded:!0})},removeFade:function(){this.updatePropsModel({faded:!1})},setEnabled:function(){this.updatePropsModel({disabled:!1})},setDisabled:function(){this.updatePropsModel({selected:!1,disabled:!0})},save:function(){this.model.save({})},canControlBeClosed:function(){if(this.propsModel&&this.propsModel.get("preventClose"))return!0;if(this.selected){var t=this.propsModel.get("injectedRefs");return t.canControlBeClosed&&t.canControlBeClosed()||this.master.deselect(),!0}return!1},onEscKey:function(){this.selected&&this.master.deselect()},onPropsModelChanged:function(){this.selected=this.propsModel.get("selected"),this.disabled=this.propsModel.get("disabled"),this.faded=this.propsModel.get("faded"),this.visible=this.propsModel.get("visible")}});e.b=p},"QP/g":function(module,exports){module.exports={"template-constructor-control-cart_add_product_widget":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Add product widget" data-alt-pos="left" data-alt-offset="9"></div>\n';return __p}}},QRzc:function(module,exports){module.exports={"template-viewer-mag-menu":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<noindex>\n\t\t<div class="mag-menu '+(null==(__t=hasProjectInfo?"":"no-project-info")?"":__t)+'" data-nosnippet>\n\t\t\t<div class="menu-wrapper">\n\n\t\t\t\t',hasProjectInfo&&(__p+='\n\t\t\t\t\t<div class="menu-info">\n\n\t\t\t\t\t\t<a class="link '+(null==(__t=common.isDownloadedSource?"inactive-link":"")?"":__t)+'" href="'+(null==(__t=mag.model.user.getLink())?"":_.escape(__t))+'">\n\t\t\t\t\t\t\t<div class="userpic" style="background-image:url(\''+(null==(__t=mag.model.user.getUserpic(64))?"":__t)+'\')"></div>\n\t\t\t\t\t\t\t<div class="username">'+(null==(__t=mag.user.name)?"":_.escape(__t))+'</div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<div class="published-by" data_caption="published by" data_date="'+(null==(__t=publishDate)?"":__t)+'"></div>\n\t\t\t\t\t\t<div class="mag-title">'+(null==(__t=mag.title)?"":_.escape(__t))+"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"),__p+='\n\n\t\t\t\t<div class="scroll-wrapper">\n\n\t\t\t\t\t<div class="pages-wrapper has-'+(null==(__t=viewerType)?"":__t)+'-scroll">\n\t\t\t\t\t\t<div class="pages">\n\n\t\t\t\t\t\t\t',_.each(pages,(function(t,e){var i="horizontal"==viewerType?"left":"top",n=e*("horizontal"==viewerType?width:height);__p+='\n\t\t\t\t\t\t\t\t<div class="page" data-id="'+(null==(__t=t._id)?"":__t)+'" data-num="'+(null==(__t=t.num)?"":__t)+'" data-src="'+(null==(__t=mag.model.getPageScreenshot(width,{_id:t._id}))?"":__t)+'" style="width:'+(null==(__t=width)?"":__t)+"px;height:"+(null==(__t=height)?"":__t)+"px;"+(null==(__t=i)?"":__t)+":"+(null==(__t=n)?"":__t)+'px">\n\t\t\t\t\t\t\t\t\t<img class="screenshot" src="'+(null==(__t=stub)?"":__t)+'" />\n\t\t\t\t\t\t\t\t\t<div class="num '+(null==(__t=t.pageNestedNum&&t.pageNestedNum.length>3?t.pageNestedNum.length>4?"nested-over-4":"nested-over-3":t.num>99?"over99":"")?"":__t)+'">'+(null==(__t=t.pageNestedNum?t.pageNestedNum:t.num)?"":__t)+"</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t"})),__p+='\n\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</noindex>\n';return __p}}},R31J:function(module,exports){module.exports={"template-pack":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="pack" id="pack_'+(null==(__t=id)?"":__t)+'">\n\t\t<div class="content"></div>\n\t\t'+(null==(__t=templates["template-block-frame"]())?"":__t)+"\n\t</div>\n";return __p}}},RLXn:function(t,e,i){"use strict";var n=i("rFsW"),o={i1:{caption:"Thin Italic",style:{fontWeight:100,fontStyle:"italic"}},i3:{caption:"Light Italic",style:{fontWeight:300,fontStyle:"italic"}},i4:{caption:"Italic",style:{fontWeight:400,fontStyle:"italic"}},i5:{caption:"Medium Italic",style:{fontWeight:500,fontStyle:"italic"}},i7:{caption:"Bold Italic",style:{fontWeight:700,fontStyle:"italic"}},i9:{caption:"Black Italic",style:{fontWeight:900,fontStyle:"italic"}},n1:{caption:"Thin",style:{fontWeight:100,fontStyle:"normal"}},n3:{caption:"Light",style:{fontWeight:300,fontStyle:"normal"}},n4:{caption:"Regular",style:{fontWeight:400,fontStyle:"normal"}},n5:{caption:"Medium",style:{fontWeight:500,fontStyle:"normal"}},n7:{caption:"Bold",style:{fontWeight:700,fontStyle:"normal"}},n9:{caption:"Black",style:{fontWeight:900,fontStyle:"normal"}}},a={model:{event:"change"},props:{fontStyle:{type:Array,default:function(){return[""]}},fontFamily:{type:Array,default:function(){return[""]}},fontWeight:{type:Array,default:function(){return[0]}},vAlign:{type:String,default:"auto"}},data:function(){return{visibleBox:!1,boxStyles:{},styleVariants:{}}},computed:{exStyle:function(){return{"font-style":this.getParamForMultipleStyles(this.fontStyle),"font-weight":this.getParamForMultipleStyles(this.fontWeight)}},fromTop:function(){return"auto"!==this.vAlign&&n.a.keys(this.styleVariants).length>5},disabled:function(){return 0===n.a.keys(this.styleVariants).length},caption:function(){var t=this,e="";return this.keys.forEach((function(i,n){o[i]&&(e+=o[i].caption,n+1<t.keys.length&&(e+=", "))})),e},keys:function(){for(var t=[],e=0;e<this.fontStyle.length;e++){var i=("italic"===this.fontStyle[e]?"i":"n")+(""+this.fontWeight[e])[0];this.styleVariants[i]||1!==this.fontFamily.length||(i=this.styleVariants.n4?"n4":n.a.keys(this.styleVariants)[0],this.$emit("update:fontStyle","i"===i[0]?"italic":"normal"),this.$emit("update:fontWeight",100*parseInt(i[1],10))),t.push(i)}return t}},watch:{disabled:{handler:function(t){t&&this.visibleBox&&(this.visibleBox=!1)},immediate:!0},fontFamily:{handler:function(t){var e=this,i=t.map((function(t){return RM.constructorRouter.fonts.findFontByCSSName(t)})),o=[],a={i:"italic",n:"normal"};i.forEach((function(t){var i={};t.variations.forEach((function(t){i[t]={caption:e.generateName(t),style:{fontWeight:100*parseInt(t[1],10),fontStyle:a[t[0]]}}})),o.push(i)})),1===o.length?this.styleVariants=n.a.clone(o[0]):o.length>1&&function(){for(var t=n.a.clone(o[0]),i=function(e){var i=o[e];Object.keys(t).forEach((function(e){i[e]||delete t[e]}))},a=1;a<o.length;a++)i(a);e.styleVariants=t}()},immediate:!0}},mounted:function(){if(this.boxStyles["max-height"]="".concat(window.innerHeight,"px"),"auto"===this.vAlign){var t="top",e="bottom";this.$el.getBoundingClientRect().top>window.innerHeight/2&&(t="bottom",e="top"),this.boxStyles[t]="27px",this.boxStyles[e]="auto"}},methods:{generateName:function(t){var e="i"===t[0],i={1:"Thin",2:"ExtraLight",3:"Light",4:"Regular",5:"Medium",6:"SemiBold",7:"Bold",8:"ExtraBold",9:"Black"}[t[1]];return e&&"Regular"===i?"Italic":i+(e?" Italic":"")},getParamForMultipleStyles:function(t){return 1===t.length||n.a.every(t,(function(e){return e===t[0]}))?t[0]:"inherit"},selectFont:function(t){this.$emit("update:fontStyle",t.style.fontStyle),this.$emit("update:fontWeight",t.style.fontWeight)},toggleVisible:function(){this.disabled||(this.visibleBox||this.$emit("showPopup",this),this.visibleBox=!this.visibleBox)}}},r=(i("3dGj"),i("KHd+")),s=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"font-style-container"},[i("span",{staticClass:"example",class:{disabled:t.disabled},style:t.exStyle,on:{click:t.toggleVisible}},[t._v(t._s(t.caption))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.disabled,expression:"!disabled"}],staticClass:"expand-arrow",on:{click:t.toggleVisible}}),t._v(" "),i("div",{staticClass:"box_container",class:{visible:t.visibleBox,"from-top":t.fromTop},style:t.boxStyles},t._l(t.styleVariants,(function(e,n){return i("div",{key:n,staticClass:"font-elem",class:t.keys.includes(n)?"curr":"",style:e.style,on:{click:function(i){return t.selectFont(e,n)}}},[t._v("\n      "+t._s(e.caption)+"\n      "),i("div",{staticClass:"point"})])})),0)])}),[],!1,null,null,null);e.a=s.exports},RLiD:function(t,e,i){"use strict";var n=i("WpaW");i.n(n).a},RX7I:function(t,e,i){"use strict";i("9GTV");var n=window.soundcite;delete window.soundcite,e.a=n},Ragx:function(t,e,i){"use strict";i("Da6b");var n=i("KHd+"),o=Object(n.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 40 40"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20 8C13.3726 8 8 13.3726 8 20C8 26.6274 13.3726 32 20 32C26.6274 32 32 26.6274 32 20C32 13.3726 26.6274 8 20 8ZM24.1142 19.2407C24.5798 19.6398 24.5798 20.3601 24.1142 20.7592L19.6508 24.585C19.0021 25.141 18 24.6801 18 23.8257V16.1742C18 15.3198 19.0021 14.8589 19.6508 15.4149L24.1142 19.2407Z"}})])}),[],!1,null,"c3d3b7fc",null);e.a=o.exports},RedZ:function(module,exports){module.exports={"template-constructor-control-picture_preview":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Lightbox" data-alt-pos="left" data-alt-offset="9">\n    <div class="left-icon">\n      <img class="svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/constructor/controls/picture_preview/icon.svg" />\n    </div>\n    <div class="right-icon">\n      <div class="arrow"></div>\n    </div>\n  </div>\n\n\t<div class="panel">\n    <div class="panel-caption">Lightbox</div>\n\n\t\t<div class="animation-error">\n\t\t\t<div class="message-text">Oops, you can’t enable Lightbox, as this image already has an On-Click animation</div>\n    </div>\n\n    <div class="link-error">\n\t\t\t<div class="message-text">Oops, you can’t enable Lightbox to this image since link added</div>\n    </div>\n\n    <div class="fullscreen-controls">\n      <div class="icon-panel icon-overlay noarrow" data-alt-pos="left" data-alt-offset="9">\n        <div class="colorbox_container"></div>\n      </div>\n      <div class="icon-panel icon-preview-toggle noarrow" data-alt-pos="left" data-alt-offset="43">\n        <img class="svg" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/constructor/controls/picture_preview/icon.svg" />\n      </div>\n    </div>\n\t</div>\n\n';return __p}}},Rh5U:function(module,exports){module.exports={"template-viewer-mag":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="mag">\n\t\t<div class="mag-pages-container">\n\t\t\t<div class="container disable-transitions">\n\n\t\t\t\t<div class="blackout"></div>\n\t\t\t</div>\n\t\t\t<div class="above-pages-container"></div>\n\t\t</div>\n\n\t\t',hasStandaloneBottomArrow&&(__p+='\n\t\t\t<div class="navigation-arrow bottom offscreen"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+"')\"></div></div>\n\t\t"),__p+="\n\n\n\t\t",isPreview&&(__p+='\n\t\t\t<div class="mag-pages-viewport-device"></div>\n\t\t'),__p+="\n\t</div>\n\n";return __p}}},Rn2B:function(module,exports){module.exports={"template-constructor-control-hotspot-pin-settings":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="icon noarrow" data-alt="Pin Settings" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\n\t\t<div class="search-block">\n\n\t\t\t<input class="search" type="text" placeholder="Search">\n\n\n\t\t\t<div class="loupe">\n\t\t\t\t<div class="rmpreloader hidden"><div class="arc"></div></div>\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t\t<div class="common-wrapper">\n\n\n\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t<div class="resizable-content">\n\n\t\t\t\t\t\t<div class="rectangle-icon item">\n\t\t\t\t\t\t\t<div class="line"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="circle-icon item">\n\t\t\t\t\t\t\t<div class="circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t</div>\n\n\n\t\t\t<div class="params-wrapper clearfix">\n\n\t\t\t\t<div class="edit-item color-click-area" data-field="bg_color" data-field-dop="bg_opacity">\n\t\t\t\t\t<div class="caption">Color</div>\n\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="edit-item combined separator" data-field="borders">\n\t\t\t\t\t<div class="caption">Border</div>\n\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\n\t\t\t\t\t<div class="edit-item border-color color-click-area" data-field="color" data-field-dop="opacity">\n\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="edit-item separator" data-field="tip_show_on">\n\t\t\t\t\t<div class="caption">Show on</div>\n\t\t\t\t\t<div class="switcher" data-active="click">\n\t\t\t\t\t\t<div class="switcher-item" data-value="click">Click</div>\n\t\t\t\t\t\t<div class="switcher-item" data-value="hover">Hover</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\n\t\t</div>\n\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\n\t\t<div class="colorbox_container"></div>\n\n\t</div>\n';return __p},"template-constructor-control-hotspot-pin-settings-icon-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon-item item">\n\t\t<div class="noun-icon" style="background-image: url('+(null==(__t=icon.preview_url_42)?"":__t)+');" '+(null==(__t=icon.id?'data-id="'+icon.id+'"':'data-rm_id="'+icon.rm_id+'"')?"":__t)+' data-url="'+(null==(__t=icon.icon_url)?"":__t)+'">\n\t</div>\n';return __p}}},RnhZ:function(t,e,i){var n={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function o(t){var e=a(t);return i(e)}function a(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=a,t.exports=o,o.id="RnhZ"},SH8X:function(t,e,i){"use strict";var n=i("rsO6");i.n(n).a},SUqF:function(t,e,i){"use strict";var n,o,a,r=i("roQd"),s={enterPickTriggerMode:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=arguments.length>3?arguments[3]:void 0;a=function(n,o){if(s.canBeATrigger(n,e,i)){o.stopPropagation();var a=n.id;s.highlightActiveTriggerBlock(t,e,a,!1,!1),l(a)}},n=function(n){var o=t.findBlock(n);s.canBeATrigger(o,e,i)&&o&&o.highlight(!0,r.a.ACTIVE_TRIGGER_HIGHLIGHT_CLASS)},o=function(e){var i=t.findBlock(e);i&&i.highlight(!1,r.a.ACTIVE_TRIGGER_HIGHLIGHT_CLASS)},t.on("block:click",a),t.on("block:mouseenter",n),t.on("block:mouseleave",o)},leavePickTriggerMode:function(t){t.off("block:click",a),t.off("block:mouseenter",n),t.off("block:mouseleave",o)},canBeATrigger:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return!r.a.EXTERNAL_TRIGGER_BLOCK_EXCLUDE.includes(t.model.attributes.type)&&!i.includes(t.id)&&s.canBeExternalTrigger(t,e)},canBeExternalTrigger:function(t,e){var i=t.attributes||t.model.attributes||{},n=e.attributes||e.model.attributes||{},o=i.type&&-1===r.a.EXTERNAL_TRIGGER_BLOCK_EXCLUDE.indexOf(i.type),a=e&&n.is_above&&i.is_global&&!i.is_above;return o&&!a},highlightActiveTriggerBlock:function(t,e,i,n,o){var a=i&&t.findBlock(i),s=e.id===i&&1===t.getPackBlocks(e.model.get("pack_id")).length,l=o?r.a.ACTIVE_TRIGGER_REMOVE_CLASS:r.a.ACTIVE_TRIGGER_HIGHLIGHT_CLASS;a&&a.highlight(n,l);var c=e.triggerAssets&&e.triggerAssets[i];if(c){var d=s?e.ownTooltip&&e.ownTooltip.getElement():c.tooltip&&c.tooltip.getElement();d&&d.toggleClass(l,Boolean(n))}}};e.a=s},TAzU:function(t,e,i){},TBxE:function(t,e,i){"use strict";var n=i("xi34"),o=i("Kw5r"),a=i("rFsW"),r=i("q1z7"),s=i.n(r),l=i("f3SV"),c=i("q7tt"),d=new RegExp("^image/("+l.a.UPLOAD_IMAGE_FORMATS+")$","i"),h=new RegExp("([a-z-_0-9/:.]*.("+l.a.UPLOAD_IMAGE_FORMATS+")(\\W.*)?$)","i"),u=s.a.View.extend({DEFAULT_ERROR_MSG:"Something went wrong!",constructor:function(t){return t instanceof c.a?this.block=t:t instanceof o.default&&(this.block=t.raw_block||t.block,this.panel=t),this.initialize.apply(this,arguments),this},initialize:function(t,e){a.a.bindAll(this);var i=this.block;(e=e||{}).fileTypes&&(this.fileTypes=new RegExp("^image/("+e.fileTypes+")$","i"),this.fileTypesErrorMessage=e.fileTypesErrorMessage,delete e.fileTypes,delete e.fileTypesErrorMessage),e=a.a.defaults(e,a.a.extend({dataType:"json",singleFileUploads:!0,sequentialUploads:!0,formData:{id:i.model.id,mid:i.workspace.mag.get("num_id"),name:i.name,uploadType:"picture",unique:e.unique},dropZone:Object(n.a)(),pasteZone:null,replaceFileInput:!1},this.panel?{dropZone:Object(n.a)(this.panel.$el),fileInput:Object(n.a)(e.uploadInputRefName?this.panel.$refs[e.uploadInputRefName]:this.panel.$refs.uploadInput)}:{})),this.options=e,this.debug&&console.log(e),this.$uploader=Object(n.a)(e.fileInput).fileupload(e),this.bindHandlers(),this.uploadingData=[]},bindHandlers:function(){var t=this;this.preventDefaultOnDrop(),this.$uploader.bind("fileuploadadd",(function(e,i){if(t.debug&&console.log("add",i),t.uploadData=i,!i||!i.files||!i.files[0]||i.files[0].skipped)return!1;var n=i.files&&i.files[0].size,o=i.files&&i.files[0].type;n>l.a.UPLOAD_IMAGE_SIZE_LIMIT?(i.allowUpload=!1,alert(i.files[0].uploadError=l.a.MSG_UPLOAD_IMAGE_SIZE_ERROR)):(t.fileTypes||d).test(o)?i.allowUpload=!0:(i.allowUpload=!1,alert(i.files[0].uploadError=t.fileTypesErrorMessage||l.a.MSG_UPLOAD_IMAGE_SUPPORTED_ERROR)),t.trigger("add",e,i),t.uploadingData.push(i),i.submit()})).bind("fileuploaddrop",(function(e,i){t.debug&&console.log("drop",i),t.trigger("drop",e);var o=(e.originalEvent.dataTransfer||e.delegatedEvent.dataTransfer).getData("text/html");if(o){var a=Object(n.a)(o).filter("img").attr("src");if(a)return h.test(a)?void t.trigger("uploadFromUrl",a):(alert(i.uploadError=l.a.MSG_UPLOAD_IMAGE_SUPPORTED_ERROR),i.allowUpload=!1,t.clearFileInputField(),!1)}})).bind("fileuploadsubmit",(function(e,i){if(t.debug&&console.log("submit",i),!i.allowUpload){var n=i.uploadError||i.files&&i.files[0]&&i.files[0].uploadError;return n&&(delete i.uploadError,i.files&&delete i.files[0].uploadError,t.trigger("fail",e,i,n),t.clearFileInputField()),!1}i.allowUpload=!1})).bind("fileuploadsend",(function(e,i){if(t.debug&&console.log("send",i),i.files[0].skipped)return!1;t.trigger("send",e,i)})).bind("fileuploadstart",(function(e,i){t.debug&&console.log("start",i),t.uploading=!0,t.trigger("start",e,i)})).bind("fileuploaddone",(function(e,i){t.debug&&console.log("done",i),t.uploadingData.shift(),t.uploading=!1,t.clearFileInputField(),i.files[0].skipped||t.trigger("done",e,i)})).bind("fileuploaddragover",(function(e){t.trigger("dragover",e)})).bind("fileuploaddragleave",(function(e){t.trigger("dragleave",e)})).bind("fileuploadfail",(function(e,i){t.debug&&console.log("fail",i),t.uploadingData.shift(),t.uploading=!1,t.clearFileInputField();var n=t.DEFAULT_ERROR_MSG;500==(i&&i.jqXHR&&i.jqXHR.status)&&a.a.delay((function(){alert(n=l.a.MSG_UPLOAD_IMAGE_SUPPORTED_ERROR)}),300),i.files&&!i.files[0].skipped&&"abort"!=i.errorThrown&&t.trigger("fail",e,i,n)}))},setOptions:function(t){this.options=a.a.extend(this.options,t),this.$uploader.fileupload(this.options)},setFormData:function(t,e,i){if(!t||!e||!i)return console.error("missing required parameters");this.$uploader.fileupload({formData:{id:t,name:e,uploadType:i}})},clearFileInputField:function(){this.$uploader.wrap("<form>").closest("form").get(0).reset(),this.$uploader.unwrap()},switchOff:function(){this.options.dropZone.off("drop dragover",this.prevent),this.$uploader.fileupload("disable")},switchOn:function(){this.preventDefaultOnDrop(),this.$uploader.fileupload("enable")},preventDefaultOnDrop:function(){this.options.dropZone.on("drop dragover",this.prevent)},prevent:function(t){t.preventDefault()},abort:function(){this.uploadingData[0]&&this.uploadingData[0].abort(),a.a.each(this.uploadingData,(function(t){t.files[0].skipped=!0}))},destroy:function(){this.abort(),this.switchOff(),this.off(),this.$uploader.fileupload("destroy")}});u.MimeTypeRegExp=d,u.UrlImageTypeRegExp=h,e.a=u},TGSb:function(module,exports){module.exports={"template-constructor-control-common_lock":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Lock" data-alt-pos="left" data-alt-offset="9"></div>\n';return __p}}},TP6R:function(t,e,i){},Tjx0:function(t,e,i){"use strict";var n=i("4nGE");i.n(n).a},Tu3F:function(module,exports){module.exports={"template-viewer-toolbar":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+='\n\n\t<div class="toolbar for-viewer">\n\n\t\t';var offscreenClass=isPreview||common.embedMode?"":"offscreen-initially";__p+="\n\n\t\t",hasPageCounter&&!pageCounterInsideMenu&&(__p+='\n\t\t\t<div class="page-counter-wrapper '+(null==(__t=offscreenClass)?"":__t)+'">\n\t\t\t\t<div class="page-counter"><span class="cur"></span> of <span class="total">'+(null==(__t=totalPages)?"":__t)+"</span></div>\n\t\t\t</div>\n\t\t"),__p+="\n\n\t\t",brandingInToolbar&&(__p+='\n\t\t\t<div class="toolbar-branding"></div>\n\t\t'),__p+="\n\n\t\t",hasShare&&(__p+='\n\t\t\t<div class="share-button sprite '+(null==(__t=offscreenClass)?"":__t)+'" data-alt="Share" data-alt-pos="'+(null==(__t=controlsOnTop?"bottom":"top")?"":__t)+'" data-alt-offset="9"  data-alt-style="toolbar-share-tooltip" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+"')\"></div>\n\t\t"),__p+="\n\n\t\t",hasMenu&&(__p+='\n\t\t\t<div class="menu-button '+(null==(__t=offscreenClass)?"":__t)+'" data-alt="Menu (M)" data-alt-pos="'+(null==(__t=controlsOnTop?"bottom":"top")?"":__t)+'" data-alt-offset="9" data-alt-style="toolbar-menu-tooltip">\n\t\t\t\t',hasPageCounter&&pageCounterInsideMenu&&(__p+='\n\t\t\t\t\t<div class="page-counter"><span class="cur"></span> of <span class="total">'+(null==(__t=totalPages)?"":__t)+"</span></div>\n\t\t\t\t"),__p+='\n\n\t\t\t\t<svg class="menu-icon" width="32" height="14" viewBox="0 0 32 14">\n\t\t\t\t\t<g fill="currentColor" fill-rule="evenodd"><path d="M1 0h30a1 1 0 010 2H1a1 1 0 110-2zM1 12h30a1 1 0 010 2H1a1 1 0 010-2z"/></g>\n\t\t\t\t</svg>\n\t\t\t\t<svg class="cross-icon" width="18" height="18" viewBox="0 0 18 18">\n\t\t\t\t\t<path d="M17.485.515a1 1 0 010 1.414L10.415 9l7.07 7.071a1 1 0 01-1.414 1.414L9 10.415l-7.071 7.07a1 1 0 01-1.414-1.414L7.585 9 .516 1.929A1 1 0 011.929.515L9 7.585l7.071-7.07a1 1 0 011.414 0z" fill="currentColor" fill-rule="evenodd"></path>\n\t\t\t\t</svg>\n\t\t\t\t<div class="page-preloader sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+"')\"></div>\n\t\t\t</div>\n\t\t"),__p+="\n\n\t\t",common.embedMode&&(__p+='\n\t\t\t<div class="embed-close-button '+(null==(__t=offscreenClass)?"":__t)+'">Close</div>\n\t\t'),__p+="\n\n\t</div>\n\n"}return __p}}},TxgR:function(t,e,i){},U72E:function(module,exports){module.exports={"template-constructor-workspace-inside-block":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="workspace-inside-block">\n\t\t<div class="blocks-wrapper"></div>\n\t</div>\n\n';return __p}}},UeZx:function(module,exports){module.exports={"template-constructor-block":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="block '+(null==(__t=block.hidden?"invisible":"")?"":__t)+'" data-id="'+(null==(__t=block._id)?"":__t)+'">\n\t\t<div class="content"></div>\n\t\t'+(null==(__t=templates["template-block-frame"]())?"":__t)+"\n\t</div>\n";return __p}}},UyQn:function(t,e,i){"use strict";var n=i("bXDN");i.n(n).a},VZqm:function(t,e,i){"use strict";var n=i("xi34"),o=i("rFsW"),a={model:{event:"change"},props:{value:"",variants:{type:Array,default:function(){return[]}},hideControls:{type:Boolean,default:!1}},methods:{spinType:function(t){var e=this,i=0;o.a.each(this.variants,(function(t,n){t.value===e.value&&(i=n)})),i=(i+=t)<0?i+this.variants.length:i%this.variants.length,Object(n.a)(this.$el).toggleClass("negative",t<0),this.$emit("change",this.variants[i].value)}}},r=(i("mX/r"),i("KHd+")),s=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spinner"},[i("transition",{attrs:{name:"fade"}},[t._l(t.variants,(function(e,n){return[e.value===t.value?i("div",{key:n,staticClass:"spin-title",class:{clickable:t.hideControls},on:{click:function(e){return e.stopPropagation(),t.spinType(1)}}},[t._v("\n        "+t._s(e.title)+"\n      ")]):t._e()]}))],2),t._v(" "),t.hideControls?t._e():i("div",{staticClass:"spin left",on:{click:function(e){return e.stopPropagation(),t.spinType(-1)}}}),t._v(" "),t.hideControls?t._e():i("div",{staticClass:"spin right",on:{click:function(e){return e.stopPropagation(),t.spinType(1)}}})],1)}),[],!1,null,null,null);e.a=s.exports},Vc8N:function(module,exports){module.exports={"template-constructor-block-twitter-type_tweet":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<a href="https://twitter.com/share" class="twitter-share-button" data-url="'+(null==(__t=url)?"":_.escape(__t))+'" data-lang="en" data-size="'+(null==(__t=large_button?"large":"medium")?"":__t)+'" data-text="'+(null==(__t="undefined"!=typeof text?text:"")?"":_.escape(__t))+'">Tweet</a>\n\t<div class="overlay"></div>\n';return __p},"template-constructor-block-twitter-type_follow":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<a href="https://twitter.com/'+(null==(__t=username||"Readymag")?"":_.escape(__t))+'" class="twitter-follow-button" data-show-count="false" data-show-screen-name="'+(null==(__t=show_name?"true":"false")?"":__t)+'" data-lang="en" data-size="'+(null==(__t=large_button?"large":"medium")?"":__t)+'">Follow @'+(null==(__t=username)?"":_.escape(__t))+'</a>\n\t<div class="overlay"></div>\n';return __p},"template-constructor-block-twitter-type_hashtag":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<a href="https://twitter.com/intent/tweet?button_hashtag='+(null==(__t=hash)?"":_.escape(__t))+'" class="twitter-hashtag-button" data-size="'+(null==(__t=large_button?"large":"medium")?"":__t)+'">Tweet #'+(null==(__t=hash)?"":_.escape(__t))+'</a>\n\t<div class="overlay"></div>\n';return __p},"template-constructor-block-twitter-type_timeline":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="\n\t"+(null==(__t=code)?"":__t)+'\n\t<div class="overlay"></div>\n';return __p},"template-constructor-block-twitter-type_embed":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="\n\t"+(null==(__t=code)?"":__t)+'\n\t<div class="overlay"></div>\n';return __p}}},VsGE:function(t,e,i){t.exports=i.p+"img/constructor/controls/add_to_cart_settings/number-disabled.svg"},VxDd:function(t,e,i){t.exports=i.p+"img/constructor/controls/add_to_cart_settings/layout-horizontal.svg"},WEBt:function(module,exports){module.exports={"template-viewer-branding":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="rm-branding offscreen-initially">\n\t<a class="rm-branding-button" href="https://readymag.com" target="_blank"></a>\n\t</div>\n';return __p}}},"WT2/":function(t,e,i){"use strict";var n=i("6auq");i.n(n).a},Wa0v:function(t,e,i){"use strict";i("L8ei");var n=i("KHd+"),o=Object(n.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"40px",height:"40px",viewBox:"0 0 40 40",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M21 18.5C21 19.8807 19.8807 21 18.5 21C17.1193 21 16 19.8807 16 18.5C16 17.1193 17.1193 16 18.5 16C19.8807 16 21 17.1193 21 18.5ZM20.8957 22.31C20.202 22.7471 19.3805 23 18.5 23C16.0147 23 14 20.9853 14 18.5C14 16.0147 16.0147 14 18.5 14C20.9853 14 23 16.0147 23 18.5C23 19.3806 22.7471 20.202 22.3099 20.8958L25.6568 24.2427C26.0473 24.6332 26.0473 25.2663 25.6568 25.6569C25.2663 26.0474 24.6331 26.0474 24.2426 25.6569L20.8957 22.31Z"}})])}),[],!1,null,"763953b1",null);e.a=o.exports},WoDZ:function(t,e,i){"use strict";var n=i("xi34"),o=i("OTSC"),a={getVideoAspectFromPoster:function(t,e){var i={abort:function(){h.onload=null,h.onerror=null}},o={aspect_poster:null,aspect_real:null};if(!t)return e(o),i;var a,r,s,l,c,d,h=new Image;return h.onload=function(){c=h.width,d=h.height,s=200,l=Math.floor(s*(d/c)),a=Object(n.a)('<canvas id="qqq" width="200" height="'+l+'"></canvas>').css("visibility","hidden").appendTo("body"),(r=a[0].getContext("2d")).drawImage(h,0,0,s,l);var t,i,u=r.getImageData(0,0,s,l),p=0,m=0,g=0,f=0;for(i=0;i<=l/2;i++){if(_(i,"row").isContrast){(i<=1||_(i-1,"row").isBlack||_(i-2,"row").isBlack)&&(p=i);break}}for(i=l-1;i>l/2;i--){if(_(i,"row").isContrast){(i>=l-2||_(i+1,"row").isBlack||_(i+2,"row").isBlack)&&(m=l-1-i);break}}var v=Math.max(p,m),b=0;if(!v){for(t=0;t<=100;t++){if(_(t,"column").isContrast){(t<=1||_(t-1,"column").isBlack||_(t-2,"column").isBlack)&&(g=t);break}}for(t=199;t>100;t--){if(_(t,"column").isContrast){(t>=198||_(t+1,"column").isBlack||_(t+2,"column").isBlack)&&(f=199-t);break}}b=Math.max(f,g)}v>l/3&&(v=0),b>s/3&&(b=0);var y=c/d;function _(t,e){var i,n,o,a,r,c="row"==e?s:l,d=0,h=0;for(i=0;i<c;i++)n=("row"==e?t*s+i:i*s+t)<<2,d+=(o=u.data[n])+(a=u.data[n+1])+(r=u.data[n+2]),o<20&&a<20&&r<20&&h++;return{isBlack:(d/=3*c)<5&&c-h<3,isContrast:h<c/2}}v?y=s/(l-2*v):b&&(y=(s-2*b)/l),a.remove(),o.aspect_poster=c/d,o.aspect_real=y,e(o)},h.onerror=function(){e(o)},h.src="/api/proxy/?url="+encodeURIComponent(t),i},setVideoPosition:function(t){if(t.aspect_poster&&t.$media&&t.$media.length){var e=t.$container.css("width"),i=t.$container.css("height");if(/px/.test(e+i))e=parseInt(e),i=parseInt(i);else{if(!t.mag)return;var n=t.mag.getContainerSizeCached();e=n.width,i=n.height}var o,a,r=t.aspect_poster,s=t.aspect_real||r,l=t.controls_remove?5:0,c=e+2*l,d=i+2*l,h=c,u=d;if(r)c/d>s?a=(o=c)/s:o=(a=d)*s,r<s?u=(h=o)/r:h=(u=a)*r;if("vimeo"==t.provider.toLowerCase()&&t.controls_remove){var p=50-(u-d)/2,m=46-(h-c)/2;if(p>0||m>0){var g=(u+2*p)/u,f=(h+2*m)/h,v=Math.max(g,f);h*=v,u*=v}}if("youtube"==t.provider.toLowerCase()&&t.controls_remove){var b=103-(u-d)/2;b>0&&(h=(u+=2*b)*r)}var y=-l-(h-c)/2,_=-l-(u-d)/2;t.$media.css({left:y,top:_,width:h,height:u})}},getHighResVideoThumbnail:function(t){if(!t.provider||!t.thumbnail_url)return Promise.resolve(t.thumbnail_url||"");function e(t,e){return t.replace(/(\/)(\w*default)(\.\w+$)/i,"$1"+e+"$3")}function i(t,e){return t.replace(/(\/)(\w+_)(\d+x\d+|\d+)(\.\w+$)/i,"$1$2"+e+"$4")}var n,o=[];switch(t.provider.toLowerCase()){case"vimeo":o.push({url:i(t.thumbnail_url,"1280"),width:1280}),o.push({url:i(t.thumbnail_url,"640"),width:640});break;case"youtube":o.push({url:e(t.thumbnail_url,"maxresdefault"),width:1280}),o.push({url:e(t.thumbnail_url,"sddefault"),width:640})}return(n=o)&&n.length?new window.Promise((function(e){var i=0;!function e(o,a,r){(function(t,e){var i=new Image,n=new window.Promise((function(t){function n(){i.removeEventListener("load",o),i.removeEventListener("error",a)}function o(){t(e<=i.naturalWidth),n()}function a(){t(!1),n()}i.addEventListener("load",o),i.addEventListener("error",a)}));return i.src=t,n})(o,a).then((function(a){a?r(o):++i<n.length?e(n[i].url,n[i].width,r):r(t.thumbnail_url)}))}(n[i].url,n[i].width,e)})):Promise.resolve(t.thumbnail_url)},getEmbedData:function(t,e,i){return n.a.ajax({type:"GET",url:"/api/proxy/",dataType:"json",data:{url:/oembed/i.test(t)?t:this.getEmbedUrl(t)},success:function(t){t.url=t.url&&o.default.toHttps(t.url),t.thumbnail_url=t.thumbnail_url&&o.default.toHttps(t.thumbnail_url),"function"==typeof e&&e(t)},error:function(t,e,n){"abort"!==e&&"function"==typeof i&&i(t,e,n)},global:!1})},getEmbedUrl:function(t){if(this.isVimeo(t))return"https://vimeo.com/api/oembed.json?url="+encodeURIComponent(t);var e=a.getYoutubeIdFromUrl(t);return e?"https://www.youtube.com/oembed?format=json&url="+encodeURIComponent("https://www.youtube.com/watch?v="+e):""},getYoutubeIdFromUrl:function(t){var e=t.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);if(e&&11===e[2].length)return e[2];return(e=t.match(/.*(youtu.*\&v=)([^#\&\?]*).*/))&&11===e[2].length?e[2]:null},getVimeoIdFromUrl:function(t){var e=t.match(/(video\/)(\w+)(_\d+x\d+|_\d+)(\.\w+$)/i);return e&&e[2]?e[2]:null},getVideoProvider:function(t){return this.isVimeo(t)?"Vimeo":this.isYoutube(t)?"YouTube":""},isVimeo:function(t){return/vimeo\.com\/.+/.test(t)},isYoutube:function(t){return!!this.getYoutubeIdFromUrl(t)}};e.a=a},WpaW:function(t,e,i){},Wwwp:function(t,e,i){"use strict";i.d(e,"c",(function(){return b})),i.d(e,"b",(function(){return y})),i.d(e,"a",(function(){return w}));var n=i("h6tn"),o=i("ICos"),a=i("v92f"),r=i("8Tds"),s=i("zjto"),l=i("f3SV"),c=i("D12m"),d=i("M7m1"),h=i("w5C2");function u(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){g(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var f=function(t,e){if(!t)return"";var i="number"==typeof e?e:100;return"".concat(t).concat(Object(o.a)(i))},v=function(t,e){return c.a.prototype.switchTextToViewport(t,e)},b=function(t){var e=m({},t),i=e.text,n=Object(d.a)({str:i}),o=n.blocks,l=n.styles,c=n.entityMap,h=n.blocksMeta,u=o.map((function(t){return t.key})),p=Object.values(c).map((function(t){return t.data.id})),g={blocks:o,styles:l,entityMap:c,blocksMeta:h};if(e.viewport_phone_portrait){var b=v(i,a.a.PhonePortrait),y=Object(d.a)({str:b,blockKeys:u,entityKeys:p}),_=y.styles,w=y.blocksMeta,k=y.entityMap;g.viewport_phone_portrait={blocksMeta:w,entityMap:k,styles:_,bgColor:f(e.viewport_phone_portrait.bg_color,100*e.viewport_phone_portrait.bg_opacity),columns:{count:e.viewport_phone_portrait.column_count,gap:e.viewport_phone_portrait.column_gap}},e.viewport_phone_portrait=m(m({},e.viewport_phone_portrait),g.viewport_phone_portrait),e.viewport_phone_portrait.hasOwnProperty("hidden")||(e.viewport_phone_portrait.hidden=!1),delete e.viewport_phone_portrait.column_count,delete e.viewport_phone_portrait.column_gap,delete e.viewport_phone_portrait.bg_color,delete e.viewport_phone_portrait.bg_opacity}if(e.viewport_tablet_portrait){var S=v(i,a.a.TabletPortrait),x=Object(d.a)({str:S,blockKeys:u,entityKeys:p}),C=x.styles,O=x.blocksMeta,j=x.entityMap;g.viewport_tablet_portrait={blocksMeta:O,entityMap:j,styles:C,bgColor:f(e.viewport_tablet_portrait.bg_color,100*e.viewport_tablet_portrait.bg_opacity),columns:{count:e.viewport_tablet_portrait.column_count,gap:e.viewport_tablet_portrait.column_gap}},e.viewport_tablet_portrait=m(m({},e.viewport_tablet_portrait),g.viewport_tablet_portrait),e.viewport_tablet_portrait.hasOwnProperty("hidden")||(e.viewport_tablet_portrait.hidden=!1),delete e.viewport_tablet_portrait.column_count,delete e.viewport_tablet_portrait.column_gap,delete e.viewport_tablet_portrait.bg_color,delete e.viewport_tablet_portrait.bg_opacity}return e=m(m({},e),{},{autosize:e.autosize,verticalAlign:r.d.top,blocks:g.blocks,styles:g.styles,entityMap:g.entityMap,blocksMeta:g.blocksMeta,bgColor:f(e.bg_color,100*e.bg_opacity),columns:{count:e.column_count,gap:e.column_gap},version:s.h,column_count:void 0,column_gap:void 0,bg_color:void 0,bg_opacity:void 0,text:void 0})},y=function(t){var e=["none",0,"baseline"],i=["opacity"];return t.map((function(t){var a=t._name,r=t._caption,s=t.tag,c=(t._sort,u(t,["_name","_caption","tag","_sort"])),d=Object.keys(c).reduce((function(t,a){var r=Object(n.a)(a),s=c[a];if(i.includes(a)||e.includes(s))return m({},t);if("textAlign"===r&&"start"===s)s="left";else if("color"===r){var l=c.opacity>0?parseFloat((c.opacity/100).toFixed(2)):1,d=Object(o.b)(s,l);s=Object(o.h)(d)}else r.includes("padding")?s=parseInt(s):"fontWeight"===r&&"normal"===s&&(s=h.b.fontWeight);return m(m({},t),{},g({},r,s))}),{});return d.paddingLeft=d.paddingLeft||0,d.paddingRight=d.paddingRight||0,d.paddingTop=d.paddingTop||0,d.paddingBottom=d.paddingBottom||0,{name:a,label:r,tag:s||l.a.AVAILABLE_TEXT_TAGS[0],cssProperties:d}}))},_=function(t,e){var i=function(t){return e?"".concat(e,"-").concat(t):t},n=void 0!==t[i("color")]?t[i("color")]:t.color,o=void 0!==t[i("opacity")]?t[i("opacity")]:t.opacity,a=void 0!==t[i("u-color")]?t[i("u-color")]:t["u-color"],s=void 0!==t[i("u-opacity")]?t[i("u-opacity")]:t["u-opacity"],l=void 0!==t[i("u-size")]?t[i("u-size")]:t["u-size"],c=void 0!==t[i("u-offset")]?t[i("u-offset")]:t["u-offset"],d=void 0!==t[i("u-style")]?t[i("u-style")]:t["u-style"];return{textColor:f(String("inherit"===n?t.color:n),Number("inherit"===o?t.opacity:o)),color:f(String("inherit"===a?t["u-color"]:a),Number("inherit"===s?t["u-opacity"]:s)),size:Number("inherit"===l?t["u-size"]:l),padding:Number("inherit"===c?t["u-offset"]:c),type:function(t){switch(t){case"none":return r.a.None;case"dotted":return r.a.Dotted;case"dashed":return r.a.Dashed;case"solid":return r.a.Solid}}(d)}},w=function(t){return t.map((function(t){return{name:t._name,label:t._caption,style:{link:_(t),hover:_(t,"hover"),current:_(t,"current")}}}))}},Wxmq:function(module,exports){module.exports={"template-viewer-share":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="\n\t",hasOverlay&&(__p+='\n\t\t<div class="share-popup-overlay hidden" data-nosnippet></div>\n\t'),__p+='\n\n\t<div class="share-popup hidden" data-nosnippet>\n\t\t<noindex>\n\t\t\t<div class="content-wrapper">\n\n\t\t\t\t<div class="share-wrapper">\n\t\t\t\t\t<div class="caption">Share</div>\n\n\t\t\t\t\t<div class="type-selector">\n\t\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t\t<div class="type-full">Project</div>\n\t\t\t\t\t\t<div class="type-page">Current Page</div>\n\t\t\t\t\t\t<div class="arrow sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="buttons-wrapper">\n\t\t\t\t\t\t<div class="share-facebook button" data-tp="facebook"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div>Share</div>\n\t\t\t\t\t\t<div class="share-twitter button" data-tp="twitter"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div>Tweet</div>\n\t\t\t\t\t\t<div class="share-pinterest button" data-tp="pinterest"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div>Pin</div>\n\t\t\t\t\t\t<div class="share-linkedin button" data-tp="linkedin"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+"')\"></div>Linkedin</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t",common.isDownloadedSource||(__p+='\n\t\t\t\t\t\t<div class="open-embed"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div>Embed</div>\n\t\t\t\t\t\t<div class="close">Close</div>\n\t\t\t\t\t\t<div class="send-report" data-tp="report"><div class="icon sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+"')\"></div>Report</div>\n\t\t\t\t\t"),__p+="\n\t\t\t\t</div>\n\n\t\t\t\t",common.isDownloadedSource||(__p+='\n\t\t\t\t\t<div class="embed-wrapper">\n\t\t\t\t\t\t<div class="caption">Embed</div>\n\n\t\t\t\t\t\t<div class="size-selector" data-selected="responsive">\n\t\t\t\t\t\t\t<div class="size responsive" data-size="responsive">Responsive</div>\n\t\t\t\t\t\t\t<div class="size big" data-size="big">512×383</div>\n\t\t\t\t\t\t\t<div class="size small" data-size="small">288×236</div>\n\t\t\t\t\t\t\t<div class="arrow sprite" style="background-image: url(\''+(null==(__t=icons.sprite)?"":__t)+'\')"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="code-block">\n\t\t\t\t\t\t\t<div class="thumb">\n\t\t\t\t\t\t\t\t<img class="thumb-pic" src="" alt=""/>\n\t\t\t\t\t\t\t\t<div class="thumb-toolbar">\n\t\t\t\t\t\t\t\t\t<div class="icon arrows" style="background-image: url(\''+(null==(__t=icons.thumbArrows)?"":__t)+'\')"></div>\n\t\t\t\t\t\t\t\t\t<div class="icon open" style="background-image: url(\''+(null==(__t=icons.thumbOpen)?"":__t)+'\')"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<textarea class="embed-code"></textarea>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="back">Back</div>\n\t\t\t\t\t</div>\n\t\t\t\t'),__p+='\n\t\t\t</div>\n\n\t\t\t<div class="corner-wrapper">\n\t\t\t\t<div class="corner"></div>\n\t\t\t</div>\n\t\t</noindex>\n\t</div>\n';return __p}}},WySc:function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("LDvm"),l=i("8by/"),c=i("ICos"),d=i("QNie");function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function u(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function m(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){p(a,n,o,r,s,"next",t)}function s(t){p(a,n,o,r,s,"throw",t)}r(void 0)}))}}function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){v(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return _(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function w(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}i.d(e,"a",(function(){return S})),i.d(e,"c",(function(){return x})),i.d(e,"b",(function(){return C}));var k=Object(n.e)(r.m).withConfig({displayName:"ColorPicker___StyledBox"})(["background-image:url('","');"],"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9IjAgMCAyMiAyMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPG1hc2sgaWQ9Im1hc2swIiBtYXNrLXR5cGU9ImFscGhhIiBtYXNrVW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjIiIGhlaWdodD0iMjIiPgo8Y2lyY2xlIGN4PSIxMSIgY3k9IjExIiByPSIxMC41IiBmaWxsPSIjQkU0MDQwIiBzdHJva2U9IiNCOEI4QjgiLz4KPC9tYXNrPgo8ZyBtYXNrPSJ1cmwoI21hc2swKSI+CjxjaXJjbGUgY3g9IjEiIGN5PSIxIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEiIGN5PSI5IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEiIGN5PSIxNyIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1IiBjeT0iNSIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1IiBjeT0iMTMiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iNSIgY3k9IjIxIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzIiBjeT0iNSIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSIxMyIgY3k9IjEzIiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzIiBjeT0iMjEiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjEiIGN5PSI1IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjIxIiBjeT0iMTMiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjEiIGN5PSIyMSIgcj0iMiIgZmlsbD0iIzI4MjgyOCIvPgo8Y2lyY2xlIGN4PSI1IiBjeT0iMSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iNSIgY3k9IjkiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjUiIGN5PSIxNyIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMSIgY3k9IjUiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjEiIGN5PSIxMyIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMSIgY3k9IjIxIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5IiBjeT0iNSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjEzIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSI5IiBjeT0iMjEiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjE3IiBjeT0iNSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTciIGN5PSIxMyIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTciIGN5PSIyMSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjEiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjkiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iOSIgY3k9IjE3IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjEzIiBjeT0iMSIgcj0iMiIgZmlsbD0id2hpdGUiLz4KPGNpcmNsZSBjeD0iMTMiIGN5PSI5IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxMyIgY3k9IjE3IiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIxNyIgY3k9IjEiIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMTciIGN5PSI5IiByPSIyIiBmaWxsPSIjMjgyODI4Ii8+CjxjaXJjbGUgY3g9IjE3IiBjeT0iMTciIHI9IjIiIGZpbGw9IiMyODI4MjgiLz4KPGNpcmNsZSBjeD0iMjEiIGN5PSIxIiByPSIyIiBmaWxsPSJ3aGl0ZSIvPgo8Y2lyY2xlIGN4PSIyMSIgY3k9IjkiIHI9IjIiIGZpbGw9IndoaXRlIi8+CjxjaXJjbGUgY3g9IjIxIiBjeT0iMTciIHI9IjIiIGZpbGw9IndoaXRlIi8+CjwvZz4KPC9zdmc+Cg=="),S=function(t){var e=t.hex,i=t.borderColor,n=void 0===i?"white":i,o=t.opacity,s=void 0===o?1:o;return(a.a.createElement(r.B,{alignItems:"center",justifyContent:"center"},a.a.createElement(r.m,{width:24,height:24,borderRadius:"50%",border:"2px solid",borderColor:n,position:"relative"},a.a.createElement(r.m,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,borderRadius:"50%",style:{backgroundColor:e,opacity:s}}),a.a.createElement(k,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1,borderRadius:"50%"}))))},x={h:180,s:0,v:0,a:1},C=function(t){var e=t.projectId,i=t.userId,n=t.onChangeComplete,p=t.onColorChange,g=t.color,y=t.setColor,_=t.width,k=void 0===_?170:_,S=t.height,x=w(t,["projectId","userId","onChangeComplete","onColorChange","color","setColor","width","height"]),C=Object(o.useContext)(d.a).model,O=b(Object(l.d)(),2),j=O[0],P=O[1],E=Object(o.useMemo)((function(){var t,e;return(null==C||null===(t=C.project)||void 0===t||null===(e=t.edit_params)||void 0===e?void 0:e.get("colorbox_state"))||"color"}),[]),I=function(t){P(f(f({},j),{},{project:t}))},T=function(t){P(f(f({},j),{},{global:t}))},M=b(Object(o.useState)(g),2),$=M[0],A=M[1];Object(o.useEffect)((function(){Object(c.h)($)!==Object(c.h)(g)&&A(g)}),[g]);var R=function(){var t=m(regeneratorRuntime.mark((function t(n,o){var a,l,c,d,h,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=n===r.yb.project?j.project.regular:j.global.regular,m=void 0,m=p.reduce((function(t,e,i){return null!==t||e?t:i}),null),a=null!==m?m:p.length,l=n===r.yb.project?s.O:s.L,c=n===r.yb.project?I:T,(d=n===r.yb.project?j.project:j.global).regular[a]=o,c(d),t.next=8,l({userId:i,projectId:e,color:o,index:a,type:r.xb.regular});case 8:h=t.sent,u=h.data,c(u);case 11:case"end":return t.stop()}var p,m}),t)})));return function(e,i){return t.apply(this,arguments)}}(),D=function(){var t=m(regeneratorRuntime.mark((function t(n,o){var a,l,c,d,h,u,p,m,g,f,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n===r.yb.project?j.project:j.global,l=n===r.yb.project?I:T,c=n===r.yb.project?s.O:s.L,d=a.regular.findIndex((function(t){return t&&t.toLowerCase()===o.toLowerCase()})),h=a.favourites.findIndex((function(t){return t&&t.toLowerCase()===o.toLowerCase()})),!(d>-1)){t.next=16;break}return(u=n===r.yb.project?j.project:j.global).regular[d]=void 0,l(u),t.next=11,c({color:void 0,index:d,type:r.xb.regular,projectId:e,userId:i});case 11:p=t.sent,m=p.data,l(m),t.next=25;break;case 16:if(!(h>-1)){t.next=25;break}return(g=n===r.yb.project?j.project:j.global).favourites[d]=void 0,l(g),t.next=22,c({color:void 0,index:h,type:r.xb.favourites,projectId:e,userId:i});case 22:f=t.sent,v=f.data,l(v);case 25:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}(),B=function(){var t=m(regeneratorRuntime.mark((function t(n){var o,a,c,d,h,p,m,g,b,y,_,w,k,S,x,C,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.tab,a=n.from,c=n.to,d=n.color,h=n.newIndex,p=n.oldIndex,m=Object(l.a)(),g=o===r.yb.project?m.project:m.global,b=o===r.yb.project?I:T,a!==c?((_=u(g[a]))[p]=void 0,(w=u(g[c]))[h]=d,b((v(y={},a,_),v(y,c,w),y))):((k=u(g[a]))[p]=void 0,k[h]=d,b(f(f({},g),{},v({},a,k)))),o!==r.yb.project){t.next=13;break}return t.next=8,Object(s.x)({projectId:e,from:a,to:c,color:d,newIndex:h,oldIndex:p});case 8:S=t.sent,x=S.data,I(x),t.next=18;break;case 13:return t.next=15,Object(s.w)({userId:i,from:a,to:c,color:d,newIndex:h,oldIndex:p});case 15:C=t.sent,O=C.data,T(O);case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return a.a.createElement(r.s,h({width:k,height:S,onChange:function(t){A(t),y(t),p&&p(t)},color:$,projectSwatches:j.project,globalSwatches:j.global,onChangeComplete:n,initialSection:E,onSectionChanged:function(t){C.project.edit_params.set("colorbox_state",t),C.project.edit_params.save()}},x,{onSwatchAdd:R,onSwatchRemove:D,onMoveColors:B}))}},X7yJ:function(t,e,i){"use strict";var n=i("f3SV"),o=i("mkcP");function a(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){l(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=Boolean(window&&window.viewerConfig&&window.viewerConfig.homepageRewrite),d=Boolean(window&&window.viewerConfig&&window.viewerConfig.isDownloadedSource)&&!c,h=function(t){return n.a.allowedLambdaExt.includes(t)},u=function(t){return Boolean(!d&&t&&t.lambdaUrl&&h(t.type))},p=function(t,e){switch(e){case"video":case"slideshow":return Boolean(!d&&t&&t.url&&h(t.type));case"background":return Boolean(!d&&t&&(t.url||t.finalUrl)&&h(t.type));default:return Boolean(!d&&t&&(t.unscaledUrl||t.unscaledOptimizedUrl)&&h(t.type))}},m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.width,i=t.height,o=t.cropX,a=t.cropY,r=t.cropW,s=t.cropH,l=t.originalW,c=void 0===l?9999:l,d=t.originalH,h=void 0===d?9999:d,u=t.quality,p=t.ext,m=t.scale,g=t.animationScale,f=t.isStretched,v=t.dpr,b=t.lossless,y=t.nearLossless,_=t.fit,w=void 0===_?"none":_,k=window.devicePixelRatio||n.a.minDpr,S=v||(k<n.a.minDpr?n.a.minDpr:k),x=[],C=Math.max(m||1,1),O=g||1;if(!f&&e){var j=Math.min(Math.round(e*S*C*O),c);j<c&&x.push("w=".concat(j))}if(!f&&!e&&i){var P=Math.min(Math.round(i*S*C*O),h);P<h&&x.push("h=".concat(P))}if(u&&x.push("q=".concat(u)),p&&x.push("e=".concat(p)),b&&x.push("ll=true"),y&&x.push("nll=true"),"auto"===w&&e&&i){var E=Math.min(Math.round(i*S*C*O),h);E<h&&x.push("h=".concat(E))}return void 0!==o&&void 0!==a&&r&&s&&(r!==c||s!==h)&&(x.push("cX=".concat(o)),x.push("cY=".concat(a)),x.push("cW=".concat(r)),x.push("cH=".concat(s))),x.length?"?".concat(x.join("&")):""},g=function(t){return t?"".concat(t.lambdaUrl||function(t){if(!t)return"";try{var e=new URL(t.unscaledUrl||t.url||t.unscaledOptimizedUrl||t.finalUrl);return"".concat(n.a.readymag_lambda_host).concat(e.pathname)}catch(t){return""}}(t)):""},f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return"";var i=s({},e);return p(t)&&!u(t)&&(i.cropX=void 0,i.cropY=void 0,i.cropW=e.originalW,i.cropH=e.originalH),o.a.isSupported("webp")&&(i.ext="webp","png"===t.type&&(i.nearLossless=!0)),"".concat(g(t)).concat(m(i))};e.a={allowedLambdaExt:h,useLambdaUrl:u,useLambdaUrlOldProjects:p,useLqipUrl:function(t){return Boolean(t&&t.lqipUrl||u(t))},getLambdaUrl:f,getOriginalLambdaUrl:g,getLambdaParams:m,getSrcset:function(t,e){var i=e.dprSet,n=void 0===i?[2,3]:i,o=a(e,["dprSet"]),r=[];(n||[]).forEach((function(e){o.dpr=e;var i=f(t,o);i!==r[r.length-1]&&r.push({dpr:e,url:i})}));var s=r.map((function(t){return"".concat(t.url," ").concat(t.dpr,"x")}));return s.length>1?s.join(", "):void 0},getLqipUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return"";if(t.lqipUrl)return t.lqipUrl;var i=s({dpr:1,width:n.a.lqipWidth,quality:n.a.lqipQuality},e);return f(t,i)},getThumbnailUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t)return"";var i=s({width:n.a.THUMB_SIZE,height:n.a.THUMB_SIZE,quality:n.a.THUMB_QUALITY,fit:"auto"},e);return f(t,i)}}},XHB6:function(t,e,i){"use strict";var n=i("xi34"),o=i("OTSC"),a=i("Fts9"),r=i("I0kf"),s={model:{event:"change"},props:{color:String,alpha:Number,disabled:{type:Boolean,default:!1},disabledIcon:String,customIcon:String,showAlpha:{type:Boolean,default:!0},showArrowIcon:{type:Boolean,default:!1},hOffset:{type:Number,default:0},opacityMultiplier:{type:Number,default:1},vOffset:{type:Number,default:0},verticalAlign:{type:String,default:"auto"},alwaysVisible:{type:Boolean,default:!1},colorboxType:{type:String,default:"small"},colorboxWidth:{type:Number,default:168},colorboxHeight:{type:Number,default:void 0},swatchesMin:{type:Number,default:void 0},swatchesPerLine:{type:Number,default:void 0},favouritesMax:{type:Number,default:void 0},favouritesPerLine:{type:Number,default:void 0},favouriteGap:{type:Number,default:void 0},colorboxBorderRadius:{type:Number,default:void 0}},data:function(){return{mutableColor:this.color,mutableAlpha:this.showAlpha?this.alpha*this.opacityMultiplier:1,visibleBox:!1,colorBoxStyles:{},isNewColorPicker:Object(r.a)("constructor.newColorpicker")}},computed:{bg:function(){return this.disabled&&!this.mutableColor?"#b8b8b8":o.default.getRGBA(this.mutableColor,this.showAlpha?this.opacity100based:1)},opacity100based:function(){return this.mutableAlpha/100},opacityResult:function(){return this.mutableAlpha/this.opacityMultiplier}},watch:{color:function(t){return this.mutableColor=t,!!this.colorbox&&(this.mutableColor?void this.colorbox.setColor(this.mutableColor):(this.visibleBox&&this.hide(),!1))}},mounted:function(){var t=8;this.alwaysVisible?(this.colorBoxStyles.width=(this.colorboxWidth||168)+"px",this.colorBoxStyles.height=this.colorboxHeight?this.colorboxHeight+"px":void 0,this.colorBoxStyles.overflow="hidden",this.colorBoxStyles["border-radius"]="6px 6px 0 0",this.onColorClick()):(Object(n.a)(this.$el).hasClass("round")&&(t=7),this.$el.getBoundingClientRect().top>window.innerHeight/2||"top"===this.verticalAlign?this.colorBoxStyles["margin-top"]=-(240+t+this.vOffset)+"px":this.colorBoxStyles["margin-top"]=Object(n.a)(this.$refs.button).height()+t+this.vOffset+"px",this.colorBoxStyles["margin-left"]=-(this.hOffset+152-Object(n.a)(this.$refs.button).width())+"px")},methods:{onColorClick:function(){if(!this.disabled){if(!this.colorbox){var t={$parent:this.$el.querySelector(".colorbox_container"),type:this.colorboxType,show_opacity:this.showAlpha};this.colorboxWidth&&(t.width=this.colorboxWidth),this.swatchesMin&&(t.swatches_min=this.swatchesMin),this.swatchesPerLine&&(t.swatches_per_line=this.swatchesPerLine),this.favouritesMax&&(t.favourites_max=this.favouritesMax),this.favouritesPerLine&&(t.favourites_per_line=this.favouritesPerLine),this.isNewColorPicker&&("number"==typeof this.favouriteGap&&(t.favourite_gap=this.favouriteGap),"number"==typeof this.colorboxHeight&&(t.height=this.colorboxHeight),"number"==typeof this.colorboxBorderRadius&&(t.borderRadius=this.colorboxBorderRadius)),this.colorbox=new a.a(t),this.colorbox.on("colorchange",this.colorOpacityChanged),this.colorbox.on("opacitychange",this.colorOpacityChanged)}this.colorbox.setColor(this.mutableColor),this.colorbox.setOpacity(this.opacity100based),this.$emit(this.visibleBox?"hidePopup":"showPopup",this),this.visibleBox=!this.visibleBox}},colorOpacityChanged:function(t,e,i,n){this.mutableColor=this.colorbox.rgb2hex([t,e,i]),this.mutableAlpha=100*n,this.$emit("update:all",{color:this.mutableColor,alpha:this.opacityResult}),this.$emit("update:color",this.mutableColor),this.$emit("update:alpha",this.opacityResult)},hide:function(){this.visibleBox=!1,this.$emit("hidePopup")}}},l=(i("6z1P"),i("KHd+")),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"button",class:{"color-picker-container":!0,"color-picker-disabled":t.disabled}},[t.showAlpha?i("div",{staticClass:"opacity-grid"}):t._e(),t._v(" "),t.alwaysVisible?t._e():i("div",{staticClass:"color-preview",style:{backgroundColor:t.bg},on:{click:function(e){return e.stopPropagation(),t.onColorClick(e)}}},[t.disabled&&t.disabledIcon?i("img",{staticClass:"disabled-icon",attrs:{src:t.disabledIcon}}):t._e(),t._v(" "),!t.disabled&&t.customIcon?i("img",{staticClass:"custom-icon",attrs:{src:t.customIcon}}):t._e()]),t._v(" "),t.showArrowIcon?i("div",{staticClass:"arrow-icon",on:{click:function(e){return e.stopPropagation(),t.onColorClick(e)}}}):t._e(),t._v(" "),t.isNewColorPicker?t._e():i("div",{staticClass:"colorbox_container",class:{visible:t.visibleBox},style:t.colorBoxStyles,on:{click:function(t){t.stopPropagation()}}}),t._v(" "),t.isNewColorPicker?i("div",{staticClass:"colorbox_container",class:{visible:t.visibleBox},style:t.colorBoxStyles}):t._e()])}),[],!1,null,null,null);e.a=c.exports},"Y+fa":function(t,e,i){"use strict";var n=i("TAzU");i.n(n).a},YNoo:function(module,exports){module.exports={"template-viewer-widget-text":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="\n\t";var cc=1==column_count?"auto":column_count;__p+='\n\t<div style=" -webkit-nbsp-mode:normal; -webkit-line-break:after-white-space; white-space:'+(null==(__t=isNotChrome?"normal":"pre-wrap")?"":__t)+"; column-count:"+(null==(__t=cc)?"":__t)+";-webkit-column-count:"+(null==(__t=cc)?"":__t)+" !important;-moz-column-count:"+(null==(__t=cc)?"":__t)+";column-gap:"+(null==(__t=column_gap)?"":__t)+"px;-webkit-column-gap:"+(null==(__t=column_gap)?"":__t)+"px !important;-moz-column-gap:"+(null==(__t=column_gap)?"":__t)+"px;background:"+(null==(__t=bg)?"":_.escape(__t))+'">'+(null==(__t=text)?"":__t)+"</div>\n"}return __p}}},YWqI:function(t,e,i){"use strict";var n=i("8nfS");i.n(n).a},YqYG:function(t,e,i){"use strict";i.r(e);var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("Nnyp"),l=i.n(s),c=a.a.View.extend({template:l.a["template-common-alert"],events:{"click .button":"onButtonClick",click:"hideOnBgClick","click .button.upgrade":"upgrade","click .button.cancel":"hide","click .button.close":"hide","click .button.ok":"hide","click .contact-link":"hide","click .button.resend":"resendConfirmationEmail"},initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),this.opts=this.opts||{},this.router=this.router||RM.homepageRouter||RM.collectorRouter||RM.constructorRouter,this.router&&this.router.analytics&&this.router.analytics.sendEvent("Alert Show",{label:this.alert_source,_alert_source:this.alert_source})},render:function(){this.setElement(Object(n.a)(this.template({opts:this.opts}))),this.$parent&&(this.$parent instanceof Element&&(this.$parent=Object(n.a)(this.$parent)),this.$parent.append(this.$el).addClass("visible")),r.a.delay(r.a.bind((function(){this.$el.addClass("show")}),this),50),Object(n.a)("body").on("keyup",this.onBodyKeyUp),RM.common.disableShortcuts.alert=!0},hide:function(){delete RM.common.disableShortcuts.alert,Object(n.a)("body").off("keyup",this.onBodyKeyUp),this.$el.removeClass("show").addClass("hide"),r.a.delay(r.a.bind((function(){this.remove(),this.$parent&&this.$parent.removeClass("visible")}),this),400),this.trigger("hide",{lastButtonClicked:this.lastButtonClicked})},upgrade:function(t){Modernizr.sessionstorage&&window.sessionStorage.setItem("rm.accountUpgradeReturnUrl",window.location.pathname),this.router&&this.router.analytics&&this.router.analytics.sendEvent("Alert Upgrade",{label:this.alert_source,_alert_source:this.alert_source}),2==t.which||t.metaKey||t.ctrlKey||this.router&&this.router==RM.collectorRouter&&(this.hide(),this.router.navigate("/settings#change-plan",{trigger:!0}),t.preventDefault())},onBodyKeyUp:function(t){27==t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.hide())},hideOnBgClick:function(t){Object(n.a)(t.target).closest(".panel").length||this.hide()},resendConfirmationEmail:function(){n.a.get("/api/user/confirm/resend"),this.hide()},onButtonClick:function(t){var e=Object(n.a)(t.currentTarget).attr("data-type");this.lastButtonClicked=e}});e.default=c},Zl4r:function(module,exports){module.exports={"template-constructor-pages-panel-settings-viewer":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="viewer-caption">Navigation</div>\n\n\t<div class="scroll-switcher">\n\t\t<div class="scroll-option vertical" data-viewertype="vertical">Vertical</div>\n\t\t<div class="scroll-option horizontal selected" data-viewertype="horizontal">Horizontal</div>\n\t\t<div class="selection-frame"></div>\n\t</div>\n\n\n\t<div class="viewer-setting scalableviewer">\n\t\t<div class="caption">\n\t\t\t<span>Scale Layout</span>\n\t\t\t<a href="https://help.readymag.com/hc/en-us/articles/360020844331-Scale-layout" target="_blank" class="help"></a>\n\t\t</div>\n\t\t<div class="desc">Desktop layout scales up to<br>\n\t\t\t<input class="amount-px" type="text" spellcheck="false">px browser\'s width\n\t\t</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\n\t<div class="viewer-setting slidein">\n\t\t<div class="caption">\n\t\t\t<span>Slide-in transition</span>\n\t\t\t<div class="help">\n\t\t\t\t<div class="help-popup">\n\t\t\t\t\t<div class="help-body-wrapper">\n\t\t\t\t\t\t<div class="help-body">\n\t\t\t\t\t\t\t<span class="help-text">Note, that in Vertical Viewer it might affect scrolling smoothness for projects with heavy animations.</span>\n\t\t\t\t\t\t\t<div class="help-popup-corner">\n\t\t\t\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="hover-spacer"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="desc">Next page appears on top<br>of the current one</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\n\n\t<div class="separator s2"></div>\n\n\t',is_contributor?__p+='\n\t<div class="upgrade-message hidden">Please upgrade <a class="settings-link upgrade-link" href="mailto:'+(null==(__t=owner_email)?"":__t)+'">owner’s account</a><br/>to manage the white label settings.</div>\n\t':__p+='\n\t<div class="upgrade-message hidden">Please <a class="settings-link upgrade-link" href="/settings#change-plan">upgrade</a> your account<br/>to manage the white label settings.</div>\n\t',__p+='\n\n\t<div class="viewer-setting arrows">\n\t\t<div class="caption">\n\t\t\t<span>Navigation arrows</span>\n\t\t\t<div class="help">\n\t\t\t\t<div class="help-popup">\n\t\t\t\t\t<div class="help-body-wrapper">\n\t\t\t\t\t\t<div class="help-body">\n\t\t\t\t\t\t\t<span class="help-text">Arrows to switch between the pages at the right and left sides of each page.</span>\n\t\t\t\t\t\t\t<div class="help-popup-corner">\n\t\t\t\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="hover-spacer"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\t',isNewSettingsEnabled&&(__p+='\n\t\t<div class="separator s2"></div>\n\t'),__p+='\n\t<div class="viewer-setting menubutton">\n\t\t<div class="caption">\n\t\t\t<span>Menu button</span>\n\t\t\t<div class="help">\n\t\t\t\t<div class="help-popup">\n\t\t\t\t\t<div class="help-body-wrapper">\n\t\t\t\t\t\t<div class="help-body">\n\t\t\t\t\t\t\t<span class="help-text">\n\t\t\t\t\t\t\t\t'+(null==(__t=isNewSettingsEnabled?"Main menu button at the bottom right corner of each page.":"Main menu button at the top right corner of each page.")?"":__t)+'\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div class="help-popup-corner">\n\t\t\t\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="hover-spacer"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\t<div class="viewer-setting projectinfo">\n\t\t<div class="caption">\n\t\t\t\x3c!--__magterm--\x3e\n\t\t\t<span>Project info</span>\n\t\t</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\t<div class="viewer-setting sharebutton">\n\t\t<div class="caption">\n\t\t\t<span>Share button</span>\n\t\t</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\t<div class="viewer-setting pagecounter">\n\t\t<div class="caption">\n\t\t\t<span>Page counter</span>\n\t\t</div>\n\t\t<div class="switcher"></div>\n\t</div>\n\t',isNewSettingsEnabled&&(__p+='\n\t\t<div class="viewer-setting controlsontop">\n\t\t\t<div class="caption">\n\t\t\t\t<span>Controls on top</span>\n\t\t\t</div>\n\t\t\t<div class="switcher"></div>\n\t\t</div>\n\t'),__p+="\n\t",isNewSettingsEnabled&&(__p+='\n\t\t<div class="separator s2"></div>\n\t'),__p+='\n \t<div class="viewer-setting switcher endpage section">\n\t<div class="caption">\n\t\t<span>Readymag branding</span>\n\t</div>\n\t<div class="switcher"></div>\n</div>\n\n<div class="viewer-setting switcher lqip section">\n\t<div class="caption">\n\t\t<span>Progressive images</span>\n\t\t<div class="help">\n\t\t\t<div class="help-popup">\n\t\t\t\t<div class="help-body-wrapper">\n\t\t\t\t\t<div class="help-body">\n\t\t\t\t\t\t<span class="help-text">Use blurred images to preview while loading.</span>\n\t\t\t\t\t\t<div class="help-popup-corner">\n\t\t\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="hover-spacer"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="switcher"></div>\n</div>\n\n\x3c!-- <div class="endpage-selector">\n\t<div class="selector-value">Show info + Readymag promo</div>\n\t\t<select name="endpage-select">\n      <option value="join">Show info + Readymag promo</option>\n\t\t\t<option value="recent">Show info + latest projects</option>\n\t\t\t<option value="empty">Show only project info</option>\n\t\t</select>\n \t</div> --\x3e\n</div>\n\n\t<div class="learn-more"><a href="http://help.readymag.com/hc/en-us/articles/360020588752-Viewer-navigation" target="_blank" class="learn-more-link settings-link">Learn more</a> about Viewer Settings</div>\n\n\t\x3c!--<div class="learn-more"><a href="" class="settings-link">Learn more</a> about Viewer Settings</div>--\x3e\n';return __p}}},Zuws:function(module,exports){module.exports={"template-viewer-widget-background":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="rmwidget widget-background" style="background-color: #'+(null==(__t=data.color)?"":__t)+'">\n\n        ',"picture"==data.selectedType&&(__p+='\n            <div class="picture-background" style="opacity: '+(null==(__t=data.opacity||1)?"":__t)+';"></div>\n        '),__p+="\n\n        ","video"==data.selectedType&&(__p+='\n            <div class="video-background" style="opacity: '+(null==(__t=data.videoopacity||1)?"":__t)+';">\n                <div class="video-container"></div>\n                <div class="overlay"></div>\n            </div>\n\t\t'),__p+="\n\n\t\t","slideshow"==data.selectedType&&(__p+='\n\t\t\t<div class="slideshow-background">\n\t\t\t\t<div class="slideshow-container"></div>\n\t\t\t\t<div class="slideshow-preload"></div>\n\t\t\t</div>\n\t\t'),__p+="\n\t</div>\n";return __p}}},"a/+O":function(module,exports){module.exports={"template-constructor-helpers-upload-button":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="rm-upload-button">\n\t\t<div class="icon"></div>\n\t</div>\n\n';return __p}}},a3mI:function(module,exports){module.exports={"template-constructor-control-button_icon":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="icon noarrow" data-alt="Icon" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\n\t\t<div class="search-block">\n\n\t\t\t<input class="search" type="text" placeholder="Search">\n\n\n\t\t\t<div class="loupe">\n\t\t\t\t<div class="rmpreloader hidden"><div class="arc"></div></div>\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t\t<div class="common-wrapper">\n\n\n\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t<div class="resizable-content">\n\n\t\t\t\t\t\t<div class="disable-icon item">\n\t\t\t\t\t\t\t<div class="line"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\x3c!--<div class="last-icon item">--\x3e\n\t\t\t\t\t\t\t\x3c!--<div class="noun-icon"></div>--\x3e\n\t\t\t\t\t\t\x3c!--</div>--\x3e\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t</div>\n\n\n\t\t\t<div class="params-wrapper clearfix">\n\n\t\t\t\t<div class="edit-item" data-field="icon_h">\n\t\t\t\t\t<div class="caption">Size</div>\n\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="edit-item" data-field="icon_pos">\n\t\t\t\t\t<div class="caption">Pos.</div>\n\t\t\t\t\t<div class="positions">\n\t\t\t\t\t\t<div class="right position" data-position="right">\n\t\t\t\t\t\t\t<div class="fill"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="left position" data-position="left">\n\t\t\t\t\t\t\t<div class="fill"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\n\t</div>\n';return __p},"template-constructor-control-button_icon-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon-item item">\n\t\t<div class="noun-icon" style="background-image: url('+(null==(__t=icon.preview_url_42)?"":__t)+');" '+(null==(__t=icon.id?'data-id="'+icon.id+'"':'data-rm_id="'+icon.rm_id+'"')?"":__t)+' data-url="'+(null==(__t=icon.icon_url)?"":__t)+'">\n\t</div>\n';return __p}}},a68n:function(t,e,i){"use strict";i.d(e,"i",(function(){return p})),i.d(e,"f",(function(){return f})),i.d(e,"a",(function(){return v})),i.d(e,"d",(function(){return b})),i.d(e,"c",(function(){return y})),i.d(e,"b",(function(){return _})),i.d(e,"g",(function(){return w})),i.d(e,"e",(function(){return k})),i.d(e,"h",(function(){return S}));var n=i("/5Qy"),o=i("ICos"),a=i("fueH"),r=i("w5C2"),s=i("Jzj8");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function h(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var p="textStyle",m=["fontSize","lineHeight","letterSpacing","textIndent","paddingLeft","paddingTop","paddingRight","paddingBottom","width"],g=function(t,e){if(e){if(m.includes(t))return"".concat(e,"px");if("color"===t){var i=Object(o.f)(String(e)),n=i.r,a=i.g,r=i.b,s=i.a;return"rgba(".concat(n,", ").concat(a,", ").concat(r,", ").concat(s,")")}return e}},f=function(t,e){if(e){if(m.includes(t))return parseInt(String(e));if("color"===t){var i=Object(o.i)(String(e)),n=i.r,a=i.g,r=i.b;return Object(o.j)({r:n,g:a,b:r,a:1})}return e}},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.keys(t).reduce((function(i,o){return t[o]?"".concat(i).concat(Object(n.a)(o),": ").concat(g(o,t[o])).concat(e?" !important":"","; "):i}),"")},b=function(){var t=Object(s.d)()||window.ServerData&&window.ServerData.mags&&window.ServerData.mags.mag&&window.ServerData.mags.mag.textStyles;return t?[].concat(h(t.project||[]),h(t.global||[])).reduce((function(t,e){return c(c({},t),{},d({},e.name,{element:e.tag}))}),{}):{}},y=function(t,e){return t?e?parseFloat(String(t)):parseInt(String(t)):0},_=function(t){var e=t.editorState,i=t.block,n=a.a.getBlockData({editorState:e,block:i,key:p});return"string"==typeof n?n:""},w=function(t){var e=t.block,i=t.editorState,n=t.styleName;return a.a.setBlockData({editorState:i,block:e,key:p,value:n})},k=function(t){if(t&&t.cssProperties){var e=t.cssProperties,i=e.paddingTop,n=e.paddingLeft,o=e.paddingRight,a=e.paddingBottom,r={left:void 0!==n?y(n):0,top:void 0!==i?y(i):0,right:void 0!==o?y(o):0,bottom:void 0!==a?y(a):0};if(r.left||r.top||r.right||r.bottom)return r}},S=function(t){var e=t.style,i=t.currentStyle,n=t.editorState,o=a.a.getSelectedBlocks(n),s=n.getCurrentContent();return o.reduce((function(t,n){var o=s.getBlockForKey(n),l=a.a.clearStylesFromBlock({editorState:t,block:o});return null===e?l=w({editorState:l,block:o,styleName:r.a.Unstyled}):e.name!==i&&(l=w({editorState:l,block:o,styleName:e.name})),l}),n)}},amZL:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("OTSC"),l=i("DqjY"),c=i("ee0N"),d=i.n(c),h=i("MseB"),u=i.n(h),p=a.a.View.extend({initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),this.destroy.__debounced=r.a.debounce(this.destroy,0),this.$parent.hasClass("typekit-popup-shown")||(this.template=u.a["template-constructor-helpers-typekit-popup"],this.render(),r.a.defer(this.show))},TOP_POPUP_TRESHOLD:170,render:function(){var t,e;this.setElement(Object(n.a)(this.template({}))),this.$parent.addClass("typekit-popup-shown"),this.$parent.on("mouseleave",this.setPopupTimeout),this.$parent.on("mouseenter",this.resetPopupTimeout),this.$parent.on("click",this.destroy.__debounced),t=Math.round(this.$parent.offset().left+this.$parent.width()/2),e=Math.round(this.$parent.offset().top),this.$el.toggleClass("popup-below",e-this.TOP_POPUP_TRESHOLD<0),Object(n.a)("body").append(this.$el),this.$el.css({left:t,top:e})},show:function(t){this.$el.addClass("shown")},setPopupTimeout:function(){this.$parent.hasClass("typekit-popup-shown")&&(this.popupTimer=setTimeout(this.destroy.__debounced,500))},resetPopupTimeout:function(){clearTimeout(this.popupTimer)},destroy:function(){this.$parent.removeClass("typekit-popup-shown"),this.$parent.off("mouseleave",this.setPopupTimeout),this.$parent.off("mouseenter",this.resetPopupTimeout),this.$parent.off("click",this.destroy.__debounced),clearTimeout(this.popupTimer),this.$el.removeClass("shown"),setTimeout(r.a.bind((function(){this.$el.off().remove()}),this),300)}}),m=i("nnuN"),g=["Assistant","Bitter","Cabin","Catamaran","Caveat","Changa","Cinzel","Comfortaa","Commissioner","Crimson Pro","Cuprum","Dancing Script","Domine","Dosis","EB Garamond","Encode Sans","Epilogue","Exo","Exo 2","Faustina","Fira Code","Grandstander","Grenze Gotisch","Heebo","Hepta Slab","Ibarra Real Nova","Inconsolata","Inter","Josefin Sans","Jost","Jura","Kreon","Kufam","Lemonada","Libre Franklin","Literata","Lora","Manrope","Manuale","Markazi Text","Maven Pro","Merriweather Sans","Mulish","MuseoModerno","Orbitron","Oswald","Oxanium","Petrona","Piazzolla","Playfair Display","Podkova","Public Sans","Quicksand","Raleway","Recursive","Red Rose","Roboto Mono","Roboto Slab","Rokkitt","Rosario","Rubik","Ruda","Sansita Swashed","Signika","Sora","Space Grotesk","Spartan","Syne","Trispace","Varta","Vollkorn","Work Sans","Yanone Kaffeesatz"];function f(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function v(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?f(Object(i),!0).forEach((function(e){b(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):f(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function b(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var y=a.a.View.extend({events:{"click .view-wrapper .grid-view, .view-wrapper .list-view":"switchView","click .size-wrapper .top-letter, .size-wrapper .bottom-letter":"onSizeLetterClick","click .right-panel .providers-switcher li":"switchProvider","click .right-panel .provider-filter .language-wrapper":"toggleLanguage","click .scroll-wrapper.main .results .font-item .list-add-remove-font":"addRemoveFont","mouseenter .scroll-wrapper.main .results .font-item ":"checkAddRemoveState","click .right-panel .font-info .bottom-info .info-add-remove-font":"addRemoveFont","mousedown .scroll-wrapper.main .results .font-item":"onFontItemMouseDown","mousemove .scroll-wrapper.main .results .font-item":"onFontItemMouseMove","mouseup .scroll-wrapper.main .results .font-item":"onFontItemMouseUp","click .scroll-wrapper.main .results .font-item":"openInfo","click .search-icon":"toggleSearch","click .back-icon":"closeInfo","input .search-wrapper .search-string":"onSearchStringChange","keypress .search-wrapper .search-string":"onSearchStringKey","keyup .search-wrapper .search-string":"onSearchStringKey","keydown .search-wrapper .search-string":"onSearchStringKey","click .search-wrapper .clear":"onClearSearchString",click:"closeLanguage","click .filter div":"onFilterItemClick","mouseenter .filter div":"onFilterMouseEnter","mouseleave .filter div":"onFilterMouseLeave"},PAGINATION:4,DATA_URL:window.fontsConfig.fontslist,IMGS_URL:window.fontsConfig.fontsimgs,LANGUAGE_MAP:{cyrillic:"cyrillic",devanagari:"devanagari",greek:"greek",khmer:"khmer",latin:"latin",vietnamese:"vietnamese",ca:"latin",cs:"latin",de:"latin",en:"latin",es:"latin",fr:"latin",it:"latin",nl:"latin",pl:"latin",pt:"latin",ru:"cyrillic",sv:"latin"},LANGUAGE_NAMES:{cyrillic:"Cyrillic",devanagari:"Devanagari",greek:"Greek",khmer:"Khmer",latin:"Latin",vietnamese:"Vietnamese",ab:"Abkhazian",af:"Afrikaans",az:"Azerbaijani",ba:"Bahasa",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",ce:"Chechen",cs:"Czech",cv:"Chuvash",da:"Danish",de:"German",en:"English",eo:"Esperanto",es:"Spanish",et:"Estonian",fi:"Finnish",fr:"French",gd:"Gaelic",gl:"Galician",hr:"Croatian",hu:"Hungarian",is:"Icelandic",it:"Italian",kk:"Kazakh",ku:"Kurdish",ky:"Kyrgyz",lt:"Lithuanian",lv:"Latvian",mt:"Maltese",mn:"Mongolian",nl:"Dutch",no:"Norwegian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",sq:"Albanian",sr:"Serbian",sv:"Swedish",tg:"Tajik",tk:"Turkmen",tr:"Turkish",tt:"Tatar",uk:"Ukrainian",uz:"Uzbek"},FVD_NAMES:m.WEIGHTS,CHARSETS_PRIORITY_FILTER_ON:["cyrillic","greek","vietnamese","devanagari","khmer","latin"],CHARSETS_PRIORITY_FILTER_OFF:["latin","cyrillic","greek","vietnamese","devanagari","khmer"],FVD_PRIORITY_REGULAR:["n4","i4","n3","i3","n5","i5","n2","i2","n6","i6","n1","i1","n7","i7","n8","i8","n9","i9"],FVD_PRIORITY_LIGHT:["n1","i1","n2","i2","n3","i3","n4","i4","n5","i5","n6","i6","n7","i7","n8","i8","n9","i9"],FVD_PRIORITY_HEAVY:["n9","i9","n8","i8","n7","i7","n6","i6","n5","i5","n4","i4","n3","i3","n2","i2","n1","i1"],initialize:function(t){r.a.bindAll(this),this.template=d.a["template-constructor-helpers-font-explorer"],this.itemTemplate=d.a["template-constructor-helpers-font-explorer-item"],this.noFoundTemplate=d.a["template-constructor-helpers-font-explorer-no-found"],this.applyFilter.__debounced=r.a.debounce(this.applyFilter,150),this.loadVisibleFontPreviews.__debounced=r.a.debounce(this.loadVisibleFontPreviews,300)},render:function(){this.setElement(Object(n.a)(this.template({})).insertAfter("#constructor")),this.$mainList=this.$(".scroll-wrapper.main .results-wrapper .results"),this.$infoList=this.$(".scroll-wrapper.info .results-wrapper .results"),this.mainScroll=Object(n.a)(this.$mainList.closest(".scroll-wrapper")).RMScroll({$container:this.$mainList.closest(".results-wrapper"),$content:this.$mainList,$handle:this.$mainList.closest(".scroll-wrapper").find(".scroll"),onScroll:this.onFontsScroll,gap_start:8,gap_end:8}).data("scroll"),this.infoScroll=Object(n.a)(this.$infoList.closest(".scroll-wrapper")).RMScroll({$container:this.$infoList.closest(".results-wrapper"),$content:this.$infoList,$handle:this.$infoList.closest(".scroll-wrapper").find(".scroll"),gap_start:8,gap_end:8}).data("scroll");var t=Object(n.a)(this.$(".size-wrapper .slider"));if(this.sizeSlider=t.slider({min:1,max:7,value:4,orientation:"vertical",start:function(){Object(n.a)("body").addClass("ns-resize-cursor"),t.addClass("dragging")},stop:function(){Object(n.a)("body").removeClass("ns-resize-cursor"),t.removeClass("dragging")},change:this.sizeChanged,slide:this.sizeChanged}),RM.constructorRouter&&RM.constructorRouter.previewMode){var e=Math.round(Math.abs(window.innerHeight-this.$el.height())/2);this.$el.css({position:"fixed","margin-top":0,top:e+"px"})}this.loadFontsData(),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("fontexplorer")})),this.rendered=!0},loadFontsData:function(){var t=this,e=new Date,i=e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear();n.a.ajax({type:"GET",url:this.DATA_URL+"?timestamp="+i+"&callback=?",jsonpCallback:"fontsListCallback",contentType:"application/json",cache:!0,dataType:"jsonp",success:function(e){t.$(".overlay").remove(),e.typetoday=e.typetoday.filter((function(t){return!t.deprecated})).map((function(t){return t.deprecated_variations&&t.deprecated_variations.length?v(v({},t),{},{variations:r.a.difference(t.variations,t.deprecated_variations)}):t})),e.google.forEach((function(t){g.includes(t.family)&&(t.variable="variable")})),t.fontsData=e,t.applyFilter()},error:function(t){console.log(arguments)}})},buildFilter:function(){var t=this.$(".right-panel .providers-switcher li.active").attr("data-name"),e=this.$('.right-panel .provider-filter[data-name="'+t+'"]'),i={},o="";return this.$(".search-icon").hasClass("active")?o=n.a.trim(this.$(".search-wrapper .search-string").val()):e.find(".filter div.active").each((function(){var t=Object(n.a)(this),e=t.parent().attr("data-name"),o=t.attr("data-name");i[e]||(i[e]=[]),i[e].push(o)})),{provider:t,filter:i,search:o}},applyFilter:function(){if(this.fontsData){var t,e,i,n,o=this.buildFilter(),a=o.provider,l=o.filter,c=o.search,d=this.fontsData[a];if(this.$(".search-wrapper .search-string").attr("placeholder","Search "+d.length+" fonts"),JSON.stringify(this.filter)!=JSON.stringify(o)){d=r.a.filter(d,(function(o){for(t in o=o.browse_info?o.browse_info:o,n=!0,l)if(i=l[t],e=r.a.isArray(o[t])?o[t]:[o[t]],!(n=n&&r.a.intersection(i,e).length))return;return n}));var h=r.a.compact(s.default.escapeRegExp(c).split(" ")),u=new RegExp(h.join(".*?"),"i");d=r.a.filter(d,(function(t){var e=t.name||t.family;return u.test(e)})),this.filteredFonts=d,this.filter=o,this.$mainList.empty(),this.mainScroll.recalc()}}},showFilteredFontsPortion:function(){if(this.filteredFonts){var t=this,e=Modernizr.retina?"@2x":"",i=this.$mainList.find(".font-item").length,n=this.filteredFonts.length,o=i,a=Math.min(n-i,this.PAGINATION),l=this.filter.provider,c=this.filter.filter,d=("google"==l?[]:c.weight)||[],h=("google"==l?c.subsets:c.language)||[];if(0!=n){if(0!=a){for(var u=o;u<o+a;u++){var p=this.filteredFonts[u],m=l+"_"+g(p.id||p.family||p.name)+"_"+f("google"==l?p.subsets:p.browse_info?p.browse_info.language:["en"],h)+"_"+v(p.variations,d);this.$mainList.append(this.itemTemplate({img1:m,img2:e+".png?t="+p.lastModified,text:p.name||p.family,name:p.name||p.family,id:p.id||p.name||p.family,styles:p.variations.length,provider:l,Utils:s.default}))}this.mainScroll.recalc()}}else this.$mainList.append(this.noFoundTemplate({}))}function g(t){return t.toLowerCase().split(" ").join("-")}function f(e,i){var n=function(e){for(var i={},n=0;n<e.length;n++)t.LANGUAGE_MAP[e[n]]&&(i[t.LANGUAGE_MAP[e[n]]]=!0);return Object.keys(i)}(e=(e=i.length?r.a.intersection(e,i):e).length?e:["latin"]),o=i.length?t.CHARSETS_PRIORITY_FILTER_ON:t.CHARSETS_PRIORITY_FILTER_OFF;return r.a.intersection(o,n)[0]}function v(e,i){var n,o=(i=i.length?i:["regular"])[0];return"light"==o&&(n=t.FVD_PRIORITY_LIGHT),"regular"==o&&(n=t.FVD_PRIORITY_REGULAR),"heavy"==o&&(n=t.FVD_PRIORITY_HEAVY),r.a.intersection(n,e)[0]}},loadVisibleFontPreviews:function(){var t=this.IMGS_URL+this.$mainList.attr("data-view")+"_",e=this.$mainList.parent().scrollTop(),i=this.$mainList.parent().height();this.$mainList.find(".font-item").each((function(){var o=Object(n.a)(this),a=t+o.attr("data-img1")+o.attr("data-img2");if(!o.attr("data-loaded")){var r=o.height(),s=o.position().top;s+r>e&&s<i+e&&(o.css("background-image",'url("'+a+'")'),o.attr("data-loaded",!0))}}))},onFontsScroll:function(t){t.content_size-t.container_size-t.scroll_pos<100&&this.showFilteredFontsPortion(),this.loadVisibleFontPreviews.__debounced()},switchView:function(t){var e=Object(n.a)(t.target);if(!e.hasClass("active")){e.addClass("active").siblings().removeClass("active");var i,o=this.$mainList.parent().scrollTop(),a=0;this.$mainList.find(".font-item").each((function(){if(i=Object(n.a)(this),(a=i.position().top-o)>=0)return!1})),this.$mainList.attr("data-view",e.attr("data-name")),this.$mainList.find(".font-item").removeAttr("data-loaded").css("background-image",""),this.mainScroll.recalc(),this.$mainList.parent().scrollTop(i.position().top-a)}},switchProvider:function(t){var e=Object(n.a)(t.target);e.hasClass("active")||(e.addClass("active").siblings().removeClass("active"),this.$(".provider-filter").addClass("invisible"),this.$('.provider-filter[data-name="'+e.attr("data-name")+'"]').removeClass("invisible"),this.applyFilter())},onFilterItemClick:function(t){var e=Object(n.a)(t.target),i=e.closest(".filter"),o=!!(i.attr("data-multiple")-0);e.attr("data-name")&&(e.toggleClass("active"),o||e.siblings("div").removeClass("active"),i.hasClass("language")&&this.updateLangs(i),this.applyFilter())},sizeChanged:function(t,e){this.$mainList.attr("data-size",e.value),this.mainScroll.recalc(),this.$infoList.attr("data-size",e.value),this.infoScroll.recalc()},onSearchStringKey:function(t){if(t.stopPropagation(),t.keyCode==n.a.keycodes.esc&&t.preventDefault(),"keyup"==t.type){if(t.keyCode==n.a.keycodes.esc)return void(""!=this.$(".search-wrapper .search-string").val()?this.clearSearchString():this.toggleSearch());t.keyCode==n.a.keycodes.enter&&(t.preventDefault(),this.applyFilter())}},onSearchStringChange:function(){var t=this.$(".search-wrapper .search-string").val();this.$(".search-wrapper .clear").toggleClass("invisible",""==t),this.applyFilter.__debounced()},clearSearchString:function(){this.$(".search-wrapper .search-string").blur().val("").focus(),this.onSearchStringChange()},onClearSearchString:function(){this.clearSearchString(),this.toggleSearch()},toggleSearch:function(){clearTimeout(this.searchFocusTimeout),this.$(".search-icon").toggleClass("active"),this.$(".search-wrapper").toggleClass("shift-down"),this.$(".scroll-wrapper.main").toggleClass("shift-down"),this.$(".search-icon").hasClass("active")?this.searchFocusTimeout=setTimeout(r.a.bind((function(){this.$(".search-wrapper .search-string").focus()}),this),700):s.default.getFocusBack(),this.applyFilter(),setTimeout(function(){this.mainScroll.recalc()}.bind(this),300)},addRemoveFont:function(t){t.stopPropagation();var e=Object(n.a)(t.target).closest(".font-item, .info-add-remove-font"),i=e.hasClass("removable")?"remove":"add",o=e.attr("data-font-provider"),a=e.attr("data-font-id"),s=e.attr("data-font-name"),l={};"typekit"==o&&(l={id:a}),"webtype"==o&&(l={name:a}),"google"==o&&(l={family:a}),"typetoday"==o&&(l={name:a});var c=r.a.findWhere(this.fontsData[o],l);"remove"==i?RM.constructorRouter.fonts.removeFonts([a]):RM.constructorRouter.fonts.addFonts([{provider:o,css_name:a,name:s,variations:c.variations,temporary:!0}],"font-explorer").error&&new p({$parent:e.hasClass("font-item")?e.find(".list-add-remove-font"):e});this.checkAddRemoveState(e),RM.analytics&&RM.analytics.sendEvent("Font Explorer Add/Remove from Library",i)},checkAddRemoveState:function(t){var e=Object(n.a)(t.target||t),i=RM.constructorRouter.fonts.getUsedFontsCache()[e.attr("data-font-id")],o=i&&!i.hidden;e.toggleClass("removable",!!o),e.hasClass("info-add-remove-font")&&e.text(o?"Remove from Font Selector":"Add to Font Selector")},closeInfo:function(){this.$(".font-explorer-wrapper").removeClass("info-mode")},onFontItemMouseDown:function(){this.fontItemMouseDown=!0},onFontItemMouseMove:function(){this.fontItemMouseDown&&(this.preventFontItemClick=!0)},onFontItemMouseUp:function(){this.fontItemMouseDown=!1},openInfo:function(t){if(this.preventFontItemClick)this.preventFontItemClick=!1;else{var e=Object(n.a)(t.target).closest(".font-item");this.$(".font-explorer-wrapper").addClass("info-mode"),this.$infoList.empty();var i=this,o=e.attr("data-font-provider"),a=e.attr("data-font-id"),c=e.attr("data-font-name"),d={};"typekit"==o&&(d={id:a}),"webtype"==o&&(d={name:a}),"google"==o&&(d={family:a}),"typetoday"==o&&(d={name:a});var h,u,p,m=r.a.findWhere(this.fontsData[o],d),g="google"==o?"Google Fonts":m.foundry,f="google"==o?"http://www.google.com/fonts/specimen/"+c.split(" ").join("+"):m.web_link,v=m.description,b=m.variations,y=e.attr("data-img1"),_=e.attr("data-img2"),w=Object(n.a)('<a target="_blank" href="'+m.web_link+'">More...</a>');u=m.subsets||m.browse_info&&m.browse_info.language||[],u=r.a.map(u,(function(t){return s.default.capitalize(i.LANGUAGE_NAMES[t]||t)}));for(var k=Object(n.a)(".font-info .language-wrapper .language"),S=Object(n.a)(".font-info .language-clamp"),x=u.length;x>0&&(h=u.slice(0,x).join(", "),!(x==u.length&&(S.empty().text(h),S.height()<=k.height())))&&(S.empty().text(h+", ").append(w),!(S.height()<=k.height()));x--);p=m.browse_info&&m.browse_info.recommended_for||[],p=(p=r.a.map(p,(function(t){return s.default.capitalize(i.LANGUAGE_NAMES[t]||t)}))).join(" & ");for(x=0;x<b.length;x++){var C=Object(n.a)(this.itemTemplate({img1:"",img2:"",text:l.a.getCustomVariationNameByFVD(m.name,b[x])||this.FVD_NAMES[b[x]],name:"",id:"",styles:"",provider:"",Utils:s.default})),O=this.IMGS_URL+"list_"+y.substr(0,y.length-2)+b[x]+_;C.css("background-image",'url("'+O+'")'),this.$infoList.append(C),C.attr("data-loaded",!0)}this.infoScroll.recalc();var j=this.$(".right-panel .font-info"),P=Object(n.a)(".bottom-info .info-add-remove-font",j);Object(n.a)(".name",j).text(c),Object(n.a)(".foundry",j).toggleClass("hidden",!g),Object(n.a)(".foundry a",j).text(g).attr("href",f),Object(n.a)(".description-wrapper",j).toggleClass("hidden",!v),Object(n.a)(".description-wrapper .description",j).text(v),Object(n.a)(".description-wrapper .more",j).attr("href",f),Object(n.a)(".language-wrapper",j).toggleClass("hidden",!h),Object(n.a)(".recommended-wrapper",j).toggleClass("hidden",!p),Object(n.a)(".recommended-wrapper .recommended",j).text(p),Object(n.a)(".promo",j).toggleClass("hidden","typetoday"!==o),Object(n.a)(".promo a",j).attr("href",m.web_link);var E=Object(n.a)(".description-wrapper .description",j);Object(n.a)(".description-wrapper",j).toggleClass("huge",E.height()==parseInt(E.css("max-height"),10)),P.attr("data-font-provider",o).attr("data-font-id",a).attr("data-font-name",c),this.checkAddRemoveState(P)}},toggleLanguage:function(t){var e=Object(n.a)(t.currentTarget);Object(n.a)(t.target).closest(".filter.language").length||e.toggleClass("active")},closeLanguage:function(t){Object(n.a)(t.target).closest(".language-wrapper").length||this.$(".language-wrapper").removeClass("active")},updateLangs:function(t){var e=t.find("div.active"),i=[];e.each((function(){i.push(Object(n.a)(this).text())})),t.closest(".language-wrapper").find(".caption").text(i.length?i.join(", "):"Language Support")},onFilterMouseEnter:function(t){var e=Object(n.a)(t.target);if(e.attr("data-alt")){var i=e.parent().prevAll(".filter-caption").first();i.text(e.attr("data-alt")),clearTimeout(i.data("clear-timer"))}},onFilterMouseLeave:function(t){var e=Object(n.a)(t.target);if(e.attr("data-alt")){var i=e.parent().prevAll(".filter-caption").first();i.data("clear-timer",setTimeout((function(){i.text(i.attr("data-initial"))}),100))}},onSizeLetterClick:function(t){var e=Object(n.a)(t.target),i=this.sizeSlider.slider("value"),o=e.hasClass("top-letter")?1:-1;this.sizeSlider.slider("value",i+o)},onBodyKey:function(t){this.$(".search-input").is(":focus")||(t.keyCode!=n.a.keycodes.esc&&t.keyCode!=n.a.keycodes.backspace||(t.preventDefault(),t.stopPropagation()),"keyup"==t.type&&(t.keyCode==n.a.keycodes.esc&&(this.$(".font-explorer-wrapper").hasClass("info-mode")?this.closeInfo():this.hide()),t.keyCode==n.a.keycodes.backspace&&(this.$(".font-explorer-wrapper").hasClass("info-mode")?this.closeInfo():this.hide()),t.keyCode==n.a.keycodes.f&&this.toggleSearch()))},onMouseWheel:function(t){t&&t.stopPropagation(),t&&t.preventDefault()},disableMouseWheel:function(){Object(n.a)(document).bind("mousewheel",this.onMouseWheel)},enableMouseWheel:function(){Object(n.a)(document).unbind("mousewheel",this.onMouseWheel)},show:function(){if(!this.rendered)return this.render(),void r.a.defer(this.show);this.disableMouseWheel(),this.$block_layer=RM.constructorRouter.showBlockLayer(this.hide),this.$el.removeClass("show-out").addClass("show-in").css("display","block"),setTimeout(r.a.bind((function(){this.$el.removeClass("show-in")}),this),20),setTimeout(r.a.bind((function(){this.$el.css("width","+=1")}),this),300),setTimeout(r.a.bind((function(){this.$el.css("width","-=1")}),this),300),Object(n.a)("body").on("keypress keyup keydown",this.onBodyKey),this.shown=!0},hide:function(t){t&&t.stopPropagation(),this.enableMouseWheel(),RM.constructorRouter.hideBlockLayer(this.$block_layer),Object(n.a)("body").off("keypress keyup keydown",this.onBodyKey),this.$el.addClass("show-out"),setTimeout(r.a.bind((function(){this.$el.css("display","none")}),this),200),s.default.getFocusBack(),this.$(".language-wrapper").removeClass("active"),RM.constructorRouter.fonts.clearTempFonts(),this.shown=!1},toggle:function(){this.shown?this.hide():this.show(),this.trigger("toggle")}}),_=i("o3C3"),w=i.n(_),k=i("YqYG");RM.views.fontExplorer=new y;var S=a.a.View.extend({name:"FontSelector",initialize:function(t){this.model=RM.constructorRouter.fonts,this.settings={},this.old_fonts=[],r.a.bindAll(this),r.a.extend(this.settings,t),this.mag=RM.constructorRouter.mag.toJSON(),this.settings.canUploadFonts=RM.constructorRouter.isOwner?(RM.constructorRouter.me.get("permissions")||{}).can_use_custom_fonts:this.mag.user.permissions.can_use_custom_fonts,this.settings.canEditCustomFonts=this.mag.doesUserHaveAccess,this.template=w.a["template-constructor-helpers-font-selector"],this.item_template=w.a["template-constructor-helpers-font-selector-item"],this.create()},create:function(){this.render(),this.switchToCategory(this.model.get("fonts_tab")||"custom"),this.model.on("change:fonts",this.onFontsChange)},render:function(){var t=this.settings.css&&this.settings.css.left||0,e=this.settings.css&&this.settings.css.top||0;this.setElement(Object(n.a)(this.template({})).css({display:"none",left:t,top:e})),this.settings.$parent.append(this.$el),this.$addFontPopup=this.$(".add-font-popup"),this.$el.on("click",".tabs-switcher .caption-system",r.a.bind((function(){this.switchToCategory("system"),RM.analytics&&RM.analytics.sendEvent("Font Selector Switch to Category","system")}),this)),this.$el.on("click",".tabs-switcher .caption-custom",r.a.bind((function(){this.switchToCategory("custom"),RM.analytics&&RM.analytics.sendEvent("Font Selector Switch to Category","custom")}),this)),this.$el.on("click",this.onGlobalClickHandler),this.$el.on("mouseenter",".category-element .caption",this.checkTitleShowForLongFontName),this.$el.on("click",".category-element .edit-custom-font",this.onEditCustomFontClick),this.$el.on("click",".add-font-button",this.onAddFontButtonClick),this.onFontsChange(),this.scroll={system:this.createScroll("system"),custom:this.createScroll("custom")},this.settings.canEditCustomFonts||this.$(".add-font-button[data-type=upload]").remove()},onFontsChange:function(){var t=this.old_fonts,e=this.model.get("fonts"),i=r.a.map(t,(function(t){return t.provider+"|"+t.css_name})),o=r.a.map(e,(function(t){return t.provider+"|"+t.css_name})),a=this;clearTimeout(this.reinitTimeout);var s=r.a.difference(o,i),l=r.a.difference(i,o),c=r.a.intersection(i,o);r.a.each(s,(function(t){var e=t.split("|"),i=e[0],o=e[1],r=a.$(".categories .scroll-wrapper."+("system"==i?"system":"custom")+" .category"),s=a.model.findFontByCSSName(o),l=a.model.getProviderData(i),c=Object(n.a)(a.item_template({provider_data:l,font:s,canUploadFonts:a.settings.canUploadFonts,canEditCustomFonts:a.settings.canEditCustomFonts})).addClass("collapsed");if(setTimeout((function(){c.removeClass("collapsed")}),15),0==r.find(".category-element").length)c.appendTo(r);else{var d=!1;r.find(".category-element").each((function(){var t=Object(n.a)(this);if(t.find(".caption").text().toLowerCase()>s.name.toLowerCase())return c.insertBefore(t),d=!0,!1})),d||c.appendTo(r)}})),r.a.each(l,(function(t){var e=t.split("|"),i=e[0],n=e[1],o=a.$(".categories .scroll-wrapper."+("system"==i?"system":"custom")+" .category"),r=(a.model.findFontByCSSName(n),a.model.getProviderData(i),o.find('.category-element[data-provider="'+i+'"][data-css_name="'+n+'"]'));r.addClass("collapsed"),setTimeout((function(){r.remove()}),300)})),r.a.each(c,(function(t){var e=t.split("|"),i=e[0],n=e[1],o=a.$(".categories .scroll-wrapper."+("system"==i?"system":"custom")+" .category"),r=a.model.findFontByCSSName(n),s=o.find('.category-element[data-provider="'+i+'"][data-css_name="'+n+'"]');s.toggleClass("hidden",!!r.hidden).find(".caption").text(r.name),r.hidden&&s.removeClass("active")})),this.old_fonts=r.a.cloneWithObjects(e),this.reinitTimeout=setTimeout(this.reinitScrolls,250)},checkTitleShowForLongFontName:function(t){var e=t.currentTarget,i=Object(n.a)(e);e.offsetWidth<e.scrollWidth&&!i.attr("title")&&i.attr("title",i.text())},onEditCustomFontClick:function(t){var e=Object(n.a)(t.currentTarget).closest(".category-element").attr("data-css_name"),i=this.model.get("fonts"),o=r.a.findWhere(i,{css_name:e});this.showFontUploadPanel(o),RM.analytics&&RM.analytics.sendEvent("Font Selector Edit Custom Font")},scrollFontsToActive:function(t,e){var i=this.$(".categories .scroll-wrapper."+t),n=this.$(".categories .scroll-wrapper."+t+" .category-wrapper"),o=n.find(".category-element.active").eq(0),a=!0;if(1==o.length){i.is(":visible")||(i.css("display","block"),a=!1);var r=o.position().top,s=o.height(),l=n.height(),c=Math.floor(r-(l-s)/2);a?n.stop().animate({scrollTop:c},e):(n.stop().scrollTop(c),i.css("display","none"))}},reinitScrolls:function(){r.a.each(this.scroll,(function(t){t.recalc()}))},createScroll:function(t){var e=Object(n.a)(this.$(".categories .scroll-wrapper."+t));return e.RMScroll({$container:e.find(".category-wrapper"),$content:e.find(".category-wrapper .category"),$handle:e.find(".scroll"),gap_start:8,gap_end:8}).data("scroll")},onGlobalClickHandler:function(t){var e=Object(n.a)(t.target),i=e.closest(".category-element"),o=i.attr("data-css_name");if(e.hasClass("action")&&e.parent().hasClass("category-element")){var a,r;!RM.constructorRouter.isOwner&&this.settings.canEditCustomFonts&&(a=this.mag.user._id,r=this.mag.num_id),this.model.changeFontHidden(o,!i.hasClass("hidden"),a,r).error&&new p({$parent:e});var s=i.hasClass("hidden")?"delete":"restore";RM.analytics&&RM.analytics.sendEvent("Font Selector Edit List",s)}if(e.hasClass("caption")&&e.parent().hasClass("category-element")){if(i.hasClass("disabled"))return void(i.hasClass("personal")&&this.showUpgradeAlert({type:"type-upload-fonts"},"use custom font"));this.setActiveFont([o]),this.trigger("selectfont",o)}this.isAddFontPopupVisible&&!e.closest(".add-font").length&&this.toggleAddFontPopup()},setActiveFont:function(t,e){this.$(".categories .category-element").removeClass("active"),r.a.each(t,r.a.bind((function(t){this.$('.categories .category-element[data-css_name="'+t+'"]').addClass("active")}),this)),void 0!==e&&(this.scrollFontsToActive("system",e),this.scrollFontsToActive("custom",e))},show:function(t){this._initialTab=this.model.get("fonts_tab"),this._initialFonts=this.model.get("fonts"),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("fontselector")})),this.$el.fadeIn(150),this.setActiveFont(t,0),this.reinitScrolls(),RM.analytics&&RM.analytics.sendEvent("Font Selector Show")},hide:function(t){this.$el.fadeOut(150),(this._initialTab||this._initialFonts)&&(r.a.isEqual(this.model.get("fonts_tab"),this._initialTab)&&r.a.isEqual(this.model.get("fonts"),this._initialFonts)||this.model.save({},{silent:!0}))},switchToCategory:function(t){"system"!=t&&"custom"!=t&&(t="custom"),this.model.set({fonts_tab:t},{silent:!0}),this.$(".tabs-switcher .caption-"+t).addClass("active").siblings().removeClass("active"),"system"==t?this.$(".add-font").stop().fadeOut():this.$(".add-font").stop().fadeIn();var e=this.$(".categories > div:visible").eq(0),i=this.$(".categories .scroll-wrapper."+t);if(!e.is(i)){if(0==e.length)i.css("display","block");else{var n=e.index()<i.index()?1:-1;i.css({display:"block",opacity:0,"margin-left":8*n}).animate({opacity:1,"margin-left":0},300),e.animate({opacity:0,"margin-left":-8*n},300,(function(){this.setAnimation=!1,e.css("display","none")}))}this.reinitScrolls()}},toggleAddFontPopup:function(){this.$addFontPopup.toggleClass("invisible",!!this.isAddFontPopupVisible),this.isAddFontPopupVisible=!this.isAddFontPopupVisible},onAddFontButtonClick:function(t){switch(Object(n.a)(t.currentTarget).attr("data-type")){case"library":this.toggleFontExplorer();break;case"upload":this.canUploadFonts()&&this.showFontUploadPanel()}},canUploadFonts:function(){return this.settings.canUploadFonts||this.showUpgradeAlert({type:"type-upload-fonts"},"upload font"),this.settings.canUploadFonts},showUpgradeAlert:function(t,e){r.a.extend(t,{is_contributor:!RM.constructorRouter.isOwner,owner_email:RM.constructorRouter.mag.get("user").email}),this.alertDuplicate=this.alertDuplicate||new k.default({$parent:Object(n.a)("body > .popups"),router:RM.constructorRouter,opts:t,alert_source:e}),this.alertDuplicate.render()},toggleFontExplorer:function(){RM.views.fontExplorer.toggle()},showFontUploadPanel:function(t){var e=this.$(".upload-font");this.fontUploader=new x({el:e,allFonts:this.model,fontParams:t,mag:this.mag}),this.fontUploader.show(),this.listenTo(this.fontUploader,"hide-font",function(t){var e=t.css_name;this.$(".category-element[data-css_name="+e+"]").find(".action").click()}.bind(this)),this.listenTo(this.fontUploader,"update-font",function(t){var e=t.css_name;this.trigger("selectfont",e)}.bind(this)),this.listenToOnce(this.fontUploader,"hide",function(){this.stopListening(this.fontUploader),this.fontUploader=null,this.isFontUploaderVisible=!1}.bind(this)),this.isFontUploaderVisible=!0},handleEscape:function(){return this.isFontUploaderVisible&&this.fontUploader.handleEscape()||!this.isFontUploaderVisible},destroy:function(){this.fontuploader&&this.fontuploader.remove(),this.fontuploader=null,this.model.off("change:fonts",this.onFontsChange),this.hide(),this.$el.remove()}}),x=a.a.View.extend({className:"upload-font",template:w.a["template-constructor-helpers-font-selector-upload"],templateWeights:w.a["template-constructor-helpers-font-selector-upload-weights"],events:{"keydown .font-name-input":"onFontNameKeydown","input .font-name-input":"onFontNameInput","click .uf-section.actions .done:not(.disabled)":"hide","click .button.add-weight:not(.disabled)":"onAddWeightClick","click .weight-item:not(.disabled)":"onWeightItemClick","click .button.select":"onSelectButtonClick","click .uf-panel.weights .delete-weight":"onDeleteWeightClick"},WEIGTS:m.WEIGHTS,SAVE_URL:"/api/customfonts",initialize:function(t){r.a.bindAll(this),r.a.extend(this,t);var e=a.a.Model.extend({urlRoot:this.SAVE_URL,idAttribute:"_id",defaults:{is_personal:!0}});t.fontParams=t.fontParams||{};var i=r.a.omit(t.fontParams,"variations"),n=r.a.map(t.fontParams.variations||[],(function(t){return{type:t}}));this.isNew=r.a.isEmpty(i),this.model=new e(i||{}),this.weights=new a.a.Collection(n),this.weights.comparator=function(t){var e=t.get("type");return e.slice(1)+e[0].replace("n","1").replace("i","2")},this.weights.sort()},render:function(t){this.$el.html(Object(n.a)(this.template(this.model.toJSON()))),this.$buttonAddWeight=this.$(".button.add-weight"),this.$buttonSelect=this.$(".button.select"),this.$buttonUpload=this.$(".button.upload"),this.$buttonDone=this.$(".uf-section.actions .done"),this.$fileUploader=Object(n.a)("#font-file-upload"),this.listenTo(this.weights,"add remove",this.renderVariations),this.listenTo(this.weights,"change",this.updateVariation),this.bindMainFileupload();var e=Object(n.a)(this.$(".uf-panel.weights .scroll-wrapper"));this.weightScroll=e.RMScroll({$container:e.find(".results-wrapper"),$content:e.find(".results"),$handle:e.find(".scroll"),gap_start:8,gap_end:88}).data("scroll"),this.renderVariations()},renderVariations:function(){this.$(".uf-panel.weights .list").html(this.templateWeights({weights:this.weights.toJSON(),names:this.WEIGTS,isUploadInProgress:r.a.findWhere(this.weights,{isUploading:!0}),_:r.a})),this.updateWeightSelector(),this.bindWeightFileuploads(),this.weightScroll.recalc()},updateVariation:function(t){var e=t.get("type"),i=this.$(".uf-panel.weights .weight[data-type="+e+"]");i.find(".name").text(this.WEIGTS[e]),i.find(".reupload-weight").toggleClass("animate",!!t.get("isUploading")),this.$(".delete-weight").toggleClass("disabled",!!t.get("isUploading")),this.$(".uf-panel.weights .list").toggleClass("uploading",!!t.get("isUploading")),this.$buttonAddWeight.toggleClass("disabled",!!t.get("isUploading"))},updateWeightSelector:function(){r.a.each(r.a.keys(this.WEIGTS),function(t){var e=!!this.weights.findWhere({type:t});this.$(".weight-item[data-var="+t+"]").toggleClass("disabled",e)}.bind(this))},bindMainFileupload:function(){Object(n.a)(this.$fileUploader).fileupload({dataType:"json",fileInput:this.$fileUploader,paramName:"upload",dropZone:this.$el,singleFileUploads:!0,acceptFileTypes:/(\.|\/)(woff)$/i,pasteZone:null,add:this.onUploadAdd,start:this.onUploadStart,done:this.onUploadDone,fail:this.onUploadFail,always:this.onUploadComplete}).bind("fileuploaddragover",function(t){if("uploader"!==this.currentPanel)return!1;clearTimeout(this.dragoverTimeout),this.dragoverTimeout=setTimeout(function(){this.$el.removeClass("file-dragover")}.bind(this),300),this.$el.hasClass("file-dragover")||this.$el.addClass("file-dragover")}.bind(this)).bind("fileuploaddrop",function(t,e){if("uploader"!==this.currentPanel)return!1}.bind(this))},bindWeightFileuploads:function(){this.reUploadXHR&&this.reUploadXHR.abort(),Object(n.a)(this.$(".uf-panel.weights .font-file-re-upload")).fileupload({dataType:"json",fileInput:this.$buttons,paramName:"upload",singleFileUploads:!0,acceptFileTypes:/(\.|\/)(woff)$/i,pasteZone:null,add:this.onReuploadEvent,start:this.onReuploadEvent,done:this.onReuploadEvent,fail:this.onReuploadEvent,always:this.onReuploadEvent})},onReuploadEvent:function(t,e){var i=Object(n.a)(t.target).closest(".weight").attr("data-type"),o=this.weights.findWhere({type:i});if(o)switch(t.type){case"fileuploadadd":if(!this.checkFile(e))return;this.reUploadXHR=e.submit();break;case"fileuploadstart":o.set("isUploading",!0);break;case"fileuploaddone":o.set("woff",e.result.woffUrl),this.saveFont();break;case"fileuploadalways":o.set("isUploading",!1)}},onUploadAdd:function(t,e){this.checkFile(e)&&(this.uploadXHR=e.submit())},checkFile:function(t){return/\.woff$/i.test((t.files||[{}])[0].name)},onUploadStart:function(t,e){var i=new a.a.Model({type:this.selectedVar});this.weights.add(i),i.set("isUploading",!0),this.switchToPanel("weights"),this.$buttonAddWeight.addClass("disabled"),RM.analytics&&RM.analytics.sendEvent("Font Selector Custom Font Panel Upload Weight")},onUploadDone:function(t,e){this.weights.findWhere({type:this.selectedVar}).set("woff",e.result.woffUrl),this.saveFont()},onUploadFail:function(t,e){var i=this.weights.findWhere({type:this.selectedVar});this.weights.remove(i)},onUploadComplete:function(t,e){var i=this.weights.findWhere({type:this.selectedVar});i&&i.set("isUploading",!1),this.$buttonAddWeight.removeClass("disabled")},show:function(){Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("fontuploader")})),this.render(),this.switchToPanel("weights"),this.onFontNameInput(),r.a.defer(function(){this.$el.removeClass("invisible"),r.a.delay(function(){this.isNew&&this.$(".font-name-input").focus(),this.weightScroll.recalc()}.bind(this),200)}.bind(this)),RM.analytics&&RM.analytics.sendEvent("Font Selector Show Custom Font Panel")},hide:function(t){this.uploadXHR&&this.uploadXHR.abort(),this.reUploadXHR&&this.reUploadXHR.abort(),this.$el.addClass("invisible"),this.undelegateEvents(),r.a.delay(function(){this.$el.empty(),this.trigger("hide")}.bind(this),200)},onFontNameKeydown:function(t){var e=this.$(".font-name-input").val().trim();t.keyCode==n.a.keycodes.enter&&e&&e!==this.model.get("name")&&this.saveFont()},onFontNameInput:function(){var t=this.$(".font-name-input").val().trim();this.$(".uf-section.weight-list").toggleClass("invisible",!t),this.$buttonDone.toggleClass("disabled",!t)},switchToPanel:function(t){this.currentPanel=t,this.$(".uf-panel."+t).removeClass("invisible").siblings(".uf-panel").addClass("invisible")},hidePanel:function(t){this.$(".uf-panel"+t).removeClass("invisible").siblings(".uf-panel").addClass("invisible")},onAddWeightClick:function(){this.switchToPanel("selector")},onWeightItemClick:function(t){var e=Object(n.a)(t.currentTarget);this.selectedVar=e.attr("data-var"),this.$buttonSelect.text(this.WEIGTS[this.selectedVar]),this.switchToPanel("uploader"),RM.analytics&&RM.analytics.sendEvent("Font Selector Custom Font Panel Select Weight",this.WEIGTS[this.selectedVar])},onSelectButtonClick:function(t){this.switchToPanel("selector")},onDeleteWeightClick:function(t){var e=Object(n.a)(t.currentTarget).closest(".weight"),i=e.attr("data-type"),o=this.weights.findWhere({type:i});if(!e.hasClass("uploading"))return!this.isNew&&this.weights.length<2?(this.model.get("hidden")||this.trigger("hide-font",{css_name:this.model.get("css_name")}),void this.hide()):void r.a.defer(function(){this.weights.remove(o),this.saveFont()}.bind(this));this.uploadXHR&&this.uploadXHR.abort()},handleEscape:function(){return"weights"!==this.currentPanel?this.switchToPanel("weights"):this.hide(),!1},saveFont:function(){var t=this.$(".font-name-input"),e=t.val().trim()||this.model.get("name"),i=this.weights.map((function(t){return r.a.pick(t.toJSON(),"type","woff")}));if(e&&i.length){var n={name:e,variations:i,is_personal:!0};!RM.constructorRouter.isOwner&&this.mag.doesUserHaveAccess&&(n.mag_user=this.mag.user._id,n.mag_num_id=this.mag.num_id),this.model.save(n,{url:this.SAVE_URL,success:function(e){this.isNew=!1;var i=r.a.pluck(e.get("variations"),"type");this.weights.reset(e.get("variations")),t.val(e.get("name"));var n=this.model.get("css_name");this.allFonts.addFonts([{provider:"custom",css_name:n,css_url:this.model.get("css_url"),signed_css_url:this.model.get("signed_css_url"),name:this.model.get("name"),variations:i,is_personal:!0,_id:this.model.get("_id")}],"font-upload"),this.trigger("update-font",{css_name:n})}.bind(this)})}},destroy:function(){}});e.a=S},avvt:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("Rh5U"),l=i.n(s),c=i("0sUV"),d=i("OTSC"),h=i("f3SV"),u=i("DqjY"),p=i("3eHG"),m=i("5ta/"),g=i("rVpV"),f=i("roQd"),v=i("pFlR"),b=i("38JW"),y=i("v92f"),_=i("gdoY"),w=i("HwMs"),k=i("ubkq"),S=i.n(k),x=i("QNiq"),C=i("I0kf"),O=i("phNm"),j=i("3ED2"),P=i.n(j),E=i("+IKJ"),I=i("Xjjk"),T=i.n(I),M=i("jfjY"),$=i("BrCd"),A=i.n($),R=i("Fi5S"),D=function(t,e){return new Intl.NumberFormat(window.navigator.language||"en-US",{style:"currency",currency:e}).format(t)},B=[{value:"AF",caption:"Afghanistan"},{value:"AX",caption:"Aland Islands"},{value:"AL",caption:"Albania"},{value:"DZ",caption:"Algeria"},{value:"AS",caption:"American Samoa"},{value:"AD",caption:"Andorra"},{value:"AO",caption:"Angola"},{value:"AI",caption:"Anguilla"},{value:"AQ",caption:"Antarctica"},{value:"AG",caption:"Antigua and Barbuda"},{value:"AR",caption:"Argentina"},{value:"AM",caption:"Armenia"},{value:"AW",caption:"Aruba"},{value:"AU",caption:"Australia"},{value:"AT",caption:"Austria"},{value:"AZ",caption:"Azerbaijan"},{value:"BS",caption:"Bahamas"},{value:"BH",caption:"Bahrain"},{value:"BD",caption:"Bangladesh"},{value:"BB",caption:"Barbados"},{value:"BY",caption:"Belarus"},{value:"BE",caption:"Belgium"},{value:"BZ",caption:"Belize"},{value:"BJ",caption:"Benin"},{value:"BM",caption:"Bermuda"},{value:"BT",caption:"Bhutan"},{value:"BO",caption:"Bolivia, Plurinational State of"},{value:"BQ",caption:"Bonaire, Sint Eustatius and Saba"},{value:"BA",caption:"Bosnia and Herzegovina"},{value:"BW",caption:"Botswana"},{value:"BV",caption:"Bouvet Island"},{value:"BR",caption:"Brazil"},{value:"IO",caption:"British Indian Ocean Territory"},{value:"BN",caption:"Brunei Darussalam"},{value:"BG",caption:"Bulgaria"},{value:"BF",caption:"Burkina Faso"},{value:"BI",caption:"Burundi"},{value:"KH",caption:"Cambodia"},{value:"CM",caption:"Cameroon"},{value:"CA",caption:"Canada"},{value:"CV",caption:"Cape Verde"},{value:"KY",caption:"Cayman Islands"},{value:"CF",caption:"Central African Republic"},{value:"TD",caption:"Chad"},{value:"CL",caption:"Chile"},{value:"CN",caption:"China"},{value:"CX",caption:"Christmas Island"},{value:"CC",caption:"Cocos (Keeling) Islands"},{value:"CO",caption:"Colombia"},{value:"KM",caption:"Comoros"},{value:"CG",caption:"Congo"},{value:"CD",caption:"Congo, the Democratic Republic of the"},{value:"CK",caption:"Cook Islands"},{value:"CR",caption:"Costa Rica"},{value:"CI",caption:"Côte d'Ivoire"},{value:"HR",caption:"Croatia"},{value:"CU",caption:"Cuba"},{value:"CW",caption:"Curaçao"},{value:"CY",caption:"Cyprus"},{value:"CZ",caption:"Czech Republic"},{value:"DK",caption:"Denmark"},{value:"DJ",caption:"Djibouti"},{value:"DM",caption:"Dominica"},{value:"DO",caption:"Dominican Republic"},{value:"EC",caption:"Ecuador"},{value:"EG",caption:"Egypt"},{value:"SV",caption:"El Salvador"},{value:"GQ",caption:"Equatorial Guinea"},{value:"ER",caption:"Eritrea"},{value:"EE",caption:"Estonia"},{value:"ET",caption:"Ethiopia"},{value:"FK",caption:"Falkland Islands (Malvinas)"},{value:"FO",caption:"Faroe Islands"},{value:"FJ",caption:"Fiji"},{value:"FI",caption:"Finland"},{value:"FR",caption:"France"},{value:"GF",caption:"French Guiana"},{value:"PF",caption:"French Polynesia"},{value:"TF",caption:"French Southern Territories"},{value:"GA",caption:"Gabon"},{value:"GM",caption:"Gambia"},{value:"GE",caption:"Georgia"},{value:"DE",caption:"Germany"},{value:"GH",caption:"Ghana"},{value:"GI",caption:"Gibraltar"},{value:"GR",caption:"Greece"},{value:"GL",caption:"Greenland"},{value:"GD",caption:"Grenada"},{value:"GP",caption:"Guadeloupe"},{value:"GU",caption:"Guam"},{value:"GT",caption:"Guatemala"},{value:"GG",caption:"Guernsey"},{value:"GN",caption:"Guinea"},{value:"GW",caption:"Guinea-Bissau"},{value:"GY",caption:"Guyana"},{value:"HT",caption:"Haiti"},{value:"HM",caption:"Heard Island and McDonald Islands"},{value:"VA",caption:"Holy See (Vatican City State)"},{value:"HN",caption:"Honduras"},{value:"HK",caption:"Hong Kong"},{value:"HU",caption:"Hungary"},{value:"IS",caption:"Iceland"},{value:"IN",caption:"India"},{value:"ID",caption:"Indonesia"},{value:"IR",caption:"Iran, Islamic Republic of"},{value:"IQ",caption:"Iraq"},{value:"IE",caption:"Ireland"},{value:"IM",caption:"Isle of Man"},{value:"IL",caption:"Israel"},{value:"IT",caption:"Italy"},{value:"JM",caption:"Jamaica"},{value:"JP",caption:"Japan"},{value:"JE",caption:"Jersey"},{value:"JO",caption:"Jordan"},{value:"KZ",caption:"Kazakhstan"},{value:"KE",caption:"Kenya"},{value:"KI",caption:"Kiribati"},{value:"KP",caption:"Korea, Democratic People's Republic of"},{value:"KR",caption:"Korea, Republic of"},{value:"KW",caption:"Kuwait"},{value:"KG",caption:"Kyrgyzstan"},{value:"LA",caption:"Lao People's Democratic Republic"},{value:"LV",caption:"Latvia"},{value:"LB",caption:"Lebanon"},{value:"LS",caption:"Lesotho"},{value:"LR",caption:"Liberia"},{value:"LY",caption:"Libya"},{value:"LI",caption:"Liechtenstein"},{value:"LT",caption:"Lithuania"},{value:"LU",caption:"Luxembourg"},{value:"MO",caption:"Macao"},{value:"MK",caption:"Macedonia, the Former Yugoslav Republic of"},{value:"MG",caption:"Madagascar"},{value:"MW",caption:"Malawi"},{value:"MY",caption:"Malaysia"},{value:"MV",caption:"Maldives"},{value:"ML",caption:"Mali"},{value:"MT",caption:"Malta"},{value:"MH",caption:"Marshall Islands"},{value:"MQ",caption:"Martinique"},{value:"MR",caption:"Mauritania"},{value:"MU",caption:"Mauritius"},{value:"YT",caption:"Mayotte"},{value:"MX",caption:"Mexico"},{value:"FM",caption:"Micronesia, Federated States of"},{value:"MD",caption:"Moldova, Republic of"},{value:"MC",caption:"Monaco"},{value:"MN",caption:"Mongolia"},{value:"ME",caption:"Montenegro"},{value:"MS",caption:"Montserrat"},{value:"MA",caption:"Morocco"},{value:"MZ",caption:"Mozambique"},{value:"MM",caption:"Myanmar"},{value:"NA",caption:"Namibia"},{value:"NR",caption:"Nauru"},{value:"NP",caption:"Nepal"},{value:"NL",caption:"Netherlands"},{value:"NC",caption:"New Caledonia"},{value:"NZ",caption:"New Zealand"},{value:"NI",caption:"Nicaragua"},{value:"NE",caption:"Niger"},{value:"NG",caption:"Nigeria"},{value:"NU",caption:"Niue"},{value:"NF",caption:"Norfolk Island"},{value:"MP",caption:"Northern Mariana Islands"},{value:"NO",caption:"Norway"},{value:"OM",caption:"Oman"},{value:"PK",caption:"Pakistan"},{value:"PW",caption:"Palau"},{value:"PS",caption:"Palestine, State of"},{value:"PA",caption:"Panama"},{value:"PG",caption:"Papua New Guinea"},{value:"PY",caption:"Paraguay"},{value:"PE",caption:"Peru"},{value:"PH",caption:"Philippines"},{value:"PN",caption:"Pitcairn"},{value:"PL",caption:"Poland"},{value:"PT",caption:"Portugal"},{value:"PR",caption:"Puerto Rico"},{value:"QA",caption:"Qatar"},{value:"RE",caption:"Réunion"},{value:"RO",caption:"Romania"},{value:"RU",caption:"Russian Federation"},{value:"RW",caption:"Rwanda"},{value:"BL",caption:"Saint Barthélemy"},{value:"SH",caption:"Saint Helena, Ascension and Tristan da Cunha"},{value:"KN",caption:"Saint Kitts and Nevis"},{value:"LC",caption:"Saint Lucia"},{value:"MF",caption:"Saint Martin (French part)"},{value:"PM",caption:"Saint Pierre and Miquelon"},{value:"VC",caption:"Saint Vincent and the Grenadines"},{value:"WS",caption:"Samoa"},{value:"SM",caption:"San Marino"},{value:"ST",caption:"Sao Tome and Principe"},{value:"SA",caption:"Saudi Arabia"},{value:"SN",caption:"Senegal"},{value:"RS",caption:"Serbia"},{value:"SC",caption:"Seychelles"},{value:"SL",caption:"Sierra Leone"},{value:"SG",caption:"Singapore"},{value:"SX",caption:"Sint Maarten (Dutch part)"},{value:"SK",caption:"Slovakia"},{value:"SI",caption:"Slovenia"},{value:"SB",caption:"Solomon Islands"},{value:"SO",caption:"Somalia"},{value:"ZA",caption:"South Africa"},{value:"GS",caption:"South Georgia and the South Sandwich Islands"},{value:"SS",caption:"South Sudan"},{value:"ES",caption:"Spain"},{value:"LK",caption:"Sri Lanka"},{value:"SD",caption:"Sudan"},{value:"SR",caption:"Suriname"},{value:"SJ",caption:"Svalbard and Jan Mayen"},{value:"SZ",caption:"Swaziland"},{value:"SE",caption:"Sweden"},{value:"CH",caption:"Switzerland"},{value:"SY",caption:"Syrian Arab Republic"},{value:"TW",caption:"Taiwan, Province of China"},{value:"TJ",caption:"Tajikistan"},{value:"TZ",caption:"Tanzania, United Republic of"},{value:"TH",caption:"Thailand"},{value:"TL",caption:"Timor-Leste"},{value:"TG",caption:"Togo"},{value:"TK",caption:"Tokelau"},{value:"TO",caption:"Tonga"},{value:"TT",caption:"Trinidad and Tobago"},{value:"TN",caption:"Tunisia"},{value:"TR",caption:"Turkey"},{value:"TM",caption:"Turkmenistan"},{value:"TC",caption:"Turks and Caicos Islands"},{value:"TV",caption:"Tuvalu"},{value:"UG",caption:"Uganda"},{value:"UA",caption:"Ukraine"},{value:"AE",caption:"United Arab Emirates"},{value:"GB",caption:"United Kingdom"},{value:"US",caption:"United States"},{value:"UM",caption:"United States Minor Outlying Islands"},{value:"UY",caption:"Uruguay"},{value:"UZ",caption:"Uzbekistan"},{value:"VU",caption:"Vanuatu"},{value:"VE",caption:"Venezuela, Bolivarian Republic of"},{value:"VN",caption:"Viet Nam"},{value:"VG",caption:"Virgin Islands, British"},{value:"VI",caption:"Virgin Islands, U.S."},{value:"WF",caption:"Wallis and Futuna"},{value:"EH",caption:"Western Sahara"},{value:"YE",caption:"Yemen"},{value:"ZM",caption:"Zambia"},{value:"ZW",caption:"Zimbabwe"}],L=i("Vxjr");function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function F(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function U(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){F(a,n,o,r,s,"next",t)}function s(t){F(a,n,o,r,s,"throw",t)}r(void 0)}))}}function N(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function H(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?N(Object(i),!0).forEach((function(e){V(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function V(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var W,G,q,K,Y,X,Z,J,Q,tt,et,it,nt,ot,at=h.a.stripe_live?h.a.STRIPE_LIVE_PUBLIC_KEY:h.a.STRIPE_TEST_PUBLIC_KEY,rt=Backbone.View.extend({template:A.a["template-viewer-cart-sidebar"],cardStyle:{base:{letterSpacing:"0.3px",color:"#0080FF",fontSize:"16px",fontFamily:"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif","::placeholder":{color:"#CFD7DF"},fontSmoothing:"antialiased"},invalid:{color:"#e5424d",":focus":{color:"#303238"}}},getRenderStatus:function(){return this.rendered},initialize:function(t){return r.a.bindAll(this),this.mag=t,this.environment=this.mag.router.environment,this.rendered=!1,this.haveSkus=!1,this.havePrices=!1,this.checkoutCompete=!1,this.isHiddenSettings=!0,this.activeTab="tab-items",this.orderLoading=!1,this.paymentLoading=!1,this.hoveredItem=null,this.shippingForm={name:{value:null,error:null,validationRules:[{title:"required"}]},phone:{value:null,error:null,validationRules:[{title:"phoneNumber"}]},line1:{value:null,error:null,validationRules:[{title:"required"}]},line2:{value:null,error:null,validationRules:[]},city:{value:null,error:null,validationRules:[{title:"required"}]},state:{value:null,error:null,validationRules:[]},country:{value:"default",error:null,validationRules:[{title:"required",func:function(t,e){return"default"===e?"field is required":null}}]},postal_code:{value:null,error:null,validationRules:[]},email:{value:null,error:null,validationRules:[{title:"required"},{title:"email"}]},note:{value:null,error:null,validationRules:[]}},this.cardHolderNameValue=null,this.clearShippingFormField_debounced=r.a.debounce(this.clearShippingFormField,200),this.render(),this},render:function(){if(!RM.screenshot){var t=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");if(t&&t.can_use_e_commerce&&!this.mag.eCommerceManager.isConstructor()&&this.mag.eCommerceManager.haveEcommerceCartWidget&&this.mag.eCommerceManager.isMagConnectedTo("stripe")&&!this.rendered){this.rendered=!0,document.querySelectorAll("#cart-sidebar").length&&document.querySelectorAll("#cart-sidebar").forEach((function(t){return t.parentNode.removeChild(t)})),this.setElement(this.template({isMobile:Object(M.isMobile)(),isViewer:this.environment===h.a.environment.viewer})),this.$el.appendTo(Object(n.a)("body")),this.$toolbar=Object(n.a)(".toolbar.for-viewer"),this.$tabs=this.$el.find(".cart-sidebar-tabs"),this.$items=this.$el.find(".cart-items-list"),this.$closeButton=this.$el.find(".close-button"),this.$footer=this.$el.find(".sidebar-footer"),this.$navButtons=this.$el.find(".sidebar-btn"),this.$calcTextContainer=this.$el.find(".text-size-calc-container"),this.$itemsTab=this.$tabs.find(".tab-items"),this.$shippingTab=this.$tabs.find(".tab-inputs"),this.$orderTab=this.$tabs.find(".tab-order"),this.$paymentTab=this.$tabs.find(".tab-checkout"),this.$goToPayment=this.$orderTab.find(".cart-pay-btn"),this.$orderDetails=this.$orderTab.find(".order-details"),this.$orderItems=this.$orderTab.find(".order-items-list"),this.$orderError=this.$orderTab.find(".order-error"),this.$orderShippingAddress=this.$orderTab.find(".order-shipping-address"),this.$orderShippingMethod=this.$orderTab.find(".order-shipping-method"),this.$orderShippingEmail=this.$orderTab.find(".order-shipping-email"),this.$orderTax=this.$orderTab.find(".order-tax"),this.$orderTotalPrice=this.$orderTab.find(".order-total-price"),this.$paymentSuccess=this.$tabs.find("#payment-success-msg"),this.$paymentFailed=this.$tabs.find("#payment-failed-msg"),this.cartWidgetData=this.mag.eCommerceManager.getCartWidgetData(),this.environment===h.a.environment.preview&&(this.cartWidgetData&&this.cartWidgetData._id&&this.setupSettingsPanel(),window.RM.constructorRouter.on("previewClose",this.closeSideBar.bind(this)),this.bindTextInputsEvents());var e=this.$el.find(".svg");return P()(e),this.$el.find("[data-alt]:not(.rmalttext)").RMAltText(),this.generateSidebarCSS(this.cartWidgetData),this.renderSidebarTexts(),this.renderCartItems(),this.renderShippingForm(),this.initNavigation(),this.bindDomEvents(),R.a.on("ecommerce:cartsidebar:visibility:changed",this.toggleSidebar),this.mag.eCommerceManager.events.on("ecommerce:cartdata:changed",this.renderCartItems),this}}},bindDomEvents:function(){this.$closeButton.on("click",this.closeSideBar.bind(this)),this.$tabs.find(".cart-cancel-btn").on("click",this.cancelOrder.bind(this)),Object(n.a)(document).on("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),Object(n.a)(document).on("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave),this.bindStaticTextFieldsHovers()},unbindDomEvents:function(){this.$closeButton.off("click",this.closeSideBar),this.$tabs.find(".cart-cancel-btn").off("click",this.cancelOrder),Object(n.a)(document).off("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),Object(n.a)(document).off("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave)},bindStaticTextFieldsHovers:function(){this.environment===h.a.environment.preview&&(this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseover",(function(t){Object(n.a)(t.target).addClass("active")})),this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseleave",(function(t){Object(n.a)(t.target).is(":focus")||Object(n.a)(t.target).removeClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseover",(function(t){Object(n.a)(t.target).find(".cart-checkout-input").addClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseleave",(function(t){var e=Object(n.a)(t.target).find(".cart-checkout-input");e.is(":focus")||e.removeClass("active")})))},hideSidebar:function(){this.$el.removeClass("show"),Object(n.a)("body").removeClass("cart-sidebar-shown"),Object(n.a)("html").removeClass("cart-disable-scroll"),!this.isHiddenSettings&&this.settingsPanel&&(this.isHiddenSettings=!0,this.settingsPanel.isHidden=this.isHiddenSettings)},toggleSidebar:function(t){t?(this.hideSidebar(),this.checkoutCompete&&(this.mag.eCommerceManager.clearCart(),this.goToInitialTab(),this.hideSuccessPaymentMessage(),this.$paymentFailed.empty()),this.clearOrderError()):(this.$el.addClass("show"),Object(n.a)("body").addClass("cart-sidebar-shown"),Object(n.a)("html").addClass("cart-disable-scroll"))},closeSideBar:function(){this.mag.eCommerceManager.isCartSidebarHidden||this.mag.eCommerceManager.changeCartSidebarVisibility()},initNavigation:function(){this.$tabs.find("[data-tab^='tab-']").each(function(t,e){Object(n.a)(e).on("click",function(t){if(!t.isDefaultPrevented())if(this.haveSkus&&this.havePrices)window.alert("You can't buy all these products, try separately");else if(this.haveSkus||this.havePrices){if("tab-inputs"===e.dataset.tab&&(this.updateShippingForm(),RM.analytics&&RM.analytics.sendEvent("Checkout 1st step completed")),"tab-order"===e.dataset.tab){if(!this.validateShippingForm())return void this.renderShippingFormErrors();this.clearShippingFormErrors(),RM.analytics&&RM.analytics.sendEvent("Checkout 2nd step completed");var i,n,o=this.mag.eCommerceManager.getShippingForm();o&&(i=r.a.mapObject(o,(function(t){return{value:t.value}})),n=r.a.mapObject(this.shippingForm,(function(t){return{value:t.value}}))),(!o||o&&!r.a.isEqual(i,n))&&(this.mag.eCommerceManager.setShippingForm(this.shippingForm),this.havePrices&&(this.needForUpdateCustomer=!0)),this.haveSkus&&this.renderOrderTab(),this.havePrices&&this.renderOrderTabForPrices()}"tab-checkout"===e.dataset.tab&&(RM.analytics&&RM.analytics.sendEvent("Checkout 3rd step completed"),this.haveSkus&&this.renderCheckoutForm(),this.havePrices&&this.renderCheckoutFormPaymentIntent()),this.goToTabByClassname("."+e.dataset.tab)}}.bind(this))}.bind(this))},goToTabByClassname:function(t){this.$tabs.find(".cart-sidebar-tab").each((function(t,e){Object(n.a)(e).removeClass("active")})),this.$tabs.find(t).addClass("active"),this.activeTab=t.slice(1)},goToInitialTab:function(){this.goToTabByClassname(".tab-items")},generateSidebarCSS:function(t){var e="cart_sidebar_styles_".concat(t._id),i=d.default.getRGBA(t["bar-color"],t["bar-color-opacity"]/100),o=d.default.getRGBA(t["bar-background-color"],t["bar-background-color-opacity"]/100),a=d.default.getRGBA(t["bar-color"],.45*t["bar-color-opacity"]/100),r=this.getAdditionalColor(o);this.cardStyle=H(H({},this.cardStyle),{},{base:H(H({},this.cardStyle.base),{},{color:i,fontWeight:t["bar-font-weight"],"::placeholder":{color:a}}),invalid:H(H({},this.cardStyle.invalid),{},{color:a,fontWeight:t["bar-font-weight"],":focus":{color:i},"::placeholder":{color:a}})});var s="    .cart-sidebar {\n\n      color: ".concat(i,";\n      background-color: ").concat(o,";\n      box-shadow: ").concat(t["bar-shadow"]?"0 0 4px rgba(124, 124, 125, 0.5)":"none",";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar textarea {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input {\n\n      color: ").concat(i,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input::placeholder {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .cart-title-input.active {\n\n      border-color: ").concat(Object(E.e)(.8,i),";\n    }\n\n    .cart-sidebar .empty-cart-title-input.active {\n\n      border-color: ").concat(Object(E.e)(.8,i),";\n    }\n\n    .cart-sidebar .cart-price-input.active, .cart-sidebar .cart-quantity-input.active {\n\n      border-color: ").concat(Object(E.e)(.2,a),";\n    }\n\n    .cart-sidebar .cart-checkout-input.active {\n\n      border-color: ").concat(Object(E.e)(.8,i),";\n    }\n\n    .cart-sidebar .cart-price-input {\n\n      color: ").concat(a,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .cart-quantity-input {\n\n      color: ").concat(a,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar button {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar select {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .sidebar-btn {\n\n      color: ").concat(i,";\n      border-color: ").concat(a,";\n    }\n\n    .cart-sidebar .preloader svg path {\n\n      stroke: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-btn path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .expand-arrow svg path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .cart-cancel-btn {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block.hover {\n\n      background-color: ").concat(r,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-attributes {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-price {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-items-quantity {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-remove-btn-icon path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-decrease-btn-icon rect {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-increase-btn-icon path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form, .cart-sidebar .sidebar-body .order-details-form .form-input {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .form-input::placeholder {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .rm-native-fake-select {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .rm-native-fake-select.selected {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form svg path {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .form-title {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .form-error {\n\n      background-color: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-body .order-details-form .rm-native-select-popup {\n\n      background-color: ").concat(r,";\n    }\n\n    .cart-sidebar .tab-order .order-details .order-title-row {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .tab-order .order-details .rm-native-fake-select {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .tab-checkout .payment-input {\n\n      color: ").concat(i,";\n    }\n\n    .cart-sidebar .tab-checkout .payment-input::placeholder {\n\n      color: ").concat(a,";\n    }\n\n    .cart-sidebar .tab-checkout #payment-failed-msg .error-icon {\n\n      border-color: ").concat(a,";\n    }\n\n    .cart-sidebar .tab-checkout #payment-failed-msg .error-icon svg g {\n\n      fill: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button path {\n\n      stroke: ").concat(i,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button:hover path {\n\n      stroke: ").concat(a,";\n    }\n\n    .cart-sidebar.cart-is-mobile .sidebar-body .cart-item-block {\n\n      background-color: ").concat(r,";\n    }");Object(n.a)("#".concat(e)).remove();var l=document.createElement("style");l.type="text/css",l.id=e,l.className="cart-sidebar-styles",l.appendChild(document.createTextNode(s)),document.querySelector("head").appendChild(l)},getAdditionalColor:function(t){return Object(E.c)(t)<.05&&Object(E.b)("#fff",t)-Object(E.b)("#000",t)>=8?Object(E.d)(.1,t):Object(E.a)(.1,t)},renderCartItems:function(){var t=this.mag.eCommerceManager.getCartData();if(t&&t.skus){var e=Object.keys(t.skus),i=Object.keys(t.prices);this.$items.empty(),this.haveSkus=!!e.length,this.havePrices=!!i.length,this.haveSkus||this.havePrices?(this.$itemsTab.find(".сheck-out-btn").css("display","block"),this.$itemsTab.find(".empty-cart").css("display","none")):(this.$itemsTab.find(".сheck-out-btn").css("display","none"),this.$itemsTab.find(".empty-cart").css("display","flex")),this.renderPricesCartItems(i),this.renderSkusCartItems(e);var n=this.$items.find(".svg");P()(n),this.renderSidebarTexts(),this.unbindTextInputsEvents(!0),this.bindTextInputsEvents(!0)}},renderCartItem:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"price",o=this.hoveredItem===t.id,a=Object(n.a)("<div/>",{class:"cart-item-block".concat(o?" hover":"")});a.data("".concat(i,"-id"),t.id);var r=t.image||t.productObject.images&&t.productObject.images.length;if(r){var s=t.image?t.image:t.productObject.images?t.productObject.images[0]:"";e=Object(n.a)("<div/>",{class:"cart-item-image",css:{"background-position":"center center","background-size":"cover","background-repeat":"no-repeat","background-image":"url(".concat(s,")")}}),a.append(e)}var l=Object(n.a)("<div/>",{class:e?"cart-item-title":"cart-item-title without-image"}).text(t.productObject.name),c=t.cart_count,h=(("price"===i?t.unit_amount:t.price)/100).toFixed(2),u=D(h,t.currency),p=D((h*c).toFixed(2),t.currency),m=Object(n.a)("<div/>",{class:"cart-item-price"}),g=Object(n.a)("<input/>",{type:"text",class:"cart-text-input cart-price-input",name:"price",placeholder:"Price",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});g.get(0).dataset.dynamicWidth=!0;var f,v=Object(n.a)("<span/>").html(c>1?": ".concat(u," × ").concat(c," = ").concat(p):": ".concat(u));if(m.append(g).append(v),"sku"===i){f=Object(n.a)("<div/>",{class:"cart-item-attributes"});var b=t.attributes;for(var y in b){var _=Object(n.a)("<div/>",{class:"cart-item-attribute"}).html("".concat(d.default.capitalize(y),": ").concat(b[y]));f.append(_)}}var w=Object(n.a)("<div/>",{class:"cart-items-quantity"}),k=Object(n.a)("<input/>",{type:"text",class:"cart-text-input cart-quantity-input",name:"quantity",placeholder:"Quantity",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});k.get(0).dataset.dynamicWidth=!0;var S=Object(n.a)("<span/>").html(": ".concat(c));w.append(k).append(S);var x=Object(n.a)("<div/>",{class:"cart-item-remove-btn",title:"remove"}).attr("data-".concat(i,"-id"),t.id),C=Object(n.a)("<img/>",{class:"svg cart-item-remove-btn-icon",src:Object(L.findImagePath)("./viewer/cart-sidebar/cart-item-delete.svg")});x.append(C),x.on("click",this.onRemoveItem);var O=Object(n.a)("<div/>",{class:"cart-item-edit-group"}),j=Object(n.a)("<div/>",{class:"cart-item-increase-btn"}).attr("data-".concat(i,"-id"),t.id),P=Object(n.a)("<img/>",{class:"svg cart-item-increase-btn-icon",src:Object(L.findImagePath)("./viewer/cart-sidebar/cart-item-increase.svg")});if(j.append(P),O.append(j),("price"===i||this.mag.eCommerceManager.checkItemQuantity(t.id))&&(j.addClass("active"),j.on("click",this.onIncreaseItem)),c>1){var E=Object(n.a)("<div/>",{class:"cart-item-decrease-btn decrease-btn-".concat(t.id)}).attr("data-".concat(i,"-id"),t.id),I=Object(n.a)("<img/>",{class:"svg cart-item-decrease-btn-icon",src:Object(L.findImagePath)("./viewer/cart-sidebar/cart-item-decrease.svg")});E.append(I),O.append(E),E.on("click",this.onDecreaseItem)}else{var T=this.$items.find("decrease-btn-".concat(t.id));T.off("click",this.onDecreaseItem),T.remove()}"price"===i?a.append(l).append(m).append(w).append(x).append(O):a.append(l).append(f).append(m).append(w).append(x).append(O),this.$items.append(a)},renderPricesCartItems:function(t){var e=this,i=this.mag.eCommerceManager.getCartData();t.forEach((function(t){var n=i.prices[t];n.active&&e.renderCartItem(n)}))},renderSkusCartItems:function(t){var e=this,i=this.mag.eCommerceManager.getCartData();t.forEach((function(t){var n=i.skus[t];n.active&&e.renderCartItem(n,"sku")}))},onRemoveItem:function(t){t.currentTarget.dataset.priceId?this.mag.eCommerceManager.removeFromCart(t.currentTarget.dataset.priceId):t.currentTarget.dataset.skuId&&this.mag.eCommerceManager.removeSkuFromCart(t.currentTarget.dataset.skuId)},onIncreaseItem:function(t){t.currentTarget.dataset.priceId?this.mag.eCommerceManager.increaseCartItem(t.currentTarget.dataset.priceId):t.currentTarget.dataset.skuId&&this.mag.eCommerceManager.increaseSkuCartItem(t.currentTarget.dataset.skuId)},onDecreaseItem:function(t){t.currentTarget.dataset.priceId?this.mag.eCommerceManager.decreaseCartItem(t.currentTarget.dataset.priceId):t.currentTarget.dataset.skuId&&this.mag.eCommerceManager.decreaseSkuCartItem(t.currentTarget.dataset.skuId)},getTextFieldModelKey:function(t){return"bar-".concat(t)},getSidebarTextValue:function(t){var e=this.getTextFieldModelKey(t);return this.cartWidgetData&&this.cartWidgetData[e]?T()(this.cartWidgetData[e]):h.a.defaultSidebarTexts[t]?h.a.defaultSidebarTexts[t]:null},calcTextFieldSize:function(t){if(!t)return null;var e=getComputedStyle(t);this.$calcTextContainer.css({"font-family":e.fontFamily,"font-size":e.fontSize,"font-style":e.fontStyle,"font-weight":e.fontWeight,"letter-spacing":e.letterSpacing}),this.$calcTextContainer.text(t.value);var i=this.$calcTextContainer.width();return Math.ceil(i)},renderSidebarTexts:function(){var t=this;this.$itemsTab.find(".cart-text-input").each((function(e,i){var n=i.getAttribute("name"),o=t.getSidebarTextValue(n);if(o&&(i.value=o,i.dataset.dynamicWidth)){var a=t.calcTextFieldSize(i);a&&(i.style.width="".concat(a,"px"))}}))},bindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){Object(n.a)(i).on("click",t.onTextFieldClick),Object(n.a)(i).on("input",t.onTextFieldChange),Object(n.a)(i).on("focus",t.onTextFieldFocus),Object(n.a)(i).on("blur",t.onTextFieldBlur)})),e&&this.environment===h.a.environment.preview&&(this.$itemsTab.find(".cart-item-block").on("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").on("mouseleave",this.onDynamicMouseLeave))},unbindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){Object(n.a)(i).off("click",t.onTextFieldClick),Object(n.a)(i).off("input",t.onTextFieldChange),Object(n.a)(i).off("focus",t.onTextFieldFocus),Object(n.a)(i).off("blur",t.onTextFieldBlur)})),e&&this.environment===h.a.environment.preview&&(this.$itemsTab.find(".cart-item-block").off("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").off("mouseleave",this.onDynamicMouseLeave))},onDynamicMouseOver:function(t){Object(n.a)(t.target).find(".cart-price-input, .cart-quantity-input").addClass("active")},onDynamicMouseLeave:function(t){Object(n.a)(t.target).find(".cart-price-input, .cart-quantity-input").each((function(){Object(n.a)(this).is(":focus")||Object(n.a)(this).removeClass("active")}))},onTextFieldClick:function(t){t.preventDefault()},onTextFieldChange:function(t){if(t.target.dataset.dynamicWidth){var e=this.calcTextFieldSize(t.target);e&&(t.target.style.width="".concat(e,"px"))}},onTextFieldFocus:function(t){this.environment===h.a.environment.preview&&Object(n.a)(t.target).addClass("active")},onTextFieldBlur:function(t){var e=this;this.environment===h.a.environment.preview&&Object(n.a)(t.target).removeClass("active");var i=t.target.getAttribute("name"),o=this.getSidebarTextValue(i);if(o)if(t.target.value){if(this.cartWidgetModel){var a=V({},this.getTextFieldModelKey(i),t.target.value);this.updateCartWidgetData(a),this.cartWidgetModel.save(a,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){t.target.dataset.dynamicWidth&&e.renderSidebarTexts()}))}}else t.target.value=o},renderShippingForm:(ot=U(regeneratorRuntime.mark((function t(){var e,o,a,s,l,c,d,h,u=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=r.a.clone(B)).unshift({value:"default",caption:"Country"}),o=this.mag.eCommerceManager.getCartData(),(a=o.shippingForm)&&"object"===z(a)&&(this.shippingForm=a),t.next=7,i.e(4).then(i.bind(null,"h9wM"));case 7:return s=t.sent,l=s.default,t.next=11,Promise.resolve().then(i.bind(null,"Kw5r"));case 11:c=t.sent,d=c.default,h=d.extend(l),this.countrySelect=new h({el:this.$tabs.find(".countries-select").get(0),propsData:{options:function(){return e},value:this.shippingForm.country.value,isDesktop:!1,callback:this.onCountryChange}}),this.mag.eCommerceManager.hasShippableProducts()?this.$shippingTab.find(".shipping-form").removeClass("hidden"):this.$shippingTab.find(".shipping-form").addClass("hidden"),this.$tabs.find(".order-details-form .form-input").each((function(t,e){var i=e.getAttribute("name");u.shippingForm[i]&&(e.value=u.shippingForm[i].value),Object(n.a)(e).on("input",u.onShippingFormChange)}));case 17:case"end":return t.stop()}}),t,this)}))),function(){return ot.apply(this,arguments)}),updateShippingForm:function(){var t=this.mag.eCommerceManager.getShippingForm();t&&"object"===z(t)&&(this.shippingForm=t),this.mag.eCommerceManager.hasShippableProducts()?this.$shippingTab.find(".shipping-form").removeClass("hidden"):this.$shippingTab.find(".shipping-form").addClass("hidden")},onCountryChange:function(t){this.shippingForm.country.value=t,this.countrySelect.value=t,this.clearShippingFormField_debounced("country")},onShippingFormChange:function(t){var e=t.target.getAttribute("name");void 0!==this.shippingForm[e]&&"object"===z(this.shippingForm[e])&&(this.shippingForm[e].value=t.target.value,this.clearShippingFormField_debounced(e))},renderShippingFormErrors:function(){var t=this;Object.keys(this.shippingForm).forEach((function(e){t.shippingForm[e].error&&t.$shippingTab.find(".form-error.".concat(e,"-error")).removeClass("hidden")}))},clearShippingFormErrors:function(){var t=this;Object.keys(this.shippingForm).forEach((function(e){t.$tabs.find(".form-error.".concat(e,"-error")).addClass("hidden")}))},clearShippingFormField:function(t){if(void 0!==this.shippingForm[t]&&this.shippingForm[t].error){var e=this.validateShippingFormField(t);e&&e.success&&(this.$tabs.find(".form-error.".concat(t,"-error")).addClass("hidden"),this.shippingForm[t].error=null)}},validateShippingFormField:function(t){var e=this,i=[];if(void 0!==this.shippingForm[t])return this.shippingForm[t].validationRules.length?(this.shippingForm[t].validationRules.forEach((function(n){if("function"==typeof n.func){var o=n.func(t,e.shippingForm[t].value);o&&i.push(o)}else{var a=e["".concat(n.title,"Validation")](t,e.shippingForm[t].value);a&&i.push(a)}})),i.length?{success:!1,error:!0,errorMessages:i}:{success:!0}):{success:!0}},requiredValidation:function(t,e){return e?null:"field is required"},emailValidation:function(t,e){return e?d.default.isValidEmail(e)?null:"it's not email":null},phoneNumberValidation:function(t,e){return e?d.default.isValidPhoneNumber(e)?null:"it's not  phone number":null},validateShippingForm:function(){var t=!1;if(this.mag.eCommerceManager.hasShippableProducts())for(var e in this.shippingForm){var i=this.validateShippingFormField(e);i&&(i.success?this.shippingForm[e].error=null:(this.shippingForm[e].error=i.errorMessages,t=!0))}else{var n=this.validateShippingFormField("email");n&&(n.success?this.shippingForm.email.error=null:(this.shippingForm.email.error=n.errorMessages,t=!0))}return!t},renderOrderTab:function(){var t=this;this.clearOrderError();var e=this.mag.eCommerceManager.getCartData(),i=e.order;if(i&&i.created<Math.floor(Date.parse(e.changed)/1e3))return this.showOrderLoader(),void this.mag.eCommerceManager.cancelOrder().then((function(e){e.data&&"canceled"===e.data.status&&(t.mag.eCommerceManager.deleteOrder(),t.createOrder())})).catch((function(e){t.hideOrderLoader(),t.renderOrderError(e&&e.message?e.message:""),t.mag.eCommerceManager.deleteOrder()}));i?this.renderOrderDetails():this.createOrder()},renderOrderTabForPrices:(nt=U(regeneratorRuntime.mark((function t(){var e,i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clearOrderError(),this.showOrderLoader(),t.next=4,this.getCustomer();case 4:if(!(e=t.sent)){t.next=42;break}return t.next=8,this.getInvoiceItemsForCustomer(e.id);case 8:if(!t.sent){t.next=42;break}return t.next=12,this.getInvoiceForCustomer(e.id);case 12:if(!(i=t.sent)){t.next=42;break}if(!(i.created<Math.floor(Date.parse(this.mag.eCommerceManager.getCartData().changed)/1e3))){t.next=41;break}if(!this.needForUpdateCustomer){t.next=19;break}return t.next=18,this.updateOrCreateCustomer();case 18:this.needForUpdateCustomer=!1;case 19:return t.prev=19,t.next=22,this.cancelInvoice(i);case 22:t.next=29;break;case 24:return t.prev=24,t.t0=t.catch(19),this.renderOrderError("can't cancel old order"),this.hideOrderLoader(),t.abrupt("return");case 29:return t.prev=29,t.next=32,this.createInvoiceWithItems();case 32:(n=t.sent)&&this.renderInvoiceDetails(n),t.next=39;break;case 36:t.prev=36,t.t1=t.catch(29),this.renderOrderError("can't create order");case 39:t.next=42;break;case 41:this.renderInvoiceDetails(i);case 42:this.hideOrderLoader();case 43:case"end":return t.stop()}}),t,this,[[19,24],[29,36]])}))),function(){return nt.apply(this,arguments)}),renderInvoiceDetails:(it=U(regeneratorRuntime.mark((function t(e){var i,o,a,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.$orderItems.empty(),this.$orderShippingAddress.empty(),this.$orderShippingMethod.empty(),this.$orderShippingEmail.empty(),this.$orderTax.empty(),this.$orderTotalPrice.empty(),e.lines.data.forEach((function(t){var e=Object(n.a)("<div/>",{class:"order-item"}).html(t.quantity+" × "+t.description),i=Object(n.a)("<div/>",{class:"order-item-price"}).text(D((t.amount/100).toFixed(2),t.currency));e.append(i),r.$orderItems.append(e)})),e.customer_shipping&&e.customer_shipping.address&&(i=function(t){return t?" ".concat(t):""},o=e.customer_shipping.address,a="".concat(o.line1).concat(i(o.line2)," ").concat(o.city,",").concat(i(o.state)).concat(i(o.postal_code)," ").concat(o.country),this.$orderShippingAddress.text(a),this.$tabs.find(".shipping-details").removeClass("hidden")),this.$orderShippingMethod.parent(".shipping-method.order-row").addClass("hidden"),this.$orderDetails.find(".order-id").text(String(e.id).slice(0,20)+"..."),this.$orderShippingEmail.text(e.customer_email),this.$orderDetails.find(".shipping-email").removeClass("hidden"),e.customer_phone?(this.$orderDetails.find(".order-shipping-phone").text(e.customer_phone),this.$orderDetails.find(".shipping-phone").removeClass("hidden")):this.$orderDetails.find(".shipping-phone").addClass("hidden"),e.tax?(this.$orderTax.parent(".shipping-tax-size.order-row").removeClass("hidden"),this.$orderTax.text(D((e.tax/100).toFixed(2),e.currency))):this.$orderTax.parent(".shipping-tax-size.order-row").addClass("hidden"),this.$orderTotalPrice.text(D((e.total/100).toFixed(2),e.currency)),this.$goToPayment.removeClass("hidden");case 16:case"end":return t.stop()}}),t,this)}))),function(t){return it.apply(this,arguments)}),getCustomer:(et=U(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=this.mag.eCommerceManager.getCartData()).customer){t.next=17;break}return t.prev=2,t.next=5,this.mag.eCommerceManager.createOrUpdateCustomer(this.mag.num_id,this.generateCustomerDataFromShippingForm(e.shippingForm));case 5:if(!(i=t.sent)||!i.data){t.next=9;break}return this.mag.eCommerceManager.setCustomer(i.data),t.abrupt("return",i.data);case 9:t.next=15;break;case 11:throw t.prev=11,t.t0=t.catch(2),console.error(t.t0),t.t0;case 15:t.next=18;break;case 17:return t.abrupt("return",e.customer);case 18:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(){return et.apply(this,arguments)}),updateOrCreateCustomer:(tt=U(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.mag.eCommerceManager.getCartData(),t.next=3,this.mag.eCommerceManager.createOrUpdateCustomer(this.mag.num_id,this.generateCustomerDataFromShippingForm(e.shippingForm));case 3:if(!(i=t.sent)||!i.data){t.next=7;break}return this.mag.eCommerceManager.setCustomer(i.data),t.abrupt("return",i.data);case 7:case"end":return t.stop()}}),t,this)}))),function(){return tt.apply(this,arguments)}),generateCustomerDataFromShippingForm:function(t){var e={email:t.email.value,name:t.name.value,shipping:{address:{country:t.country.value,city:t.city.value,line1:t.line1.value},name:t.name.value}};return t.phone.value&&(e.phone=t.phone.value,e.shipping.phone=t.phone.value),t.line2.value&&(e.shipping.address.line2=t.line2.value),t.postal_code.value&&(e.shipping.address.postal_code=t.postal_code.value),t.state.value&&(e.shipping.address.state=t.state.value),e},getInvoiceItemsForCustomer:(Q=U(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((i=this.mag.eCommerceManager.getCartData()).invoiceItems&&i.invoiceItems.length>0)){t.next=5;break}return t.abrupt("return",i.invoiceItems);case 5:return t.next=7,this.createInvoiceItemsForCustomer(e);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return Q.apply(this,arguments)}),createInvoiceItemsForCustomer:(J=U(regeneratorRuntime.mark((function t(e){var i,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.mag.eCommerceManager.getCartData(),n=Object.keys(i.prices).map((function(t){return{price:i.prices[t].id,quantity:i.prices[t].cart_count}})),t.prev=2,t.next=5,this.mag.eCommerceManager.createInvoiceItems(this.mag.num_id,e,n);case 5:if(!((o=t.sent)&&o.data&&o.data.length)){t.next=9;break}return this.mag.eCommerceManager.setInvoiceItems(o.data),t.abrupt("return",o.data);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error(t.t0);case 14:case"end":return t.stop()}}),t,this,[[2,11]])}))),function(t){return J.apply(this,arguments)}),getInvoiceForCustomer:(Z=U(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=this.mag.eCommerceManager.getCartData()).invoice||!i.invoice.id){t.next=15;break}return t.next=4,this.mag.eCommerceManager.getInvoice(this.mag.num_id,i.invoice.id);case 4:if(!(n=t.sent)||"draft"!==n.status&&"open"!==n.status){t.next=10;break}return this.mag.eCommerceManager.setInvoice(n),t.abrupt("return",n);case 10:return t.next=12,this.createInvoiceForCustomer(e);case 12:return t.abrupt("return",t.sent);case 13:t.next=18;break;case 15:return t.next=17,this.createInvoiceForCustomer(e);case 17:return t.abrupt("return",t.sent);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return Z.apply(this,arguments)}),createInvoiceForCustomer:(X=U(regeneratorRuntime.mark((function t(e){var i,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.mag.eCommerceManager.getCartData(),n={customer:e,collection_method:"charge_automatically",auto_advance:!1},i.shippingForm&&i.shippingForm.note.value&&(n.metadata={customer_note:i.shippingForm.note.value}),t.prev=3,t.next=6,this.mag.eCommerceManager.createInvoice(this.mag.num_id,n);case 6:if(!(o=t.sent)||!o.data){t.next=10;break}return this.mag.eCommerceManager.setInvoice(o.data),t.abrupt("return",o.data);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(3),t.t0&&t.t0.type===O.c.nothingToInvoice&&(this.mag.eCommerceManager.clearCart(),this.goToInitialTab());case 15:case"end":return t.stop()}}),t,this,[[3,12]])}))),function(t){return X.apply(this,arguments)}),createInvoiceWithItems:(Y=U(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCustomer();case 2:return e=t.sent,t.next=5,this.createInvoiceItemsForCustomer(e.id);case 5:return t.next=7,this.createInvoiceForCustomer(e.id);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t,this)}))),function(){return Y.apply(this,arguments)}),cancelInvoice:(K=U(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("draft"!==e.status){t.next=5;break}return t.next=3,this.mag.eCommerceManager.deleteDraftInvoice(this.mag.num_id,e.id);case 3:t.next=8;break;case 5:if("open"!==e.status&&"uncollectible"!==e.status){t.next=8;break}return t.next=8,this.mag.eCommerceManager.voidDraftInvoice(this.mag.num_id,e.id);case 8:this.mag.eCommerceManager.unsetInvoiceItems(),this.mag.eCommerceManager.unsetInvoice();case 10:case"end":return t.stop()}}),t,this)}))),function(t){return K.apply(this,arguments)}),createOrder:function(){this.showOrderLoader(),this.mag.eCommerceManager.updateCartData().then(function(){var t=this,e=this.generateOrderRequestData();e&&e instanceof Error?this.renderOrderError(e.message):e&&e.currency&&n.a.ajax({type:"POST",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/orders/",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){t.hideOrderLoader(),e&&e.data&&(t.mag.eCommerceManager.setOrder(e.data),t.renderOrderDetails())},error:function(e){var i=JSON.parse(e.responseText);t.hideOrderLoader(),t.renderOrderError(i.message)}})}.bind(this)).catch(function(t){this.hideOrderLoader(),t&&t.message&&this.renderOrderError(t.message)}.bind(this))},showOrderLoader:function(){this.orderLoading||(this.orderLoading=!0,this.$goToPayment.hasClass("hidden")||this.$goToPayment.addClass("hidden"),this.$orderTab.find(".preloader").addClass("show"),this.$orderDetails.addClass("hidden"))},hideOrderLoader:function(){this.orderLoading&&(this.orderLoading=!1,this.$goToPayment.hasClass("hidden")&&this.$goToPayment.removeClass("hidden"),this.$orderTab.find(".preloader").removeClass("show"),this.$orderDetails.removeClass("hidden"))},renderOrderDetails:(q=U(regeneratorRuntime.mark((function t(){var e,o,a,r,s,l,c,d,h,u,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.mag.eCommerceManager.getOrder(),this.$orderItems.empty(),this.$orderShippingAddress.empty(),this.$orderShippingMethod.empty(),this.$orderShippingEmail.empty(),this.$orderTax.empty(),this.$orderTotalPrice.empty(),e.items.forEach(function(t){if("tax"===t.type)o=t;else if("shipping"===t.type)a=t;else{var e=Object(n.a)("<div/>",{class:"order-item"}).html(t.quantity+" × "+t.description),i=Object(n.a)("<div/>",{class:"order-item-price"}).text(D((t.amount/100).toFixed(2),t.currency));e.append(i),this.$orderItems.append(e)}}.bind(this)),e.shipping?(r=function(t){return t?" ".concat(t):""},s=e.shipping.address,l="".concat(s.line1).concat(r(s.line2)," ").concat(s.city,",").concat(r(s.state)).concat(r(s.postal_code)," ").concat(s.country),this.$orderShippingAddress.text(l),this.$tabs.find(".shipping-details").removeClass("hidden")):this.$tabs.find(".shipping-details").addClass("hidden"),!(e.shipping_methods.length>1)){t.next=23;break}return c=this.shippingMethodsOptions(e.shipping_methods),t.next=13,i.e(4).then(i.bind(null,"h9wM"));case 13:return d=t.sent,h=d.default,t.next=17,Promise.resolve().then(i.bind(null,"Kw5r"));case 17:u=t.sent,p=u.default,m=p.extend(h),this.shippingMethodSelect?(this.shippingMethodSelect.options=function(){return c},this.shippingMethodSelect.value=a.parent):this.shippingMethodSelect=new m({el:this.$orderShippingMethod.get(0),propsData:{options:function(){return c},value:a.parent,isDesktop:!1,callback:this.onShippingMethodChange}}),t.next=25;break;case 23:this.$orderShippingMethod.parent(".shipping-method.order-row").removeClass("hidden"),this.$orderShippingMethod.text(a.description+" "+D((a.amount/100).toFixed(2),a.currency));case 25:this.$orderDetails.find(".order-id").text(String(e.id).slice(0,20)+"..."),e.email?(this.$orderShippingEmail.text(e.email),this.$orderDetails.find(".shipping-email").removeClass("hidden")):this.$orderDetails.find(".shipping-email").addClass("hidden"),e.phone?(this.$orderDetails.find(".order-shipping-phone").text(e.phone),this.$orderDetails.find(".shipping-phone").removeClass("hidden")):this.$orderDetails.find(".shipping-phone").addClass("hidden"),o&&(this.$orderTax.parent(".shipping-tax-size.order-row").removeClass("hidden"),this.$orderTax.text(o.description+" "+D((o.amount/100).toFixed(2),o.currency))),this.$orderTotalPrice.text(D((e.amount/100).toFixed(2),e.currency)),this.$goToPayment.removeClass("hidden");case 31:case"end":return t.stop()}}),t,this)}))),function(){return q.apply(this,arguments)}),shippingMethodsOptions:function(t){return t.map((function(t){return{value:t.id,caption:t.description+" "+D((t.amount/100).toFixed(2),t.currency)}}))},onShippingMethodChange:function(t){var e=this;this.shippingMethodSelect.value=t,this.showOrderLoader(),this.mag.eCommerceManager.changeShippingMethod(t).then((function(t){e.hideOrderLoader(),t.data&&(e.mag.eCommerceManager.setOrder(t.data),e.renderOrderDetails())})).catch((function(){e.hideOrderLoader()}))},renderOrderError:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$orderError.find(".order-error-message").text(t),this.$orderError.removeClass("hidden"),this.$orderDetails.addClass("hidden"),this.$goToPayment.addClass("hidden")},clearOrderError:function(){this.$orderError.addClass("hidden"),this.$orderDetails.removeClass("hidden"),this.$goToPayment.removeClass("hidden")},transformShippingFormToOrderRequest:function(){var t=this.checkShippableInCart(),e={currency:"usd",email:this.shippingForm.email.value,items:[]};return this.shippingForm.note.value&&(e.metadata={note:this.shippingForm.note.value}),t?(e.shipping={name:this.shippingForm.name.value,phone:this.shippingForm.phone.value,address:{line1:this.shippingForm.line1.value,line2:this.shippingForm.line2.value,city:this.shippingForm.city.value,state:this.shippingForm.state.value,country:this.shippingForm.country.value,postal_code:this.shippingForm.postal_code.value}},e):e},generateOrderRequestData:function(){var t=this.mag.eCommerceManager.getCartData();if(!t||!t.skus)return new Error("Empty cart");var e=[],i=this.transformShippingFormToOrderRequest();for(var n in t.skus)t.skus[n].active&&(i.items.push({type:t.skus[n].object,parent:n,currency:t.skus[n].currency,quantity:t.skus[n].cart_count}),-1===e.indexOf(t.skus[n].currency)&&e.push(t.skus[n].currency));return e.length>1?new Error("mixed currencies"):(i.currency=e.pop(),i)},cancelOrder:function(){var t=this;if(this.showPaymentLoader(),this.havePrices){var e=this.mag.eCommerceManager.getCartData();e.invoice&&this.cancelInvoice(e.invoice).then((function(){t.hidePaymentLoader(),t.goToTabByClassname(".tab-items")})).catch((function(){t.hidePaymentLoader()}))}else this.mag.eCommerceManager.cancelOrder().then((function(e){t.hidePaymentLoader(),e.data&&"canceled"===e.data.status&&(t.mag.eCommerceManager.deleteOrder(),t.goToTabByClassname(".tab-items"))})).catch((function(){t.hidePaymentLoader()}))},renderCheckoutFormPaymentIntent:(G=U(regeneratorRuntime.mark((function t(){var e,i,n,o,a,r,s,l,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.mag.eCommerceManager.getCustomer()){t.next=4;break}return this.$paymentFailed.text("Customer not found"),t.abrupt("return");case 4:return t.next=6,this.getInvoiceForCustomer(e.id);case 6:if(i=t.sent){t.next=10;break}return this.$paymentFailed.text("Invoice not found"),t.abrupt("return");case 10:if(n=this.mag.eCommerceManager.getCartData(),this.showPaymentLoader(),"draft"!==i.status){t.next=27;break}return t.next=15,this.mag.eCommerceManager.finalizeInvoice(this.mag.num_id,i.id);case 15:return o=t.sent,this.mag.eCommerceManager.setInvoice(o),t.next=19,this.mag.eCommerceManager.getPaymentIntent(this.mag.num_id,o.payment_intent);case 19:if((a=t.sent).receipt_email){t.next=23;break}return t.next=23,this.mag.eCommerceManager.updatePaymentIntent(this.mag.num_id,a.id,{receipt_email:n.shippingForm.email.value});case 23:this.clientSecret=a.client_secret,this.hidePaymentLoader(),t.next=36;break;case 27:if("open"!==i.status){t.next=36;break}return t.next=30,this.mag.eCommerceManager.getPaymentIntent(this.mag.num_id,i.payment_intent);case 30:if((r=t.sent).receipt_email){t.next=34;break}return t.next=34,this.mag.eCommerceManager.updatePaymentIntent(this.mag.num_id,r.id,{receipt_email:n.shippingForm.email.value});case 34:this.clientSecret=r.client_secret,this.hidePaymentLoader();case 36:s=this.mag.eCommerceManager.getStripeConnectedUserId(),this.stripe||(this.stripe=Stripe(at,{stripeAccount:s})),l=this.stripe.elements(),this.cardNumber||(this.cardNumber=l.create("cardNumber",{style:this.cardStyle,placeholder:"Card number"}),this.cardNumber.mount("#card-number-element"),this.cardNumber.addEventListener("change",(function(t){var e=c.$paymentTab.find(".card-number-error");t.error?e.removeClass("hidden"):e.addClass("hidden")})),this.cardNumber.addEventListener("ready",(function(t){c.renderCartHolderInput()}))),this.cardExpiry||(this.cardExpiry=l.create("cardExpiry",{style:this.cardStyle,placeholder:"M/Y"}),this.cardExpiry.mount("#card-expiry-element"),this.cardExpiry.addEventListener("change",(function(t){var e=c.$paymentTab.find(".card-expiry-error");t.error?e.removeClass("hidden"):e.addClass("hidden")}))),this.cardCvc||(this.cardCvc=l.create("cardCvc",{style:this.cardStyle,placeholder:"Security code"}),this.cardCvc.mount("#card-cvc-element"),this.cardCvc.addEventListener("change",(function(t){var e=c.$paymentTab.find(".card-cvc-error");t.error?e.removeClass("hidden"):e.addClass("hidden")}))),this.form||(this.form=document.getElementById("payment-form"),this.form.addEventListener("submit",this.onPaymentFormSubmit.bind(this)));case 43:case"end":return t.stop()}}),t,this)}))),function(){return G.apply(this,arguments)}),renderCheckoutForm:function(){var t=this,e=this.mag.eCommerceManager.getStripeConnectedUserId();this.stripe||(this.stripe=Stripe(at,{stripeAccount:e}));var i=this.stripe.elements();this.cardNumber||(this.cardNumber=i.create("cardNumber",{style:this.cardStyle,placeholder:"Card number"}),this.cardNumber.mount("#card-number-element"),this.cardNumber.addEventListener("change",(function(e){var i=t.$paymentTab.find(".card-number-error");e.error?i.removeClass("hidden"):i.addClass("hidden")})),this.cardNumber.addEventListener("ready",(function(e){t.renderCartHolderInput()}))),this.cardExpiry||(this.cardExpiry=i.create("cardExpiry",{style:this.cardStyle,placeholder:"M/Y"}),this.cardExpiry.mount("#card-expiry-element"),this.cardExpiry.addEventListener("change",(function(e){var i=t.$paymentTab.find(".card-expiry-error");e.error?i.removeClass("hidden"):i.addClass("hidden")}))),this.cardCvc||(this.cardCvc=i.create("cardCvc",{style:this.cardStyle,placeholder:"Security code"}),this.cardCvc.mount("#card-cvc-element"),this.cardCvc.addEventListener("change",(function(e){var i=t.$paymentTab.find(".card-cvc-error");e.error?i.removeClass("hidden"):i.addClass("hidden")}))),this.form||(this.form=document.getElementById("payment-form"),this.form.addEventListener("submit",this.onPaymentFormSubmit.bind(this)))},renderCartHolderInput:function(){this.cardHolderName||(this.cardHolderName=this.$paymentTab.find(".card-name-input"),this.cardHolderName.removeClass("hidden"),this.cardHolderName.on("input",this.onCardHolderNameChange))},onCardHolderNameChange:function(t){this.cardHolderNameValue=t.target.value,this.cardHolderNameValue?this.$paymentTab.find(".card-name-error").hasClass("hidden")||this.$paymentTab.find(".card-name-error").addClass("hidden"):this.$paymentTab.find(".card-name-error").hasClass("hidden")&&this.$paymentTab.find(".card-name-error").removeClass("hidden")},onPaymentFormSubmit:function(t){t.preventDefault(),this.cardHolderNameValue?(this.$paymentTab.find(".card-name-error").addClass("hidden"),this.haveSkus?this.onSkuPaymentFormSubmit():this.havePrices&&this.onPricesPaymentFormSubmit()):this.$paymentTab.find(".card-name-error").removeClass("hidden")},onSkuPaymentFormSubmit:function(){var t=this;this.stripe.createToken(this.cardNumber,{name:this.cardHolderNameValue}).then((function(e){e.error||t.stripeTokenHandler(e.token)}))},onPricesPaymentFormSubmit:function(){var t=this;this.clientSecret?(this.hideErrorPaymentMessage(),this.showPaymentLoader(),this.stripe.confirmCardPayment(this.clientSecret,{payment_method:{card:this.cardNumber,billing_details:{name:this.cardHolderNameValue}}}).then((function(e){e.error?(t.hidePaymentLoader(),t.showErrorPaymentMessage("Payment Failed on confirmCardPayment"),t.checkoutCompete=!0):(t.hidePaymentLoader(),"succeeded"===e.paymentIntent.status&&(t.showSuccessPaymentMessage(),RM.analytics&&RM.analytics.sendEvent("Checkout success")),t.checkoutCompete=!0)}))):this.showErrorPaymentMessage("Not client secret")},stripeTokenHandler:function(t,e){var i=this.mag.eCommerceManager.getOrder();if(i){var o=i.email;o?(this.hideErrorPaymentMessage(),this.showPaymentLoader(),n.a.ajax({type:"POST",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/orders/"+i.id+"/pay/",data:JSON.stringify({stripe_token:t.id,email:o}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){this.hidePaymentLoader(),t&&t.data&&("paid"===t.data.status&&(RM.analytics&&RM.analytics.sendEvent("Checkout success"),this.showSuccessPaymentMessage(),"function"==typeof e&&e({status:"success"})),this.checkoutCompete=!0)}.bind(this),error:function(){this.hidePaymentLoader(),this.showErrorPaymentMessage("Payment Failed"),"function"==typeof e&&e({status:"fail"}),this.checkoutCompete=!0}.bind(this)})):this.showErrorPaymentMessage("Email is required")}else this.showErrorPaymentMessage("Order not found")},showPaymentLoader:function(){this.paymentLoading||(this.paymentLoading=!0,this.$paymentTab.find(".preloader").addClass("show"),this.$paymentTab.find(".cart-payment-btn").css("display","none"),this.$paymentTab.find(".cart-cancel-btn").css("display","none"))},hidePaymentLoader:function(){this.paymentLoading&&(this.paymentLoading=!1,this.$paymentTab.find(".preloader").removeClass("show"),this.$paymentTab.find(".cart-payment-btn").css("display","block"),this.$paymentTab.find(".cart-cancel-btn").css("display","block"))},showErrorPaymentMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$paymentFailed.find(".error-message").text(t),this.$paymentFailed.addClass("show")},hideErrorPaymentMessage:function(){this.$paymentFailed.find(".error-message").empty(),this.$paymentFailed.removeClass("show")},showSuccessPaymentMessage:function(){this.$paymentTab.find(".sidebar-header").css("display","none"),this.$paymentTab.find(".sidebar-body").css("display","none"),this.$paymentSuccess.addClass("show")},hideSuccessPaymentMessage:function(){this.$paymentTab.find(".sidebar-header").css("display","block"),this.$paymentTab.find(".sidebar-body").css("display","block"),this.$paymentSuccess.removeClass("show")},toogleSettings:function(){this.isHiddenSettings=!this.isHiddenSettings,this.settingsPanel&&(this.settingsPanel.isHidden=this.isHiddenSettings)},getSettingsData:function(){var t={};if(this.cartWidgetData){var e=r.a.clone(this.cartWidgetData);t={"bar-color":e["bar-color"],"bar-color-opacity":e["bar-color-opacity"],"bar-background-color":e["bar-background-color"],"bar-background-color-opacity":e["bar-background-color-opacity"],"bar-shadow":e["bar-shadow"],"bar-font-family":e["bar-font-family"],"bar-font-style":e["bar-font-style"],"bar-font-weight":e["bar-font-weight"],"bar-letter-spacing":e["bar-letter-spacing"]}}return{isHidden:this.isHiddenSettings,model:t,onOverlayClick:this.onSettingsOverlayClick.bind(this)}},setupSettingsPanel:(W=U(regeneratorRuntime.mark((function t(){var e,o,a,s,l,c,d,h,u,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(i.bind(null,"tf3M"));case 2:return e=t.sent,o=e.default,t.next=6,i.e(6).then(i.bind(null,"YOpb"));case 6:return a=t.sent,s=a.default,t.next=10,Promise.resolve().then(i.bind(null,"nnuN"));case 10:return l=t.sent,c=l.default,this.cartWidgetModel=new o(this.cartWidgetData),this.saveModelChanges_debounced=r.a.debounce(this.saveModelChanges.bind(this),80),RM.constructorRouter&&RM.constructorRouter.mag&&!RM.constructorRouter.mag.get("_id")&&(RM.constructorRouter.isOwner=r.a.isEmpty(RM.constructorRouter.previewMag.get("shared")),RM.constructorRouter.previewMag.edit_params=new s(RM.constructorRouter.previewMag.get("edit_params"),RM.constructorRouter.previewMag),RM.constructorRouter.previewMag.unset("edit_params"),RM.constructorRouter.previewMag.filterUnusedFonts(),RM.constructorRouter.fonts=new c(RM.constructorRouter.previewMag.edit_params)),this.$settingButton=Object(n.a)("<div>",{class:"settings-button-wrap",attr:{"data-alt":"Settings","data-alt-pos":"bottom","data-alt-offset":"9"}}),this.$settingButton.append(Object(n.a)("<img>",{class:"settings-button svg",src:Object(L.findImagePath)("./constructor/controls/cart_settings/cart-sidebar-settings.svg")})),Object(n.a)(".sidebar-settings-container").append(this.$settingButton),this.$settingButton.on("click",this.toogleSettings),this.$settingButton.RMAltText(),P()(this.$settingButton.find(".svg")),t.next=23,i.e(5).then(i.bind(null,"MErq"));case 23:return d=t.sent,h=d.default,t.next=27,Promise.resolve().then(i.bind(null,"Kw5r"));case 27:u=t.sent,p=u.default,m=p.extend(h),this.settingsPanel=new m({el:Object(n.a)('<div id="sidebar-settings-panel">').appendTo(document.body).get(0),data:this.getSettingsData()}),this.settingsPanel.$on("change",this.onModelChange);case 32:case"end":return t.stop()}}),t,this)}))),function(){return W.apply(this,arguments)}),onSettingsOverlayClick:function(){this.toogleSettings()},onModelChange:function(t){this.saveModelChanges_debounced(t)},saveModelChanges:function(t){var e=this;this.updateCartWidgetData(t),this.generateSidebarCSS(this.cartWidgetData),this.cartWidgetModel&&this.cartWidgetModel.save(t,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){e.renderSidebarTexts()}))},updateCartWidgetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cartWidgetData=H(H({},this.cartWidgetData),t)},checkShippableInCart:function(){var t=this.mag.eCommerceManager.getCartData();for(var e in t.skus)if(t.skus[e].productObject.shippable)return!0;return!1},destroy:function(){var t=this;if(this.rendered)return this.checkoutCompete&&(this.mag.eCommerceManager.clearCart(),this.goToInitialTab(),this.hideSuccessPaymentMessage(),this.$paymentFailed.empty()),this.mag.eCommerceManager.events.off("ecommerce:cartsidebar:visibility:changed"),this.mag.eCommerceManager.events.off("ecommerce:cartdata:changed"),this.form&&this.form.removeEventListener("submit",this.onPaymentFormSubmit),this.cardHolderName&&this.cardHolderName.off("input",this.onCardHolderNameChange),this.$tabs.find("[data-tab^='tab-']").each((function(t,e){Object(n.a)(e).off("click")})),this.$items.find(".cart-item-remove-btn").each((function(t,e){Object(n.a)(e).off("click")})),this.$tabs.find(".order-details-form .form-input").each((function(e,i){Object(n.a)(i).off("input",t.onShippingFormChange)})),this.unbindDomEvents(),this.settingsPanel&&(this.settingsPanel.$off("change",this.onModelChange),this.settingsPanel.$destroy()),this.$settingButton&&this.$settingButton.off("click",this.toogleSettings),this.environment===h.a.environment.preview&&this.unbindTextInputsEvents(),this.remove()},cartItemBlockHover:function(t){var e=Object(n.a)(t.currentTarget);e&&e.length&&(e.addClass("hover").siblings().removeClass("hover"),this.hoveredItem=e.data("price-id")||e.data("sku-id"))},cartItemBlockLeave:function(t){var e=Object(n.a)(t.currentTarget);e&&e.length&&(e.removeClass("hover"),(e.data("price-id")||e.data("sku-id"))===this.hoveredItem&&(this.hoveredItem=null))}}),st=i("wd/R"),lt=i.n(st);function ct(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function dt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ht(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?dt(Object(i),!0).forEach((function(e){ut(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):dt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ut(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var pt=Backbone.View.extend({template:A.a["template-viewer-cart-sidebar"],initialize:function(t){return r.a.bindAll(this),this.mag=t,this.environment=this.mag.router.environment,this.rendered=!1,this.havePrices=!1,this.isHiddenSettings=!0,this.hoveredItem=null,this.render(),this},render:function(){if(!RM.screenshot){var t=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");if(t&&t.can_use_e_commerce&&!this.mag.eCommerceManager.isConstructor()&&this.mag.eCommerceManager.haveEcommerceCartWidget&&this.mag.eCommerceManager.getConnectedProvider()&&!this.rendered){this.rendered=!0,this.provider=this.mag.eCommerceManager.getConnectedProvider(),document.querySelectorAll("#cart-sidebar").length&&document.querySelectorAll("#cart-sidebar").forEach((function(t){return t.parentNode.removeChild(t)})),this.setElement(this.template({isMobile:Object(M.isMobile)(),isViewer:this.environment===h.a.environment.viewer})),this.$el.appendTo(Object(n.a)("body")),this.$toolbar=Object(n.a)(".toolbar.for-viewer"),this.$tabs=this.$el.find(".cart-sidebar-tabs"),this.$items=this.$el.find(".cart-items-list"),this.$closeButton=this.$el.find(".close-button"),this.$footer=this.$el.find(".sidebar-footer"),this.$calcTextContainer=this.$el.find(".text-size-calc-container"),this.$itemsTab=this.$tabs.find(".tab-items"),this.$checkOutButton=this.$itemsTab.find(".сheck-out-btn"),this.cartWidgetData=this.mag.eCommerceManager.getCartWidgetData(),this.environment===h.a.environment.preview&&(this.cartWidgetData&&this.cartWidgetData._id&&this.setupSettingsPanel(),window.RM.constructorRouter.on("previewClose",this.closeSideBar.bind(this)),this.bindTextInputsEvents());var e=this.$el.find(".svg");P()(e),this.$el.find("[data-alt]:not(.rmalttext)").RMAltText(),this.generateSidebarCSS(this.cartWidgetData);var i=this.mag.eCommerceManager.getEcommerceData();return Object(n.a)('<div class="ec-cart-widget"></div><div><script data-cfasync="false" type="text/javascript" src="https://app.ecwid.com/script.js?'.concat(i.ecwid.serviceData.storeId,"&data_platform=code&data_date=").concat(lt()(this.mag.published?this.mag.published:this.mag.creation_date).format("YYYY-MM-DD"),'" charset="utf-8"><\/script></div>')).appendTo(this.$el),this.renderSidebarTexts(),this.renderCartItems(),this.bindDomEvents(),R.a.on("ecommerce:cartsidebar:visibility:changed",this.toggleSidebar),this.mag.eCommerceManager.events.on("ecommerce:cartdata:changed",this.renderCartItems),this}}},bindDomEvents:function(){this.$closeButton.on("click",this.closeSideBar.bind(this)),this.$checkOutButton.on("click",this.goToCheckout.bind(this)),Object(n.a)(document).on("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),Object(n.a)(document).on("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave),this.bindStaticTextFieldsHovers()},unbindDomEvents:function(){this.$closeButton.off("click",this.closeSideBar),this.$checkOutButton.off("click",this.goToCheckout.bind(this)),Object(n.a)(document).off("mouseover",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockHover),Object(n.a)(document).off("mouseleave",".cart-sidebar .sidebar-body .cart-item-block",this.cartItemBlockLeave)},bindStaticTextFieldsHovers:function(){this.environment===h.a.environment.preview&&(this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseover",(function(t){Object(n.a)(t.target).addClass("active")})),this.$itemsTab.find(".cart-title-input, .empty-cart-title-input").on("mouseleave",(function(t){Object(n.a)(t.target).is(":focus")||Object(n.a)(t.target).removeClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseover",(function(t){Object(n.a)(t.target).find(".cart-checkout-input").addClass("active")})),this.$itemsTab.find(".сheck-out-btn").on("mouseleave",(function(t){var e=Object(n.a)(t.target).find(".cart-checkout-input");e.is(":focus")||e.removeClass("active")})))},hideSidebar:function(){this.$el.removeClass("show"),Object(n.a)("body").removeClass("cart-sidebar-shown"),Object(n.a)("html").removeClass("cart-disable-scroll"),!this.isHiddenSettings&&this.settingsPanel&&(this.isHiddenSettings=!0,this.settingsPanel.isHidden=this.isHiddenSettings)},toggleSidebar:function(t){t?this.hideSidebar():(this.$el.addClass("show"),Object(n.a)("body").addClass("cart-sidebar-shown"),Object(n.a)("html").addClass("cart-disable-scroll"))},closeSideBar:function(){this.mag.eCommerceManager.isCartSidebarHidden||this.mag.eCommerceManager.changeCartSidebarVisibility()},generateSidebarCSS:function(t){this.stylesElementId="cart_sidebar_styles_".concat(t._id);var e=d.default.getRGBA(t["bar-color"],t["bar-color-opacity"]/100),i=d.default.getRGBA(t["bar-background-color"],t["bar-background-color-opacity"]/100),o=d.default.getRGBA(t["bar-color"],.45*t["bar-color-opacity"]/100),a=this.getAdditionalColor(i),r="    .cart-sidebar {\n\n      color: ".concat(e,";\n      background-color: ").concat(i,";\n      box-shadow: ").concat(t["bar-shadow"]?"0 0 4px rgba(124, 124, 125, 0.5)":"none",";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar textarea {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input {\n\n      color: ").concat(e,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar input::placeholder {\n\n      color: ").concat(o,";\n    }\n\n    .cart-sidebar .cart-title-input.active {\n\n      border-color: ").concat(Object(E.e)(.8,e),";\n    }\n\n    .cart-sidebar .empty-cart-title-input.active {\n\n      border-color: ").concat(Object(E.e)(.8,e),";\n    }\n\n    .cart-sidebar .cart-price-input.active, .cart-sidebar .cart-quantity-input.active {\n\n      border-color: ").concat(Object(E.e)(.2,o),";\n    }\n\n    .cart-sidebar .cart-checkout-input.active {\n\n      border-color: ").concat(Object(E.e)(.8,e),";\n    }\n\n    .cart-sidebar .cart-price-input {\n\n      color: ").concat(o,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .cart-quantity-input {\n\n      color: ").concat(o,";\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar button {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar select {\n\n      font-family: ").concat(t["bar-font-family"],";\n      font-weight: ").concat(t["bar-font-weight"],";\n      font-style: ").concat(t["bar-font-style"],";\n    }\n\n    .cart-sidebar .sidebar-btn {\n\n      color: ").concat(e,";\n      border-color: ").concat(o,";\n    }\n\n    .cart-sidebar .preloader svg path {\n\n      stroke: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-btn path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .expand-arrow svg path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .cart-cancel-btn {\n\n      color: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block.hover {\n\n      background-color: ").concat(a,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-attributes {\n\n      color: ").concat(o,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-price {\n\n      color: ").concat(o,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-items-quantity {\n\n      color: ").concat(o,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-remove-btn-icon path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-decrease-btn-icon rect {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-body .cart-item-block .cart-item-increase-btn-icon path {\n\n      fill: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button path {\n\n      stroke: ").concat(e,";\n    }\n\n    .cart-sidebar .sidebar-settings-container .settings-button:hover path {\n\n      stroke: ").concat(o,";\n    }\n\n    .cart-sidebar.cart-is-mobile .sidebar-body .cart-item-block {\n\n      background-color: ").concat(a,";\n    }");Object(n.a)("#".concat(this.stylesElementId)).remove();var s=document.createElement("style");s.type="text/css",s.id=this.stylesElementId,s.className="cart-sidebar-styles",s.appendChild(document.createTextNode(r)),document.querySelector("head").appendChild(s)},getAdditionalColor:function(t){return Object(E.c)(t)<.05&&Object(E.b)("#fff",t)-Object(E.b)("#000",t)>=8?Object(E.d)(.1,t):Object(E.a)(.1,t)},renderCartItems:function(){var t=this.mag.eCommerceManager.getCartData();if(t){var e=Object.keys(t.prices);this.$items.empty(),this.havePrices=Boolean(e.length),this.havePrices?(this.$itemsTab.find(".сheck-out-btn").css("display","block"),this.$itemsTab.find(".empty-cart").css("display","none")):(this.$itemsTab.find(".сheck-out-btn").css("display","none"),this.$itemsTab.find(".empty-cart").css("display","flex")),this.renderPricesCartItems(e);var i=this.$items.find(".svg");P()(i),this.renderSidebarTexts(),this.unbindTextInputsEvents(!0),this.bindTextInputsEvents(!0)}},renderPricesCartItems:function(t){var e=this,i=this.mag.eCommerceManager.getCartData();t.forEach((function(t){var n=i.prices[t];n.active&&e.renderCartItem(n)}))},renderCartItem:function(t){var e,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"price",a=this.mag.eCommerceManager.getCartItenKey(t),r=this.hoveredItem===a,s=Object(n.a)("<div/>",{class:"cart-item-block".concat(r?" hover":"")});s.data("".concat(o,"-id"),a);var l=(null===(e=t.selectedCombination)||void 0===e?void 0:e.thumbnailUrl)||t.image||t.images&&t.images.length;if(l){var c=this.getProductImage(t);i=Object(n.a)("<div/>",{class:"cart-item-image",css:{"background-position":"center center","background-size":"cover","background-repeat":"no-repeat","background-image":"url(".concat(c,")")}}),s.append(i)}var d=Object(n.a)("<div/>",{class:i?"cart-item-title":"cart-item-title without-image"}).text(t.nameTranslated&&t.nameTranslated[this.mag.eCommerceManager.userLocale]?t.nameTranslated[this.mag.eCommerceManager.userLocale]:t.name),h=t.cart_count,u=this.getOneItemPrice(t),p=D(u,t.currency),m=D((u*h).toFixed(2),t.currency),g=Object(n.a)("<div/>",{class:"cart-item-price"}),f=Object(n.a)("<input/>",{type:"text",class:"cart-text-input cart-price-input",name:"price",placeholder:"Price",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});f.get(0).dataset.dynamicWidth=!0;var v=Object(n.a)("<span/>").html(h>1?": ".concat(p," × ").concat(h," = ").concat(m):": ".concat(p));g.append(f).append(v);var b=this.getTranslatedOptions(t),y=Object(n.a)("<div/>",{class:"cart-items-quantity"}),_=Object(n.a)("<input/>",{type:"text",class:"cart-text-input cart-quantity-input",name:"quantity",placeholder:"Quantity",maxlength:"32",translate:"no",autocomplete:"no",autocorrect:"no",spellcheck:"false"});_.get(0).dataset.dynamicWidth=!0;var w=Object(n.a)("<span/>").html(": ".concat(h));y.append(_).append(w);var k=Object(n.a)("<div/>",{class:"cart-item-remove-btn",title:"remove"}).attr("data-".concat(o,"-id"),a),S=Object(n.a)("<img/>",{class:"svg cart-item-remove-btn-icon",src:Object(L.findImagePath)("./viewer/cart-sidebar/cart-item-delete.svg")});k.append(S),k.on("click",this.onRemoveItem);var x=Object(n.a)("<div/>",{class:"cart-item-edit-group"}),C=Object(n.a)("<div/>",{class:"cart-item-increase-btn"}).attr("data-".concat(o,"-id"),a),O=Object(n.a)("<img/>",{class:"svg cart-item-increase-btn-icon",src:Object(L.findImagePath)("./viewer/cart-sidebar/cart-item-increase.svg")});if(C.append(O),x.append(C),this.mag.eCommerceManager.isOutOfStock(t)||(C.addClass("active"),C.on("click",this.onIncreaseItem)),h>1){var j=Object(n.a)("<div/>",{class:"cart-item-decrease-btn decrease-btn-".concat(a)}).attr("data-".concat(o,"-id"),a),P=Object(n.a)("<img/>",{class:"svg cart-item-decrease-btn-icon",src:Object(L.findImagePath)("./viewer/cart-sidebar/cart-item-decrease.svg")});j.append(P),x.append(j),j.on("click",this.onDecreaseItem)}else{var E=this.$items.find("decrease-btn-".concat(a));E.off("click",this.onDecreaseItem),E.remove()}s.append(d).append(b).append(g).append(y).append(k).append(x),this.$items.append(s)},getProductImage:function(t){var e;return(null===(e=t.selectedCombination)||void 0===e?void 0:e.thumbnailUrl)?t.selectedCombination.thumbnailUrl:t.image?t.image:t.images?t.images[0]:""},getTranslatedOptions:function(t){var e=this;if(t.selectedOptions){var i=Object(n.a)("<div/>",{class:"cart-item-attributes"});return Object.keys(t.selectedOptions).forEach((function(o){var a=d.default.capitalize(o),r=t.selectedOptions[o],s=e.mag.eCommerceManager.userLocale,l=t.options.find((function(t){return t.name===o}));if((null==l?void 0:l.nameTranslated)&&(null==l?void 0:l.nameTranslated[s])&&(a=d.default.capitalize(l.nameTranslated[s])),null==l?void 0:l.choices){var c=l.choices.find((function(e){return e.text===t.selectedOptions[o]}));(null==c?void 0:c.textTranslated)&&(null==c?void 0:c.textTranslated[s])&&(r=c.textTranslated[s])}var h=Object(n.a)("<div/>",{class:"cart-item-attribute"}).html("".concat(a,": ").concat(r));i.append(h)})),i}},getOneItemPrice:function(t){var e,i=t.price;return(null===(e=t.selectedCombination)||void 0===e?void 0:e.price)&&(i=t.selectedCombination.price),t.selectedOptions&&Object.keys(t.selectedOptions).forEach((function(e){var n=t.options.find((function(t){return t.name===e})),o=n?n.choices.find((function(i){return i.text===t.selectedOptions[e]})):null;o&&o.priceModifier&&("ABSOLUTE"===o.priceModifierType?i+=o.priceModifier:"PERCENT"===o.priceModifierType&&(i+=t.price*(o.priceModifier/100).toFixed(2)))})),i},onRemoveItem:function(t){t.currentTarget.dataset.priceId&&this.mag.eCommerceManager.removeFromCart(t.currentTarget.dataset.priceId)},onIncreaseItem:function(t){t.currentTarget.dataset.priceId&&this.mag.eCommerceManager.increaseCartItem(t.currentTarget.dataset.priceId)},onDecreaseItem:function(t){t.currentTarget.dataset.priceId&&this.mag.eCommerceManager.decreaseCartItem(t.currentTarget.dataset.priceId)},goToCheckout:function(t){var e=this;if(!t.isDefaultPrevented()){var i=this.mag.eCommerceManager.getCartData(),n=window.Ecwid;if(n){n.init();var o=Object.keys(i.prices),a=[];n.Cart.clear(),o.forEach((function(t){var r={id:Number(i.prices[t].id),quantity:i.prices[t].cart_count,callback:function(i,r,s){i&&function(t){a.push(t)}(t),o.length===a.length&&(n.OnOrderPlaced.add((function(){e.mag.eCommerceManager.clearCart(),e.mag.eCommerceManager.getProducts(e.mag.eCommerceManager.connectedProvider)})),n.Cart.gotoCheckout(),e.mag.eCommerceManager.getProducts(e.mag.eCommerceManager.connectedProvider).then((function(){e.mag.eCommerceManager.updateCartProductItems()})))}};i.prices[t].selectedOptions?r.options=ht({},i.prices[t].selectedOptions):i.prices[t].options.length&&i.prices[t].options.forEach((function(t){t.required&&(r.options||(r.options={}),r.options[t.name]=t.choices[t.defaultChoice])})),n.Cart.addProduct(r)}))}else alert("No Ecwid")}},getTextFieldModelKey:function(t){return"bar-".concat(t)},getSidebarTextValue:function(t){var e=this.getTextFieldModelKey(t);return this.cartWidgetData&&this.cartWidgetData[e]?T()(this.cartWidgetData[e]):h.a.defaultSidebarTexts[t]?h.a.defaultSidebarTexts[t]:null},calcTextFieldSize:function(t){if(!t)return null;var e=getComputedStyle(t);this.$calcTextContainer.css({"font-family":e.fontFamily,"font-size":e.fontSize,"font-style":e.fontStyle,"font-weight":e.fontWeight,"letter-spacing":e.letterSpacing}),this.$calcTextContainer.text(t.value);var i=this.$calcTextContainer.width();return Math.ceil(i)},renderSidebarTexts:function(){var t=this;this.$itemsTab.find(".cart-text-input").each((function(e,i){var n=i.getAttribute("name"),o=t.getSidebarTextValue(n);if(o&&(i.value=o,i.dataset.dynamicWidth)){var a=t.calcTextFieldSize(i);a&&(i.style.width="".concat(a,"px"))}}))},bindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){Object(n.a)(i).on("click",t.onTextFieldClick),Object(n.a)(i).on("input",t.onTextFieldChange),Object(n.a)(i).on("blur",t.onTextFieldBlur)})),e&&this.environment===h.a.environment.preview&&(this.$itemsTab.find(".cart-item-block").on("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").on("mouseleave",this.onDynamicMouseLeave))},unbindTextInputsEvents:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$itemsTab.find(".cart-text-input"+(e?'[data-dynamic-width="true"]':"")).each((function(e,i){Object(n.a)(i).off("click",t.onTextFieldClick),Object(n.a)(i).off("input",t.onTextFieldChange),Object(n.a)(i).off("blur",t.onTextFieldBlur)})),e&&this.environment===h.a.environment.preview&&(this.$itemsTab.find(".cart-item-block").off("mouseover",this.onDynamicMouseOver),this.$itemsTab.find(".cart-item-block").off("mouseleave",this.onDynamicMouseLeave))},onDynamicMouseOver:function(t){Object(n.a)(t.target).find(".cart-price-input, .cart-quantity-input").addClass("active")},onDynamicMouseLeave:function(t){Object(n.a)(t.target).find(".cart-price-input, .cart-quantity-input").each((function(){Object(n.a)(this).is(":focus")||Object(n.a)(this).removeClass("active")}))},onTextFieldClick:function(t){t.preventDefault()},onTextFieldChange:function(t){if(t.target.dataset.dynamicWidth){var e=this.calcTextFieldSize(t.target);e&&(t.target.style.width="".concat(e,"px"))}},onTextFieldFocus:function(t){this.environment===h.a.environment.preview&&Object(n.a)(t.target).addClass("active")},onTextFieldBlur:function(t){var e=this;this.environment===h.a.environment.preview&&Object(n.a)(t.target).removeClass("active");var i=t.target.getAttribute("name"),o=this.getSidebarTextValue(i);if(o)if(t.target.value){if(this.cartWidgetModel){var a=ut({},this.getTextFieldModelKey(i),t.target.value);this.updateCartWidgetData(a),this.cartWidgetModel.save(a,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){t.target.dataset.dynamicWidth&&e.renderSidebarTexts()}))}}else t.target.value=o},toogleSettings:function(){this.isHiddenSettings=!this.isHiddenSettings,this.settingsPanel&&(this.settingsPanel.isHidden=this.isHiddenSettings)},getSettingsData:function(){var t={};if(this.cartWidgetData){var e=r.a.clone(this.cartWidgetData);t={"bar-color":e["bar-color"],"bar-color-opacity":e["bar-color-opacity"],"bar-background-color":e["bar-background-color"],"bar-background-color-opacity":e["bar-background-color-opacity"],"bar-shadow":e["bar-shadow"],"bar-font-family":e["bar-font-family"],"bar-font-style":e["bar-font-style"],"bar-font-weight":e["bar-font-weight"],"bar-letter-spacing":e["bar-letter-spacing"]}}return{isHidden:this.isHiddenSettings,model:t,onOverlayClick:this.onSettingsOverlayClick.bind(this)}},setupSettingsPanel:function(){var t,e=(t=regeneratorRuntime.mark((function t(){var e,o,a,s,l,c,d,h,u,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(i.bind(null,"tf3M"));case 2:return e=t.sent,o=e.default,t.next=6,i.e(6).then(i.bind(null,"YOpb"));case 6:return a=t.sent,s=a.default,t.next=10,Promise.resolve().then(i.bind(null,"nnuN"));case 10:return l=t.sent,c=l.default,this.cartWidgetModel=new o(this.cartWidgetData),this.saveModelChanges_debounced=r.a.debounce(this.saveModelChanges.bind(this),80),RM.constructorRouter&&RM.constructorRouter.mag&&!RM.constructorRouter.mag.get("_id")&&(RM.constructorRouter.isOwner=r.a.isEmpty(RM.constructorRouter.previewMag.get("shared")),RM.constructorRouter.previewMag.edit_params=new s(RM.constructorRouter.previewMag.get("edit_params"),RM.constructorRouter.previewMag),RM.constructorRouter.previewMag.unset("edit_params"),RM.constructorRouter.previewMag.filterUnusedFonts(),RM.constructorRouter.fonts=new c(RM.constructorRouter.previewMag.edit_params)),this.$settingButton=Object(n.a)("<div>",{class:"settings-button-wrap",attr:{"data-alt":"Settings","data-alt-pos":"bottom","data-alt-offset":"9"}}),this.$settingButton.append(Object(n.a)("<img>",{class:"settings-button svg",src:Object(L.findImagePath)("./constructor/controls/cart_settings/cart-sidebar-settings.svg")})),Object(n.a)(".sidebar-settings-container").append(this.$settingButton),this.$settingButton.on("click",this.toogleSettings),this.$settingButton.RMAltText(),P()(this.$settingButton.find(".svg")),t.next=23,i.e(5).then(i.bind(null,"MErq"));case 23:return d=t.sent,h=d.default,t.next=27,Promise.resolve().then(i.bind(null,"Kw5r"));case 27:u=t.sent,p=u.default,m=p.extend(h),this.settingsPanel=new m({el:Object(n.a)('<div id="sidebar-settings-panel">').appendTo(document.body).get(0),data:this.getSettingsData()}),this.settingsPanel.$on("change",this.onModelChange);case 32:case"end":return t.stop()}}),t,this)})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){ct(a,n,o,r,s,"next",t)}function s(t){ct(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(){return e.apply(this,arguments)}}(),onSettingsOverlayClick:function(){this.toogleSettings()},onModelChange:function(t){this.saveModelChanges_debounced(t)},saveModelChanges:function(t){var e=this;this.updateCartWidgetData(t),this.generateSidebarCSS(this.cartWidgetData),this.cartWidgetModel&&this.cartWidgetModel.save(t,{toHistory:!1,skipHistory:!0,patch:!0}).then((function(){e.renderSidebarTexts()}))},updateCartWidgetData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.cartWidgetData=ht(ht({},this.cartWidgetData),t)},destroy:function(){if(this.rendered)return this.mag.eCommerceManager.events.off("ecommerce:cartsidebar:visibility:changed"),this.mag.eCommerceManager.events.off("ecommerce:cartdata:changed"),this.$items.find(".cart-item-remove-btn").each((function(t,e){Object(n.a)(e).off("click")})),this.unbindDomEvents(),this.settingsPanel&&(this.settingsPanel.$off("change",this.onModelChange),this.settingsPanel.$destroy()),this.$settingButton&&this.$settingButton.off("click",this.toogleSettings),this.environment===h.a.environment.preview&&this.unbindTextInputsEvents(),Object(n.a)("#".concat(this.stylesElementId)).remove(),this.remove()},cartItemBlockHover:function(t){var e=Object(n.a)(t.currentTarget);e&&e.length&&(e.addClass("hover").siblings().removeClass("hover"),this.hoveredItem=e.data("price-id")||e.data("sku-id"))},cartItemBlockLeave:function(t){var e=Object(n.a)(t.currentTarget);e&&e.length&&(e.removeClass("hover"),(e.data("price-id")||e.data("sku-id"))===this.hoveredItem&&(this.hoveredItem=null))}}),mt=i("CXd4"),gt=i.n(mt),ft=a.a.View.extend({ARROWS_SHOW_DELAY:1e3,BOTTOM_SHOW_DELAY:1e3,BOTTOM_HIDE_DELAY:0,template:gt.a["template-viewer-navigation"],events:{"click .navigation-arrow.left":"goPrevPage","click .navigation-arrow.right":"goNextPage","click .navigation-arrow.bottom":"scrollCurrentPage"},initialize:function(t){return r.a.bindAll(this),r.a.extend(this,t),this.updateScaleState.__debounced=r.a.debounce(this.updateScaleState,100),this},render:function(){return this.setElement(this.template({icons:{sprite:Object(L.findImagePath)("./common/navigation/sprite".concat(L.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.$prev=this.$(".navigation-arrow.left"),this.$next=this.$(".navigation-arrow.right"),this.$bottom=this.$(".navigation-arrow.bottom"),r.a.delay(r.a.bind((function(){this.$prev.removeClass("offscreen"),this.$next.removeClass("offscreen")}),this),this.ARROWS_SHOW_DELAY),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"finalPageShown",this.onFinalPageShow),this.listenTo(this.mag,"finalPageHidden",this.onFinalPageHide),this.listenTo(this.mag,"keypress-"+n.a.keycodes.left,this.goPrevPage),this.listenTo(this.mag,"keypress-"+n.a.keycodes.right,this.goNextPage),x.a.isDesktop&&Object(n.a)(window).bind("mousewheel",this.onMouseWheel),x.a.isDesktop||(Object(n.a)(window).bind("gesturechange",this.updateScaleState.__debounced),this.updateScaleState(),(this.mag.getPagesCount()>1||this.hasFinalPage)&&this.setSwipeAction()),this},destroy:function(){return x.a.isDesktop&&Object(n.a)(window).unbind("mousewheel",this.onMouseWheel),x.a.isDesktop||(Object(n.a)(window).unbind("gesturechange",this.updateScaleState.__debounced),this.pagesSwipe&&this.pagesSwipe.destroy()),this.remove()},onMouseWheel:function(t,e,i,n){this.preventTrackpadSwipeTill&&+new Date<this.preventTrackpadSwipeTill||Math.abs(i)>40&&Math.abs(i)>Math.abs(n)&&(i>0&&this.goPrevPage(),i<0&&this.goNextPage(),this.preventTrackpadSwipeTill=+new Date+1e3)},setSwipeAction:function(){this.pagesSwipe=this.mag.$mag_container.RMSwipe({$scrollElements:this.mag.$mag_container,getMaxTransitionSpeed:r.a.bind((function(){return this.mag.getPageTransitionTime()}),this),customMoveCheck:r.a.bind((function(t,e){if(this.hasFinalPage&&this.mag.isLastPage()){if(this.finalPageShown&&!t.hasClass("final-page"))return!1;if(!this.finalPageShown){if(!t.hasClass("final-page")&&e<0)return!1;if(t.hasClass("final-page")&&e>0)return!1}}return!(t.hasClass("prev-page")&&e<0)&&!(t.hasClass("next-page")&&e>0)}),this),beforeAutoAnimation:r.a.bind((function(t,e){return this.mag.isLastPage()&&this.hasFinalPage&&("left"===t&&!this.finalPageShown||"right"===t&&this.finalPageShown)?{autoAnimate:!0,immediateCallback:!0}:(this.mag.showPageCounter(t),{autoAnimate:!0,immediateCallback:!1})}),this),onSwipeStart:r.a.bind((function(){!this.finalPageShown&&this.mag.showPageCounter()}),this),getCurrentConstraints:r.a.bind((function(t){var e={},i=this.mag.$mag_container.width(),n=t.closest(".page, .final-page");return n.length||(n=this.mag.currentPage.$el),this.mag.isLastPage()&&this.hasFinalPage&&this.finalPageShown?e.$moveItems=n:e.$moveItems=n.add(n.prev()).add(n.next()),e.$referenceItem=e.$moveItems.filter(":not(.center-page)").first(),!this.mag.isLastPage()||this.hasFinalPage&&!this.finalPageShown?e.left={max:i}:e.left={max:0,noTrigger:!0},this.mag.isFirstPage()&&!this.finalPageShown?e.right={max:0,noTrigger:!0}:e.right={max:i},e}),this),callback:r.a.bind((function(t){"right"===t&&this.mag.goPrevPage({animation:!1,bySwipe:!0}),"left"===t&&this.mag.goNextPage({animation:!1,bySwipe:!0})}),this)}).data("swipe")},onFinalPageShow:function(){this.finalPageShown=!0,this.$next.addClass("hidden"),this.$bottom.addClass("final-page-offscreen"),this.$prev.toggleClass("hidden",!x.a.isDesktop)},onFinalPageHide:function(){this.finalPageShown=!1,this.$next.removeClass("hidden"),this.$bottom.removeClass("final-page-offscreen"),this.$prev.toggleClass("hidden",this.mag.isFirstPage())},onPageChange:function(t,e){this.$next.toggleClass("hidden",!(!this.mag.isLastPage()||this.mag.finalPage)||!(!this.mag.finalPage||!this.mag.finalPage.shown)),this.recalcBottomArrowState(t),this.$prev.toggleClass("hidden",this.mag.isFirstPage()),this.mag.updateArrowsColor(t)},recalcBottomArrowState:function(t){clearTimeout(this.bottomArrowTimeout);var e=t.isBottomArrowVisible();"horizontal"===this.viewerType&&v.a.isScaleLayout(this.mag.viewOpts)&&(e=!1),this.isPreview&&"default"!==this.mag.viewport&&(e=!1),this.bottomArrowTimeout=setTimeout(r.a.bind((function(){this.$bottom.toggleClass("offscreen",!e)}),this),e?this.BOTTOM_SHOW_DELAY:this.BOTTOM_HIDE_DELAY)},goPrevPage:function(t){this.mag.goPrevPage({animation:!0})},goNextPage:function(t){this.mag.goNextPage({animation:!0})},scrollCurrentPage:function(t){this.mag.scrollCurrentPageALittle()},updateScaleState:function(){Modernizr.android||this.$prev.add(this.$next).add(this.$bottom).toggleClass("scaled-offscreen",d.default.isPageNativelyScaled())}}),vt=i("Gw2y"),bt=i.n(vt),yt=i("BVsp"),_t=a.a.View.extend({template:bt.a["template-viewer-final-page"],events:{"click .recover .go":"onClickRecoverSubmit","click .join.ljr-panel .go":"onJoinButtonClick"},initialize:function(t){return r.a.bindAll(this),r.a.extend(this,t),this},render:function(){var t="empty";return"join"!==this.finalPageType||this.me||(t="join"),"join"===this.finalPageType&&(t="join"),this.setElement(this.template({mag:this.mag,disableSocials:this.isPrivate,recentMags:this.recentMags,tp:t,magLink:this.mag.getUrl(),isStickyVerticalViewer:this.isStickyVerticalViewer,tweetText:m.getFinalShare(null,r.a.extend(this.mag.model.toJSON(),{user:this.mag.user}),{forProject:!0,customDomain:RM.common.isDomainViewer}).tweet,specialRecentView:"recent"===t&&1===this.recentMags.length&&!x.a.isPhone,Constants:h.a})),Modernizr.safari&&this.unFocusInput(),this.$el.appendTo(this.$container),"join"===t&&new yt.default({useNavigate:!1,$node:this.$(".dop-container-join"),router:this.router}).render(),"horizontal"===this.viewerType?(this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"keypress-"+n.a.keycodes.esc,this.hide)):this.show(),this.setRecoverPanelTop(),this},onJoinButtonClick:function(){!this.$(".join.ljr-panel input").hasClass("err")&&this.$(".join.ljr-panel .go").hasClass("active")},onClickRecoverSubmit:function(){var t=this.$(".recover.ljr-panel .email-input").val();Object(n.a)(".recover.ljr-panel .send-message .recover-email").text(t)},unFocusInput:function(){this.$(".join.ljr-panel .email-input").one("focus",(function(){Object(n.a)(this).blur()}))},setRecoverPanelTop:function(){var t=window.matchMedia("(max-width: 768px)").matches,e=(this.getHeight()-Object(n.a)(".join.ljr-panel").outerHeight())/2+"px";Object(n.a)(".recover.ljr-panel").css({top:t?"0":e})},show:function(){return this.shown||(this.$el.removeClass("offscreen hidden"),this.shown=!0,"horizontal"===this.viewerType&&this.mag.trigger("finalPageShown")),this},hide:function(){return this.shown&&(this.$el.addClass("offscreen"),this.shown=!1,this.mag.trigger("finalPageHidden")),this},destroy:function(){return this.remove()},setSizeAndPosForStickyVersion:function(t){var e=window.matchMedia("(max-width: 768px)").matches;t=t||{},this.$(".recover.ljr-panel").hasClass("hidden")?(this.$(".dop-container-text").removeClass("hidden"),this.$el.css({height:e?this.$(".final-page-container").height():"100vh",top:t.absolutePosition})):(this.$(".dop-container-text").addClass("hidden"),this.$el.css({height:"100vh",top:t.absolutePosition}))},scrollOnVerticalMode:function(t){this.hasScrollOnVerticalMode=!0,this.$el.css("top",0),d.default.applyTransform(this.$(".final-page-wrapper"),"translateY("+-t+"px)")},resetScrollOnVerticalMode:function(){this.hasScrollOnVerticalMode&&(this.hasScrollOnVerticalMode=!1,this.$el.css("top",""),d.default.applyTransform(this.$(".final-page-wrapper"),""))},getHeight:function(){return this.$(".final-page-wrapper").height()},onPageChange:function(){this.$el.toggleClass("hidden",!this.mag.isLastPage()),this.hide()},onKeyUp:function(t){t.stopPropagation()}}),wt=i("Tu3F"),kt=i.n(wt),St=i("Wxmq"),xt=i.n(St),Ct=a.a.View.extend({template:xt.a["template-viewer-share"],events:{"click .buttons-wrapper .button":"share","click .send-report":"share","click .open-embed":"openEmbed","click .close":"hide","click .embed-wrapper .back":"closeEmbed","click .embed-wrapper .embed-code":"selectEmbedCode","keyup .embed-wrapper .embed-code":"onKeyUp","click .type-selector":"onTypeSelectorClick","click .size-selector":"onSizeSelectorClick",click:"onClick"},initialize:function(t){return r.a.bindAll(this),r.a.extend(this,t),this},render:function(){return this.setElement(this.template({hasOverlay:x.a.isPhone,common:RM.common,icons:{sprite:Object(L.findImagePath)("./viewer/share/sprite".concat(L.is2X?"@2x":"",".png")),thumbArrows:Object(L.findImagePath)("./viewer/share/thumb-arrows".concat(L.is2X?"@2x":"",".png")),thumbOpen:Object(L.findImagePath)("./viewer/share/thumb-open".concat(L.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.selectFullMode(),x.a.isPhone&&(this.shareSwipe=this.$el.RMSwipe({minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,beforeAutoAnimation:r.a.bind((function(t,e){return{autoAnimate:!0,immediateCallback:!0}}),this),getCurrentConstraints:r.a.bind((function(t){var e={},i=this.$el.filter(".share-popup");return e.$referenceItem=i,e.$moveItems=i,e.up={max:0,noTrigger:!0},e.down={max:i.height()},e}),this),callback:r.a.bind((function(t){this.hide()}),this)}).data("swipe")),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"finalPageShown",this.onFinalPageShow),this.listenTo(this.mag,"keypress-"+n.a.keycodes.esc,this.hide),Object(n.a)("body").on("click",this.hideOnBodyClick),this},show:function(){return this.shown||(clearTimeout(this.hideTimeout),this.$el.removeClass("hidden"),this.$el.height(),this.$el.addClass("show-popup"),this.$container.addClass("no-hover"),this.shown=!0,this.updateEmbed()),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.$el.removeClass("show-popup"),this.$container.removeClass("no-hover"),this.hideTimeout=setTimeout(r.a.bind((function(){this.closeEmbed(),this.$el.addClass("hidden")}),this),400),this.shown=!1),this},destroy:function(){return clearTimeout(this.hideTimeout),Object(n.a)("body").off("click",this.hideOnBodyClick),this.shareSwipe&&this.shareSwipe.destroy(),this.remove()},hideOnBodyClick:function(t){x.a.isPhone||Object(n.a)(t.target).closest(this.$container).length||this.hide()},onPageChange:function(t,e){this.hide()},onFinalPageShow:function(){this.hide()},onClick:function(t){x.a.isPhone&&Object(n.a)(t.currentTarget).hasClass("share-popup-overlay")&&this.hide()},onKeyUp:function(t){t.stopPropagation()},openEmbed:function(t){this.router.analytics&&this.router.analytics.sendEvent("Embed","contents ("+this.shareMode+")"),this.selectEmbedCode(),this.$el.addClass("show-embed")},updateEmbed:function(){var t,e=this.mag.currentPage||this.mag.pages[0],i=this.$(".size-selector").attr("data-selected");this.$(".embed-wrapper .embed-code").val(Ct.getEmbedCode({shareMode:this.shareMode,cur_page_num_id:e.num_id,mag_num_id:this.mag.num_id,size:{responsive:"responsive",big:512,small:288}[i]})),t=this.mag.model.getPageScreenshot(256,{_id:"page"===this.shareMode?e._id:this.mag.coverPid}),this.currentEmbedSrc!==t&&(this.$(".thumb-pic").attr("src",t),this.currentEmbedSrc=t)},closeEmbed:function(){this.$el.removeClass("show-embed")},share:function(t){m.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:Object(n.a)(t.currentTarget).attr("data-tp"),source:"share panel",page:this.mag.currentPage||this.mag.pages[0],mag:r.a.extend(this.mag.model.toJSON(),{user:this.mag.user}),forProject:"full"===this.shareMode,customDomain:!(!RM.common.isDomainViewer&&!RM.common.embedDomainName),customDomainProfile:!(!RM.common.customDomainProfile&&"User"!==RM.common.embedDomainType),analytics:this.router.analytics,exportBasePath:window.RM.common.isDownloadedSource?window.RM.config&&window.RM.config.root:void 0})},onTypeSelectorClick:function(t){if(x.a.isPhone){var e=Object(n.a)(t.target);e.closest(".type-full").length&&this.selectFullMode(),e.closest(".type-page").length&&this.selectPageMode()}else{"page"===(this.$(".type-selector").attr("data-tp")||"page")?this.selectFullMode():this.selectPageMode()}},onSizeSelectorClick:function(t){var e,i,o=Object(n.a)(t.currentTarget),a=o.attr("data-selected");i=(i=(e=r.a.map(o.find(".size"),(function(t){return Object(n.a)(t).attr("data-size")}))).indexOf(a)+1)>=e.length?0:i,o.attr("data-selected",e[i]),this.updateEmbed()},selectPageMode:function(){this.$(".type-selector").attr("data-tp","page"),this.shareMode="page",this.updateEmbed()},selectFullMode:function(){this.$(".type-selector").attr("data-tp","full"),this.shareMode="full",this.updateEmbed()},selectEmbedCode:function(){x.a.isDesktop&&this.$(".embed-wrapper .embed-code").get(0).setSelectionRange(0,9999)}},{getEmbedCode:function(t){var e,i,n,o,a='<script async src="'+h.a.EMBED_SCRIPT_INIT+'" id="readymag-embed-init"><\/script>';return e=RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname,o=' data-uri="'+(i="full"===t.shareMode?t.mag_num_id:"p"+t.cur_page_num_id)+'" ',o+=' data-width="'+t.size+'" ',(RM.common.isDomainViewer||RM.common.embedDomainName)&&(o+=' data-domain="'+e+'" ',RM.common.customDomainProfile||"User"===RM.common.embedDomainType||(i="full"===t.shareMode?"":"p"+t.cur_page_num_id)),h.a.IS_LIVE||(o+=' data-origin="'+h.a.readymag_embed_host+'" '),'<a class="rm-mag-embed" href="'+(n=e+"/"+i)+'"'+o+' target="_blank">'+n+"</a>\n"+a}}),Ot=Ct,jt=i("QRzc"),Pt=i.n(jt),Et=a.a.View.extend({template:Pt.a["template-viewer-mag-menu"],events:{"click .page":"onPageClick"},initialize:function(t){return r.a.bindAll(this),r.a.extend(this,t),this.IMG_STUB=Object(L.findImagePath)("./spacer.gif"),x.a.isPhone?"horizontal"===this.viewerType?(this.PAGE_WIDTH=140,this.PAGE_HEIGHT=92):(this.PAGE_WIDTH=240,this.PAGE_HEIGHT=158):(this.PAGE_WIDTH="vertical"===this.viewerType?240:280,this.PAGE_HEIGHT="vertical"===this.viewerType?158:184),this.loadVisibleScreenshots.__debounced=r.a.debounce(this.loadVisibleScreenshots,500),this.unloadInvisibleScreenshots.__debounced=r.a.debounce(this.unloadInvisibleScreenshots,3e3),this},render:function(){this.setElement(this.template({mag:this.mag,pages:this.pages,width:this.PAGE_WIDTH,height:this.PAGE_HEIGHT,stub:this.IMG_STUB,viewerType:this.viewerType,publishDate:this.publishDate,hasProjectInfo:this.hasProjectInfo,common:RM.common})),this.$el.appendTo(this.$container),this.$pagesWrapper=this.$(".pages-wrapper");var t=this.$(".page");if("horizontal"==this.viewerType?(this.$(".pages").css("width",t.length*this.PAGE_WIDTH),this.$pagesWrapper.scrollLeft(99999)):(this.$(".pages").css("height",t.length*this.PAGE_HEIGHT),this.$pagesWrapper.scrollTop(99999)),x.a.isDesktop&&(this.scroll=this.$(".scroll-wrapper").RMScroll({$container:this.$pagesWrapper,$content:this.$(".pages"),$handle:this.$(".scroll"),wheelScrollSpeed:1.3,gap_start:8,gap_end:8,maxHandleSize:136,dragScroll:!0,tp:this.viewerType}).data("scroll")),this.$pagesWrapper.bind("scroll",this.onScroll),this.cacheSize(),this.cacheScroll(),this.cachePagesPos(),this.loadedScreenshots={},this.showInitially&&(this.loadVisibleScreenshots(),this.show(!0)),"horizontal"==this.viewerType&&x.a.isPhone||Object(n.a)(".menu-info .mag-title").dotdotdot({height:x.a.isPhone?48:68,wrap:"letter",callback:r.a.bind((function(t,e){t&&this.$(".menu-info .mag-title").attr("title",this.mag.title)}),this)}),!x.a.isDesktop){var e="horizontal"==this.viewerType?this.$el.height():this.$el.width(),i=this.$el.add(this.$toolbar);"horizontal"==this.viewerType&&this.mag.navigation&&(i=i.add(this.mag.navigation.$bottom)),this.menuSwipe=i.RMSwipe({$scrollElements:this.$pagesWrapper,minTransitionSpeed:200,maxTransitionSpeed:400,rubberBand:!1,getCurrentConstraints:r.a.bind((function(){var t={};return t.$referenceItem=this.$el,t="horizontal"==this.viewerType?this.shown?{up:{max:0,noTrigger:!0},down:{max:e}}:{up:{max:e},down:{max:0,noTrigger:!0}}:this.shown?{left:{max:0,noTrigger:!0},right:{max:e}}:{left:{max:e},right:{max:0,noTrigger:!0}}}),this),callback:r.a.bind((function(t){this.shown?this.hide():this.show()}),this)}).data("swipe")}return this.isPreview&&this.listenTo(RM.constructorRouter,"renewScreenshot",this.renewScreenshot),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"finalPageShown",this.onFinalPageShow),this.listenTo(this.mag,"finalPageHidden",this.onFinalPageHide),this.listenTo(this.mag,"keypress-"+n.a.keycodes.m,this.toggle),this.listenTo(this.mag,"keypress-"+n.a.keycodes.esc,this.hide),R.a.on("constructorSettings:open",this.show),R.a.on("constructorSettings:close",this.hide),Object(n.a)(window).on("resize",this.onResize),this.$el.bind("mousewheel",this.onMouseWheel),this},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.finalPageShown||this.shown||(this.shown=!0,e&&this.$el.css({transition:"none"}),this.mag.$el.addClass("viewer-mag-menu-shown"),Object(n.a)("html").addClass("mag-menu-shown"),this.mag.$el.toggleClass("viewer-mag-menu-no-project-info",!this.hasProjectInfo),this.loadOtherScreenshots(),this.mag.trigger("menuShown"),R.a.trigger("magMenu:open"),e&&setTimeout((function(){return t.$el.css({transition:""})}))),this},toggle:function(){return this.shown?this.hide():this.show()},hide:function(){return this.shown&&(this.mag.$el.removeClass("viewer-mag-menu-shown viewer-mag-menu-no-project-info"),Object(n.a)("html").removeClass("mag-menu-shown"),this.clearLoadOtherTimeout(),this.mag.focusCurrentPage(),this.shown=!1,this.mag.trigger("menuHidden"),R.a.trigger("magMenu:close")),this},destroy:function(){return Object(n.a)(window).off("resize",this.onResize),Object(n.a)("html").removeClass("mag-menu-shown"),R.a.trigger("magMenu:close"),this.$el.unbind("mousewheel",this.onMouseWheel),this.menuSwipe&&this.menuSwipe.destroy(),this.$pagesWrapper.unbind("scroll",this.onScroll),R.a.off("constructorSettings:open",this.show),R.a.off("constructorSettings:close",this.hide),this.remove()},onMouseWheel:function(t){t.preventDefault()},onResize:function(){this.cacheSize(),this.scroll&&this.scroll.recalc(),this.mag.currentPage&&this.shiftToPage(this.mag.currentPage.num,!1)},onScroll:function(){this.cacheScroll()},cacheSize:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollSize="horizontal"==this.viewerType?this.$pagesWrapper.width():this.$pagesWrapper.height()},cacheScroll:function(){this.cachedData=this.cachedData||{},this.cachedData.scrollPos="horizontal"==this.viewerType?this.$pagesWrapper.scrollLeft():this.$pagesWrapper.scrollTop()},cachePagesPos:function(){this.cachedData=this.cachedData||{},this.cachedData.pagesPos={};var t=this.cachedData.pagesPos,e=this.viewerType,i=this.PAGE_WIDTH,n=this.PAGE_HEIGHT;r.a.each(this.pages,(function(o,a){t[o.num]=a*("horizontal"==e?i:n)}))},onPageChange:function(t,e){this.shown||(this.loadVisibleScreenshots.__debounced(),!x.a.isDesktop&&this.unloadInvisibleScreenshots.__debounced()),this.shiftToPage(t.num,this.shown),r.a.isEmpty(this.loadedScreenshots)&&this.loadVisibleScreenshots()},onFinalPageShow:function(){this.hide(),this.finalPageShown=!0},onFinalPageHide:function(){this.finalPageShown=!1},shiftToPage:function(t,e){var i,n=this.$('.page[data-num="'+t+'"]'),o=this.cachedData.scrollSize,a=this.cachedData.scrollPos,r="horizontal"==this.viewerType?this.PAGE_WIDTH:this.PAGE_HEIGHT,s=this.cachedData.pagesPos[t],l=a+r/2,c=a+o-r/2;if(this.$(".page.active").removeClass("active"),n.addClass("active"),s<l)i=s-l;else{if(!(s+r>c))return;i=s+r-c}var d={};d["horizontal"==this.viewerType?"scrollLeft":"scrollTop"]=a+i,this.$pagesWrapper.stop().animate(d,e?300:0)},onPageClick:function(t){if(!this.scroll||!this.scroll.wasContentDrag){var e=Object(n.a)(t.currentTarget).data("num");this.mag.currentPage&&e==this.mag.currentPage.num||this.mag.showPage(e,{animation:!1})}},renewScreenshot:function(t){var e=this.$(".page").filter((function(){return Object(n.a)(this).data("id")==t})),i=RM.constructorRouter.mag.pages.find((function(e){return e.id==t})),o=i&&i.getScreenshot(this.PAGE_WIDTH);e.attr("data-src")?e.attr("data-src",o):e.find(".screenshot").prop("src",o)},getVisibleScreenshotRange:function(){var t=this.cachedData.scrollSize,e=this.cachedData.scrollPos,i="horizontal"==this.viewerType?this.PAGE_WIDTH:this.PAGE_HEIGHT;return{min:Math.max(0,Math.floor(e/i)),max:Math.min(this.mag.getPagesCount()-1,Math.floor((e+t)/i))}},loadVisibleScreenshots:function(){if(this.mag.pages&&this.mag.pages.length){var t=this.getVisibleScreenshotRange(),e=this;this.$(".page").each((function(i){var o,a=(o=Object(n.a)(this)).attr("data-src");i>=t.min&&i<=t.max&&a&&!e.loadedScreenshots[i]&&((o=Object(n.a)(this)).find(".screenshot").prop("src",a),o.removeAttr("data-src"),e.loadedScreenshots[i]=!0)}))}},unloadInvisibleScreenshots:function(){if(!this.shown){var t=this.getVisibleScreenshotRange(),e=this;this.$(".page").each((function(i){var o,a=(o=Object(n.a)(this)).attr("data-src");(i<t.min||i>t.max)&&!a&&e.loadedScreenshots[i]&&((o=Object(n.a)(this)).attr("data-src",o.find(".screenshot").prop("src")),o.find(".screenshot").prop("src",e.IMG_STUB),delete e.loadedScreenshots[i])}))}},loadOtherScreenshots:function(){this.clearLoadOtherTimeout(),this.loadOtherSafeTimeout=500,this.loadNextScreenshot()},loadNextScreenshot:function(){var t,e,i,n=this.getVisibleScreenshotRange(),o=Math.floor((n.min+n.max)/2),a=this.loadedScreenshots,r=this.mag.getPagesCount()-1;for(t=o;t<=r&&a[t];t++);for(e=o;e>=0&&a[e];e--);if(!(e<0&&t>r)){a[i=t>r?e:e<0?t:t-o>o-e?e:t]=!0;var s=this.$(".page").eq(i),l=s.find(".screenshot"),c=this;l.one("load error",(function(t){clearTimeout(c.$curLoadingTimeout),c.loadNextScreenshot()})),this.$curLoadingTimeout=setTimeout((function(){l.off(),c.loadOtherSafeTimeout*=1.1,c.loadNextScreenshot()}),this.loadOtherSafeTimeout),l.prop("src",s.attr("data-src")),s.removeAttr("data-src"),this.$curLoadingScreenshot=l}},clearLoadOtherTimeout:function(){this.$curLoadingScreenshot&&this.$curLoadingScreenshot.off(),clearTimeout(this.$curLoadingTimeout)}}),It=a.a.View.extend({PAGE_COUNTER_TIMEOUT:2800,PAGE_COUNTER_TIMEOUT_INITIAL:4e3,brandingInToolbar:!1,template:kt.a["template-viewer-toolbar"],events:{"click .menu-button":"toggleMenu","click .share-button":"toggleShare","click .embed-close-button":"onEmbedCloseClick"},initialize:function(t){return r.a.bindAll(this),r.a.extend(this,t),this},render:function(){if(this.setElement(this.template({mag:this.mag,isPreview:this.isPreview,hasMenu:this.hasMenu,hasShare:this.hasShare,hasPageCounter:this.hasPageCounter,pageCounterInsideMenu:this.hasMenu&&x.a.isPhone,totalPages:this.mag.getPagesCount(),common:RM.common,controlsOnTop:this.controlsOnTop,brandingInToolbar:this.brandingInToolbar,icons:{sprite:Object(L.findImagePath)("./common/toolbar/sprite".concat(L.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.$menuButton=this.$el.find(".menu-button"),this.$shareButton=this.$el.find(".share-button"),this.$pageCounter=this.$el.find(".page-counter"),this.$pageCounterWrapper=this.$pageCounter.parent(),this.hasShare&&(this.share=new Ot({mag:this.mag,router:this.router,$container:x.a.isPhone?this.$container:this.$shareButton}).render(),this.hasMenu||this.$shareButton.addClass("without-menu-button")),this.hasMenu&&(this.magMenu=new Et({mag:this.mag,pages:this.pages,router:this.router,isPreview:this.isPreview,hasProjectInfo:this.hasProjectInfo,publishDate:this.publishDate,$container:this.$container,$toolbar:this.$el,viewerType:this.viewerType,showInitially:this.isSettingsOpened}).render()),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"finalPageShown",this.onFinalPageShow),this.listenTo(this.mag,"finalPageHidden",this.onFinalPageHide),this.listenTo(this.mag,"menuShown",this.onMenuShow),this.listenTo(this.mag,"menuHidden",this.onMenuHide),this.listenTo(this.mag,"presentationModeOn",this.onPresentationModeOn),this.listenTo(this.mag,"presentationModeOff",this.onPresentationModeOff),!this.isPreview){var t=this.$(".offscreen-initially:visible"),e=150*t.length+800;t.each((function(t,i){setTimeout((function(){Object(n.a)(i).removeClass("offscreen-initially")}),e),e-=150}))}return this.$("div[data-alt]:not(.rmalttext), a[data-alt]:not(.rmalttext)").RMAltText(),this},destroy:function(){return this.share&&this.share.destroy(),this.magMenu&&this.magMenu.destroy(),this.remove()},isMenuOpened:function(){return!!this.menuShown},closeMenu:function(){this.magMenu&&this.magMenu.hide()},onPageChange:function(t,e){this.showPageCounter(t,e),this.$menuButton.removeClass("waiting-video-bg-start preloading"),this.prevPage&&this.stopListening(this.prevPage),t&&(t.loaded||(this.$menuButton.addClass("preloading"),this.listenTo(t,"pageLoaded",this.onPageLoaded)),t.hasVideoBG&&!t.videoBGStarted&&(this.$menuButton.addClass("waiting-video-bg-start"),this.listenTo(t,"videoBGStarted",this.onVideoBGStarted)),this.prevPage=t)},onPageLoaded:function(){this.$menuButton.removeClass("preloading")},onVideoBGStarted:function(){this.$menuButton.removeClass("waiting-video-bg-start")},onFinalPageShow:function(){this.magMenu&&this.magMenu.hide(),this.finalPageShown=!0,this.updateVisibilityState()},onFinalPageHide:function(){this.finalPageShown=!1,this.updateVisibilityState()},onPresentationModeOn:function(){this.isPresentationMode=!0,this.updateVisibilityState()},onPresentationModeOff:function(){this.isPresentationMode=!1,this.updateVisibilityState()},updateVisibilityState:function(){this.finalPageShown||this.isPresentationMode?this.$el.stop().fadeOut(200):this.$el.stop().fadeIn(200)},onMenuShow:function(){this.menuShown=!0,this.hidePageCounter()},onMenuHide:function(){this.menuShown=!1},getPageCounterSize:function(t){if(!this.cachedPageCounterData){this.$pageCounter.find(".cur").text("0");var e=this.$pageCounter.outerWidth();this.$pageCounter.find(".cur").text("00");var i=this.$pageCounter.outerWidth()-e,n=e-i;this.cachedPageCounterData={baseSize:n,digitSize:i},this.$pageCounter.find(".cur").text(t)}var o=this.cachedPageCounterData;return o.baseSize+(t+"").length*o.digitSize},updatePageCounterSize:function(t){this.$pageCounter.length&&this.$pageCounterWrapper.length&&(!this.menuShown&&this.pageCounterShown?this.$pageCounterWrapper.css("width",this.getPageCounterSize(t)):this.$pageCounterWrapper.css("width",""))},showPageCounter:function(t,e){this.hasPageCounter&&(this.$pageCounter.find(".cur").text(t.num),e.showPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.addClass("show-page-counter"),this.pageCounterShown=!0,Modernizr.android?setTimeout(r.a.bind((function(){this.updatePageCounterSize(t.num)}),this),17):this.updatePageCounterSize(t.num),this.pageCounterTimeout=setTimeout(this.hidePageCounter,e.initial?this.PAGE_COUNTER_TIMEOUT_INITIAL:this.PAGE_COUNTER_TIMEOUT)))},hidePageCounter:function(){this.hasPageCounter&&(clearTimeout(this.pageCounterTimeout),this.$el.removeClass("show-page-counter"),this.pageCounterShown=!1,this.updatePageCounterSize())},toggleMenu:function(t){this.magMenu&&this.magMenu.toggle()},toggleShare:function(t){Object(n.a)(t.target).is(this.$shareButton)&&this.share&&this.share.toggle()},postMessageToParent:function(t,e){var i={type:t,data:e},n=window.parent;n&&n.postMessage(JSON.stringify(i),"*")},onEmbedCloseClick:function(t){this.postMessageToParent("close-fullscreen")}}),Tt=i("WEBt"),Mt=i.n(Tt),$t=a.a.View.extend({template:Mt.a["template-viewer-branding"],initialize:function(t){return r.a.bindAll(this),r.a.extend(this,t),this},render:function(){return this.setElement(this.template()),this.$el.appendTo(this.$container),this.listenTo(this.mag,"pageChanged",this.onPageChange),this.listenTo(this.mag,"finalPageShown",this.hide),this.listenTo(this.mag,"finalPageHidden",this.show),r.a.delay(function(){this.$el.removeClass("offscreen-initially")}.bind(this),800),this},onPageChange:function(t,e){},hide:function(){this.$el.stop().fadeOut(200)},show:function(){this.$el.stop().fadeIn(200)}}),At=i("zWgA"),Rt=i.n(At),Dt=i("m41J");function Bt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Lt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Bt(Object(i),!0).forEach((function(e){zt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Bt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function zt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Ft=a.a.View.extend({TYPEKIT_PREVIEW_API_LINK:"//use.typekit.net/previewkits/pk-v1.js",PRELOAD_COUNT_HORIZONTAL:{backward:1,forward:x.a.isDesktop?5:x.a.isPhone?3:2},PRELOAD_COUNT_VERTICAL:{backward:x.a.isDesktop?2e3:(x.a.isPhone,1e3),forward:x.a.isDesktop?3e3:(x.a.isPhone,2e3)},SCROLLABLE_TRESHOLD:100,SCROLL_SNAP:0,template:l.a["template-viewer-mag"],initialize:function(t,e){var i=this;r.a.bindAll(this),t||(t={}),r.a.defaults(t,{pages:[]}),this.hasWidgetsWithVerticalOnscrollAnimation=!1;var o=Object(r.a)(t.pages).chain().reduce((function(t,e){return t.concat(e.wids)}),[]).each((function(t){f.a.normalizeAnimations(t.animation).find((function(t){return"scroll"===t.type&&t.steps&&t.steps.find((function(t){return t.dy}))}))&&(i.hasWidgetsWithVerticalOnscrollAnimation=!0)})).filter({is_global:!0}).value();this.staticGlobalWidgetsData=Object(r.a)(o).filter((function(t){return!t.is_above})),this.aboveGlobalWidgetsData=Object(r.a)(o).filter((function(t){return t.is_above}));var a=r.a.pluck(this.aboveGlobalWidgetsData,"_id");return t.pages.forEach((function(t){t.pagePath=t.pagePath||t.uri||t.num.toString()})),t.pages.forEach((function(t){t.uri=t.pagePath})),Object(r.a)(t.pages).each(function(t){t.wids=t.wids.concat(r.a.reject(this.staticGlobalWidgetsData,(function(e){return e.pid===t._id}))),t.wids=r.a.unique(t.wids,(function(t){return t._id||Math.random()})),t.wids=Object(r.a)(t.wids).filter((function(t){return!r.a.contains(a,t._id)}))}.bind(this)),r.a.extend(this,t),this.model=new c.a(t,{parse:!0}),this.router=e,this.eCommerceManager=new O.b(this.router,this,this.router.environment),"ecwid"===this.eCommerceManager.getConnectedProvider()?this.cartSidebar=new pt(this):this.cartSidebar=new rt(this),this.isPreview=e.isPreview,this.$container=e.$mags_container,x.a.isDesktop&&Object(n.a)("<div>").bind("mousewheel",(function(){})),this.setViewerOptions(this.getMagViewport()),this.continueLoading.__debounced=r.a.debounce(this.continueLoading,200),this.loadPages.__debounced=r.a.debounce(this.loadPages,700),this.onResize.__debounced=r.a.debounce(this.onResize,300),this.redrawAboveGlobalWidgets.__debounced=r.a.debounce(this.redrawAboveGlobalWidgets,500,!0),this.widgetPackCount=0,this.getAboveGlobalBoxMemoized=r.a.memoize(this.getAboveGlobalBox,(function(t,e,i){return t+" "+(e&&e.num)+" "+(e&&e.pageViewport)+" "+(i&&i.width)+" "+(i&&i.height)})),this},setViewerOptions:function(t){var e={arrows:!0,menubutton:!0,projectinfo:!0,sharebutton:!0,pagecounter:!0,controlsontop:!1,viewertype:"vertical",slidein:!1,scalewidth:3600,endpage:!0,endpagetype:"join",lqip:!1};(e=r.a.extend(e,this.model.get("opts"))).viewertype=RM.screenshot?"horizontal":e.viewertype,(!x.a.isDesktop||this.isPreview&&"default"!==t)&&(e.slidein=!1),"vertical"===e.viewertype&&(x.a.isDesktop?this.isStickyVerticalViewer=!e.slidein&&!this.isPreview&&!this.hasWidgetsWithVerticalOnscrollAnimation:(this.isStickyVerticalViewer=Modernizr.csspositionsticky,this.isStickyVerticalViewer||(e.viewertype="horizontal",this.pages.length>1&&(e.arrows=!0)))),e.sharebutton=e.sharebutton&&!this.isPreview&&!!this.published&&!this.is_private,e.pagecounter=e.pagecounter&&!this.isPreview&&this.pages.length>1,e.endpage=e.endpage&&!this.isPreview&&!!this.published,this.model.user&&this.model.user.get&&"540dc7a3a5c9259a383b910b"==this.model.user.get("_id")&&(e=r.a.extend(e,{arrows:!0,menubutton:this.isPreview,sharebutton:!1,pagecounter:!1,endpage:!1})),RM.common.isDomainViewer&&(e.endpage=!1),this.viewOpts=e,this.PRELOAD_COUNT="horizontal"==this.viewOpts.viewertype?this.PRELOAD_COUNT_HORIZONTAL:this.PRELOAD_COUNT_VERTICAL},setViewerClasses:function(){this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").addClass("viewer-type-"+this.viewOpts.viewertype).removeClass("pages-pos-normal pages-pos-overlap").addClass("pages-pos-"+(this.viewOpts.slidein?"overlap":"normal")),"vertical"==this.viewOpts.viewertype&&(Object(n.a)("html").addClass("overflow-on-vertical-view"),this.isStickyVerticalViewer&&(this.$el.addClass("viewer-type-vertical-sticky"),Object(n.a)("body").addClass("overflow-on-vertical-view"))),this.viewOpts.controlsontop&&Object(n.a)("html").addClass("controls-on-top"),Object(n.a)("html").addClass("new-settings")},unsetViewerClasses:function(){this.$el.removeClass("viewer-type-horizontal viewer-type-vertical").removeClass("pages-pos-normal pages-pos-overlap"),"vertical"==this.viewOpts.viewertype&&(Object(n.a)("html").removeClass("overflow-on-vertical-view"),this.$magScrollSizer.css("height",""),this.isStickyVerticalViewer&&(this.$el.removeClass("viewer-type-vertical-sticky"),Object(n.a)("body").removeClass("overflow-on-vertical-view"))),Object(n.a)("html").removeClass("controls-on-top")},render:function(){if(!this.active){this.title=this.title||"Project",this.magOpenTime=new Date,document.documentElement.style.setProperty("--min-desktop-width","".concat(y.b.dictionary[y.a.Default].min_scale_width,"px")),this.setElement(this.template({hasStandaloneBottomArrow:!this.isPreview&&"vertical"==this.viewOpts.viewertype&&this.viewOpts.arrows,isPreview:!!this.isPreview,icons:{sprite:Object(L.findImagePath)("./common/navigation/sprite".concat(L.is2X?"@2x":"",".png"))}})),this.$el.appendTo(this.$container),this.setViewerClasses(),Object(n.a)("body").on("click","a.external-link",this.toExternalLink).on("click",".maglink.back-to-top",this.backToTopCurrentPage).on("click",".maglink",this.maglink).on("click",".goback-link",this.onGobackLinkClick).on("click",".mailchimp-link",this.onMailchimpLinkClick).on("click",".anchor-link",this.onAnchorLinkClick).on("click",".share-link",this.onShareLinkClick),this.$mag_container=this.$(".mag-pages-container"),this.$mag_container.on("scroll",this.fixFocusScroll),this.$mag_viewport_device=this.$(".mag-pages-viewport-device"),this.$pages_container=this.$(".mag-pages-container .container"),this.$pages_blackout=this.$pages_container.find(".blackout"),this.$aboveWidgetsContainer=this.$(".above-pages-container"),"vertical"==this.viewOpts.viewertype&&(this.$magScrollContainer=Object(n.a)(window),this.$magScrollSizer=Object(n.a)("body"),this.isStickyVerticalViewer&&(this.$magScrollSizer=Object(n.a)("body").add(this.$el)),this.$magScrollHandler=Object(n.a)(window),this.$magScrollAnimate=Object(n.a)("body, html")),"vertical"==this.viewOpts.viewertype&&(this.$bottomArrow=this.$(".navigation-arrow.bottom"),this.$bottomArrow.one("click",this.scrollMagALittle)),this.active=!0;var t=this.pages;this.pages=null,this.viewport=null,this.switchToViewport(this.getMagViewport()),this.onResize(),x.a.isDesktop||setTimeout(this.onResize,1500),this.pages=Object(r.a)(t).chain().sortBy((function(t){return t.num})).map(r.a.bind((function(e){var i="";try{i=new b.a({mag:this,router:this.router,totalPages:t.length,pageData:e,viewerType:this.viewOpts.viewertype,isStickyVerticalViewer:this.isStickyVerticalViewer,$container:this.$pages_container}).render()}catch(t){console.log("Error page rendering.",t)}return i}),this)).filter((function(t){return!!t})).value();var e=this.getPage(this.getPagesCount());if(e&&e.markAsLast(),"horizontal"==this.viewOpts.viewertype&&this.setPagesTransitions(),!RM.screenshot){"horizontal"==this.viewOpts.viewertype&&this.viewOpts.arrows&&(this.navigation=new ft({mag:this,router:this.router,$container:this.$el,isPreview:this.isPreview,hasFinalPage:this.viewOpts.endpage,viewerType:this.viewOpts.viewertype}).render()),this.viewOpts.endpage&&(this.finalPage=new _t({me:this.router.me,mag:this,router:this.router,$container:this.$pages_container,isPreview:this.isPreview,isPrivate:this.is_private,viewerType:this.viewOpts.viewertype,finalPageType:this.viewOpts.endpagetype,isStickyVerticalViewer:this.isStickyVerticalViewer,recentMags:this.model.recentMags||Object(r.a)([])}).render());var i=this.must_show_branding&&!(RM.common.embedMode&&!x.a.isDesktop),o=i&&x.a.isDesktop&&!this.viewOpts.controlsontop&&!this.isPreview;this.toolbar=new It({mag:this,pages:this.pages,router:this.router,$container:this.$el,isPreview:this.isPreview,hasMenu:this.viewOpts.menubutton,hasProjectInfo:this.viewOpts.projectinfo,hasShare:this.viewOpts.sharebutton&&!h.a.IS_FILE_PROTOCOL,hasPageCounter:this.viewOpts.pagecounter,controlsOnTop:this.viewOpts.controlsontop,brandingInToolbar:o,viewerType:this.viewOpts.viewertype,publishDate:this.published?S()(new Date(this.published),"mmm dd, yyyy"):"unpublished",isSettingsOpened:this.isSettingsOpened}).render(),i&&(this.branding=new $t({mag:this,$container:o?this.toolbar.$el.find(".toolbar-branding"):this.$el}).render())}"vertical"==this.viewOpts.viewertype&&(this.onResize(),x.a.isDesktop&&this.getPage(1)&&this.getPage(1).$content.focus(),Object(n.a)("body").on("keydown",this.onVerticalViewKeyDown)),x.a.isDesktop?(Object(n.a)(window).on("mousedown",this.onMouseDown),Object(n.a)(window).on("mouseup",this.onMouseUp),Object(n.a)(window).on("mousewheel",this.onMouseWheel)):(Object(n.a)(window).on("touchstart",this.onDragStart),Object(n.a)(window).on("touchmove",this.onDragMove),Object(n.a)(window).on("touchend touchcancel",this.onDragEnd),Object(n.a)(window).on("pageshow",this.onResize)),d.default.PageVisibilityManager.addEventListener(this.onPageVisibilityChange),this.listenTo(this,"finalPageShown",this.onFinalPageShow),this.listenTo(this,"finalPageHidden",this.onFinalPageHide),this.listenTo(a.a,"form:focus",this.onFormFocus),this.listenTo(a.a,"form:blur",this.onFormBlur),Object(n.a)(window).on("resize",this.onResize),this.isPreview&&this.listenTo(this.model,"change:opts",this.onOptsChange),x.a.isDesktop||Object(n.a)(window).on("orientationchange",this.onResize),Object(n.a)(window).on("gesturestart gestureend",this.onGestureChange),"vertical"==this.viewOpts.viewertype&&this.$magScrollHandler.on("scroll",this.onMagScroll),Object(n.a)("body").on("keyup",this.onKeyup),u.a.generateCSS("paragraph","viewer",document,this.edit_params&&this.edit_params.paragraph_styles),u.a.generateCSS("link","viewer",document,this.edit_params&&this.edit_params.link_styles),RM.screenshot&&"true"==d.default.queryUrlGetParam("pdf")||this.isPreview||u.a.setShortList(u.a.getVeryShortList(this.edit_params&&this.edit_params.fonts));var s=!this.isPreview&&this.model.get("is_published")?"published":"edit",l=this;return"edit"!=s||window.TypekitPreview?c():n.a.getScript(this.TYPEKIT_PREVIEW_API_LINK,(function(t,e,i){c()})),this}function c(){u.a.appendFontsCssToDocument({version:s,fonts:l.edit_params&&l.edit_params.fonts,typekit_url:l.typekit_url})}},destroy:function(){var t=this;return r.a.each(this.pages,(function(t){t.destroy()})),this.pages=null,Object(n.a)("body").off("click","a.external-link",this.toExternalLink).off("click",".maglink.back-to-top",this.backToTopCurrentPage).off("click",".maglink",this.maglink).off("click",".goback-link",this.onGobackLinkClick).off("click",".mailchimp-link",this.onMailchimpLinkClick).off("click",".anchor-link",this.onAnchorLinkClick).off("keydown",this.onVerticalViewKeyDown).off("click",".share-link",this.onShareLinkClick),this.toolbar&&this.toolbar.destroy(),this.navigation&&this.navigation.destroy(),this.finalPage&&this.finalPage.destroy(),this.cartSidebar&&setTimeout((function(){t.cartSidebar.destroy()}),320),x.a.isDesktop?(Object(n.a)(window).off("mousedown",this.onMouseDown),Object(n.a)(window).off("mouseup",this.onMouseUp),Object(n.a)(window).off("mousewheel",this.onMouseWheel)):(Object(n.a)(window).off("touchstart",this.onDragStart),Object(n.a)(window).off("touchmove",this.onDragMove),Object(n.a)(window).off("touchend touchcancel",this.onDragEnd),Object(n.a)(window).off("pageshow")),this.unsetViewerClasses(),d.default.PageVisibilityManager.removeEventListener(this.onPageVisibilityChange),Object(n.a)(window).off("resize",this.onResize),Object(n.a)(window).off("orientationchange",this.onResize),Object(n.a)(window).off("gesturestart gestureend",this.onGestureChange),"vertical"==this.viewOpts.viewertype&&this.$magScrollHandler.off("scroll",this.onMagScroll),Object(n.a)("body").off("keyup",this.onKeyup),this.active=!1,this.trigger("destroyed"),this.remove()},getUrl:function(){return RM.common.isDomainViewer?window.location.protocol+"//"+window.location.hostname+"/"+(RM.common.customDomainProfile?this.num_id+"/":""):window.location.protocol+"//"+window.location.hostname+"/"+this.num_id+"/"},getPage:function(t){return parseInt(t,10)==t&&(t=parseInt(t,10)),r.a.isNumber(t)?this.pages[t-1]:Object(r.a)(this.pages).find((function(e){return e.uri==t}))},getPageByPath:function(t){return"1"===t.toString()?this.pages[0]:this.pages.find((function(e){return e.pagePath===t}))},getPagesCount:function(){return this.pages&&this.pages.length},isFirstPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num-1)},isLastPage:function(){return this.currentPage&&!this.getPage(this.currentPage.num+1)},getPageId:function(t){var e=r.a.find(this.pages,(function(e){return e.num_id===t}));return e&&e._id},getPageNum:function(t){var e=r.a.find(this.pages,(function(e){return e._id==t}));return e&&e.num},getPageUri:function(t){var e=r.a.find(this.pages,(function(e){return e._id==t}));if(!e)return null;var i=e.uri?e.uri+"/":1==e.num?"":e.num+"/";return this.router.getMagUri(this)+i},getPageTransitionTime:function(){var t=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),e=this.getContainerSizeCached().height;return x.a.isDesktop?550:x.a.isTablet?t>e?550:470:t>e?520:370},onPageVisibilityChange:function(){var t=this;if(this.currentPage)if(clearTimeout(this.visibilityHandlerTimeout),d.default.PageVisibilityManager.isPageHidden())this.visibilityHandlerTimeout=setTimeout((function(){t.currentPage.stop({widgetTypes:["video","background","iframe"]});var e=t.getPage(t.currentPage.num+1);e&&e.started&&(e.stop({widgetTypes:["video","background","iframe"]}),t.restartNextPage=!0)}),700);else{this.currentPage.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0});var e=this.getPage(this.currentPage.num+1);e&&this.restartNextPage&&(e.start({widgetTypes:["audio","video","background","iframe"],forceStart:!0}),delete this.restartNextPage)}},updateArrowsColor:function(t){if(t){var e=t.arrows_color||"white";this.$el.removeClass("navigation-white-arrows").removeClass("navigation-black-arrows").addClass("navigation-"+e+"-arrows")}},onFinalPageShow:function(){this.currentPage&&this.currentPage.stop({widgetTypes:["audio","video","background","iframe"]}),"horizontal"==this.viewOpts.viewertype&&(this.$pages_container.removeClass("disable-transitions"),this.$pages_container.addClass("fade-last-page-on-final-page"))},onFinalPageHide:function(){this.currentPage&&this.currentPage.start({widgetTypes:["audio","video","background","iframe"]}),"horizontal"==this.viewOpts.viewertype&&this.$pages_container.removeClass("fade-last-page-on-final-page")},onFormFocus:function(){if(Modernizr.safari&&!x.a.isDesktop&&"vertical"===this.viewOpts.viewertype){var t=this.getScroll();r.a.each(this.pages,(function(e){e.trigger("form:focus",t)})),this.$magScrollContainer&&this.$magScrollContainer.on("scroll",this.onScrollWithFormInFocus)}},onFormBlur:function(){(Modernizr.safari||!x.a.isDesktop)&&"vertical"===this.viewOpts.viewertype&&(r.a.each(this.pages,(function(t){t.trigger("form:blur")})),this.$magScrollContainer&&this.$magScrollContainer.off("scroll",this.onScrollWithFormInFocus))},onScrollWithFormInFocus:function(){if((Modernizr.safari||!x.a.isDesktop)&&"vertical"===this.viewOpts.viewertype){var t=this.getScroll();r.a.each(this.pages,(function(e){e.trigger("page:scrollWithFormInFocus",t)}))}},onDragStart:function(t){clearTimeout(this.touchInProgressTimeout),this.pauseLoading("touch");var e=t.originalEvent.targetTouches[0];this.globalTouchObject={$target:Object(n.a)(t.target).closest(".has-horizontal-scroll, .has-vertical-scroll"),x:e.screenX,y:e.screenY,startTime:+new Date}},onDragMove:function(t){var e=this.globalTouchObject;if(!(t.originalEvent.touches.length>1)&&e){if("horizontal"==this.viewOpts.viewertype)this.currentPage&&this.currentPage.hasFixedWidgets&&Object(n.a)(t.target).closest(this.$mag_container).length&&!e.$target.length&&(e.$target=this.currentPage.$scrollWrapper);else e.$target.length||(e.$target=this.$magScrollContainer);if(e.$target.length){if(!d.default.isPageNativelyScaled()){var i=t.originalEvent.targetTouches[0],o=(i.screenX,e.x,i.screenY-e.y);if(Math.abs(o)>5&&e.$target.hasClass("has-vertical-scroll")){var a=e.$target[0].scrollHeight,r=e.$target.outerHeight();o>0&&e.$target.scrollTop()<=0&&t.preventDefault(),o<0&&e.$target.scrollTop()>=a-r&&t.preventDefault()}e.$target.hasClass("has-horizontal-scroll")}}else t.preventDefault()}},onDragEnd:function(t){this.checkDoubleTap(t),this.touchInProgressTimeout=setTimeout(r.a.bind((function(){this.continueLoading("touch")}),this),400);var e=this.globalTouchObject;if(e){var i=t.originalEvent.changedTouches[0],o=i.screenX-e.x,a=i.screenY-e.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(o)<3&&Math.abs(a)<3&&+new Date-e.startTime<500&&!d.default.isPageNativelyScaled()&&Object(n.a)(t.target).closest(this.$mag_container).length&&this.toolbar.closeMenu()}delete this.globalTouchObject},checkDoubleTap:function(t){if(!(t.originalEvent.touches.length>0)){var e=+new Date,i=e-(this.lastTouchEndTime||e+1);if(this.lastTouchEndTime=e,i<500&&i>0&&d.default.isPageNativelyScaled()){var o=Object(n.a)('meta[name="viewport"]');if(o.length){var a=o.attr("content"),s=a.replace(/maximum\-scale\=[0-9\.]*/,"maximum-scale=1.0");if(o.attr("content",s),Modernizr.android){var l=Object(n.a)("<div>").appendTo("body");r.a.delay((function(){l.remove()}),500),setTimeout(r.a.bind((function(){o.attr("content",a);var t=Object(n.a)("<div>").appendTo("body");r.a.delay((function(){t.remove()}),500)}),this),1e3)}else o.attr("content",a);this.lastTouchEndTime=0,r.a.delay((function(){Object(n.a)(window).trigger("gesturechange")}),300),r.a.delay((function(){Object(n.a)(window).trigger("gesturechange")}),1e3)}}}},onMouseDown:function(t){this.globalMouseObject={x:t.screenX,y:t.screenY,startTime:+new Date}},onMouseUp:function(t){var e=this.globalMouseObject;if(e){var i=t.screenX-e.x,o=t.screenY-e.y;this.toolbar&&this.toolbar.isMenuOpened()&&Math.abs(i)<3&&Math.abs(o)<3&&+new Date-e.startTime<500&&Object(n.a)(t.target).closest(this.$mag_container).length&&this.toolbar.closeMenu()}delete this.globalMouseObject},onMouseWheel:function(t){t.originalEvent.deltaX<0&&Math.abs(t.originalEvent.deltaY)<2&&t.cancelable&&t.preventDefault()},onKeyup:function(t){if("input"!=t.target.tagName.toLowerCase()&&("textarea"!=t.target.tagName.toLowerCase()||"copyhack"==t.target.className)&&r.a.isEmpty(RM.common.disableShortcuts)&&!this.isInPresentationMode){var e=r.a.chain(y.b.viewports).filter((function(t){return"tablet_portrait"!=t.name||(this.currentPage["viewport_"+t.name]||{}).enabled}),this).map((function(t,e){var i=r.a.clone(t);return i.shortcut=""+(e+1),i})).findWhere({shortcut:String.fromCharCode(t.keyCode)}).value();e&&this.isPreview&&(this.switchToViewport(e.name),this.aboveGlobalWidgetsRendered||"horizontal"!==this.viewOpts.viewertype||this.renderAboveGlobalWidgets(this.currentPage),this.setViewerOptions(e.name),this.setViewerClasses(),this.onResize(),this.loadPages());r.a.find(n.a.keycodes,(function(e,i){var o=n.a.keycodes[i]===t.keyCode;return o&&i,o}))&&this.trigger("keypress-"+t.keyCode,t)}},onKeydown:function(t){if("input"!=t.target.tagName.toLowerCase()&&("textarea"!=t.target.tagName.toLowerCase()||"copyhack"==t.target.className)&&r.a.isEmpty(RM.common.disableShortcuts)&&this.isInPresentationMode&&!(t.altKey||t.ctrlKey||t.metaKey))switch(t.which){case 8:case 33:case 80:case 37:case 72:case 38:case 75:t.preventDefault(),this.goPrevPage({animation:!0});break;case 13:case 34:case 78:case 39:case 76:case 40:case 74:t.preventDefault(),this.goNextPage({animation:!0});break;case 36:t.preventDefault(),this.goFirstPage();break;case 35:t.preventDefault(),this.goLastPage();break;case 9:case 32:t.preventDefault(),t.shiftKey?this.goPrevPage({animation:!0}):this.goNextPage({animation:!0});break;case 77:t.preventDefault(),this.trigger("keypress-"+t.keyCode,t)}},onVerticalViewKeyDown:function(t){var e;if(!this.isInPresentationMode&&"vertical"===this.viewOpts.viewertype&&(t.which===n.a.keycodes.down||t.which===n.a.keycodes.up)){if(t.preventDefault(),this.arrowKeyLastScrollAt&&new Date-this.arrowKeyLastScrollAt<400)return;var i=t.which===n.a.keycodes.down;this.arrowKeyLastScrollAt=+new Date;var o,a,s=window.innerHeight,l=this.getScroll(),c=this.getScrollPosition(),d=Math.round(s/4),h=function(t){return t&&t<=d},u=r.a.bind((function(){var t=this.magPagesPos[this.currentPage.num];return Math.abs(l-t.y)}),this),p=this.currentPage.pageHeight,m=0===c&&!this.isFirstPage();if(i)h(o=p-c-s)?a=p-c:a=(e=o)>d&&e<s?o:s,m&&this.viewOpts.slidein&&(a+=u());else{if(m){var g=this.magPagesPos[this.currentPage.num-1];c=g?g.h:0}a=h(o=c-s)||c<s?-c:-s,m&&this.viewOpts.slidein&&(a-=this.SCROLL_SNAP-u())}this.setScrollPosition({delta:a,animate:!0})}},togglePresentationMode:function(t){!!this.isInPresentationMode!=t&&x.a.isDesktop&&(this.isPreview||(t?(Object(n.a)("body").on("keydown",this.onKeydown),this.trigger("presentationModeOn")):(Object(n.a)("body").off("keydown",this.onKeydown),this.trigger("presentationModeOff")),this.isInPresentationMode=t))},recalcBottomArrowState:function(t){this.currentPage&&t===this.currentPage&&this.navigation&&this.navigation.recalcBottomArrowState(t)},setScrollPosition:function(t){var e;this.currentPage&&("vertical"==this.viewOpts.viewertype?(e=void 0!==t.offset?this.magPagesPos[this.currentPage.num].y+t.offset:this.getScroll()+t.delta,t.animate?this.$magScrollAnimate.animate({scrollTop:e},500):this.setScroll(e)):(e=void 0!==t.offset?t.offset:this.currentPage.$scrollWrapper.scrollTop()+t.delta,t.animate?this.currentPage.$scrollWrapper.animate({scrollTop:e},500):this.currentPage.$scrollWrapper.scrollTop(e)))},getScrollPosition:function(){if(!this.currentPage)return 0;return"vertical"==this.viewOpts.viewertype?Math.max(this.getScroll()-this.magPagesPos[this.currentPage.num].y,0):this.currentPage.$scrollWrapper.scrollTop()},getScroll:function(){return this.$magScrollContainer&&this.$magScrollContainer.scrollTop()},setScroll:function(t){this.$magScrollContainer&&this.$magScrollContainer.scrollTop(t)},onMagScroll:function(){if(document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullScreenElement||document.msFullscreenElement||this.hadPlayingVideoOnResize)this.hadPlayingVideoOnResize=!1;else{r.a.isFunction(this._resetUrlStringTimeoutFunc)&&this._resetUrlStringTimeoutFunc(),this.pauseWidgetsLoadingOnScroll();var t=this.findPageOnCurrentMagScroll({pageStartsOnBottom:!Object(C.a)("viewer.offPageStartOnBottom")&&this.isStickyVerticalViewer&&!x.a.isDesktop}),e=this.getScrollParams(t);if(this.lastPageScroll=e.pageScroll,this.lastPageScrollPercent=e.pageScrollPercent,this.showPage(t.page.num,e),this.finalPage&&!this.isStickyVerticalViewer&&(null!=t.finalPageScroll?this.finalPage.scrollOnVerticalMode(t.finalPageScroll):this.finalPage.resetScrollOnVerticalMode()),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!0,scroll:this.getScroll()}),this.trigger("mag scroll",this.getScroll()),this.finalPage&&this.isStickyVerticalViewer){var i=this.getScroll(),n=this.magPagesPos[this.pages.length],o=n.y+n.h-this.getContainerSizeCached().height;this.trigger(i>o?"finalPageShown":"finalPageHidden")}if(this.$bottomArrow&&+this.magOpenTime+2e3<+new Date){this.$bottomArrow.addClass("offscreen");var a=this.$bottomArrow;delete this.$bottomArrow,setTimeout((function(){a.remove()}),400)}}},scrollMagALittle:function(){this.$magScrollAnimate.animate({scrollTop:this.getScroll()+this.getContainerSizeCached().height},500)},findPageOnCurrentMagScroll:function(t){t=t||{};var e,i,n,o,a=this.getScroll(),r=this.getContainerSizeCached(),s=(a=Math.min(Math.max(a,0),this.magHeight-r.height),this.pages.length),l=a+(t.pageStartsOnBottom?r.height-50-16-16:0);for(e=0;e<s;e++){i=this.pages[e],n=this.magPagesPos[i.num];var c,d=o?o.y+o.h:n.y;if(l>=d&&l<n.y+n.h||e==s-1)return e==s-1&&(c=Math.max(a-n.y-n.h-n.dh,0)),{page:i,scroll:a,pos:n,finalPageScroll:c,finalPageShown:this.finalPage&&!(l>=d&&l<n.y+n.h)};o=n}},getScrollParams:function(t){var e=Math.max(t.scroll-t.pos.y,0),i={initiator:"scroll",pageScroll:e,pageScrollPercent:e/t.page.pageHeight};if(this.viewOpts.slidein?(i.nextPageScroll=0,i.slideInNextPageScroll=t.pos.h-i.pageScroll):i.nextPageScroll=i.pageScroll-t.pos.h,i.nextPageVisible=t.pos.h-i.pageScroll<this.getContainerSizeCached().height,this.viewOpts.slidein){var n=(t.pos.h-i.pageScroll)/this.getContainerSizeCached().height;i.nextPageBlackout=Math.min(Math.max(n,0),1)}return i},onCurrentPageScroll:function(t,e){this.pauseWidgetsLoadingOnScroll(),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.onScroll({forceApply:!this.isStickyVerticalViewer,scroll:e}),this.lastPageScroll=e,this.lastPageScrollPercent=this.lastPageScroll/t.pageHeight,this.loadPages.__debounced()},scrollCurrentPageALittle:function(){this.currentPage&&this.currentPage.scrollPageALittle()},focusCurrentPage:function(){this.currentPage&&this.currentPage.focusPage()},backToTopCurrentPage:function(){if("vertical"==this.viewOpts.viewertype){var t=this.findPageOnCurrentMagScroll();this.$magScrollAnimate.animate({scrollTop:t.pos.y},500)}else this.currentPage&&this.currentPage.backToTop();RM.analytics&&RM.analytics.sendEvent("Scroll Top Link")},scrollPageToPos:function(t,e){var i,n,o=this.getPage(t),a=this.getContainerSizeCached();e=e||0,e*=o.scale,e+=o.contentPosition.top,"vertical"==this.viewOpts.viewertype?(i=this.magPagesPos[o.num],n=Math.max(0,i.y+e),n=Math.min(n,i.y+i.h-a.height),this.$magScrollAnimate.animate({scrollTop:n},500)):(this.currentPage!=o&&this.showPage(o.num),n=Math.max(0,e),o.scrollTo(n))},pauseWidgetsLoadingOnScroll:function(){},toExternalLink:function(t){var e=Object(n.a)(t.target).closest("a").attr("href");RM.analytics&&RM.analytics.sendEvent("External Link",e)},maglink:function(t){if(2!=t.which&&!t.metaKey&&!t.ctrlKey){var e=Object(n.a)(t.currentTarget).data("link")||Object(n.a)(t.currentTarget).attr("href");if(!e)return!1;if(t.preventDefault(),Object(n.a)(t.currentTarget).hasClass("back-to-top"))return this.backToTopCurrentPage();this.router.navigate(e,{trigger:!0})}},onGobackLinkClick:function(t){this.router.goBack()},onMailchimpLinkClick:function(t){var e,i=Object(n.a)(t.currentTarget);if(!i.hasClass("disabled")){i.flashClass("disabled",3e3);try{e=JSON.parse(i.attr("data-mailchimp"))}catch(t){e=null}e&&p.a.initMailchimpAPI((function(t){d.default.deleteCookie("MCEvilPopupClosed"),t.start(e)}))}},onAnchorLinkClick:function(t){var e=Object(n.a)(t.currentTarget),i=parseInt(e.attr("data-anchor-link-pos"),10)||0,o=e.attr("data-page-id"),a=e.attr("data-page-uri");if(o){var r=this.pages.find((function(t){return t._id===o}));r&&(a=r.num)}i&&a&&(this.scrollPageToPos(a,i),RM.analytics&&RM.analytics.sendEvent("Anchor Link",i))},onShareLinkClick:function(t){m.share({host:(RM.common.embedDomainName||window.location.protocol+"//"+window.location.hostname)+"/",tp:Object(n.a)(t.currentTarget).attr("data-share-provider"),source:"mag links",page:this.currentPage||this.pages[0],mag:r.a.extend(this.model.toJSON(),{user:this.user}),forProject:"mag"==Object(n.a)(t.currentTarget).attr("data-share-type"),customDomain:!(!RM.common.isDomainViewer&&!RM.common.embedDomainName),customDomainProfile:!(!RM.common.customDomainProfile&&"User"!=RM.common.embedDomainType),analytics:this.router.analytics})},showPageCounter:function(t){if(this.toolbar){var e=1;this.currentPage&&(e=this.currentPage.num+(t?"left"==t?1:-1:0),e=Math.max(Math.min(e,this.getPagesCount()),1)),this.toolbar.showPageCounter(this.getPage(e),{showPageCounter:!0})}},showPage:function(t,e){e=e||{},this.active||this.render();var i=this.getPage(t),n=this.currentPage,o=i&&this.getPage(i.num+1),a=this;i&&!this.aboveGlobalWidgetsRendered&&this.renderAboveGlobalWidgets(i),this.isStickyVerticalViewer?this.redrawAboveGlobalWidgets():e.nextPageVisible||"horizontal"===this.viewOpts.viewertype?this.redrawAboveGlobalWidgets(i,o,e.slideInNextPageScroll||e.nextPageScroll,e.animation):i?this.redrawAboveGlobalWidgets(i):n&&this.redrawAboveGlobalWidgets.__debounced(),"vertical"==this.viewOpts.viewertype&&(e.animation=!1,i&&i.scrollOnVerticalMode(e.pageScroll||0),i&&o&&null!=e.nextPageScroll&&(o.scrollOnVerticalMode(e.nextPageScroll),(x.a.isDesktop||Object(C.a)("viewer.offPageStartOnBottom"))&&(e.nextPageVisible?o.start():o.stop())),i&&null!=e.nextPageBlackout&&this.$pages_blackout.css({display:o?"block":"none",opacity:e.nextPageBlackout,"z-index":i.getPageZIndex()}));var r=!this.currentPage;if(!r&&t===this.currentPage.num)return!1;if(!i)return 1!==t&&this.router.onError(),!1;if(n)if("horizontal"==this.viewOpts.viewertype||this.isStickyVerticalViewer)n.stop();else{o==n&&e.nextPageVisible||n.stop();var s=n&&this.getPage(n.num+1);s&&!(s==i||s==o&&e.nextPageVisible)&&s.stop()}else e.animation=!1;this.pauseLoading("page-change-animation"),this.currentPage=i,n&&n.resetWaitForAnimationEnd(),clearInterval(this.showPageCompleteInterval),this.$pages_container.toggleClass("disable-transitions",!e.animation),e.animation&&(this.viewOpts.slidein&&n&&n.num>i.num?n.waitForAnimationEnd(u):i.waitForAnimationEnd(u)),this.direction=!n||n.num<i.num?"forward":"backward";var l=i.num-this.getPreloadPageCount(i.num-1,"forward"===this.direction?"backward":"forward"),c=i.num+this.getPreloadPageCount(i.num-1,this.direction);"horizontal"!=this.opts.viewertype||this.opts.arrows||(l=c=i.num);for(var d=0;d<this.pages.length;d++){var h=this.pages[d];h.num<i.num?h.setPosition("prev",h.num+1==i.num):h.num>i.num?h.setPosition("next",h.num-1==i.num):h.setPosition("center",h.num==i.num),h.num>=l&&h.num<=c&&h.show(),"vertical"==this.viewOpts.viewertype&&(h.num<i.num||h.num>i.num+1)&&h.resetScrollOnVerticalMode()}function u(){function t(){for(var t=0;t<a.pages.length;t++){var e=a.pages[t];(e.num<l||e.num>c)&&e.hide()}!a.lastFinalPageState&&i.start(),a.loadPages()}e.animation||r||window.requestAnimationFrame((function(){a.$pages_container.removeClass("disable-transitions")})),a.continueLoading("page-change-animation"),"vertical"==a.viewOpts.viewertype&&"scroll"!=e.initiator&&a.setScroll(a.magPagesPos[i.num].y),a.isPreview&&a.$el.scrollTop(0),clearInterval(a.showPageCompleteInterval),a.loadingPaused?a.showPageCompleteInterval=setInterval((function(){a.loadingPaused||(clearInterval(a.showPageCompleteInterval),t())}),17):t()}!e.animation&&u(),this.scheduleSetUrlString({replace:!r,skipInternalHistory:e.skipInternalHistory}),this.router.setTitle(),this.trigger("pageChanged",i,{showPageCounter:e.animation||e.bySwipe||r||"scroll"==e.initiator,initial:r}),i.trigger("changedTo"),"vertical"==this.viewOpts.viewertype&&this.updateArrowsColor(i)},scheduleSetUrlString:function(){if(!Modernizr.chrome)return this.router.setUrlString.apply(this.router,arguments),this.router.trackPage(),void(this._resetUrlStringTimeoutFunc=!1);var t=arguments;this._resetUrlStringTimeoutFunc=function(){clearTimeout(this._urlStrigScheduleTimeout),this._urlStrigScheduleTimeout=setTimeout(function(){this._resetUrlStringTimeoutFunc=null,this.router.setUrlString.apply(this.router,t),this.router.trackPage()}.bind(this),100)}.bind(this),this._resetUrlStringTimeoutFunc()},goNextPage:function(t){var e=this.finalPage&&this.finalPage.shown;this.isLastPage()?e||(this.finalPage&&this.finalPage.show(),this.finalPage&&this.redrawAboveGlobalWidgets(this.finalPage)):this.currentPage&&this.router.go(this.currentPage.num+1,Lt(Lt({},t),{},{isPageNum:!0}))},goPrevPage:function(t){var e=this.finalPage&&this.finalPage.shown;if(this.isLastPage()&&e)return this.finalPage&&this.finalPage.hide(),void(this.finalPage&&this.redrawAboveGlobalWidgets(this.currentPage));this.isFirstPage()||this.currentPage&&this.router.go(this.currentPage.num-1,Lt(Lt({},t),{},{isPageNum:!0}))},goFirstPage:function(){this.router.go(1,{isPageNum:!0})},goLastPage:function(){this.router.go(this.getPagesCount(),{isPageNum:!0})},pauseLoading:function(t){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[t]=!0,this.loadingPaused=!0},continueLoading:function(t){this.pauseReasons=this.pauseReasons||{},this.pauseReasons[t]=!1,this.loadingPaused=!r.a.every(r.a.values(this.pauseReasons),(function(t){return!t}))},loadPages:function(){if(this.pages&&this.pages.length){var t=this.getPagesLoadOrder();if(t&&t.length){var e,i,n=[],o=[];for(e=0;e<t.length;e++){var a=(i=this.pages[t[e]]).getWidgetsPacks();a.length&&n.push(a),o=o.concat(i.getImmediatePack())}if(n.length){var r=[];for(e=0;e<n.length;e++){0==e&&l(e,0),l(e+1,0);for(var s=1;s<n[e].length;s++)l(e,s)}r.unshift(o),this.widgetsPacksLoadQueue=r,this.stopPagesLoad(),this.loadNextWidgetsPack()}}}function l(t,e){t<0||t>=n.length||e<0||e>=n[t].length||r.push(n[t][e])}},stopPagesLoad:function(){clearTimeout(this.loadNextWidgetsTimer)},loadNextWidgetsPack:function(){if(this.widgetsPacksLoadQueue.length)if(this.loadingPaused)this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,50);else{var t=this.widgetsPacksLoadQueue.shift();if(t.length){var e=r.a.uniq(r.a.map(t,"page")),i=e[0];if(1!==e.length||i.shown&&!i.loaded){this.widgetPackCount;i.loadWidgetsPack(t,r.a.bind((function(){this.widgetPackCount++,this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,17)}),this))}else this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,17)}else this.loadNextWidgetsTimer=setTimeout(this.loadNextWidgetsPack,17)}else a.a.trigger("widgetsQueue:empty",this.num_id)},getPreloadPageCount:function(t,e){if("horizontal"==this.viewOpts.viewertype)return this.PRELOAD_COUNT[e];for(var i=1,n=0,o="forward"==e?1:-1;n<this.PRELOAD_COUNT[e]&&i*o+t<this.pages.length&&i*o+t>=0;)n+=this.pages[i*o+t].height,i++;return i},getPagesLoadOrder:function(){var t=this.currentPage;if(t){var e,i=t.num-1,n=this.pages.length,o=[],a=this,r=t.num-this.getPreloadPageCount(i,"forward"==this.direction?"backward":"forward"),s=t.num+this.getPreloadPageCount(i,this.direction);if(l(i),"backward"==this.direction){for(l(i-1),l(i+1),e=i-2;e>=r;e--)l(e);for(e=i+2;e<=s;e++)l(e)}else{for(l(i+1),l(i-1),e=i+2;e<=s;e++)l(e);for(e=i-2;e>=r;e--)l(e)}return o}function l(t){t<0||t>=n||!a.pages[t].shown||a.pages[t].loaded||o.push(t)}},onGestureChange:function(){this.onResize.__debounced()},checkFullscreen:function(){this.fullscreenCheckCounter=5,clearInterval(this.fullscreenCheckTimer),this.fullscreenCheckTimer=setInterval(r.a.bind((function(){var t=window.fullScreen||window.innerWidth==screen.width&&window.innerHeight>=screen.height-1;this.togglePresentationMode(t),this.fullscreenCheckCounter--,this.fullscreenCheckCounter||clearInterval(this.fullscreenCheckTimer)}),this),500)},onResize:function(t){var e=this;if(this.checkFullscreen(),!x.a.isDesktop&&"horizontal"==this.viewOpts.viewertype||"vertical"==this.viewOpts.viewertype&&!this.isStickyVerticalViewer){var i="horizontal"==this.viewOpts.viewertype?Object(n.a)("html, body").add(this.$el):this.$el,o=d.default.isPageNativelyScaled(),a=window.innerHeight;337==a&&414==Object(n.a)(window).height()&&a++,i.height(o?"100%":a),!o&&i.scrollTop(0)}var s=this.getContainerSize(),l=this.isPortrait()?"portrait":"landscape",c=!1;if(!x.a.isDesktop&&this.prevOrientation&&this.prevOrientation!==l){var h=this.getPage(this.currentPage.num-1),u=_.a.video.findPlayingVideo(this.currentPage.widgets)||_.a.video.findPlayingVideo(null==h?void 0:h.widgets),p=!!u&&Dt.a.doBoundingBoxesIntersect(u.$el[0].getBoundingClientRect(),{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth});u&&p?(this.hadPlayingVideoOnResize=!0,setTimeout((function(){u.page.num===e.currentPage.num&&e.setScrollPosition({offset:u.y*e.getScale(e.currentPage.pageViewport)})}),500)):(this.hadPlayingVideoOnResize=!1,this.switchToViewport(this.getMagViewport()),this.setPagesTransitions(),this.stopPagesLoad(),setTimeout(this.onResize,300),setTimeout(this.onResize,1500)),c=!0}if(this.prevOrientation=l,this.isPreview&&"default"!=this.viewport){var m=Math.round((this.$el.width()-s.width)/2),g=Math.round((this.$el.height()-s.height)/2);this.$mag_container.add(this.$mag_viewport_device).css({top:Math.max(g,0),left:Math.max(m,0),width:s.width,height:s.height})}else this.$mag_container.add(this.$mag_viewport_device).css({top:"",left:"",width:"",height:""});this.$mag_viewport_device.attr("data-viewport",this.viewport),this.setNewPagesWidths(s.width,s.height),this.magHeight=0,this.magPagesPos=[];var f=this.pages&&this.pages.length;if(r.a.each(this.pages,r.a.bind((function(t,e){var i=t.onResize({absolutePosition:this.magHeight}),n=0;(e<f-1||this.finalPage)&&this.viewOpts.slidein&&(n=this.SCROLL_SNAP),this.magPagesPos[t.num]={y:this.magHeight,h:i,dh:n},this.magHeight+=i+n}),this)),this.finalPage&&(this.isStickyVerticalViewer&&this.finalPage.setSizeAndPosForStickyVersion({absolutePosition:this.magHeight}),this.magHeight+=this.finalPage.getHeight()),"vertical"===this.viewOpts.viewertype&&this.magHeight){var v=this.$magScrollSizer.width(),b=0;if(this.isPreview&&"default"!==this.viewport&&(b=Math.max(this.$el.height()-this.getViewportSetting("min_height"),0)),this.$magScrollSizer.css("height",this.magHeight+b),v!=this.$magScrollSizer.width()&&x.a.isDesktop&&this.onResize(),this.currentPage)if(this.isStickyVerticalViewer||this.hadPlayingVideoOnResize){if(c&&!this.hadPlayingVideoOnResize){var y=this.getScrollPosForNewSize();setTimeout(r.a.bind((function(){this.setScroll(y)}),this),0)}}else this.setScroll(this.getScrollPosForNewSize()),this.onMagScroll();this.$bottomArrow&&this.$bottomArrow.toggleClass("offscreen",this.getScroll()+s.height+this.SCROLLABLE_TRESHOLD>this.magHeight)}if("horizontal"==this.viewOpts.viewertype&&this.currentPage&&c&&!this.hadPlayingVideoOnResize){y=this.getScrollPosForNewSize();setTimeout(r.a.bind((function(){this.currentPage.$scrollWrapper.scrollTop(y)}),this),0),this.aboveGlobalWidgetsRendered||setTimeout(r.a.bind((function(){this.aboveGlobalWidgetsRendered||this.renderAboveGlobalWidgets(this.currentPage)}),this),40)}this.currentPage&&this.loadPages.__debounced()},onOptsChange:function(){window.dispatchEvent(new Event("resize"))},getScrollPosForNewSize:function(){return this.currentPage?"vertical"==this.viewOpts.viewertype?this.magPagesPos[this.currentPage.num].y+(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:(this.lastPageScrollPercent||0)*this.currentPage.pageHeight:0},setNewPagesWidths:function(t,e){var i=this.$el.find("#page-position-style"),o=x.a.isDesktop?"":" translateZ(0)",a="        .mag .mag-pages-container .container {\n          left: 0px;\n          width: "+t+"px;\n        }\n        .mag .mag-pages-container .container .page {\n          left: 0px;\n          width: "+t+"px;\n        }\n        .mag .mag-pages-container .container .final-page {\n          left: 0px;\n          width: "+t+"px;\n        }\n",r="";if("horizontal"==this.viewOpts.viewertype)r="          .mag .mag-pages-container .container .final-page.offscreen {\n            -webkit-transform: translateX("+t+"px) "+o+";\n            transform: translateX("+t+"px) "+o+";\n          }\n          .mag .mag-pages-container .container .page.prev-page {\n            -webkit-transform: translateX("+(this.viewOpts.slidein?0:-t)+"px) "+o+";\n            transform: translateX("+(this.viewOpts.slidein?0:-t)+"px) "+o+";\n          }\n          .mag .mag-pages-container .container .page.center-page {\n            -webkit-transform: translateX(0) "+o+";\n            transform: translateX(0) "+o+";\n          }\n          .mag .mag-pages-container .container .page.next-page {\n            -webkit-transform: translateX("+t+"px) "+o+";\n            transform: translateX("+t+"px) "+o+";\n          }";else if(this.isStickyVerticalViewer){var s=this.getContainerSizeCached().height;r="            .mag .mag-pages-container .container .page .page-fixed-bg-container,            .mag .mag-pages-container .container .page .fixed-position-container,            .mag .mag-pages-container .container .page .fixed-position-container-top {              height: "+s+"px;            }\n            .mag .mag-pages-container .container .page .fixed-position-container,            .mag .mag-pages-container .container .page .fixed-position-container-top,            .mag .mag-pages-container .container .page:not(.hide-sticky) .content-scroll-wrapper {              margin-top: "+-s+"px;            }\n"}else r="            .mag .mag-pages-container .container .final-page {\n              top: "+(e+1)+"px;            }\n            .mag .mag-pages-container .container .page.prev-page {\n              top: "+(-e-1)+"px;            }\n            .mag .mag-pages-container .container .page.next-page {\n              top: "+(e+1)+"px;            }\n";i.length||(i=Object(n.a)('<style id="page-position-style" type="text/css">')).appendTo(this.$el),"horizontal"==this.viewOpts.viewertype?(this.$pages_container.addClass("disable-transitions-on-resize"),i.text(a+r),this.$pages_container.height(),this.$pages_container.removeClass("disable-transitions-on-resize")):i.text(a+r)},setPagesTransitions:function(){var t=this.$el.find("#page-transition-style"),e=this.getPageTransitionTime(),i="cubic-bezier(0.40, 0.24, 0.40, 1)",o="        .mag .mag-pages-container .container .page {\n          -webkit-transition:\tall "+e+"ms "+i+";          transition: all "+e+"ms "+i+";        }\n        .mag .mag-pages-container .container .page.center-page {\n          -webkit-transition:\tall "+(e-5)+"ms "+i+";          transition: all "+(e-5)+"ms "+i+";        }\n        .mag .mag-pages-container .container .final-page {\n          -webkit-transition:\tall "+e+"ms "+i+";          transition: all "+e+"ms "+i+";        }\n        ";t.length||(t=Object(n.a)('<style id="page-transition-style" type="text/css">')).appendTo(this.$el),t.text(o)},switchToViewport:function(t){if(this.viewport!=t){var e=this.viewport;this.containerSize=null,this.viewport=t,this.trigger("change:viewport",{viewport:this.viewport,oldViewport:e}),this.aboveGlobalWidgetsRendered=!1,this.aboveGlobalWidgets&&this.aboveGlobalWidgets.forEach((function(t){t.destroy(),t.off()})),this.aboveGlobalAnimations&&this.aboveGlobalAnimations.destroy(),this.aboveGlobalWidgets=[],r.a.each(this.pages,(function(t){t.updateViewport()}))}},getContainerSize:function(){var t,e,i=this;return this.isPreview&&"default"!=this.viewport?(t=this.getViewportWidth(this.viewport),e=Math.min(this.getViewportSetting("min_height"),this.$el.height())):(t=RM.screenshot?Object(n.a)(window).width():this.$el.width(),e=RM.screenshot?window.innerHeight:this.isStickyVerticalViewer&&Modernizr.safari&&!x.a.isDesktop?i.isPortrait()?Math.max(window.innerHeight,screen.height-20-20+1):Math.min(screen.width,screen.height):this.isStickyVerticalViewer?window.innerHeight:this.$el.height()||window.innerHeight),this.containerSize={width:t,height:e},this.containerSize},getContainerSizeCached:function(){return this.containerSize||this.getContainerSize()},getViewportWidth:function(t){return t&&t!==y.a.Default?y.b.dictionary[t].width:this.desktopWidth||y.b.dictionary[y.a.Default].width},isPortrait:function(){return window.screen?window.screen.orientation&&window.screen.orientation.type?!!window.screen.orientation.type.match(/portrait/i):0===window.orientation||90!==window.orientation&&-90!==window.orientation&&window.innerWidth<window.innerHeight:window.innerWidth<window.innerHeight},getMagViewport:function(){var t=this.isPortrait();if(this.isPreview)return this.constructorViewport||"default";var e=y.a.Default,i=window.innerWidth;if(Modernizr.retina||!x.a.isDesktop||Modernizr.ismobile){if(screen&&screen.width&&(i=t?Math.min(screen.width,screen.height):Math.max(screen.width,screen.height)),t)return i<600?y.a.PhonePortrait:i>=600&&i<=1024?y.a.TabletPortrait:y.a.Default;if(i>980)return y.a.Default}if(Modernizr.isipad)return t?y.a.TabletPortrait:y.a.Default;if(!x.a.isDesktop){var n=i,o=r.a.reduce(y.b.viewports,(function(t,e,i){return Math.abs(e.width-n)<=Math.abs(y.b.viewports[t].width-n)?i:t}),0);e=y.b.viewports[o].name}return e},getViewportSetting:function(t,e){return(y.b.dictionary[e||this.viewport]||{})[t]},log:function(){for(var t="",e=0;e<arguments.length;e++)t+=arguments[e]+" ";var i=Object(n.a)("#log");i.length||(i=Object(n.a)('<div id="log">').css({position:"fixed",background:"rgba(0, 0, 0, 0.7)",color:"#fff",width:200,height:300,left:10,top:10,"z-index":999999,overflow:"auto"}).appendTo("body"));var o=i.html(),a=o.split("<br>");i.html(a.slice(-17).join("<br/>")+"<br/>"+t),i.scrollTop(999999)},fixFocusScroll:function(){this.$mag_container.scrollTop(0),this.$mag_container.scrollLeft(0)},matchSameDomainLink:function(t){var e=t.match(new RegExp("//"+d.default.escapeSpecial(window.location.hostname)+"/(.*)")),i=e&&e[1];if(i){var n=this.getPageByPath(i);if(n)return n._id}return t},getScale:function(t){if(RM.screenshot)return 1;var e=Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),i=this.getViewportWidth(t),n=e/i;return e<this.getContainerSizeCached().width&&v.a.isScaleLayout(this.opts)&&!Modernizr.firefox&&this.$el.find(".page-content-container").addClass("scale-centring"),v.a.normalize(n,void 0,this.viewport,i,this.opts)},getWidgetById:function(t,e){var i,n,o=e&&e.getWidgetDataById(t)?e:r.a.find(this.pages,(function(e){return e.getWidgetDataById&&e.getWidgetDataById(t)}));return o?(n=o.getWidgetById(t))?i=window.Promise.resolve(n):o.loaded||(i=new window.Promise(function(e,i){this.listenToOnce(o,"loaded"+t,(function(){var n=o.getWidgetById(t);n?e(n):i()}))}.bind(this))):r.a.find(this.aboveGlobalWidgetsData,{_id:t})&&((n=r.a.find(this.aboveGlobalWidgets,{_id:t}))?i=window.Promise.resolve(n):this.aboveGlobalWidgetsRendered||(i=new window.Promise(function(e,i){this.listenToOnce(this,"aboveGlobalWidgetsRendered",(function(){var n=r.a.find(this.aboveGlobalWidgets,{_id:t});n?e(n):i()}))}.bind(this)))),i||window.Promise.reject()},renderAboveGlobalWidgets:function(t){var e=[],i=t.pageViewport;r.a.each(this.aboveGlobalWidgetsData,function(n){var o,a=r.a.find(this.aboveGlobalWidgets,{_id:n._id});if(a&&(a.destroy(),a.off()),n){var s=t.getWidgetViewportData(n,i),l=!this.isPreview&&f.a.hasExpired(s);_.a[s.type]&&!l&&((o=new _.a[s.type](s,t)).$fixedContainer=this.$aboveWidgetsContainer,o.isValid()&&e.push(o))}}.bind(this)),this.aboveGlobalAnimations=this.initializeAboveGlobalAnimation(e,t),r.a.each(e,(function(t){t.render(),t.hidden?g.a.hide(t,!0):g.a.show(t,!0)})),this.aboveGlobalWidgets=r.a.sortBy(e,"y"),this.aboveGlobalWidgetsRendered=!0,this.trigger("aboveGlobalWidgetsRendered")},initializeAboveGlobalAnimation:function(t,e){t=r.a.isArray(t)?t:[t],e.scale=this.getScale(e.pageViewport);var i=new w.a({page:e,widgets:t}),n=[];return r.a.each(t,(function(t){var e=new window.Promise((function(e){t.loaded?e(t):t.on("loaded",e.bind(null,t))}));n.push(e)})),window.Promise.all(n).then(function(){this.aboveAnimationsReady=!0,this.trigger("aboveAnimationsReady")}.bind(this)),this.listenTo(e,"resize",(function(t){r.a.isUndefined(t.prevScale)||t.prevScale===t.scale||i.updateTimelines(),i.onResize({updateAll:!0})})),i},updateAboveGlobalViewport:function(t,e){var i=r.a.find(this.aboveGlobalWidgetsData,{_id:t._id}),n=e.getWidgetViewportData(i,e.pageViewport);if(t.animationObj&&this.aboveGlobalAnimations.removeAnimation(t.animationObj),t.destroy(),t.initialize(n,e),t.hasAnimation()){var o=this.aboveGlobalAnimations.addAnimation(t);o&&o.start()}t.render(),g.a.hide(t,!0)},getAboveGlobalBox:function(t,e,i){var n=r.a.find(this.aboveGlobalWidgetsData,{_id:t}),o=e.getWidgetViewportData(n,e.pageViewport);return d.default.getFixedPositionBox(o.fixed_position,r.a.pick(o,["x","y","w","h"]),e.scale,i)},redrawAboveGlobalWidgets:function(t,e,i,n){if(!t){var o=r.a.isUndefined(this.getScroll())?void 0:this.findPageOnCurrentMagScroll(),a=o&&o.page.num,s=o&&this.getScrollParams(o);t=a&&this.getPage(a),e=t&&this.getPage(t.num+1),i=s&&(s.slideInNextPageScroll||s.nextPageScroll),n=s&&s.animation}i=r.a.isUndefined(i)?void 0:Math.abs(i);var l={width:Math.min(this.viewOpts.scalewidth,this.getContainerSizeCached().width),height:this.getContainerSizeCached().height},c=function(t,e){return!t.page||e&&t.page.pageViewport!==e.pageViewport};if(r.a.isUndefined(i)){var h=this.getPageTransitionTime();r.a.each(this.aboveGlobalWidgets,function(e){var i=t._id&&!g.a.isHidden(e,t._id,this.isPreview),o=t._id&&c(e,t);t._id&&e.updatePage(t),o&&this.updateAboveGlobalViewport(e,t),i?n?e.wasHidden&&d.default.waitForTransitionEnd(t.$el,h,"transform",g.a.show.bind(null,e)):e.wasHidden&&g.a.show(e):!e.wasHidden&&g.a.hide(e)}.bind(this))}else{var u=Math.abs(i);r.a.each(this.aboveGlobalWidgets,function(i){var n=!g.a.isHidden(i,t._id,this.isPreview),a=e&&!g.a.isHidden(i,e._id,this.isPreview),r=n&&a&&t.pageViewport===e.pageViewport,s=this.getAboveGlobalBoxMemoized(i._id,t,l),d=this.getAboveGlobalBoxMemoized(i._id,e||t,l),h=!x.a.isDesktop&&o&&o.finalPageScroll&&o.finalPageScroll>0,p=n&&u>s.top+s.height&&!h,m=e&&a&&d.top>u,f=!e&&n&&(!t.mag.viewOpts.endpage||!!o&&void 0===o.finalPageScroll);if(p||m||r||f){var v=p?t:m?e:i.page,b=c(i,v);i.updatePage(v),b?(i.rendered=!1,g.a.hide(i).then(function(){this.updateAboveGlobalViewport(i,v),g.a.show(i)}.bind(this))):i.wasHidden&&g.a.show(i)}else!i.wasHidden&&g.a.hide(i)}.bind(this))}},getUsedFonts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return u.a.getUsedFontsFromWidgetsModels(Lt(Lt({},t),{},{models:this.pages.reduce((function(t,e){return e.widgets.reduce((function(t,e){return t.push(e)&&t}),t)}),[]),customList:t.includeCustom?r.a.filter(this.edit_params&&this.edit_params.fonts,{provider:"custom"}):[]}))},hasCodeInjection:function(){var t=this;if(r.a.any(["ci_head","ci_body_top","ci_body_bottom","ci_css"],(function(e){return!!t[e]})))return!0;var e=!1;return r.a.each(this.pages,(function(t){r.a.each(t.widgetsData,(function(t){var i=!("iframe"!==t.type||!t.code);if(i&&!t.use_iframe){var n="codeinjection"===Rt()(t.code,t);if(n){var o=!(!r.a.all(y.b.viewport_listall,(function(e){var i=t[e];return i&&i.hidden||!i}))||!t.hidden);i&&n&&!o&&(e=!0)}}}))})),e}});e.a=Ft},b1Nn:function(t,e,i){"use strict";var n,o,a=i("vOnD"),r=i("q1tI"),s=i.n(r),l=i("i8i4"),c=i.n(l),d=i("iC7s"),h=i("QuYs"),u=i("rFsW"),p=i("q1z7"),m=i.n(p);!function(t){t[t.Standard=0]="Standard",t[t.Small=1]="Small"}(n||(n={})),function(t){t.TogglePreview="togglePreview",t.ToggleSettingsSidebar="toggleSettingsSidebar",t.OpenSettingsSidebar="openSettingsSidebar",t.CloseSettingsSidebar="closeSettingsSidebar",t.CloseMagMenu="closeMagMenu",t.OpenMagMenu="openMagMenu",t.SetMagMenuOrientation="setMagMenuOrientation",t.SetMagMenu="setMagMenu",t.SetControlsOnTop="setControlsOnTop",t.ToggleTrash="toggleTrash",t.TogglePageSettings="togglePageSettings",t.SetProjectSettingsState="setProjectSettingsState",t.ToggleHelpPopup="toggleHelpPopup",t.ToggleHelpPanel="toggleHelpPanel",t.ToggleUserTemplatesModal="toggleUserTemplatesModal",t.ToggleRmTemplatesModal="toggleRmTemplatesModal",t.SetPageActionsPopup="setPageActionsPopup",t.ToggleGridSize="toggleGridSize",t.TogglePageSelection="togglePageSelection",t.SetDragging="setDragging",t.SetReadyToPublish="setReadyToPublish",t.SetAddingPage="setAddingPage",t.ToggleTeamworkModal="toggleTeamworkModal",t.SetNotice="setNotice",t.ToggleExportAsTemlate="toggleExportAsTemlate",t.ToggleShowTourOnOpen="toggleShowTourOnOpen",t.ToggleCartSidebarState="toggleCartSidebarState",t.ToggleShowTips="toggleShowTips"}(o||(o={}));var g=i("Fi5S"),f=i("I0kf");function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){w(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var k=s.a.createContext({}),S={};try{var x=localStorage.getItem("rm_pageSettings");S=JSON.parse(x||"{}")}catch(t){}var C,O=function(t){var e,i=t.magModel,a=t.router,l=t.children,c={inPreview:!!a.previewMode,isSettingsOpened:m.a.history.getFragment().indexOf("/contents/")>-1,isMagMenuOpen:!1,isTrashOpened:!1,isPageSettingsOpened:!1,isProjectSettingsOpened:!1,isHelpPopupOpened:!1,isHelpPanelOpen:!1,isUserTemplatesModalShown:!1,isRmTemplatesModalShown:!1,isPageActionsPopupOpenedFor:!1,gridSize:S.gridSize||n.Standard,selectedPages:{},isDragging:!1,magMenuOrientation:i.attributes.opts.viewertype,magMenuOn:i.attributes.opts.menubutton,controlsOnTop:i.attributes.opts.controlsontop,readyToPublish:!0,addingPage:!1,isTeamworkModalOpened:!1,exportAsTemlate:!1,showTourOnOpen:Boolean(a.showTourOnOpen),isCartSidebarOpened:!1,showTips:Boolean(null===(e=a.me)||void 0===e?void 0:e.attributes.constructor_show_tips)},d=function(t,e){var i=_({},t.selectedPages);return i[e]?delete i[e]:i[e]=!0,i},u=v(Object(r.useReducer)((function(t,e){switch(e.type){case o.TogglePreview:var i=!t.inPreview;return _(_({},t),{},{inPreview:i,isSettingsOpened:!i&&t.isSettingsOpened,readyToPublish:!i&&t.readyToPublish,notice:void 0});case o.ToggleSettingsSidebar:var a=t.isSettingsOpened;return _(_({},t),{},{isSettingsOpened:!t.isSettingsOpened,notice:a?void 0:t.notice,isHelpPanelOpen:!1});case o.OpenSettingsSidebar:return h.d.sendEvent(h.b.MenuOpen),_(_({},t),{},{isSettingsOpened:!0});case o.CloseSettingsSidebar:return _(_({},t),{},{isSettingsOpened:!1,notice:void 0,isHelpPanelOpen:!1});case o.OpenMagMenu:return _(_({},t),{},{isMagMenuOpen:!0});case o.CloseMagMenu:return _(_({},t),{},{isMagMenuOpen:!1});case o.SetMagMenuOrientation:return _(_({},t),{},{magMenuOrientation:e.orientation});case o.SetMagMenu:return _(_({},t),{},{magMenuOn:e.isOn});case o.SetControlsOnTop:return _(_({},t),{},{controlsOnTop:e.onTop});case o.ToggleTrash:return _(_({},t),{},{isTrashOpened:!t.isTrashOpened});case o.TogglePageSettings:return _(_({},t),{},{isPageSettingsOpened:!t.isPageSettingsOpened,isHelpPanelOpen:!1});case o.SetProjectSettingsState:return e.payload&&h.d.sendEvent(h.b.SettingsOpen),_(_({},t),{},{isProjectSettingsOpened:e.payload,isHelpPanelOpen:!1});case o.ToggleHelpPopup:return _(_({},t),{},{isHelpPopupOpened:!t.isHelpPopupOpened});case o.ToggleHelpPanel:return _(_({},t),{},{isHelpPanelOpen:e.open});case o.ToggleUserTemplatesModal:return _(_({},t),{},{isUserTemplatesModalShown:!t.isUserTemplatesModalShown});case o.ToggleRmTemplatesModal:return _(_({},t),{},{isRmTemplatesModalShown:!t.isRmTemplatesModalShown});case o.SetPageActionsPopup:return _(_({},t),{},{isPageActionsPopupOpenedFor:e.payload});case o.ToggleGridSize:return _(_({},t),{},{gridSize:t.gridSize===n.Standard?n.Small:n.Standard});case o.TogglePageSelection:return _(_({},t),{},{selectedPages:d(t,e.payload)});case o.SetDragging:return _(_({},t),{},{isDragging:e.payload});case o.SetReadyToPublish:return _(_({},t),{},{readyToPublish:e.ready});case o.SetAddingPage:return _(_({},t),{},{addingPage:e.inProgress});case o.ToggleTeamworkModal:return _(_({},t),{},{isTeamworkModalOpened:e.payload});case o.SetNotice:return _(_({},t),{},{notice:e.notice});case o.ToggleExportAsTemlate:return _(_({},t),{},{exportAsTemlate:!t.exportAsTemlate});case o.ToggleShowTourOnOpen:return _(_({},t),{},{showTourOnOpen:e.showOnOpen});case o.ToggleCartSidebarState:return _(_({},t),{},{isCartSidebarOpened:!t.isCartSidebarOpened});case o.ToggleShowTips:return _(_({},t),{},{showTips:!t.showTips});default:return t}}),c),2),p=u[0],b=u[1];Object(r.useEffect)((function(){localStorage.setItem("rm_pageSettings",JSON.stringify({gridSize:p.gridSize}))}),[p.gridSize]),Object(r.useEffect)((function(){var t;if(Object(f.a)("constructor.eduTips")){var e=a&&(null===(t=a.me)||void 0===t?void 0:t.attributes.constructor_show_tips);p.showTips!==e&&a&&a.me&&a.me.save({constructor_show_tips:p.showTips},{patch:!0})}}),[p.isHelpPanelOpen]),Object(r.useEffect)((function(){!p.isSettingsOpened&&m.a.history.getFragment().indexOf("/contents/")>-1&&a.navigate("edit/".concat(a.mag.get("num_id"),"/").concat(a.getCurrentPageNum(),"/"),{replace:!0}),g.a.trigger(p.isSettingsOpened?"constructorSettings:open":"constructorSettings:close"),a.isSettingsOpened=p.isSettingsOpened}),[p.isSettingsOpened]);var y=Object(r.useCallback)((function(){b({type:o.OpenMagMenu})}),[]),w=Object(r.useCallback)((function(){b({type:o.CloseMagMenu})}),[]),x=Object(r.useCallback)((function(t,e){e.viewertype!==p.magMenuOrientation&&b({type:o.SetMagMenuOrientation,orientation:e.viewertype}),e.menubutton!==p.magMenuOn&&b({type:o.SetMagMenu,isOn:e.menubutton}),e.controlsontop!==p.controlsOnTop&&b({type:o.SetControlsOnTop,onTop:e.controlsontop})}),[p.magMenuOrientation,p.magMenuOn,p.controlsOnTop]);Object(r.useEffect)((function(){return g.a.on("magMenu:open",y),g.a.on("magMenu:close",w),function(){g.a.off("magMenu:open",y),g.a.off("magMenu:close",w)}}),[y,w]),Object(r.useEffect)((function(){return g.a.listenTo(i,"change:opts",x),function(){g.a.stopListening(i,"change:opts",x)}}),[x,x]);var C=Object(r.useCallback)((function(){b({type:o.SetReadyToPublish,ready:!0})}),[]);Object(r.useEffect)((function(){return g.a.listenTo(a,"previewMag:load:success",C),function(){g.a.stopListening(a,"previewMag:load:success",C)}}),[C]);var O=function(){b({type:o.ToggleCartSidebarState})};Object(r.useEffect)((function(){return g.a.on("ecommerce:cartsidebar:visibility:changed",O),function(){g.a.off("ecommerce:cartsidebar:visibility:changed",O)}}),[O]);return s.a.createElement(k.Provider,{value:_(_({},p),{},{dispatch:b,setPageVisibility:function(t,e){return new Promise((function(n,o){var a=i.getPage(t);a||n(),a.save({hidden:e}).done((function(t){n(t)})).fail((function(t){o(t.responseJSON)}))}))}})},l)},j=function(t,e,i,n){var o=i.findIndex((function(e){return e.num===t})),a=o>=0?i[o]:null,r=t+1,s=null;if(a&&a.children&&a.children.length)if(n[a._id]&&n[a._id].collapsed)s=a._id;else{var l=i[o+1];r=l?l.num:a.children[a.children.length-1].num+1}if(!a){var c=e.find((function(e){return e.num===t}));c&&(s=c.parentPage)}return{newPageNum:r,newPageParentId:s}},P=function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return e.map((function(e){return e.children?{id:e._id,parentId:i,items:t(e.children,e._id)}:{id:e._id,parentId:i}}))},E=i("wEEd"),I=Object(a.e)(d.B).withConfig({displayName:"ExternalSettingsHead___StyledFlex"})(["font-family:-apple-system,system-ui,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,Arial,sans-serif;visibility:",";"],(function(t){return t._css})),T=Object(a.e)(d.ib).withConfig({displayName:"ExternalSettingsHead___StyledRoundButton"})(["z-index:2;text-decoration:none;border:1px solid rgba(184,184,184,0.4) !important;&:hover{border:1px solid rgba(184,184,184,0.4);opacity:0.96;}&:active{border:1px solid rgba(184,184,184,0.4);}.user-avatar-settings-sidebar,.user-avatar-settings-sidebar > div{width:54px;height:54px;background-color:",";vertical-align:top;}"],(function(t){return t._css2})),M=Object(a.e)(d.n).withConfig({displayName:"ExternalSettingsHead___StyledButton"})(["z-index:1;order:2;text-decoration:none;&:hover{z-index:10;}.user-avatar-settings-add-collab{width:56px;height:56px;border:1px solid #e3e3e3;}"]),$=function(){var t,e,i=Object(r.useContext)(rd),n=Object(r.useContext)(k);return s.a.createElement(s.a.Fragment,null,s.a.createElement(I,{height:56,position:"absolute",top:24,right:"100%",mr:"16px",opacity:n.isSettingsOpened?1:0,_css:n.isSettingsOpened?"visible":"hidden"},s.a.createElement(T,{"aria-labelledby":"open-profile",size:56,color:"white",hoverColor:"white",activeColor:"white",as:"a",m:"0",href:i.isOwner?"/".concat(i.project.user.uri)+(i.project.folder?"/f/".concat(i.project.folder.uri):""):"/shared/".concat(i.project.user.uri),_css2:d.Ub.white},s.a.createElement(d.hb,{url:null===(t=window.RM.constructorRouter.me)||void 0===t?void 0:t.get("pic"),name:null===(e=window.RM.constructorRouter.me)||void 0===e?void 0:e.get("name"),className:"user-avatar-settings-sidebar"})),i.isOwner&&s.a.createElement(M,{"aria-labelledby":"add-collaborator",as:"a",ml:-20,mr:"4px",onClick:function(){n.dispatch({type:o.ToggleTeamworkModal,payload:!0})}},1===i.projectTeam.length?s.a.createElement(d.hb,{className:"user-avatar-settings-add-collab",url:i.projectTeam[0].pic,name:i.projectTeam[0].name||i.projectTeam[0].email,type:"settingsUser"}):s.a.createElement(d.hb,{name:"",className:"user-avatar-settings-add-collab",type:"settingsUser"},s.a.createElement(d.Cb,{textStyle:"subheading",mt:"-5px",color:"black",pl:i.projectTeam.length>0?"6px":0,letterSpacing:i.projectTeam.length>0?"-2px":"0px"},"+"),i.projectTeam.length>0&&s.a.createElement(d.Cb,{textStyle:"subheading",color:"black"},i.projectTeam.length)))))},A=i("wd/R"),R=i.n(A),D=i("f3SV"),B=function(t){return t.is_published?t.changed?"Unpublished changes":"Published ".concat(R()(t.published).format("MMM D, YYYY")):"Unpublished"};!function(t){t.Unpublished="unpublished",t.SameAsPublished="sameAsPublished",t.UnpublishedChanges="unpublishedChanges"}(C||(C={}));var L,z=function(t){return t.is_published?t.changed?C.UnpublishedChanges:C.SameAsPublished:C.Unpublished},F=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=D.a.readymag_host.split("//")[1],n=t.domain,o=t.user.domain,a=e?"".concat(D.a.readymag_host.split("//")[0],"//"):"",r=o||(n||"".concat(i,"/").concat(t.user.uri));return a+r},U=function(t){var e="UNKNOWN",i="UNKNOWN",n="UNKNOWN";return t&&(t.arecord&&(e="A-record",i=t.usedArecord||i,n=t.validArecord||n),t.cname&&(e="CNAME-record",i=t.usedCname||i,n=t.validCname&&t.validCname+"."||n)),{recordType:e,currentValue:i,neededValue:n}},N=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.replace(/(\r?\n|\r)+/g,e)};!function(t){t.canInjectCode="can_inject_code",t.canExportPDF="can_export_pdf",t.canExportCode="can_export_code",t.canUseShots="can_use_shots",t.canUseForms="can_use_forms"}(L||(L={}));var H,V=i("+IKJ");!function(t){t.ecommerce="type-publish-ecommerce",t.freePublishLimit="type-publish-limit",t.unconfirmedEmail="type-publish-noemail",t.customCode="type-code-injection",t.shots="type-widget-shots",t.forms="type-widget-shots",t.pdfExport="type-export-pdf",t.htmlExport="type-export-code"}(H||(H={}));var W=function t(e){var i=e.message,n=e.tag,o=e.type;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.message=i,this.tag=n,this.type=o||"error"};function G(){return(G=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function q(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var K,Y=Object(a.e)(d.n).withConfig({displayName:"ConfirmButton___StyledButton"})(["transition:opacity 0.2s ease;&:hover{opacity:0.96;background:",";color:",";}"],(function(t){return t._css}),(function(t){return t._css2})),X=function(t){var e=t.children,i=t["aria-labelledby"],n=t.width,o=t.onClick,a=t.bg,r=t.color,l=t.danger,c=t.dangerOnHover,h=q(t,["children","aria-labelledby","width","onClick","bg","color","danger","dangerOnHover"]),u=l?d.Ub.tomato:a||d.Ub.white,p=l?d.Ub.white:r||d.Ub.black;return s.a.createElement(Y,G({"aria-labelledby":i,width:n||80,height:32,lineHeight:"30px",textStyle:"small",bg:u,color:p,borderRadius:"xl",cursor:"pointer",border:"1px solid rgba(128, 128, 128, 0.16)"},h,{onClick:o,_css:c?d.Ub.tomato:u,_css2:c?d.Ub.white:p}),e)},Z=7100,J="240px",Q=9999,tt="0.3s";!function(t){t.Duplicate="duplicate",t.Delete="detele",t.Settings="settings",t.GoToPage="gotopage"}(K||(K={}));var et=Object(a.e)(d.Z).withConfig({displayName:"ExportModal___StyledOverlay"})(["background:black;"]),it=function(t){var e=t.children,i=t.onExit,n=Object(d.Wb)("Escape");return Object(r.useEffect)((function(){n&&i()}),[n,i]),s.a.createElement(s.a.Fragment,null,s.a.createElement(et,{zIndex:Q-1,onClick:i}),s.a.createElement(d.B,{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:Q-1,m:"auto",p:"20px 24px 24px",borderRadius:"m",flexDirection:"column",bg:"lightGray",width:336,height:496,role:"dialog","aria-modal":"true"},e))},nt=i("LDvm");function ot(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function at(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return rt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return rt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var st=function(t){var e=t.split(" ").join("").split(",").reduce((function(t,e){if(e&&/\d+|\d+-\d+/i.test(e)){var i=at(e.split("-").map((function(t){return parseInt(t)})),2),n=i[0],o=i[1];if(!o&&n&&n>0&&n<999)t.push(n);else{if(!(o&&n>0&&n<999&&o>0&&o<999&&n<=o))throw"Wrong pages value: ".concat(e);for(var a=n;a<=o;a++)t.push(a)}}return t}),[]);if(!e.length)throw"Empty pages list";return Array.from(new Set(e))},lt=Object(a.e)(d.H).withConfig({displayName:"PDFExport___StyledInlineInput"})(["&:focus{border:none;}"]),ct=function(t){var e=t.numId,i=t.email,n=void 0===i?"your email":i,o=t.onExit,a=at(Object(r.useState)(!1),2),l=a[0],c=a[1],u=at(Object(r.useState)(!1),2),p=u[0],m=u[1],g=at(Object(r.useState)(""),2),f=g[0],v=g[1],b=at(Object(r.useState)(!1),2),y=b[0],_=b[1],w=at(Object(r.useState)(),2),k=w[0],S=w[1],x=at(Object(r.useState)(!1),2),C=x[0],O=x[1],j=function(){var t,i=(t=regeneratorRuntime.mark((function t(i){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!p){t.next=2;break}return t.abrupt("return");case 2:i.preventDefault(),t.prev=3,n=y?st(f):void 0,t.next=11;break;case 7:return t.prev=7,t.t0=t.catch(3),S(t.t0),t.abrupt("return");case 11:return t.prev=11,m(!0),t.next=15,Object(nt.f)(e,n);case 15:m(!1),c(!0),h.d.sendEvent(h.b.PDFExport,{label:e,_mag_id:e,_range_type:y?"custom":"all",_range:f}),t.next=25;break;case 20:t.prev=20,t.t1=t.catch(11),m(!1),O(!0),setTimeout((function(){return O(!1)}),5e3);case 25:case"end":return t.stop()}}),t,null,[[3,7],[11,20]])})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){ot(a,n,o,r,s,"next",t)}function s(t){ot(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t){return i.apply(this,arguments)}}();return s.a.createElement(it,{onExit:o},s.a.createElement(d.Cb,{as:"div",textStyle:"subheading",mb:24,lineHeight:"30px"},"Export to PDF"),l?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{as:"div"},"Your project is being converted.",s.a.createElement("br",null),"We will send you the download link to ",n," when it’s ready."),s.a.createElement(d.n,{width:"100%",height:56,mt:"auto",variant:"bordered",onClick:o},"Done")):s.a.createElement(s.a.Fragment,null,s.a.createElement("form",{onSubmit:j},s.a.createElement(d.B,null,s.a.createElement(d.m,{width:"50%"},s.a.createElement(d.ub,{color:y?"gray":"black",onClick:function(t){t.preventDefault(),_(!1)}},"All pages")),s.a.createElement(d.m,{width:"50%"},s.a.createElement(lt,{name:"page-range",value:f,placeholder:"or select e.g. 2-8",onChange:function(t){S(void 0),_(Boolean(t.target.value)),v(t.target.value)},onFocus:function(){_(Boolean(f)),S(void 0)},p:0,color:y?"black":"gray"}))),s.a.createElement(d.n,{disabled:C||p,width:"100%",height:56,mt:20,variant:"bordered"},C?"Error":"Create PDF")),k&&s.a.createElement(d.Cb,{as:"div",textStyle:"small",color:"tomato",mt:14},k),s.a.createElement(d.Cb,{as:"div",mt:"auto",textStyle:"small",color:"darkGray"},"Please note that if your projects contains Typekit web fonts they will be replaced by alternatives due to license restrictions.")))};function dt(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ht(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ut(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ut(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var pt=Object(a.e)(d.m).withConfig({displayName:"HTMLExport__Paragraph"})(["& + &{margin-top:1.3em;}"]),mt=Object(a.e)(d.H).withConfig({displayName:"HTMLExport___StyledInlineInput"})(["&:focus{border:none;}"]),gt=function(t){var e=t.numId,i=t.email,n=void 0===i?"your email":i,o=t.onExit,a=ht(Object(r.useState)(!1),2),l=a[0],c=a[1],u=ht(Object(r.useState)(""),2),p=u[0],m=u[1],g=ht(Object(r.useState)(!1),2),f=g[0],v=g[1],b=ht(Object(r.useState)(!1),2),y=b[0],_=b[1],w=function(){var t,i=(t=regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!y&&p){t.next=2;break}return t.abrupt("return");case 2:return i.preventDefault(),t.prev=3,_(!0),h.d.sendEvent(h.b.HTMLExport),t.next=8,Object(nt.e)(e,p);case 8:c(!0),_(!1),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(3),_(!1),v(!0),setTimeout((function(){return v(!1)}),5e3);case 17:case"end":return t.stop()}}),t,null,[[3,12]])})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){dt(a,n,o,r,s,"next",t)}function s(t){dt(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t){return i.apply(this,arguments)}}();return s.a.createElement(it,{onExit:o},s.a.createElement(d.Cb,{as:"div",textStyle:"subheading",mb:24,lineHeight:"30px"},"Export to HTML"),l?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{as:"div"},"Your project is being converted. We will send you the download link to ",n," when it’s ready."),s.a.createElement(d.n,{width:"100%",height:56,mt:"auto",variant:"bordered",onClick:o},"Done")):s.a.createElement(s.a.Fragment,null,s.a.createElement("form",{onSubmit:w},s.a.createElement(d.Cb,{as:"div"},"Please provide a full URL where the project will be hosted. Typekit fonts will only work on this domain."),s.a.createElement(mt,{name:"base-url",placeholder:"domain.com or domain.com/page",value:p,onChange:function(t){return m(t.target.value)},p:0,mt:12}),s.a.createElement(d.n,{disabled:!p||f||y,width:"100%",height:56,mt:20,variant:"bordered"},f?"Error":"Create export")),s.a.createElement(d.Cb,{as:"div",mt:"auto",textStyle:"small",color:"darkGray"},s.a.createElement(pt,null,"Please note:"),s.a.createElement(pt,null,"Forms won’t send data to emails, Google Docs, or Mailchimp. Only URL option will work."),s.a.createElement(pt,null,"In an exported project, sharing customization per page won’t work. Instead, first page settings would be used for the whole project."),s.a.createElement(pt,null,"Exported projects can’t be password-protected."),s.a.createElement(pt,null,s.a.createElement(d.ub,{textStyle:"small",href:"https://help.readymag.com/hc/en-us/articles/360020647452-Code-export",target:"_blank",rel:"noopener noreferrer"},"Learn more")))))};function ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return vt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return vt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var bt=Object(a.e)(d.ub).withConfig({displayName:"MorePublishMenu___StyledStyledLink"})(["display:block;"]),yt=Object(a.e)(d.ub).withConfig({displayName:"MorePublishMenu___StyledStyledLink2"})(["display:block;"]),_t=Object(a.e)(d.U).withConfig({displayName:"MorePublishMenu___StyledMenuItem"})(["display:flex;justify-content:center;"]),wt=function(t){var e=t.m,i=Object(r.useContext)(rd),n=Object(r.useContext)(k),a=i.hasPermission(L.canExportPDF),l=i.hasPermission(L.canExportCode),h=z(i.project),u=ft(Object(r.useState)(!1),2),p=u[0],m=u[1],g=ft(Object(r.useState)(!1),2),f=g[0],v=g[1],b=ft(Object(r.useState)(!1),2),y=b[0],_=b[1],w=ft(Object(r.useState)(!1),2),S=w[0],x=w[1],O=ft(Object(r.useState)(!1),2),j=O[0],P=O[1],E=document.querySelector("body > .popups"),I=document.querySelector("#project-settings-body");return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.S,{onStateChange:function(t){return!t.isOpen&&_(!1)},transitionConfig:{duration:0},modifiers:I?[{name:"preventOverflow",options:{padding:{left:8,right:8},boundary:I}}]:void 0,target:s.a.createElement(d.ib,{size:56,color:"darkGray",m:e},s.a.createElement(d.Hb,{color:"white"})),placement:"top"},s.a.createElement(d.m,{position:"relative",bg:Object(V.e)(.08,d.Ub.black),borderRadius:"s",p:"10px 0",mb:12,width:224,textAlign:"center"},s.a.createElement(d.U,{textStyle:"regular",lineHeight:"32px",height:"32px",color:"white",onClick:a?function(){n.dispatch({type:o.SetNotice,notice:void 0});try{i.checkPDFExportPermission(),v(!0)}catch(t){if(!(t instanceof W))throw t;n.dispatch({type:o.SetNotice,notice:t})}}:void 0},a?"Export to PDF":s.a.createElement(bt,{href:"/pricing",color:"white",lineHeight:"inherit",onMouseEnter:function(){return x(!0)},onMouseLeave:function(){return x(!1)}},S?"Upgrade":"Export to PDF")),s.a.createElement(d.U,{textStyle:"regular",lineHeight:"32px",height:"32px",color:"white",onClick:l?function(){try{i.checkHTMLExportPermission(),m(!0)}catch(t){if(!(t instanceof W))throw t;n.dispatch({type:o.SetNotice,notice:t})}}:void 0},l?"Export to HTML":s.a.createElement(yt,{href:"/pricing",color:"white",lineHeight:"inherit",onMouseEnter:function(){return P(!0)},onMouseLeave:function(){return P(!1)}},j?"Upgrade":"Export to HTML")),h===C.UnpublishedChanges&&s.a.createElement(_t,{textStyle:"regular",color:"white",lineHeight:"32px",height:"32px",onClick:function(t){t.stopPropagation(),_(!0)}},y?s.a.createElement(s.a.Fragment,null,s.a.createElement(X,{dangerOnHover:!0,onClick:i.restoreToPublished},"Restore"),s.a.createElement(X,{m:"0 0 0 20px",onClick:function(t){t.stopPropagation(),_(!1)}},"Cancel")):"Restore to last published"),h!==C.Unpublished&&s.a.createElement(d.U,{textStyle:"regular",lineHeight:"32px",height:"32px",color:"white",onClick:i.unpublish},"Unpublish"),s.a.createElement(d.B,{position:"absolute",height:8,width:16,bottom:-8,right:28,color:Object(V.e)(.08,d.Ub.black)},s.a.createElement(d.ob,null)))),p&&E?c.a.createPortal(s.a.createElement(gt,{numId:i.project.num_id,email:i.project.user.email,onExit:function(){return m(!1)}}),E):null,f&&E?c.a.createPortal(s.a.createElement(ct,{numId:i.project.num_id,email:i.project.user.email,onExit:function(){return v(!1)}}),E):null)};function kt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return St(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return St(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function xt(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ct(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){xt(a,n,o,r,s,"next",t)}function s(t){xt(a,n,o,r,s,"throw",t)}r(void 0)}))}}var Ot=Object(a.e)(d.ub).withConfig({displayName:"PublishSection___StyledStyledLink"})(["display:block;width:144px;height:56px;text-align:center;"]),jt=Object(a.e)(d.Cb).withConfig({displayName:"PublishSection___StyledText"})(["display:block;height:56px;width:100%;"]),Pt=function(){var t=Object(r.useContext)(rd),e=Object(r.useContext)(k),i=z(t.project),n=Object(r.useCallback)((function(){var i=Object(f.a)("constructor.canUseFormPermission")?"Injected Code, Forms and Shots will not work in Published project.":"Injected Code and Shots will not work in Published project.";!t.hasPermission(L.canInjectCode)&&t.hasCustomCode()?e.dispatch({type:o.SetNotice,notice:{message:i,tag:H.customCode}}):!t.hasPermission(L.canUseShots)&&t.hasShots()?e.dispatch({type:o.SetNotice,notice:{message:i,tag:H.shots}}):!t.hasPermission(L.canUseForms)&&t.hasForms()&&e.dispatch({type:o.SetNotice,notice:{message:i,tag:H.forms}})}),[]),a=Object(r.useCallback)((function(){!t.publishInProgress&&i!==C.SameAsPublished&&e.dispatch({type:o.SetNotice,notice:void 0})}),[t.publishInProgress,i]),l=i===C.UnpublishedChanges||i===C.SameAsPublished,c=Object(r.useCallback)(Ct(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i===C.SameAsPublished||t.publishInProgress){n.next=20;break}return e.dispatch({type:o.SetNotice,notice:void 0}),n.prev=2,n.next=5,t.publishWithNotice({alsoExport:e.exportAsTemlate});case 5:n.next=20;break;case 7:if(n.prev=7,n.t0=n.catch(2),!(n.t0 instanceof W&&"warning"===n.t0.type)){n.next=15;break}return n.next=12,t.publishWithNotice({skipWarnings:!0,alsoExport:e.exportAsTemlate});case 12:e.dispatch({type:o.SetNotice,notice:n.t0}),n.next=20;break;case 15:if(!(n.t0 instanceof W)){n.next=19;break}e.dispatch({type:o.SetNotice,notice:n.t0}),n.next=20;break;case 19:throw n.t0;case 20:case"end":return n.stop()}}),n,null,[[2,7]])}))),[i,t.publishInProgress,e.exportAsTemlate]),h="".concat(D.a.readymag_host,"/").concat(t.project.user.uri,"/").concat(t.project.uri,"/"),u=!t.isPublishError&&!t.publishInProgress&&i===C.SameAsPublished,p=kt(Object(r.useState)(!1),2),m=p[0],g=p[1];return s.a.createElement(d.B,{position:"relative",width:"100%",minHeight:88,height:88,px:16,justifyContent:"space-between",alignItems:"center"},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),u?s.a.createElement(Ot,{onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},href:h,target:"_blank",textStyle:"regular",color:"tomato",lineHeight:"52px",justifyContent:"center",alignItems:"center",userSelect:"none"},m?"Open":"Published"):s.a.createElement(d.n,{variant:"clean",width:l?144:"100%",height:56,borderRadius:30,bg:"tomato",color:"white",textStyle:"regular","aria-labelledby":"publish-button",onClick:c,onMouseEnter:n,onMouseLeave:a},t.publishInProgress?s.a.createElement(d.m,{width:56,m:"auto"},s.a.createElement(d.Q,{bgColor:"transparent"})):s.a.createElement(jt,{lineHeight:"52px"},t.isPublishError?"Error":i===C.Unpublished?"Publish":"Republish")),l&&s.a.createElement(wt,{m:"0 0 0 8px"}))},Et=i("za5s");function It(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Tt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Mt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Mt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var $t=s.a.memo((function(t){var e=t.link,i=t.m,n=t.color,o=t.borderColor,a=Tt(Object(r.useState)("Copy link"),2),l=a[0],c=a[1],h=function(){c("Copied"),setTimeout((function(){c("Copy link")}),2500)},u=function(){var t=document.createElement("textarea");t.value=e,t.style.top="-9999px",t.style.left="-9999px",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),h()}catch(t){console.error("fallback unable to copy",t)}document.body.removeChild(t)},p=function(){var t,i=(t=regeneratorRuntime.mark((function t(i){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.preventDefault(),!navigator.permissions||!navigator.clipboard){t.next=18;break}return t.prev=2,t.next=5,navigator.permissions.query({name:"clipboard-write"});case 5:if(n=t.sent,"granted"!==(o=n.state)&&"prompt"!==o){t.next=11;break}return t.next=10,navigator.clipboard.writeText(e);case 10:h();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(2),console.error("clipboard.writeText unable to copy",t.t0);case 16:t.next=19;break;case 18:u();case 19:case"end":return t.stop()}}),t,null,[[2,13]])})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){It(a,n,o,r,s,"next",t)}function s(t){It(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t){return i.apply(this,arguments)}}();return s.a.createElement(d.B,{width:"100%",height:40,m:i||0,justifyContent:"space-between"},s.a.createElement(d.n,{width:92,height:40,variant:"bordered",borderColor:o||Object(V.e)(.92,d.Ub.black),textStyle:"small",color:n||"black",onClick:p},l),s.a.createElement(d.n,{width:90,height:38,variant:"bordered",borderColor:o||Object(V.e)(.92,d.Ub.black),as:"a",href:e,target:"_blank",textStyle:"small",color:n||"black",lineHeight:"38px","aria-labelledby":"open-project-by-link"},"Open"))}));$t.displayName="OpenAndCopyLink";var At=i("t2H3");function Rt(){return(Rt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Dt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Bt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Bt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Lt(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var zt=Object(a.e)(d.H).withConfig({displayName:"CustomUrl___StyledInlineInput"})(["text-overflow:ellipsis;&::placeholder{color:",";}&:disabled{color:",";}&:focus{border:none;}"],(function(t){return t._css}),(function(t){return t._css2})),Ft=function(t){var e=t.link,i=t.disabled,n=t.id,o=t.name,a=t.placeholder,l=t.color,h=t.inactiveColor,u=t.textStyle,p=void 0===u?"regular":u,m=t.withSlash,g=t.validationMessageContainer,f=void 0===g?document.body:g,v=t.validationMessageAnchor,b=t.validationMessageZIndex,y=t.validate,_=t.filter,w=t.onDone,k=Lt(t,["link","disabled","id","name","placeholder","color","inactiveColor","textStyle","withSlash","validationMessageContainer","validationMessageAnchor","validationMessageZIndex","validate","filter","onDone"]),S=Dt(Object(r.useState)(e||""),2),x=S[0],C=S[1],O=Dt(Object(r.useState)(x),2),j=O[0],P=O[1],E=Dt(Object(r.useState)(!1),2),I=E[0],T=E[1],M=Dt(Object(r.useState)(),2),$=M[0],A=M[1],R=Dt(Object(r.useState)(),2),D=R[0],B=R[1],L=Dt(Object(r.useState)(!1),2),z=L[0],F=L[1],U=Dt(Object(r.useState)(!1),2),N=U[0],H=U[1],V=Object(r.useCallback)((function(t){13===t.keyCode&&(t.preventDefault(),t.currentTarget.blur())}),[]),W=Object(r.useCallback)((function(t){T(!1),$?(C(j),A(void 0)):(P(x),w(x))}),[x,j,$]),G=Object(r.useCallback)((function(){P(x),T(!0),F(!1)}),[x]),q=Object(r.useCallback)((function(t){if(v&&f&&t){var e=t.getBoundingClientRect();B((i=f.getBoundingClientRect(),n=v.getBoundingClientRect(),o=e,{top:Math.abs(i.top-n.top)-o.height/2+n.height/2,left:Math.abs(i.left-n.left)-o.width}))}var i,n,o}),[v,f]);Object(r.useEffect)((function(){C(e||""),P(e||"")}),[e]);var K=Object(r.useRef)(null),Y=Object(r.useCallback)((function(){return F(!0)}),[]);return Object(r.useEffect)((function(){var t=N&&K.current?function t(e){if(e)return e.scrollHeight>e.clientHeight?e:e.parentNode?t(e.parentNode):void 0}(K.current):void 0;return t&&($?t.addEventListener("scroll",Y):t.removeEventListener("scroll",Y)),function(){t&&t.removeEventListener("scroll",Y)}}),[K,N,$]),s.a.createElement(d.B,Rt({},k,{ref:function(t){K.current=t,H(!0)}}),m&&s.a.createElement(d.Cb,{textStyle:p,color:!I&&!x||i?h||d.Ub.gray:l||d.Ub.black},"/"),s.a.createElement(zt,{type:"text",id:n,name:o,textStyle:p,color:$?d.Ub.tomato:l||d.Ub.black,placeholder:a,spellCheck:!1,autoComplete:"off",autoCorrect:"off",value:x,disabled:i,onKeyDown:V,onChange:function(t){var e=_?_(t.currentTarget.value):t.currentTarget.value,i=y(e);F(!1),C(e),A(i)},onFocus:G,onBlur:W,height:"auto",p:0,_css:h||d.Ub.gray,_css2:h||d.Ub.gray}),I&&$&&f&&!z&&c.a.createPortal(s.a.createElement(At.a,{ml:"-4px",visibility:D?"visible":"hidden",ref:q,key:$,text:$||"",position:"absolute",top:D&&D.top,left:D&&D.left,zIndex:b}),f))};function Ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Nt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Nt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ht=Object(a.e)(d.m).withConfig({displayName:"LinkSettings___StyledBox"})(["white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"]),Vt=Object(a.e)("label").withConfig({displayName:"LinkSettings___StyledLabel"})(["",";color:",";"],(function(t){return t._css}),(function(t){return t._css2})),Wt=s.a.memo((function(t){var e=t.isProjectSettingsOpened,i=t.projectNumId,n=t.publishState,o=t.projectUri,a=t.fullProjectLink,l=t.urlDomainString,c=t.loadUserProjectsLinks,h=t.saveProjectUri,u=Object(r.useContext)(rd),p=Ut(Object(r.useState)([]),2),m=p[0],g=p[1],f=Ut(Object(r.useState)(!1),2),v=f[0],b=f[1];Object(r.useEffect)((function(){e&&(v||(b(!0),c().then((function(t){g(t),b(!1)})).finally((function(){b(!1)}))))}),[e]);var y=Object(r.useCallback)((function(t){var e=function(t,e,i){var n=t.toLowerCase();return/(^-)|(-$)/.test(n)?new Error("The link should not start or end with a hyphen"):"info"===n?new Error("Sorry, info is not acceptable"):n&&n.length>128?new Error("The link should be less than 128 characters long"):/^[0-9]+$/.test(n)&&n!==e.toString()?new Error("The link should not consist of digits only"):i.reduce((function(t,e){return t&&n!==e.uri}),!0)?void 0:new Error("You already have a project with this link")}(t,i,m);return e?e.message:void 0}),[i,m]),_=Object(r.useCallback)((function(t){h(t||i.toString())}),[i]),w=Object(r.useCallback)((function(t){return e=t,[{regex:/(_)/gi,replacer:"-"},{regex:/([^a-zA-Z0-9-])/gi,replacer:""},{regex:/(-{2,})/gi,replacer:"-"}].forEach((function(t){e.match(t.regex)&&(e=e.replace(t.regex,t.replacer))})),e;var e}),[]),k=Object(r.useRef)(null);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ht,{width:"100%",mt:10},s.a.createElement(Vt,{htmlFor:"project-link",title:l,_css:Object(Et.themeGet)("textStyles.small"),_css2:d.Ub.black},"".concat(l,"/")),s.a.createElement(d.m,{ref:k,mb:"10px"},s.a.createElement(Ft,{validationMessageAnchor:k.current,validationMessageContainer:u.popupContainer,textStyle:"regular",name:"project-link",id:"project-link",placeholder:i.toString(),link:o,disabled:v,mt:"4px",validate:y,filter:w,onDone:_}))),n!==C.Unpublished&&s.a.createElement($t,{link:a,m:"2px 0 0 0"}))}));Wt.displayName="LinkSettings";var Gt=function(t){var e=t.p,i=t.m,n=t["aria-labelledby"],o=t.children;return(s.a.createElement(d.m,{width:"100%",p:e||"12px 16px",m:i||"0",borderRadius:"m",bg:"white",textAlign:"center","aria-labelledby":n||"common-error-message"},o))};function qt(){return(qt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Kt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Yt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Kt(Object(i),!0).forEach((function(e){Xt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Kt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Xt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Zt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Jt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Jt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Qt(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var te=Object(a.e)(d.B).withConfig({displayName:"Helptip___StyledFlex"})(["text-decoration:none;&:hover{background:",";& > *{color:",";cursor:inherit;}}"],(function(t){return t._css}),(function(t){return t._css2})),ee=function(t){var e=t.text,i=t.href,n=t.width,o=void 0===n?160:n,a=(t.height,t.p),l=void 0===a?"12px 16px":a,c=t.boxPosition,h=t.arrowPosition,u=t.onClick,p=t.variant,m=void 0===p?"default":p,g=t.forceShow,f=t.whiteSpace,v=Qt(t,["text","href","width","height","p","boxPosition","arrowPosition","onClick","variant","forceShow","whiteSpace"]),b=Object(r.useRef)(null),y=Zt(Object(r.useState)(!!g),2),_=y[0],w=y[1],k=Object(E.d)(_,null,{config:{duration:0},from:{opacity:0},enter:{opacity:1},leave:{opacity:0}}),S="white"===m;return s.a.createElement(d.m,qt({position:"relative",width:24,height:24,minWidth:24},v),s.a.createElement(te,{as:i?"a":void 0,href:i,target:i?"_blank":void 0,justifyContent:"center",alignItems:"center",border:"1px solid",borderColor:Object(V.e)(.92,d.Ub.black),borderRadius:"round",width:24,height:24,lineHeight:24,cursor:i?"pointer":"default",onMouseEnter:function(){return w(!0)},onMouseLeave:function(){return w(!1)},onClick:function(){return u&&u()},_css:S?d.Ub.white:Object(V.e)(.04,d.Ub.darkGray),_css2:S?d.Ub.gray:d.Ub.white},s.a.createElement(d.Cb,{textStyle:"small",color:"gray",cursor:"default"},"?")),k.map((function(t){var i=t.item,n=t.key,a=t.props;return i&&s.a.createElement(E.a.div,{style:Yt(Yt({},a),{},{position:"absolute",bottom:"100%",left:0,pointerEvents:"none"}),key:n},s.a.createElement(d.m,qt({position:"absolute",bottom:0,mb:"12px",width:o},c||{ml:"".concat(-parseInt(o.toString())/2+12,"px")}),s.a.createElement(d.Fb,{text:e,rotation:0,translateX:-8,arrowRef:b,arrowPosition:Yt({top:"100%",left:"50%"},h),width:"100%",height:"auto",p:l,whiteSpace:f||"normal",bg:S?"white":void 0,color:S?"black":void 0,border:S?"1px solid ".concat(Object(V.e)(.92,d.Ub.black)):void 0})))})))},ie=i("OTSC"),ne=i("tyue"),oe=i.n(ne);function ae(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function re(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return se(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return se(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var le=Object(a.e)(d.H).withConfig({displayName:"PrivacySettings___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css}),(function(t){return t._css2})),ce=Object(a.e)(d.B).withConfig({displayName:"PrivacySettings___StyledFlex"})(["&:hover{& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}animation:"," 2s infinite linear;@keyframes loadingindicatoranimation{from{transform:rotateZ(0deg);}to{transform:rotateZ(360deg);}}"],(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5}),(function(t){return t._css6})),de=Object(a.e)(d.ib).withConfig({displayName:"PrivacySettings___StyledRoundButton"})(["&:hover{& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(t){return t._css7}),(function(t){return t._css8}),(function(t){return t._css9})),he=s.a.memo((function(t){var e=t.projectNumId,i=t.isPublished,n=t.disabled,o=t.isClosed,a=t.privateSwitchState,l=t.setPrivateSwitchState,c=t.setProjectPrivacy,u=t.saveBgImage,p=t.saveProjectOptions,m=t.password,g=t.passwordBackground,f=t.isOwner,v=t.ownerEmail,b=re(Object(r.useState)(!1),2),y=b[0],_=b[1],w=re(Object(r.useState)((function(){return m})),2),k=w[0],S=w[1],x=re(Object(r.useState)((function(){return g})),2),C=x[0],O=x[1],j=Object(r.useRef)(null);Object(r.useEffect)((function(){o&&a&&!k&&(m?S(m):l(!1))}),[o]);var P=function(){return Object(nt.K)(e).then((function(t){return ie.default.facebookGraphRefresh(t)}))},E=re(Object(r.useState)(!1),2),I=E[0],T=E[1],M=re(Object(r.useState)(!1),2),$=M[0],A=M[1],R=re(Object(r.useState)(!1),2),B=R[0],L=R[1],z=Object(r.useCallback)(function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(A(!1),!(e.size>D.a.UPLOAD_IMAGE_SIZE_LIMIT)){t.next=4;break}return window.alert(D.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),t.abrupt("return");case 4:if(!B){t.next=6;break}return t.abrupt("return");case 6:return L(!0),t.prev=7,t.next=10,Object(nt.T)("password-bg",e);case 10:(i=t.sent)&&i.picture&&i.picture.url&&(O(i.picture.url),u(i.picture.url).fail((function(){O(g)})).always((function(){L(!1)}))),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(7),L(!1);case 17:case"end":return t.stop()}}),t,null,[[7,14]])})),function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){ae(a,n,o,r,s,"next",t)}function s(t){ae(a,n,o,r,s,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),[B]),F=n&&!a;return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.B,{width:"100%",height:24,mb:"4px",justifyContent:"space-between"},s.a.createElement(d.Cb,{textStyle:"small",lineHeight:"24px",color:F?Object(V.e)(.6,d.Ub.black):"black"},"Protect with a password"),F?s.a.createElement(ee,{width:194,text:f?"Upgrade your account to use password protection":"Contact owner for upgrade account to use password protection",boxPosition:{ml:"-169px"},arrowPosition:{left:"auto",right:-3},href:f?"/settings#change-plan":"mailto:".concat(v),onClick:function(){h.d.sendEvent(h.b.PrivacyAlertUpgrade)}}):s.a.createElement(d.zb,{backgroundChecked:"green",checked:a,onChange:function(){if(!y){var t=!a;l(t),(t&&m||!t)&&(_(!0),c({isPrivate:t}).then((function(){t&&p({sharebutton:!1})})).catch((function(){l(!t)})).finally((function(){_(!1)}))),i&&P(),h.d.sendEvent(h.b.PasswordToggle,{eventLabel:t?"on":"off"})}},disabled:n})),n&&a&&s.a.createElement(Gt,{m:"0 0 16px"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Please note that if you remove the password, you won’t be able to set it back again as your current subscription plan doesn’t support password protection.")),a&&s.a.createElement(d.m,{width:"100%"},s.a.createElement(d.B,{justifyContent:"space-between"},s.a.createElement(le,{ref:j,name:"project-password",id:"project-password",type:"text",mb:"4px",color:"black",fontSize:"regular",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"Set password",value:k,onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),t.currentTarget.blur())},onChange:function(t){var e;S(function(t){return/\s/.test(t)?t.replace(/\s/g,""):t}((e=t.currentTarget.value,/[^\x00-\x7f]/.test(e)?e.replace(/[^\x00-\x7f]/g,""):e)))},onBlur:function(){if(a){if(k!==m){_(!0);var t=!m;c({isPrivate:!0,password:k}).finally((function(){_(!1),t&&P()})),k&&h.d.sendEvent(h.b.SetProjectPassword)}}else S(m)},_css:d.Ub.gray,_css2:d.Ub.gray}),k&&s.a.createElement(d.B,{width:22,height:24,pl:"4px",justifyContent:"flex-start",alignItems:"center"},s.a.createElement(d.p,{color:"green"}))),s.a.createElement(d.Cb,{textStyle:"small"},"Password page background"),s.a.createElement(d.m,{width:192,height:125,mt:"4px",position:"relative",opacity:$?.8:1,onDragEnter:function(){$||A(!0)},onDragLeave:function(){$&&A(!1)},onMouseEnter:function(){return T(!0)},onMouseLeave:function(){return T(!1)}},s.a.createElement(d.A,{id:"privacy-bg-upload",accept:"image/*",dropFile:!0,readFileData:!1,onChange:z},s.a.createElement(s.a.Fragment,null,s.a.createElement(d.m,{width:192,height:125,bg:"darkGrey",borderRadius:"s",position:"relative",cursor:"pointer",boxShadow:"0 1px 1px rgba(64, 64, 64, 0.32)"},s.a.createElement(d.v,{width:"100%",height:"100%",borderRadius:"s",backgroundImage:"url(".concat(C||oe.a,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"})),(I||B)&&!$&&s.a.createElement(d.B,{width:96,height:32,position:"absolute",left:0,right:0,bottom:9,m:"auto",justifyContent:"space-around"},s.a.createElement(ce,{width:32,height:32,justifyContent:"center",alignItems:"center",border:"1px solid rgba(128, 128, 128, 0.16)",borderRadius:"round",bg:"white",cursor:B?"default":"pointer",_css3:d.Ub.tomato,_css4:d.Ub.tomato,_css5:d.Ub.white,_css6:B?"loadingindicatoranimation":"none"},s.a.createElement(d.gb,{color:"black"})),C&&!B&&s.a.createElement(de,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onClick:function(t){t.preventDefault(),t.stopPropagation(),B||(L(!0),O(void 0),u("").fail((function(){O(g)})).always((function(){L(!1)})))},_css7:d.Ub.tomato,_css8:d.Ub.tomato,_css9:d.Ub.white},s.a.createElement(d.w,{color:"black"}))))))))}));function ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return pe(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pe(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}he.displayName="PrivacySettings";var me=s.a.memo((function(t){var e=t.allowIndex,i=t.indexDisabled,n=t.projectHidden,o=t.profileUrl,a=t.saveProjectOptions,l=ue(Object(r.useState)((function(){return e})),2),c=l[0],u=l[1],p=ue(Object(r.useState)((function(){return n})),2),m=p[0],g=p[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.B,{width:"100%",height:24,mb:"4px",justifyContent:"space-between"},s.a.createElement(d.Cb,{textStyle:"small",lineHeight:"24px",color:i?Object(V.e)(.6,d.Ub.black):"black"},"Make searchable"),i?s.a.createElement(ee,{width:194,text:"Upgrade to make your site visible to search engines",boxPosition:{ml:"-169px"},arrowPosition:{left:"auto",right:-3},href:"/settings#change-plan"}):s.a.createElement(d.zb,{backgroundChecked:"green",checked:c,onChange:function(){if(!i){var t=!c;u(t),a({allowindex:t}),h.d.sendEvent(h.b.ProjectVisibleToSearchEngines,{eventLabel:t?"visible":"hidden"})}},disabled:i})),s.a.createElement(d.B,{width:"100%",minHeight:24,mb:"4px",justifyContent:"space-between",alignItems:"center"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Add to my"," ",s.a.createElement(d.ub,{href:o,target:"_blank",textStyle:"small"},"Public Profile")),s.a.createElement(d.zb,{backgroundChecked:"green",checked:!m,onChange:function(){var t=!m;g(t),a({hidden:t}),h.d.sendEvent(h.b.ProjectVisibileToVisitors,{eventLabel:t?"hidden":"visible"})}})))}));function ge(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return fe(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return fe(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}me.displayName="VisibilitySettings";var ve=s.a.memo((function(t){var e=t.isActiveSubscription,i=t.numId,n=ge(Object(r.useState)(!1),2),o=n[0],a=n[1];return s.a.createElement(d.B,{width:"100%",height:24,mb:"4px",justifyContent:"space-between"},s.a.createElement(d.Cb,{textStyle:"small",lineHeight:"24px",color:e?"black":Object(V.e)(.6,d.Ub.black)},o?"Submitted":"Submit"," to"," ",s.a.createElement(d.ub,{href:"".concat(D.a.readymag_host,"/examples/"),target:"_blank",textStyle:"small",color:e?"black":Object(V.e)(.6,d.Ub.black)},"Examples")),e?s.a.createElement(d.zb,{backgroundChecked:"green",checked:o,onChange:function(){e&&Object(nt.F)("".concat(D.a.readymag_host,"/").concat(i,"/")).then((function(t){a(!0),h.d.sendEvent(h.b.SubmitToExplore)})).catch((function(){console.warn("sendToExamples error")}))},disabled:o}):s.a.createElement(ee,{width:194,text:"Upgrade your account to submit projects to Examples",boxPosition:{ml:"-169px"},arrowPosition:{left:"auto",right:-3},href:"/settings#change-plan"}))}));function be(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ye(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ye(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}ve.displayName="SubmitToExamples";var _e,we=function(t){var e,i=t.isActive,n=Object(r.useContext)(k),a=Object(r.useContext)(rd),l=be(Object(r.useState)((function(){return a.project.title||""})),2),c=l[0],h=l[1],u=be(Object(r.useState)(!1),2),p=u[0],m=u[1],g=be(Object(r.useState)((function(){return a.project.description||""})),2),f=g[0],v=g[1],b=be(Object(r.useState)(!1),2),y=b[0],_=b[1];Object(r.useEffect)((function(){p||h(a.project.title||"")}),[a.project.title]);var w=function(){m(!1);var t=N(c," ").trim();h(t),a.projectSave({title:t},{patch:!0})};Object(r.useEffect)((function(){y||v(a.project.description||"")}),[a.project.description]);var S=function(){_(!1);var t=f.trim();v(t),a.projectSave({description:t},{patch:!0})},x=Object(r.useMemo)((function(){return F(a.project)}),[a.project.domain,a.project.user.domain,a.project.user.uri]),C=Object(r.useMemo)((function(){return(t=a.project.user).domain?t.domain:"".concat(D.a.readymag_host,"/").concat(t.uri);var t}),[a.project.user]),O=Object(r.useMemo)((function(){return"".concat(D.a.readymag_host,"/").concat(a.project.user.uri,"/").concat(a.project.num_id,"/")}),[a.project.num_id,a.project.user.uri]),j=Object(r.useCallback)((function(t){t!==a.project.uri&&a.projectSave({uri:t},{patch:!0})}),[]),P=be(Object(r.useState)((function(){return a.project.is_private})),2),E=P[0],I=P[1],T=Object(r.useCallback)((function(t){return a.projectSave({pass_bg:t},{patch:!0})}),[]),M=Object(r.useMemo)((function(){return z(a.project)}),[a.project.is_published,a.project.changed]),$=Object(r.useMemo)((function(){var t=a.project.user.permissions.viewer_opts_overrides||{};return t&&void 0!==t.allowindex}),[a.project.user]),A=Object(r.useMemo)((function(){return"active"===(window.RM.constructorRouter.me.get("stripe")||{}).subscription_status}),[window.RM.constructorRouter.me]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.jb,null,(function(t){var e=t.ref;return(s.a.createElement(d.m,{width:"100%",maxHeight:160,ref:e},s.a.createElement(d.I,{name:"project-title-in-settings",placeholder:"Project Title",translate:"no",spellCheck:!1,maxLength:128,rows:1,autoSize:!0,textStyle:"regular",color:"black",value:c,onChange:function(t){h(N(String(t.currentTarget.value)))},onFocus:function(){m(!0)},onBlur:w})))})),s.a.createElement(d.jb,null,(function(t){var e=t.ref;return(s.a.createElement(d.m,{width:"100%",maxHeight:96,mt:"10px",ref:e},s.a.createElement(d.I,{name:"project-description",placeholder:"Description",translate:"no",spellCheck:!1,maxLength:6e3,rows:1,autoSize:!0,textStyle:"small",color:"black",value:f,onChange:function(t){v(t.currentTarget.value)},onFocus:function(){_(!0)},onBlur:S})))})),s.a.createElement(Wt,{isProjectSettingsOpened:n.isProjectSettingsOpened,projectNumId:a.project.num_id,publishState:M,projectUri:a.project.uri,fullProjectLink:O,urlDomainString:x,loadUserProjectsLinks:function(){return a.loadUserProjectsLinks(a.project.user._id)},saveProjectUri:j}),s.a.createElement(d.B,{width:"100%",mt:a.project.is_published?16:0,flexDirection:"column"},s.a.createElement(he,{projectNumId:a.project.num_id,isPublished:a.project.is_published,privateSwitchState:E,setPrivateSwitchState:I,disabled:!(null===(e=a.project.user)||void 0===e?void 0:e.permissions.can_make_mag_private),isClosed:!n.isProjectSettingsOpened||!i,setProjectPrivacy:a.setProjectPrivacy,saveBgImage:T,saveProjectOptions:a.setProjectOptions,password:a.project.pass,passwordBackground:a.project.pass_bg,isOwner:a.isOwner,ownerEmail:a.project.user.email}),!E&&s.a.createElement(me,{allowIndex:a.project.opts.allowindex,projectHidden:a.project.opts.hidden,indexDisabled:$,profileUrl:C,saveProjectOptions:a.setProjectOptions}),!E&&a.project.is_published&&s.a.createElement(ve,{isActiveSubscription:A,numId:a.project.num_id})),a.project.user.permissions.can_export_template&&s.a.createElement(d.B,{width:"100%",height:24,justifyContent:"space-between"},s.a.createElement(d.Cb,{textStyle:"small",lineHeight:"24px"},"Export as template"),s.a.createElement(d.zb,{backgroundChecked:"green",checked:n.exportAsTemlate,onChange:function(){n.dispatch({type:o.ToggleExportAsTemlate})}})))},ke=function(t){var e=t.showUpgradeAlert,i=t.onOpenCodeEditorClick;return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.n,{width:"100%",height:40,mt:"5px",mb:16,variant:"bordered",textStyle:"small",onClick:i},"Open Code Editor"),e&&s.a.createElement(Gt,null,s.a.createElement(d.Cb,{textStyle:"small",color:"tomato"},"Injected code works",s.a.createElement("br",null),"for Preview only!"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement(d.Cb,{textStyle:"small",color:"black"},s.a.createElement(d.ub,{href:"/settings#change-plan",target:"_blank",textStyle:"small",isActive:!0,onClick:function(){h.d.sendEvent(h.b.CodeEditorUpdate)}},"Upgrade")," ","to have it work",s.a.createElement("br",null),"in Published project.")))},Se=i("0NDv");function xe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ce(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ce(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.invalid="invalid",t.unpublished="unpublished",t.subscriptionExpired="subscription-expired",t.notfound="notfound",t.testDnsError="test-dns-error",t.testOtherUser="test-other-user",t.testSameUser="test-same-user",t.domainSetDnsError="domain-set-dns-error",t.waitOurDnsServer="wait-our-dns-server",t.domainSetTryLater="domain-set-try-later",t.serverError="server-error"}(_e||(_e={}));var Oe=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=Object(r.useContext)(rd),n=Object(r.useState)((function(){return t||""})),o=xe(n,2),a=o[0],s=o[1],l=Object(r.useState)(),c=xe(l,2),d=c[0],u=c[1],p=Object(r.useState)(!1),m=xe(p,2),g=m[0],f=m[1],v=Object(r.useState)(!1),b=xe(v,2),y=b[0],_=b[1],w=function(t,e,i){g&&f(!1),u({errorType:t,dnsError:e,domainData:i})},k=function(){u(void 0)},S=function(){a&&!y&&(/:|@|\\|\//.test(a)?w(_e.invalid):(_(!0),i.checkDomain(a).then((function(t){if(!t)return w(_e.serverError),e||h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: no response from server"}),void _(!1);if(t.errors.notPublished)return w(_e.unpublished),e||h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: unpublished"}),void _(!1);if(t.errors.noValidSubscription)return w(_e.subscriptionExpired),e||h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: subscription expired"}),void _(!1);if(!e&&t.errors.badDomainName)return w(_e.invalid),h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: invalid symbols"}),void _(!1);if(t.errors.domainNotFound)return w(_e.notfound),e||h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: nslookup not found"}),void _(!1);if(e){if(t.errors.badDNSSettings){var i=U(t.dnsSettings);return w(_e.domainSetDnsError,{domainName:a,recordType:i.recordType,currentValue:i.currentValue,neededValue:i.neededValue}),void _(!1)}}else{if(t.errors.badDNSSettings||t.errors.ipv6Present||t.errors.invalidOwner){var n=U(t.dnsSettings),o=function(){w(_e.testDnsError,{domainName:a,recordType:n.recordType,currentValue:n.currentValue,neededValue:n.neededValue,badDNSSettings:!!t.errors.badDNSSettings,ipv6Present:!!t.errors.ipv6Present,invalidOwner:!!t.errors.invalidOwner,ownerKey:t.dnsSettings.ownerKey})};return Se.a.get("http://".concat(a,"/api/domainmaptest")).then((function(t){t&&t.domainOk?o():w(_e.waitOurDnsServer)})).catch((function(){return o()})).finally((function(){_(!1)})),void h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: bad dns settings ".concat(n.recordType)})}var r=t.domain_data||{},s=r.mag||{},l=r.user||s.user||{},c=l.name||"UNKNOWN",d="/"+(l.uri||"UNKNOWN")+"/",u=d+(s.uri||"UNKNOWN")+"/",p=s.title||u;if(t.errors.domainUsed)return t.errors.usedByOtherUser?w(_e.testOtherUser,void 0,{userName:c,userUrl:d}):w(_e.testSameUser,void 0,{magName:p,magUrl:u,entityType:r.type,userUrl:d}),h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: already in use"}),void _(!1)}_(!1),f(!0)})).catch((function(){e||h.d.sendEvent(h.b.MapDomain,{eventLabel:"error: no response from server"}),w(_e.serverError),_(!1)}))))};return{testingDomain:a,domainError:d,domainCheckSuccess:g,isProcessingTest:y,setTestingDomain:s,checkDomain:S,showDomainError:w,hideDomainError:k,setDomainCheckSuccess:f}},je=function(){h.d.sendEvent(h.b.DomainAlertUpgrade)},Pe=Object(a.e)("ul").withConfig({displayName:"CheckDomain___StyledUl"})(["margin:4px 0;"]),Ee=Object(a.e)("li").withConfig({displayName:"CheckDomain___StyledLi"})(["",""],(function(t){return t._css})),Ie=Object(a.e)("li").withConfig({displayName:"CheckDomain___StyledLi2"})(["",""],(function(t){return t._css2})),Te=Object(a.e)("li").withConfig({displayName:"CheckDomain___StyledLi3"})(["",""],(function(t){return t._css3})),Me=function(t){var e=t.domainError,i=t.m,n=t.showUnmap,o=t.mapDomain,a=t.unmapDomain,r=e?e.dnsError:void 0,l=e?e.domainData:void 0;return e?s.a.createElement(Gt,{m:i||"0 0 14px","aria-labelledby":"domain-error-message"},function(){if(!e)return null;switch(e.errorType){case _e.serverError:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Something went wrong.",s.a.createElement("br",null),"Please try again later.");case _e.unpublished:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"You can","'","t use custom domain mapping on unpublished project. Please, publish it first.");case _e.subscriptionExpired:return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Please"," ",s.a.createElement(d.ub,{href:"/settings#change-plan",target:"_blank",textStyle:"small",color:"tomato",onClick:je},"upgrade")," ","to access custom domain mapping."),s.a.createElement(d.ub,{href:"".concat(D.a.readymag_host,"/pricing/"),target:"_blank",textStyle:"small",color:"tomato"},"See the pricing"));case _e.invalid:return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Domain name should not contain non-alphanumeric characters. No directories are allowed.",s.a.createElement("br",null),s.a.createElement("br",null),"Examples:"),s.a.createElement("br",null),s.a.createElement(d.Cb,{textStyle:"small",color:"gray"},"mydomain.com",s.a.createElement("br",null),"www.mydomain.com",s.a.createElement("br",null),"readymag.mydomain.com"));case _e.notfound:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"We can’t find the info for this domain. Please check the name again. Note that it may take up to a few hours for a subdomain to get created.");case _e.waitOurDnsServer:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Your domain settings are correct; It seems that our DNS servers haven","'","t updated yet, though.",s.a.createElement("br",null),"It may take up to 72 hrs.",s.a.createElement("br",null),"Please try again later.");case _e.testDnsError:return s.a.createElement(s.a.Fragment,null,function(){if(!r)return null;var t=[r.invalidOwner,r.badDNSSettings,r.ipv6Present].filter((function(t){return Boolean(t)}));return(s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Please go to your domain registrar website, open the DNS settings and take"," ",1===t.length?"this step":"these steps",":"),s.a.createElement(Pe,null,r.invalidOwner&&s.a.createElement(Ee,{key:"invalidOwner",_css:"padding: 4px 0"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Confirm your domain ownership—add a TXT record with the value"," ",s.a.createElement(d.Cb,{textStyle:"small",color:"darkGray",fontFamily:"monospace"},r.ownerKey)),"."),r.badDNSSettings&&s.a.createElement(Ie,{key:"dnsError",_css2:"padding: 4px 0"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Change the value of your ",r.recordType," to"," ",s.a.createElement(d.Cb,{textStyle:"small",color:"darkGray",fontFamily:"monospace"},r.neededValue?r.neededValue.replace(/\.$/,""):""),".")),r.ipv6Present&&s.a.createElement(Te,{key:"ipv6Present",_css3:"padding: 4px 0"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Remove the AAAA-record from your DNS settings to"," "),s.a.createElement(d.ub,{href:"https://help.readymag.com/hc/en-us/articles/360021875752-SSL",target:"_blank",textStyle:"small",color:"tomato"},"disable iPv6"),".")),s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"These changes can take anywhere between a couple of minutes and 72 hours to start working properly. When the updates come into effect, test again and hit the ‘Map’ button.")))}());case _e.testOtherUser:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"This domain is already used by"," ",s.a.createElement(d.ub,{href:l&&l.userUrl?l.userUrl:"#",target:"_blank",textStyle:"small",color:"tomato"},l&&l.userName?l.userName:"other user"),".");case _e.testSameUser:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"This domain is already mapped to"," ",s.a.createElement(d.ub,{href:l&&l.magUrl?l.magUrl:"#",target:"_blank",textStyle:"small",color:"tomato"},l&&l.magName?l.magName:"project name"),".",s.a.createElement("br",null),s.a.createElement(d.ub,{textStyle:"small",color:"tomato",onClick:function(){return o&&o()}},"Switch it to current project"));case _e.domainSetDnsError:return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Seems like your DNS settings have been changed.")," ",r?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"This domain’s ",r.recordType?r.recordType:""," ","UNKNOWN"===r.currentValue?"is not currently set":"is currently set to"," ","UNKNOWN"!==r.currentValue?r.currentValue:"",". Please change your"," ",r.recordType?r.recordType:""," to"," ",s.a.createElement(d.Cb,{textStyle:"small",color:"darkGray",fontFamily:"monospace"},r.neededValue?r.neededValue:"")," ","at your registrar settings."," ")):null);case _e.domainSetTryLater:return s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Seems that some of the DNS servers haven","'","t updated yet.",s.a.createElement("br",null),"It may take 72 hrs.",s.a.createElement("br",null),"Please try again later.");default:return null}}(),n&&a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"or")," ",s.a.createElement(d.ub,{textStyle:"small",color:"tomato",onClick:function(){return a()}},"Unmap"))):null};function $e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ae(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ae(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Re,De=Object(a.e)("label").withConfig({displayName:"DomainTest___StyledLabel"})(["",";"],(function(t){return t._css})),Be=Object(a.e)(d.H).withConfig({displayName:"DomainTest___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css2}),(function(t){return t._css3})),Le=function(){var t=Object(r.useContext)(rd),e=Oe(t.project.last_checked_domain||""),i=e.testingDomain,n=e.domainError,o=e.domainCheckSuccess,a=e.isProcessingTest,l=e.setTestingDomain,c=e.checkDomain,u=e.showDomainError,p=e.hideDomainError,m=e.setDomainCheckSuccess,g=$e(Object(r.useState)(!1),2),f=g[0],v=g[1],b=function(){i&&!f&&(v(!0),n&&p(),t.mapDomain(i).then((function(){Object(nt.K)(t.project.num_id).then((function(t){return ie.default.facebookGraphRefresh(t)}));var e=/^www\./.test(i)?" www":"";h.d.sendEvent(h.b.MapDomain,{eventLabel:"success".concat(e)})})).catch((function(t){t&&t.badDomainName?u(_e.domainSetTryLater):u(_e.serverError)})).finally((function(){v(!1)})))};return s.a.createElement(s.a.Fragment,null,s.a.createElement(De,{htmlFor:"project-domain",_css:Object(Et.themeGet)("textStyles.small")},"Enter registered domain name"),s.a.createElement(Be,{name:"project-domain",id:"project-domain",type:"text",mt:"4px",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"yourdomainname.com","aria-labelledby":"test-domain-input",value:i,onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),t.currentTarget.blur(),c())},onChange:function(t){n&&p(),o&&m(!1),l(function(t){var e=t.trim();return e=(e=(e=(e=(e=(e=e.replace(/^\/\//,"")).replace(/^[A-Za-z]+?:\/\//,"")).replace(/\/.*$/,"")).replace(/:\d*$/,"")).replace(/^.*?@/,"")).trim()}(t.currentTarget.value))},_css2:d.Ub.gray,_css3:d.Ub.gray}),s.a.createElement(d.n,{width:"100%",height:40,mt:"2px",mb:14,variant:"bordered",textStyle:"small",disabled:!i||a||f,onClick:o?b:c,"aria-labelledby":o?"map-domain-button":"test-domain-button"},o?f?"Mapping":"Map":a?"Testing...":"Test"),s.a.createElement(Me,{domainError:n,onHideError:p,mapDomain:b}),o&&s.a.createElement(Gt,{m:"0 0 14px"},s.a.createElement(d.Cb,{textStyle:"small",color:"green"},"Your domain is pointing to Readymag",s.a.createElement("br",null),"and can be mapped to this project.")))};function ze(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Fe(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){ze(a,n,o,r,s,"next",t)}function s(t){ze(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ne(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ne(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.domainSetTryLater="domain-set-try-later",t.serverError="server-error"}(Re||(Re={}));var He=Object(a.e)("label").withConfig({displayName:"DomainSettings___StyledLabel"})(["color:",";",";"],(function(t){return t._css}),(function(t){return t._css2})),Ve=Object(a.e)(d.H).withConfig({displayName:"DomainSettings___StyledInlineInput"})(["padding:0;&:focus{border:none;}"]),We=Object(a.e)(d.B).withConfig({displayName:"DomainSettings___StyledFlex"})(["background-image:",";background-size:cover;background-position:center;& svg{opacity:0;}&:hover{background-image:none;& > div{opacity:1;}& svg{color:",";opacity:1;}}"],(function(t){return t._css3}),(function(t){return t._css4})),Ge=Object(a.e)(d.B).withConfig({displayName:"DomainSettings___StyledFlex2"})(["&:hover{& svg{color:",";}}"],(function(t){return t._css5})),qe=Object(a.e)(d.B).withConfig({displayName:"DomainSettings___StyledFlex3"})(["animation:loadingindicatoranimation 2s infinite linear;@keyframes loadingindicatoranimation{from{transform:rotateZ(0deg);}to{transform:rotateZ(360deg);}}"]),Ke=function(){var t=Object(r.useContext)(rd),e=Oe(t.project.domain||"",!0),i=e.domainError,n=e.domainCheckSuccess,o=e.isProcessingTest,a=e.checkDomain,l=e.hideDomainError;Object(r.useEffect)((function(){a()}),[]);var c=Object(r.useMemo)((function(){return!!t.project.domain&&i&&(i.errorType===_e.domainSetDnsError||i.errorType===_e.notfound||i.errorType===_e.subscriptionExpired)}),[t.project.domain,i]),u=Ue(Object(r.useState)(!1),2),p=u[0],m=u[1],g=Ue(Object(r.useState)(!1),2),f=g[0],v=g[1],b=Ue(Object(r.useState)(!1),2),y=b[0],_=b[1],w=function(){v(!0),t.unmapDomain().catch((function(){_(!0)})).finally((function(){v(!1)}))},k=Ue(Object(r.useState)(!1),2),S=k[0],x=k[1],C=Object(r.useMemo)((function(){return t.project.opts.favicon}),[t.project.opts.favicon]),O=Object(r.useCallback)(function(){var e=Fe(regeneratorRuntime.mark((function e(i){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.size>D.a.UPLOAD_IMAGE_SIZE_LIMIT)){e.next=3;break}return window.alert(D.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),e.abrupt("return");case 3:if(!S){e.next=5;break}return e.abrupt("return");case 5:return x(!0),e.prev=6,e.next=9,Object(nt.T)("favicon",i);case 9:if(!(n=e.sent)||!n.baseUrl){e.next=14;break}return e.next=13,t.setProjectOptions({favicon:n.baseUrl});case 13:x(!1);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),x(!1);case 19:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}(),[S]),j=function(){var e=Fe(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.setProjectOptions({favicon:""});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=t.project.opts.sslState||"";return/pending/.test(e)?"pending on"===e:!!t.project.opts.ssl},E=Ue(Object(r.useState)((function(){return P()})),2),I=E[0],T=E[1],M=Ue(Object(r.useState)(),2),$=M[0],A=M[1],R=Ue(Object(r.useState)(!1),2),B=R[0],L=R[1],z=Object(r.useRef)().current,F=Object(r.useRef)().current,U=function(t){T(t),L(!1),clearInterval(z),clearInterval(F)};Object(r.useEffect)((function(){T(P())}),[t.project.opts.sslState,t.project.opts.ssl]),Object(r.useEffect)((function(){N(!1)}),[]);var N=function(e){L(!0);var i=!!t.project.opts.ssl,n=function(){t.getSSLState().then((function(n){if(n&&n.opts&&n.opts.sslState){var o=n.opts.ssl;"success"===n.opts.sslState?(U(o),e&&(t.projectSet({ssl:o},{silent:!0}),h.d.sendEvent(h.b.SSLToggle,{eventLabel:"ssl ".concat(o?"on":"off")}))):"error"===n.opts.sslState&&(U(o),e&&A(Re.serverError))}else U(i)})).catch((function(){U(i),e&&A(Re.serverError)}))};z=setInterval(n,5e3),n(),F=setTimeout((function(){U(i),A(Re.serverError)}),3e5)};return s.a.createElement(s.a.Fragment,null,o?s.a.createElement(d.B,{justifyContent:"center"},s.a.createElement(d.Q,{bgColor:"transparent",color:"black"})):i&&!n?s.a.createElement(Me,{domainError:i,onHideError:l,showUnmap:c,unmapDomain:w}):s.a.createElement(s.a.Fragment,null,s.a.createElement(He,{htmlFor:"project-mapped-domain",_css:Object(Et.themeGet)("colors.black"),_css2:Object(Et.themeGet)("textStyles.small")},"Name"),s.a.createElement(Ve,{id:"project-mapped-domain",type:"text",spellCheck:!1,autoCorrect:"off",defaultValue:t.project.domain,mt:"4px","aria-labelledby":"mapped-domain",readOnly:!0}),p?s.a.createElement(d.B,{width:"100%",height:40,mt:12,mb:16,justifyContent:"space-between",alignItems:"center"},s.a.createElement(d.n,{width:90,height:38,variant:"bordered",textStyle:"small",lineHeight:"38px",background:"white",onClick:w,"aria-labelledby":"unmap-domain"},"Unmap"),s.a.createElement(d.n,{width:90,height:38,variant:"bordered",textStyle:"small",lineHeight:"38px",background:"white",onClick:function(){m(!1)}},"Cancel")):s.a.createElement(d.n,{width:"100%",height:40,mt:12,mb:16,variant:"bordered",textStyle:"small",disabled:!t.project.domain||f,onClick:function(){m(!0),y&&_(!1)},"aria-labelledby":"open-unmap-dialog"},f?"Unmaping":"Unmap"),y&&s.a.createElement(Gt,{m:"0 0 14px"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Something went wrong.",s.a.createElement("br",null),"Please try again later.")),s.a.createElement(d.B,{width:"100%",height:24,mb:16,justifyContent:"space-between"},s.a.createElement(d.Cb,{textStyle:"small",lineHeight:"24px",color:"black"},"Favicon"),C&&s.a.createElement(We,{width:24,height:24,borderRadius:"round",justifyContent:"center",alignItems:"center",border:"1px solid rgba(64, 64, 64, 0.08)",cursor:"pointer",onClick:j,_css3:t.project.opts.favicon?"url(".concat(ie.default.addFilenameComponent(t.project.opts.favicon,57),")"):"none",_css4:d.Ub.tomato},s.a.createElement(d.w,{color:"black"})),!C&&s.a.createElement(d.A,{id:"favicon-upload",accept:"image/*",dropFile:!1,readFileData:!1,onChange:O},s.a.createElement(Ge,{width:24,height:24,borderRadius:"round",justifyContent:"center",alignItems:"center",border:"1px solid rgba(64, 64, 64, 0.08)",cursor:"pointer",_css5:d.Ub.tomato},s.a.createElement(d.eb,{color:"black"})))),s.a.createElement(d.B,{width:"100%",height:24,mb:16,justifyContent:"space-between"},s.a.createElement(d.Cb,{textStyle:"small",lineHeight:"24px",color:"black"},"SSL"),s.a.createElement(d.B,{width:68,height:24,justifyContent:"space-between"},s.a.createElement(ee,{text:"An SSL Certificate provides privacy, security, and data integrity for your projects",href:"https://help.readymag.com/hc/en-us/articles/360021875752-SSL",width:194,boxPosition:{ml:"-125px"},arrowPosition:{left:"auto",right:41},mr:"4px"}),B?s.a.createElement(qe,{size:24,justifyContent:"flex-end"},s.a.createElement(d.pb,{color:"tomato"})):s.a.createElement(d.zb,{backgroundChecked:"green",checked:I,disabled:f,onChange:function(){var e=!I;$&&A(void 0),T(e),t.changeSSL(e).then((function(){N(!0),h.d.sendEvent(h.b.SSLToggle,{eventLabel:"ssl ".concat(e?"on":"off")})})).catch((function(t){T(!e),t&&t.badDNSSettings?A(Re.domainSetTryLater):A(Re.serverError)}))}}))),$&&s.a.createElement(Gt,{m:"0 0 14px"},$===Re.domainSetTryLater&&s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Seems that some of the DNS servers haven","'","t updated yet. It may take 72 hrs.",s.a.createElement("br",null),"Please try again later."),$===Re.serverError&&s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Something went wrong.",s.a.createElement("br",null),"Please try again later."))))};function Ye(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Xe(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Xe(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xe(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ze=Object(a.e)("label").withConfig({displayName:"RegisterDomain___StyledLabel"})(["",";"],(function(t){return t._css})),Je=Object(a.e)(d.H).withConfig({displayName:"RegisterDomain___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css2}),(function(t){return t._css3})),Qe=Object(a.e)(d.Gb).withConfig({displayName:"RegisterDomain___StyledTriangleIcon"})(["transform:rotate(-90deg);"]),ti=function(){var t=Ye(Object(r.useState)(),2),e=t[0],i=t[1],n=Ye(Object(r.useState)("https://iwantmyname.com"),2),o=n[0],a=n[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{htmlFor:"register-domain",_css:Object(Et.themeGet)("textStyles.small")},"Or register new domain name"),s.a.createElement(d.B,{width:"100%"},s.a.createElement(Je,{name:"register-domain",id:"register-domain",type:"text",mt:"4px",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"iwantmyname.com",value:e,onKeyDown:function(t){13===t.keyCode&&(t.preventDefault(),t.currentTarget.blur())},onChange:function(t){i(t.currentTarget.value),t.currentTarget.value?a("https://iwantmyname.com/services/social/readymag-custom-domain?_r=readymag&domain=".concat(encodeURIComponent(t.currentTarget.value))):a("https://iwantmyname.com")},_css2:d.Ub.gray,_css3:d.Ub.gray}),s.a.createElement(d.m,{width:14,position:"relative",top:12,left:1},s.a.createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},s.a.createElement(Qe,{color:e?"black":"gray"})))))};function ei(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ii(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ii(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ii(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ni=Object(a.e)("label").withConfig({displayName:"GaSettings___StyledLabel"})(["",";"],(function(t){return t._css})),oi=Object(a.e)(d.B).withConfig({displayName:"GaSettings___StyledFlex"})(["&:hover{& .help-link{opacity:1;}}"]),ai=Object(a.e)(d.H).withConfig({displayName:"GaSettings___StyledInlineInput"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css2}),(function(t){return t._css3})),ri=Object(a.e)("label").withConfig({displayName:"GaSettings___StyledLabel2"})(["",";"],(function(t){return t._css4})),si=Object(a.e)(d.B).withConfig({displayName:"GaSettings___StyledFlex2"})(["&:hover{& .help-link{opacity:1;}}"]),li=Object(a.e)(d.H).withConfig({displayName:"GaSettings___StyledInlineInput2"})(["&:focus{border:none;}&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css5}),(function(t){return t._css6})),ci=function(t){var e=t.ga,i=t.gtm,n=t.canUseGtm,o=t.saveProjectOptions,a=ei(Object(r.useState)((function(){return e||""})),2),l=a[0],c=a[1],u=ei(Object(r.useState)((function(){return i||""})),2),p=u[0],m=u[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.m,{width:"100%",mt:"4px"},s.a.createElement(ni,{htmlFor:"google-analytics",_css:Object(Et.themeGet)("textStyles.small")},"Google Analytics"),s.a.createElement(oi,{width:"100%",justifyContent:"space-between"},s.a.createElement(ai,{name:"google-analytics",id:"google-analytics",type:"text",mt:"4px",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"GA-XXXXXX",value:l,onChange:function(t){c(t.currentTarget.value.trim())},onBlur:function(){l!==e&&(o({ga_id:l}),l&&h.d.sendEvent(h.b.SetProjectGA))},_css2:d.Ub.gray,_css3:d.Ub.gray}),s.a.createElement(ee,{text:"Set a Google Analytics ID to send data to your GA account",href:"https://help.readymag.com/hc/en-us/articles/360020844511-Google-Analytics",width:194,boxPosition:{ml:"-169px"},arrowPosition:{left:"auto",right:-3}}))),s.a.createElement(d.m,{width:"100%",mt:"4px"},s.a.createElement(ri,{htmlFor:"google-tag-manager",_css4:Object(Et.themeGet)("textStyles.small")},"Google Tag Manager"),s.a.createElement(si,{width:"100%",justifyContent:"space-between"},s.a.createElement(li,{name:"google-tag-manager",id:"google-tag-manager",type:"text",mt:"4px",spellCheck:!1,autoComplete:"off",autoCorrect:"off",placeholder:"GTM-XXXXXX",value:p,onChange:function(t){n&&m(t.currentTarget.value.trim())},onBlur:function(){p!==i&&n&&(o({gtm_id:p}),p&&h.d.sendEvent(h.b.SetProjectGTM))},disabled:!n,_css5:d.Ub.gray,_css6:d.Ub.gray}),s.a.createElement(ee,{text:"Set a Google Tag Manager ID",href:"https://help.readymag.com/hc/en-us/articles/360025544812-Google-Tag-Manager",width:194,boxPosition:{ml:"-169px"},arrowPosition:{left:"auto",right:-3},whiteSpace:"nowrap"}))))};function di(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return hi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return hi(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ui,pi=function(){var t=Object(r.useContext)(rd),e=Object(r.useMemo)((function(){return!!t.project.domain}),[t.project.domain]),i=Object(r.useMemo)((function(){return!!t.project.user.permissions.can_map_domain}),[t.project.user.permissions.can_map_domain]),n=Object(r.useMemo)((function(){return t.project.is_published}),[t.project.is_published]),o=di(Object(r.useState)(!1),2),a=o[0],l=o[1],c=di(Object(r.useState)(!1),2),h=c[0],u=c[1],p=di(Object(r.useState)(!1),2),m=p[0],g=p[1];return s.a.createElement(s.a.Fragment,null,n?i?e?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.B,{"aria-labelledby":"mapping-status","data-status":"mapped",display:"none"}),s.a.createElement(Ke,null)):s.a.createElement(s.a.Fragment,null,s.a.createElement(d.B,{"aria-labelledby":"mapping-status","data-status":"not-mapped",display:"none"}),s.a.createElement(Le,null),s.a.createElement(ti,null)):s.a.createElement(Gt,{m:"0 0 14px"},t.isOwner?s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Please"," ",s.a.createElement(d.ub,{href:"/settings#change-plan",target:"_blank",textStyle:"small",isActive:!0,onClick:je},"upgrade")," ","to access custom domain mapping.",s.a.createElement("br",null),s.a.createElement(d.ub,{href:"".concat(D.a.readymag_host,"/pricing/"),target:"_blank",textStyle:"small",isActive:!0},"See the pricing")):s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"To access custom domain mapping project owner should upgrade.",s.a.createElement("br",null),s.a.createElement(d.ub,{href:"mailto:".concat(t.project.user.email),textStyle:"small",isActive:!0},"Contact the owner"))):s.a.createElement(Gt,{m:"0 0 14px"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"You can","'","t map a domain to an unpublished project.",s.a.createElement("br",null),"Please, publish your project first.")),i&&s.a.createElement(ci,{ga:t.project.opts.ga_id,gtm:t.project.opts.gtm_id,canUseGtm:!!t.project.user.permissions.can_use_gtm,saveProjectOptions:t.setProjectOptions}),t.project.domain&&i&&n&&s.a.createElement(Gt,{m:"4px 0 14px"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"If you don’t see your project or Readymag page when you visit"," ",s.a.createElement(d.ub,{href:"//".concat(t.project.domain),target:"_blank",textStyle:"small",isActive:!0},"your website"),", the DNS record might need more time to update. This can take up to 72 hours.")),t.project.domain&&(!i||!n)&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Gt,{m:"4px 0 14px"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"The name ",t.project.domain," is already being used in this project.",s.a.createElement("br",null),s.a.createElement(d.ub,{textStyle:"small",isActive:!0,onClick:function(){h||(u(!0),t.unmapDomain().catch((function(){g(!0)})).finally((function(){u(!1),a&&l(!1)})))}},h?"Unmaping...":"Unmap"))),m&&s.a.createElement(Gt,{m:"0 0 14px"},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Something went wrong.",s.a.createElement("br",null),"Please try again later."))),s.a.createElement(d.B,{width:"100%",mt:"4px",justifyContent:"flex-start"},s.a.createElement(d.ub,{href:"https://help.readymag.com/hc/en-us/articles/360020588592-Domain",target:"_blank",textStyle:"small",color:"darkGray"},"Need help?")))},mi=i("saLn"),gi=Object(a.e)(d.Cb).withConfig({displayName:"ScaleSwitch___StyledText"})(["white-space:nowrap;"]),fi=function(t){var e=t.checked,i=t.maxWidth,n=t.onChange,o=t.onMaxWidthChange,a=t.m;return s.a.createElement(d.B,{width:216,height:104,p:16,borderRadius:52,alignItems:"center",bg:e?"green":"gray",cursor:"pointer",onClick:function(){return n(!e)},m:a},s.a.createElement(d.Pb,{as:"input",type:"checkbox",checked:e,onChange:function(){return n(e)}}),e?s.a.createElement(gi,{as:"label",color:"white",textStyle:"small",lineHeight:"32px",height:32,cursor:"text",userSelect:"none",onClick:function(t){return t.stopPropagation()}},"Scale layout up to ",s.a.createElement(d.m,{display:"inline-block"},s.a.createElement(d.Y,{min:1024,max:9999,autoWidth:!0,color:"orange",textStyle:"small",positive:!0,p:0,value:i,onChange:function(t){return o(t)}})),"px"):s.a.createElement(d.Cb,{color:"white",textStyle:"small",userSelect:"none"},"Scale layout"))};function vi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return bi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return bi(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.Vertical="vertical",t.Horizontal="horizontal"}(ui||(ui={}));var yi=Object(a.e)(d.m).withConfig({displayName:"DirectionSwitch___StyledBox"})(["transform:translateX(",");transition:transform 0.2s ease-in-out;"],(function(t){return t._css})),_i=function(t){var e=t.direction,i=t.onChange,n=t.m,o=vi(Object(r.useState)(e!==ui.Horizontal),2),a=o[0],l=o[1];return s.a.createElement(d.B,{position:"relative",width:216,height:104,bg:"gray",borderRadius:52,justifyContent:"space-between",cursor:"pointer",m:n,onClick:function(){l(!a),i(a?ui.Horizontal:ui.Vertical)}},s.a.createElement(d.Pb,{as:"select",value:e,onChange:function(t){i(t.currentTarget&&t.currentTarget.value===ui.Horizontal?ui.Horizontal:ui.Vertical)}}),s.a.createElement(yi,{position:"absolute",width:104,height:104,borderRadius:52,p:16,bg:"green",_css:a?"0px":"112px"}),s.a.createElement(d.B,{position:"absolute",left:0,alignItems:"center",width:104,height:104,borderRadius:52,p:16},s.a.createElement(d.Cb,{textStyle:"small",color:"white",userSelect:"none"},"Vertical")),s.a.createElement(d.B,{position:"absolute",right:0,alignItems:"center",width:104,height:104,borderRadius:52,p:16},s.a.createElement(d.Cb,{textStyle:"small",color:"white",display:"block",userSelect:"none"},"Horizontal")))},wi=Object(a.e)(d.m).withConfig({displayName:"ArrowSwitch___StyledBox"})(["transform:rotate(45deg);"]),ki=Object(a.e)(d.m).withConfig({displayName:"ArrowSwitch___StyledBox2"})(["transform:rotate(45deg);"]),Si=function(t){var e=t.arrowsOn,i=t.slideIn,n=t.slideInRequiresArrows,o=t.arrowsDisabled,a=t.onArrowsChange,r=t.onSlideInChange,l=t.m,c=n&&!e;return s.a.createElement(d.B,{position:"relative",width:216,height:104,alignItems:"center",justifyContent:"space-between",m:l},s.a.createElement(d.Pb,{as:"input",type:"checkbox",checked:e,onChange:function(){return a(!e)}}),s.a.createElement(d.Pb,{as:"input",type:"checkbox",checked:i,onChange:function(){return r(!i)}}),s.a.createElement(d.m,{position:"absolute",width:110,height:104,left:0,right:0,m:"auto",bg:i?"green":"gray",cursor:c?"auto":"pointer",onClick:function(){return!c&&r(!i)},opacity:c?0:i?.7:1},s.a.createElement(wi,{position:"absolute",right:-46,top:0,bottom:0,m:"auto",width:90,height:90,borderRadius:28,bg:"inherit"}),s.a.createElement(d.B,{position:"absolute",left:59,width:104,height:104,p:16,alignItems:"center"},s.a.createElement(d.Cb,{color:"white",textStyle:"small"},"Slide-in",s.a.createElement("br",null),"transition"))),s.a.createElement(d.B,{position:"relative",width:104,height:104,p:16,alignItems:"center",cursor:o?"auto":"pointer",onClick:function(t){t.stopPropagation(),a(!e)}},s.a.createElement(ki,{position:"absolute",left:8,width:90,height:90,borderRadius:28,bg:o?"lightGray":void 0},s.a.createElement(d.m,{width:"100%",height:"100%",borderRadius:28,position:"absolute",bg:e?"green":"gray",opacity:o?.5:1})),s.a.createElement(d.Cb,{position:"relative",color:"white",textStyle:"small",userSelect:"none"},"Navigation",s.a.createElement("br",null),"arrows")))};function xi(){return(xi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Ci(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||ji(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oi(t){return function(t){if(Array.isArray(t))return Pi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||ji(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ji(t,e){if(t){if("string"==typeof t)return Pi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Pi(t,e):void 0}}function Pi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ei(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ii(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ei(Object(i),!0).forEach((function(e){Ti(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ei(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Ti(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Mi=Object(a.e)(ee).withConfig({displayName:"ViewerPanel__OptionHelptip"})([""]),$i=Object(a.e)(d.Cb).withConfig({displayName:"ViewerPanel__OptionText"})([""]),Ai=Object(a.e)(d.B).withConfig({displayName:"ViewerPanel__OptionRow"})(["justify-content:space-between;align-items:center;","{flex:1;}","{opacity:0;}&:hover{","{opacity:1;}}"],$i,Mi,Mi),Ri=function(t){var e=t.m,i=t.width,n=Object(r.useContext)(rd),o=n.project.user.permissions.viewer_opts_overrides||{},a=Ii(Ii(Ii(Ii({},n.project.opts),o),n.project.is_private&&{sharebutton:!1}),!n.project.opts.menubutton&&{projectinfo:!1}),l=[].concat(Oi(Object.keys(o)),Oi(a.menubutton?[]:["projectinfo"]),Oi(n.project.is_private?["sharebutton"]:[])),c=Object.keys(o).includes("arrows"),u=Ci(Object(r.useState)(a.scalewidth),2),p=u[0],m=u[1],g=Object(mi.a)((function(t){return n.setProjectOptions({scalewidth:t})}),500).callback,f={width:194,boxPosition:{ml:"-125px"},arrowPosition:{left:"auto",right:41}};return s.a.createElement(d.m,{m:e,width:i},s.a.createElement(fi,{checked:a.scalableviewer,maxWidth:p,onChange:function(t){return n.setProjectOptions({scalableviewer:t})},onMaxWidthChange:function(t){m(t),g(t)},m:"6px 0 8px 0"}),s.a.createElement(_i,{direction:a.viewertype,onChange:function(t){return n.setProjectOptions({viewertype:t})},m:"8px 0"}),s.a.createElement(Si,{arrowsOn:a.arrows,slideIn:a.slidein,slideInRequiresArrows:a.viewertype===ui.Horizontal,arrowsDisabled:l.includes("arrows"),onArrowsChange:function(t){return n.setProjectOptions({arrows:t})},onSlideInChange:function(t){return n.setProjectOptions({slidein:t})},m:"8px 0"}),s.a.createElement(d.m,{m:"16px"},c&&s.a.createElement(Gt,{m:"16px 0",p:"12px 16px"},s.a.createElement(d.Cb,{textStyle:"small"},"Please"," ",s.a.createElement(d.ub,{href:"/settings#change-plan",target:"_blank",textStyle:"small",isActive:!0},"upgrade")," ","your account to manage the white label settings.")),s.a.createElement(Ai,{my:"4px"},s.a.createElement($i,{textStyle:"small",opacity:l.includes("menubutton")?.4:1},"Project menu"),s.a.createElement(Mi,xi({},f,{mr:"4px",text:a.controlsontop?"Show the menu button in the top right corner of a page":"Show the menu button in the bottom right corner of a page",href:"https://help.readymag.com/hc/en-us/articles/360020588752-Viewer-navigation"})),s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.menubutton,disabled:l.includes("menubutton"),onChange:function(t){return n.setProjectOptions({menubutton:t})}})),s.a.createElement(Ai,{my:"4px"},s.a.createElement($i,{textStyle:"small",opacity:l.includes("projectinfo")?.4:1},"Project info"),s.a.createElement(Mi,xi({},f,{mr:"4px",text:"Display the title and the description of your project within the project menu"})),s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.projectinfo,disabled:l.includes("projectinfo"),onChange:function(t){return n.setProjectOptions({projectinfo:t})}})),s.a.createElement(Ai,{my:"4px"},s.a.createElement($i,{textStyle:"small",opacity:l.includes("sharebutton")?.4:1},"Share button"),s.a.createElement(Mi,xi({},f,{mr:"4px",text:"Show the share button to the user"})),s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.sharebutton,disabled:l.includes("sharebutton"),onChange:function(t){return n.setProjectOptions({sharebutton:t})}})),s.a.createElement(Ai,{my:"4px"},s.a.createElement($i,{textStyle:"small",opacity:l.includes("pagecounter")?.4:1},"Page counter"),s.a.createElement(Mi,xi({},f,{mr:"4px",text:"Show a number of a current page to the user"})),s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.pagecounter,disabled:l.includes("pagecounter"),onChange:function(t){return n.setProjectOptions({pagecounter:t})}})),s.a.createElement(Ai,{my:"4px"},s.a.createElement($i,{textStyle:"small",opacity:l.includes("controlsontop")?.4:1},"Buttons on top"),s.a.createElement(Mi,xi({},f,{mr:"4px",text:"Keep Project menu, Project info, Share button, and Page counter at the top of the screen"})),s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.controlsontop,disabled:l.includes("controlsontop"),onChange:function(t){return n.setProjectOptions({controlsontop:t})}})),s.a.createElement(Ai,{my:16},s.a.createElement($i,{textStyle:"small",opacity:l.includes("lqip")?.4:1},"Progressive images"),s.a.createElement(Mi,xi({},f,{mr:"4px",text:"Use blurred image previews while loading",href:"https://help.readymag.com/hc/en-us/articles/360019989052-Picture"})),s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.lqip,disabled:l.includes("lqip"),onChange:function(t){return n.setProjectOptions({lqip:t})}})),s.a.createElement(Ai,{my:16},s.a.createElement($i,{textStyle:"small",opacity:l.includes("endpage")?.4:1},"Readymag branding"),l.includes("endpage")?s.a.createElement(ee,xi({},f,{boxPosition:{ml:"-169px"},arrowPosition:{left:"auto",right:-3},p:"12px 15px",text:"Upgrade to disable branding",href:"/settings#change-plan",onClick:function(){h.d.sendEvent(h.b.BrandingAlertUpgrade)}})):s.a.createElement(d.zb,{backgroundChecked:"green",checked:a.endpage,onChange:function(t){return n.setProjectOptions({endpage:t})}})),s.a.createElement(d.B,{width:"100%",justifyContent:"flex-start"},s.a.createElement(d.ub,{href:"https://help.readymag.com/hc/en-us/articles/360020588752-Viewer-navigation",target:"_blank",textStyle:"small",color:"darkGray"},"Need help?"))))},Di=Object(a.e)(d.B).withConfig({displayName:"ProjectSettings___StyledFlex"})(["display:",";"],(function(t){return t._css})),Bi=Object(a.e)(d.B).withConfig({displayName:"ProjectSettings___StyledFlex2"})(["user-select:none;&:hover{& span{color:",";}}"],(function(t){return t._css2})),Li=Object(a.e)(d.B).withConfig({displayName:"ProjectSettings___StyledFlex3"})(["user-select:none;&:hover{& span{color:",";}}"],(function(t){return t._css3})),zi=Object(a.e)(d.B).withConfig({displayName:"ProjectSettings___StyledFlex4"})(["user-select:none;&:hover{& span{color:",";}}"],(function(t){return t._css4})),Fi=Object(a.e)(d.B).withConfig({displayName:"ProjectSettings___StyledFlex5"})(["user-select:none;&:hover{& span{color:",";}}"],(function(t){return t._css5})),Ui=function(){var t=Object(r.useContext)(rd),e=Object(r.useContext)(k),i=z(t.project),n=Object(r.useMemo)((function(){return t.hasProjectCode()}),[t.project.ci_head,t.project.ci_css,t.project.ci_body_top,t.project.ci_body_bottom]),a=function(){return t.openCodeEditor()};return s.a.createElement(Di,{id:"constructor-project-settings",flexDirection:"column",width:J,height:"100%",pt:"16px",position:"relative",zIndex:1,_css:e.isProjectSettingsOpened?"flex":"none"},s.a.createElement(d.B,{justifyContent:"space-between",p:"0 24px",position:"relative",zIndex:1},s.a.createElement(d.Cb,{textStyle:"small",color:i===C.UnpublishedChanges?"tomato":"darkGray"},B(t.project)),s.a.createElement(d.n,{textStyle:"small",color:"darkGray",onClick:function(){return e.dispatch({type:o.ToggleHelpPanel,open:!0})}},"Help")),s.a.createElement(d.B,{width:J,height:"calc(100% - 100px)",mt:"-4px"},s.a.createElement(d.a,{springConfig:{mass:1,tension:210,friction:20,clamp:!0}},s.a.createElement(d.r,{renderButton:function(t){var e=t.isActive;return(s.a.createElement(Bi,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer","aria-labelledby":"project-settings-general",_css2:e?d.Ub.black:d.Ub.tomato},s.a.createElement(d.Cb,{color:"black",textStyle:"subheading"},"Project settings")))},open:!0},(function(t,e){return s.a.createElement(d.m,{ref:t,width:J,px:24,pb:24},s.a.createElement(we,{isActive:e}))})),s.a.createElement(d.r,{renderButton:function(t){var e=t.isActive;return(s.a.createElement(Li,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer","aria-labelledby":"project-settings-viewer",_css3:e?d.Ub.black:d.Ub.tomato},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),s.a.createElement(d.m,{position:"relative",bottom:"2px"},s.a.createElement(d.Cb,{color:"black",textStyle:"subheading"},"Viewer"))))}},(function(t){return s.a.createElement(d.m,{ref:t,width:J,px:24},s.a.createElement(Ri,{m:"0 0 0 -16px",width:224}))})),s.a.createElement(d.r,{renderButton:function(t){var e=t.isActive;return(s.a.createElement(zi,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer","aria-labelledby":"project-code-injection",_css4:e?d.Ub.black:d.Ub.tomato},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),s.a.createElement(d.m,{position:"relative",bottom:"2px"},s.a.createElement(d.Cb,{color:"black",textStyle:"subheading"},"Code")),n&&s.a.createElement(d.m,{width:"6px",height:"6px",borderRadius:"round",bg:"black",position:"absolute",right:24,top:21})))}},(function(e){return s.a.createElement(d.m,{ref:e,width:J,px:24},s.a.createElement(ke,{hasProjectCode:n,showUpgradeAlert:!t.me.permissions.can_inject_code,onOpenCodeEditorClick:a}))})),s.a.createElement(d.r,{renderButton:function(e){var i=e.isActive;return(s.a.createElement(Fi,{width:"100%",height:48,px:24,justifyContent:"left",alignItems:"center",cursor:"pointer","aria-labelledby":"project-settings-domain",_css5:i?d.Ub.black:d.Ub.tomato},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"gray"}),s.a.createElement(d.m,{position:"relative",bottom:"2px"},s.a.createElement(d.Cb,{color:"black",textStyle:"subheading"},"Domain")),t.project.domain&&s.a.createElement(d.m,{width:"6px",height:"6px",borderRadius:"round",bg:"black",position:"absolute",right:24,top:21})))}},(function(t){return s.a.createElement(d.m,{ref:t,width:J,px:24,pb:24},s.a.createElement(pi,null))})))),s.a.createElement(Pt,null))},Ni=i("xG9w"),Hi=i("LZwC"),Vi=i.n(Hi);function Wi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Gi(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Gi(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gi(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var qi=Object(a.e)(d.m).withConfig({displayName:"PopupBody___StyledBox"})(["background-image:url('","');background-position:center;background-size:cover;background-repeat:no-repeat;"],Vi.a),Ki=Object(a.e)(d.B).withConfig({displayName:"PopupBody___StyledFlex"})(["background-image:",";background-position:center;background-repeat:no-repeat;background-size:cover;"],(function(t){return t._css})),Yi=function(t){var e=t.onMyTemplatesClick,i=t.onRmTemplatesClick,n=t.isUserTemplatesLoading,o=t.userTemplatesScreenshot,a=Wi(Object(r.useState)(!1),2),l=a[0],c=a[1],h=Wi(Object(r.useState)(!1),2),u=h[0],p=h[1];return s.a.createElement(d.B,{flexDirection:"column",color:"white",pt:3,pl:3,pb:3},s.a.createElement(d.B,{"aria-labelledby":"show-rm-templates-modal",alignItems:"center",cursor:"pointer",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},onClick:function(t){t.preventDefault(),i()}},s.a.createElement(qi,{width:88,height:60,borderRadius:"s",bg:"grey"}),s.a.createElement(d.Cb,{textStyle:"small",ml:3,color:l?"tomato":"white"},"R/m templates")),s.a.createElement(d.B,{"aria-labelledby":"show-user-templates-modal",alignItems:"center",mt:3,cursor:"pointer",onMouseEnter:function(){return p(!0)},onMouseLeave:function(){return p(!1)},onClick:function(t){return function(t){t.preventDefault(),e()}(t)}},s.a.createElement(Ki,{width:88,height:60,borderRadius:"s",justifyContent:"center",alignItems:"center",bg:"grey",_css:o?"url(".concat(o,")"):"none"},!o&&n&&s.a.createElement(d.Q,{bgColor:"transparent"})),s.a.createElement(d.Cb,{textStyle:"small",ml:3,color:u?"tomato":"white"},"My templates")))},Xi=Object(a.e)(d.m).withConfig({displayName:"MyTemplatesModal___StyledBox"})(["overflow-y:auto;"]),Zi=s.a.memo((function(t){var e=t.isShown,i=t.width,n=t.height,o=t.isLoading,a=t.children,l=Object(r.useRef)(null);return c.a.createPortal(s.a.createElement(s.a.Fragment,null,e?s.a.createElement(Xi,{id:"my-templates-modal",ref:l,width:"".concat(i,"px"),height:"".concat(n,"px"),position:"absolute",top:"calc(50% - ".concat(n/2,"px)"),left:"calc(50% - ".concat(i/2,"px)"),zIndex:9999,borderRadius:"l",bg:"black"},o?s.a.createElement(d.B,{width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},s.a.createElement(d.Q,{bgColor:"transparent"})):a):null),document.body)}));Zi.displayName="MyTemplatesModal";var Ji=Zi,Qi=i("YqYG"),tn=i("xi34"),en=i("kwMJ"),nn=i.n(en),on=m.a.View.extend({events:{"click .scroll-wrapper.main .results .templateset":"onTemplatesetClick","click .search-icon":"toggleSearch","click .back-icon":"closeInfo","input .search-wrapper .search-string":"onSearchStringChange","keypress .search-wrapper .search-string":"onSearchStringKey","keyup .search-wrapper .search-string":"onSearchStringKey","keydown .search-wrapper .search-string":"onSearchStringKey","click .search-wrapper .clear":"onClearSearchString","click .category-switcher .category-item":"filterItemClick","click .sort-switcher .sort-item":"filterItemClick","click .template:not(.added)":"onAddPageClick","click .right-panel .add-pages:not(.added)":"onAddMultimpleClick"},CATEGORIES:{microsites:"Microsites",presentations:"Presentations",photo_stories:"Photo Stories",longreads:"Longreads",sandbox:"Sandbox"},VIEWPORTS:{tablet_portrait:"Tablet Portrait",phone_portrait:"Phone Portrait"},initialize:function(t){u.a.bindAll(this),this.template=nn.a["template-constructor-helpers-template-center"],this.templatesetTemplate=nn.a["template-constructor-helpers-template-center-templateset"],this.templateTemplate=nn.a["template-constructor-helpers-template-center-template"],this.templateTemplateInfo=nn.a["template-constructor-helpers-template-center-templateinfo"],this.templatePageAnimation=nn.a["template-constructor-helpers-template-center-animation"],this.router=t.router,this.showPagesAlert=t.pagesAlert,this.animateAppearance=t.animateAppearance,this.onClose=t.onClose,this.overlayDarker=!!t.overlayDarker&&!!t.overlayDarker,this.overlayTransparent=!!t.overlayTransparent&&!!t.overlayTransparent,this.showBlockLayer=void 0===t.showBlockLayer||t.showBlockLayer,this.applyFilter.__debounced=u.a.debounce(this.applyFilter,150)},render:function(){this.setElement(Object(tn.a)(this.template({})).insertAfter("#constructor")),this.setElement(this.$el),this.$mainList=this.$(".scroll-wrapper.main .results-wrapper .results"),this.$infoList=this.$(".scroll-wrapper.info .results-wrapper .results"),this.filterCategory&&this.$('.category-switcher .category-item[data-category="'+this.filterCategory+'"]').addClass("active").siblings().removeClass("active"),this.mainScroll=Object(tn.a)(this.$mainList.closest(".scroll-wrapper")).RMScroll({$container:this.$mainList.closest(".results-wrapper"),$content:this.$mainList,$handle:this.$mainList.closest(".scroll-wrapper").find(".scroll"),gap_start:8,gap_end:8}).data("scroll"),this.infoScroll=Object(tn.a)(this.$infoList.closest(".scroll-wrapper")).RMScroll({$container:this.$infoList.closest(".results-wrapper"),$content:this.$infoList,$handle:this.$infoList.closest(".scroll-wrapper").find(".scroll"),gap_start:8,gap_end:8}).data("scroll");var t=Object(tn.a)(this.$(".size-wrapper .slider"));this.sizeSlider=t.slider({min:1,max:7,value:4,orientation:"vertical",start:function(){Object(tn.a)("body").addClass("ns-resize-cursor"),t.addClass("dragging")},stop:function(){Object(tn.a)("body").removeClass("ns-resize-cursor"),t.removeClass("dragging")},change:this.sizeChanged,slide:this.sizeChanged}),this.loadTemplateData(),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("templatecenter")})),this.rendered=!0},loadTemplateData:function(){var t=arguments,e=this;if(!u.a.isEmpty(this.templatesets))return e.$(".overlay").remove(),e.renderTemplatesetList();tn.a.ajax({type:"GET",url:"/api/rm_templatesets/",contentType:"application/json",success:function(t){e.$(".overlay").remove(),u.a.each(t,(function(t){t.templates=u.a.sortBy(t.templates,"num")})),e.templatesets=e.filtered_templatesets=t,e.applyFilter(),e.filterCategories()},error:function(e){console.log(t)}})},filterCategories:function(){Object.keys(this.CATEGORIES).forEach(function(t){this.templatesets.some((function(e){return e.categories.includes(t)}))||this.$('.category-switcher .category-item[data-category="'+t+'"]').remove()}.bind(this))},renderTemplatesetList:function(){var t=this.$(".scroll-wrapper.main .results");t.empty().scrollTop(0),u.a.each(this.filtered_templatesets,(function(e){t.append(this.renderTemplateset(e))}),this),this.templatesetRendered=!0,u.a.defer(function(){this.mainScroll.recalc()}.bind(this))},renderTemplateset:function(t){return t.pages=t.templates.length,t.screenshot=t.templates[0].thumb,this.templatesetTemplate({data:t})},renderTemplateList:function(t){var e=this.$(".scroll-wrapper.info .results"),i=t.templates;e.empty().scrollTop(0),u.a.each(i,(function(i,n){i.idx=n+1,i.mag_num_id=t.mag_num_id,e.append(this.renderTemplate(i))}),this)},renderTemplate:function(t){var e=Object(tn.a)(this.templateTemplate({data:t})),i=e.find("img"),n=t.thumb,o=t.fullScreenshotBaseUrl?ie.default.addFilenameComponent(t.fullScreenshotBaseUrl,"256"):n;return i.one("load",function(){u.a.defer(function(){this.infoScroll.recalc()}.bind(this))}.bind(this)),i.attr("src",o),e},renderTemplateInfo:function(t){var e,i=[];u.a.each(t.categories,(function(t){i.push(this.CATEGORIES[t])}),this),t.categories_string=i.join(", "),t.VIEWPORTS=this.VIEWPORTS,this.$(".right-panel .template-info").html(this.templateTemplateInfo({data:t,Constants:D.a,_:u.a})),u.a.defer(function(){e=Object(tn.a)(this.$(".right-panel .desc-scroll-wrapper")),this.infoDescriptionScroll=e.RMScroll({$container:e.find(".desc-wrapper"),$content:e.find(".desc"),$handle:e.find(".scroll"),gap_start:4,gap_end:4}).data("scroll")}.bind(this))},applyFilter:function(){var t=tn.a.trim(this.$(".search-string").val()),e=this.$(".category-switcher .category-item.active").attr("data-category"),i=this.$(".sort-switcher .sort-item.active").attr("data-criteria");u.a.isEmpty(this.templatesets)||(this.filtered_templatesets=t?u.a.filter(this.templatesets,(function(e){return new RegExp(t,"i").test(e.title)})):this.templatesets,e&&(this.filtered_templatesets=u.a.filter(this.filtered_templatesets,(function(t){return u.a.contains(t.categories,e)}))),this.filterCategory=e,u.a.isEmpty(this.filtered_templatesets)||(this.filtered_templatesets=u.a.sortBy(this.filtered_templatesets,(function(t){return"popular"==i?-(t.usages||0):-new Date(t.created)}))),this.renderTemplatesetList())},onSearchStringKey:function(t){if(t.stopPropagation(),t.keyCode==tn.a.keycodes.esc&&t.preventDefault(),"keyup"==t.type){if(t.keyCode==tn.a.keycodes.esc)return void(""!=this.$(".search-wrapper .search-string").val()?this.clearSearchString():this.toggleSearch());t.keyCode==tn.a.keycodes.enter&&(t.preventDefault(),this.applyFilter())}},onSearchStringChange:function(){var t=this.$(".search-wrapper .search-string").val();this.$(".search-wrapper .clear").toggleClass("invisible",""==t),this.applyFilter.__debounced()},clearSearchString:function(){this.$(".search-wrapper .search-string").blur().val("").focus(),this.onSearchStringChange()},onClearSearchString:function(){this.clearSearchString(),this.toggleSearch()},toggleSearch:function(){clearTimeout(this.searchFocusTimeout),this.$(".search-icon").toggleClass("active"),this.$(".search-wrapper").toggleClass("shift-down"),this.$(".scroll-wrapper.main").toggleClass("shift-down"),this.$(".search-icon").hasClass("active")?this.searchFocusTimeout=setTimeout(u.a.bind((function(){this.$(".search-wrapper .search-string").focus()}),this),700):(this.$(".search-wrapper .search-string").val(""),this.$(".search-wrapper .clear").addClass("invisible"),ie.default.getFocusBack()),this.applyFilter()},closeInfo:function(){this.$(".template-center-wrapper").removeClass("info-mode")},onTemplatesetClick:function(t){var e=Object(tn.a)(t.currentTarget).attr("data-id");this.openInfo(e)},openInfo:function(t){var e=u.a.findWhere(this.templatesets,{_id:t});this.renderTemplateList(e),this.renderTemplateInfo(e),this.$(".template-center-wrapper").addClass("info-mode"),this.$(".template-center-wrapper").one("transitionend webkitTransitionEnd",function(){this.infoScroll.recalc()}.bind(this))},onBodyKey:function(t){this.$(".search-input").is(":focus")||(t.keyCode!=tn.a.keycodes.esc&&t.keyCode!=tn.a.keycodes.backspace||(t.preventDefault(),t.stopPropagation()),"keyup"==t.type&&(t.keyCode==tn.a.keycodes.esc&&(this.$(".font-explorer-wrapper").hasClass("info-mode")?this.closeInfo():u.a.isFunction(this.onClose)?this.onClose():this.hide()),t.keyCode==tn.a.keycodes.backspace&&(this.$(".font-explorer-wrapper").hasClass("info-mode")?this.closeInfo():u.a.isFunction(this.onClose)?this.onClose():this.hide()),t.keyCode==tn.a.keycodes.f&&this.toggleSearch()))},filterItemClick:function(t){Object(tn.a)(t.currentTarget).addClass("active").siblings().removeClass("active"),this.applyFilter()},canCreatePage:function(t){var e=this.router.me.get("permissions").pages_per_mag;return!(e&&t+this.router.mag.pages.length>e)||(this.showPagesAlert(),!1)},onAddPageClick:function(t){var e=Object(tn.a)(t.currentTarget).closest(".template"),i=e.attr("data-id"),n=e.attr("data-thumb");this.canCreatePage(1)&&(u.a.delay(function(){this.trigger("add-page",{template:i,specialScreenshot:n})}.bind(this),800),e.flashClass("added",2e3),this.animateAdd(e))},onAddMultimpleClick:function(t){var e=Object(tn.a)(t.currentTarget),i=Object(tn.a)(t.currentTarget).attr("data-id"),n=u.a.findWhere(this.templatesets,{_id:i}),o=[];n&&this.canCreatePage(n.templates.length)&&(u.a.each(n.templates,(function(t){o.push({template:t.page_id,specialScreenshot:t.thumb})})),1===o.length?this.animateAdd(this.$(".center-panel .template")):this.animateAdd(),u.a.delay(function(){this.trigger("add-multiple",{templates:o})}.bind(this),1500),e.flashClass("added",2e3))},onMouseWheel:function(t){t&&t.stopPropagation(),t&&t.preventDefault()},animateAdd:function(t){var e,i,n,o=Object(tn.a)('<div class="animation-wrapper-v"></div>'),a=Object(tn.a)('<div class="animation-wrapper-h"></div>').append(o),r=Object(tn.a)('<div class="animation-wrapper-clip"></div>').append(a),s=this.$el.offset(),l=(this.$el.width(),this.$el.height());if(t)e=t.find(".template-image-wrapper"),i=e.clone().detach().addClass("clipped"),(n=e.offset()).top<s.top&&(n.top=s.top+20),i.css({margin:0}),o.append(i),u.a.defer((function(){a.css({position:"fixed"}),a.addClass("animation-page-flyout-x"),o.addClass("animation-page-flyout-y")}));else{n={left:Object(tn.a)(".center-panel .template").offset().left,top:s.top+l/2-87};var c=[];r.css({overflow:"hidden"}),u.a.each(Object(tn.a)(".center-panel .template"),(function(t){var e=Object(tn.a)(t).find(".template-image-wrapper");(i=e.clone().detach().addClass("clipped stacking")).css({margin:0}),o.prepend(i);i.offset().top,n.top;ie.default.applyTransform(i,"translateY("+(e.offset().top-n.top)+"px)"),c.push(i)})),u.a.delay((function(){u.a.each(c,(function(t,e){ie.default.applyTransform(t,"translateY("+5*e+"px)translateX(-"+5*e+"px)")}))}),100),u.a.delay((function(){r.css({overflow:"visible"}),a.addClass("animation-page-flyout-x"),o.addClass("animation-page-flyout-y")}),700)}Object(tn.a)("head").append(Object(tn.a)(this.templatePageAnimation({top1:(s.top-n.top)/2,top2:s.top-n.top-130,top3:s.top-n.top-70}))),a.css({left:n.left,top:n.top}),r.css({top:s.top,height:l}),Object(tn.a)("body").append(r),u.a.delay((function(){r.remove(),Object(tn.a)("#template-center-page-animation").remove()}),1500)},disableMouseWheel:function(){window.document.addEventListener("mousewheel",this.onMouseWheel,{passive:!1})},enableMouseWheel:function(){window.document.removeEventListener("mousewheel",this.onMouseWheel)},show:function(){this.render(),this.disableMouseWheel(),this.showBlockLayer&&(this.$block_layer=RM.constructorRouter.showBlockLayer(u.a.isFunction(this.onClose)?this.onClose:this.hide,{darker:this.overlayDarker,transparent:this.overlayTransparent})),this.animateAppearance?(this.$el.removeClass("show-out").addClass("show-in").css("display","block"),setTimeout(u.a.bind((function(){this.$el.removeClass("show-in")}),this),20),setTimeout(u.a.bind((function(){this.$el.css("width","+=1")}),this),300),setTimeout(u.a.bind((function(){this.$el.css("width","-=1")}),this),300)):this.$el.removeClass("show-out").css("display","block"),Object(tn.a)("body").on("keypress keyup keydown",this.onBodyKey),this.shown=!0},hide:function(t){t&&t.stopPropagation(),this.enableMouseWheel(),this.showBlockLayer&&RM.constructorRouter.hideBlockLayer(this.$block_layer),Object(tn.a)("body").off("keypress keyup keydown",this.onBodyKey),this.animateAppearance?(this.$el.addClass("show-out"),setTimeout(u.a.bind((function(){this.remove()}),this),200)):(this.$el.css("display","none"),this.remove()),ie.default.getFocusBack(),this.$(".language-wrapper").removeClass("active"),this.shown=!1},toggle:function(){this.shown?this.hide():this.show(),this.trigger("toggle")}});function an(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return rn(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return rn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var sn=function(t){var e=t.isShown,i=t.addPageFromTemplate,n=Object(r.useContext)(rd),o=an(Object(r.useState)(null),2),a=o[0],l=o[1],c=function(){a&&a.remove();var t=new Qi.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"page from rm template"});t.render(),l(t)},d=an(Object(r.useState)(null),2),h=d[0],u=d[1],p=Object(r.useRef)(!1),m=function(t){i(t)},g=function(t){if(t.templates&&t.templates.length&&!p.current){var e=0;p.current=!0,function o(){i(t.templates[e++],n.currentPageNum+e).then((function(){e!==t.templates.length?o():p.current=!1})).catch((function(){p.current=!1}))}()}};return Object(r.useEffect)((function(){var t=new on({router:window.RM.constructorRouter,pagesAlert:c,showBlockLayer:!1});t.on("add-page",m),t.on("add-multiple",g),u(t)}),[]),Object(r.useEffect)((function(){h&&(h.off("add-page"),h.off("add-multiple"),h.on("add-page",m),h.on("add-multiple",g))}),[n.currentPageNum,n.pagesParams]),Object(r.useEffect)((function(){h&&(e?h.show():h.hide())}),[e]),s.a.createElement(s.a.Fragment,null)};function ln(t){return function(t){if(Array.isArray(t))return hn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||dn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||dn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(t,e){if(t){if("string"==typeof t)return hn(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?hn(t,e):void 0}}function hn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var un,pn=Object(a.e)(d.B).withConfig({displayName:"MyTemplatesModalBody___StyledFlex"})(["overflow-y:auto;"]),mn=Object(a.e)(d.B).withConfig({displayName:"MyTemplatesModalBody___StyledFlex2"})(["align-content:flex-start;"]),gn=Object(a.e)(d.m).withConfig({displayName:"MyTemplatesModalBody___StyledBox"})(["white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"]),fn=Object(a.e)(d.B).withConfig({displayName:"MyTemplatesModalBody___StyledFlex3"})(["background-image:",";background-position:center center;background-repeat:no-repeat;background-size:cover;&:hover{.delete-template-button{opacity:1;}}"],(function(t){return t._css})),vn=Object(a.e)(d.ib).withConfig({displayName:"MyTemplatesModalBody___StyledRoundButton"})(["position:absolute;top:8px;right:8px;opacity:0;transition:opacity 0.15s ease;"]),bn=Object(a.e)(d.H).withConfig({displayName:"MyTemplatesModalBody___StyledInlineInput"})(["&:focus{border-bottom:none;}"]),yn=function(t){var e=t.templates,i=t.newTemplateTitle,n=t.createNewUserTemplate,o=t.addPageFromTemplate,a=t.deleteUserTemplate,l=cn(Object(r.useState)(!1),2),c=l[0],h=l[1],u=cn(Object(r.useState)([]),2),p=u[0],m=u[1],g=cn(Object(r.useState)(!1),2),f=g[0],v=g[1],b=cn(Object(r.useState)(!1),2),y=b[0],_=b[1],w=cn(Object(r.useState)(!1),2),k=w[0],S=w[1],x=function(t){if(t.preventDefault(),t.stopPropagation(),!c){var e="pending-".concat(Date.now());h(!0),m([{id:e,pending:!0,thumb:""}].concat(ln(p))),n().then((function(){h(!1)})).catch((function(){h(!1)})).finally((function(){m(p.filter((function(t){return t.id!==e})))}))}},C=Object(r.useCallback)((function(t){13===t.keyCode&&(t.preventDefault(),t.target.blur())}),[]),O=Object(r.useCallback)((function(t,e){return e&&Object(nt.D)(t,e)}),[]);return s.a.createElement(pn,{width:"100%",height:"100%",borderRadius:"l"},s.a.createElement(d.jb,null,(function(t){var n=t.ref;return(s.a.createElement(mn,{ref:n,width:"100%",height:"100%",py:"24px",px:"68px",flexWrap:"wrap"},s.a.createElement(d.B,{cursor:"pointer",flexDirection:"column",onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)}},s.a.createElement(d.B,{width:216,height:141,mx:"12px",position:"relative",justifyContent:"center",alignItems:"center",bg:"darkGray",borderRadius:"s",cursor:"pointer",onClick:x},s.a.createElement(d.db,{color:f?"white":"black"})),s.a.createElement(gn,{width:216,mx:"12px",mb:"8px",mt:"6px",p:"0 0 10px 0",color:f?"white":"darkGray"},s.a.createElement(d.Cb,{textStyle:"small",textAlign:"center",color:f?"white":"darkGray"},i))),[].concat(ln(p),ln(e)).map((function(t){return s.a.createElement(d.B,{flexDirection:"column",key:t.id},s.a.createElement(fn,{key:t.id,width:216,height:141,mx:"12px",position:"relative",bg:"darkGray",borderRadius:"s",justifyContent:"center",alignItems:"center",cursor:"pointer",onClick:function(e){return!t.pending&&function(t,e,i){t.preventDefault(),t.stopPropagation(),o({template:e,custom:!0,specialScreenshot:i})}(e,t.id,t.thumb)},_css:t.thumb?"url(".concat(t.thumb,")"):"none"},t.pending&&s.a.createElement(d.Q,{bgColor:"transparent"}),!t.pending&&s.a.createElement(vn,{size:32,className:"delete-template-button",color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onMouseEnter:function(){return _(t.id)},onMouseLeave:function(){k&&S(!1),_(!1)},onMouseDown:function(){return S(t.id)},onMouseUp:function(){return S(!1)},onClick:function(e){return function(t,e){t.preventDefault(),t.stopPropagation(),a(e)}(e,t.id)}},s.a.createElement(d.w,{color:k&&k===t.id?"white":y&&y===t.id?"tomato":"black"}))),s.a.createElement(bn,{mx:"12px",mb:"8px",mt:"6px",p:"0 0 10px 0",width:"auto",type:"text",textStyle:"small",color:"white",spellCheck:!1,placeholder:"Template title",defaultValue:t.title,disabled:t.pending,onBlur:function(e){return O(t.id,e.target.value)},onKeyDown:C,textAlign:"center"}))}))))})))};function _n(){return(_n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function wn(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}!function(t){t.Top="top",t.Right="right",t.Bottom="bottom",t.Left="left"}(un||(un={}));var kn=Object(a.e)(d.m).withConfig({displayName:"Popup___StyledBox"})(["transform:",";transition:0.3s transform ease;"],(function(t){return t._css})),Sn=Object(a.e)(d.B).withConfig({displayName:"Popup___StyledFlex"})(["",""],(function(t){return t._css2})),xn=Object(r.forwardRef)((function(t,e){var i=t.isShown,n=t.position,o=void 0===n?"absolute":n,a=t.zIndex,l=void 0===a?8e3:a,h=t.transform,u=t.placement,p=t.rootElement,m=t.children,g=wn(t,["isShown","position","zIndex","transform","placement","rootElement","children"]);if(!i)return null;var f=Object(r.useMemo)((function(){var t="";switch(u){case un.Bottom:t="bottom: -8px; left: 20px;";break;case un.Right:t="bottom: calc(50% - 4px); right: -12px; transform: rotate(-90deg);"}return t}),[u]);return(c.a.createPortal(s.a.createElement(kn,_n({ref:e,position:o,zIndex:l,borderRadius:"s",bg:Object(V.e)(.08,d.Ub.black)},g,{_css:h||"none"}),m,u&&s.a.createElement(Sn,{height:8,width:16,position:"absolute",color:Object(V.e)(.08,d.Ub.black),_css2:f},s.a.createElement(d.ob,null))),p||document.body))}));xn.displayName="Popup";var Cn=xn;function On(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return jn(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return jn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Pn=s.a.memo((function(t){var e=t.isTrashOpened,i=t.isSettingsOpened,n=Object(r.useContext)(k),a=Object(r.useContext)(rd),l=On(Object(r.useState)(!1),2),c=l[0],h=l[1],u=On(Object(r.useState)(!1),2),p=u[0],m=u[1],g=Object(d.Xb)({watchingClick:c,callback:function(){h(!1)}});Object(r.useEffect)((function(){i&&c&&(m(!0),a.getUserTemplates().then((function(){m(!1)})).catch((function(t){m(!1),t&&console.warn(t.message)})))}),[i,c]);var f=Object(r.useMemo)((function(){var t=a.pages.find((function(t){return t._id===a.currentPageId}));return t&&t.title?t.title:"page ".concat(a.currentPageNum)}),[a.currentPageNum]),v=function(t,e){return a.addNewPage(e||a.currentPageNum,t)};return s.a.createElement(s.a.Fragment,null,s.a.createElement(d.n,{"aria-labelledby":"toggle-templates-popup",color:c?"tomato":"darkGray",textStyle:"small",onClick:function(t){t.preventDefault(),h(!c)}},"Add"),s.a.createElement(Cn,{ref:g,width:224,height:168,right:"8px",bottom:84,position:"fixed",isShown:c,transform:e?"translateX(-240px)":"translateX(0px)",placement:un.Bottom,rootElement:document.querySelector("#settings-container")},s.a.createElement(Yi,{onRmTemplatesClick:function(){h(!1),n.dispatch({type:o.ToggleRmTemplatesModal})},onMyTemplatesClick:function(){h(!1),n.dispatch({type:o.ToggleUserTemplatesModal})},isUserTemplatesLoading:p,userTemplatesScreenshot:a.userTemplates.length?a.userTemplates[0].thumb:void 0})),s.a.createElement(Ji,{width:880,height:576,isShown:n.isUserTemplatesModalShown,isLoading:p},s.a.createElement(yn,{templates:a.userTemplates,newTemplateTitle:"Create template from ".concat(f),createNewUserTemplate:a.createTemplateFromCurrentPage,addPageFromTemplate:v,deleteUserTemplate:a.deleteUserTemplate})),s.a.createElement(sn,{isShown:n.isRmTemplatesModalShown,addPageFromTemplate:v}))}));Pn.displayName="AddFromTemplatesButton";var En=Pn;function In(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Tn(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Tn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Mn=Object(a.e)(d.m).withConfig({displayName:"SettingsFooter___StyledBox"})(["animation:1.5s blinkAnimation infinite linear;@keyframes blinkAnimation{from{opacity:1;}33%{opacity:1;}34%{opacity:0.8;}40%{opacity:0;}60%{opacity:0;}66%{opacity:0.8;}67%{opacity:1;}to{opacity:1;}}"]),$n=function(){var t=Object(r.useContext)(k),e=Object(r.useContext)(rd),i=In(Object(r.useState)(null),2),n=i[0],a=i[1];return s.a.createElement(d.B,{width:"100%",height:95,minHeight:95,px:24,position:"relative",justifyContent:"space-between",alignItems:"center"},s.a.createElement(d.m,{position:"relative",bottom:"4px"},s.a.createElement(En,{isTrashOpened:t.isTrashOpened,isSettingsOpened:t.isSettingsOpened})),s.a.createElement(d.n,{position:"relative",bottom:"3px",left:"7px"},s.a.createElement(d.db,{"aria-labelledby":"add-blank-page",onClick:function(i){i.preventDefault(),t.dispatch({type:o.SetAddingPage,inProgress:!0}),e.addNewPage(e.currentPageNum).finally((function(){t.dispatch({type:o.SetAddingPage,inProgress:!1})})).catch((function(t){t&&"permission_denied"===t.err&&function(){n&&n.remove();var t=new Qi.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:e.project.user?e.project.user.email:""},alert_source:"blank page"});t.render(),a(t)}()}))}})),e.project.has_deleted_pages||t.isTrashOpened?s.a.createElement(d.B,{width:36,position:"relative",justifyContent:"flex-end"},e.pageRecentlyDeleted&&s.a.createElement(Mn,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",top:"2px",left:t.isTrashOpened?"-4px":"10px"}),s.a.createElement(d.n,{"aria-labelledby":"toggle-pages-bin",color:t.isTrashOpened?"tomato":"darkGray",textStyle:"small",position:"relative",bottom:"3px",onClick:function(i){i.preventDefault(),(e.project.has_deleted_pages||t.isTrashOpened)&&t.dispatch({type:o.ToggleTrash})}},t.isTrashOpened?"Close":"Bin")):s.a.createElement(d.B,{width:36}))};function An(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Rn(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?An(Object(i),!0).forEach((function(e){Dn(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):An(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Dn(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Bn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ln(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ln(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var zn=s.a.createContext({}),Fn=s.a.createContext({}),Un="undefined"!=typeof window&&(window.requestAnimationFrame||window.setImmediate)||function(t){return setTimeout(t,0)},Nn=function(t){var e=t.onBeforeDragStart,i=t.onDragStart,n=t.children,o=t.idList,a=t.isDragOff,l=t.onDragEnd,c=t.onAfterDragEnd,d=t.unionOn,h=Bn(Object(r.useState)({startX:0,startY:0,refList:{},dropableList:{},originalDropable:"",draggableRef:null,origDropableRef:null,origDragableIdx:0,draggableId:"",flatList:[],excluded:[]}),2),u=h[0],p=h[1],m=Object(r.useRef)([]),g=Bn(Object(r.useState)({isDragOff:Boolean(a)}),2),f=g[0],v=g[1],b=d?.8:.5,y=(u.startX,u.startY),_=u.refList,w=u.dropableList,k=u.originalDropable,S=u.draggableRef,x=u.origDropableRef,C=u.origDragableIdx,O=u.draggableId,j=u.flatList,P=u.excluded,E=Object(r.useRef)(!1),I=Bn(Object(r.useState)(!1),2),T=I[0],M=I[1],$=Object(r.useRef)(!1),A=Object(r.useRef)(!1),R=function(t){$.current=t,M(t)},D=Object(r.useRef)(!1),B=Object(r.useRef)(0),L=Object(r.useRef)(0),z=Object(r.useRef)(0),F=Object(r.useRef)(0),U=Object(r.useRef)(0),N=Object(r.useRef)(0),H=Object(r.useRef)(""),V=Object(r.useRef)(null),W=Object(r.useRef)(void 0),G=Object(r.useRef)(void 0),q=Object(r.useRef)(50),K=Object(r.useRef)(0),Y=Object(r.useRef)(0),X=Object(r.useRef)(0),Z=Object(r.useRef)(0),J=Object(r.useRef)(0),Q=Bn(Object(r.useState)(""),2),tt=Q[0],et=Q[1],it=Object(r.useRef)(""),nt=function(t){it.current=t,et(t)},ot=Bn(Object(r.useState)(""),2),at=ot[0],rt=ot[1],st=Object(r.useRef)(""),lt=function(t){st.current=t,rt(t)},ct={pushDraggableRef:function(t,e){_[t]=e,e.current&&(e.current.className+=" sortable-item")},pushDropableRef:function(t,e,i){w[e]={ref:t,parentId:i,deltaSize:0},t.current&&(t.current.className+=" sortable-dropable")},setDraggable:function(t,i,n,a,r,s){if(!u.draggableId&&t&&n&&n.current){var l=e?e(t):[],c=function t(e){return Object(Ni.reduce)(e,(function(e,i){return e.push(i),i.items?e.concat(t(i.items)):e}),[])}(o);l.length&&(c=Object(Ni.filter)(c,(function(t){return!l.includes(t.id)})));var d=w[i],h=d.ref,g=d.parentId,f=Object(Ni.filter)(c,(function(t){return g?t.parentId===g:!t.parentId==!g})),v=n.current.getBoundingClientRect();U.current=Object(Ni.findIndex)(f,{id:t}),B.current=a,L.current=r,z.current=r;var b={startX:a,startY:r,draggableId:t,draggableRef:n,flatList:c,excluded:l,originalDropable:i,origDropableRef:h,origDragableIdx:U.current};for(var y in lt(g),q.current=v.height,N.current=0,W.current=h,H.current=i,m.current=f,D.current=!1,F.current=0,G.current=s,K.current=s.current&&s.current.scrollTop||0,T&&R(!1),w)if(!w[y].parentId){var _=w[y].ref;if(_&&_.current){V.current=_.current;var k=_.current.getBoundingClientRect();Y.current=k.top,X.current=k.bottom,Z.current=k.left,J.current=k.right}}p((function(t){return Rn(Rn({},t),b)}))}}},dt=Object(r.useRef)(0),ht=function(){nt(void 0),dt.current&&(clearTimeout(dt.current),dt.current=0)};Object(r.useEffect)((function(){v((function(t){return Rn(Rn({},t),{},{isDragOff:Boolean(a)})}))}),[a]);var ut=function(t){var e=w[t].ref;if(e.current){var i=w[t].deltaSize;if(i){e.current.style.height="auto";var n=e.current.getBoundingClientRect();e.current.style.height="".concat(n.height+i,"px")}else e.current.style.height=""}},pt=Object(r.useCallback)((function(t){var e=function(){if(O&&S&&S.current){var t=S.current.getBoundingClientRect().height;m.current.forEach((function(e,i){var n=e.id,o=_[n];o&&o.current&&(W.current!==x?W.current&&W.current.current&&x&&x.current&&(x.current.contains(W.current.current)?i<U.current+F.current?o.current.style.transform="translateY(0px)":o.current.style.transform="translateY(".concat(+t,"px)"):i<U.current+F.current?o.current.style.transform="translateY(0px)":o.current.style.transform="translateY(".concat(t,"px)")):i!==U.current&&(i<Math.min(U.current,U.current+F.current)||i>Math.max(U.current,U.current+F.current)?o.current.style.transform="translateY(0px)":F.current<0?o.current.style.transform="translateY(".concat(+t,"px)"):o.current.style.transform="translateY(".concat(-t,"px)")))})),S&&S.current&&(S.current.style.transform="translateY(".concat(L.current-y+N.current,"px)")),it.current=void 0,ht(),D.current=!1}};if(O&&!D.current){if(!$.current)return Math.abs(L.current-y)>=5?(E.current=!1,i&&i(),S&&S.current&&(S.current.style.zIndex="100000",S.current.style.cursor="pointer"),void R(!0)):void 0;if(A.current||G.current&&G.current.current&&S&&S.current&&function t(e,i){if($.current){var n=e.getBoundingClientRect(),o=i.getBoundingClientRect();if(n.top-o.top<10&&i.scrollTop>0)A.current=!0,i.scrollTop-=15,pt(!0),Un((function(){t(e,i)}));else if(o.bottom-n.bottom<10&&i.clientHeight+i.scrollTop<i.scrollHeight)A.current=!0,i.scrollTop+=15,pt(!0),Un((function(){t(e,i)}));else if(A.current)if(A.current=!1,V.current){var a=V.current.getBoundingClientRect();Y.current=a.top,X.current=a.bottom}else for(var r in w)if(!w[r].parentId){var s=w[r].ref;if(s&&s.current){var l=s.current.getBoundingClientRect();Y.current=l.top,X.current=l.bottom}}}}(S.current,G.current.current),S&&S.current&&W.current&&W.current.current){var n=S.current.getBoundingClientRect(),o=parseInt((S.current.style.transform||"0").replace(/[^\-0-9]/g,"")),a=Y.current-(n.top-o),r=X.current-(n.bottom-o),s=L.current-y+N.current+(G.current&&G.current.current?G.current.current.scrollTop-K.current:0),l=Math.min(r,Math.max(a,s));if(S.current.style.transform="translateY(".concat(l,"px)"),t)return;if(G.current&&G.current.current){var c=G.current.current.getBoundingClientRect();if(n.top-c.top<10)return;if(c.bottom-n.bottom<10)return}q.current=n.height;var d=F.current,h=L.current-z.current,u=S.current.getBoundingClientRect(),p=(u.left+u.right)/2,g=h>0?u.bottom+2:u.top-2,f=document.elementFromPoint(p,g),v=f&&f.closest(".sortable-item"),P=f&&f.closest(".sortable-dropable"),I=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=w[t],o=Object(Ni.filter)(j,(function(t){return n.parentId?t.parentId===n.parentId:!t.parentId==!n.parentId}));w[t].deltaSize+=q.current,ut(t),w[H.current].deltaSize-=q.current,ut(H.current),m.current.forEach((function(t,e){var i=t.id,n=_[i];H.current===k?n&&n.current&&e!==U.current&&(e<U.current?n.current.style.transform="":n.current.style.transform="translateY(-".concat(q.current,"px)")):n&&n.current&&(n.current.style.transform="")}));var a=o.find((function(t){return t.id===w[H.current].parentId}));a?t===k?(U.current=C,F.current=i>0?o.indexOf(a)+1-C:o.indexOf(a)-C):(U.current=0,F.current=i>0?o.indexOf(a)+1:o.indexOf(a)):t===k?(F.current=d>F.current?-C:o.length-C,U.current=C):(U.current=0,F.current=i>0?0:o.length);var r=m.current.findIndex((function(t){return t.id===n.parentId})),s=a?o.indexOf(a):-1;-1!==r&&C>r&&t!==k||-1!==s&&U.current+F.current<=s&&t!==k?N.current=-q.current:N.current=0,lt(n.parentId),W.current=n.ref,H.current=t,m.current=o,z.current=L.current,D.current=!0,e()};if(h>0&&s-r>8&&st.current)return void I("0",h);if(v&&W.current&&W.current.current){var T=v.getBoundingClientRect(),M=h>0?u.bottom-T.top:T.top+q.current-u.top,B=Object.keys(_).find((function(t){return _[t].current===v}));if(P&&P!==W.current.current){var Z=Object.keys(w).find((function(t){return w[t].ref.current&&w[t].ref.current===P}));if(Z&&M>8)return void I(Z,h)}var J=m.current.findIndex((function(t){return t.id===B})),Q=m.current.findIndex((function(t){return t.id===O}));if(-1!==J){var tt=m.current[J],et=0;-1!==Q&&Q<=J&&h<0&&(et=-1),-1!==Q&&Q>=J&&h>0&&(et=1);var ot=Math.abs(J+et-(U.current+F.current))>1||M>q.current*b;if(!ot&&M>.2*q.current&&!st.current&&!dt.current?function(t){dt.current&&(clearTimeout(dt.current),dt.current=0),dt.current=setTimeout((function(){nt(t),dt.current=0}),800)}(B):it.current&&it.current!==B&&dt.current&&ht(),ot){if(tt.items){var at=Object.keys(w).find((function(t){return w[t].ref.current&&w[t].parentId===tt.id}));if(at)return void I(at,h)}(d=J-U.current)===F.current&&(d+=h>0?1:-1)}}}else ht();F.current!==d&&(F.current=d,D.current=!0,e()),z.current=L.current}else ht()}}),[y,F,T]),mt=function(t){$.current&&t.preventDefault(),B.current=t.screenX,L.current=t.screenY,pt()},gt=function(t){E.current&&(E.current=!1),$.current&&(t.preventDefault(),R(!1),l&&(it.current?l(O,it.current,0,P):l(O,st.current,U.current+F.current,P)),c&&c(),ht(),function(){for(var t in _){var e=_[t];e.current&&(e.current.style.transform="",e.current.style.zIndex="",e.current.style.border="",e.current.style.opacity="",e.current.style.background="",e.current.style.cursor="")}for(var i in w){var n=w[i].ref;n&&n.current&&(n.current.style.marginBottom="",n.current.style.paddingBottom="",n.current.style.height=""),w[i].deltaSize=0}}()),p((function(t){return Rn(Rn({},t),{},{draggableIdx:0,draggableId:"",dIdx:0})})),H.current=""},ft=function(t){return t.preventDefault()},vt=function(t){return t.preventDefault()},bt=function t(e){e.preventDefault(),window.removeEventListener("click",t,{capture:!0})};return Object(r.useEffect)((function(){return E.current||$.current?(window.removeEventListener("click",vt,{capture:!0}),window.removeEventListener("mousedown",ft,{capture:!0}),window.addEventListener("click",vt,{capture:!0}),window.addEventListener("mousedown",ft,{capture:!0})):(window.addEventListener("click",bt,{capture:!0}),setTimeout((function(){window.removeEventListener("click",bt,{capture:!0})}),800),window.removeEventListener("click",vt,{capture:!0}),window.removeEventListener("mousedown",ft,{capture:!0})),function(){window.removeEventListener("click",vt,{capture:!0}),window.removeEventListener("mousedown",ft,{capture:!0})}}),[E.current,$.current]),Object(r.useEffect)((function(){return O?(E.current=!0,window.addEventListener("mousemove",mt,{capture:!0}),window.addEventListener("mouseup",gt,{capture:!0})):(E.current=!1,window.removeEventListener("mousemove",mt,{capture:!0}),window.removeEventListener("mouseup",gt,{capture:!0})),function(){window.removeEventListener("mousemove",mt,{capture:!0}),window.removeEventListener("mouseup",gt,{capture:!0})}}),[O]),s.a.createElement(zn.Provider,{value:{parentId:at,id:O,isActive:T,onItemId:tt}},s.a.createElement(Fn.Provider,{value:Rn(Rn({},f),ct)},n({dragInProgress:T})))},Hn=function(t){var e=t.children,i=t.parentId,n=t.dropableId,o=Object(r.useContext)(Fn).pushDropableRef,a=Object(r.useRef)(null);return Object(r.useEffect)((function(){o(a,n,i)}),[a]),e({state:"",dropElementRef:a,dropableId:n})},Vn=function(t){var e=t.children,i=t.draggableId,n=t.dropableId,o=t.disabled,a=Object(r.useRef)(null),s=Object(r.useRef)(null),l=Object(r.useContext)(Fn),c=l.pushDraggableRef,h=l.setDraggable,u=l.isDragOff,p=Object(r.useContext)(d.kb).wrapperRef,m=Bn(Object(r.useState)([0,0]),2),g=m[0],f=m[1],v=function(t){t.defaultPrevented||0===t.button&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey||(t.preventDefault(),f([t.screenX,t.screenY])))};return Object(r.useEffect)((function(){!o&&!u&&g[0]&&g[1]&&h(i,n,a,g[0],g[1],p)}),[g]),Object(r.useEffect)((function(){c(i,a);var t=s.current||a.current;return t&&(t.removeEventListener("mousedown",v),t.addEventListener("mousedown",v)),function(){t&&t.removeEventListener("mousedown",v)}}),[a.current,s.current]),e({state:"",ref:a,mouseDownRef:s})},Wn=Object(a.e)(d.bb).withConfig({displayName:"PageScreenshot___StyledPicture"})(["border-radius:4px;opacity:",";filter:blur(",");display:block;"],(function(t){return t._css}),(function(t){return t._css2})),Gn=function(t){var e=t.url,i=t.opacity,n=t.blur,o=void 0!==n&&n,a=t.width,r=t.height;if(!e)return null;var l=e,c=ie.default.getFilenameComponent(e);if(!c||c&&isNaN(Number(c))){var h=ie.default.screenshotSize(256);l=ie.default.addFilenameComponent(e,h)}return(s.a.createElement(d.m,{width:"100%",height:"100%",position:"relative"},s.a.createElement(Wn,{width:a||"100%",height:r||"100%",src:l,_css:void 0!==i?i:1,_css2:o?"1px":0}),s.a.createElement(d.m,{width:"100%",height:"100%",position:"absolute",top:0,left:0})))},qn=function(t){var e=t.isPageSettingsOpened,i=t.hideDelete,n=t.actionCallback;return(s.a.createElement(d.m,{pl:3,pt:12},s.a.createElement(d.m,null,s.a.createElement(d.n,{"aria-labelledby":"duplicate-page",textStyle:"subheading",color:"white",onClick:function(t){t.preventDefault(),t.stopPropagation(),n(K.Duplicate)}},"Duplicate")),s.a.createElement(d.m,{mt:12},s.a.createElement(d.n,{"aria-labelledby":"toggle-page-settings",textStyle:"subheading",color:e?"tomato":"white",onClick:function(t){t.preventDefault(),t.stopPropagation(),h.d.sendEvent(h.b.PageSEOOpen),n(K.Settings)}},"Settings")),!i&&s.a.createElement(d.m,{mt:12},s.a.createElement(d.n,{"aria-labelledby":"delete-page",textStyle:"subheading",color:"white",onClick:function(t){t.preventDefault(),t.stopPropagation(),n(K.Delete)}},"Delete"))))};function Kn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Yn(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Yn(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yn(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Xn=Object(a.e)(d.ib).withConfig({displayName:"PageActionsSmallPanel___StyledRoundButton"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5})),Zn=Object(a.e)(d.hb).withConfig({displayName:"PageActionsSmallPanel___StyledResponsiveAvatar"})(["margin-left:8px;"]),Jn=s.a.memo((function(t){var e=t.isPopupOpened,i=t.isCurrentPage,n=t.popupContainer,o=t.hideDelete,a=t.onPageActionsButtonClick,l=t.isPageSettingsOpened,c=t.pageActionsHandler,h=t.collaboratorName,u=t.collaboratorAvatar,p=t.keepActionButtons,m=Kn(Object(r.useState)({left:0,top:0}),2),g=m[0],f=m[1],v=Object(d.Xb)({watchingClick:e,callback:function(){a(!0)}});return s.a.createElement(d.B,{className:"page-actions-small-panel"},s.a.createElement(Xn,{"aria-labelledby":"toggle-page-actions-popup",size:32,color:"white",hoverColor:"white",activeColor:"tomato","data-active":e||l&&i,outline:!0,mr:0,onClick:function(t){if(t.preventDefault(),t.stopPropagation(),n){var e=t.currentTarget.getBoundingClientRect(),i=n.getBoundingClientRect();f({left:e.left-i.left-e.width-127,top:e.top-i.top-(o?28:46)}),a()}},_css:p?1:0,_css2:d.Ub.white,_css3:d.Ub.tomato,_css4:d.Ub.tomato,_css5:d.Ub.white},s.a.createElement(d.Hb,{color:e||l&&i?"white":"black"})),n&&s.a.createElement(Cn,{ref:v,rootElement:n,isShown:e,width:148,height:o?88:124,top:"".concat(g.top,"px"),left:"".concat(g.left,"px"),placement:un.Right},s.a.createElement(qn,{isPageSettingsOpened:l,hideDelete:o,actionCallback:c})),h&&s.a.createElement(Zn,{size:"small",url:u,name:h}))}));Jn.displayName="PageActionsSmallPanel";var Qn=Object(a.e)(d.B).withConfig({displayName:"PageActionsStandartPanel__Actions"})(["transition:opacity 0.2s ease;& > *{margin-left:16px;&:first-child{margin-left:0;}}"]),to=Object(a.e)(d.ib).withConfig({displayName:"PageActionsStandartPanel___StyledRoundButton"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5})),eo=Object(a.e)(d.ib).withConfig({displayName:"PageActionsStandartPanel___StyledRoundButton2"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(t){return t._css6}),(function(t){return t._css7}),(function(t){return t._css8}),(function(t){return t._css9}),(function(t){return t._css10})),io=Object(a.e)(d.ib).withConfig({displayName:"PageActionsStandartPanel___StyledRoundButton3"})(["opacity:",";transition:opacity 0.2s ease;&:hover{background-color:",";& svg{color:",";}}&:active{background-color:",";& svg{color:",";}}"],(function(t){return t._css11}),(function(t){return t._css12}),(function(t){return t._css13}),(function(t){return t._css14}),(function(t){return t._css15})),no=Object(a.e)(d.hb).withConfig({displayName:"PageActionsStandartPanel___StyledResponsiveAvatar"})(["transform:translateX(",");transition:opacity 0.2s ease,transform 0.2s ease-in-out;"],(function(t){return t._css16})),oo=s.a.memo((function(t){var e=t.isCurrentPage,i=t.isPageSettingsOpened,n=t.hideDelete,o=t.collaboratorName,a=t.collaboratorAvatar,r=t.pageActionsHandler,l=t.keepActionButtons;return(s.a.createElement(Qn,{className:"page-actions-standart-panel",width:128,height:32,position:"absolute",bottom:8,left:0,right:0,m:"auto",justifyContent:"center"},s.a.createElement(to,{"aria-labelledby":"duplicat-page",size:32,color:"white",outline:!0,mr:0,unstyledHover:!0,onClick:function(t){t.preventDefault(),t.stopPropagation(),r(K.Duplicate)},_css:i?0:l?1:0,_css2:d.Ub.white,_css3:d.Ub.tomato,_css4:d.Ub.tomato,_css5:d.Ub.white},s.a.createElement(d.x,{color:"black"})),s.a.createElement(eo,{"aria-labelledby":"toggle-page-settings",size:32,color:"white",outline:!0,"data-active":e&&i,mr:0,onClick:function(t){t.preventDefault(),e&&t.stopPropagation(),i||h.d.sendEvent(h.b.PageSEOOpen),(!i||i&&e)&&r(K.Settings)},_css6:l?1:0,_css7:d.Ub.white,_css8:d.Ub.tomato,_css9:d.Ub.tomato,_css10:d.Ub.white},s.a.createElement(d.lb,{color:e&&i?"white":"black"})),n||o?null:s.a.createElement(io,{"aria-labelledby":"delete-page",size:32,color:"white",outline:!0,mr:0,onClick:function(t){t.preventDefault(),t.stopPropagation(),r(K.Delete)},_css11:i?0:l?1:0,_css12:d.Ub.white,_css13:d.Ub.tomato,_css14:d.Ub.tomato,_css15:d.Ub.white},s.a.createElement(d.w,{color:"black"})),o&&s.a.createElement(no,{className:"page-actions-avatar",size:"small",url:a,name:o,_css16:l?0:"-48px"})))}));oo.displayName="PageActionsStandartPanel";var ao=s.a.memo((function(t){var e,i=t.isCurrentPage,a=t.pageId,l=t.gridSize,c=t.hidden,h=void 0!==c&&c,u=Object(r.useContext)(k),p=Object(r.useContext)(rd),m=Object(r.useContext)(Ro),g=function(t){var e=!1;t||u.isPageActionsPopupOpenedFor!==a&&(e=a),u.dispatch({type:o.SetPageActionsPopup,payload:e})},f=function(t){switch(t){case K.Duplicate:!function(){var t="pending-".concat(Date.now()),e=p.pages.find((function(t){return t._id===a})),i=p.pagesParams[a];if(e){var n=i.children.length&&i.collapsed;m.addPendingPage({_id:t,uri:"",screenshot:e.screenshot,title:e.title,num:i.children.length?e.num:e.num+1,parentPage:n?e._id:e.parentPage,hidden:!1,pending:!0})}p.duplicatePage(a).then((function(){})).catch((function(t){console.warn("page dublicate",t)})).finally((function(){m.removePendingPage(t)}))}();break;case K.Delete:p.deletePage(a);break;case K.Settings:u.isPageActionsPopupOpenedFor&&g(!0),u.isTrashOpened,u.isPageSettingsOpened||i||u.isPageActionsPopupOpenedFor!==a||window.RM.constructorRouter.showWorkspace({id:a}),u.dispatch({type:o.TogglePageSettings});break;case K.GoToPage:p.changeWorkspace({id:a})}},v=Object(r.useMemo)((function(){return u.isPageActionsPopupOpenedFor===a}),[u.isPageActionsPopupOpenedFor]),b=p.lockedPages[a],y=b&&b!==(null===(e=window.RM.constructorRouter.me)||void 0===e?void 0:e.get("uri"))?p.collaborators.find((function(t){return t.uri===b})):void 0;return h?null:l===n.Standard?s.a.createElement(d.m,null,s.a.createElement(oo,{isCurrentPage:i,keepActionButtons:i&&!u.addingPage,isPageSettingsOpened:u.isPageSettingsOpened,hideDelete:1===p.pages.length,collaboratorName:y&&y.name,collaboratorAvatar:y&&y.pic,pageActionsHandler:f})):s.a.createElement(d.B,{alignItems:"center",position:"absolute",top:0,bottom:0,m:"auto",left:7},s.a.createElement(Jn,{isPopupOpened:v,popupContainer:p.popupContainer,hideDelete:1===p.pages.length,onPageActionsButtonClick:g,isPageSettingsOpened:u.isPageSettingsOpened,collaboratorName:y&&y.name,collaboratorAvatar:y&&y.pic,isCurrentPage:i,keepActionButtons:i&&!u.addingPage,pageActionsHandler:f}))}));function ro(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return so(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return so(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function so(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}ao.displayName="ActionsPanelWraper";var lo=Object(a.e)(d.B).withConfig({displayName:"PageListItem___StyledFlex"})(["transform:rotate(",") translateX(",");transition:transform 200ms ease;"],(function(t){return t._css}),(function(t){return t._css2})),co=Object(a.e)(d.m).withConfig({displayName:"PageListItem___StyledBox"})(["border:"," solid ",";&:hover{.page-actions-standart-panel > *,.page-actions-small-panel > *{opacity:1;}.page-actions-avatar{transform:translateX(0);}}transform-origin:left;overflow:hidden;flex:0 0 auto;transform:scale(",");"],(function(t){return t._css3}),(function(t){return t._css4}),(function(t){return t._css5})),ho=Object(a.e)(d.Cb).withConfig({displayName:"PageListItem___StyledText"})(["float:left;"]),uo=Object(a.e)(d.H).withConfig({displayName:"PageListItem___StyledInlineInput"})(["width:","px;height:auto;padding:0;text-overflow:ellipsis;&:focus{border:none;}"],(function(t){return t._css6})),po=s.a.memo((function(t){var e=t.page,i=t.gridSize,o=t.dragableRef,a=t.level,l=void 0===a?0:a,c=t.head,h=t.childIndex,u=t.onCollapsed,p=t.isPageCollapsed,m=void 0===p||p,g=Object(r.useContext)(rd),f=Object(r.useContext)(zn),v=l?16*l:l,b=Object(r.useMemo)((function(){return g.pagesParams[e._id]?g.pagesParams[e._id].parentId?g.pagesParams[g.pagesParams[e._id].parentId].viewNum:g.pagesParams[e._id].viewNum:e.num}),[e,l,g.pagesParams]),y=ro(Object(r.useState)((function(){return e.title?e.title:""})),2),_=y[0],w=y[1],k=ro(Object(r.useState)(!1),2),S=k[0],x=k[1];Object(r.useEffect)((function(){S||e.title===_||w(e.title?e.title:"")}),[e.title]);var C=ro(Object(r.useState)(""),2),O=C[0],j=C[1];Object(r.useEffect)((function(){j(e._id===f.onItemId?"colors.gray":g.selectedPages.includes(e._id)?"colors.tomato":"")}),[f.onItemId,g.selectedPages]),Object(r.useEffect)((function(){!e.screenshot&&g.updatePageScreenshot(e._id)}),[e.screenshot]);var P=e.pending,E=Object(r.useRef)(null),I=Object(r.useCallback)((function(t){t!==e.uri&&g.pageSave(e._id,{uri:t})}),[e._id]),T=Object(r.useCallback)((function(t){return g.validatePageUri(e._id,t)}),[e._id]),M=Object(r.useCallback)((function(t){return t.replace(/[^A-Za-z0-9_.+-]/g,"")}),[]);return s.a.createElement(d.m,{width:"192px",py:"2px",ml:"".concat(v,"px"),position:"relative",display:i===n.Standard?"block":"flex",className:"page-list-item","data-page-id":e._id},e._id===g.currentPageId&&s.a.createElement(mo,{gridSize:i}),c&&s.a.createElement(lo,{width:12,height:12,position:"absolute",top:i===n.Standard?143:20,left:i===n.Standard?5:97,alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:1,onClick:function(){return u&&u()},_css:m?"0deg":"-90deg",_css2:m?n.Standard?"3px":"2px":"0px"},s.a.createElement(d.Gb,{color:"black"})),s.a.createElement(co,{width:i===n.Standard?208:"96px",height:i===n.Standard?140:"64px",className:"page-list-item-picture",mb:l?1:"0px",borderRadius:i===n.Standard?"8px":"6px",position:"relative",zIndex:1,p:i===n.Standard?"4px":"2px",cursor:"pointer",onClick:function(t){t.defaultPrevented||(t.metaKey||t.ctrlKey?g.selectPage(e._id):t.shiftKey?g.selectPagesRange(e._id):g.selectedPages.length?g.deselectPages():f.isActive||g.changeWorkspace({id:e._id}),t.preventDefault())},_css3:i===n.Standard?"4px":"2px",_css4:O?Object(Et.themeGet)(O):"transparent",_css5:l&&i===n.Standard?"0.92":"1"},s.a.createElement(d.m,{className:"sortable-item-handle",height:i===n.Standard?124:"56px",position:"relative",boxShadow:"0 1px 1px rgba(64, 64, 64, 0.32)",borderRadius:i===n.Standard?"8px":"4px",bg:"white",ref:o},P&&s.a.createElement(d.B,{position:"absolute",top:"0",right:"0",bottom:"0",left:"0",justifyContent:"center",alignItems:"center",zIndex:1},s.a.createElement(d.Q,{bgColor:"transparent"})),s.a.createElement(Gn,{url:e.screenshot,opacity:e.hidden?.4:1,width:i===n.Standard?192:88,height:i===n.Standard?124:56}),!P&&s.a.createElement(ao,{isCurrentPage:e._id===g.currentPageId,pageId:e._id,gridSize:i,hidden:!!f.isActive}))),s.a.createElement(d.m,{opacity:i===n.Standard&&e._id===f.id&&f.isActive?0:1},s.a.createElement(d.m,{width:"100%",ml:"".concat(i===n.Standard?c?24:8:c?20:4,"px"),mt:"".concat(i===n.Standard?c?-1:0:16,"px")},s.a.createElement(ho,{textStyle:"small"},b,h?".".concat(h):"",". "),s.a.createElement(uo,{type:"text",textStyle:"small",color:"black",placeholder:"Page Title",spellCheck:!1,autoComplete:"off",autoCorrect:"off",maxLength:128,value:_,disabled:P,onChange:function(t){w(t.target.value)},onBlur:function(){x(!1);var t=g.pageSave(e._id,{title:_});!t||t instanceof Error||t.done((function(t){})).fail((function(){}))},onFocus:function(){x(!0)},_css6:i===n.Standard?c||l?156:170:c||l?62:82})),s.a.createElement(d.B,{width:"100%",ml:"".concat(i===n.Standard?c&&m?24:8:4,"px"),mt:"-2px",justifyContent:"start",ref:E},s.a.createElement(Ft,{validationMessageAnchor:E.current,validationMessageContainer:g.popupContainer,name:"link",placeholder:"custom url",textStyle:"small",link:e.uri,disabled:P,width:i===n.Standard?c||l?172:192:c||l?80:96,withSlash:!0,validationMessageZIndex:3,validate:T,filter:M,onDone:I}))))}));po.displayName="PageListItem";var mo=function(t){var e=t.gridSize;return(s.a.createElement(d.m,{width:"6px",height:"6px",borderRadius:"round",bg:"tomato",position:"absolute",top:e===n.Standard?70:"31px",left:e===n.Standard?-7:"-11px",zIndex:1}))};function go(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||vo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fo(t){return function(t){if(Array.isArray(t))return bo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||vo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vo(t,e){if(t){if("string"==typeof t)return bo(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?bo(t,e):void 0}}function bo(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var yo=Object(a.e)(d.m).withConfig({displayName:"StackedPages___StyledBox"})(["user-select:none;"]),_o=Object(a.e)(d.m).withConfig({displayName:"StackedPages___StyledBox2"})(["border:"," solid transparent;cursor:pointer;:hover{.page-actions-standart-panel > *{opacity:1;display:block;}.page-actions-button{opacity:1;display:block;}}transform-origin:left;overflow:hidden;flex:0 0 auto;transform:scale(",");"],(function(t){return t._css}),(function(t){return t._css2})),wo=Object(a.e)(d.m).withConfig({displayName:"StackedPages___StyledBox3"})(["box-shadow:0 1px 1px rgba(64,64,64,0.32);"]),ko=s.a.memo((function(t){var e=t.topPageId,i=t.stackedPages,o=t.gridSize,a=t.level,l=void 0===a?0:a,c=Object(r.useContext)(rd),h=l?16*l:l,u=c.pagesTree.reduce((function(t,e){return e.children instanceof Array?[].concat(fo(t),[e],fo(e.children)):[].concat(fo(t),[e])}),[]).filter((function(t){return i.includes(t._id)}));if(e){var p=u.findIndex((function(t){return t._id===e})),m=go(u.splice(p,1),1)[0];u.unshift(m)}return u=u.slice(0,4).reverse(),s.a.createElement(yo,{width:"192px",height:o===n.Standard?"176px":"68px",py:"2px",ml:"".concat(h,"px"),position:"relative",display:o===n.Standard?"block":"flex"},u.map((function(t,e){return s.a.createElement(_o,{key:t._id,top:o===n.Standard?4*(u.length-1-e):0,left:4*(u.length-1-e),width:o===n.Standard?208:"96px",height:o===n.Standard?140:"64px",className:"page-list-item-picture",mb:l?1:"0px",borderRadius:o===n.Standard?"8px":"4px",position:"absolute",zIndex:1,p:o===n.Standard?"4px":"2px",_css:o===n.Standard?"4px":"2px",_css2:l&&o===n.Standard?"0.92":"1"},s.a.createElement(wo,{borderRadius:"s",height:o===n.Standard?124:"56px",bg:"#FFF"},s.a.createElement(Gn,{url:t.screenshot,width:o===n.Standard?192:88,height:o===n.Standard?124:56})))})),s.a.createElement(d.m,{height:32}))}));function So(t){return function(t){if(Array.isArray(t))return Oo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Co(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Co(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Co(t,e){if(t){if("string"==typeof t)return Oo(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Oo(t,e):void 0}}function Oo(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}ko.displayName="StackedPages";"undefined"!=typeof window&&(window.requestAnimationFrame||window.setImmediate);var jo=s.a.memo((function(t){var e=t.page,i=t.gridSize,n=t.level,o=void 0===n?0:n,a=t.dropableId,l=t.childIndex,c=Object(r.useContext)(rd),h=Object(r.useContext)(zn),u=Object(r.useRef)(null),p=!(!e.children||!e.children.length),m=!c.pagesParams[e._id]||c.pagesParams[e._id].collapsed,g=xo(Object(r.useState)(!1),2),f=g[0],v=g[1],b=xo(Object(r.useState)(0),2),y=b[0],_=b[1],w=Object(r.useCallback)((function(){c.setPageCollapse(e._id,!m),v(!1),m?_(setTimeout((function(){v(!0)}),800)):y&&(clearTimeout(y),_(0))}),[e._id,m]),k=xo(Object(r.useState)(!1),2),S=k[0],x=k[1],C=xo(Object(r.useState)(!1),2),O=C[0],j=C[1];return Object(r.useEffect)((function(){if(h.isActive&&h.id){if(c.selectedPages.includes(h.id))return h.id===e._id?(x(!0),void j(!1)):(x(!1),void j(c.selectedPages.includes(e._id)));if(h.id===e._id&&e.children)return void x(!0)}x(!1),j(!1)}),[h.isActive]),O?null:s.a.createElement(Vn,{draggableId:e._id,dropableId:a},(function(t){var n=t.ref,a=t.mouseDownRef;return(s.a.createElement(d.m,{position:"relative",ref:n},S?s.a.createElement(ko,{topPageId:e._id,stackedPages:c.selectedPages.includes(e._id)?c.selectedPages:[e._id].concat(So(e.children.map((function(t){return t._id})))),gridSize:i,level:h.id===e._id?h.parentId?1:0:o}):s.a.createElement(s.a.Fragment,null,s.a.createElement(po,{page:e,gridSize:i,dragableRef:a,level:h.id===e._id?h.parentId?1:0:o,head:p,onCollapsed:w,isPageCollapsed:m,childIndex:l}),m&&!f&&e.children&&p?s.a.createElement(Hn,{parentId:e._id,dropableId:e._id},(function(t){var n=t.dropElementRef,a=t.dropableId;return(s.a.createElement(d.m,{className:"page-children-container",ref:u,"data-parent-id":e._id,style:{height:m?"auto":"0px",overflow:m?"visible":"hidden",transition:"height 200ms ease"}},s.a.createElement(d.m,{ref:n},e.children.map((function(t,e){return s.a.createElement(jo,{key:t._id,page:t,gridSize:i,level:o+1,dropableId:a,childIndex:e+1})})))))})):null)))}))}));function Po(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Eo(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Po(Object(i),!0).forEach((function(e){Io(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Po(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Io(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function To(t){return function(t){if(Array.isArray(t))return Ao(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||$o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||$o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $o(t,e){if(t){if("string"==typeof t)return Ao(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ao(t,e):void 0}}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}jo.displayName="Branch";var Ro=s.a.createContext({removePendingPage:function(){},addPendingPage:function(){}}),Do=Object(a.e)(d.B).withConfig({displayName:"PagesList___StyledFlex"})(["user-select:none;"]),Bo=function(){var t=Object(r.useContext)(k),e=Object(r.useContext)(rd),i=Object(r.useContext)(zn),o=Mo(Object(r.useState)(0),2),a=o[0],l=o[1],c=Mo(Object(r.useState)([]),2),h=c[0],u=c[1],p=Object(r.useCallback)((function(t){u([].concat(To(h),[t]))}),[h]),m=Object(r.useCallback)((function(t){u(h.filter((function(e){return e._id!==t})))}),[h]);Object(r.useEffect)((function(){if(i.isActive&&i.id&&e.selectedPages.includes(i.id)){var o=e.pagesTree.reduce((function(t,e){return e.children instanceof Array?[].concat(To(t),[e],To(e.children)):[].concat(To(t),[e])}),[]).filter((function(t){return e.selectedPages.includes(t._id)})).findIndex((function(t){return t._id===i.id}));l(Math.max(0,o*(t.gridSize===n.Standard?176:68)))}else l(0)}),[i.isActive]),Object(r.useEffect)((function(){t.isSettingsOpened&&e.scrollToPage(e.currentPageId)}),[e.currentPageId,t.isSettingsOpened]);var g=Object(r.useCallback)((function(t){return t.sort((function(t,e){return(t.pending?t.num-1:t.num)-(e.pending?e.num-1:e.num)}))}),[]),f=h.length?g([].concat(To(e.pagesTree.map((function(t){var e=h.filter((function(e){return e.parentPage===t._id}));return e.length?Eo(Eo({},t),{},{children:g([].concat(To(t.children?t.children:[]),To(e)))}):t}))),To(h.filter((function(t){return!t.parentPage}))))):e.pagesTree;return s.a.createElement(Ro.Provider,{value:{addPendingPage:p,removePendingPage:m}},s.a.createElement(Do,{id:"page-list-container",flexDirection:"column",justifyContent:"left",flexWrap:"wrap",pl:t.gridSize===n.Standard?"8px":"12px",pr:3,py:"6px"},i.isActive?s.a.createElement(d.m,{height:a}):null,s.a.createElement(Hn,{dropableId:"0"},(function(e){var i=e.dropElementRef,n=e.dropableId;return(s.a.createElement(d.m,{ref:i},f.map((function(e){return s.a.createElement(jo,{key:e._id,page:e,gridSize:t.gridSize,dropableId:n})}))))}))))};function Lo(t){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zo(t){return function(t){if(Array.isArray(t))return No(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Uo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Uo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uo(t,e){if(t){if("string"==typeof t)return No(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?No(t,e):void 0}}function No(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ho,Vo=Object(a.e)(d.m).withConfig({displayName:"SettingsBody___StyledBox"})(["overflow:hidden;"]),Wo=function(){var t=Object(r.useContext)(k),e=Object(r.useContext)(rd),i=Object(r.useRef)(!0),a=Object(r.useRef)(null),l=Object(r.useRef)(!1),c=Object(r.useRef)(null),u=Object(r.useRef)(!1),p=Object(r.useRef)(null),m=Object(r.useRef)(null);Object(r.useEffect)((function(){m.current&&(t.isPageActionsPopupOpenedFor?m.current.style.overflowY="hidden":m.current.style.overflowY="scroll")}),[t.isPageActionsPopupOpenedFor]);var g=function(t){m.current=t;var e=t.scrollHeight,i=t.clientHeight,n=t.scrollTop,o=!!n,r=i<e&&i+n<e;r!==u.current&&(u.current=r,c.current&&(c.current.style.display=r?"block":"none")),o!==l.current&&(l.current=o,a.current&&(a.current.style.display=o?"block":"none"))},f=Object(r.useCallback)((function(t){if(i.current){var e=t.target;e&&g(e)}}),[i]),v=function(t){g(t)};Object(r.useEffect)((function(){m.current&&g(m.current)}),[t.gridSize,e.pagesParams]);var b=Fo(Object(r.useState)((function(){return e.project.title||""})),2),y=b[0],_=b[1],w=Fo(Object(r.useState)(!1),2),S=w[0],x=w[1];Object(r.useEffect)((function(){S||_(e.project.title||"")}),[e.project.title]);var O=function(){x(!1);var t=N(y," ").trim();_(t),e.projectSave({title:t},{patch:!0})},j=function(){t.dispatch({type:o.ToggleGridSize})},E=z(e.project);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Nn,{unionOn:!0,idList:P(e.pagesTree),isDragOff:t.isPageSettingsOpened,onAfterDragEnd:function(){p.current&&p.current.style.removeProperty("height");var t=document.getElementsByTagName("body")[0],e=t.className;t.className=e.split(" ").filter((function(t){return t&&"user-select-none"!==t})).join(" "),i.current=!0},onBeforeDragStart:function(t){if(e.selectedPages.includes(t))return Object(Ni.without)(e.selectedPages,t);var i=e.pagesTree.find((function(e){return e._id===t}));if(i&&i.children&&(!e.pagesParams[i._id]||e.pagesParams[i._id].collapsed))return i.children.map((function(t){return t._id}));return[]},onDragStart:function(){document.getElementsByTagName("body")[0].className+=" user-select-none",p.current&&(p.current.style.height=p.current.clientHeight+"px"),i.current=!1},onDragEnd:function(t,i,n,o){var a=P(e.pagesTree),r=e.pagesTree.reduce((function(t,e){return e.children?[].concat(zo(t),[e],zo(e.children)):[].concat(zo(t),[e])}),[]).find((function(e){return e._id===t})),s=function t(e,i){for(var n=[],o=0;o<e.length;o++)if(i.includes(e[o].id)&&n.push(e[o]),e[o].items){var a=t(e[o].items,i);n=[].concat(zo(n),zo(a))}for(var r=function(t){var n=Object(Ni.findIndex)(e,(function(e){return e.id===i[t]}));-1!==n&&e.splice(n,1)},s=0;s<i.length;s++)r(s);return n}(a,e.selectedPages.includes(t)?o.length?[].concat(zo(o),[t]):[t]:i&&r&&r.children?[t].concat(zo(r.children.map((function(t){return t._id})))):[t]);if(s.length){s.forEach((function(t){return t.parentId=void 0})),function t(e,i,n,o){if(o)for(var a=function(a){if(e[a].id===o)return e[a].items||(e[a].items=[]),i.forEach((function(t){return t.parentId=e[a].id})),t(e[a].items,i,n),{v:void 0};e[a].items&&t(e[a].items,i,n,o)},r=0;r<e.length;r++){var s=a(r);if("object"===Lo(s))return s.v}else e.splice.apply(e,[n,0].concat(zo(i)))}(a,s,n,i);var l=function t(e){return e.reduce((function(e,i){return e.push(i),i.items?e.concat(t(i.items)):e}),[])}(a),c=1,d=l.map((function(t){return{id:t.id,num:c++,parentPage:t.parentId||null}}));e.saveOrder(d),setTimeout((function(){e.updateUrl(),i&&h.d.sendEvent(h.b.CreatePage,{eventLabel:"Subpage"})}),100)}}},(function(){return s.a.createElement(d.m,{id:"project-settings-body",width:"100%",height:"calc(100% - 89px)",position:"relative"},s.a.createElement(d.jb,{onScroll:f,onFirstRender:v},(function(i){var a=i.ref;return(s.a.createElement(Vo,{ref:Object(d.Vb)(a,p),pt:16,px:2},s.a.createElement(d.B,{justifyContent:"space-between",p:"0 16px",position:"relative",zIndex:1},s.a.createElement(d.Cb,{textStyle:"small",color:E===C.UnpublishedChanges?"tomato":"darkGray"},B(e.project)),s.a.createElement(d.n,{textStyle:"small",color:"darkGray","aria-labelledby":"open-help-panel",onClick:function(){return t.dispatch({type:o.ToggleHelpPanel,open:!0})}},"Help")),s.a.createElement(d.m,{px:3,mt:"8px"},s.a.createElement(d.jb,null,(function(t){var e=t.ref;return(s.a.createElement(d.m,{width:"100%",maxHeight:192,ref:e},s.a.createElement(d.I,{name:"project-title",placeholder:"Project Title",translate:"no",spellCheck:!1,maxLength:128,rows:1,autoSize:!0,textStyle:"subheading",color:"black",value:y,onChange:function(t){_(N(String(t.currentTarget.value)))},onFocus:function(){x(!0)},onBlur:O})))})),s.a.createElement(d.m,{mt:"5px",position:"relative"},s.a.createElement(d.B,{width:28,mt:"12px",onClick:j,cursor:"pointer"},s.a.createElement(d.m,null,s.a.createElement(d.rb,{color:t.gridSize===n.Standard?"black":"gray"})),s.a.createElement(d.m,{ml:"1"},s.a.createElement(d.nb,{color:t.gridSize===n.Small?"black":"gray"}))))),s.a.createElement(Bo,null),s.a.createElement(d.m,{ref:c,width:224,height:2,position:"fixed",bottom:87,borderRadius:"xs",bg:"gray",display:"none"})))})))})),s.a.createElement($n,null))};function Go(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return qo(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qo(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qo(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t[t.Confirmed=0]="Confirmed",t[t.Canceled=1]="Canceled"}(Ho||(Ho={}));var Ko=Object(a.e)(d.m).withConfig({displayName:"Trash___StyledBox"})(["z-index:",";overflow-x:hidden;overflow-y:auto;transform:translateX( "," );transition:transform "," ease;"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3})),Yo=s.a.memo((function(){var t=Object(r.useContext)(k),e=Object(r.useContext)(rd),i=Go(Object(r.useState)(!1),2),n=i[0],a=i[1],l=Go(Object(r.useState)(!1),2),c=l[0],h=l[1];Object(r.useEffect)((function(){t.isTrashOpened?(t.isPageSettingsOpened&&(h(!0),setTimeout((function(){t.dispatch({type:o.TogglePageSettings}),h(!1)}),0)),document.body.classList.add("trash-is-opened"),e.updateTrash()):(c&&h(!1),document.body.classList.remove("trash-is-opened"),n&&a(!1))}),[t.isTrashOpened]);var u=function(t){return e.restorePage(t)},p=function(t){return e.deletePagesFromTrash([t])};return s.a.createElement(Ko,{id:"constructor-pages-bin",height:"100%",width:240,pt:0,position:"fixed",top:0,right:0,bottom:0,bg:"black",_css:c?Z+1:Z,_css2:t.isSettingsOpened?t.isTrashOpened?"0px":"240px":t.isTrashOpened?"480px":"240px",_css3:t.isPageSettingsOpened?"0":tt},s.a.createElement(d.m,{height:"calc(100% - 88px)",overflow:"auto"},s.a.createElement(d.jb,null,(function(t){var i=t.ref;return(s.a.createElement(d.m,{ref:i,px:22,pt:28},s.a.createElement(d.B,{height:48,alignItems:"center",mb:16},s.a.createElement(d.Cb,{color:"white",textStyle:"subheading",textAlign:"left"},"Deleted pages")),e.trashPages.map((function(t){return s.a.createElement(Jo,{key:t._id,page:t,isOwner:e.isOwner,onRestorePage:u,onDeletePage:p})}))))}))),e.trashPages.length&&s.a.createElement(ia,{onEmptyTrash:function(){e.isOwner&&e.trashPages.length&&a(!0)},isOwner:e.isOwner,isEmptyTrashDialogOpened:n,onDialogClick:function(t){t===Ho.Confirmed&&e.isOwner&&e.trashPages.length&&e.emptyTrash(),a(!1)}}))}));Yo.displayName="Trash";var Xo=Object(a.e)(d.m).withConfig({displayName:"Trash___StyledBox2"})([":hover{.trash-page-actions{opacity:1;}}"]),Zo=Object(a.e)(d.B).withConfig({displayName:"Trash___StyledFlex"})(["opacity:0;transition:opacity 200ms ease;"]),Jo=s.a.memo((function(t){var e=t.page,i=t.isOwner,n=t.onRestorePage,o=t.onDeletePage,a=Go(Object(r.useState)(!1),2),l=a[0],c=a[1];return s.a.createElement(d.m,{mb:12,ml:"2px","data-pageid":e._id},s.a.createElement(Xo,{width:192,height:124,bg:"darkGray",borderRadius:"s",position:"relative"},s.a.createElement(Gn,{url:e.screenshot}),s.a.createElement(Zo,{className:"trash-page-actions",width:176,height:32,justifyContent:i?"space-between":"center",position:"absolute",left:8,bottom:8},l?s.a.createElement(X,{"aria-labelledby":"confirm-bin-action",danger:!0,onClick:function(t){t.preventDefault(),i&&o(e._id)}},"Yes"):s.a.createElement(X,{"aria-labelledby":"restore-page",onClick:function(t){t.preventDefault(),n(e._id)}},"Restore"),l?s.a.createElement(X,{"aria-labelledby":"deny-bin-action",onClick:function(t){t.preventDefault(),c(!1)}},"Cancel"):s.a.createElement(s.a.Fragment,null,i&&s.a.createElement(X,{"aria-labelledby":"delete-page-from-bin",dangerOnHover:!0,onClick:function(t){t.preventDefault(),c(!0)}},"Delete")))),s.a.createElement(d.m,{mt:"7px"},s.a.createElement(d.Cb,{textStyle:"small",color:"white"},e.title?e.title:"Page Title")))}));Jo.displayName="TrashPage";var Qo=Object(a.e)(d.B).withConfig({displayName:"Trash___StyledFlex2"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);&:hover{opacity:0.96;}"]),ta=Object(a.e)(d.B).withConfig({displayName:"Trash___StyledFlex3"})(["cursor:pointer;border:1px solid rgba(128,128,128,0.16);&:hover{background-color:",";opacity:0.96;& > span{color:",";}}"],(function(t){return t._css4}),(function(t){return t._css5})),ea=Object(a.e)(d.n).withConfig({displayName:"Trash___StyledButton"})(["cursor:pointer;"]),ia=s.a.memo((function(t){var e=t.onEmptyTrash,i=t.isOwner,n=t.isEmptyTrashDialogOpened,o=t.onDialogClick;return(s.a.createElement(d.B,{height:88,px:24,justifyContent:"center",alignItems:"center",position:"relative"},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,borderRadius:"xs",bg:"gray"}),n?s.a.createElement(d.B,{width:"100%",justifyContent:"space-between"},s.a.createElement(Qo,{"aria-labelledby":"empty-bin-cancel",width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(){return o(Ho.Canceled)}},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Cancel")),s.a.createElement(ta,{"aria-labelledby":"empty-bin-confirm",width:80,height:32,alignItems:"center",justifyContent:"center",bg:"white",borderRadius:"xl",onClick:function(){return o(Ho.Confirmed)},_css4:d.Ub.tomato,_css5:d.Ub.white},s.a.createElement(d.Cb,{textStyle:"small",color:"black"},"Empty"))):s.a.createElement(s.a.Fragment,null,i&&s.a.createElement(ea,{"aria-labelledby":"empty-bin",textStyle:"small",color:"white",onClick:e},"Empty bin"))))}));ia.displayName="TrashFooter";var na=Yo,oa=i("5ta/"),aa=Object(a.e)(d.B).withConfig({displayName:"CollapseButton___StyledFlex"})(["user-select:none;transition:color 200ms,border 200ms;"]),ra=function(t){var e=t.children;return(s.a.createElement(aa,{width:"100%",alignItems:"center",height:48,cursor:"pointer"},e))},sa=Object(a.e)(d.n).withConfig({displayName:"CustomizeButton"})(["width:100%;height:40px;border:solid 2px ",";border-radius:32px;"],Object(Et.themeGet)("colors.darkGray"));function la(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ca(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?la(Object(i),!0).forEach((function(e){da(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):la(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function da(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ha(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ua(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ua(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ua(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var pa=function(t){var e=t.isActive,i=t.onClick,n=ha(Object(r.useState)(!1),2),o=n[0],a=n[1];return s.a.createElement(d.m,{onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},onClick:i},s.a.createElement(ra,null,s.a.createElement(d.Cb,{textStyle:"subheading",textAlign:"left",color:!e&&o?"tomato":"white"},"Page SEO")))},ma=Object(a.e)("label").withConfig({displayName:"SeoSettings___StyledLabel"})(["color:",";",";"],(function(t){return t._css}),(function(t){return t._css2})),ga=Object(a.e)(d.I).withConfig({displayName:"SeoSettings___StyledInlineTextArea"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css3}),(function(t){return t._css4})),fa=Object(a.e)("label").withConfig({displayName:"SeoSettings___StyledLabel2"})(["color:",";",";"],(function(t){return t._css5}),(function(t){return t._css6})),va=Object(a.e)(d.I).withConfig({displayName:"SeoSettings___StyledInlineTextArea2"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css7}),(function(t){return t._css8})),ba=Object(a.e)("label").withConfig({displayName:"SeoSettings___StyledLabel3"})(["color:",";",";"],(function(t){return t._css9}),(function(t){return t._css10})),ya=Object(a.e)(d.I).withConfig({displayName:"SeoSettings___StyledInlineTextArea3"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css11}),(function(t){return t._css12})),_a=Object(a.e)(d.m).withConfig({displayName:"SeoSettings___StyledBox"})(["color:",";white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"],(function(t){return t._css13})),wa=Object(a.e)("label").withConfig({displayName:"SeoSettings___StyledLabel4"})(["",";"],(function(t){return t._css14})),ka=Object(a.e)(d.m).withConfig({displayName:"SeoSettings___StyledBox2"})(["max-width:50%;color:",";white-space:nowrap;text-overflow:ellipsis;overflow:hidden;"],(function(t){return t._css15})),Sa=Object(r.forwardRef)((function(t,e){var i=t.currentPage,n=Object(r.useContext)(rd),o=ha(Object(r.useState)(null),2),a=o[0],l=o[1],c=Object(r.useMemo)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_seo}),[window.RM.constructorRouter.me]),h=function(){var t={title:"",description:"",keywords:""};return i.seo&&(t=ca(ca({},t),i.seo)),t},u=function(){var t,e=(t=n.project.domain||n.project.user&&n.project.user.domain,oa.getDefaultSEO(i,n.project,{customDomain:Boolean(t)}));return{title:n.project.title||e.title||"",description:n.project.description||"What’s it about…",keywords:"e.g. fashion, photo"}},p=ha(Object(r.useState)((function(){return h()})),2),m=p[0],g=p[1],f=ha(Object(r.useState)((function(){return u()})),2),v=f[0],b=f[1];Object(r.useEffect)((function(){b(u()),g(h())}),[i]),Object(r.useEffect)((function(){b(u())}),[n.project.title,n.project.description]);var y=function(t){var e=t.target,i=e.dataset.name;i&&void 0!==m[i]&&g((function(t){return ca(ca({},t),da({},i,e.value))}))},_=function(){var t=n.pageSave(i._id,{seo:m},{patch:!0});!t||t instanceof Error||t.done((function(t){})).fail((function(){}))},w=Object(r.useMemo)((function(){return n.pagesParams[i._id]?n.pagesParams[i._id].viewNum.toString():""}),[i._id,n.pagesParams[i._id]]),k=Object(r.useRef)(null),S=Object(r.useCallback)((function(t){t!==i.uri&&n.pageSave(i._id,{uri:t},{patch:!0})}),[i._id]),x=Object(r.useCallback)((function(t){return n.validatePageUri(i._id,t)}),[i._id]),O=Object(r.useCallback)((function(t){return t.replace(/[^A-Za-z0-9_.+-]/g,"")}),[]),j=Object(r.useMemo)((function(){return z(n.project)}),[n.project.is_published,n.project.changed]),P=Object(r.useMemo)((function(){return"".concat(D.a.readymag_host,"/").concat(n.project.user.uri,"/").concat(n.project.uri,"/")}),[n.project.uri,n.project.user.uri]),E=Object(r.useMemo)((function(){return"".concat(P,"num/").concat(i.num_id,"/")}),[P,i.num_id]);return s.a.createElement(d.m,{ref:e,mx:24},s.a.createElement(d.m,{mt:"12px"},s.a.createElement(ma,{htmlFor:"page-seo-title",_css:c?d.Ub.white:d.Ub.darkGray,_css2:Object(Et.themeGet)("textStyles.small")},"Title"),s.a.createElement(ga,{name:"page-seo-title","data-name":"title",color:"white",placeholder:v.title,translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:128,rows:1,autoSize:!0,mt:"4px",disabled:!c,value:m.title,onChange:y,onBlur:_,_css3:d.Ub.darkGray,_css4:d.Ub.darkGray})),s.a.createElement(d.m,{mt:"22px"},s.a.createElement(fa,{htmlFor:"page-seo-description",_css5:c?d.Ub.white:d.Ub.darkGray,_css6:Object(Et.themeGet)("textStyles.small")},"Description"),s.a.createElement(va,{name:"page-seo-description","data-name":"description",color:"white",placeholder:v.description,translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:2048,rows:1,autoSize:!0,mt:"4px",disabled:!c,value:m.description,onChange:y,onBlur:_,_css7:d.Ub.darkGray,_css8:d.Ub.darkGray})),s.a.createElement(d.m,{mt:"22px"},s.a.createElement(ba,{htmlFor:"page-seo-keywords",_css9:c?d.Ub.white:d.Ub.darkGray,_css10:Object(Et.themeGet)("textStyles.small")},"Keywords"),s.a.createElement(ya,{name:"page-seo-keywords","data-name":"keywords",color:"white",placeholder:v.keywords,translate:"no",spellCheck:!1,autoComplete:"off",autoCorrect:"off",rows:1,autoSize:!0,mt:"4px",disabled:!c,value:m.keywords,onChange:y,onBlur:_,_css11:d.Ub.darkGray,_css12:d.Ub.darkGray})),s.a.createElement(d.m,{mt:"22px"},s.a.createElement(_a,{width:"100%",_css13:c?d.Ub.white:d.Ub.darkGray},s.a.createElement(wa,{htmlFor:"page-link",title:"".concat(F(n.project),"/"),_css14:Object(Et.themeGet)("textStyles.small")},"".concat(F(n.project),"/"))),s.a.createElement(d.B,{flexWrap:"nowrap",ref:k},s.a.createElement(ka,{_css15:c?d.Ub.white:d.Ub.darkGray},s.a.createElement(d.Cb,{fontSize:"regular"},n.project.uri,i.parentPage&&n.pagesParams[i.parentPage]?"/".concat(n.pagesParams[i.parentPage].uri):null)),s.a.createElement(Ft,{validationMessageAnchor:k.current,validationMessageContainer:document.body,name:"page-link",color:"white",textStyle:"regular",disabled:!c,placeholder:w,inactiveColor:d.Ub.darkGray,link:i&&i.uri?i.uri:"",validationMessageZIndex:Q,validate:x,filter:O,onDone:S,maxWidth:"50%",withSlash:!0,key:i._id}))),j!==C.Unpublished&&s.a.createElement($t,{link:E,m:"22px 0 0 0",color:"white",borderColor:"darkGray"}),s.a.createElement(sa,{textStyle:"small",color:"white",mt:24,display:c?"none":"block",onClick:function(t){t.preventDefault(),function(){a&&a.remove();var t=new Qi.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-seo",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"custom seo"});t.render(),l(t)}()}},"Customize"))}));Sa.displayName="SeoSettings";var xa,Ca=s.a.memo(Sa);function Oa(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ja(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Oa(Object(i),!0).forEach((function(e){Pa(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Oa(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Pa(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ea(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ia(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Ea(a,n,o,r,s,"next",t)}function s(t){Ea(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Ta(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ma(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ma(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ma(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.Default="default",t.Custom="custom",t.Inherited="inherited"}(xa||(xa={}));var $a=function(t){var e=t.isActive,i=t.onClick,n=Ta(Object(r.useState)(!1),2),o=n[0],a=n[1];return s.a.createElement(d.m,{width:"100%",height:48,position:"relative",onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},onClick:i},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,left:-16,borderRadius:"xs",bg:"darkGray"}),s.a.createElement(ra,null,s.a.createElement(d.m,{position:"relative",bottom:"2px"},s.a.createElement(d.Cb,{textStyle:"subheading",textAlign:"left",color:!e&&o?"tomato":"white"},"Social sharing"))))},Aa=Object(a.e)(d.m).withConfig({displayName:"SocialSettings___StyledBox"})(["&:hover{& svg{color:",";}}"],(function(t){return t._css})),Ra=Object(a.e)(d.B).withConfig({displayName:"SocialSettings___StyledFlex"})(["box-shadow:0 0 0 1px rgba(128,128,128,0.16);animation:"," 2s infinite linear;@keyframes loadingindicatoranimation{from{transform:rotateZ(0deg);}to{transform:rotateZ(360deg);}}"],(function(t){return t._css2})),Da=Object(a.e)(d.I).withConfig({displayName:"SocialSettings___StyledInlineTextArea"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css3}),(function(t){return t._css4})),Ba=Object(a.e)(d.I).withConfig({displayName:"SocialSettings___StyledInlineTextArea2"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css5}),(function(t){return t._css6})),La=Object(a.e)("label").withConfig({displayName:"SocialSettings___StyledLabel"})(["color:",";",";"],(function(t){return t._css7}),(function(t){return t._css8})),za=Object(a.e)(d.I).withConfig({displayName:"SocialSettings___StyledInlineTextArea3"})(["&::placeholder{color:",";}&:disabled{color:",";}"],(function(t){return t._css9}),(function(t){return t._css10})),Fa=Object(a.e)("label").withConfig({displayName:"SocialSettings___StyledLabel2"})(["color:",";",";"],(function(t){return t._css11}),(function(t){return t._css12})),Ua=Object(r.forwardRef)((function(t,e){var i=t.currentPage,n=Object(r.useContext)(rd),o=Ta(Object(r.useState)(null),2),a=o[0],l=o[1],c=Object(r.useMemo)((function(){return!!window.RM.constructorRouter.me&&!!(window.RM.constructorRouter.me.get("permissions")||{}).custom_sharing}),[window.RM.constructorRouter.me]),u=Ta(Object(r.useState)((function(){return n.project.master_share_pid||null})),2),p=u[0],m=u[1],g=function(){var t=i;return p?p===t._id?xa.Custom:xa.Inherited:t.custom_shares?xa.Custom:xa.Default},f=Ta(Object(r.useState)(g()),2),v=f[0],b=f[1],y=Object(r.useMemo)((function(){return!c||v===xa.Inherited}),[v,c]),_=function(t){if(t.custom_shares){var e=t.custom_shares;if(!e.image){var i=ie.default.screenshotSize(512),n=ie.default.addFilenameComponent(t.screenshot,i);e.image=n}return e}return{description:"",title:"",tweet:"",image:""}},w=function(){var t=n.project.domain||n.project.user&&n.project.user.domain;return oa.getDefaultShare(i,n.project,{customDomain:Boolean(t)})},k=function(){var t=i,e=w();if(p){if(p===t._id)return _(t);var o=n.pages.find((function(t){return t._id===p}));if(o)return _(o)}else if(t.custom_shares)return _(t);return e},S=Ta(Object(r.useState)((function(){return k()})),2),x=S[0],C=S[1];Object(r.useEffect)((function(){return C(k()),b(g()),function(){C(null),b(xa.Default)}}),[i]);var O=function(t){return n.pageSave(i._id,{custom_shares:t||x})},j=Ta(Object(r.useState)(!1),2),P=j[0],E=j[1],I=Ta(Object(r.useState)(!1),2),T=I[0],M=I[1],$=Ta(Object(r.useState)(!1),2),A=$[0],R=$[1],B=Object(r.useMemo)((function(){if(x&&x.image){var t=oa.removeFilenameComponent(x.image);return i.screenshot!==t}return!1}),[x,i.screenshot]),L=Ta(Object(r.useState)(!1),2),z=L[0],F=L[1],U=Ta(Object(r.useState)(!1),2),N=U[0],H=U[1],V=Ta(Object(r.useState)(!1),2),W=V[0],G=V[1],q=Ta(Object(r.useState)(!1),2),K=q[0],Y=q[1],X=function(){var t=Ia(regeneratorRuntime.mark((function t(e){var i,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(R(!1),!(e.size>D.a.UPLOAD_IMAGE_SIZE_LIMIT)){t.next=4;break}return window.alert(D.a.MSG_UPLOAD_IMAGE_SIZE_ERROR),t.abrupt("return");case 4:if(!T){t.next=6;break}return t.abrupt("return");case 6:return M(!0),t.prev=7,t.next=10,Object(nt.T)("share-upload",e);case 10:(i=t.sent)&&i.picture&&i.picture.url&&x&&(n=ja(ja({},x),{},{image:i.picture.url}),!(o=O(n))||o instanceof Error||o.then((function(){C((function(t){return ja(ja({},t),n)})),v===xa.Default&&b(xa.Custom)})).always((function(){M(!1)}))),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(7),M(!1);case 17:case"end":return t.stop()}}),t,null,[[7,14]])})));return function(e){return t.apply(this,arguments)}}(),Z=function(){var t=Ia(regeneratorRuntime.mark((function t(e){var i,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),i=w(),n=ja(ja({},x),{},{image:i.image}),!(o=O(n))||o instanceof Error||o.done((function(){return C((function(t){return ja(ja({},t),n)}))}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),J=function(t){var e=t.target,i=e.getAttribute("name");i&&x&&void 0!==x[i]&&C((function(t){return ja(ja({},t),Pa({},i,e.value))}))},Q=function(t){if(x){var e=O();!e||e instanceof Error||e.done((function(){v===xa.Default&&b(xa.Custom)})).fail((function(){}))}},tt=Object(r.useMemo)((function(){return Boolean(i&&p&&i._id===p)}),[i,p]),et=function(){n.pageUnset(i._id,"custom_shares");var t=n.pageSave(i._id,{});!t||t instanceof Error||t.done((function(){C(w()),b(xa.Default)})).fail((function(){}))};return s.a.createElement(d.m,{ref:e,mx:24,pb:24},s.a.createElement(d.m,{mt:"10px",position:"relative"},s.a.createElement(d.Cb,{color:"white",textStyle:"small"},"OpenGraph"),s.a.createElement(Aa,{position:"absolute",right:0,top:5,_css:d.Ub.tomato},s.a.createElement("a",{href:"https://help.readymag.com/hc/en-us/articles/360020844431-Sharing",target:"_blank",rel:"noopener noreferrer"},s.a.createElement(d.fb,{color:"darkGray"})))),s.a.createElement(d.m,{width:192,height:104,mt:"12px",position:"relative",opacity:A?.8:1,onDragEnter:function(){A||R(!0)},onDragLeave:function(){A&&R(!1)},onMouseEnter:function(){return E(!0)},onMouseLeave:function(){return E(!1)}},s.a.createElement(d.A,{accept:"image/*",dropFile:!0,readFileData:!1,onChange:X,disabled:y},s.a.createElement(s.a.Fragment,null,s.a.createElement(d.m,{width:192,height:104,bg:"darkGrey",borderRadius:"s",position:"relative",cursor:c&&!y?"pointer":"default",boxShadow:"0 1px 1px rgba(64, 64, 64, 0.32)"},s.a.createElement(d.v,{width:"100%",height:"100%",borderRadius:"s",backgroundImage:x&&x.image?"url(".concat(x.image,")"):"none",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"})),(P||T)&&!A&&s.a.createElement(d.B,{width:96,height:32,position:"absolute",left:0,right:0,bottom:8,m:"auto",justifyContent:"space-around",cursor:"default"},!y&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Ra,{width:32,height:32,justifyContent:"center",alignItems:"center",onMouseEnter:function(){return F(!0)},onMouseLeave:function(){return F(!1)},onMouseDown:function(){return H(!0)},onMouseUp:function(){return H(!1)},bg:N?"tomato":"white",borderRadius:"round",cursor:T?"default":"pointer",_css2:T?"loadingindicatoranimation":"none"},s.a.createElement(d.gb,{color:N?"white":z&&!T?"tomato":"black"})),B&&!T&&s.a.createElement(d.ib,{size:32,color:"white",hoverColor:"white",activeColor:"tomato",outline:!0,onMouseEnter:function(){return G(!0)},onMouseLeave:function(){return G(!1)},onMouseDown:function(){return Y(!0)},onMouseUp:function(){return Y(!1)},onClick:Z,disabled:T},s.a.createElement(d.w,{color:K?"white":W?"tomato":"black"}))))))),s.a.createElement(d.m,{mt:"4px"},s.a.createElement(Da,{name:"title",placeholder:"Title",translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:128,rows:1,autoSize:!0,color:"white",textStyle:"regular",disabled:y,value:x&&x.title?x.title:void 0,onChange:J,onBlur:Q,_css3:d.Ub.darkGray,_css4:d.Ub.darkGray})),s.a.createElement(d.m,null,s.a.createElement(Ba,{name:"description",placeholder:"Description",translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:2048,autoSize:!0,rows:1,color:"white",textStyle:"small",disabled:y,value:x&&x.description?x.description:void 0,onChange:J,onBlur:Q,_css5:d.Ub.darkGray,_css6:d.Ub.darkGray})),s.a.createElement(d.m,{mt:"22px"},s.a.createElement(La,{htmlFor:"share-tweet",_css7:Object(Et.themeGet)("colors.white"),_css8:Object(Et.themeGet)("textStyles.small")},"Tweet message"),s.a.createElement(za,{name:"tweet",translate:"no",autoComplete:"off",autoCorrect:"off",maxLength:116,rows:1,autoSize:!0,mt:"4px",color:"white",textStyle:"regular",disabled:y,value:x&&x.tweet?x.tweet:void 0,onChange:J,onBlur:Q,_css9:d.Ub.darkGray,_css10:d.Ub.darkGray})),s.a.createElement(d.B,{mt:"22px",alignItems:"center",justifyContent:"space-between"},s.a.createElement(d.m,{width:"128px"},s.a.createElement(Fa,{htmlFor:"all-pages",_css11:Object(Et.themeGet)("colors.white"),_css12:Object(Et.themeGet)("textStyles.small")},"Use these sharing settings for all pages")),s.a.createElement(d.zb,{name:"all-pages",disabled:y||!function(){return Object(r.useMemo)((function(){return!p||tt}),[tt,p])},checked:tt,onChange:function(t){if(t){if(m(i._id),n.projectSave({master_share_pid:i._id}),h.d.sendEvent(h.b.MasterPageSharing,{eventLabel:"on page ".concat(i.num_id)}),!i.custom_shares){var e=w(),o=n.pageSave(i._id,{custom_shares:e});!o||o instanceof Error||o.done((function(){C(e),b(xa.Custom)}))}}else m(null),n.projectUnset("master_share_pid"),n.projectSave({}),h.d.sendEvent(h.b.MasterPageSharing,{eventLabel:"off page ".concat(i.num_id)})}})),s.a.createElement(d.B,{mt:"2px"},s.a.createElement(sa,{textStyle:"small",color:"white",mt:"24px",display:c?"none":"block",onClick:function(t){t.preventDefault(),function(){a&&a.remove();var t=new Qi.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-custom-sharing",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:n.project.user?n.project.user.email:""},alert_source:"custom sharing"});t.render(),l(t)}()}},"Customize"),s.a.createElement(sa,{textStyle:"small",color:"white",mt:"24px",display:c&&v===xa.Custom?"block":"none",onClick:function(t){if(t.preventDefault(),p){n.projectUnset("master_share_pid");var e=n.projectSave({});!e||e instanceof Error||e.done((function(){m(null),et()}))}else et();h.d.sendEvent(h.b.RestoreDefaultsSharing,{eventLabel:"page ".concat(i.num_id)})}},"Restore to defaults"),s.a.createElement(sa,{textStyle:"small",color:"white",mt:"24px",display:c&&v===xa.Inherited?"block":"none",onClick:function(t){t.preventDefault(),p&&(window.RM.constructorRouter.showWorkspace({id:p}),n.scrollToPage(p))}},"Go to master page")))}));Ua.displayName="SocialSettings";var Na=s.a.memo(Ua),Ha=i("3Qzt");function Va(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Wa(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Wa(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wa(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ga=Object(a.e)(d.m).withConfig({displayName:"PageSettings___StyledBox"})(["z-index:",";transform:translateX( "," );transition:transform "," ease;"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3})),qa=Object(a.e)(d.n).withConfig({displayName:"PageSettings___StyledButton"})(["&:hover{color:",";}"],(function(t){return t._css4})),Ka=function(){var t=Object(r.useContext)(k),e=Object(r.useContext)(rd),i=Va(Object(r.useState)(null),2),n=i[0],a=i[1];Object(r.useEffect)((function(){var i=t.isPageSettingsOpened&&e.pages.find((function(t){return t._id===e.currentPageId}))||null;return a(i),function(){a(null)}}),[t.isPageSettingsOpened,e.currentPageNum,e.currentPageId]),Object(r.useEffect)((function(){if(t.isPageSettingsOpened){var i=e.pages.find((function(t){return t._id===e.currentPageId}))||null;return a(i),function(){a(null)}}}),[e.pages]);var l=Va(Object(r.useState)(!1),2),c=l[0],u=l[1];Object(r.useEffect)((function(){t.isPageSettingsOpened?(t.isTrashOpened&&(u(!0),setTimeout((function(){t.dispatch({type:o.ToggleTrash}),u(!1)}),0)),document.body.classList.add("page-settings-is-opened")):(c&&u(!1),document.body.classList.remove("page-settings-is-opened"))}),[t.isPageSettingsOpened]);return s.a.createElement(Ga,{id:"constructor-page-settings",height:"100%",width:240,p:0,position:"fixed",top:0,right:0,bottom:0,bg:"black",overflow:"hidden",_css:c?Z+1:Z,_css2:t.isSettingsOpened?t.isPageSettingsOpened?"0":"240px":t.isPageSettingsOpened?"480px":"240px",_css3:t.isTrashOpened?"0":tt},s.a.createElement(d.m,{width:"100%",height:"calc(100% - 88px)",pt:28},n&&s.a.createElement(d.a,{springConfig:{easing:Ha.a.easeInCubic}},s.a.createElement(d.r,{renderButton:function(t){var e=t.isActive;return(s.a.createElement(pa,{isActive:e,onClick:function(){!e&&h.d.sendEvent(h.b.PageSEOOpen)}}))},buttonPadding:"0 24px",open:!0},(function(t){return s.a.createElement(Ca,{ref:t,currentPage:n})})),s.a.createElement(d.r,{renderButton:function(t){var e=t.isActive;return(s.a.createElement($a,{isActive:e,onClick:function(){!e&&h.d.sendEvent(h.b.PageSharingOpen)}}))},buttonPadding:"0 24px"},(function(t){return s.a.createElement(Na,{ref:t,currentPage:n})})))),s.a.createElement(d.B,{position:"relative",width:"100%",height:88,justifyContent:"center",alignItems:"center"},s.a.createElement(d.m,{width:224,height:2,position:"absolute",top:-1,left:8,borderRadius:"xs",bg:"darkGray"}),s.a.createElement(qa,{textStyle:"small",variant:"primary","aria-labelledby":"close-page-settings",onClick:function(){t.dispatch({type:o.TogglePageSettings})},_css4:d.Ub.tomato},"Close page settings")))},Ya=Object(a.e)(d.B).withConfig({displayName:"ToolbarButton___StyledFlex"})(["cursor:pointer;backdrop-filter:blur(3px);display:",";",""],(function(t){return t._css}),(function(t){return t._css2})),Xa=function(t){var e=t.id,i=t.hidden,n=t.width,o=t.onClick,a=t.onMouseEnter,r=t.onMouseLeave,l=t.className,c=t.children,h=t.ml,u=t.bg,p=t.disableHover,m=void 0!==p&&p,g=t.color,f=t.disabled,v=t.tooltip,b=t.tooltipPosition,y=t.tooltipDisabled,_=t.tooltipModifiers,w=t.tooltipPadding,k=t.forceTooltip,S=t["aria-labelledby"],x=s.a.createElement(Ya,{className:l,width:n||56,height:56,alignItems:"center",justifyContent:"center",borderRadius:30,color:g||f?"gray":"white",bg:u||Object(V.e)(.12,k?d.Ub.black:d.Ub.darkGray),_css:i?"none":"flex",_css2:m?"":"\n          &:hover {\n            background: ".concat(Object(V.e)(.12,f?d.Ub.darkGray:d.Ub.black),";\n          }\n        ")},c);return s.a.createElement(d.B,{onMouseEnter:a,onMouseLeave:r,id:e,"aria-labelledby":S,onClick:o,ml:h},v?s.a.createElement(d.Eb,{key:v,text:v,modifiers:_,position:b||"top",indent:4,disabled:y,p:w,bg:Object(V.e)(.08,d.Ub.black),show:!!k||void 0},x):x)};function Za(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ja(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ja(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ja(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Qa=Object(a.f)(["0%{opacity:1;}50%{opacity:0;}"]),tr=Object(a.e)(d.m).withConfig({displayName:"CollaboratorLock___StyledBox"})(["display:inline;animation:"," 2.4s infinite steps(1) ","s;"],Qa,(function(t){return t._css})),er=function(t){var e=t.index,i=void 0===e?0:e;return(s.a.createElement(tr,{_css:.4*i},"."))},ir=Object(a.e)(Xa).withConfig({displayName:"CollaboratorLock___StyledToolbarButton"})(["position:relative;width:auto;padding-right:30px;&:hover{background:",";}"],(function(t){return t._css2})),nr=Object(a.e)(d.hb).withConfig({displayName:"CollaboratorLock___StyledResponsiveAvatar"})(["width:54px;height:54px;margin-left:1px;"]),or=Object(a.e)(d.B).withConfig({displayName:"CollaboratorLock___StyledFlex"})(["flex-direction:column;margin-left:16px;"]),ar=Object(a.e)(d.m).withConfig({displayName:"CollaboratorLock___StyledBox2"})(["position:absolute;left:0;right:0;top:0;bottom:0;border-radius:28px;line-height:56px;text-align:center;"]),rr=function(t){var e=t.iAmOwner,i=t.name,n=t.avatarUrl,o=Object(r.useContext)(rd),a=Za(Object(r.useState)(!1),2),l=a[0],c=a[1];return s.a.createElement(ir,{ml:2,onClick:function(){},onMouseEnter:function(){return e&&c(!0)},onMouseLeave:function(){return c(!1)},_css2:Object(Et.themeGet)(l?"colors:black":"colors.darkGray")},s.a.createElement(nr,{size:"medium",url:n,name:i}),s.a.createElement(or,null,s.a.createElement(d.Cb,{color:"white",lineHeight:"1"},i),s.a.createElement(d.Cb,{color:"gray",lineHeight:"1"},"editing now",s.a.createElement(er,{index:0}),s.a.createElement(er,{index:1}),s.a.createElement(er,{index:2}))),l&&s.a.createElement(ar,{color:"white",bg:"black",onClick:function(){return o.takeOverCurrentPage()}},"Take Over"))};function sr(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function lr(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){sr(a,n,o,r,s,"next",t)}function s(t){sr(a,n,o,r,s,"throw",t)}r(void 0)}))}}var cr=Object(a.e)(d.B).withConfig({displayName:"PublishButton___StyledFlex"})(["backdrop-filter:blur(3px);&:hover{background:",";}"],(function(t){return t._css})),dr=Object(a.e)(d.Cb).withConfig({displayName:"PublishButton___StyledText"})(["display:block;line-height:52px;height:56px;text-decoration:none;color:inherit;",""],(function(t){return t._css2})),hr=function(t){var e=t.m,i=Object(r.useContext)(rd),n=Object(r.useContext)(k),a=z(i.project),l=Object(r.useCallback)((function(){var t=Object(f.a)("constructor.canUseFormPermission")?"Injected Code, Forms and Shots will not work in Published project.":"Injected Code and Shots will not work in Published project.";!i.hasPermission(L.canInjectCode)&&i.hasCustomCode()?n.dispatch({type:o.SetNotice,notice:{message:t,tag:H.customCode}}):!i.hasPermission(L.canUseShots)&&i.hasShots()?n.dispatch({type:o.SetNotice,notice:{message:t,tag:H.shots}}):!i.hasPermission(L.canUseForms)&&i.hasForms()&&n.dispatch({type:o.SetNotice,notice:{message:t,tag:H.forms}})}),[]),c=Object(r.useCallback)((function(){!i.publishInProgress&&a!==C.SameAsPublished&&n.dispatch({type:o.SetNotice,notice:void 0})}),[i.publishInProgress,a]),h="".concat(D.a.readymag_host,"/").concat(i.project.user.uri,"/").concat(i.project.uri,"/"),u=!i.isPublishError&&!i.publishInProgress&&a===C.SameAsPublished,p=Object(r.useCallback)(lr(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a===C.SameAsPublished||i.publishInProgress){t.next=20;break}return n.dispatch({type:o.SetNotice,notice:void 0}),t.prev=2,t.next=5,i.publishWithNotice({fromPreview:n.inPreview});case 5:t.next=20;break;case 7:if(t.prev=7,t.t0=t.catch(2),!(t.t0 instanceof W&&"warning"===t.t0.type)){t.next=15;break}return t.next=12,i.publishWithNotice({skipWarnings:!0,fromPreview:n.inPreview});case 12:n.dispatch({type:o.SetNotice,notice:t.t0}),t.next=20;break;case 15:if(!(t.t0 instanceof W)){t.next=19;break}n.dispatch({type:o.SetNotice,notice:t.t0}),t.next=20;break;case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[2,7]])}))),[a,i.publishInProgress]);return s.a.createElement(cr,{id:"publish-button",width:149,height:56,m:e,alignItems:"center",justifyContent:"center",borderRadius:30,bg:Object(V.e)(.12,d.Ub.darkGray),color:"white",position:"relative",cursor:"pointer",onMouseEnter:u?function(){}:l,onMouseLeave:u?function(){}:c,onClick:p,_css:Object(V.e)(.12,d.Ub.black)},s.a.createElement(dr,{textStyle:"regular",textAlign:"center",is:u?"a":"span",href:u?h:void 0,target:"_blank",_css2:u?"position: absolute; top: 0; right: 0; bottom: 0; left: 0;":""},i.isPublishError?"Error":i.publishInProgress?s.a.createElement(d.Q,{bgColor:"transparent"}):a===C.SameAsPublished?"Open":a===C.UnpublishedChanges?"Republish":"Publish"))},ur=i("jIIB");function pr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return mr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return mr(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var gr,fr=function(t){var e=t.previewOnly,i=t.hidden,n=Object(r.useContext)(k),a=pr(Object(r.useState)(!1),2),l=a[0],c=a[1],h=e||n.inPreview,u=Object(r.useCallback)((function(){var t=n.inPreview?"Out":n.isSettingsOpened?"In: settings opened":"In: settings closed";window.RM.constructorRouter.togglePreview(t)}),[n.inPreview,n.isSettingsOpened]),p=function(){!e&&n.dispatch({type:o.TogglePreview})};return Object(r.useEffect)((function(){return window.RM.constructorRouter.unbindGlobalKeyPress("p",u),window.RM.constructorRouter.bindGlobalKeyPress({key:"p",handler:u}),n.inPreview?(window.RM.constructorRouter.off("previewOpen",p),window.RM.constructorRouter.on("previewClose",p)):(window.RM.constructorRouter.off("previewClose",p),window.RM.constructorRouter.on("previewOpen",p)),function(){window.RM.constructorRouter.unbindGlobalKeyPress("p",u),window.RM.constructorRouter.off("previewOpen",p),window.RM.constructorRouter.off("previewClose",p)}}),[n.inPreview]),s.a.createElement(Xa,{id:"preview-toggle-button",tooltip:h?"Edit (P)":"Preview (P)",tooltipDisabled:l,ml:2,hidden:i,onMouseEnter:function(){return l&&c(!1)},onClick:function(){u(),c(!0)}},h?s.a.createElement(d.y,{preserveAspectRatio:"none",width:38,height:38}):s.a.createElement(d.z,{height:"26px",width:"38px"}))},vr=i("IwqK");function br(){return(br=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function yr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return _r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function wr(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}!function(t){t.connection="connection",t.socket="socket",t.none="none"}(gr||(gr={}));var kr={connection:"Seems there is a connection problem. Changes may not be saved until this\n  alert disappears.",socket:"You have been disconnected from the server.",duplicate:"It seems like you’ve opened this project in another tab or browser. We’ve\n  interrupted this session in order to avoid conflicting copies.",none:"unknown alert"},Sr=Object(a.e)(d.B).withConfig({displayName:"ConnectionAlert___StyledFlex"})(["transform:",";"],(function(t){return t._css})),xr=Object(a.e)(d.n).withConfig({displayName:"ConnectionAlert___StyledButton"})(["&:hover{color:",";background:",";}"],(function(t){return t._css2}),(function(t){return t._css3})),Cr=function(t){var e=t.transform,i=t.position,n=void 0===i?"fixed":i,o=t.zIndex,a=void 0===o?Q:o,l=wr(t,["transform","position","zIndex"]),h=yr(Object(r.useState)(gr.none),2),u=h[0],p=h[1],m=function(){return p(gr.connection)},g=function(){return p(gr.socket)},f=function(){return p(gr.none)},v=Object(r.useMemo)((function(){return kr[u]}),[u]);Object(r.useEffect)((function(){return window.RM.constructorRouter.on("showConnectionAlert",m),window.RM.constructorRouter.on("showSocketConnectionAlert",g),window.RM.constructorRouter.on("hideConnectionAlert",f),window.RM.constructorRouter.on("hideSocketConnectionAlert",f),function(){window.RM.constructorRouter.off("showConnectionAlert",m),window.RM.constructorRouter.off("showSocketConnectionAlert",g),window.RM.constructorRouter.off("hideConnectionAlert",f),window.RM.constructorRouter.off("hideSocketConnectionAlert",f)}}),[window.RM.constructorRouter]);var b=yr(Object(r.useState)(null),2),y=b[0],_=b[1],w=yr(Object(r.useState)(null),2),k=w[0],S=w[1],x=yr(Object(r.useState)(!0),2),C=x[0],O=x[1],j=Object(vr.a)(y,k,{placement:"top"}),P=j.styles,E=j.attributes,I=j.update,T=u===gr.socket,M=u!==gr.none;Object(r.useEffect)((function(){I&&I()}),[u]);var $=document.querySelector("#settings-container");return $&&M?c.a.createPortal(s.a.createElement(s.a.Fragment,null,T?s.a.createElement(d.Z,{zIndex:Q-1,bg:"black",opacity:.2}):null,s.a.createElement(Sr,br({position:n,zIndex:a},l,{_css:e}),C&&s.a.createElement(d.m,br({width:276,p:16,mb:18,borderRadius:"s",textAlign:"center",bg:"white",boxShadow:"0 0 0 1px rgba(0, 0, 0, 0.08)",ref:S,style:P.popper},E.popper),s.a.createElement(d.m,null,s.a.createElement(d.Cb,{display:"block",textStyle:"regular"},v)),T&&s.a.createElement(xr,{mt:12,width:88,height:38,borderRadius:"s",bg:"tomato",color:"white",onClick:function(){return window.location.reload()},_css2:Object(Et.themeGet)("colors.white"),_css3:Object(Et.themeGet)("colors.black")},"Reload")),s.a.createElement(d.m,{ref:_},s.a.createElement(d.ib,{size:56,mr:0,color:"tomato",onClick:function(){return O(!C)}},s.a.createElement(d.L,{color:"white"}))))),$):null},Or=i("31/U"),jr=Object(a.e)(d.B).withConfig({displayName:"Toolbar___StyledFlex"})(["transition:transform "," ease;transform:",";"],(function(t){return t._css}),(function(t){return t._css2})),Pr=function(t){var e,i=t.transform,n=t.previewOnly,o=t.className,a=Object(r.useContext)(rd),l=Object(r.useContext)(k),c=n||l.inPreview,d=a.lockedPages[a.currentPageId],h=d&&d!==(null===(e=window.RM.constructorRouter.me)||void 0===e?void 0:e.get("uri"))?a.collaborators.find((function(t){return t.uri===d})):void 0,u=Object(r.useMemo)((function(){var t;return(null===(t=a.me.ab_flags)||void 0===t?void 0:t.constructor_show_double_settings_btn)&&l.isSettingsOpened?116:80}),[l.isSettingsOpened]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(jr,{className:o||"settings-toolbar",justifyContent:"space-between",position:"fixed",right:u,bottom:16,zIndex:Z,_css:tt,_css2:i},!c&&s.a.createElement(Cr,{bottom:16,right:144,transform:i}),!c&&h&&s.a.createElement(rr,{iAmOwner:a.isOwner,name:h.name,avatarUrl:h.pic}),!c&&s.a.createElement(Or.a,null),c&&l.readyToPublish&&s.a.createElement(hr,{m:"0 0 0 8px"}),s.a.createElement(fr,{previewOnly:n})),(l.isSettingsOpened||l.inPreview)&&l.notice&&s.a.createElement(ur.a,{position:"fixed",left:16,bottom:16,visible:!0,isTip:!1,helpBtn:!1,message:l.notice.message,zIndex:Z+1}))};function Er(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ir(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Er(Object(i),!0).forEach((function(e){Tr(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Er(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Tr(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Mr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return $r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ar=s.a.createContext({}),Rr=function(t){var e=t.me,i=t.children,n=Mr(Object(r.useState)(Ir({},null==e?void 0:e.attributes.behavior_metrics)),2),o=n[0],a=n[1];return s.a.createElement(Ar.Provider,{value:{metrics:o,changeMetrics:function(t){a(Ir(Ir({},o),t)),null==e||e.save({behavior_metrics:Ir(Ir({},e.get("behavior_metrics")||{}),t)},{patch:!0})}}},i)};function Dr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Br(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Br(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Lr=function(t){var e=t.width,i=t.height;return(s.a.createElement("svg",{width:e,height:i,viewBox:"0 0 34 30",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M11.738 1a5 5 0 00-4.35 2.5l-5.149 8.918a5 5 0 00.01 5.017l5.267 9.04a5 5 0 004.301 2.484L22.28 29a5 5 0 004.35-2.5l5.149-8.918a5 5 0 00-.01-5.017l-5.267-9.04A5 5 0 0022.2 1.04l-10.463-.04zm5.273 9a5 5 0 110 10 5 5 0 010-10z",stroke:"#FFF",strokeWidth:"2",fill:"none",fillRule:"evenodd"})))},zr=Object(a.e)(d.Cb).withConfig({displayName:"SettingsToggle___StyledText"})(["font-weight:700;"]),Fr=function(t){var e,i,n=t.onMouseEnter,a=Object(r.useContext)(k),l=Object(r.useContext)(rd),c=Object(r.useContext)(Ar),h=Dr(Object(r.useState)(""),2),u=h[0],p=h[1],m=Dr(Object(r.useState)(""),2),f=m[0],v=m[1],b=Dr(Object(r.useState)(a.isSettingsOpened&&!(null===(e=c.metrics)||void 0===e?void 0:e.projectSettingsTooltipSeen)),2),y=b[0],_=b[1];Object(r.useEffect)((function(){var t=l.currentPageId,e=l.pagesParams;e[t]&&(e[t].parentId?(p("".concat(e[e[t].parentId].viewNum)),v("".concat(e[t].viewNum))):(p("".concat(e[t].viewNum)),f&&v("")))}),[l.currentPageNum,l.currentPageId]);var w=Dr(Object(r.useState)(!1),2),S=w[0],x=w[1];Object(r.useEffect)((function(){S&&setTimeout((function(){return x(!1)}),2e3)}),[S]);var C=Object(r.useCallback)((function(){a.dispatch({type:o.ToggleSettingsSidebar})}),[]),O=Object(r.useCallback)((function(){x(!0),a.isSettingsOpened?a.isProjectSettingsOpened?a.dispatch({type:o.SetProjectSettingsState,payload:!1}):a.dispatch({type:o.SetProjectSettingsState,payload:!0}):a.dispatch({type:o.OpenSettingsSidebar})}),[a.isSettingsOpened,a.isProjectSettingsOpened]);return Object(r.useEffect)((function(){return g.a.on("shortcut:m",C),function(){g.a.off("shortcut:m",C)}}),[]),Object(r.useEffect)((function(){var t;a.isSettingsOpened?_(!(null===(t=c.metrics)||void 0===t?void 0:t.projectSettingsTooltipSeen)):!a.isSettingsOpened&&y&&(_(!1),c.changeMetrics({projectSettingsTooltipSeen:!0}))}),[a.isSettingsOpened,null===(i=c.metrics)||void 0===i?void 0:i.projectSettingsTooltipSeen,y]),s.a.createElement(Xa,{id:"settings-toggle-button","aria-labelledby":a.isSettingsOpened?a.isProjectSettingsOpened?"open-page-settings":"open-project-settings":"open-page-settings",tooltip:a.isSettingsOpened?a.isProjectSettingsOpened?"Pages menu":"Project settings":"Menu (M)",tooltipDisabled:S,tooltipPadding:"0 12px",forceTooltip:a.isSettingsOpened&&y,onMouseEnter:n,onClick:O},a.isSettingsOpened?a.isProjectSettingsOpened?s.a.createElement(d.T,null):s.a.createElement(Lr,{width:34,height:30}):1===l.pages.length?s.a.createElement(d.T,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"subheading"},u),f?s.a.createElement(zr,{textStyle:"small",position:"relative",top:5},".",f):null))};function Ur(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Nr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Nr(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Hr,Vr=function(t){var e=t.width,i=t.height;return(s.a.createElement("svg",{width:e,height:i,viewBox:"0 0 34 30",xmlns:"http://www.w3.org/2000/svg"},s.a.createElement("path",{d:"M11.738 1a5 5 0 00-4.35 2.5l-5.149 8.918a5 5 0 00.01 5.017l5.267 9.04a5 5 0 004.301 2.484L22.28 29a5 5 0 004.35-2.5l5.149-8.918a5 5 0 00-.01-5.017l-5.267-9.04A5 5 0 0022.2 1.04l-10.463-.04zm5.273 9a5 5 0 110 10 5 5 0 010-10z",stroke:"#FFF",strokeWidth:"2",fill:"none",fillRule:"evenodd"})))},Wr=Object(a.e)(Xa).withConfig({displayName:"SettingsToggleNew___StyledToolbarButton"})(["margin-right:-20px;z-index:",";"],(function(t){return t._css})),Gr=Object(a.e)(Xa).withConfig({displayName:"SettingsToggleNew___StyledToolbarButton2"})(["z-index:",";"],(function(t){return t._css2})),qr=Object(a.e)(d.Cb).withConfig({displayName:"SettingsToggleNew___StyledText"})(["font-weight:700;"]),Kr=function(t){var e,i,n=t.onMouseEnter,a=Object(r.useContext)(k),l=Object(r.useContext)(rd),c=Object(r.useContext)(Ar),h=Ur(Object(r.useState)(""),2),u=h[0],p=h[1],m=Ur(Object(r.useState)(""),2),f=m[0],v=m[1],b=Ur(Object(r.useState)(a.isSettingsOpened&&!(null===(e=c.metrics)||void 0===e?void 0:e.projectSettingsTooltipSeen)),2),y=b[0],_=b[1];Object(r.useEffect)((function(){var t=l.currentPageId,e=l.pagesParams;e[t]&&(e[t].parentId?(p("".concat(e[e[t].parentId].viewNum)),v("".concat(e[t].viewNum))):(p("".concat(e[t].viewNum)),f&&v("")))}),[l.currentPageNum,l.currentPageId]);var w=Object(r.useCallback)((function(){a.dispatch({type:o.ToggleSettingsSidebar})}),[]),S=Object(r.useCallback)((function(){a.isSettingsOpened?a.isProjectSettingsOpened?a.dispatch({type:o.SetProjectSettingsState,payload:!1}):a.dispatch({type:o.SetProjectSettingsState,payload:!0}):a.dispatch({type:o.OpenSettingsSidebar})}),[a.isSettingsOpened,a.isProjectSettingsOpened]);Object(r.useEffect)((function(){return g.a.on("shortcut:m",w),function(){g.a.off("shortcut:m",w)}}),[]);var x=Ur(Object(r.useState)(!1),2),C=x[0],O=x[1],j=Ur(Object(r.useState)(!1),2),P=j[0],E=j[1];Object(r.useEffect)((function(){P&&setTimeout((function(){return E(!1)}),500)}),[P]),Object(r.useEffect)((function(){E(!0),O(!0)}),[a.isSettingsOpened]);var I=Ur(Object(r.useState)(null),2),T=I[0],M=I[1],$=function(t){P||(M(t.currentTarget.getAttribute("aria-labelledby")),C&&O(!1)),n&&n()},A=function(t){return M(null)};return Object(r.useEffect)((function(){var t;a.isSettingsOpened?_(!(null===(t=c.metrics)||void 0===t?void 0:t.projectSettingsTooltipSeen)):!a.isSettingsOpened&&y&&(_(!1),c.changeMetrics({projectSettingsTooltipSeen:!0}))}),[a.isSettingsOpened,null===(i=c.metrics)||void 0===i?void 0:i.projectSettingsTooltipSeen,y]),s.a.createElement(d.m,null,s.a.createElement(d.m,{display:a.isSettingsOpened?"flex":"none"},s.a.createElement(Wr,{id:"settings-toggle-button","aria-labelledby":"open-page-settings",tooltip:"Pages menu",tooltipDisabled:C,tooltipPadding:"0 12px",forceTooltip:y,onClick:function(){return a.isProjectSettingsOpened&&S()},onMouseEnter:$,onMouseLeave:A,disableHover:!0,bg:"open-page-settings"===T?Object(V.e)(.12,d.Ub.black):a.isProjectSettingsOpened?Object(V.e)(.12,y?d.Ub.black:d.Ub.darkGray):Object(V.e)(.12,"open-project-settings"===T?d.Ub.darkGray:d.Ub.black),_css:"open-page-settings"===T?3:a.isProjectSettingsOpened?1:2},s.a.createElement(d.T,null)),s.a.createElement(Gr,{id:"settings-toggle-button","aria-labelledby":"open-project-settings",tooltip:"Project settings",tooltipDisabled:C,tooltipPadding:"0 12px",forceTooltip:y,onClick:function(){return!a.isProjectSettingsOpened&&S()},onMouseEnter:$,onMouseLeave:A,disableHover:!0,bg:"open-project-settings"===T?Object(V.e)(.12,d.Ub.black):a.isProjectSettingsOpened?Object(V.e)(.12,"open-page-settings"===T?d.Ub.darkGray:d.Ub.black):Object(V.e)(.12,y?d.Ub.black:d.Ub.darkGray),_css2:"open-project-settings"===T?3:a.isProjectSettingsOpened?2:1},s.a.createElement(Vr,{width:34,height:30}))),s.a.createElement(d.m,{display:a.isSettingsOpened?"none":"flex"},s.a.createElement(Xa,{id:"settings-toggle-button","aria-labelledby":"open-page-settings",tooltip:"Menu (M)",tooltipPadding:"0 12px",onMouseEnter:n,onClick:S},1===l.pages.length?s.a.createElement(d.T,null):s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{textStyle:"subheading"},u),f?s.a.createElement(qr,{textStyle:"small",position:"relative",top:5},".",f):null))))};function Yr(t){return function(t){if(Array.isArray(t))return Jr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Zr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Zr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zr(t,e){if(t){if("string"==typeof t)return Jr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Jr(t,e):void 0}}function Jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.Settings="Settings",t.Trash="Trash",t.PageSettings="PageSettings",t.UserTemplatesModal="UserTemplatesModal"}(Hr||(Hr={}));var Qr=[{stateName:"isSettingsOpened",methodName:o.ToggleSettingsSidebar,panelName:Hr.Settings},{stateName:"isTrashOpened",methodName:o.ToggleTrash,panelName:Hr.Trash},{stateName:"isPageSettingsOpened",methodName:o.TogglePageSettings,panelName:Hr.PageSettings},{stateName:"isUserTemplatesModalOpened",methodName:o.ToggleUserTemplatesModal,panelName:Hr.UserTemplatesModal}],ts=function(){var t=Object(r.useContext)(k),e=Xr(Object(r.useState)(!1),2),i=e[0],n=e[1],o=Xr(Object(r.useState)([]),2),a=o[0],s=o[1],l=Object(d.Wb)("Escape");Object(r.useEffect)((function(){var e;t.isSettingsOpened?(e=[],Qr.forEach((function(i){t[i.stateName]&&e.push(i)})),s(e)):a.length&&s([])}),[t.isSettingsOpened]);var c=function(t){var e=Qr.find((function(e){return e.panelName===t}));if(e){var i=Yr(a);i.push(e),s(i)}},h=function(t){var e=a.findIndex((function(e){return e.panelName===t}));if(e>=0){var i=Yr(a);i.splice(e,1),s(i)}};return Object(r.useEffect)((function(){if(!i&&l&&a.length){var e=Yr(a),o=e.pop();o&&(t.dispatch({type:o.methodName}),s(e))}n(l)}),[l]),Object(r.useEffect)((function(){t.isTrashOpened?c(Hr.Trash):h(Hr.Trash)}),[t.isTrashOpened]),Object(r.useEffect)((function(){t.isPageSettingsOpened?c(Hr.PageSettings):h(Hr.PageSettings)}),[t.isPageSettingsOpened]),Object(r.useEffect)((function(){t.isUserTemplatesModalShown?c(Hr.UserTemplatesModal):h(Hr.UserTemplatesModal)}),[t.isUserTemplatesModalShown]),null},es=i("lU33"),is=i("M85P"),ns=i("ilPa"),os=i("WCWw"),as=i.n(os),rs=Object(a.e)(as.a.input).withConfig({displayName:"Input__UserInput"})(["",";",";",";outline:none;height:70px;width:100%;padding-left:0;padding-right:0;border:none;font-family:",";transition:border-color 100ms ease-out;border-top:2px solid transparent;border-bottom:2px solid ",";border-radius:0;&::placeholder{color:","!important;}&:focus{border-bottom-color:",";&::placeholder{color:","!important;}}"],Et.space,Et.textStyle,Et.fontWeight,Object(Et.themeGet)("fonts.main"),Object(Et.themeGet)("colors.lightGray"),Object(Et.themeGet)("colors.gray"),Object(Et.themeGet)("colors.black"),Object(Et.themeGet)("colors.gray"));rs.defaultProps={textStyle:"subheading"};var ss=rs;function ls(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function cs(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ls(Object(i),!0).forEach((function(e){ds(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ls(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ds(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hs(t){return function(t){if(Array.isArray(t))return us(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return us(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return us(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function us(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ps=function(t){return t&&/^\S+@\S+$/.test(t)},ms=function(t){return!t.isFolder},gs=function(t){return t.isFolder},fs=function(t,e){var i=[].concat(hs(t),hs(e));return i.map((function(t){if(!t.isPending)return t;var e=i.find((function(e){return e.email===t.email&&e._id!==t._id}));return e?cs(cs({},t),{},{name:e.name,pic:e.pic}):t}))};function vs(){return(vs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function bs(t){return(bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ys(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function _s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ys(Object(i),!0).forEach((function(e){ws(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ys(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ws(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ks(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Ss(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var xs,Cs,Os=function(t,e){return t||ps(e)},js=(xs=d.Tb,Cs=1,function(t){if(Array.isArray(t))return t}(xs)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}}(xs,Cs)||function(t,e){if(t){if("string"==typeof t)return Ss(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ss(t,e):void 0}}(xs,Cs)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],Ps=Object(a.e)(d.ib).withConfig({displayName:"UserSearch__CancelItem"})(["position:absolute;left:0;top:0;right:0;bottom:0;z-index:1;margin:auto;"]),Es=function(t,e){var i=e.inputValue,n=ks(e,["inputValue"]);switch(n.type){case is.a.stateChangeTypes.blurInput:case is.a.stateChangeTypes.itemMouseEnter:case is.a.stateChangeTypes.mouseUp:return n;default:return _s({inputValue:i},n)}},Is=Object(a.e)(d.hb).withConfig({displayName:"UserSearch___StyledResponsiveAvatar"})(["display:block;"]),Ts=Object(a.e)(d.B).withConfig({displayName:"UserSearch___StyledFlex"})(["",".clear{visibility:hidden;}&:hover ",".clear{visibility:visible;}"],d.n,d.n),Ms=Object(a.e)(d.m).withConfig({displayName:"UserSearch___StyledBox"})(["",""],(function(t){return t._css})),$s=Object(a.e)(ss).withConfig({displayName:"UserSearch___StyledInput"})(["box-sizing:border-box;height:","px;"],(function(t){return t._css2})),As=Object(a.e)(d.q).withConfig({displayName:"UserSearch___StyledCollaborator"})(["opacity:0.4;"]),Rs=Object(a.e)(d.ib).withConfig({displayName:"UserSearch___StyledRoundButton"})(["flex-shrink:0;margin-right:0;"]),Ds=Object(a.e)(d.B).withConfig({displayName:"UserSearch___StyledFlex2"})(["",""],(function(t){return t._css3})),Bs=function(t){var e=t.placeholder,i=t.submitText,n=void 0===i?"Submit":i,o=t.suggestions,a=void 0===o?[]:o,l=t.renderWhenSelected,c=t.disabled,u=void 0!==c&&c,p=t.focusOnMount,m=t.onChange,g=t.onFocus,f=t.onBlur,v=t.selectedUser,b=t.showInput,y=void 0===b||b,_=Object(r.useRef)(null);return Object(r.useEffect)((function(){p&&_.current&&_.current.focus()}),[p]),s.a.createElement(is.a,{stateReducer:Es,itemToString:function(t){return t?t.name:null},id:"rm-user-search",initialInputValue:"string"==typeof v?v:void 0,initialSelectedItem:"object"===bs(v)?v:void 0,isOpen:!0,onStateChange:function(t){m&&(void 0!==t.selectedItem?(m(t.selectedItem),h.d.sendEvent(h.c.CollaborateSuggestionApplied)):void 0!==t.inputValue&&m(t.inputValue))}},(function(t){var i=t.getInputProps,o=t.getItemProps,r=t.getMenuProps,c=t.selectedItem,h=t.inputValue,p=t.clearSelection;return(s.a.createElement("div",null,s.a.createElement(es.a,{query:"(min-width: ".concat(js,")")},(function(t){var m=Object(ns.a)(a,h||"",{keys:["name"]}),v=h?null:Boolean(a.length)&&s.a.createElement(d.B,{mr:[0,3],mb:[3,0],height:72,alignItems:"center"},s.a.createElement(d.Cb,{textStyle:t?"subheading":"regular",color:"gray"},"Suggestions"));return s.a.createElement(d.m,null,s.a.createElement(d.B,{pl:c||!t?0:88,flexDirection:["row-reverse","row"]},c?t?s.a.createElement(d.hb,{name:c.name,url:c.pic,mr:3}):s.a.createElement(d.m,{position:"relative"},s.a.createElement(Ps,{color:"tomato",size:24,"aria-label":"Clear selection",onClick:function(){return p()}},s.a.createElement(d.w,null)),s.a.createElement(Is,{name:c.name,url:c.pic})):null,s.a.createElement(d.m,{flex:1,display:["flex","block"]},s.a.createElement(Ts,{justifyContent:"space-between",borderBottom:c?"2px solid":void 0,borderColor:"black",width:1,position:"relative"},c?s.a.createElement(d.B,{height:d.Rb.regular-2,alignItems:"center"},s.a.createElement(Ms,{_css:t?"":"white-space: nowrap; width: calc(100vw - 200px); overflow: hidden; text-overflow: ellipsis;"},s.a.createElement(d.Cb,{textStyle:t?"subheading":"regular"},c.name,t&&s.a.createElement(d.n,{className:"clear","aria-label":"Clear selection",onClick:function(){return p()},ml:2},s.a.createElement(d.w,{"aria-hidden":!0}))))):y?s.a.createElement(d.m,{as:"label",width:1},s.a.createElement(d.Pb,{as:"span"},e),s.a.createElement($s,vs({ref:_,textStyle:t?"subheading":"regular",pr:80},i(_s(_s({placeholder:e,id:"rm-user-search-input",height:d.Rb.regular,disabled:u},g?{onFocus:function(){return g()}}:{}),f?{onBlur:function(){return f()}}:{})),{_css2:d.Rb.regular}))):"",Os(c,h)&&t?s.a.createElement(d.n,{variant:"primary",textStyle:"subheading",type:"submit",disabled:u,position:"absolute",right:0,lineHeight:"72px",minWidth:60},n):null),!t&&h&&!Os(c,h)&&m.length?m.slice(0,1).map((function(t,e){return s.a.createElement(As,vs({name:t.name||t.email,email:t.name?t.email:"",url:t.pic,projectsCount:t.projectsCount,key:e,isCaptionVisible:!1,showInitials:!1,fullBox:!1,"data-testid":t._id},o({item:t,key:e})))})):null,Os(c,h)&&!t?s.a.createElement(Rs,{type:"submit",size:d.Rb.regular,color:"tomato",disabled:u},n):null,Os(c,h)?l:null)),a.length?s.a.createElement(d.m,{mt:[22,66],ml:[0,d.Rb.regular+16],minHeight:d.Rb.regular+(t?d.Sb:0)},Os(c,h)?null:s.a.createElement(d.m,{display:["block","flex"]},t?null:v,s.a.createElement(Ds,vs({},r(),{flexWrap:["nowrap","wrap"],ml:[-24,0],pl:[24,0],width:["100vw",null],_css3:t?"":"overflow-x: auto; -webkit-overflow-scrolling: touch"}),t?v:null,t||!h?m.map((function(e,i){return s.a.createElement(d.m,{height:116,key:i},s.a.createElement(d.q,vs({name:e.name||e.email,email:e.name?e.email:"",url:e.pic,projectsCount:e.projectsCount,isCaptionVisible:!t,fullBox:!t,"data-testid":e._id},o({item:e,key:i}))))})):null))):null)}))))}))};function Ls(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function zs(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Ls(a,n,o,r,s,"next",t)}function s(t){Ls(a,n,o,r,s,"throw",t)}r(void 0)}))}}var Fs=function(){var t=zs(regeneratorRuntime.mark((function t(e,i,n,o){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Se.a.post("/api/team",{email:e,mags:i,folders:n,sharesAll:o});case 2:if((a=t.sent).teamMember){t.next=5;break}throw a.error||a;case 5:return t.abrupt("return",a.teamMember);case 6:case"end":return t.stop()}}),t)})));return function(e,i,n,o){return t.apply(this,arguments)}}(),Us=function(){var t=zs(regeneratorRuntime.mark((function t(e,i,n,o){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Se.a.put("/api/team",{email:e,mags:i,folders:n,sharesAll:o});case 2:if((a=t.sent).teamMember){t.next=5;break}throw a.error||a;case 5:return t.abrupt("return",a.teamMember);case 6:case"end":return t.stop()}}),t)})));return function(e,i,n,o){return t.apply(this,arguments)}}(),Ns=function(t){return Se.a.delete("/api/team",{email:t})},Hs=function(t){return Se.a.post("/api/team/invite",{email:t})};function Vs(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ws(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Vs(a,n,o,r,s,"next",t)}function s(t){Vs(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Gs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qs(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ks(t,e){return(Ks=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ys(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Zs(t);if(e){var o=Zs(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Xs(this,i)}}function Xs(t,e){return!e||"object"!==tl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zs(t){return(Zs=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Js(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Qs(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tl(t){return(tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function el(t){return function(t){if(Array.isArray(t))return nl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||il(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function il(t,e){if(t){if("string"==typeof t)return nl(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?nl(t,e):void 0}}function nl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ol=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||il(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(d.Tb,1)[0],al=function(t){return t.reduce((function(t,e){return ms(e)?[].concat(el(t),[e.num_id]):t}),[])},rl=function(t){var e=t.all,i=t.excluded,n=t.selectedUser,o=(i||[]).map((function(t){return t._id}));return n&&"object"===tl(n)&&n._id&&o.push(n._id),e.reduce((function(t,e){var i=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Js(Object(i),!0).forEach((function(e){Qs(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Js(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},e),n=t.map((function(t){return t._id}));return e.isPending||[].concat(el(o),el(n)).includes(e._id)?t:[].concat(el(t),[i])}),[])},sl=function(t){return t.reduce((function(t,e){return gs(e)?[].concat(el(t),[e._id]):t}),[])};Object(a.e)(as.a.input).withConfig({displayName:"TeamworkModal__ProjectsFilter"})(["",";",";",";outline:none;height:72px;width:100%;padding-left:0;padding-right:0;border:none;transition:border-color 100ms ease-out;border-top:2px solid transparent;border-bottom:2px solid ",";border-radius:0;&::placeholder{color:",";}&:focus{border-bottom-color:",";}"],Et.space,Et.textStyle,Et.fontWeight,Object(Et.themeGet)("colors.lightGray"),Object(Et.themeGet)("colors.gray"),Object(Et.themeGet)("colors.black")).defaultProps={textStyle:"subheading"};var ll,cl,dl,hl,ul=a.e.div.withConfig({displayName:"TeamworkModal__PendingButtons"})(["white-space:nowrap;","{display:none;}&:hover{","{display:none;}","{display:inline-block;}}"],d.n,d.Cb,d.n),pl=Object(a.e)(d.B).withConfig({displayName:"TeamworkModal___StyledFlex"})(["flex-wrap:wrap;"]),ml=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ks(t,e)}(a,t);var e,i,n,o=Ys(a);function a(){var t;return Gs(this,a),(t=o.apply(this,arguments)).state={projects:t.props.projects?t.props.projects:[],selectedUser:null,copy:!1,isSubmitting:!1,didError:!1,userSearchKey:1,lastInvinationTo:null,filteredProjects:t.props.allProjects.slice(0,2)},t.formRef=s.a.createRef(),t.onChange=function(e){t.setState({selectedUser:e,selectedProject:void 0})},t.onFocus=function(e){t.setState({isInputInFocus:!0}),t.formRef.current&&!e&&window.scroll({top:t.formRef.current.offsetTop,behavior:"smooth"})},t.onBlur=function(){return t.setState({isInputInFocus:!1})},t.isFormValid=function(){return t.state.selectedUser&&ps("string"==typeof t.state.selectedUser?t.state.selectedUser:t.state.selectedUser.email)},t.addCollaborator=function(){var e=Ws(regeneratorRuntime.mark((function e(i){var n,o,a,r,s,l,c,d,u,p,m,g,f,v,b,y,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i?{selectedUser:i}:t.state,o=n.selectedUser,a=t.props.user,!o){e.next=37;break}if(r="string"==typeof o?o:o.email,s=al(t.props.allProjects),l=al(t.state.projects),c=sl(t.state.projects),t.setState({isSubmitting:!0,didError:!1,error:""}),a.email!==r){e.next=10;break}return e.abrupt("return",t.setState({isSubmitting:!1,didError:!0,error:"You can’t collaborate with yourself."}));case 10:if(e.prev=10,d=fs(t.props.myTeam,t.props.sharedTeam),u=d.find((function(t){return t.email===r})),p=u&&t.props.myTeam.some((function(t){return t.email===r})),!u||!p){e.next=25;break}return g=u.sharesAll?s:new Set([].concat(el(u.projectNumIds),el(l))),f=new Set([].concat(el(u.folderIds),el(c))),v=(m=Array.prototype).concat.apply(m,el(el(f).map((function(e){return t.props.allProjects.filter((function(t){return ms(t)&&t.folder===e}))})))).map((function(t){return t.num_id})),b=new Set(el(g).filter((function(t){return!v.includes(t)}))),e.next=21,Us(r,el(b),el(f),!1);case 21:y=e.sent,t.props.onTeammateUpdate(y),e.next=31;break;case 25:return e.next=27,Fs(r,l,c,!1);case 27:_=e.sent,h.d.sendEvent(h.b.AddTeamMember,{eventLabel:"Constructor"}),h.d.sendEvent(h.c.Collaborate,{eventLabel:t.getAnalyticsLabel()}),t.props.onTeammateAdd(_);case 31:t.setState({isSubmitting:!1,didError:!1,userSearchKey:t.state.userSearchKey+1,selectedUser:""}),e.next=37;break;case 34:e.prev=34,e.t0=e.catch(10),t.setState({isSubmitting:!1,didError:!0,error:e.t0.error?e.t0.error.message?e.t0.error.message:e.t0.error.toString():"Error adding collaborator. Please try again."});case 37:case"end":return e.stop()}}),e,null,[[10,34]])})));return function(t){return e.apply(this,arguments)}}(),t.onSubmit=Ws(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.state.projects.length){e.next=4;break}t.setState({isSelectUserProjectVisible:!0}),e.next=6;break;case 4:return e.next=6,t.addCollaborator();case 6:case"end":return e.stop()}}),e)}))),t.onUnshare=function(){var e=Ws(regeneratorRuntime.mark((function e(i){var n,o,a,r,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=al(t.state.projects),o=sl(t.state.projects),a=al(t.props.allProjects),r=(i.sharesAll?a:i.projectNumIds).filter((function(t){return!n.includes(t)})),s=i.folderIds.filter((function(t){return!o.includes(t)})),t.setState({didError:!1,error:""}),e.prev=6,!i.isPending||r.length||s.length){e.next=14;break}return e.next=10,Ns(i.email);case 10:h.d.sendEvent(h.b.DeleteTeamMember),t.props.onTeammateRemove(i),e.next=18;break;case 14:return e.next=16,Us(i.email,r,s,!1);case 16:l=e.sent,t.props.onTeammateUpdate(l);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(6),t.setState({didError:!0,error:"Error when unsharing. Please try again."});case 23:case"end":return e.stop()}}),e,null,[[6,20]])})));return function(t){return e.apply(this,arguments)}}(),t.onResend=function(){var e=Ws(regeneratorRuntime.mark((function e(i){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setState({didError:!1,error:""}),e.prev=1,e.next=4,Hs(i.email);case 4:t.setState({lastInvinationTo:i._id}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),t.setState({didError:!0,error:"Error sending invitation. Please try again."});case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),t.getContributorsPlanLimit=function(){var e=t.props.user;return e&&e.plan_limits&&e.plan_limits.contributors||0},t.getTeammatesWithSharedMags=function(t){return t.filter((function(t){return t.sharesAll||t.projectNumIds&&t.projectNumIds.length||t.folderIds&&t.folderIds.length}))},t.getAnalyticsLabel=function(){var e=al(t.state.projects),i=sl(t.state.projects),n=e.length,o=i.length;return n&&o?"Multiple":n?"Project":"Collection"},t}return e=a,(i=[{key:"render",value:function(){var t=this,e=fs(this.props.myTeam,this.props.sharedTeam),i=function(t,e){return e.filter((function(e){return t.length&&(e.sharesAll&&t.every((function(t){return ms(t)}))||t.every((function(t){return ms(t)&&(e.projectNumIds||[]).includes(t.num_id)||ms(t)&&!!t.folder&&(e.folderIds||[]).includes(t.folder)||gs(t)&&(e.folderIds||[]).includes(t._id)})))}))}(this.state.projects,e),n=al(this.state.projects),o=rl({all:this.props.myTeam,excluded:i,selectedUser:this.state.selectedUser}),a=sl(this.state.projects),r=n.length,l=a.length,c=!i.length,h=this.getContributorsPlanLimit()-this.getTeammatesWithSharedMags(this.props.myTeam).length>0,u=[r?"".concat(r>1?r+" selected projects":"project"):"",l?"".concat(l>1?l+(r?" folders":" selected folders"):"folder"):""].join(l&&r?" and ":""),p=s.a.createElement(d.ub,{as:"a",color:"gray",href:"/settings#change-plan"},"Upgrade to invite more");return s.a.createElement(es.a,{query:"(min-width: ".concat(ol,")")},(function(e){return s.a.createElement(d.V,{closeTitle:"Close",initialFocus:e&&c?"#rm-user-search-input":"",show:t.props.show,onExit:t.props.onExit,error:t.state.error,zIndex:10500,title:s.a.createElement(d.m,{as:"span",pl:e?d.Rb.regular+16:0},t.props.projects?t.state.projects.length?i.length?"".concat(u," shared with"):"Collaborate on ".concat(u," with"):"Add collaborator":s.a.createElement(s.a.Fragment,null,t.state.isSelectUserProjectVisible?s.a.createElement(d.n,{as:"a",textStyle:e?"subheading":"regular",onClick:function(){t.setState({isSelectUserProjectVisible:!1,projects:[]})},color:"gray"},"Add collaborator"):s.a.createElement(d.Cb,{textStyle:e?"subheading":"regular"},"Add collaborator"),t.state.isSelectUserProjectVisible||t.state.selectedProject?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.Cb,{px:2,textStyle:e?"subheading":"regular",color:"gray"},">"),t.state.selectedProject&&!t.state.isSelectUserProjectVisible?s.a.createElement(d.n,{as:"a",textStyle:e?"subheading":"regular",onClick:function(){t.setState({isSelectUserProjectVisible:!0,projects:[]})},color:"gray"},"Select project"):s.a.createElement(d.Cb,{textStyle:e?"subheading":"regular"},"Select project")):null))},s.a.createElement(d.B,{mb:[0,o.length>1?0:40],flex:["1",null],flexDirection:"column",justifyContent:["space-between",null]},s.a.createElement(d.m,{mt:[0,72],mb:[80,0]},e&&s.a.createElement(d.B,{flexDirection:"column"},i.map((function(e){return s.a.createElement(d.B,{justifyContent:"space-between",key:e._id||e.email},s.a.createElement(d.B,{alignItems:"center"},s.a.createElement(d.hb,{name:e.name||"",url:e.pic}),s.a.createElement(d.m,{ml:16},s.a.createElement(d.Cb,{as:"div",textStyle:"subheading"},e.name||e.email))),function(e){return t.state.projects.every((function(t){return ms(t)&&!!t.folder&&e.folderIds.includes(t.folder)}))}(e)?s.a.createElement(d.n,{variant:"tertiary",textStyle:"subheading",disabled:!0},"Shared within collection"):e.isPending?s.a.createElement(ul,null,s.a.createElement(d.Cb,{as:"div",textStyle:"subheading",lineHeight:"".concat(d.Rb.regular,"px")},"Pending"),s.a.createElement(d.n,{variant:"tertiary",textStyle:"subheading",lineHeight:"".concat(d.Rb.regular,"px"),onClick:function(){return t.onResend(e)},onMouseOut:function(){return t.setState({lastInvinationTo:null})}},t.state.lastInvinationTo===e._id?"Sent":"Resend"),s.a.createElement(d.n,{variant:"tertiary",textStyle:"subheading",lineHeight:"".concat(d.Rb.regular,"px"),ml:10,onClick:function(){return t.onUnshare(e)}},"Unshare")):s.a.createElement(d.n,{variant:"tertiary",textStyle:"subheading",onClick:function(){return t.onUnshare(e)}},"Unshare"))}))),t.state.isTeammateDropdownOpen||!h&&!t.state.selectedUser&&1!==o.length?null:s.a.createElement(d.m,{as:"form",onSubmit:function(e){e.preventDefault(),1!==o.length||h?t.isFormValid()&&t.onSubmit():t.setState({selectedUser:o[0]},(function(){t.isFormValid()&&t.onSubmit()}))},mt:[26,0],ref:t.formRef},s.a.createElement(Bs,{placeholder:"Maria or maria@example",submitText:h?t.state.projects.length?"Invite":"Select project":"Add",disabled:t.state.isSubmitting,suggestions:!t.state.error&&(o.length>1||h)?o:[],onChange:t.onChange,onFocus:function(){return t.onFocus(e)},onBlur:function(){return t.onBlur()},key:t.state.userSearchKey,"data-testid":"user-search",showInput:h,selectedUser:t.state.selectedUser?t.state.selectedUser:1!==o.length||h?void 0:o[0]})),!h&&!t.state.selectedUser&&o.length>1?s.a.createElement(d.m,{pl:[0,88],mt:[0,24],minHeight:[60,0],textAlign:e?"left":"center",pb:10},t.state.projects.length?s.a.createElement(d.Cb,{textStyle:e?"subheading":"regular",color:"gray"},"Add collaborator"):null,s.a.createElement(pl,{mt:[0,12]},o.map((function(i){return s.a.createElement(d.m,{key:i._id||i.email,height:145},s.a.createElement(d.q,{name:i.name||i.email,email:i.email,url:i.pic,projectsCount:i.projectsCount,isCaptionVisible:!e,fullBox:!e,"data-testid":i._id,onClick:Ws(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.setState({selectedUser:i});case 1:case"end":return e.stop()}}),e)})))}))})))):null),h?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(d.m,{pl:[0,88],mt:[0,o.length>1?40:100],mb:[18,56],minHeight:[60,0],textAlign:e?"left":"center"},s.a.createElement(d.Cb,null,"You can’t ",o.length?"invite":"add"," more collaborators on your plan."," ",e&&p)),!e&&s.a.createElement(d.m,{flex:"0 0 0",p:"28px 0 17px",borderTop:"2px solid",borderColor:"lightGray",textAlign:"center"},p))))}))}}])&&qs(e.prototype,i),n&&qs(e,n),a}(s.a.Component);function gl(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  display: block;\n  ",";\n"]);return gl=function(){return t},t}function fl(){return(fl=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}!function(t){t.Draggable="Draggable",t.Selectable="Selectable",t.Search="Search"}(ll||(ll={})),function(t){t.ByMe="ByMe",t.WithMe="WithMe"}(cl||(cl={})),function(t){t.Grouped="Grouped",t.Ungrouped="Ungrouped"}(dl||(dl={})),function(t){t.Alphabet="Alphabet",t.LastChanged="LastChanged",t.DateCreated="DateCreated"}(hl||(hl={}));var vl=r.createElement("path",{d:"M80 4a4 4 0 118 0v80a4 4 0 11-8 0V4zM64 4a4 4 0 118 0v80a4 4 0 11-8 0V4zM48 4a4 4 0 118 0v80a4 4 0 11-8 0V4zM32 4a4 4 0 118 0v80a4 4 0 11-8 0V4zM16 4a4 4 0 118 0v80a4 4 0 11-8 0V4zM0 4a4 4 0 118 0v80a4 4 0 11-8 0V4z",fill:"#0080FF",fillRule:"evenodd"}),bl=Object(a.e)((function(t){return r.createElement("svg",fl({width:88,height:88},t),vl)}))(gl(),Et.color);function yl(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  display: block;\n  ",";\n"]);return yl=function(){return t},t}function _l(){return(_l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var wl=r.createElement("path",{d:"M82 0a6 6 0 016 6v76a6 6 0 01-6 6H6a6 6 0 01-6-6V6a6 6 0 016-6h76zM52 28a8 8 0 00-8 8l-.004-.25A8 8 0 1036 44a8 8 0 107.996 8.25L44 52a8 8 0 108-8l.25-.004A8 8 0 0052 28z",fill:"#282828",fillRule:"evenodd"}),kl=Object(a.e)((function(t){return r.createElement("svg",_l({width:88,height:88},t),wl)}))(yl(),Et.color);function Sl(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  display: block;\n  ",";\n"]);return Sl=function(){return t},t}function xl(){return(xl=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var Cl=r.createElement("path",{d:"M84 80a4 4 0 110 8H4a4 4 0 110-8h80zm0-16a4 4 0 110 8H4a4 4 0 110-8h80zm0-16a4 4 0 110 8H4a4 4 0 110-8h80zm0-16a4 4 0 110 8H4a4 4 0 110-8h80zm0-16a4 4 0 110 8H4a4 4 0 110-8h80zm0-16a4 4 0 110 8H4a4 4 0 110-8h80z",fill:"#F8A42B",fillRule:"evenodd"}),Ol=Object(a.e)((function(t){return r.createElement("svg",xl({width:88,height:88},t),Cl)}))(Sl(),Et.color);function jl(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  display: block;\n  ",";\n"]);return jl=function(){return t},t}function Pl(){return(Pl=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var El=r.createElement("path",{d:"M82 0a6 6 0 016 6v76a6 6 0 01-6 6H6a6 6 0 01-6-6V6a6 6 0 016-6h76zM70.828 17.172a4 4 0 00-5.656 0l-48 48-.151.159a4 4 0 005.807 5.497l48-48 .151-.159a4 4 0 00-.15-5.497z",fill:"#EC520B",fillRule:"evenodd"}),Il=Object(a.e)((function(t){return r.createElement("svg",Pl({width:88,height:88},t),El)}))(jl(),Et.color);function Tl(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  display: block;\n  ",";\n"]);return Tl=function(){return t},t}function Ml(){return(Ml=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var $l=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 0a6 6 0 00-6 6v76a6 6 0 006 6h76a6 6 0 006-6V6a6 6 0 00-6-6H6zm6 16a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm16 0a4 4 0 11-8 0 4 4 0 018 0zM16 28a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm16 0a4 4 0 100-8 4 4 0 000 8zM16 44a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm16 0a4 4 0 100-8 4 4 0 000 8zM16 60a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm16 0a4 4 0 100-8 4 4 0 000 8zM12 80a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm12 4a4 4 0 100-8 4 4 0 000 8zm20-4a4 4 0 11-8 0 4 4 0 018 0zm16 0a4 4 0 11-8 0 4 4 0 018 0z",fill:"#089400"}),Al=Object(a.e)((function(t){return r.createElement("svg",Ml({width:88,height:88,fill:"none"},t),$l)}))(Tl(),Et.color);function Rl(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  display: block;\n  ",";\n"]);return Rl=function(){return t},t}function Dl(){return(Dl=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var Bl=r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6 0a6 6 0 00-6 6v76a6 6 0 006 6h76a6 6 0 006-6V6a6 6 0 00-6-6H6zm22 48a4 4 0 100-8 4 4 0 000 8zm36-4a4 4 0 11-8 0 4 4 0 018 0zm-20 4a4 4 0 100-8 4 4 0 000 8z",fill:"#B9B9B9"}),Ll=Object(a.e)((function(t){return r.createElement("svg",Dl({width:88,height:88,fill:"none"},t),Bl)}))(Rl(),Et.color),zl=Object(a.e)(d.m).withConfig({displayName:"HelpGridCell___StyledBox"})(["display:block;text-decoration:none;"]),Fl=Object(a.e)(d.m).withConfig({displayName:"HelpGridCell___StyledBox2"})(["&:hover{display:block;opacity:0.8;}"]),Ul=Object(a.e)(d.Cb).withConfig({displayName:"HelpGridCell___StyledText"})(["display:block;&:hover{color:",";}"],(function(t){return t._css})),Nl=function(t){var e=t.text,i=t.children,n=t.href,o=t.onClick,a=t["aria-labelledby"];return(s.a.createElement(zl,{as:"a",m:"8px",width:88,href:n,cursor:"pointer",onClick:function(t){t.preventDefault(),o&&o()},"aria-labelledby":a},s.a.createElement(Fl,{as:"span"},i),s.a.createElement(Ul,{textStyle:"small",mt:"8px",color:"black",_css:d.Ub.tomato},e)))},Hl=i("K6JF"),Vl=i("x/B7"),Wl=i.n(Vl);function Gl(t){return function(t){if(Array.isArray(t))return ql(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ql(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ql(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ql(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Kl=[{tp:"move-cursor",speed:1/0,delayBefore:0,delayAfter:700,dy:-18,dx:-6,selector:"#constructor .help-tour .tour-welcome .selector-wrapper .left .pic"},{direction:"back",tp:"click",selector:"#settings-toggle-button",delayBefore:0,delayAfter:0},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .plus-button",delayBefore:0,delayAfter:0},{tp:"move-cursor",dx:14,dy:14,selector:"#constructor .widgetbar:visible .plus-button",delayBefore:0},{tp:"click",selector:"prev"},{tp:"show-panel",corner:"bottom",ax:"left",cx:15,dx:-14,ay:"bottom",dy:-50,selector:"prev",caption:"Add a Widget",text:"To add new widgets, click on a + button and choose the one you need."},{tp:"move-cursor",dy:-13,selector:".widget-selector .widget-block:first-of-type"},{tp:"click",selector:".widget-selector .widget-block:first-of-type",delayAfter:function(t){!function e(){u.a.delay((function(){(Object(f.a)("constructor.textv3")?Object(tn.a)('#constructor .controls:visible div[data-control-type="text_align_new"] button'):Object(tn.a)("#constructor .controls:visible .control.text_align")).length?u.a.delay(t,200):e()}),100)}()}},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .plus-button",delayBefore:0},{direction:"back",tp:"move-cursor",dx:14,dy:14,selector:"#constructor .widgetbar:visible .plus-button",speed:900},{direction:"back",tp:"click",selector:"#constructor .workspace",delayBefore:0,delayAfter:0},{direction:"back",tp:"undo",selector:"#constructor .widgetbar:visible .undo.active",steps:1/0},{direction:"back",tp:"click",selector:"#constructor .workspace",delayBefore:0,delayAfter:0}].concat(Gl(Object(f.a)("constructor.textv3")?[{tp:"move-cursor",selector:'#constructor .controls:visible div[data-control-type="text_align_new"] button'}]:[{tp:"move-cursor",selector:"#constructor .controls:visible .control.text_align"}]),[{tp:"show-panel",corner:"right",ax:"right",dx:-67,ay:"top",dy:-112,selector:"prev",caption:"Widget Settings",text:"Widget properties are accessible from the settings toolbar on the right side of the page."},{tp:"click",selector:"#constructor .workspace",delayBefore:0,delayAfter:0},{tp:"click",selector:"#constructor .workspace .block-text",delayBefore:0,delayAfter:0}],Gl(Object(f.a)("constructor.textv3")?[{direction:"back",tp:"move-cursor",selector:'#constructor .controls:visible div[data-control-type="text_align_new"] button',speed:1200,delayBefore:300},{direction:"back",tp:"dblclick",selector:"#constructor .workspace .block.text-v3"},{direction:"back",tp:"click",selector:"#constructor .workspace .block.text-v3"}]:[{direction:"back",tp:"move-cursor",selector:"#constructor .controls:visible .control.text_align",speed:1200,delayBefore:300},{direction:"back",tp:"dblclick",selector:"#constructor .workspace .block-text"},{direction:"back",tp:"click",selector:"#constructor .workspace .block-text"}]),[{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .stack-button",delayBefore:0,delayAfter:0},{tp:"move-cursor",dx:0,dy:0,selector:"#constructor .widgetbar:visible .stack-button",speed:900},{tp:"click",selector:"prev"},{tp:"show-panel",corner:"left",cy:55,ax:"left",dx:110,ay:"bottom",dy:-43,selector:"prev",caption:"Quick Access to All Widgets",text:"Use this panel to set up a grid, guides, and a page background, as well as to change the hierarchy of widgets on the page. Each widget has its own icon in this panel."},{tp:"click",selector:"prev"},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .stack-button"},{direction:"back",tp:"move-cursor",dx:0,dy:0,selector:"#constructor .widgetbar:visible .stack-button",speed:300},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .viewport",delayBefore:0,delayAfter:0},{tp:"move-cursor",dx:0,selector:"#constructor .widgetbar:visible .viewport",speed:300},{tp:"click",selector:"prev"},{tp:"click",selector:"#constructor .viewports-panel .phone_portrait div[data-state=on] .rmswitcher-panel",delayBefore:0,delayAfter:0},{tp:"show-panel",corner:"left",cy:25,ax:"left",dx:220,ay:"bottom",dy:-44,selector:"#constructor .widgetbar:visible .viewport",caption:"Viewports",text:"Adapt your design to device screens: activate whatever viewports you need and redesign the layout accordingly."},{direction:"back",tp:"move-cursor",dx:0,selector:"#constructor .widgetbar:visible .viewport",speed:300},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .undo"},{direction:"back",tp:"click",selector:"#constructor .viewports-panel .phone_portrait .rm-switcher .rmswitcher-panel",delayBefore:0,delayAfter:0},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .undo",delayBefore:0,delayAfter:0},{tp:"move-cursor",dx:0,selector:"#constructor .viewports-panel .phone_portrait .rm-switcher .rmswitcher-panel",speed:150,delayBefore:300},{tp:"click",selector:"prev"},{tp:"show-panel",corner:"left",ax:"left",dx:51,ay:"bottom",dy:70,selector:"prev",caption:"Mobile Auto-layout",text:"When you activate a mobile viewport for the first time, you will see an automatically generated mobile layout. You can modify this later in the process."},{tp:"click",selector:"#constructor .widgetbar:visible .viewport",delayBefore:0,delayAfter:0},{direction:"back",tp:"move-cursor",dx:0,selector:"#constructor .viewports-panel .phone_portrait .rm-switcher .rmswitcher-panel",speed:1200},{direction:"back",tp:"click",selector:"#constructor .widgetbar:visible .viewport",delayBefore:0,delayAfter:0},{direction:"back",tp:"click",selector:"#main"},{tp:"move-cursor",selector:"#settings-toggle-button",speed:900,delayBefore:0},{tp:"show-panel",corner:"bottom",ax:"right",dx:40,ay:"bottom",dy:-60,selector:"prev",caption:"Pages menu and Project settings",text:"This is the place where you can manage page order, project settings, and publish the project.",cx:0},{direction:"back",tp:"move-cursor",selector:"#settings-toggle-button",delayBefore:300,speed:400},{direction:"back",tp:"click",selector:"#main"},{direction:"back",tp:"move-cursor",selector:'[aria-labelledby="open-page-settings"]'},{tp:"click",selector:"#settings-toggle-button"},function(){return document.querySelector('[aria-labelledby="open-project-settings"]')?{tp:"move-cursor",selector:'[aria-labelledby="open-project-settings"]',speed:400,delayBefore:300}:void 0},function(){return document.querySelector('[aria-labelledby="open-project-settings"]')?{tp:"click",selector:'[aria-labelledby="open-project-settings"]',delayBefore:300}:void 0},{tp:"move-cursor",selector:'[aria-labelledby="project-settings-general"]',delayBefore:200,dx:-40},{tp:"show-panel",corner:"right",dx:-110,ax:"right",ay:"top",dy:-40,selector:"prev",caption:"General Settings",text:"Use this tab to set up the project title and description that will be used for sharing, or to change a link."},{direction:"back",tp:"click",selector:"prev",delayBefore:0,delayAfter:0},{direction:"back",tp:"move-cursor",selector:'[aria-labelledby="project-settings-general"]',speed:400,dx:-40},{tp:"move-cursor",selector:'[aria-labelledby="project-settings-domain"]',speed:400,delayAfter:0,dx:-40},{tp:"click",selector:"prev",delayAfter:500},{tp:"move-cursor",selector:'[aria-labelledby="project-settings-domain"]',speed:400,dx:-40},{tp:"show-panel",corner:"right",ax:"right",dx:-110,ay:"top",dy:-40,selector:"prev",caption:"Domain Mapping",text:"Set up your own domain for new projects in this panel. This feature is supported under Creator, Professional and Custom plans."},{direction:"back",tp:"move-cursor",selector:'[aria-labelledby="project-settings-domain"]',speed:400,dx:-40},{direction:"back",tp:"click",selector:'[aria-labelledby="project-settings-domain"]',delayBefore:0,delayAfter:500},{direction:"back",tp:"move-cursor",selector:'[aria-labelledby="project-settings-domain"]',speed:400,delayAfter:0,dx:-40},{tp:"move-cursor",selector:'[aria-labelledby="project-settings-viewer"]',speed:200,delayAfter:0,dx:-40},{tp:"click",selector:"prev",delayBefore:0},{tp:"show-panel",corner:"right",ax:"right",dx:-110,ay:"top",dy:-40,selector:"prev",caption:"Viewer Settings",text:"This tab allows you to change some layout settings for your project: making page order vertical or horizontal, changing page transition style, enabling Scale Layout."},{direction:"back",tp:"click",selector:'[aria-labelledby="project-settings-viewer"]',delayBefore:0},{direction:"back",tp:"move-cursor",selector:'[aria-labelledby="project-settings-viewer"]',delayAfter:0,dx:-40},{direction:"back",tp:"click",selector:'[aria-labelledby="open-project-settings"]',delayAfter:200},{direction:"back",tp:"move-cursor",selector:'[aria-labelledby="open-project-settings"]',delayAfter:200,speed:400},{tp:"move-cursor",selector:'[aria-labelledby="open-page-settings"]'},{tp:"click",selector:'[aria-labelledby="open-page-settings"]',delayAfter:300},{tp:"move-cursor",selector:'#constructor-settings-sidebar svg[aria-labelledby="add-blank-page"]',speed:200},{tp:"show-panel",delayBefore:200,corner:"bottom",ax:"right",dx:97,ay:"bottom",dy:-60,selector:"prev",caption:"Add Pages",text:"Add a new blank page."},{tp:"click",selector:"prev",delayAfter:300},{direction:"back",tp:"move-cursor",selector:'#constructor-settings-sidebar svg[aria-labelledby="add-blank-page"]',speed:1/0},{direction:"back",tp:"click",selector:'#page-list-container .sortable-item:last-of-type button[aria-labelledby="delete-page"]'},{direction:"back",tp:"click",selector:'[aria-labelledby="open-page-settings"]',delayAfter:300},{direction:"back",tp:"click",selector:"#settings-toggle-button",delayAfter:300},{tp:"click",selector:"#constructor .widgetbar:visible .plus-button"},{tp:"move-cursor",delayAfter:500,selector:".widget-selector .widget-block .icon-image.shape"},{tp:"click",selector:"prev",delayAfter:function(t){!function e(){u.a.delay((function(){Object(tn.a)("#constructor .controls:visible .shape_settings").length?u.a.delay(t,200):e()}),100)}()}},{tp:"move-cursor",selector:'#constructor .controls:visible .shape_settings [data-type="ellipse"]',delayBefore:200},{tp:"click",selector:"prev"},{tp:"move-cursor",selector:'#constructor .controls:visible [data-name="animation-control-icon"]',dy:5,delayBefore:10,speed:100},{tp:"click",selector:"prev"},{tp:"move-cursor",selector:'#constructor .controls:visible [data-name="animation-panel"] [data-value="load"]',delayBefore:400,speed:100},{tp:"click",selector:"prev",delayBefore:400},{tp:"move-cursor",selector:'#constructor .controls:visible [data-name="animation-panel"] .effects-presets-wrapper [data-value="use_scale"]',delayBefore:400,speed:50},{tp:"click",selector:"prev",delayBefore:400},{tp:"move-cursor",selector:'#constructor .controls:visible [data-name="animation-panel"] .loop-types .loop-type-swing',delayBefore:400,speed:150},{tp:"click",selector:"prev",delayBefore:400},{tp:"move-cursor",selector:'#constructor .controls:visible [data-name="animation-control-icon"]',dy:5,speed:300},{tp:"show-panel",corner:"right",ax:"right",dx:-205,ay:"bottom",dy:80,cy:110,selector:"prev",caption:"Animations",text:"Add interactivity to your layout with Animations. Make adjustments via the Animations panel on the right."},{tp:"click",selector:"prev"},{direction:"back",tp:"click",selector:'#constructor .controls:visible [data-name="animation-control-icon"]'},{direction:"back",tp:"move-cursor",selector:'#constructor .controls:visible [data-name="animation-control-icon"]',dy:5},{direction:"back",tp:"click",selector:"#constructor .workspace .shape"},{tp:"move-cursor",selector:"#preview-toggle-button"},{tp:"show-panel",corner:"bottom",ax:"right",dx:91,ay:"bottom",dy:-60,cx:0,selector:"prev",caption:"Preview",text:"Click the Preview icon to check on your project before publishing."},{tp:"click",selector:"prev",delayAfter:function(t){!function e(){u.a.delay((function(){Object(tn.a)("#mags *").length?u.a.delay(t,500):e()}),100)}()}},{direction:"back",tp:"move-cursor",selector:"#preview-toggle-button",speed:1/0},{direction:"back",tp:"click",selector:"#preview-toggle-button",delayAfter:function(t){!function e(){u.a.delay((function(){Object(tn.a)("#constructor .workspace .shape").length?u.a.delay(t,200):e()}),100)}()}},{tp:"move-cursor",selector:"#preview-toggle-button",speed:1/0},{tp:"show-panel",corner:"bottom",ax:"right",dx:91,ay:"bottom",dy:-60,cx:0,selector:"prev",caption:"Preview Mode Capabilities",text:"In Preview mode, you can assess how your layout will look as a published project, including animations."},{direction:"back",tp:"move-cursor",selector:"#preview-toggle-button",speed:300},{tp:"move-cursor",selector:"#publish-button",speed:200},{tp:"show-panel",corner:"bottom",ax:"right",dx:140,ay:"bottom",dy:-60,cx:0,selector:"prev",caption:"Publish",text:"Click on the Publish button to make your project public."}]),Yl=m.a.View.extend({events:{"click .tour-welcome .selector-wrapper .left":"startTour","click .tour-welcome .close":"hide",click:"stopPropagation"},initialize:function(t){u.a.bindAll(this),u.a.extend(this,t),this.template=Wl.a["template-constructor-help-tour"],this.templateWelcome=Wl.a["template-constructor-help-tour-welcome"],this.templateStep=Wl.a["template-constructor-help-tour-step"]},className:"help-tour invisible",render:function(){return this.currentState="",this.previousState="",this.$el.html(this.template()),Object(tn.a)("#constructor").append(this.$el),this.delegateEvents(),this},setCurrentState:function(t){this.previousState=this.currentState,this.currentState=t},show:function(){this.render(),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("help-tour")})),this.$el.attr("tabindex",-1),this.restoreFocus(),this.$el.on("keydown",this.onKeyDown),this.$el.on("focusout",this.restoreFocus),Object(tn.a)(window).bind("resize",this.onResize),u.a.defer((function(){RM.common.disableShortcuts["help-tour"]=!0})),this.startWelcome(),this.sendAnalyticsEvent("Help Tour",{label:"Source",value:this.isAutoShow?"auto":"manual"}),u.a.defer(function(){this.$el.removeClass("invisible")}.bind(this))},hide:function(){"welcome"===this.currentState&&this.$welcome&&this.collapsePanelToTarget(this.$welcome,"help"),"finish"===this.currentState&&this.$stepPanel&&this.collapsePanelToTarget(this.$stepPanel,"menu"),this.$el.off("keydown",this.onKeyDown),this.$el.off("focusout",this.restoreFocus),Object(tn.a)(window).unbind("resize",this.onResize);var t="step"===this.currentState||"tour"===this.currentState?this.tourData&&this.tourData.currentStep:this.currentState;"welcome"===this.currentState?this.sendAnalyticsEvent("Help Tour","Skipped"):"finish"===this.currentState?this.sendAnalyticsEvent("Help Tour","Finished"):this.sendAnalyticsEvent("Help Tour","Stopped on "+t+" stage"),u.a.defer((function(){delete RM.common.disableShortcuts["help-tour"]})),this.$el.addClass("invisible"),u.a.delay(this.remove,500),"function"==typeof this.cbOnClose&&u.a.delay(this.cbOnClose,1e3)},collapsePanelToTarget:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"help",i=t.offset().left+t.width()/2,n=t.offset().top+t.outerHeight()/2,o="help"===e?Object(tn.a)('[aria-labelledby="open-help-popup"], [aria-labelledby="start-quick-tour"], [aria-labelledby="open-help-panel"]'):Object(tn.a)("#mags .menu-button"),a=o.offset().left+o.width()/2,r=o.offset().top+o.height()/2;ie.default.applyTransition(t,"400ms transform ease-in"),ie.default.applyTransform(t,"translate("+(a-i)+"px, "+(r-n)+"px) scale(0.1)")},stopPropagation:function(t){t.stopPropagation()},sendAnalyticsEvent:function(t,e){var i=RM.constructorRouter||RM.collectorRouter||RM.viewerRouter||RM.homepageRouter;i&&i.analytics&&i.analytics.sendEvent(t,e)},restoreFocus:function(){u.a.delay(function(){this.$el.focus()}.bind(this),100),u.a.delay(function(){this.$el.focus()}.bind(this),300),u.a.delay(function(){this.$el.focus()}.bind(this),500)},onKeyDown:function(t){if(t.stopPropagation(),t.ctrlKey||t.metaKey)return!0;if("input"!==t.target.tagName.toLowerCase()&&"textarea"!==t.target.tagName.toLowerCase()){if(t.keyCode===tn.a.keycodes.esc){if("welcome"===this.currentState)return void this.hide();if("step"===this.currentState&&this.$stepPanel)return void ie.default.simulateEvent(this.$stepPanel.find(".close")[0],"click",{});if("finish"===this.currentState)return void this.hide()}if(t.keyCode===tn.a.keycodes.right){if("welcome"===this.currentState)return void this.startTour();if("step"===this.currentState&&this.$stepPanel)return void ie.default.simulateEvent(this.$stepPanel.find(".next")[0],"click",{});if("finish"===this.currentState)return void this.hide()}if(t.keyCode===tn.a.keycodes.left){if("welcome"===this.currentState)return void this.hide();if("step"===this.currentState&&this.$stepPanel)return void ie.default.simulateEvent(this.$stepPanel.find(".back")[0],"click",{})}}},onResize:function(){"step"!==this.currentState&&"tour"!==this.currentState||this.repositionTourElements()},startWelcome:function(){this.$welcome=Object(tn.a)(this.templateWelcome()),this.$el.append(this.$welcome),this.setCurrentState("welcome")},startTour:function(){this.$welcome.fadeOut(300),u.a.delay(function(){this.$welcome.remove()}.bind(this),2e3),this.sendAnalyticsEvent("Help Tour","Started"),this.setCurrentState("tour"),this.tourData={totalSteps:u.a.filter(this.actions,(function(t){var e="function"==typeof t?t():t;return e&&"show-panel"===e.tp})).length,currentStep:0,$elps1:this.$("#help-tour-bg-clip-ellipse-main"),$elps2:this.$("#help-tour-bg-clip-ellipse-another"),$cursor:this.$(".cursor"),prevCursorX:0,prevCursorY:0},this.makeAction(0)},finishTour:function(){this.setCurrentState("finish"),this.hideCursorAndEllipses(),this.hide(),u.a.delay(function(){this.makeActionClick({tp:"click",selector:"#constructor .toolbar .preview-button"})}.bind(this),800)},makeAction:function(t){var e=this;"step"===this.previousState&&"back"===this.currentState&&(t-=2),"step-back"===this.previousState&&"tour"===this.currentState&&(t+=2);var i="step-back"===this.currentState||"back"===this.currentState?t-1:t+1;if("back"===this.currentState||"step-back"===this.currentState?this.setCurrentState("step-back"):this.setCurrentState("tour"),-1===i)return this.hideCursorAndEllipses(),void this.startWelcome();if(this.actions[t]){var n="function"==typeof this.actions[t]?this.actions[t]():this.actions[t];if(n){var o=u.a.defaults(u.a.clone(n),this.actionsDefaults[n.tp]);if("show-panel"!==o.tp&&("step-back"===this.currentState&&"next"===o.direction||"tour"===this.currentState&&"back"===o.direction))this.makeAction(i);else{var a;"prev"===o.selector&&(o.selector=this.prevSelector),this.prevSelector=o.selector||this.prevSelector;var r="function"==typeof o.delayBefore?o.delayBefore:function(t){setTimeout(t,o.delayBefore)},s="function"==typeof o.delayAfter?o.delayAfter:function(t){setTimeout(t,o.delayAfter)};r((function(){(a=(a=e.actionsFuncs[o.tp])&&e[a])&&a(o,l)}))}}else this.makeAction(i)}else this.finishTour();function l(){s((function(){e.makeAction(i)}))}},hideCursorAndEllipses:function(){ie.default.applyTransition(this.tourData.$elps1,"0.25s fill"),this.tourData.$elps1.attr("fill","white"),ie.default.applyTransition(this.tourData.$elps2,"0.25s fill"),this.tourData.$elps2.attr("fill","white"),this.tourData.$cursor.fadeOut(250)},repositionTourElements:function(){this.positionTourElement("cursor"),this.positionTourElement("elps1"),this.positionTourElement("elps2"),this.$stepPanel&&this.positionTourElement("panel")},positionTourElement:function(t,e,i){if(i=i||{},e||(e=this.tourData["prev-"+t])){var n=this.getNodeCenter(e);if("cursor"===t&&(ie.default.applyTransition(this.tourData.$cursor,(i.time||0)+"ms transform"),ie.default.applyTransform(this.tourData.$cursor,"translate("+n.x+"px, "+n.y+"px)")),"elps1"===t&&(ie.default.applyTransition(this.tourData.$elps1,"2s fill 1s, "+(i.time||0)+"ms transform"),this.moveEllipse(this.tourData.$elps1,n.x,n.y,i.time||0)),"elps2"===t&&this.moveEllipse(this.tourData.$elps2,n.x,n.y,i.time||0),"panel"===t&&this.$stepPanel){var o="";"left"===e.ax&&this.$stepPanel.css("left",n.x),"center"===e.ax&&(this.$stepPanel.css("left","50%"),o+=" translateX(-50%)"),"right"===e.ax&&this.$stepPanel.css("right",this.$el.width()-n.x),"top"===e.ay&&this.$stepPanel.css("top",n.y),"center"===e.ay&&(this.$stepPanel.css("top","50%"),o+=" translateY(-50%)"),"bottom"===e.ay&&this.$stepPanel.css("bottom",this.$el.height()-n.y),o&&ie.default.applyTransform(this.$stepPanel,o)}this.tourData["prev-"+t]=u.a.clone(e)}},makeActionMoveCursor:function(t,e){var i=this.getNodeCenter(t),n=this.tourData.prevCursorX-i.x,o=this.tourData.prevCursorY-i.y,a=Math.pow(n*n+o*o,.5),r=t.speed,s=isFinite(r)?1e3*a/r:0;this.tourData.$elps1.attr("fill","black"),this.positionTourElement("elps1",t,{time:s}),this.tourData.$cursor.fadeIn(250),this.positionTourElement("cursor",t,{time:s}),this.tourData.prevCursorX=i.x,this.tourData.prevCursorY=i.y,setTimeout(e,s)},makeActionShowPanel:function(t,e){"step-back"===this.currentState?this.tourData.currentStep--:(this.setCurrentState("step"),this.tourData.currentStep++),this.$stepPanel=Object(tn.a)(this.templateStep({caption:t.caption,text:t.text,curStep:this.tourData.currentStep,totalStep:this.tourData.totalSteps,corner:t.corner})),this.$el.append(this.$stepPanel),this.positionTourElement("panel",t);var i={};"left"!==t.corner&&"right"!==t.corner||(i[t.ay]=Math.abs(t.dy)+t.cy),"top"!==t.corner&&"bottom"!==t.corner||(i[t.ax]=Math.abs(t.dx)+t.cx),i&&this.$stepPanel.find(".corner").css(i),this.$stepPanel.fadeIn(250),this.$stepPanel.find(".back").one("click",function(){this.setCurrentState("back"),this.$stepPanel.fadeOut(250,function(){this.$stepPanel.remove(),delete this.$stepPanel,e&&e()}.bind(this))}.bind(this)),this.$stepPanel.find(".next").one("click",function(){this.setCurrentState("tour"),this.tourData&&this.tourData.currentStep===this.tourData.totalSteps?e&&e():this.$stepPanel.fadeOut(250,function(){this.$stepPanel.remove(),delete this.$stepPanel,e&&e()}.bind(this))}.bind(this)),this.$stepPanel.find(".close").one("click",function(){this.setCurrentState("tour"),this.$stepPanel.fadeOut(250,function(){this.$stepPanel.remove(),delete this.$stepPanel,this.hide()}.bind(this))}.bind(this))},makeActionClick:function(t,e){var i=this.getNodeCenter(t);ie.default.simulateEvent(Xl(t.selector)[0],"click",{pointerX:i.x,pointerY:i.y}),e&&e()},makeActionDoubleClick:function(t,e){var i=this.getNodeCenter(t);ie.default.simulateEvent(Xl(t.selector)[0],"dblclick",{pointerX:i.x,pointerY:i.y}),e&&e()},makeActionMouseover:function(t,e){Xl(t.selector).addClass("hovered"),e&&e()},makeActionMouseout:function(t,e){Xl(t.selector).removeClass("hovered"),e&&e()},makeActionUndo:function(t,e){var i=this.getNodeCenter(t),n=Xl(t.selector);n.length?(ie.default.simulateEvent(n[0],"click",{pointerX:i.x,pointerY:i.y}),t.steps===1/0?u.a.delay(function(){this.makeActionUndo(t,e)}.bind(this),100):e&&e()):e&&e()},makeActionAnotherEllipse:function(t,e){this.tourData.$elps2.attr("fill","black"),this.positionTourElement("elps2",t,{time:0}),e&&e()},makeActionAnotherEllipseHide:function(t,e){this.tourData.$elps2.attr("fill","white"),e&&e()},moveEllipse:function(t,e,i,n){if(Modernizr.safari5||Modernizr.firefox)n?(ie.default.applyTransition(t,n/2+"ms fill"),setTimeout((function(){t.attr("fill","white"),u.a.delay((function(){t.attr("cx",e).attr("cy",i),t.attr("fill","black")}),n/2)}),0)):t.attr("cx",e).attr("cy",i);else{var o="translate("+e+"px, "+i+"px)";ie.default.applyTransform(t,o)}},getNodeCenter:function(t){var e=Xl(t.selector);return{x:e.length?Math.round(e.offset().left+e.width()/2)+t.dx:0,y:e.length?Math.round(e.offset().top+e.height()/2)+t.dy:0}}}),Xl=function(t){return Object(tn.a)("function"==typeof t?t():t)};Yl.prototype.actionsFuncs={"move-cursor":"makeActionMoveCursor","show-panel":"makeActionShowPanel",click:"makeActionClick",dblclick:"makeActionDoubleClick",mouseover:"makeActionMouseover",mouseout:"makeActionMouseout",undo:"makeActionUndo","another-ellipse":"makeActionAnotherEllipse","another-ellipse-hide":"makeActionAnotherEllipseHide"},Yl.prototype.actionsDefaults={"move-cursor":{speed:600,delayBefore:50,delayAfter:100,dx:0,dy:0,direction:"next"},"show-panel":{delayBefore:300,delayAfter:50,dx:0,dy:0,cx:0,cy:0,direction:"next"},click:{delayBefore:100,delayAfter:100,direction:"next"},dblclick:{delayBefore:100,delayAfter:100,direction:"next"},mouseover:{delayBefore:0,delayAfter:0,direction:"next"},mouseout:{delayBefore:0,delayAfter:0,direction:"next"},undo:{delayBefore:10,delayAfter:10,direction:"back"},"another-ellipse":{delayBefore:0,delayAfter:0,dx:0,dy:0,direction:"next"},"another-ellipse-hide":{delayBefore:0,delayAfter:0,direction:"next"}},Yl.prototype.actions=Kl;var Zl=Yl;function Jl(){return(Jl=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}var Ql=function(t){var e=Object(r.useContext)(k),i="".concat(D.a.readymag_host,"/learn"),n="".concat(D.a.readymag_host,"/templates"),a="https://readymag.com/readymag/product-updates/",l=window.RM.constructorRouter&&window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("eduTipsEnabled"),c=Object(r.useCallback)((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"Tour open"}),new Zl({isAutoShow:!1}).show()}),[]),u=Object(r.useCallback)((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"Learn shortcuts"}),(new Hl.a).show()}),[]),p=Object(r.useCallback)((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"Help R/m"}),window.open("https://help.readymag.com","_blank")}),[]),m=Object(r.useCallback)((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"R/m updates"}),window.open(a,"_blank")}),[]),g=Object(r.useCallback)((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"Templates R/m"}),window.open(n,"_blank")}),[]),v=Object(r.useCallback)((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"Learn R/m"}),window.open(i,"_blank")}),[]);return s.a.createElement(d.B,Jl({position:"relative",flexDirection:"column",height:"100%",width:240,bg:"lightGray",p:"28px 24px 32px",id:"help-panel"},t),s.a.createElement(d.n,{color:"tomato",textStyle:"small",position:"absolute",top:16,right:24,onClick:function(){return e.dispatch({type:o.ToggleHelpPanel,open:!1})}},"Close"),s.a.createElement(d.B,{height:48,alignItems:"center"},s.a.createElement(d.Cb,{color:"black",textStyle:"subheading"},"Help")),s.a.createElement(d.B,{m:"0 -8px",flexWrap:"wrap"},s.a.createElement(Nl,{text:"Quick tour","aria-labelledby":"start-quick-tour",onClick:c},s.a.createElement(bl,null)),s.a.createElement(Nl,{text:"Shortcuts","aria-labelledby":"show-shortcuts",onClick:u},s.a.createElement(kl,null)),s.a.createElement(Nl,{href:"https://help.readymag.com",text:"Help page","aria-labelledby":"open-help",onClick:p},s.a.createElement(Ol,null)),s.a.createElement(Nl,{href:a,text:"R/m updates","aria-labelledby":"open-updates",onClick:m},s.a.createElement(Il,null)),s.a.createElement(Nl,{href:n,text:"Templates","aria-labelledby":"open-templates",onClick:g},s.a.createElement(Al,null)),s.a.createElement(Nl,{href:i,text:"Learn more","aria-labelledby":"open-learn",onClick:v},s.a.createElement(Ll,null))),Object(f.a)("constructor.eduTips")&&l&&s.a.createElement(d.B,{mt:"auto",justifyContent:"space-between",alignItems:"center"},s.a.createElement(d.m,null,s.a.createElement(d.Cb,{textStyle:"small"},"Contextual tips")),s.a.createElement(d.m,null,s.a.createElement(d.zb,{backgroundChecked:"tomato",checked:e.showTips,onChange:function(t){t||window.RM.constructorRouter.trigger("notice:hide"),h.d.sendEvent(h.b.TipsToggle,{eventLabel:"Tips ".concat(t?"on":"off")}),e.dispatch({type:o.ToggleShowTips})}}))))};function tc(t){return function(t){if(Array.isArray(t))return ec(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ec(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ec(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ec(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ic=Object(a.e)(Pr).withConfig({displayName:"Settings___StyledToolbar"})(["z-index:",";"],(function(t){return t._css})),nc=Object(a.e)(d.m).withConfig({displayName:"Settings___StyledBox"})(["position:fixed;bottom:16px;right:16px;z-index:",";transform:",";transition:transform "," ease;"],(function(t){return t._css2}),(function(t){return t._css3}),(function(t){return t._css4})),oc=Object(a.e)(d.m).withConfig({displayName:"Settings___StyledBox2"})(["transform:translateX( "," );transition:transform "," ease;"],(function(t){return t._css5}),(function(t){return t._css6})),ac=Object(a.e)(d.Z).withConfig({displayName:"Settings___StyledOverlay"})(["background-color:",";"],(function(t){return t._css7})),rc=function(){var t=Object(r.useContext)(k),e=Object(r.useContext)(rd);Object(r.useEffect)((function(){t.isSettingsOpened?document.body.classList.add("settings-is-shown"):document.body.classList.remove("settings-is-shown")}),[t.isSettingsOpened]),Object(r.useEffect)((function(){t.isSettingsOpened&&e.renewLastScreenshot()}),[t.isSettingsOpened]),Object(r.useEffect)((function(){t.showTourOnOpen&&(t.dispatch({type:o.ToggleShowTourOnOpen,showOnOpen:!1}),setTimeout((function(){h.d.sendEvent(h.b.ConstructorHelpOpen,{eventLabel:"Tour open"}),new Zl({isAutoShow:!0}).show()}),400))}),[t.showTourOnOpen]);var i=Object(r.useRef)(null),n=function(t){return Array.from(document.querySelectorAll("#settings-container, #react-aria-modal-dialog, .pages-panel-settings-overlay, .template-center, #my-templates-modal, .constructor-navigation-arrows, body > .popups, .code-editor-modal-overlay, .help-tour, .help-shortcuts, .code-editor-block")).find((function(e){return e&&e.contains(t)}))},a=Object(r.useCallback)((function(e){i.current?i.current=null:e.target&&document.body.contains(e.target)&&!n(e.target)&&t.dispatch({type:o.CloseSettingsSidebar})}),[]),l=Object(r.useCallback)((function(t){t.target&&document.body.contains(t.target)&&n(t.target)?i.current=t.target:i.current&&(i.current=null)}),[]);Object(r.useEffect)((function(){return t.isSettingsOpened?(window.addEventListener("click",a),window.addEventListener("mousedown",l)):(window.removeEventListener("click",a),window.removeEventListener("mousedown",l)),function(){window.removeEventListener("click",a),window.removeEventListener("mousedown",l)}}),[t.isSettingsOpened]),Object(r.useEffect)((function(){t.isHelpPanelOpen&&h.d.sendEvent(h.b.HelpOpen,{eventLabel:"constructor"})}),[t.isHelpPanelOpen]);var c=t.inPreview?t.isMagMenuOpen?"horizontal"===t.magMenuOrientation?"translateY(-184px)":"translateX(-240px)":t.isCartSidebarOpened?"translateX(-280px)":"translate(0px, 0px)":t.isSettingsOpened?t.isTrashOpened||t.isPageSettingsOpened?"translateX(-480px)":"translateX(-240px)":"translate(0px, 0px)",u=!t.inPreview,p=t.magMenuOn&&!t.controlsOnTop,m=Object(E.d)(u,null,{immediate:p,config:{duration:p?0:200},from:{opacity:0},enter:{opacity:1},leave:{opacity:0}});return s.a.createElement(s.a.Fragment,null,s.a.createElement(ic,{transform:c,_css:t.inPreview?Z+1:Z-2}),m.map((function(t){var i,n=t.item,o=t.key,a=t.props;return n&&s.a.createElement(E.a.div,{style:a,key:o},s.a.createElement(nc,{_css2:Z+1,_css3:c,_css4:tt},(null===(i=e.me.ab_flags)||void 0===i?void 0:i.constructor_show_double_settings_btn)?s.a.createElement(Kr,null):s.a.createElement(Fr,null)))})),s.a.createElement(oc,{id:"constructor-settings-sidebar",width:240,height:"100%",position:"fixed",top:"0",right:"0",bottom:"0",zIndex:Z,_css5:t.isSettingsOpened?t.isTrashOpened||t.isPageSettingsOpened?"-240px":"0px":"240px",_css6:tt},s.a.createElement(d.m,{width:240,height:"100%",pt:0,bg:"lightGray",color:"black"},s.a.createElement(d.m,{id:"settings-popup-container",position:"absolute",top:"0",left:"0",width:"100%"}),s.a.createElement($,null),s.a.createElement(Ui,null),s.a.createElement(Wo,null)),t.isHelpPanelOpen&&s.a.createElement(Ql,{position:"absolute",top:0,left:0,zIndex:1})),s.a.createElement(na,null),s.a.createElement(Ka,null),s.a.createElement(ts,null),t.isTeamworkModalOpened&&s.a.createElement(ml,{projects:e.teamworkProjects,allProjects:e.allProjects,myTeam:e.team,sharedTeam:[],user:e.me,show:!0,onExit:function(){t.dispatch({type:o.ToggleTeamworkModal,payload:!1})},sharedMode:cl.ByMe,onTeammateAdd:function(t){e.updateTeam([].concat(tc(e.team),[t]),e.project.num_id)},onTeammateRemove:function(t){e.updateTeam(tc(e.team.filter((function(e){return e._id!==t._id}))),e.project.num_id)},onTeammateUpdate:function(t){e.updateTeam(tc(e.team.map((function(e){return e._id===t._id?t:e}))),e.project.num_id)}}),(t.isUserTemplatesModalShown||t.isTeamworkModalOpened||t.isRmTemplatesModalShown)&&s.a.createElement(ac,{zIndex:7149,onClick:function(){t.isUserTemplatesModalShown?t.dispatch({type:o.ToggleUserTemplatesModal}):t.isRmTemplatesModalShown&&t.dispatch({type:o.ToggleRmTemplatesModal})},_css7:t.isProjectSettingsOpened?"rgba(0, 0, 0, 0.88)":"rgba(0, 0, 0, 0)"}))},sc=i("epOA"),lc=i.n(sc),cc=i("yjKB"),dc=i.n(cc),hc=m.a.View.extend({events:{"click .button-edit-code":"onEditCodeClick"},used_links:[],initialize:function(t){u.a.bindAll(this),u.a.extend(this,t),this.template=dc.a["template-constructor-pages-panel-settings-info"]},render:function(){var t=this;this.rendered||(this.rendered=!0,this.$el.html(Object(tn.a)(this.template({mag:this.mag.toJSON(),hasProjectCode:this.hasProjectCode(),Constants:D.a}))),this.titleAutoResize=Object(tn.a)(this.$(".textarea.title")).RMAutoResizeTextArea({maxHeight:160,disableMultiline:!0}).data("autoresize"),this.descriptionAutoResize=Object(tn.a)(this.$(".textarea.description")).RMAutoResizeTextArea({maxHeight:2400,maxVisibleHeight:192,$scroll:this.$(".description-scroll")}).data("autoresize"),this.$editCodeButton=this.$el.find(".button-edit-code"),this.$(".input.link").on("input",this.сustomLinkChanged),this.$(".input.link").on("focus",u.a.bind((function(){this.$(".link-status").removeClass("active")}),this)),this.$("textarea, input").on("blur",u.a.bind((function(){this.change()}),this)),Object(f.a)("constructor.newProjectSettings")&&this.mag.on("change:title",(function(e,i){t.$el.find(".textarea.title").val(i)})),this.listenTo(this.parentView,"show",this.onParentViewShow),this.listenTo(this.parentView,"contextmenu.hideall",this.hideAllContextMenus),this.listenTo(this.mag,"change:ci_head",this.onCodeInjectionChange),this.listenTo(this.mag,"change:ci_body_top",this.onCodeInjectionChange),this.listenTo(this.mag,"change:ci_body_bottom",this.onCodeInjectionChange),this.listenTo(this.mag,"change:ci_css",this.onCodeInjectionChange))},get:function(t){return this.$("input, textarea").filter("[data-param='"+t+"']").val()},change:function(t){if(this.сustomLinkChanged(),this.$(".link-status").hasClass("error")){if(t)return void this.$(".link-status").addClass("active");this.$(".input.link").val(this.mag.get("uri")),this.сustomLinkChanged(),this.$(".link-status").hasClass("error")&&(this.$(".input.link").val(this.mag.get("num_id")),this.сustomLinkChanged())}""===this.get("uri")&&(this.$(".input.link").val(this.mag.get("num_id")),this.сustomLinkChanged()),this.get("title")!==this.mag.get("title")||this.get("description")!==this.mag.get("description")||this.get("uri")!==this.mag.get("uri")?this.mag.save({uri:this.get("uri"),title:this.get("title"),description:this.get("description")},{success:t,error:function(){alert("Seems there is a connection problem.")},patch:!0}):t&&t(this.mag.attributes)},"сustomLinkChanged":function(){this.filterCustomLink(),this.checkCustomLink()},filterCustomLink:function(){var t,e,i=Object(tn.a)(this.$(".input.link")),n=i.val();u.a.each([{regex:/(_)/gi,replacer:"-"},{regex:/([^a-zA-Z0-9\-])/gi,replacer:""},{regex:/(\-{2,})/gi,replacer:"-"}],(function(o){e=i.getCursorPos(),(t=n.match(o.regex))&&(n=n.replace(o.regex,o.replacer),i.val(n),i.setCursorPos(e+o.replacer.length-t[0].length))}))},checkCustomLink:function(){var t=this.$(".input.link").val().toLowerCase(),e="";/(^\-)|(\-$)/.test(t)&&(e="The link should not start or end with a hyphen"),/^[0-9]+$/.test(t)&&t!=this.mag.get("num_id")&&(e="The link should not contain only numbers"),"info"==t&&(e="Sorry, info is not acceptable"),t&&t.length>128&&(e="128 symbols max"),u.a.reduce(this.used_links,(function(e,i){return e&&t!=i}),!0)||(e="You already have a project with this link"),this.$(".link-status").toggleClass("hidden",""==t),this.$(".link-status").removeClass("active"),e?(this.$(".link-status").addClass("error"),this.$(".link-status-text").text(e)):(this.$(".link-status").removeClass("error"),this.$(".link-status-text").text(""))},loadUsedLinks:function(){var t=this.mag.get("num_id");if(!this.me.get("_id"))return this.used_links=[];tn.a.ajax({type:"GET",url:"/api/user/"+this.mag.get("user")._id+"/links",dataType:"json",success:u.a.bind((function(e){u.a.isArray(e)&&(this.used_links=u.a.map(e,(function(e){return e.num_id!=t?(e.uri+"").toLowerCase():"-"})))}),this),error:u.a.bind((function(t,e,i){console.log(t,e,i)}),this)})},onTabClick:function(t){var e=Object(tn.a)(t.currentTarget).attr("data-name");this.switchToTab(e)},switchToTab:function(t){var e=this.$(".tab[data-name="+t+"]");e.addClass("active").siblings(".tab").removeClass("active"),this.$switcherKnob.css("left",e.position().left+1)},onParentViewShow:function(){this.loadUsedLinks(),this.сustomLinkChanged(),this.titleAutoResize&&this.titleAutoResize.resizeTextArea(),this.descriptionAutoResize&&this.descriptionAutoResize.resizeTextArea()},hideAllContextMenus:function(){},onEditCodeClick:function(){this.parentView.openCodeEditor()},hasProjectCode:function(){var t=this.mag.toJSON();return u.a.any(["ci_head","ci_body_top","ci_body_bottom","ci_css"],function(e){return!!t[e]}.bind(this))},onCodeInjectionChange:function(){this.hasProjectCode()?this.$editCodeButton.addClass("active"):this.$editCodeButton.removeClass("active")}}),uc=i("CsnC"),pc=i.n(uc),mc=m.a.View.extend({events:{"click .save-password":"onPasswordSaveClick","input .input.password":"onPasswordInputChange","keydown .input.password":"onPasswordInputKeydown","click .expired-subscription-message .link":"privacyAlertUpgrade","click .background .upload-button ":"removeBg","click .background .upload-button .bg-uploader":function(t){t.stopPropagation()}},initialize:function(t){u.a.bindAll(this),u.a.extend(this,t),this.template=pc.a["template-constructor-pages-panel-settings-privacy"],this.magOpts=this.viewOpts},render:function(){var t=!!this.mag.get("is_private");if(!this.rendered){this.rendered=!0,this.$el.html(Object(tn.a)(this.template({mag:this.mag.toJSON(),is_contributor:!RM.constructorRouter.isOwner,owner_email:this.mag.get("user").email}))),this.passSwitcher=Object(tn.a)(this.$(".switcher-password")).RMSwitcher({state:t,height:32},this.onPasswordSwitch).data("switcher"),this.hideSwitcher=Object(tn.a)(this.$(".switcher.hide")).RMSwitcher({state:!this.magOpts.get("hidden"),modelProperty:"hidden","color-0":"#0078ff","color-1":"#c9c8c9",height:32},this.onOptSwitch).data("switcher"),this.indexSwitcher=Object(tn.a)(this.$(".switcher.allowindex")).RMSwitcher({state:this.magOpts.get("allowindex"),modelProperty:"allowindex","color-0":"#0078ff","color-1":"#c9c8c9",height:32},this.onOptSwitch).data("switcher");var e=this.mag.user.get("permissions").viewer_opts_overrides||{};e&&void 0!==e.allowindex&&(this.indexSwitcher.setState(!1),this.indexSwitcher.setDisabled(!0),this.$(".switcher.allowindex").parent().addClass("disabled"));var i=this;this.$(".background .upload-button .bg-uploader").fileupload({dataType:"json",formData:{name:"password-bg"},singleFileUploads:!0,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,dropZone:this.$(".background .upload-button"),start:this.showBgPreloader,error:this.hideBgPreloader,done:function(t,e){i.saveBg(e.result.picture.url),i.hideBgPreloader()},add:function(t,e){i._uploadXHR&&i._uploadXHR.abort(),i._uploadXHR=e.submit()}}),this.$saveButton=this.$(".save-password"),this.updateVisuals(),this.listenTo(this.mag,"change:is_private",this.updateVisuals),this.listenTo(this.parentView,"tab.switch",this.onTabSwitch),this.listenTo(this.mag,"change:pass_bg",this.updateBgSettings),this.updateBgSettings()}},showBgPreloader:function(){this.$(".background .upload-button").addClass("uploading")},hideBgPreloader:function(){this.$(".background .upload-button").removeClass("uploading")},saveBg:function(t){this.mag.save({pass_bg:t},{patch:!0})},removeBg:function(){this.$(".background .upload-button").hasClass("uploading")||this.saveBg("")},updateBgSettings:function(){var t=this.mag.get("pass_bg");this.$(".background .upload-button").toggleClass("uploaded",!!t),this.$(".background .upload-button .bg-uploader").toggle(!t)},disablePrivacy:function(){this.$(".switcher-password").add(this.$(".privacy-caption")).add(this.$(".input-pass-wrapper")).hide(),this.$saveButton.addClass("disabled"),this.$(".expired-subscription-message").removeClass("hidden"),this.$(".noback-message").addClass("invisible"),this.$(".privacy-description").addClass("invisible"),this.forbiddenPrivacy=!0},onPasswordSwitch:function(t){var e=this,i={is_private:!!t},n=Object(tn.a)(".input.password"),o=tn.a.trim(n.val());this.setPasswordStatus(""),(o&&t||!t)&&this.savePrivacy(i,(function(i){i?u.a.delay((function(){e.passSwitcher.setState(!t,!0),e.updateVisuals()}),300):(e.mag.set("is_private",!!t),t&&e.viewOpts.saveOpts({sharebutton:!1}))})),e.updateVisuals(),t&&u.a.delay((function(){n.focus().select()}),500),!0===this.mag.get("is_published")&&this.updateFBCache(),RM.analytics&&RM.analytics.sendEvent("Password Toggle",t?"on":"off")},updateFBCache:function(){tn.a.get("/api/mag/fbcache/"+this.mag.get("num_id"),(function(t){ie.default.facebookGraphRefresh(t)}))},onOptSwitch:function(t,e){var i={};i[e.settings.modelProperty]="hidden"===e.settings.modelProperty?!t:t,this.optsXhr&&this.optsXhr.abort(),this.optsXhr=this.magOpts.save(i);var n="hidden"===e.settings.modelProperty?"Project Visibile to Visitors":"Project Visible to Search Engines",o=null;"Project Visibile to Visitors"===n?o=t?"hidden":"visible":"Project Visible to Search Engines"===n&&(o=t?"visible":"hidden"),RM.analytics&&RM.analytics.sendEvent(n,o)},updateVisuals:function(){var t=this.mag.get("user");this.$(".input-pass-wrapper").toggleClass("invisible",!this.passSwitcher.settings.state),this.$(".background").toggleClass("invisible",!this.passSwitcher.settings.state),this.$(".privacy-description").toggleClass("invisible",!this.passSwitcher.settings.state),this.$(".privacy-opts-block").toggleClass("invisible",this.passSwitcher.settings.state),this.$(".input.password").val(this.mag.get("pass")),this.updateSaveButton(),t&&t.permissions.can_make_mag_private||(this.passSwitcher.settings.state?(this.$(".noback-message").removeClass("invisible"),this.$(".privacy-description").addClass("invisible"),this.$(".input.password").prop("disabled",!0),this.$saveButton.addClass("disabled")):this.disablePrivacy())},setPasswordStatus:function(t,e){self.$(".password-status").toggleClass("error",!!e).toggleClass("hidden",!t).text(t)},onPasswordSaveClick:function(t){this.$saveButton.hasClass("disabled")||this.$saveButton.hasClass("lock")||(this.updatePassword(),RM.analytics&&RM.analytics.sendEvent("Set Project Password"))},onPasswordInputChange:function(t){ie.default.filterNonAscii(Object(tn.a)(t.currentTarget)),this.setPasswordStatus(""),this.updateSaveButton()},updateSaveButton:function(){var t=this.$(".input.password").val();this.$saveButton.toggleClass("disabled",!t),this.$saveButton.toggleClass("lock",t==this.mag.get("pass"))},onPasswordInputKeydown:function(t){13!==t.keyCode||this.$saveButton.hasClass("disabled")||this.$saveButton.hasClass("lock")||(this.updatePassword(),Object(tn.a)(t.currentTarget).focus().select())},updatePassword:function(){var t=this,e=this.$("input.password"),i=e.val(),n=!this.mag.get("pass");i?i!==this.mag.get("pass")&&(this.setPasswordStatus(""),this.savePrivacy({pass:i,is_private:!0},(function(e){e?t.setPasswordStatus("Error saving password",e):(t.mag.set("pass",i),t.mag.set("is_private",!0),t.updateVisuals(),n&&t.updateFBCache())}))):(this.passSwitcher.setState(!1),e.val(t.mag.get("pass")))},savePrivacy:function(t,e){this.isPrivacySaving=!0,this.passXhr&&this.passXhr.abort(),this.passXhr=tn.a.ajax({type:"POST",url:"/api/mag/privacy/"+this.mag.get("num_id"),data:t,success:function(){return e&&e(null)},error:function(t){return console.log("Error changing password: "+t.statusText),e&&e(new Error(t.statusText))},complete:function(){this.isPrivacySaving=!1,this.trigger("mag.privacy.finished")},context:this})},onTabSwitch:function(t){"privacy"===t.name&&(this.setPasswordStatus(""),this.passSwitcher.setState(this.mag.get("is_private"),!0),this.updateVisuals())},privacyAlertUpgrade:function(){var t=RM.constructorRouter&&RM.constructorRouter.analytics;t&&t.sendEvent("Privacy Alert Upgrade")}}),gc=i("oh/L"),fc=i.n(gc);function vc(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function bc(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?vc(Object(i),!0).forEach((function(e){yc(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):vc(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function yc(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var _c=m.a.View.extend({events:{"input .test-block .domain-input":"testInputChanged","input .domain-register-block .domain-input":"registerInputChanged","keydown .test-block .domain-input":"testInputKey","click .test-block .test-button":"testDomain","click .ok-domain-message .map-button":"mapDomain","click .ok-domain-message .map-cancel-button":"cancelMapDomain","click .same-user-domain-message .switch-button":"mapDomain","click .same-user-domain-message .switch-cancel-button":"cancelMapDomain","click .unmap-button":"unmapDomain","click .confirm-message .confirm-unmap-button":"confirmUnmapDomain","click .bottom-cancel-button":"cancelUnmapDomain","click .domain-set-good-message .upload-favicon-button":"uploadFavicon","click .domain-set-good-message .clear-favicon-button":"clearFavicon","click .error-block .try-again-button":"showDomainSettings","click .register-switcher .item:not(.active)":"onRegistrationSwitcherClick","click .domain-register-block .go-button":"onRegisterGoClick","click .domain-setting.favicon .upload-button .favicon-uploader":function(t){t.stopPropagation()},"click .domain-setting.favicon .upload-button ":"clearFavicon","click .expired-subscription-message .link":"domainAlertUpgrade","blur .bottom-ga-gtm-active .ga-block input":"saveGA","blur .bottom-ga-gtm-active .gtm-block input":"saveGTM"},initialize:function(t){var e,i,n=this;if(u.a.bindAll(this),u.a.extend(this,t),this.template=fc.a["template-constructor-pages-panel-settings-domain"],this.isMag="mag"===this.entityType,this.switchers={},this.entity.on("mag_state_changed",this.magStateChanged),this.entity.on("mag_publish_error",this.magStateChanged),this.needLastDomainCheck=!0,!this.viewOpts){i=this.isMag?"/api/mag/opts/"+this.entity.get("num_id"):"/api/me/opts/",e=this.entity.get("opts")||{};var o=m.a.Model.extend({url:i});this.viewOpts=new o(e),this.viewOpts.saveOpts=function(){this.save.apply(this,arguments),n.mag.set("opts",this.toJSON())}}"user"==this.entityType?this.domainType="profile domain":"mag"==this.entityType&&(this.domainType="mag domain"),this.listenTo(this.parentView,"show",this.showDomainSettings),this.listenTo(this.viewOpts,"change:favicon",this.updateFaviconSettings),this.listenTo(this.viewOpts,"change:ga_id",this.updateGA),this.listenTo(this.viewOpts,"change:gtm_id",this.updateGTM),this.listenTo(this.parentView,"tab-switch",(function(t){t&&"domain"==t.panel&&this.showDomainSettings()}))},render:function(){var t=this;if(!this.rendered){this.rendered=!0;var e={entity:this.entity.toJSON(),type:this.entityType,is_contributor:this.isMag?!RM.constructorRouter.isOwner:null,owner_email:this.isMag?RM.constructorRouter.mag.get("user").email:null};this.isMag&&u.a.extend(e,{is_contributor:!RM.constructorRouter.isOwner,owner_email:RM.constructorRouter.mag.get("user").email}),this.$el.html(Object(tn.a)(this.template(bc(bc({},e),{},{Constants:D.a})))),Object(tn.a)(this.$(".domain-setting.favicon .favicon-uploader")).fileupload({dataType:"json",formData:{name:"favicon"},singleFileUploads:!0,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,dropZone:this.$(".domain-setting.favicon .upload-button"),start:this.showFaviconPreloader,error:this.hideFaviconPreloader,done:function(e,i){t.saveFavicon(i.result.baseUrl)},add:function(e,i){t._uploadXHR&&t._uploadXHR.abort(),t._uploadXHR=i.submit()}}),this.updateFaviconSettings(),this.updateGA(),this.updateGTM(),this.createSwitchers(),this.getSSLState()}},createSwitchers:function(){var t=Object(tn.a)(this.$(".ssl-setting .switcher")),e=this.viewOpts,i=e.get("sslState"),n=/pending/.test(i)?"pending on"===i:e.get("ssl");this.switchers.ssl=t.RMSwitcher({state:n,height:32,"color-0":"#0078ff","color-1":"#c9c8c9"},this.changeSSL).data("switcher")},magStateChanged:function(){this.currentXHR&&this.currentXHR.abort(),delete this.currentXHR,this.$(".common-button").removeClass("preloading"),this.showDomainSettings()},showDomainSettings:function(){if(!this.currentXHR){this.showPanelState("initial-preloader");var t=this.entity.get("domain");this.canMapDomain()?!this.isMag||this.entity.get("is_published")?(t?(this.currentXHR&&this.currentXHR.abort(),this.showPanelState("initial-preloader"),this.currentXHR=this.entity.checkDomain(t,u.a.bind((function(e){if(delete this.currentXHR,e)if(e.errors.notPublished)this.showPanelState("unpublished-unmap",{domainName:t});else if(e.errors.noValidSubscription)this.showPanelState("subscription-expired-unmap",{domainName:t});else if(e.errors.domainNotFound)this.showPanelState("domain-set-notfound",{domainName:t});else if(e.errors.badDNSSettings){var i=this.getReadableDNSData(e.dnsSettings);this.showPanelState("domain-set-dns",{domainName:t,recordType:i.recordType,currentValue:i.currentValue,neededValue:i.neededValue})}else this.showPanelState("domain-set-ok-"+this.entityType,{domainName:t,domainUrl:"http://"+t});else this.showPanelState("error")}),this))):this.entity.get("last_checked_domain")&&this.needLastDomainCheck?(this.showPanelState("test",{domainName:this.entity.get("last_checked_domain")}),this.testDomain()):this.showPanelState("test"),this.needLastDomainCheck=!1):this.showPanelState("unpublished"+(t?"-unmap":""),{domainName:t}):this.showPanelState("subscription-expired"+(t?"-unmap":""),{domainName:t})}},testDomain:function(){if(!this.currentXHR){var t=this.filterDomainName(this.$(".test-block .domain-input").val());""!=t&&(this.showPanelState("test"),/\:|\@|\\|\//.test(t)?this.showPanelState("test-invalid"):(this.currentXHR&&this.currentXHR.abort(),this.$(".test-block .test-button").addClass("preloading"),this.currentXHR=this.entity.checkDomain(t,u.a.bind((function(e){if(this.$(".test-block .test-button").removeClass("preloading"),delete this.currentXHR,!e)return this.showPanelState("error"),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: no response from server"));if(e.errors.notPublished)return this.showPanelState("unpublished"),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: unpublished"));if(e.errors.noValidSubscription)return this.showPanelState("subscription-expired"),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: subscription expired"));if(e.errors.badDomainName)return this.showPanelState("test-invalid"),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: invalid symbols"));if(e.errors.domainNotFound)return this.showPanelState("test-notfound"),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: nslookup not found"));var i=u.a.bind((function(){this.showPanelState("test-dns",{domainName:t,recordType:n.recordType,currentValue:n.currentValue,neededValue:n.neededValue,ipv6Present:e.errors.ipv6Present,hideRecordMessages:!e.errors.badDNSSettings})}),this);if(e.errors.badDNSSettings||e.errors.ipv6Present){var n=this.getReadableDNSData(e.dnsSettings);return tn.a.ajax({url:"http://"+t+"/api/domainmaptest",timeout:5e3,success:u.a.bind((function(t){t&&t.domainOk?i():this.showPanelState("wait-our-dns-server")}),this),error:i}),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: bad dns settings "+n.recordType))}var o=e.domain_data||{},a=o.mag||{},r=o.user||a.user||{},s=r.name||"UNKNOWN",l="/"+(r.uri||"UNKNOWN")+"/",c=l+(a.uri||"UNKNOWN")+"/",d=a.title||c;if(e.errors.domainUsed)return e.errors.usedByOtherUser?this.showPanelState("test-other-user",{userName:s,userUrl:l}):this.showPanelState("test-same-user",{magName:d,magUrl:c,entityType:o.type,userUrl:l}),void(RM.analytics&&RM.analytics.sendEvent("Map Domain","error: already in use"));o.type&&o.type.toLowerCase()!==this.entityType?this.showPanelState("test-same-user",{magName:d,magUrl:c,entityType:o.type,userUrl:l}):this.showPanelState("test-ok")}),this))))}},getReadableDNSData:function(t){var e="UNKNOWN",i="UNKNOWN",n="UNKNOWN";return t&&(t.arecord&&(e="A-record",i=t.usedArecord||i,n=t.validArecord||n),t.cname&&(e="CNAME-record",i=t.usedCname||i,n=t.validCname&&t.validCname+"."||n)),{recordType:e,currentValue:i,neededValue:n}},mapDomain:function(t){if(!this.currentXHR){var e=Object(tn.a)(t.target);this.currentXHR&&this.currentXHR.abort(),e.addClass("preloading");var i=this.filterDomainName(this.$(".test-block .domain-input").val());this.currentXHR=this.entity.mapDomain(i,{success:u.a.bind((function(t){e.removeClass("preloading"),delete this.currentXHR,this.showDomainSettings(),this.isMag?tn.a.get("/api/mag/fbcache/"+this.entity.get("num_id"),(function(t){ie.default.facebookGraphRefresh(t)})):ie.default._sendFBGraphRequest("http://"+i);var n=/^www\./.test(i)?" www":"";RM.analytics&&RM.analytics.sendEvent("Map Domain","success"+n)}),this),error:u.a.bind((function(t){e.removeClass("preloading"),delete this.currentXHR,this.showPanelState(t&&t.badDNSSettings?"domain-set-try-later":"error")}),this)})}},confirmUnmapDomain:function(t){if(!this.currentXHR){var e=Object(tn.a)(t.target);this.currentXHR&&this.currentXHR.abort(),e.addClass("preloading"),this.currentXHR=this.entity.unmapDomain(u.a.bind((function(t){e.removeClass("preloading"),delete this.currentXHR,this.showDomainSettings(),this.viewOpts.get("ssl")&&(this.viewOpts.save({ssl:!1}),this.entity.changeSSL(this.entity.get("domain"),!1))}),this))}},testInputChanged:function(t){this.showPanelState("test"),this.$(".test-block .test-button").toggleClass("disabled",""===this.filterDomainName(this.$(".test-block .domain-input").val()))},registerInputChanged:function(t){var e=Object(tn.a)(t.currentTarget).val(),i=this.$(".domain-register-block .go-button"),n=e?"https://iwantmyname.com/services/social/readymag-custom-domain?_r=readymag&domain="+encodeURIComponent(e):"https://iwantmyname.com";i.attr("href",n).toggleClass("disabled",!e)},testInputKey:function(t){13===t.keyCode&&this.testDomain()},cancelMapDomain:function(){this.showPanelState("test")},unmapDomain:function(){this.showPanelState("unlink-confirmation",{domainName:this.entity.get("domain")})},cancelUnmapDomain:function(){this.showPanelState(this.lastState.state,this.lastState.params)},showPanelState:function(t,e){if(!this.currentXHR){var i={"initial-preloader":[".initial-preloader"],test:[".header-message",".register-switcher",".test-block",".bottom-ga-gtm-inactive",".bottom-help-button"],"test-invalid":[".header-message",".register-switcher",".test-block",".invalid-domain-message",".bottom-ga-gtm-inactive",".bottom-help-button"],"test-notfound":[".header-message",".register-switcher",".test-block",".notfound-domain-message",".bottom-ga-gtm-inactive",".bottom-help-button"],"test-other-user":[".header-message",".register-switcher",".test-block",".other-user-domain-message",".bottom-ga-gtm-inactive",".bottom-help-button"],"test-same-user":[".header-message",".register-switcher",".test-block",".same-user-domain-message",".bottom-ga-gtm-inactive",".bottom-help-button"],"test-dns":[".header-message",".register-switcher",".test-block",".dns-domain-message",".bottom-ga-gtm-inactive",".bottom-help-button"],"test-ok":[".header-message",".test-block",".ok-domain-message",".bottom-ga-gtm-inactive",".bottom-help-button"],register:[".header-message",".register-switcher",".domain-register-block",".bottom-ga-gtm-inactive",".bottom-help-button"],"domain-set-ok-mag":[".header-message",".unmap-message",".domain-readonly-block",".bottom-ga-gtm-active",".bottom-72-message",".domain-setting.favicon",".bottom-help-button",".ssl-setting"],"domain-set-ok-user":[".header-message",".unmap-message",".domain-readonly-block",".domain-setting.favicon",".bottom-ga-gtm-active",".bottom-72-message",".bottom-help-button",".ssl-setting"],"domain-set-notfound":[".header-message",".unmap-message",".domain-readonly-block",".domain-set-notfound-message",".bottom-ga-gtm-active",".bottom-help-button"],"domain-set-dns":[".header-message",".unmap-message",".domain-readonly-block",".domain-set-bad-message",".bottom-ga-gtm-active",".bottom-help-button"],"subscription-expired":[".expired-subscription-message",".upgrade-button",".bottom-help-button"],"subscription-expired-unmap":[".expired-subscription-message",".upgrade-button",".bottom-help-button",".bottom-unmap-message"],unpublished:[".unpublished-message",".bottom-ga-gtm-inactive",".bottom-help-button"],"unpublished-unmap":[".unpublished-message",".bottom-ga-gtm-inactive",".bottom-help-button",".bottom-unmap-message"],"unlink-confirmation":[".confirm-message",".bottom-cancel-button"],error:[".error-message",".bottom-support-button"],"domain-set-try-later":[".dns-not-updated-yet",".bottom-help-button"],"wait-our-dns-server":[".wait-our-dns-server","bottom-help-button"]},n=i[t];if(n){var o=Object(tn.a)(n.join(","),this.$el).removeClass("invisible");if(this.$(".section").not(o).addClass("invisible"),"test"==t&&e&&(this.$(".test-block .domain-input").val(e.domainName),this.testInputChanged()),"test-other-user"==t&&e&&this.$(".other-user-domain-message .user-button").attr("href",e.userUrl).text(e.userName),"test-same-user"==t&&e){var a="mag"==e.entityType.toLowerCase()?e.magUrl:e.userUrl;this.$(".same-user-domain-message .mag-button").attr("href",a).text(e.magName),this.$(".entity-type").text("mag"==e.entityType.toLowerCase()?" the project ":" your profile"),this.$(".mag-button").toggleClass("invisible","user"==e.entityType.toLowerCase())}"test-dns"==t&&e&&(this.$(".dns-domain-message .domain-record-type").text(e.recordType),this.$(".dns-domain-message .domain-current-value").text(e.currentValue),this.$(".dns-domain-message .domain-needed-value").text(e.neededValue),this.$(".dns-domain-message .domain-set-phrase").toggleClass("invisible","UNKNOWN"==e.currentValue),this.$(".dns-domain-message .domain-set-phrase-unknown").toggleClass("invisible","UNKNOWN"!==e.currentValue),this.$(".dns-domain-message .domain-current-value").toggleClass("invisible","UNKNOWN"==e.currentValue),this.$(".dns-domain-message .record-error").toggleClass("invisible",e.hideRecordMessages),this.$(".dns-domain-message .record-delay").toggleClass("invisible",e.hideRecordMessages),this.$(".dns-domain-message .ipv6-message").toggleClass("invisible",!e.ipv6Present)),"domain-set-ok-mag"!=t&&"domain-set-ok-user"!=t||!e||(this.$(".domain-readonly-block .domain-readonly-input").val(e.domainName),this.$(".bottom-72-message .your-site-button").attr("href",e.domainUrl),this.viewOpts.saveOpts({endpage:!1})),"domain-set-notfound"==t&&e&&this.$(".domain-readonly-block .domain-readonly-input").val(e.domainName),"domain-set-dns"==t&&e&&(this.$(".domain-readonly-block .domain-readonly-input").val(e.domainName),this.$(".domain-set-bad-message .domain-record-type").text(e.recordType),this.$(".domain-set-bad-message .domain-current-value").text(e.currentValue),this.$(".domain-set-bad-message .domain-needed-value").text(e.neededValue),this.$(".domain-set-bad-message .domain-set-phrase").toggleClass("invisible","UNKNOWN"==e.currentValue),this.$(".domain-set-bad-message .domain-set-phrase-unknown").toggleClass("invisible","UNKNOWN"!==e.currentValue),this.$(".domain-set-bad-message .domain-current-value").toggleClass("invisible","UNKNOWN"==e.currentValue)),"subscription-expired-unmap"==t&&e&&this.$(".bottom-unmap-message .domain-name").text(e.domainName),"unpublished-unmap"==t&&e&&this.$(".bottom-unmap-message .domain-name").text(e.domainName),"unlink-confirmation"==t&&e&&this.$(".confirm-message .domain-name").text(e.domainName),"unlink-confirmation"==t&&(this.lastState=this.curState),this.$(".register-switcher .new").toggleClass("active","register"==t),this.$(".register-switcher .registered").toggleClass("active","register"!==t),u.a.each(u.a.keys(i),u.a.bind((function(e){this.$el.toggleClass(e,t==e)}),this)),this.$el.toggleClass("no-gtm",!this.canUseGTM()),/bottom-ga-gtm/.test(n.join(" "))&&"mag"==this.entityType&&this.entity.get("user").domain&&(this.$(".bottom-ga-gtm-inactive").addClass("invisible"),this.$(".bottom-ga-gtm-active").removeClass("invisible")),this.prevState=this.curState,this.curState={state:t,params:e}}}},checkPermission:function(t){var e=this.isMag?RM.constructorRouter:RM.collectorRouter;if(e){var i=this.isMag?e.mag.user:e.me;return i&&i.get("permissions")&&i.get("permissions")[t]}},canMapDomain:function(){return this.checkPermission("can_map_domain")},canUseGTM:function(){return this.checkPermission("can_use_gtm")},filterDomainName:function(t){return t=(t=(t=(t=(t=(t=tn.a.trim(t)).replace(/^\/\//,"")).replace(/^[A-Za-z]+?\:\/\//,"")).replace(/\/.*$/,"")).replace(/\:\d*$/,"")).replace(/^.*?\@/,""),t=tn.a.trim(t)},onRegistrationSwitcherClick:function(t){Object(tn.a)(t.currentTarget).hasClass("new")?this.showPanelState("register"):this.showPrevPanelState()},showPrevPanelState:function(){u.a.isEmpty(this.prevState)||this.showPanelState(this.prevState.state,this.prevState.params)},onRegisterGoClick:function(t){Object(tn.a)(t.currentTarget).hasClass("disabled")?t.preventDefault():this.showPrevPanelState()},saveGA:function(){if(this.isMag){var t=this.$(".bottom-ga-gtm-active .ga-block input").val();t!=this.viewOpts.get("ga_id")&&(this.viewOpts.saveOpts({ga_id:t}),RM.analytics&&RM.analytics.sendEvent("Set Project GA"))}},updateGA:function(){this.isMag&&(this.$(".bottom-ga-gtm-active .ga-block input").val(this.viewOpts.get("ga_id")),this.$(".bottom-ga-gtm-inactive .ga-block input").val(this.viewOpts.get("ga_id")))},saveGTM:function(){if(this.isMag){var t=this.$(".bottom-ga-gtm-active .gtm-block input").val();t!=this.viewOpts.get("gtm_id")&&(this.viewOpts.saveOpts({gtm_id:t}),RM.analytics&&RM.analytics.sendEvent("Set Project GTM"))}},updateGTM:function(){this.isMag&&(this.$(".bottom-ga-gtm-active .gtm-block input").val(this.viewOpts.get("gtm_id")),this.$(".bottom-ga-gtm-inactive .gtm-block input").val(this.viewOpts.get("gtm_id")))},updateFaviconSettings:function(){var t=this.viewOpts.get("favicon"),e=t?"url("+ie.default.addFilenameComponent(t,"57")+")":"";this.$(".domain-readonly-input").css("background-image",e),this.$(".domain-setting.favicon .upload-button").toggleClass("uploaded",!!t),this.$(".domain-setting.favicon .upload-button .favicon-uploader").toggle(!t)},showFaviconPreloader:function(){this.$(".domain-setting.favicon .upload-button").addClass("uploading")},hideFaviconPreloader:function(){this.$(".domain-setting.favicon .upload-button").removeClass("uploading")},saveFavicon:function(t){this.viewOpts.save({favicon:t},{complete:this.hideFaviconPreloader})},clearFavicon:function(){this.$(".domain-setting.favicon .upload-button").hasClass("uploading")||this.viewOpts.save("favicon","")},domainAlertUpgrade:function(){RM.analytics&&RM.analytics.sendEvent("Domain Alert Upgrade",{label:this.domainType,_domain_type:this.domainType})},changeSSL:function(t){this.viewOpts;var e=this.switchers.ssl,i=Object(tn.a)(".ssl-setting .switcher");if(!this.sslXHR){this.sslXHR&&this.sslXHR.abort(),i.addClass("loading"),e.setDisabled(!0);var n=this.entity.get("domain");this.sslXHR=this.entity.changeSSL(n,t,{success:function(){this.getSSLState(!0)}.bind(this),error:function(e){this.resetSSLState(!t),this.showPanelState(e&&e.badDNSSettings?"domain-set-try-later":"error")}.bind(this)})}},getSSLState:function(t){var e=this,i=this.viewOpts,n=this.switchers.ssl,o=Object(tn.a)(".ssl-setting .switcher");n.setDisabled(!0),o.addClass("loading");var a=this.entity.get("domain"),r=this.viewOpts.get("ssl"),s=function(){e.sslCheckStateXHR=e.entity.getSSLState(a,{success:function(n){n&&n.opts&&n.opts.sslState?(r=n.opts.ssl,"success"===n.opts.sslState?(e.resetSSLState(r),t&&i.set({ssl:r}),RM.analytics&&RM.analytics.sendEvent("SSL Toggle","ssl "+(r?"on":"off"))):"error"===n.opts.sslState&&(e.resetSSLState(r),t&&e.showPanelState("error"))):e.resetSSLState(r)},error:function(){e.resetSSLState(r),t&&e.showPanelState("error")}})};this.sslCheckStateInterval=setInterval(s,5e3),s(),this.sslCheckStateTimeout=setTimeout((function(){void 0!==r&&e.resetSSLState(!r),e.showPanelState("error")}),18e4)},resetSSLState:function(t){var e=this.switchers.ssl,i=Object(tn.a)(".ssl-setting .switcher");delete this.sslXHR,this.sslCheckStateXHR&&this.sslCheckStateXHR.abort(),delete this.sslCheckStateXHR,clearInterval(this.sslCheckStateInterval),clearTimeout(this.sslCheckStateTimeout),e.setDisabled(!1),e.setState(t,!0),i.removeClass("loading")}}),wc=i("Zl4r"),kc=i.n(wc),Sc=i("Kw5r"),xc=i("tRog");function Cc(t){return function(t){if(Array.isArray(t))return Oc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Oc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Oc(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var jc=m.a.View.extend({template:kc.a["template-constructor-pages-panel-settings-viewer"],events:{"click .scroll-option":"onScrollOptionClick","click .upgrade-link":"onUpgradeLinkClick","click .learn-more-link":"onLearnMoreClick"},initialize:function(t){u.a.bindAll(this),u.a.extend(this,t),this.switchers={},this.listenTo(this.mag,"change:is_private",this.updateShareSwitcher)},render:function(){var t=this.mag.user.get("permissions").viewer_opts_overrides||{};if(!this.rendered){this.rendered=!0,this.$el.html(Object(tn.a)(this.template({mag:this.mag.toJSON(),is_contributor:!RM.constructorRouter.isOwner,owner_email:this.mag.get("user").email,isNewSettingsEnabled:Object(f.a)("constructor.newProjectSettings")}))),this.createSwitchers(this.viewOpts),this.switchViewerType(this.viewOpts.get("viewertype")),u.a.has(t,"arrows")&&this.$(".upgrade-message").removeClass("hidden"),this.listenTo(this.parentView,"tab.switch",this.onTabSwitch);var e=Sc.default.extend(xc.a);this.numericInput=new e({el:this.$el.find(".amount-px").get(0),propsData:{min:1024,max:9999,mouseUse:!1,thousandDelimiter:",",value:this.viewOpts.get("scalewidth"),disabled:!this.viewOpts.get("scalableviewer")}}),this.onCheckScaleInput(this.numericInput.value),this.numericInput.$on("change",u.a.debounce(this.onCheckScaleInput,100))}},onCheckScaleInput:function(t){var e=t.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1"+this.numericInput.thousandDelimiter);this.numericInput.value=e,this.viewOpts.saveOpts({scalewidth:t})},updateShareSwitcher:function(){var t=this.mag.user.get("permissions").viewer_opts_overrides||{};u.a.has(t,"sharebutton")||(this.switchers.sharebutton.setDisabled(!!this.mag.get("is_private")),this.switchers.sharebutton.setState(!this.mag.get("is_private")&&this.viewOpts.get("sharebutton"),!0))},onTabSwitch:function(t){RM.analytics&&RM.analytics.sendEvent&&!this.$(".upgrade-message").hasClass("hidden")&&"viewer"==t.name&&RM.analytics.sendEvent("White Label Alert Show")},createSwitchers:function(t){var e=this,i=this.mag.user.get("permissions").viewer_opts_overrides||{},n=["arrows","menubutton","projectinfo","sharebutton","pagecounter"].concat(Cc(Object(f.a)("constructor.newProjectSettings")?["controlsontop"]:[]),["controlsontop","endpage","slidein","scalableviewer","lqip"]);u.a.each(u.a.keys(u.a.pick.apply(u.a,[t.attributes].concat(Cc(n)))),(function(n){var o=Object(tn.a)(e.$(".viewer-setting."+n+" .switcher")),a=e.switchers[n]=o.RMSwitcher({state:t.get(n),height:32,"color-0":"#0078ff","color-1":"#c9c8c9","text-0":"","text-1":""},(function(i){u.a.delay((function(){var o={};o[n]=i,t.save_throttled(o,{success:function(){},error:function(){a.setState(!i,!0)}}),"menubutton"===n&&(i||e.switchers.projectinfo.setState(!1),e.setSettingDisabled("projectinfo",!i)),RM.analytics&&RM.analytics.sendEvent("Viewer Options Toggle",n+" "+(i?"on":"off"))}),100),"scalableviewer"===n&&(e.numericInput.disabled=!i)})).data("switcher");u.a.has(i,n)?e.setSettingDisabled(n,!0):("projectinfo"===n&&e.setSettingDisabled(n,!t.get("menubutton")),"sharebutton"===n&&(e.setSettingDisabled(n,!!e.mag.get("is_private")),e.switchers.sharebutton.setState(!e.mag.get("is_private")&&t.get("sharebutton"),!0)))}))},onScrollOptionClick:function(t){var e=Object(tn.a)(t.currentTarget).attr("data-viewertype");this.switchViewerType(e),this.viewOpts.save_throttled({viewertype:e}),RM.analytics&&RM.analytics.sendEvent("Viewer Type Toggle",e)},switchViewerType:function(t){this.$(".scroll-option."+t).addClass("selected").siblings(".scroll-option").removeClass("selected")},onUpgradeLinkClick:function(t){RM.analytics&&RM.analytics.sendEvent&&RM.analytics.sendEvent("White Label Alert Upgrade")},onLearnMoreClick:function(t){RM.analytics&&RM.analytics.sendEvent("Viewer Settings Learn More Click")},setSettingDisabled:function(t,e){var i=this.switchers[t];i&&(i.setDisabled(e),this.$(".viewer-setting."+t).toggleClass("disabled",!!e))}}),Pc=i("5KMv"),Ec=i.n(Pc),Ic=m.a.View.extend({events:{click:"hideOnBgClick","click .done":"hide","click .close":"hide",'focus .radio-group input[type="text"]':"selectCustomType",'change .radio-group input[value="custom"]':"focusOnCustomInput",'change .radio-group input[value="all"]':"onAllTypeSelect","click .create-pdf":"createPDF"},initialize:function(t){u.a.bindAll(this),u.a.extend(this,t),t.parent&&(this.$parent=Object(tn.a)(t.parent))},render:function(){var t=Ec.a["template-common-export-pdf"];this.setElement(Object(tn.a)(t({email:this.email||"your email"}))),this.$parent&&this.$parent.append(this.$el).addClass("visible"),u.a.delay(u.a.bind((function(){this.$el.addClass("show")}),this),50),Object(tn.a)("body").on("keyup",this.onBodyKeyUp)},hide:function(){Object(tn.a)("body").off("keyup",this.onBodyKeyUp),this.$el.removeClass("show").addClass("hide"),u.a.delay(u.a.bind((function(){this.remove(),this.$parent&&this.$parent.removeClass("visible")}),this),400)},onAllTypeSelect:function(t){this.$(".errors").removeClass("visible")},selectCustomType:function(t){this.$('.radio-group input[value="custom"]').attr("checked",!0),this.$(".errors").removeClass("visible")},focusOnCustomInput:function(){this.$('.radio-group input[type="text"]').focus(),this.$(".errors").removeClass("visible")},onBodyKeyUp:function(t){27==t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.hide())},createPDF:function(){var t=this.$(".radio-group  input:radio[name=export-pdf-type]:checked").val(),e=[],i=[],n=this.$('.radio-group input[type="text"]').val();if("custom"==t){var o=(o=n.split(" ").join("")).split(","),a={};if(u.a.each(o,(function(t){if(""!=t)if(/\d+|\d+-\d+/i.test(t)){var i=t.split("-"),n=parseInt(i[0]),o=parseInt(i[1]);if(1==i.length&&(n>0&&n<999?a[n]=!0:e.push(t)),2==i.length)if(n>0&&n<999&&o>0&&o<999&&n<=o)for(var r=n;r<=o;r++)a[r]=!0;else e.push(t)}else e.push(t)})),i=u.a.keys(a),e.length)return this.$(".errors").text("Wrong pages value: "+e[0]),void this.$(".errors").addClass("visible");if(!i.length)return this.$(".errors").text("Empty pages list"),void this.$(".errors").addClass("visible")}this.$el.addClass("done-state"),tn.a.get("/api/makepdf/"+this.mag_num_id,"all"==t?void 0:{pages:i},(function(t){}));var r=RM.collectorRouter||RM.constructorRouter;r&&r.analytics&&r.analytics.sendEvent("PDF Export",{label:this.mag_num_id,_mag_id:this.mag_num_id,_range_type:t,_range:n})},hideOnBgClick:function(t){Object(tn.a)(t.target).hasClass("panel-wrapper")&&this.hide()}}),Tc=i("uGDn"),Mc=i("ubkq"),$c=i.n(Mc);function Ac(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var Rc,Dc,Bc=m.a.View.extend({events:{"click .delete-block .delete":"toggleDeletePanel","click .delete-block .delete-panel-yes":"deleteMag","click .delete-block .delete-panel-cancel":"hideAllContextMenus","click .restore-block .restore":"toggleRestorePanel","click .restore-block .restore-panel-cancel":"hideAllContextMenus","click .restore-block .restore-panel-yes":"restoreMag","click .republish-block .republish-settings":"toggleRepublishPanel","click .republish-panel-minor .republish-panel-text":"setMinorRepublish","click .republish-panel-major .republish-panel-text":"setMajorRepublish","input .republish-panel-desc":"calcRepublishDescSymbols","click .context-block-layer":"hideAllContextMenus","click .categories-wrapper":"toggleCategoriesPanel","click .categories-wrapper .categories-panel-item":"toggleCategoryItem","click .share-block .share-button":"sharePublished","click .export-pdf":"exportPDF","click .export-code":"exportCode","click .publish":"publish","click .republish":"republish","click .unpublish-block .unpublish":"unpublish","click .tab-switcher .tab":"onTabClick"},BG_COUNT:6,initialize:function(t){u.a.bindAll(this),u.a.extend(this,t),this.template=lc.a["template-constructor-pages-panel-settings"];var e=u.a.defaults(this.mag.get("opts")||{},{viewertype:"horizontal",arrows:!0,menubutton:!0,sharebutton:!0,pagecounter:!0,slidein:!1,endpage:!0,endpagetype:"join",scalewidth:3600,lqip:!1}),i="/api/mag/opts/"+this.mag.get("num_id"),n=this,o=m.a.Model.extend({url:i});this.viewOpts=new o(e),this.viewOpts.saveOpts=function(){this.save.apply(this,arguments),n.mag.set("opts",this.toJSON())},this.viewOpts.save_throttled=u.a.throttle(this.viewOpts.saveOpts,500),this.infoPanel=new hc({mag:this.mag,me:this.router.me,parentView:this}),this.privacyPanel=new mc({mag:this.mag,parentView:this,viewOpts:this.viewOpts}),this.domainPanel=new _c({entity:this.mag,entityType:"mag",parentView:this,viewOpts:this.viewOpts}),this.viewerPanel=new jc({mag:this.mag,parentView:this,me:this.router.me,viewOpts:this.viewOpts}),this.render()},render:function(){if(!this.rendered){this.rendered=!0;var t="active"===(this.router.me.get("stripe")||{}).subscription_status,e=Object(tn.a)(this.template({mag:this.mag.toJSON(),isOwner:this.router.isOwner,isBeta:this.router.me.isBetaTester(),isActiveSubscription:t}));this.withOverlay?(this.overlay=Object(tn.a)("<div>",{class:"pages-panel-settings-overlay hidden"}),this.overlay.insertBefore(this.rootElement),e.appendTo(this.overlay)):e.insertBefore(this.rootElement),this.setElement(e),this.$switcherKnob=this.$(".tab-switcher .knob"),this.infoPanel.setElement(this.$(".panel.info")),this.infoPanel.render(),this.listenTo(this.infoPanel,"contextmenu.show",this.hideAllContextMenus),this.privacyPanel.setElement(this.$(".panel.privacy")),this.privacyPanel.render(),this.domainPanel&&this.domainPanel.setElement(this.$(".panel.domain")),this.domainPanel&&this.domainPanel.render(),this.viewerPanel.setElement(this.$(".panel.viewer")),this.viewerPanel.render(),this.onPagesChange(),this.router.pageOrder.on("change:order",this.onPagesChange),this.mag.on("change:pids",this.onPagesChange),RM.constructorRouter.on("updateCover",this.setCover),this.mag.on("mag_state_changed",this.onMagStateChanged),this.mag.on("mag_publish_error",this.onMagPublishError),this.updateMagState(),this.mag&&this.mag.on("changed",this.onChanged),t&&this.submitToExploreController()}},checkIfProjectSubmittedToExplore:function(){return 1===this.mag.attributes.submitted_for_featured},submitToExploreController:function(){this.checkIfProjectSubmittedToExplore()?this.showSubmittedToExplore():this.initSubmitSwitcher()},initSubmitSwitcher:function(){var t=Sc.default.extend(Tc.a);this.submitToExploreSwitcher=new t({el:this.$el.find(".jsSubmitToExploreSwitcher").get(0),propsData:{width:48,height:26,value:!1,colorOff:"#c9c8c9",callback:u.a.once(this.submitToExploreHandler)}})},showSubmittedToExplore:function(){this.$el.find(".jsSubmitToExplorePart").text("Submitted to ").removeClass("hidden")},submitToExploreHandler:function(){var t=this,e=this.$el.find(".mag-url").attr("href");fetch("".concat(window.location.origin,"/api/featured/submit"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({url:e})}).then((function(t){return"OK"===t.statusText?t.json():null})).then((function(e){if(null===e)return!1;RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Submit To Explore"),setTimeout((function(){t.$el.find(".jsSubmitToExplorePart").addClass("hidden"),setTimeout((function(){t.showSubmittedToExplore(),t.$el.find(".jsSubmitToExploreWrapper").addClass("hidden")}),300),t.submitToExploreSwitcher.disableFromOutside()}),500)}))},onMagStateChanged:function(){setTimeout(u.a.bind((function(){this.publishInProgress=!1}),this),400),this.$el.removeClass("publishInProgress").removeClass("republishInProgress").removeClass("unpublishInProgress"),this.updateMagState()},onMagPublishError:function(t){var e=this;if(setTimeout(u.a.bind((function(){this.publishInProgress=!1}),this),400),this.$el.removeClass("publishInProgress").removeClass("republishInProgress").removeClass("unpublishInProgress"),t&&"pageorder"===t.error&&this.mag.publish_attempts<5&&this.panel)return this.panel.contents.pageOrder.trigger("reorder"),void this.panel.contents.pageOrder.once("sync",(function(){this.mag.publish()}),this);this.$el.addClass("publishError"),setTimeout((function(){e.$el.removeClass("publishError")}),5e3)},onChanged:function(){this.$el.addClass("changed")},updateMagState:function(){var t={is_published:this.mag.get("is_published"),published:this.mag.get("published"),updated:this.mag.get("updated"),changed:this.mag.get("changed")};if(this.mag.get("user")){var e=D.a.readymag_host+"/"+this.mag.get("user").uri+"/"+this.mag.get("uri")+"/";this.$(".mag-url").text(e).attr("href",e),this.$(".cover_wrap a").attr("href",e)}t.is_published?(t.published&&this.$(".publish-date span").text($c()(new Date(t.published),"mmm d, yyyy")),t.updated&&this.$(".republish-date span").text($c()(new Date(t.updated),"mmm d, yyyy")),t.published&&t.updated&&this.$(".publish-date span").text()!==this.$(".republish-date span").text()?this.$el.addClass("has-republish-date"):this.$el.removeClass("has-republish-date"),this.$el.addClass("published")):this.$el.removeClass("published"),t.is_published&&t.changed?this.$el.addClass("changed"):this.$el.removeClass("changed")},onPagesChange:function(){var t=u.a.find(this.mag.getActivePages(),u.a.bind((function(t){return 1===t.get("num")}),this));this._firstPage&&this._firstPage.get("_id")===t.get("_id")||(this._firstPage=t,this.setCover())},setCover:function(){var t=this._firstPage?this._firstPage.renewScreenshot().getScreenshot(256):"";t&&this.$(".first-page-screen").attr("src",t)},restoreMag:function(){this.$el.addClass("revert-in-progress"),this.mag&&this.mag.restoreMag((function(){RM.analytics&&RM.analytics.sendEvent("Restore to published",{cb:function(){window.location.reload()}})}))},publish:function(t){var e,i=this,n=this.$(".export-template"),o=n.length&&n.prop("checked");if(!this.publishInProgress){var a=null===(e=this.router.eCommerceManager)||void 0===e?void 0:e.hasEcommerceWidget(),r=this.router.me.get("permissions");if(!r.can_publish||a&&!r.can_use_e_commerce)this.showUpgradeAlert({type:Bc.getPublishUpgradeAlertType(r,a)},"export code");else{if(!Bc.canInjectCode(this.router,this.router.mag)&&!this.codeInjectUpgradeAlertShown)return Bc.showCodeInjectionAlert(this.router,{isContributor:!this.router.isOwner,ownerEmail:this.mag.get("user").email,onSkip:function(){return i.publish(t)}}),void(this.codeInjectUpgradeAlertShown=!0);if(Bc.canUseShots(this.router,this.router.mag)||this.widgetShotsAlertShown){if(this.privacyPanel.isPrivacySaving)return this.stopListening(this.privacyPanel,"mag.privacy.finished"),void this.listenToOnce(this.privacyPanel,"mag.privacy.finished",(function(){return i.publish(t)}));o&&this.router.exportMagAsTemplateset(),this.infoPanel.change(u.a.bind((function(){this.publishInProgress=!0,this.$el.addClass(t?"republishInProgress":"publishInProgress"),this.$el.addClass("can-revert"),RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent(t?"Republish Mag":"Publish Mag","settings"),t?(this.mag&&this.mag.publish(this.$(".republish-panel").hasClass("major"),Object(tn.a)(".republish-panel-desc").val()),this.setMinorRepublish()):this.mag&&this.mag.publish()}),this))}else Bc.showShotsAlert(this.router,{isContributor:!this.router.isOwner,ownerEmail:this.mag.get("user").email,onSkip:function(){i.widgetShotsAlertShown=!0,i.publish(t)}})}}},republish:function(){this.publish(!0)},canExportPDF:function(){var t=this.router&&this.router.me&&this.router.me.get("permissions").can_export_pdf;return t?!!t:(this.showUpgradeAlert({type:"type-export-pdf"},"export pdf"),!1)},canExportCode:function(){var t=this.router&&this.router.me&&this.router.me.get("permissions").can_export_code;return t?!!t:(this.showUpgradeAlert({type:"type-export-code"},"export code"),!1)},showUpgradeAlert:function(t,e){return u.a.extend(t,{is_contributor:!this.router.isOwner,owner_email:this.mag.get("user").email}),this.alertPublisher=new Qi.default({$parent:Object(tn.a)("body > .popups"),router:this.router,opts:t,alert_source:e}),this.alertPublisher.render(),!1},unpublish:function(){this.publishInProgress||this.infoPanel.change(u.a.bind((function(){this.publishInProgress=!0,this.$el.addClass("unpublishInProgress"),RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Unpublish Mag"),this.mag&&this.mag.unpublish()}),this))},hide:function(){this.infoPanel.change(),this.hideAllContextMenus(),this.shown=!1,this.trigger("hide"),this.withOverlay&&this.overlay&&(this.overlay.addClass("hidden"),this.overlay.off("click")),this.$el.addClass("hidden"),clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(u.a.bind((function(){this.$el.addClass("auto-index"),this.closeCodeEditor()}),this),350),Object(tn.a)(document).off("keydown",this.onGlobalKeyDown),this.stopListening(this.mag,"change:is_private",this.updateShareBlock),this.closeCodeEditor(),this.withOverlay||RM.constructorRouter.navigate("edit/"+RM.constructorRouter.mag.get("num_id")+"/contents/",{replace:!0})},show:function(){var t=this;Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("settings")})),this.withOverlay||RM.constructorRouter.navigate("edit/"+RM.constructorRouter.mag.get("num_id")+"/settings/",{replace:!0}),clearTimeout(this.hideTimeout),this.shown=!0,this.trigger("show"),this.withOverlay&&this.overlay&&(this.overlay.removeClass("hidden"),this.overlay.click((function(e){e.target!==t.overlay[0]&&e.target!==t.el||t.hide()}))),this.$el.removeClass("hidden"),this.$el.removeClass("auto-index"),Object(tn.a)(document).on("keydown",this.onGlobalKeyDown),this.listenTo(this.mag,"change:is_private",this.updateShareBlock),this.panel&&this.panel.fixPageOrder()},toggle:function(){this.$(".context-block-layer").hasClass("hidden")?this.shown?this.hide():this.show():this.hideAllContextMenus()},hideAllContextMenus:function(){this.trigger("contextmenu.hideall"),this.$(".context-block-layer").addClass("hidden"),this.$(".delete-block").removeClass("active"),this.$(".restore-block").removeClass("active"),this.$(".republish-block .republish-settings").removeClass("active")},toggleDeletePanel:function(t){if(!(t&&Object(tn.a)(t.target).closest(".context-panel").length>0)){var e=this.$(".delete-block").hasClass("active");this.hideAllContextMenus(),this.$(".delete-block").toggleClass("active",!e),this.$(".context-block-layer").toggleClass("hidden",e)}},toggleRestorePanel:function(t){if(!(t&&Object(tn.a)(t.target).closest(".context-panel").length>0)){var e=this.$(".restore-block").hasClass("active");this.hideAllContextMenus(),this.$(".restore-block").toggleClass("active",!e),this.$(".context-block-layer").toggleClass("hidden",e)}},deleteMag:function(){var t="/"+(this.mag&&this.mag.get("user")&&this.mag.get("user").uri)+"/";this.mag&&this.mag.deleteMag((function(){window.location.href=t}))},toggleRepublishPanel:function(t){if(!(t&&Object(tn.a)(t.target).closest(".context-panel").length>0)){var e=this.$(".republish-block .republish-settings").hasClass("active");this.hideAllContextMenus(),this.$(".republish-block .republish-settings").toggleClass("active",!e),this.$(".context-block-layer").toggleClass("hidden",e)}},setMinorRepublish:function(){this.$(".republish-panel").removeClass("major").addClass("minor")},setMajorRepublish:function(){this.$(".republish-panel").removeClass("minor").addClass("major")},calcRepublishDescSymbols:function(){var t=Object(tn.a)(".republish-panel-desc").val();Object(tn.a)(".republish-panel-desc-symbols").text(Math.max(128-t.length,0))},exportPDF:function(){if(this.canExportPDF()){var t=new Ic({$parent:Object(tn.a)("body > .popups"),email:this.router.me&&this.router.me.get&&this.router.me.get("email"),mag_num_id:this.mag.get("num_id")});t.render()}},exportCode:(Rc=regeneratorRuntime.mark((function t(){var e,n,o,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.canExportCode()){t.next=2;break}return t.abrupt("return");case 2:return e=i("8AXF"),n=e.renderReact,t.next=5,i.e(11).then(i.bind(null,"hB7q"));case 5:return o=t.sent,a=o.CodeExportModalWithContext,r=Object(tn.a)("<div>").appendTo("body > .popups"),n({component:a,domElement:r[0],model:this.mag}),t.abrupt("return");case 10:case"end":return t.stop()}}),t,this)})),Dc=function(){var t=this,e=arguments;return new Promise((function(i,n){var o=Rc.apply(t,e);function a(t){Ac(o,i,n,a,r,"next",t)}function r(t){Ac(o,i,n,a,r,"throw",t)}a(void 0)}))},function(){return Dc.apply(this,arguments)}),sharePublished:function(t){Object(tn.a)(t.currentTarget).hasClass("disabled")||oa.share({host:(this.mag.get("user").domain||this.mag.get("domain")||D.a.readymag_host)+"/",tp:Object(tn.a)(t.currentTarget).attr("data-tp"),source:"constructor",page:null,mag:u.a.extend(this.mag.toJSON(),{pages:this.mag.pages.toJSON()}),forProject:!0,customDomain:!(!this.mag.get("user").domain&&!this.mag.get("domain")),customDomainProfile:!!this.mag.get("user").domain,analytics:this.router.analytics,publishedVersion:!0})},updateShareBlock:function(){this.$(".share-facebook, .share-twitter").toggleClass("disabled",this.mag.get("is_private"))},onTabClick:function(t){var e=Object(tn.a)(t.currentTarget),i=e.attr("data-name");e.hasClass("active")||this.switchToTab(i)},switchToTab:function(t){var e,i,n=this.$(".tab[data-name="+t+"]");this.hideAllContextMenus(),n.addClass("active").siblings(".tab").removeClass("active"),i=0===(e=n.position().left)?1:e,this.$switcherKnob.css("left",i),this.$(".panel."+t).removeClass("hidden").siblings(".panel").addClass("hidden"),this.trigger("tab.switch",{name:t});var o=RM.analytics;if("domain"===t&&this.domainPanel&&!this.domainPanel.canMapDomain()&&o&&o.sendEvent("Domain Alert Show",{label:"mag domain",_domain_type:"mag domain"}),"privacy"===t&&this.privacyPanel&&this.privacyPanel.forbiddenPrivacy&&o&&o.sendEvent("Privacy Alert Show"),o){var a="/"+m.a.history.getFragment();a+="info"!==t?t:"",o.trackPage({page:a})}},openCodeEditor:function(){this.router.openCodeEditor()},closeCodeEditor:function(){this.router.closeCodeEditor()}},{getPublishUpgradeAlertType:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&!t.can_use_e_commerce)return"type-publish-ecommerce";var i=t._reasons||{},n=i.can_publish&&i.can_publish.code;return"reason_publish_limit"===n?"type-publish-limit":"type-publish-noemail"},canInjectCode:function(t,e){return t.me&&(!e.hasCodeInjection()||t.me.get("permissions").can_inject_code)},canUseShots:function(t,e){return t.me&&(!e.hasWidgetsWithType("shots")||t.me.get("permissions").can_use_shots)},canUseForms:function(t,e){return t.me&&(!e.hasWidgetsWithType("form")||t.me.get("permissions").can_use_forms)},showCodeInjectionAlert:function(t,e){var i=e.isContributor,n=e.ownerEmail,o=e.onSkip,a=new Qi.default({$parent:Object(tn.a)("body > .popups"),router:t,opts:{type:"type-code-injection",is_contributor:i,owner_email:n},alert_source:"code injection"});m.a.listenToOnce(a,"hide",(function(t){return"skip"===t.lastButtonClicked&&o&&o()})),a.render()},showShotsAlert:function(t,e){var i=e.isContributor,n=e.ownerEmail,o=e.onSkip,a=new Qi.default({$parent:Object(tn.a)("body > .popups"),router:t,opts:{type:"type-widget-shots",is_contributor:i,owner_email:n},alert_source:"Shots widget"});m.a.listenToOnce(a,"hide",(function(t){return"skip"===t.lastButtonClicked&&o&&o()})),a.render()},showUpgradeAlert:function(t,e){var i=e.type,n=e.isContributor,o=e.ownerEmail,a=e.source;new Qi.default({$parent:Object(tn.a)("body > .popups"),router:t,opts:{type:i,is_contributor:n,owner_email:o},alert_source:a}).render()}}),Lc=Bc,zc=i("DqjY"),Fc=i("phNm");function Uc(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Nc(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Uc(Object(i),!0).forEach((function(e){Hc(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Uc(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Hc(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Vc(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var Wc=s.a.createContext({}),Gc=function(t){var e=t.model,i=t.children,n=Object(r.useCallback)(function(){var t=function(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Vc(a,n,o,r,s,"next",t)}function s(t){Vc(a,n,o,r,s,"throw",t)}r(void 0)}))}}(regeneratorRuntime.mark((function t(i){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Nc(Nc({},e.get("opts")),i),e.set("opts",n),t.next=4,Object(nt.C)(e.get("num_id"),n);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),o=Object(r.useCallback)((function(t){return n({scalableviewer:t})}),[]),a=Object(r.useCallback)((function(t){return n({scalewidth:t})}),[]),l=Object(r.useCallback)((function(t){return n({viewertype:t})}),[]),c=Object(r.useCallback)((function(t){return n({arrows:t})}),[]),d=Object(r.useCallback)((function(t){return n({slidein:t})}),[]),h=Object(r.useCallback)((function(t){return n({lqip:t})}),[]);return s.a.createElement(Wc.Provider,{value:{project:e.attributes,setScaleLayout:o,setDirection:l,setMaxWidth:a,setArrows:c,setSlideIn:d,setLQIP:h}},i)},qc=i("/Sry");function Kc(t){return(Kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yc(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function Xc(t){var e=function(t,e){if("object"!==Kc(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==Kc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Kc(e)?e:String(e)}function Zc(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Jc(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Zc(a,n,o,r,s,"next",t)}function s(t){Zc(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Qc(t){return function(t){if(Array.isArray(t))return ad(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||od(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function td(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ed(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?td(Object(i),!0).forEach((function(e){id(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):td(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function id(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function nd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||od(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function od(t,e){if(t){if("string"==typeof t)return ad(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ad(t,e):void 0}}function ad(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var rd=s.a.createContext({}),sd=u.a.throttle(nt.C,500),ld=function t(e,i){var n=[];for(var o in e)if(e[o].parentPage===i){var a=t(e,e[o]._id),r=Object.assign({},e[o]);a.length&&(r.children=a),n.push(r)}else if(void 0===e[o].parentPage){var s=Object.assign({},e[o]);n.push(s)}return n},cd=function(t,e){var i={};return t.forEach((function(t,n){if(i[t._id]={collapsed:!e[t._id]||e[t._id].collapsed,viewNum:n+1,uri:t.uri?t.uri:(n+1).toString(),children:[]},t.children){var o=[];t.children.forEach((function(n,a){o.push(n._id),i[n._id]={collapsed:!e[n._id]||e[n._id].collapsed,viewNum:a+1,uri:n.uri?n.uri:(a+1).toString(),children:[],parentId:t._id}})),i[t._id].children=o}})),i},dd=function(){return["title","description","user","folder","uri","domain","last_checked_domain","has_deleted_pages","master_share_pid","changed","is_published","is_private","pass","pass_bg","published","opts"].map((function(t){return"change:".concat(t)})).join(" ")},hd=function(){return["screenshot","title","uri","seo","hidden","custom_shares"].map((function(t){return"change:".concat(t)})).join(" ")},ud=function(t){var e=t.project,i=t.router,n=t.children,o=nd(Object(r.useState)(null),2),a=o[0],l=o[1],c=function(t){var e=ed({},t.attributes);return delete e.children,e},d=nd(Object(r.useState)((function(){var t=e.pages.models.map((function(t){return c(t)}));t.sort((function(t,e){return t.num-e.num}));var n=ld(t,null);return{project:e.attributes,isOwner:!!i.isOwner,inPreview:!1,pages:t,trashPages:[],pageRecentlyDeleted:!1,userTemplates:[],currentPageNum:i.getCurrentPageNum(),currentPageId:i.getCurrentPageId(),pagesTree:n,pagesParams:cd(n,{}),pagesListContainer:null,settingsBody:null,popupContainer:null,codeInjectUpgradeAlertShown:!1,publishInProgress:!1,unpublishInProgress:!1,isPublishError:!1,selectedPages:[],lockedPages:{},collaborators:[],team:[],allProjects:[],teamworkProjects:[],projectTeam:[],me:i.me.attributes}})),2),u=d[0],p=d[1],m=function(t){if(a){var e=a.querySelector('.page-list-item[data-page-id="'.concat(t,'"]'));e&&setTimeout((function(){e.scrollIntoView({block:"nearest"})}),100)}};Object(r.useEffect)((function(){var t=document.getElementById("settings-container");t&&l(t);var e=document.getElementById("page-list-container"),i=document.getElementById("project-settings-body"),n=document.getElementById("settings-popup-container");e&&p((function(t){return ed(ed({},t),{},{pagesListContainer:e,settingsBody:i,popupContainer:n})}))}),[]);var v=nd(Object(r.useState)(null),2),b=v[0],y=v[1],_=function(t){b&&b.remove();var e=new Qi.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-more-pages",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:u.project.user?u.project.user.email:""},alert_source:t});e.render(),y(e)},w={projectSet:function(t,i){return e.set(t,i)},projectUnset:function(t,i){return e.unset(t,i)},projectSave:function(t,i){return e.save(t,i)},pageSet:function(t,i,n){var o=e.pages.get(t);if(!o)throw new Error("Element not found");return o.set(i,n)},pageUnset:function(t,i,n){var o=e.pages.get(t);if(!o)throw new Error("Element not found");return o.unset(i,n)},pageSave:function(t,i,n){var o=e.pages.get(t);if(!o)throw new Error("Element not found");return o.save(i,n)},setCurrentPageNum:function(t){p((function(e){return ed(ed({},e),{},{currentPageNum:t})}))},setInPreview:function(t){p((function(e){return ed(ed({},e),{},{inPreview:t})}))},setPageCollapse:function(t,e){p((function(i){return ed(ed({},i),{},{pagesParams:ed(ed({},i.pagesParams),id({},t,ed(ed({},i.pagesParams[t]),{},{collapsed:e})))})}))},scrollToPage:function(t){m(t)},addNewPage:function(t,n,o){return new Promise((function(a,r){var s=j(t,u.pages,u.pagesTree,u.pagesParams),l=s.newPageNum,c=s.newPageParentId,d={num:l};n&&(d=ed(ed({},d),n)),e.addPage(d,(function(t){if(t&&t.err)r(t);else{var s=t;n||(s.isEmptyPage=!0),s.set("parentPage",c),i.pageOrder.reorderPagesAfterAdd({page:s,magId:e.get("_id")}),e.onAdd(s),n&&(s.from_template=!0,h.d.sendEvent(h.b.Templates,{eventLabel:"From templates popup"})),o||(i.showWorkspace({id:s.id}),m(s.id)),a(s)}}),!0)}))},duplicatePage:function(t){return new Promise((function(n,o){var a=e.getPage(t);if(!a)return o(new Error("Could not find page"));a.get("mid")||a.save({mid:e.get("_id")},{silent:!0});var r=j(a.get("num"),u.pages,u.pagesTree,u.pagesParams),s=r.newPageNum,l=r.newPageParentId;a.duplicate((function(t){if(t instanceof Error)return"Server error: permission_denied"===t.message&&_("duplicate page"),o(t);var a=t;a.set("parentPage",l),i.pageOrder.reorderPagesAfterAdd({page:a,magId:e.get("_id")}),e.onAdd(a),i.gg.guides.model&&(i.gg.guides.model.addPage(a.id,{silent:i.gg.guides.hidden}),i.gg.guides.model.save()),i.showWorkspace({id:a.id}),m(a.id),n(t)}),{num:s})}))},renewLastScreenshot:function(){return Jc(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=i._pageChanged)||"string"!=typeof e){t.next=5;break}return i._pageChanged=!1,t.next=5,w.updatePageScreenshot(e);case 5:case"end":return t.stop()}}),t)})))()},updatePageScreenshot:function(t){return Jc(regeneratorRuntime.mark((function i(){var n,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(nt.i)(e.get("num_id"),t);case 2:n=i.sent,(o=e.pages.find((function(e){return e.attributes._id===t})))&&o.save&&o.save({screenshot:n},{patch:!0,skipMagChanging:!0,skipHistory:!0});case 5:case"end":return i.stop()}}),i)})))()},saveOrder:function(t){return new Promise((function(n,o){i.pageOrder.saveInProgress()||(i.pageOrder.save({order:t,mid:i.mag.id},{success:function(){e.trigger("change:pids",e,e.get("pids")),n()},error:o}),e.trigger("change:pids",e,e.get("pids")))}))},deletePage:function(t){return new Promise((function(n,o){if(i.isPageLocked(t))return o(new Error("This page is locked"));if(1===e.get("pids").length)return o(new Error("Can't delete last page"));var a=u.pagesParams[t],r=[];if(a&&a.children.length){var s=a.children;a.collapsed?i.pageOrder.removeParentIds(s):r=Qc(s)}if(r.push(t),!e.checkDeletingPages(r))return o(new Error("Can't delete all pages"));var l=r.includes(u.currentPageId),c=u.currentPageNum;i.pageOrder.deletePagesFromOrder(r,e.get("_id")).then((function(){e.deletePages(r,(function(t){t instanceof Error?(i.pageOrder.load(e),o(t)):t&&t.deleteNotEmptyPages&&$(),l?function(t){var e=i.pageOrder.get("order"),n=null;if(t>e.length)n=e[e.length-1].id;else{var o=e.find((function(e){return e.num===t}));o&&(n=o.id)}n?(i.showWorkspace({id:n}),m(n)):i.showWorkspace({num:1})}(c):i.triggerPageChange(),r.forEach((function(t){return i.removeWorkspace(t)})),n()}))}),(function(t,e){o(new Error(e))}))}))},restorePage:function(t){return new Promise((function(n,o){e.restorePage(t,{success:function(t){var o=j(i.workspace.getPageNum(),u.pages,u.pagesTree,u.pagesParams),a=o.newPageNum,r=o.newPageParentId;t.set("num",a),t.set("parentPage",r),i.pageOrder.reorderPagesAfterAdd({page:t,magId:e.get("_id")}),e.onAdd(t),e.save(),i.showWorkspace({id:t.id}),m(t.id),n(t)},error:function(t){var e=JSON.parse(t.responseText);"permission_denied"===e.err&&_("restore page"),o(e)}},!0)}))},deletePagesFromTrash:function(t){return e.deleteTrashPages(t)},updateTrash:function(){return new Promise((function(t,i){e.get("has_deleted_pages")?e.fetchTrashPages().then((function(e){e&&p((function(t){return ed(ed({},t),{},{trashPages:e})})),t(e)})):t([])}))},emptyTrash:function(){return e.emptyTrash().then((function(){p((function(t){return ed(ed({},t),{},{trashPages:[]})}))}))},getUserTemplates:function(){return e.loadUserTemplates().then((function(t){return Array.isArray(t)&&p((function(e){return ed(ed({},e),{},{userTemplates:t})})),t}))},createTemplateFromCurrentPage:function(){return i.createTemplateFromCurrentPage().then((function(t){return t&&p((function(e){var i=Array.from(e.userTemplates);return i.unshift(t),ed(ed({},e),{},{userTemplates:i})})),t})).catch((function(t){throw t&&"permission denied"===t.message&&_("create user template"),t}))},deleteUserTemplate:function(t){return Object(nt.d)(t).then((function(){p((function(e){return ed(ed({},e),{},{userTemplates:e.userTemplates.filter((function(e){return e.id!==t}))})}))}))},validatePageUri:function(t,i){var n={hyphen:"The link should not start or end with a hyphen",onlyNumbers:"The link should not consist of digits only",uriLength:"The link should be less than 128 characters long",used:"You already have a page with this link",pageNotFound:"Can't find current page"},o=e.getPage(t);if(o){var a=o.validate({uri:i,parentPage:o.get("parentPage")});return a?n[Object.keys(a)[0]]:void 0}return n.pageNotFound},updateUsedFonts:function(){return Jc(regeneratorRuntime.mark((function t(){var i,n,o,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.getUsedFonts({includeCustom:!0,excludeUnusedDefault:Object(f.a)("constructor.loadOnlyUsedFonts")}),n=zc.a.sortFontsByProvider(i),o=n.typekit,a=n.custom,r=n.dictionary,t.abrupt("return",Object(nt.B)(e.id,Object(f.a)("constructor.loadOnlyUsedFonts")?r:{used_typekit_fonts:o,used_custom_fonts:a},!0));case 3:case"end":return t.stop()}}),t)})))()},publish:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Jc(regeneratorRuntime.mark((function n(){var o,a,r,s,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=t.skipCodeInjectionAlert,a=!i.isOwner,r=e.get("user").email,s=e.get("user").permissions||{},l=Fc.b.hasEcommerceWidget(D.a.environment.preview,e.getAllWidgets()),s.can_publish&&(!l||s.can_use_e_commerce)){n.next=9;break}Lc.showUpgradeAlert(i,{type:Lc.getPublishUpgradeAlertType(s,l),source:"publish",ownerEmail:r,isContributor:a}),n.next=34;break;case 9:if(Lc.canInjectCode(i,e)||u.codeInjectUpgradeAlertShown||o){n.next=14;break}Lc.showCodeInjectionAlert(i,{isContributor:a,ownerEmail:r,onSkip:function(){return w.publish({skipCodeInjectionAlert:!0})}}),p((function(t){return ed(ed({},t),{},{codeInjectUpgradeAlertShown:!0})})),n.next=34;break;case 14:if(u.publishInProgress){n.next=34;break}return p((function(t){return ed(ed({},t),{},{publishInProgress:!0})})),h.d.sendEvent(e.get("is_published")?h.b.RepublishMag:h.b.PublishMag,{eventLabel:"preview"}),h.d.sendEvent(e.get("is_published")?h.b.RepublishMag:h.b.PublishMag,{eventLabel:"preview",page:"/virtual/publish"}),n.prev=18,n.next=21,w.updateUsedFonts();case 21:return n.next=23,Object(nt.y)(e.get("num_id"));case 23:c=n.sent,e.set(ed(ed({},e.parse(c)),{},{changed:!1})),p((function(t){return ed(ed({},t),{},{publishInProgress:!1})})),n.next=34;break;case 28:return n.prev=28,n.t0=n.catch(18),p((function(t){return ed(ed({},t),{},{publishInProgress:!1,isPublishError:!0})})),n.next=33,new Promise((function(t){return setTimeout(t,5e3)}));case 33:p((function(t){return ed(ed({},t),{},{isPublishError:!1})}));case 34:case"end":return n.stop()}}),n,null,[[18,28]])})))()},publishWithNotice:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Jc(regeneratorRuntime.mark((function n(){var o,a,r,s,l,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.get("user").permissions||{},a=Fc.b.hasEcommerceWidget(D.a.environment.preview,e.getAllWidgets()),r=Object(f.a)("constructor.canUseFormPermission")?"Injected Code, Forms and Shots will not work in Published project.":"Injected Code and Shots will not work in Published project.",o.can_publish){n.next=9;break}throw s=o._reasons||{},l=s.can_publish&&s.can_publish.code,new W({message:"reason_publish_limit"===l?"Please upgrade your account to publish more than one project.":"Please verify your email address to publish this project.",tag:"reason_publish_limit"===l?H.freePublishLimit:H.unconfirmedEmail});case 9:if(!a||o.can_use_e_commerce){n.next=13;break}throw new W({message:"Please upgrade your account to publish project with ecommerce.",tag:H.ecommerce});case 13:if(Lc.canInjectCode(i,e)||t.skipWarnings){n.next=17;break}throw new W({message:r,tag:H.customCode,type:"warning"});case 17:if(Lc.canUseShots(i,e)||t.skipWarnings){n.next=21;break}throw new W({message:r,tag:H.shots,type:"warning"});case 21:if(Lc.canUseForms(i,e)||t.skipWarnings){n.next=23;break}throw new W({message:r,tag:H.forms,type:"warning"});case 23:if(u.publishInProgress){n.next=44;break}return p((function(t){return ed(ed({},t),{},{publishInProgress:!0})})),t.alsoExport&&u.project.user.permissions.can_export_template&&i.exportMagAsTemplateset(),h.d.sendEvent(e.get("is_published")?h.b.RepublishMag:h.b.PublishMag,{eventLabel:t.fromPreview?"preview":"settings"}),h.d.sendEvent(e.get("is_published")?h.b.RepublishMag:h.b.PublishMag,{eventLabel:t.fromPreview?"preview":"settings",page:"/virtual/publish"}),n.prev=28,n.next=31,w.updateUsedFonts();case 31:return n.next=33,Object(nt.y)(e.get("num_id"));case 33:c=n.sent,e.set(ed(ed({},e.parse(c)),{},{changed:!1})),p((function(t){return ed(ed({},t),{},{publishInProgress:!1})})),n.next=44;break;case 38:return n.prev=38,n.t0=n.catch(28),p((function(t){return ed(ed({},t),{},{publishInProgress:!1,isPublishError:!0})})),n.next=43,new Promise((function(t){return setTimeout(t,5e3)}));case 43:p((function(t){return ed(ed({},t),{},{isPublishError:!1})}));case 44:case"end":return n.stop()}}),n,null,[[28,38]])})))()},unpublish:function(){return Jc(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u.unpublishInProgress){t.next=6;break}return p((function(t){return ed(ed({},t),{},{unpublishInProgress:!0})})),h.d.sendEvent(h.b.UnpublisMag),t.next=5,Object(nt.I)(e.get("num_id"));case 5:e.set({is_published:null,published:null,updated:null});case 6:case"end":return t.stop()}}),t)})))()},restoreToPublished:function(){return Jc(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(nt.A)(e.get("num_id"));case 2:h.d.sendEvent(h.b.RestoreToPublished),window.location.reload();case 4:case"end":return t.stop()}}),t)})))()},checkPDFExportPermission:function(){if(!w.hasPermission(L.canExportPDF))throw new W({message:s.a.createElement(s.a.Fragment,null,"Please upgrade your account",s.a.createElement("br",null),"to export the project to PDF.",s.a.createElement("br",null),s.a.createElement("a",{href:"/pricing",className:"learn-more"},"See the pricing")),tag:H.pdfExport})},checkHTMLExportPermission:function(){if(!w.hasPermission(L.canExportCode))throw new W({message:s.a.createElement(s.a.Fragment,null,"Please upgrade your account",s.a.createElement("br",null),"in order to export the source",s.a.createElement("br",null),"code of your projects.",s.a.createElement("br",null),s.a.createElement("a",{href:"/pricing",className:"learn-more"},"See the pricing"),"."),tag:H.htmlExport})},openCodeEditor:function(){i.openCodeEditor()},hasProjectCode:function(){return["ci_head","ci_css","ci_body_top","ci_body_bottom"].some((function(t){return!!u.project[t]}))},hasCustomCode:function(){return e.hasCodeInjection()},hasShots:function(){return e.hasWidgetsWithType("shots")},hasForms:function(){return e.hasWidgetsWithType("form")},hasPermission:function(t){return i.me&&i.me.get("permissions")[t]},selectPagesRange:function(t){p((function(e){var n=e.lastSelectedPage&&e.selectedPages.includes(e.lastSelectedPage)?e.lastSelectedPage:i.getCurrentPageId();if(n){var o=e.pagesTree.reduce((function(t,e){return t.push(e),e.children?t.concat(e.children):t}),[]),a=o.findIndex((function(e){return e._id===t})),r=o.findIndex((function(t){return t._id===n})),s=o.slice(Math.min(a,r),Math.max(a,r)+1).map((function(t){return t._id})).filter((function(t){return!e.selectedPages.includes(t)})),l=[].concat(Qc(e.selectedPages),Qc(s));return ed(ed({},e),{},{selectedPages:l,lastSelectedPage:t})}return ed(ed({},e),{},{lastSelectedPage:t})}))},selectPage:function(t){p((function(e){var i=Qc(e.selectedPages);return i.includes(t)?i.splice(i.indexOf(t),1):i.push(t),ed(ed({},e),{},{selectedPages:i,lastSelectedPage:t})}))},deselectPages:function(){p((function(t){return ed(ed({},t),{},{selectedPages:[]})}))},takeOverCurrentPage:function(){if(u.isOwner){var t=i.getCurrentPageId(),n=e.pages.find((function(e){return e.attributes._id===t}));i.unlockPage(n)}},updateUrl:function(){i.updateUrl(),i.triggerPageChange()},changeWorkspace:function(t){i.showWorkspace(t)},loadTeamworkData:function(t){return Jc(regeneratorRuntime.mark((function e(){var i,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Se.a.get("/api/team");case 2:return i=e.sent,e.next=5,Se.a.get("/api/readymags/user");case 5:return n=e.sent,o=n.mags,e.abrupt("return",{team:i,allProjects:o,teamworkProjects:o.filter((function(e){return e.num_id===t})),projectTeam:i.filter((function(e){return e.projectNumIds.includes(t)}))});case 8:case"end":return e.stop()}}),e)})))()},updateTeam:function(t,e){p((function(i){return ed(ed({},i),{},{team:t,projectTeam:t.filter((function(t){return t.projectNumIds.includes(e)}))})}))},loadUserProjectsLinks:function(t){var e=t||(i.me?i.me.get("_id"):"");return Object(nt.r)(e)},setProjectPrivacy:function(t){var i=e.get("num_id");return t.numId&&(i=t.numId,delete t.numId),Object(nt.G)(i,t.isPrivate,t.password).then((function(){var i=t.isPrivate,n=t.password,o=n||e.get("pass");e.set({is_private:i,pass:o})}))},setProjectOptions:function(t,i){return Jc(regeneratorRuntime.mark((function n(){var o,a,r,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=Object.keys(t)[0],a=Object.values(t)[0],r=ed(ed({},t),!1===t.menubutton&&{projectinfo:!1}),s=ed(ed({},u.project.opts),r),["arrows","menubutton","projectinfo","sharebutton","pagecounter","controlsontop","controlsontop","endpage","slidein","scalableviewer"].includes(o)?"scalableviewer"===o?h.d.sendEvent(h.b.ViewerOptionsToggle,{eventLabel:"".concat(o," ").concat(a?"on":"off"),page:"virtual/scale-".concat(a?"on":"off")}):h.d.sendEvent(h.b.ViewerOptionsToggle,{eventLabel:"".concat(o," ").concat(a?"on":"off")}):"viewertype"===o?h.d.sendEvent(h.b.ViewerTypeToggle,{eventLabel:a,page:"virtual/".concat(a)}):"projectinfo"===o?h.d.sendEvent(h.b.DefaultMenu,{eventLabel:"Project info ".concat(a?"on":"off")}):"menubutton"===o&&h.d.sendEvent(h.b.DefaultMenu,{eventLabel:"Project menu ".concat(a?"on":"off")}),e.set("opts",ed(ed({},e.get("opts")),r),i),n.abrupt("return",sd(e.get("num_id"),s));case 7:case"end":return n.stop()}}),n)})))()},checkDomain:function(t){var e=this;return Object(nt.a)(u.project.num_id,t).then((function(i){return e.projectSet({last_checked_domain:t},{silent:!0}),i}))},mapDomain:function(t){var e=this;return Object(nt.v)(u.project.num_id,t).then((function(i){return e.projectSet({domain:t}),i}))},unmapDomain:function(){var t=this,i=u.project.domain||"";return Object(nt.H)(u.project.num_id).then((function(n){return t.projectUnset("domain"),u.project.opts.ssl&&(t.setProjectOptions({ssl:!1}),e.changeSSL(i,!1)),n}))},changeSSL:function(t){return Jc(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=u.project.domain||"",e.changeSSL(n,t,{success:function(){},error:function(t){throw t}});case 2:case"end":return i.stop()}}),i)})))()},getSSLState:function(){return Jc(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.project.domain||"",t.abrupt("return",e.getSSLState(i,{success:function(t){return t},error:function(t){throw t}}));case 2:case"end":return t.stop()}}),t)})))()}},k=function(t,e){t&&p((function(i){var n=t.pages.models.map((function(t){return c(t)})).filter((function(t){return e.includes(t._id)}));n.sort((function(t,e){return t.num-e.num}));var o=ld(n,null);return ed(ed({},i),{},{project:t.attributes,pages:n,pagesTree:o,pagesParams:cd(o,i.pagesParams)})}))},S=function(t,e){t&&p((function(e){return ed(ed({},e),{},{project:t.attributes})}))},x=function(t){t&&(t.changed&&(t.changed.num||t.changed.parentPage)||p((function(e){var i=function(t,e){var i=e.findIndex((function(e){return e._id===t.get("_id")}));if(i>=0){var n=Qc(e);return n[i]&&(n[i]=c(t)),n}return e}(t,e.pages);i.sort((function(t,e){return t.num-e.num}));var n=ld(i,null);return ed(ed({},e),{},{pages:i,pagesTree:n,pagesParams:cd(n,e.pagesParams)})})))},C=function(t){t&&p((function(e){var i=Array.from(e.trashPages);return i.unshift(t.attributes),ed(ed({},e),{},{trashPages:i})}))},O=function(t){t&&p((function(e){var i=Array.from(e.trashPages),n=i.findIndex((function(e){return e._id===t.get("_id")}));return n>-1&&i.splice(n,1),ed(ed({},e),{},{trashPages:i})}))};Object(r.useEffect)((function(){return e.on(dd(),S),e.on("change:pids",k),e.pages.on(hd(),x),e.trashPages.on("add",C),e.trashPages.on("remove",O),w.loadTeamworkData(e.attributes.num_id).then((function(t){p((function(e){return ed(ed({},e),t)}))})),function(){e.off(dd(),S),e.off("change:pids",k),e.pages.off(hd(),x),e.trashPages.off("add",C),e.trashPages.off("remove",O)}}),[e]);var P=function(t){p((function(e){return ed(ed({},e),{},{currentPageNum:t.getPageNum(),currentPageId:t.getPageId()})}))};Object(r.useEffect)((function(){return i.on("pageChange",P),function(){i.off("pageChange",P)}}),[i]);var E,I=Object(r.useCallback)((function(t,e){p((function(i){return ed(ed({},i),{},{lockedPages:ed(ed({},i.lockedPages),{},id({},t,e))})}))}),[]),T=Object(r.useCallback)((function(t){p((function(e){var i=e.lockedPages,n=(i[t],Yc(i,[t].map(Xc)));return ed(ed({},e),{},{lockedPages:n})}))}),[]),M=Object(r.useCallback)((function(t){var e=t.list;p((function(t){return ed(ed({},t),{},{collaborators:e||[]})}))}),[]);Object(r.useEffect)((function(){return g.a.on("page:locked",I),g.a.on("page:unlocked",T),g.a.on("sockets:connect",M),function(){g.a.off("page:locked",I),g.a.off("page:unlocked",T),g.a.off("sockets:connect",M)}}),[I,T]);var $=function(){p((function(t){return ed(ed({},t),{},{pageRecentlyDeleted:!0})})),E&&clearTimeout(E),E=setTimeout((function(){A()}),4500)},A=function(){p((function(t){return ed(ed({},t),{},{pageRecentlyDeleted:!1})}))};return s.a.createElement(rd.Provider,{value:ed(ed({},u),w)},n)},pd=function(t){var e=t.model,i=t.domElement,n=t.router;c.a.render(s.a.createElement(d.Db,null,s.a.createElement(ud,{project:e,router:n},s.a.createElement(O,{magModel:e,router:n},s.a.createElement(Gc,{model:e},s.a.createElement(qc.c,{router:n},s.a.createElement(Rr,{me:n.me},s.a.createElement(rc,null))))))),i)},md=function(t){var e=t.constructorModel,i=t.domElement,n=t.router,o=t.viewerModel;c.a.render(s.a.createElement(d.Db,null,s.a.createElement(ud,{project:e,router:n},s.a.createElement(O,{magModel:e,router:n},s.a.createElement(Gc,{model:o},s.a.createElement(qc.c,{router:n},s.a.createElement(vd,{router:n})))))),i)},gd=function(t){c.a.unmountComponentAtNode(t),t&&t.parentNode&&t.parentNode.removeChild(t)},fd=Object(a.e)(Pr).withConfig({displayName:"SettingsController___StyledToolbar"})(["z-index:",";"],(function(t){return t._css})),vd=function(t){t.router;var e=Object(r.useContext)(k),i=e.inPreview?e.isMagMenuOpen?"horizontal"===e.magMenuOrientation?"translateY(-184px)":"translateX(-240px)":e.isCartSidebarOpened?"translateX(-280px)":"translate(0px, 0px)":"translate(0px, 0px)";return s.a.createElement(fd,{previewOnly:!0,transform:i,_css:Z+1})};i.d(e,"b",(function(){return rd})),i.d(e,"g",(function(){return pd})),i.d(e,"f",(function(){return md})),i.d(e,"e",(function(){return gd})),i.d(e,"d",(function(){return k})),i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return o}))},bI1h:function(t,e,i){},bXDN:function(t,e,i){},btdP:function(module,exports){module.exports={"template-constructor-control-picture-color":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Color" data-alt-pos="left" data-alt-offset="9"><div class="opacity-grid"></div><div class="color-circle"></div></div>\n\n\t<div class="panel">\n\t</div>\n\n';return __p}}},"c/7M":function(t,e,i){},cBBe:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("gHxz"),l=i.n(s),c=i("OTSC"),d=a.a.View.extend({TIP_GAP:15,initialize:function(t){t&&(r.a.bindAll(this),this.block=t.block,this.model=t.model,this.$container=t.$container,this.environment=t.environment,this.mag=t.mag,this.template=l.a["template-common-hotspot-widget"],this.render())},render:function(){this.setElement(Object(n.a)(this.template({data:this.model}))),"viewer"===this.environment&&(this.apply_tip_container_size({width:this.model.tip_w,height:this.model.tip_h}),this.apply_tip_position(this.model)),this.$el.appendTo(this.$container)},apply_tip_container_size:function(t){t&&0===t.height&&(t.height=120),t&&this.$(".tip").css(t)},apply_tip_bg_color:function(t){this.$(".blocks-wrapper").css("background-color",c.default.getRGBA(t["tip_background-color"],t["tip_background-color-opacity"]/100))},apply_tip_border_radius:function(t){this.$(".blocks-wrapper").add(this.$(".tip")).css("border-radius",t["tip_border-radius"]+"px")},apply_tip_box_shadow:function(t){this.$(".tip").toggleClass("box-shadow",!!t["tip_box-shadow"])},apply_tip_position:function(t){var e,i=this.$(".tip"),n=t.tip_pos,o=t.tip_w,a=t.tip_h||120,r=t.w,s=t.h,l="",c="",d=this.TIP_GAP;return"top"===n?(l=-(d+a),c=r/2-o/2):"right"===n?(l=s/2-a/2,c=r+d):"bottom"===n?(l=s+d,c=r/2-o/2):"left"===n&&(l=s/2-a/2,c=-(d+o)),e={top:l,left:c},i.css(e),e},destroy:function(){this.remove()}});e.a=d},csmR:function(module,exports){module.exports={"template-common-audio-player-standard":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<iframe class="common-audio-player standard" width="100%" height="100%" scrolling="no" frameborder="no" src="'+(null==(__t=src)?"":_.escape(__t))+'"></iframe>\n';return __p},"template-common-audio-player-minimal":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="common-audio-player minimal loading">\n\n\t\t<div class="sc-artwork-list">\n\t\t\t<div class="sc-loaded-artwork"></div>\n\t\t\t<div class="sc-artworks-overlay"></div>\n\t\t</div>\n\n\t\t<div class="sc-info">\n\t\t\t<h3></h3>\n\t\t\t<h4></h4>\n\t\t</div>\n\n\t\t<div class="sc-scrubber no-rmswipe">\n\t\t\t<div class="sc-hover-indicator"></div>\n\t\t\t<div class="sc-time-span">\n\t\t\t\t<div class="sc-buffer"></div>\n\t\t\t\t<div class="sc-played"></div>\n\t\t\t\t<div class="sc-button-wrapper">\n\t\t\t\t\t<div class="sc-button">\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="12" height="12"><path d="M0 0 L12 6 L0 12  Z " style="fill:#1d1a1b; stroke:none; stroke-width:0"></path></svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="sc-time-indicators">\n\t\t\t\t<span class="sc-left"></span>\n\t\t\t</div>\n\t\t</div>\n\n\t</div>\n';return __p},"template-common-audio-player-engine-html5":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="common-audio-player-engine">\n\t\t<audio preload="auto"></audio>\n\t</div>\n';return __p},"template-common-audio-player-engine-flash":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="common-audio-player-engine">\n\t\t<object height="100%" width="100%" id="'+(null==(__t=id)?"":_.escape(__t))+'">\n\t\t\t<embed allowscriptaccess="always" height="100%" width="100%" src="'+(null==(__t=swf)?"":__t)+'" type="application/x-shockwave-flash" name="'+(null==(__t=id)?"":_.escape(__t))+'" />\n\t    </object>\n\t</div>\n';return __p},"template-common-audio-player-engine-flash-ie":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="common-audio-player-engine">\n\t\t<object height="100%" width="100%" id="'+(null==(__t=id)?"":_.escape(__t))+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" data="'+(null==(__t=swf)?"":_.escape(__t))+'">\n\t\t\t<param name="movie" value="'+(null==(__t=swf)?"":_.escape(__t))+'" />\n\t\t\t<param name="allowscriptaccess" value="always" />\n\t\t</object>\n\t</div>\n';return __p}}},"cx/9":function(t,e,i){},dfNU:function(t,e,i){"use strict";var n=i("q1tI"),o=i.n(n),a=i("iC7s"),r=i("vOnD"),s=i("za5s");function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function c(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var d=r.e.input.attrs({type:"range"}).withConfig({displayName:"PanelListItem__RangeInput"})(["display:block;-webkit-appearance:none;width:100%;margin:0;height:8px;background:transparent;&:focus{outline:none;}&::-webkit-slider-thumb{-webkit-appearance:none;width:8px;height:8px;background:",";border-radius:50%;cursor:ew-resize;}&::-moz-range-thumb{width:8px;height:8px;background:",";border-radius:50%;cursor:ew-resize;}&::-ms-thumb{width:8px;height:8px;background:",";border-radius:50%;cursor:ew-resize;}"],Object(s.themeGet)("colors.blue"),Object(s.themeGet)("colors.blue"),Object(s.themeGet)("colors.blue")),h=Object(r.e)(a.B).withConfig({displayName:"PanelListItem___StyledFlex"})(["pointer-events:",";"],(function(t){return t._css})),u=function(t,e){var i=t.children,n=t.showBorderBottom,r=void 0===n||n,s=t.showBorderTop,u=void 0===s||s,p=(t.color,t.small),m=t.isRange,g=t.value,f=t.max,v=t.min,b=t.onChange,y=t.disabled,_=c(t,["children","showBorderBottom","showBorderTop","color","small","isRange","value","max","min","onChange","disabled"]);return o.a.createElement(h,l({ref:e,borderBottom:"2px solid ".concat(r?"rgba(184, 184, 184, 0.24)":"transparent"),borderTop:"2px solid ".concat(u?"rgba(184, 184, 184, 0.24)":"transparent"),height:p?"40px":"auto",pb:p?void 0:16,mb:p?void 0:9,alignItems:"center",position:"relative",opacity:y?.4:1},_,{_css:y?"none":"initial"}),o.a.createElement(a.m,{width:"100%"},i),m&&o.a.createElement(a.m,{position:"absolute",bottom:"0",left:"0",width:"100%",mb:"-5px",height:"8px",zIndex:10},o.a.createElement(d,{value:g,max:f,min:v,onChange:b?function(t){b(parseInt(t.target.value))}:void 0})))};e.a=o.a.forwardRef(u)},dptL:function(t,e,i){"use strict";i.r(e);var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("q7tt"),l=i("R31J"),c=i.n(l),d=i("MAfP"),h=i.n(d),u=i("q5gH"),p=i("m41J"),m=u.a.extend({baseDimension:"width",initialize:function(t){u.a.prototype.initialize.apply(this,arguments),this.setSizeConstraints()},setSizeConstraints:function(){var t=this.getLimits();this.minwidth=Math.max(15,t.minwidth||0),this.minheight=Math.max(15,t.minheight||0),this.maxwidth=Math.min(1/0,t.maxwidth||1/0),this.maxheight=Math.min(1/0,t.maxheight||1/0)},getLimits:function(){var t=this.block.getModelBox(),e=this.block.isFullWidth()?"height":this.baseDimension,i=r.a.reduce(this.block.blocks,(function(t,i){var n=i.getModelBox(),o={minwidth:i.frame&&i.frame.minwidth,minheight:i.frame&&i.frame.minheight,maxwidth:i.frame&&i.frame.maxwidth,maxheight:i.frame&&i.frame.maxheight};if(i.proportional&&(o=p.a.getBoxLimits(n,o)),i.frame&&i.frame.applyExtraConstraints){var a=i.frame.applyExtraConstraints({width:o.minwidth,height:o.minheight});o.minwidth=a.width,o.minheight=a.height}var r=n.angle?p.a.calcBoundingBox(n,!1,!0):n,s=(n.angle?r[e]:n[e])/o["min"+e],l=(n.angle?r[e]:n[e])/o["max"+e];return{min:Math.min(s,t.min),max:Math.max(l,t.max)}}),{min:1/0,max:0});return{minwidth:t.width/i.min,minheight:t.height/i.min,maxwidth:t.width/i.max,maxheight:t.height/i.max}},show:function(t){r.a.each(this.block.blocks,(function(t){t.frame.hide()})),u.a.prototype.show.apply(this,arguments)},onResizeStart:function(t,e){u.a.prototype.onResizeStart.apply(this,arguments),r.a.each(this.block.blocks,(function(i){i.frame.onResizeStart(t,e,{isGroupResize:!0})}))},onResizeEnd:function(t,e){u.a.prototype.onResizeEnd.apply(this,arguments),r.a.each(this.block.blocks,(function(i){i.frame.onResizeEnd(t,e,{skipHistory:!0,skipPersist:!0,isGroupResize:!0})}))},doResize:function(t,e,i,n){this.block.line&&this.block.line.update(t,this.block.isVisible(),this.block.model.get("fixed_position"),this.block.model.getViewport());var o=this.block.getModelBox(),a=this.resizeBlock.bind(this,o,t,i,n),s=r.a.map(this.block.blocks,a),l=p.a.getBoundingBoxOfBoxes(s);return this.block.css(r.a.extend({},l,{doNotRedrawPacksFrames:!0}),this.currentResizePoint),l},resizeBlock:function(t,e,i,n,o){var a=o.getModelBox(),s=a.angle,l=s?p.a.calcBoundingBox(a,!1,!0):a,c=p.a.getResizedBoxNested(l,t,e,this.block.isFullWidth()?"height":null);c=o.frame.applyConstraints(c,{direction:i,fromCenter:n,packBox:e,ratio:s?l[this.baseDimension]/l["width"===this.baseDimension?"height":"width"]:o.ratio,baseDimension:this.baseDimension});var d=s?p.a.getResizedBoxByBB(a,l,c):c;return o.css(r.a.extend({},{left:Math.round(d.left),top:Math.round(d.top),width:Math.round(d.width),height:Math.round(d.height)},{doNotRedrawPacksFrames:!0,isGroupResize:!0,groupedIds:"hotspot"===o.model.get("type")?r.a.map(this.block.blocks,"id"):[]})),o.recalcFixedLine(),o.recalcStickedLine(),c}});function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){v(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,"WidgetPackModel",(function(){return b})),i.d(e,"WidgetPack",(function(){return y}));var b=a.a.Model.extend({defaults:{type:"pack",visible:!1,x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,r:Number.NEGATIVE_INFINITY,b:Number.NEGATIVE_INFINITY,w:0,h:0,aspect:null,angle:0,fixed_position:null,is_full_width:!1,is_full_height:!1,flip_v:!1,flip_h:!1,sinAngle:0,cosAngle:1,viewport:"default"},getViewport:function(){return this.get("viewport")},reset:function(){this.set(this.defaults)}}),y=s.a.extend({id:null,blocks:null,workspace:null,latestPosSizeAngle:null,frame:null,line:null,proportional:!0,initialize:function(t){r.a.bindAll(this),this.blocks=[],this.latestPosSizeAngle={},this.model=new b,this.workspace=t.workspace},render:function(){var t=c.a["template-pack"]({id:this.id,templates:f({},h.a)});return this.setElement(Object(n.a)(t)),this.bindHandlers(),this.frame=new m({packId:this.id,block:this,blocks:this.blocks}),this.rendered=!0,this.$el},getCss:function(t,e){var i=this.model.attributes;return{left:i.x+(i.fixed_position?t:0),top:i.y+(i.fixed_position?e:0),width:i.w,height:i.h,position:i.fixed_position?"fixed":"absolute","z-index":i.fixed_position?999:void 0}},update:function(){var t=this.getCss(this.workspace.position.left,this.workspace.position.top);this.$el.css(t),this.isVisible()&&!this.frame.isFrameVisible()?this.frame.show():this.isVisible()||this.frame.hide(),this.$el.toggleClass("fixed-frame",this.isFixed()),this.$el.toggleClass("full-width",this.isFullWidth()),this.$el.toggleClass("full-height",this.isFullHeight()),this.recalcFixedLine()},recalcFixedLine:function(t){var e=this.model.get("fixed_position")||this.restoreFixed,i=this.isVisible()||t;e&&i&&!this.isSelection()?this.updateFixedLine(e):this.removeFixedLine()},destroy:function(){this.removeFixedLine(),s.a.prototype.destroy.apply(this,arguments)},bindHandlers:function(){var t=Object(n.a)(this.$el);t.drag("start",this.onDragStart,{not:".no-drag"}),t.drag(this.onDragMove,{delay:100}),t.drag("end",this.onDragEnd),t.on("click",this.onPackClick)},addBlock:function(t){if(this.blocks.push(t),!t.isPackFrameHidden){var e=t.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0}),i=Math.min(this.model.get("x"),e.bb_x),n=Math.min(this.model.get("y"),e.bb_y),o=Math.max(this.model.get("b"),e.bb_y+e.bb_h),a=Math.max(this.model.get("r"),e.bb_x+e.bb_w),s=t.model.get("fixed_position"),l=t.model.get("is_full_width"),c=t.model.get("is_full_height");this.model.set({y:n,x:i,b:o,r:a,w:a-i,h:o-n,visible:r.a.every(this.blocks,"selected"),fixed_position:s||this.model.get("fixed_position"),is_full_width:l||this.model.get("is_full_width"),is_full_height:c||this.model.get("is_full_height"),viewport:t.model.getViewport()}),t.recalcFixedLine(),this.frame&&this.frame.setSizeConstraints()}this.latestPosSizeAngle=this.getModelBox()},reset:function(){this.blocks=[],this.model.reset()},isFixed:function(){return Boolean(this.model.get("fixed_position"))},isSelection:function(){return"selected"===this.id},isVisible:function(){return Boolean(this.model.get("visible"))},export:function(){return r.a.extend({},this.model.attributes,{id:this.id})},onDragStart:function(t,e){this.anyBlockInPackForDragging=r.a.first(this.blocks),s.a.prototype.onDragStart.call(this.anyBlockInPackForDragging,t,e)},onDragMove:function(t,e){this.anyBlockInPackForDragging&&s.a.prototype.onDragMove.call(this.anyBlockInPackForDragging,t,e)},onDragEnd:function(t,e){this.anyBlockInPackForDragging&&s.a.prototype.onDragEnd.call(this.anyBlockInPackForDragging,t,e)},onPackClick:function(t){this._justResized?this._justResized=!1:window.suppressClick&&window.suppressClick>+new Date||this.trigger("click",t)},restoreFixedPosition:function(){s.a.prototype.restoreFixedPosition.apply(this,arguments),r.a.each(this.blocks,(function(t){t.restoreFixedPosition()}))},getBoxData:function(t){var e=s.a.prototype.getBoxData.apply(this,arguments);return e.b=e.y+e.h,e.r=e.x+e.w,e},getHotspotExternalPeerIds:function(){var t=r.a.map(this.blocks,"id");return r.a.reduce(this.blocks,(function(e,i){var n="hotspot"===i.model.get("type")&&r.a.difference(i.getPeerIds(),t);return r.a.each(n,(function(t){-1===e.indexOf(t)&&e.push(t)})),e}),[])},getHotspotPeerData:function(){var t=this.getHotspotExternalPeerIds();return r.a.map(t,function(t){var e=this.workspace.findBlock(t);return r.a.extend({},e.getSaveBoxData(),{_id:t})}.bind(this),{})},saveBox:function(t,e){var i=r.a.pick(this.getBoxData(),["w","h","x","y"]);this.model.set(i);var n=r.a.map(this.blocks,function(t){return r.a.extend({},t.getSaveBoxData(),{_id:t.id})}.bind(this));n=r.a.uniq([].concat(n,this.getHotspotPeerData(),e||[]),(function(t){return t._id})),this._saveXHR&&this._saveXHR.abort(),this.workspace.set_group(n,r.a.extend({isGroupResize:!0},t)),this.workspace.save_group(n,r.a.extend({isGroupResize:!0},t))}})},eN9J:function(module,exports,__webpack_require__){var require;!function(){var requirejs,require,define,__inflate;(function(t){function e(t,e){var i,n,o,a,r,s,l,c=e&&e.split("/"),d=h.map,u=d&&d["*"]||{};if(t&&"."===t.charAt(0)&&e){for(t=(c=c.slice(0,c.length-1)).concat(t.split("/")),r=0;l=t[r];r++)if("."===l)t.splice(r,1),r-=1;else if(".."===l){if(1===r&&(".."===t[2]||".."===t[0]))return!0;r>0&&(t.splice(r-1,2),r-=2)}t=t.join("/")}if((c||u)&&d)for(r=(i=t.split("/")).length;r>0;r-=1){if(n=i.slice(0,r).join("/"),c)for(s=c.length;s>0;s-=1)if((o=d[c.slice(0,s).join("/")])&&(o=o[n])){a=o;break}if(a=a||u[n]){i.splice(0,r,a),t=i.join("/");break}}return t}function i(e,i){return function(){return l.apply(t,p.call(arguments,0).concat([e,i]))}}function n(t){return function(e){c[t]=e}}function o(e){if(d.hasOwnProperty(e)){var i=d[e];delete d[e],u[e]=!0,s.apply(t,i)}if(!c.hasOwnProperty(e))throw new Error("No "+e);return c[e]}function a(t,i){var n,a,r=t.indexOf("!");return-1!==r?(n=e(t.slice(0,r),i),t=t.slice(r+1),t=(a=o(n))&&a.normalize?a.normalize(t,function(t){return function(i){return e(i,t)}}(i)):e(t,i)):t=e(t,i),{f:n?n+"!"+t:t,n:t,p:a}}function r(t){return function(){return h&&h.config&&h.config[t]||{}}}var s,l,c={},d={},h={},u={},p=[].slice;s=function(e,s,l,h){var p,m,g,f,v,b,y=[];if(h=h||e,"string"==typeof l&&(l=__inflate(e,l)),"function"==typeof l){for(s=!s.length&&l.length?["require","exports","module"]:s,b=0;b<s.length;b++)if("require"===(g=(v=a(s[b],h)).f))y[b]=i(e);else if("exports"===g)y[b]=c[e]={},p=!0;else if("module"===g)m=y[b]={id:e,uri:"",exports:c[e],config:r(e)};else if(c.hasOwnProperty(g)||d.hasOwnProperty(g))y[b]=o(g);else if(v.p)v.p.load(v.n,i(h,!0),n(g),{}),y[b]=c[g];else if(!u[g])throw new Error(e+" missing "+g);f=l.apply(c[e],y),e&&(m&&m.exports!==t&&m.exports!==c[e]?c[e]=m.exports:f===t&&p||(c[e]=f))}else e&&(c[e]=l)},requirejs=require=l=function(e,i,n,r){return"string"==typeof e?o(a(e,i).f):(e.splice||(h=e,i.splice?(e=i,i=n,n=null):e=t),i=i||function(){},r?s(t,e,i,n):setTimeout((function(){s(t,e,i,n)}),15),l)},l.config=function(t){return h=t,l},(define=function(t,e,i){e.splice||(i=e,e=[]),d[t]=[t,e,i]}).amd={jQuery:!0}})(),__inflate=function __inflate(name,src){var r;return eval(["r = function(a,b,c){","\n};\n//@ sourceURL="+name+"\n"].join(src)),r},define("lib/api/events",["require","exports","module"],(function(t,e,i){e.api={LOAD_PROGRESS:"loadProgres",PLAY_PROGRESS:"playProgress",PLAY:"play",PAUSE:"pause",FINISH:"finish",SEEK:"seek",READY:"ready",OPEN_SHARE_PANEL:"sharePanelOpened",SHARE:"share",CLICK_DOWNLOAD:"downloadClicked",CLICK_BUY:"buyClicked"},e.bridge={REMOVE_LISTENER:"removeEventListener",ADD_LISTENER:"addEventListener"}})),define("lib/api/getters",["require","exports","module"],(function(t,e,i){i.exports={GET_VOLUME:"getVolume",GET_DURATION:"getDuration",GET_POSITION:"getPosition",GET_SOUNDS:"getSounds",GET_CURRENT_SOUND:"getCurrentSound",GET_CURRENT_SOUND_INDEX:"getCurrentSoundIndex",IS_PAUSED:"isPaused"}})),define("lib/api/setters",["require","exports","module"],(function(t,e,i){i.exports={PLAY:"play",PAUSE:"pause",TOGGLE:"toggle",SEEK_TO:"seekTo",SET_VOLUME:"setVolume",NEXT:"next",PREV:"prev",SKIP:"skip"}})),define("lib/api/api",["require","exports","module","lib/api/events","lib/api/getters","lib/api/setters"],(function(t,e,i){function n(t){var e,i=!1;for(e in k)if(k.hasOwnProperty(e)&&k[e]===t){i=!0;break}return i}function o(t){var e,i;for(e=0,i=j.length;e<i&&!1!==t(j[e]);e++);}function a(t){return t.contentWindow?t.contentWindow:t.contentDocument&&"parentWindow"in t.contentDocument?t.contentDocument.parentWindow:null}function r(t){var e,i=[];for(e in t)t.hasOwnProperty(e)&&i.push(t[e]);return i}function s(t,e,i){i.callbacks[t]=i.callbacks[t]||[],i.callbacks[t].push(e)}function l(t,e){var i=!0;return e.callbacks[t]=[],o((function(e){if((e.callbacks[t]||[]).length)return i=!1,!1})),i}function c(t,e,i){var n,o,r=a(i);if(!r.postMessage)return!1;n=i.getAttribute("src").split("?")[0],o=JSON.stringify({method:t,value:e}),"//"===n.substr(0,2)&&(n=window.location.protocol+n),n=n.replace(/http:\/\/(w|wt).soundcloud.com/,"https://$1.soundcloud.com"),r.postMessage(o,n)}function d(t){var e;return o((function(i){if(i.instance===t)return e=i,!1})),e}function h(t){var e;return o((function(i){if(a(i.element)===t)return e=i,!1})),e}function u(t,e){return function(i){var n=function(t){return!!(t&&t.constructor&&t.call&&t.apply)}(i),o=d(this),a=!n&&e?i:null,r=n&&!e?i:null;return r&&s(t,r,o),c(t,a,o.element),this}}function p(t,e,i){var n,o,a;for(n=0,o=e.length;n<o;n++)t[a=e[n]]=u(a,i)}function m(t,e,i){return t+"?url="+e+"&"+function(t){var e,i,n=[];for(e in t)t.hasOwnProperty(e)&&(i=t[e],n.push(e+"="+("start_track"===e?parseInt(i,10):i?"true":"false")));return n.join("&")}(i)}function g(t,e,i){var o,a,r=t.callbacks[e]||[];for(o=0,a=r.length;o<a;o++)r[o].apply(t.instance,i);(n(e)||e===x.READY)&&(t.callbacks[e]=[])}function f(t){var e,i,n,o,a;try{i=JSON.parse(t.data)}catch(t){}if(i&&(!t.origin||/soundcloud/i.test(t.origin))){if(e=h(t.source),n=i.method,o=i.value,n===x.READY&&(e?(e.isReady=!0,g(e,P),l(P,e)):O.push(t.source)),n===x.PLAY&&!e.playEventFired&&(e.playEventFired=!0),n===x.PLAY_PROGRESS&&!e.playEventFired&&(e.playEventFired=!0,g(e,x.PLAY,[o])),!e||v(t.origin)!==v(e.domain))return!1;a=[],void 0!==o&&a.push(o),g(e,n,a)}}function v(t){return t.replace(E,"")}var b,y,_,w=t("lib/api/events"),k=t("lib/api/getters"),S=t("lib/api/setters"),x=w.api,C=w.bridge,O=[],j=[],P="__LATE_BINDING__",E=/^http(?:s?)/;window.addEventListener?window.addEventListener("message",f,!1):window.attachEvent("onmessage",f),i.exports=_=function(t,e,i){if(function(t){return!!(""===t||t&&t.charCodeAt&&t.substr)}(t)&&(t=document.getElementById(t)),!function(t){return!!t&&1===t.nodeType&&"IFRAME"===t.nodeName.toUpperCase()}(t))throw new Error("SC.Widget function should be given either iframe element or a string specifying id attribute of iframe element.");e&&(i=i||{},t.src=m("http://wt.soundcloud.dev:9200/",e,i));var n,o,r=h(a(t));return r&&r.instance?r.instance:(n=O.indexOf(a(t))>-1,o=new b(t),j.push(new y(o,t,n)),o)},_.Events=x,window.SC=window.SC||{},window.SC.Widget=_,y=function(t,e,i){this.instance=t,this.element=e,this.domain=function(t){var e,i,n,o="";for("//"===t.substr(0,2)&&(t=window.location.protocol+t),e=0,i=(n=t.split("/")).length;e<i&&e<3;e++)o+=n[e],e<2&&(o+="/");return o}(e.getAttribute("src")),this.isReady=!!i,this.callbacks={}},(b=function(){}).prototype={constructor:b,load:function(t,e){if(t){e=e||{};var i=this,n=d(this),o=n.element,a=o.src,r=a.substr(0,a.indexOf("?"));n.isReady=!1,n.playEventFired=!1,o.onload=function(){i.bind(x.READY,(function(){var t,i=n.callbacks;for(t in i)i.hasOwnProperty(t)&&t!==x.READY&&c(C.ADD_LISTENER,t,n.element);e.callback&&e.callback()}))},o.src=m(r,t,e)}},bind:function(t,e){var i=this,n=d(this);return n&&n.element&&(t===x.READY&&n.isReady?setTimeout(e,1):n.isReady?(s(t,e,n),c(C.ADD_LISTENER,t,n.element)):s(P,(function(){i.bind(t,e)}),n)),this},unbind:function(t){var e,i=d(this);i&&i.element&&(e=l(t,i),t!==x.READY&&e&&c(C.REMOVE_LISTENER,t,i.element))}},p(b.prototype,r(k)),p(b.prototype,r(S),!0)})),window.SC=window.SC||{},window.SC.Widget=require("lib/api/api")}()},ePHO:function(t,e,i){"use strict";i.d(e,"a",(function(){return v}));var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("i8i4"),s=i.n(r),l=i("iC7s"),c=i("IiUL"),d=i("uxFs");function h(){return(h=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function m(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function g(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?m(Object(i),!0).forEach((function(e){f(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):m(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var v=Object(o.createContext)({}),b=Object(n.e)(l.B).withConfig({displayName:"TextPaddings___StyledFlex"})(["zoom:var(--workspace-inverse-zoom);transform:scale(var(--workspace-zoom));transform-origin:left top;"]),y=Object(n.e)(l.H).withConfig({displayName:"TextPaddings___StyledInlineInput"})(["user-select:none !important;appearance:textfield;padding:0 !important;border:none !important;&::-webkit-outer-spin-button,&::-webkit-inner-spin-button{appearance:none;}"]),_=a.a.memo((function(t){var e=t.isActive,i=t.isSmall,r=t.from,c=t.value,h=t.position,u=t.onChange,p=t.disabled,m=window.RM.constructorRouter.zoom.getZoom(),f=Object(l.Wb)("Shift"),v="top"===r||"bottom"===r,_=i&&!v,w=Object(o.useRef)(null),k=Object(l.Yb)(w),S=k.width,x=k.height,C=(v?S:x)*m,O=w&&w.current?w.current.getBoundingClientRect():{x:0,y:0},j=_?10:"top"===r?"22px 22px 0 0":"right"===r?"0 22px 22px 0":"left"===r?"22px 0 0 22px":"0 0 22px 22px",P=Object(o.useMemo)((function(){var t=C-43,e=h*m-21.5;return Math.max(0,e<=t?e:t)}),[h,C,m]),E=_?20:43,I=_?38:v?43:47,T=Object(o.useContext)(d.a).ref,M=T&&T.current?T.current.node.getBoundingClientRect():{x:0,y:0},$=document.getElementById("paddings-input-portal"),A=a.a.createElement(l.B,{position:"relative",justifyContent:_?"flex-start":"flex-end",flexDirection:v?"row":"column",style:g({position:"absolute"},v?{left:P+M.x+O.x*m,top:M.y+O.y*m-("top"===r?E:0)}:{top:P+M.y+O.y*m,left:M.x+O.x*m-("left"===r?I:0)})},a.a.createElement(b,{bg:"blue",width:I,height:E,borderRadius:j,alignItems:"center",justifyContent:"center"},a.a.createElement(y,{fontSize:14,height:18,fontWeight:600,color:"white",placeholder:"0",type:"number",value:c,textAlign:"center",min:0,step:f?10:1,onChange:function(t){return u(parseInt(t.target.value))},autoFocus:!1,disabled:p})));return a.a.createElement(n.a,{target:document.head},a.a.createElement(a.a.Fragment,null,a.a.createElement(l.m,{ref:w,width:"100%",height:"100%"}),e&&$?s.a.createPortal(A,$):null))})),w=Object(n.e)(l.m).withConfig({displayName:"TextPaddings___StyledBox"})(["cursor:",";"],(function(t){return t._css})),k=a.a.memo((function(t){var e=t.from,i=t.isChanged,n=t.onChange,r=t.value,s=void 0===r?0:r,d=t.isSmall,p=t.marginBottom,m=void 0===p?0:p,g=t.marginLeft,v=void 0===g?0:g,b=t.marginRight,y=void 0===b?0:b,k=t.marginTop,S=void 0===k?0:k,x=t.onStart,C=t.onStop,O=Object(o.useContext)(c.FrameContext),j=O&&O.window,P=function(t,e){var i=e;j&&j.addEventListener(t,i),window.addEventListener(t,i)},E=function(t,e){var i=e;j&&j.removeEventListener(t,i),window.removeEventListener(t,i)},I="top"===e||"bottom"===e,T="bottom"===e,M=u(Object(o.useState)(!1),2),$=M[0],A=M[1],R=u(Object(o.useState)(!1),2),D=R[0],B=R[1],L=u(Object(o.useState)(!1),2),z=L[0],F=L[1],U=u(Object(o.useState)(0),2),N=U[0],H=U[1],V=Object(o.useRef)(null),W=u(Object(o.useState)(0),2),G=W[0],q=W[1],K=u(Object(o.useState)(0),2),Y=K[0],X=K[1],Z=Object(o.useRef)(!1).current,J=function(t){Z=!0;var i=I?t.screenY:t.screenX,o="right"===e?N-i:i-N;n(Math.max(0,s+o)),X(Math.max(0,(I?t.clientX:t.clientY)-G))},Q=function(){B(!1),Z&&(F(!1),C&&C(e)),Z=!1};Object(o.useEffect)((function(){return D?(P("mousemove",J),P("mouseup",Q)):(E("mousemove",J),E("mouseup",Q)),function(){E("mousemove",J),E("mouseup",Q)}}),[D]);var tt=function(t){var i=document.getElementById("paddings-input-portal"),n=t.target;i&&!i.contains(n)&&V.current&&!V.current.contains(n)&&(F(!1),B(!1),Q(),C&&C(e))},et=function(t){"Escape"===t.key&&(F(!1),B(!1),Q(),C&&C(e))};Object(o.useEffect)((function(){return D||(z?(P("click",tt),P("keyup",et)):(E("click",tt),E("keyup",et),C&&C(e))),function(){E("click",tt),E("keyup",et)}}),[D,z]);var it=Object(o.useMemo)((function(){return T?$||D?1:0:$||D?2:1}),[D,$]),nt=Object(o.useMemo)((function(){return I?"calc(100% - ".concat(v+y,"px)"):"".concat(it,"px")}),[it,v,y]),ot=Object(o.useMemo)((function(){return I?"".concat(it,"px"):"calc(100% - ".concat(m+S,"px)")}),[it,m,S]),at=Object(o.useMemo)((function(){return I?0+v:void 0}),[v]),rt=Object(o.useMemo)((function(){return I?void 0:0+S}),[S]),st=i?"tomato":"blue";return a.a.createElement(l.m,h({ref:V,position:"absolute",width:I?"100%":void 0,height:I?void 0:"100%",left:I?0:void 0,top:I?void 0:0},f({},e,0)),a.a.createElement(l.m,{bg:"rgba(28, 222, 180, 0.18)",style:{width:I?"100%":s,height:I?s:"calc(100% - ".concat(S+m,"px)"),marginTop:I?0:S}}),a.a.createElement(w,h({position:"absolute",onMouseEnter:function(){return A(!0)},onMouseLeave:function(){return A(!1)},onMouseDown:function(t){var i=document.getElementById("paddings-input-portal");if(!i||!i.contains(t.target)){if(!z){var n=t.target.getBoundingClientRect(),o=I?n.x:n.y;q(o),X(Math.max(0,(I?t.clientX:t.clientY)-o)),F(!0)}H(I?t.screenY:t.screenX),B(!0),x&&x(e)}}},f({},e,T?0:"100%"),{style:{width:T?"100%":I?nt:"4px",height:T||I?4:ot,left:T?0:at,top:rt},_css:I?"row-resize":"col-resize"}),a.a.createElement(l.m,{position:"absolute",width:I?"100%":void 0,height:I?void 0:"100%",bottom:"top"===e?"100%":void 0,top:"bottom"===e?"100%":void 0,left:"right"===e?"100%":void 0,right:"left"===e?"100%":void 0},a.a.createElement(_,{isSmall:d,position:Y,isActive:z,onChange:n,value:s,from:e,disabled:D})),a.a.createElement(l.B,{width:"100%",height:"100%",alignItems:"top"===e?"flex-start":"flex-end",justifyContent:"right"===e?"flex-end":void 0},a.a.createElement(l.m,{width:I?"100%":"".concat(it,"px"),height:I?"".concat(it,"px"):"100%",bg:$||D||T||s&&s>0?st:"transparent"}))),T&&a.a.createElement(l.m,{position:"absolute",bg:s&&s>1?st:"transparent",top:0,height:"1px",style:{left:at,width:nt}}))})),S=Object(n.e)(l.m).withConfig({displayName:"TextPaddings___StyledBox2"})(["opacity:",";visibility:",";user-select:none;"],(function(t){return t._css2}),(function(t){return t._css3})),x=Object(n.e)(l.m).withConfig({displayName:"TextPaddings___StyledBox3"})(["",""],(function(t){return t._css4}));e.b=function(t){var e=t.isVisible,i=t.children,n=t.left,r=t.top,s=t.right,c=t.bottom,d=t.onChange,h=t.changedPaddings,u=void 0===h?{}:h,p=Object(o.useContext)(v),m=p.isPaddingsEnabled,g=p.setIsPaddingsEnabled,f=Object(o.useRef)(null).current,b=function(t){f=t,g(!0)},y=function(t){f&&f!==t||g(!1)},_=Object(o.useRef)(null),w=Object(l.Yb)(_).height,C=Object(o.useMemo)((function(){return w<43}),[w]);return a.a.createElement(l.m,{position:"relative",style:{paddingTop:r,paddingLeft:n,paddingRight:s,paddingBottom:c}},e&&a.a.createElement(a.a.Fragment,null,a.a.createElement(S,{contentEditable:!1,display:"inline",_css2:e?1:0,_css3:e?"visible":"hidden"},a.a.createElement(k,{isSmall:C,isChanged:u.top,from:"top",value:r,marginLeft:n,marginRight:s,onChange:function(t){return d({top:t})},onStart:b,onStop:y}),a.a.createElement(k,{isSmall:C,isChanged:u.left,from:"left",value:n,marginTop:r,marginBottom:c,onChange:function(t){return d({left:t})},onStart:b,onStop:y}),a.a.createElement(k,{isSmall:C,isChanged:u.right,from:"right",value:s,marginTop:r,marginBottom:c,onChange:function(t){return d({right:t})},onStart:b,onStop:y}),a.a.createElement(k,{isSmall:C,isChanged:u.bottom,from:"bottom",value:c,marginLeft:n,marginRight:s,onChange:function(t){return d({bottom:t})},onStart:b,onStop:y}))),a.a.createElement(x,{ref:_,_css4:m?"* { user-select: none; }":""},i))}},ee0N:function(module,exports){module.exports={"template-constructor-helpers-font-explorer":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="\n\t";var initial="google";__p+='\n\t<div class="font-explorer">\n\t\t<div class="font-explorer-wrapper">\n\n\t\t\t<div class="left-panel">\n\n\t\t\t\t<div class="search-icon"></div>\n\n\t\t\t\t<div class="view-wrapper">\n\t\t\t\t\t<div class="grid-view active" data-name="grid"></div>\n\t\t\t\t\t<div class="list-view"  data-name="list"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="back-icon"></div>\n\n\n\t\t\t\t<div class="size-wrapper">\n\t\t\t\t\t<div class="top-letter">A</div>\n\t\t\t\t\t<div class="slider"></div>\n\t\t\t\t\t<div class="bottom-letter">A</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\n\t\t\t<div class="center-panel">\n\n\t\t\t\t<div class="search-wrapper">\n\t\t\t\t\t<div class="border"></div>\n\t\t\t\t\t<input class="search-string" type="text" placeholder=""/>\n\t\t\t\t\t<div class="clear invisible"></div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="scroll-wrapper main">\n\t\t\t\t\t<div class="results-wrapper">\n\t\t\t\t\t\t<div class="results" data-view="grid" data-size="4">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="scroll-wrapper info">\n\t\t\t\t\t<div class="results-wrapper">\n\t\t\t\t\t\t<div class="results" data-view="list" data-size="4">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\n\t\t\t<div class="right-panel">\n\n\t\t\t\t<div class="providers-switcher">\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li '+(null==(__t="google"==initial?'class="active"':"")?"":__t)+' data-name="google"></li>\n            <li '+(null==(__t="typetoday"==initial?'class="active"':"")?"":__t)+' data-name="typetoday"></li>\n            <li '+(null==(__t="typekit"==initial?'class="active"':"")?"":__t)+' data-name="typekit"></li>\n            <li '+(null==(__t="webtype"==initial?'class="active"':"")?"":__t)+' data-name="webtype"></li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<span></span>\n\t\t\t\t</div>\n\n        <div class="provider-filter '+(null==(__t="typekit"==initial?"":"invisible")?"":__t)+'" data-name="typekit">\n\n          <div class="filter-caption" data-initial="Classification">Classification</div>\n\n          <div class="filter classification" data-name="classification" data-multiple="0">\n            <div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>\n            <div class="icon-serif" data-name="serif" data-alt="Serif"></div>\n            <div class="icon-slab-serif" data-name="slab-serif" data-alt="Slab Serif"></div>\n            <div class="icon-script" data-name="script" data-alt="Script"></div>\n            <div class="icon-blackletter" data-name="blackletter" data-alt="Blackletter"></div>\n            <div class="icon-monospaced" data-name="monospaced" data-alt="Monospaced"></div>\n            <div class="icon-handmade" data-name="handmade" data-alt="Handmade"></div>\n            <div class="icon-decorative" data-name="decorative" data-alt="Decorative"></div>\n          </div>\n\n          <div class="filter-caption" data-initial="For">For</div>\n\n          <div class="filter recommended-for" data-name="recommended_for" data-multiple="1">\n            <div class="icon-paragraphs" data-name="paragraphs">Paragraphs</div>\n            <div class="icon-headings" data-name="headings">Headings</div>\n          </div>\n\n          <div class="filter-caption" data-initial="Properties">Properties</div>\n\n          <div class="filter weight" data-name="weight" data-multiple="1">\n            <div class="icon-light" data-name="light" data-alt="Light"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>\n            <div class="icon-heavy" data-name="heavy" data-alt="Heavy"></div>\n          </div>\n\n          <div class="filter width" data-name="width" data-multiple="0">\n            <div class="icon-condensed" data-name="condensed" data-alt="Condensed"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>\n            <div class="icon-extended" data-name="extended" data-alt="Extended"></div>\n          </div>\n\n          <div class="filter x-height" data-name="x_height" data-multiple="0">\n            <div class="icon-low" data-name="low" data-alt="Low x-height"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular x-height"></div>\n            <div class="icon-high" data-name="high" data-alt="High x-height"></div>\n          </div>\n\n          <div class="filter contrast" data-name="contrast" data-multiple="0">\n            <div class="icon-low" data-name="low" data-alt="Low Contrast"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular Contrast"></div>\n            <div class="icon-high" data-name="high" data-alt="High Contrast"></div>\n          </div>\n\n          <div class="filter capitals" data-name="capitals" data-multiple="0">\n            <div class="icon-uppercase-lowercase" data-name="uppercase-lowercase" data-alt="Standard"></div>\n            <div class="icon-all-or-small-caps" data-name="all-or-small-caps" data-alt="Caps Only"></div>\n          </div>\n\n          <div class="filter number-style" data-name="number_style" data-multiple="0">\n            <div class="icon-uppercase" data-name="uppercase" data-alt="Lining Figures"></div>\n            <div class="icon-lowercase" data-name="lowercase" data-alt="Old Style Figures"></div>\n          </div>\n\n\n\n          <div class="language-wrapper">\n            <div class="caption">Language Support</div>\n            <div class="arrow"></div>\n\n            <div class="filter language" data-name="language" data-multiple="1">\n              <div class="top-left left" data-name="ca">Catalan</div>\n              <div data-name="cs">Czech</div>\n              <div class="top-right" data-name="de">German</div>\n\n              <div class="left" data-name="en">English</div>\n              <div data-name="es">Spanish</div>\n              <div data-name="fr">French</div>\n\n              <div class="left" data-name="it">Italian</div>\n              <div data-name="nl">Dutch</div>\n              <div data-name="pl">Polish</div>\n\n              <div class="bottom-left bottom left" data-name="pt">Portugese</div>\n              <div class="with-corner bottom" data-name="ru">Russian</div>\n              <div class="bottom-right bottom" data-name="sv">Swedish</div>\n\n              <span class="context-panel-corner"><span class="corner"></span></span>\n            </div>\n          </div>\n\n          <a class="logo" href="http://typekit.com" target="_blank"></a>\n\n        </div>\n\n\n\n\n\n        <div class="provider-filter '+(null==(__t="webtype"==initial?"":"invisible")?"":__t)+'" data-name="webtype">\n\n          <div class="filter-caption" data-initial="Classification">Classification</div>\n\n          <div class="filter classification" data-name="classification" data-multiple="0">\n            <div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>\n            <div class="icon-serif" data-name="serif" data-alt="Serif"></div>\n            <div class="icon-monospaced" data-name="monospaced" data-alt="Monospaced"></div>\n          </div>\n\n          <div class="filter-caption" data-initial="For">For</div>\n\n          <div class="filter recommended-for" data-name="recommended_for" data-multiple="1">\n            <div class="icon-paragraphs" data-name="paragraphs">Paragraphs</div>\n            <div class="icon-headings" data-name="headings">Headings</div>\n          </div>\n\n          <div class="filter-caption" data-initial="Properties">Properties</div>\n\n          <div class="filter weight" data-name="weight" data-multiple="1">\n            <div class="icon-light" data-name="light" data-alt="Light"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>\n            <div class="icon-heavy" data-name="heavy" data-alt="Heavy"></div>\n          </div>\n\n          <div class="filter width" data-name="width" data-multiple="0">\n            <div class="icon-condensed" data-name="condensed" data-alt="Condensed"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>\n            <div class="icon-extended" data-name="extended" data-alt="Extended"></div>\n          </div>\n\n          <div class="filter x-height" data-name="x_height" data-multiple="0">\n            <div class="icon-low" data-name="low" data-alt="Low x-height"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular x-height"></div>\n            <div class="icon-high" data-name="high" data-alt="High x-height"></div>\n          </div>\n\n          <div class="filter contrast" data-name="contrast" data-multiple="0">\n            <div class="icon-low" data-name="low" data-alt="Low Contrast"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular Contrast"></div>\n            <div class="icon-high" data-name="high" data-alt="High Contrast"></div>\n          </div>\n\n\n          <div class="language-wrapper">\n            <div class="caption">Language Support</div>\n            <div class="arrow"></div>\n\n\n            <div class="filter language" data-name="language" data-multiple="1">\n              <div class="bottom-left top-left left bottom" data-name="latin">Latin</div>\n              <div class="with-corner bottom" data-name="cyrillic">Cyrillic</div>\n              <div class="top-right bottom-right bottom" data-name="greek">Greek</div>\n\n              <span class="context-panel-corner"><span class="corner"></span></span>\n            </div>\n\n          </div>\n\n          <a class="logo" href="http://webtype.com" target="_blank"></a>\n\n        </div>\n\n\n\t\t\t\t<div class="provider-filter '+(null==(__t="google"==initial?"":"invisible")?"":__t)+'" data-name="google">\n\n\t\t\t\t\t<div class="filter-caption" data-initial="Category">Category</div>\n\n\t\t\t\t\t<div class="filter classification" data-name="category" data-multiple="0">\n\t\t\t\t\t\t<div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>\n\t\t\t\t\t\t<div class="icon-serif" data-name="serif" data-alt="Serif"></div>\n\t\t\t\t\t\t<div class="icon-script" data-name="handwriting" data-alt="Handwriting"></div>\n\t\t\t\t\t\t<div class="icon-monospaced" data-name="monospace" data-alt="Monospaced"></div>\n\t\t\t\t\t\t<div class="icon-decorative" data-name="display" data-alt="Display"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="filter-caption">Properties</div>\n\n          <div class="filter variable-fonts" data-name="variable" data-multiple="0">\n            <div data-name="variable">Variable</div>\n          </div>\n\n\t\t\t\t\t<div class="language-wrapper">\n\t\t\t\t\t\t<div class="caption">Language Support</div>\n\t\t\t\t\t\t<div class="arrow"></div>\n\n\n\t\t\t\t\t\t<div class="filter language" data-name="subsets" data-multiple="1">\n\t\t\t\t\t\t\t<div class="top-left left" data-name="cyrillic">Cyrillic</div>\n\t\t\t\t\t\t\t<div data-name="devanagari">Devanagari</div>\n\t\t\t\t\t\t\t<div class="top-right" data-name="greek">Greek</div>\n\n\t\t\t\t\t\t\t<div class="bottom-left bottom left" data-name="khmer">Khmer</div>\n\t\t\t\t\t\t\t<div class="with-corner bottom" data-name="latin">Latin</div>\n\t\t\t\t\t\t\t<div class="bottom-right bottom" data-name="vietnamese">Vietnamese</div>\n\n\t\t\t\t\t\t\t<span class="context-panel-corner"><span class="corner"></span></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<a class="logo" href="http://google.com/fonts" target="_blank"></a>\n\n\t\t\t\t</div>\n\n\n        <div class="provider-filter '+(null==(__t="typetoday"==initial?"":"invisible")?"":__t)+'" data-name="typetoday">\n\n          <div class="filter-caption" data-initial="Classification">Classification</div>\n\n          <div class="filter classification" data-name="classification" data-multiple="0">\n            <div class="icon-sans-serif" data-name="sans-serif" data-alt="Sans Serif"></div>\n            <div class="icon-serif" data-name="serif" data-alt="Serif"></div>\n          </div>\n\n          <div class="filter-caption" data-initial="For">For</div>\n\n          <div class="filter recommended-for" data-name="recommended_for" data-multiple="1">\n            <div class="icon-paragraphs" data-name="paragraphs">Paragraphs</div>\n            <div class="icon-headings" data-name="headings">Headings</div>\n          </div>\n\n          <div class="filter-caption" data-initial="Properties">Properties</div>\n\n          <div class="filter weight" data-name="weight" data-multiple="1">\n            <div class="icon-light" data-name="light" data-alt="Light"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>\n            <div class="icon-heavy" data-name="heavy" data-alt="Heavy"></div>\n          </div>\n\n          <div class="filter width" data-name="width" data-multiple="0">\n            <div class="icon-condensed" data-name="condensed" data-alt="Condensed"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular"></div>\n            <div class="icon-extended" data-name="extended" data-alt="Extended"></div>\n          </div>\n\n          <div class="filter x-height" data-name="x_height" data-multiple="0">\n            <div class="icon-low" data-name="low" data-alt="Low x-height"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular x-height"></div>\n            <div class="icon-high" data-name="high" data-alt="High x-height"></div>\n          </div>\n\n          <div class="filter contrast" data-name="contrast" data-multiple="0">\n            <div class="icon-low" data-name="low" data-alt="Low Contrast"></div>\n            <div class="icon-regular" data-name="regular" data-alt="Regular Contrast"></div>\n            <div class="icon-high" data-name="high" data-alt="High Contrast"></div>\n          </div>\n\n          <div class="filter capitals" data-name="capitals" data-multiple="0">\n            <div class="icon-uppercase-lowercase" data-name="uppercase-lowercase" data-alt="Standard"></div>\n            <div class="icon-all-or-small-caps" data-name="all-or-small-caps" data-alt="Caps Only"></div>\n          </div>\n\n          <div class="filter number-style" data-name="number_style" data-multiple="0">\n            <div class="icon-uppercase" data-name="uppercase" data-alt="Lining Figures"></div>\n            <div class="icon-lowercase" data-name="lowercase" data-alt="Old Style Figures"></div>\n          </div>\n\n\n\n          <div class="language-wrapper">\n            <div class="caption">Language Support</div>\n            <div class="arrow"></div>\n\n            <div class="filter language" data-name="language" data-multiple="1">\n              <div class="top-left left" data-name="ca">Catalan</div>\n              <div data-name="cs">Czech</div>\n              <div class="top-right" data-name="de">German</div>\n\n              <div class="left" data-name="en">English</div>\n              <div data-name="es">Spanish</div>\n              <div data-name="fr">French</div>\n\n              <div class="left" data-name="it">Italian</div>\n              <div data-name="nl">Dutch</div>\n              <div data-name="pl">Polish</div>\n\n              <div class="bottom-left bottom left" data-name="pt">Portugese</div>\n              <div class="with-corner bottom" data-name="ru">Russian</div>\n              <div class="bottom-right bottom" data-name="sv">Swedish</div>\n\n              <span class="context-panel-corner"><span class="corner"></span></span>\n            </div>\n          </div>\n\n          <a class="logo" href="https://type.today" target="_blank"></a>\n\n        </div>\n\n\t\t\t\t<div class="font-info">\n\t\t\t\t\t<div class="top-info">\n\t\t\t\t\t\t<div class="name"></div>\n\t\t\t\t\t\t<div class="foundry">by <a target="_blank" href="http://123"></a></div>\n\t\t\t\t\t\t<div class="description-wrapper huge">\n\t\t\t\t\t\t\t<div class="description"></div>\n\t\t\t\t\t\t\t<a class="more" target="_blank" href="http://123">More...</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="promo">To get more styles of this typeface visit <a href="https://type.today" target="_blank">type.today</a></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="bottom-info">\n\t\t\t\t\t\t<div class="language-wrapper">\n\t\t\t\t\t\t\t<div class="caption">Language Support:</div>\n\t\t\t\t\t\t\t<div class="language">\n\t\t\t\t\t\t\t\t<div class="language-clamp"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="recommended-wrapper">\n\t\t\t\t\t\t\t<div class="caption">Recommended For:</div>\n\t\t\t\t\t\t\t<div class="recommended"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="info-add-remove-font">Add to Font Selector</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\n\t\t\t<div class="overlay">\n\t\t\t\t<div class="preloader"></div>\n\t\t\t</div>\n\n\t\t</div>\n\t</div>\n'}return __p},"template-constructor-helpers-font-explorer-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="font-item" data-img1="'+(null==(__t=img1)?"":__t)+'" data-img2="'+(null==(__t=img2)?"":__t)+'" data-font-name="'+(null==(__t=name)?"":__t)+'" data-font-id="'+(null==(__t=id)?"":__t)+'" data-font-provider="'+(null==(__t=provider)?"":__t)+'">\n\t\t<div class="caption">'+(null==(__t=text)?"":__t)+'<span class="styles-count">'+(null==(__t=styles)?"":__t)+" "+(null==(__t=Utils.declination("styles","style","styles",styles))?"":__t)+'</span></div>\n\t\t<div class="list-add-remove-font"></div>\n\t</div>\n';return __p},"template-constructor-helpers-font-explorer-no-found":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="no-found">\n\t\t<div class="header">Fk</div>\n\t\t<div class="sub-header">Sorry, no fonts found.</div>\n\t\t<div class="message">Try selecting fewer options.</div>\n\t</div>\n';return __p}}},epOA:function(module,exports){module.exports={"template-constructor-pages-panel-settings":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="pages-panel-settings hidden auto-index '+(null==(__t=mag.is_published?"published":"")?"":__t)+" "+(null==(__t=mag.prevPubVersionId?"can-revert":"")?"":__t)+" "+(null==(__t=mag.changed?"changed":"")?"":__t)+'">\n\t\t<div class="pages-panel-settings-wrapper">\n\t\t\t<div class="context-block-layer hidden"></div>\n\t\t\t<div class="tab-switcher">\n\t\t\t\t<div class="knob"></div>\n\t\t\t\t<div class="tab active" data-name="info"><span>General</span></div>\n\t\t\t\t<div class="tab" data-name="privacy"><span>Privacy</span></div>\n\t\t\t\t<div class="tab" data-name="domain"><span>Domain</span></div>\n\t\t\t\t<div class="tab" data-name="viewer"><span>Viewer</span></div>\n\t\t\t</div>\n\t\t\t<div class="content">\n\t\t\t\t<div class="panel info"></div>\n\t\t\t\t<div class="panel privacy hidden"></div>\n\t\t\t\t<div class="panel domain hidden"></div>\n\t\t\t\t<div class="panel viewer hidden"></div>\n\n\t\t\t\t<div class="publish-dates">\n\t\t\t\t\t<div class="publish-date">Published<br/><span></span></div>\n\t\t\t\t\t<div class="republish-date">Updated<br/><span></span></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="cover_wrap">\n\t\t\t\t\t<img class="first-page-screen" src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/spacer.gif" />\n\t\t\t\t\t<a href=""></a>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="mag-url-wrapper">\n\t\t\t\t\t<a class="mag-url" data-testid="project-link"></a>\n\t\t\t\t</div>\n\n\t\t\t\t',mag.doesUserHaveAccess&&(__p+='\n\t\t\t\t<div class="export-wrapper">\n\t\t\t\t\t<span>Export to </span>\n\t\t\t\t\t<span class="export-pdf">PDF</span>\n\t\t\t\t\t<span> or </span>\n\t\t\t\t\t<span class="export-code">HTML</span>\n\t\t\t\t</div>\n\t\t\t\t'),__p+="\n\n\t\t\t\t",mag.user&&mag.user.permissions&&mag.user.permissions.can_export_template&&(__p+='\n\t\t\t\t<div class="export-template-block">\n\t\t\t\t\t<input class="export-template" id="export-template" type="checkbox" name="export-template" value="">\n\t\t\t\t\t<label for="export-template">Export as template</label>\n\t\t\t\t</div>\n\t\t\t\t'),__p+="\n\n\n\t\t\t\t",isOwner&&(__p+='\n\t\t\t\t<div class="restore-block">\n\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t<span class="restore">Restore to published version</span>\n\t\t\t\t\t<div class="context-panel restore-panel">\n\t\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t\t<div class="restore-panel-caption">Are you sure you want to restore to published? </div>\n\t\t\t\t\t\t<div class="restore-panel-yes">Yes, please</div>\n\t\t\t\t\t\t<div class="restore-panel-cancel">Cancel</div>\n\t\t\t\t\t\t<div class="context-panel-corner"><div class="corner"></div></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t'),__p+='\n\n\n\t\t\t\t<div class="unpublish-block '+(null==(__t=isOwner?"":"centered")?"":__t)+'"><span class="unpublish">Unpublish</span> ',isOwner&&(__p+="or&nbsp;"),__p+="</div>\n\t\t\t\t",isOwner&&(__p+='\n\t\t\t\t<div class="delete-block">\n\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t<span class="delete">Delete project</span>\n\t\t\t\t\t<div class="context-panel delete-panel">\n\t\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t\t<div class="delete-panel-caption">Are you sure you want to delete this project?</div>\n\t\t\t\t\t\t<div class="delete-panel-yes">Yes, please</div>\n\t\t\t\t\t\t<div class="delete-panel-cancel">Cancel</div>\n\t\t\t\t\t\t<div class="context-panel-corner"><div class="corner"></div></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t'),__p+='\n\n\t\t\t\t<div data-testid=\'publish\' class="publish">Publish</div>\n\t\t\t\t<div class="publish-error">Error</div>\n\n\t\t\t\t<div class="submit-to-explore jsSubmitToExplore">\n\t\t\t\t\t<div class="submit-to-explore__text '+(null==(__t=isActiveSubscription?"":"upgrade")?"":__t)+'">\n\t\t\t\t\t',isActiveSubscription?__p+='\n\t\t\t\t\t\t<span class="submit-to-explore__part jsSubmitToExplorePart">Submit to </span>\n\t\t\t\t\t\t<a class="submit-to-explore__url" href="/examples">Examples</a>\n\t\t\t\t\t':__p+='\t\t\t\n\t\t\t\t\t\t<a class="submit-to-explore__url" href="/pricing">Upgrade</a>\n\t\t\t\t\t\t<span class="submit-to-explore__part jsSubmitToExplorePart">your account to&nbsp;submit projects to&nbsp;\n\t\t\t\t\t\t\t<a class="submit-to-explore__url" href="/examples">Examples</a>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t',__p+='\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="submit-to-explore__wrapper jsSubmitToExploreWrapper">\n\t\t\t\t\t\t<div class="jsSubmitToExploreSwitcher"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="republish-block">\n\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t<div class="republish-text">You have some unpublished changes in this project</div>\n\t\t\t\t\t<div class="republish">Republish</div>\n\t\t\t\t\t<div class="republish-error">Error</div>\n\t\t\t\t\t<div class="republish-settings">\n\t\t\t\t\t\t<div class="context-panel republish-panel minor">\n\t\t\t\t\t\t\t<div class="republish-panel-minor">\n\t\t\t\t\t\t\t\t<div class="republish-panel-text">Minor Changes<div class="republish-panel-arrow"></div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="republish-panel-major">\n\t\t\t\t\t\t\t\t<div class="republish-panel-text">Major Update<div class="republish-panel-arrow"></div></div>\n\t\t\t\t\t\t\t\t\x3c!--__magterm--\x3e\n\t\t\t\t\t\t\t\t<div class="republish-panel-anno">Your followers will see this project in their Inboxes again after the republishing. Tell them what\'s new:</div>\n\t\t\t\t\t\t\t\t<textarea maxlength="128" class="republish-panel-desc" placeholder="               (optional)"></textarea>\n\t\t\t\t\t\t\t\t<div class="republish-panel-scroll"></div>\n\t\t\t\t\t\t\t\t<div class="republish-panel-desc-symbols">128</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class="context-panel-corner"><div class="corner"></div></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="preloader">\n\t\t\t\t\t<div class="rmpreloader">\n\t\t\t\t\t\t<div class="shadow"></div>\n\t\t\t\t\t\t<div class="arc"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t\t<div class="code-editor-block invisible"></div>\n\n\t\t</div>\n\t</div>\n';return __p}}},etQA:function(t,e,i){},fEUr:function(t,e,i){"use strict";var n,o,a;i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o})),i.d(e,"c",(function(){return a})),function(t){t.hover="hover",t.scroll="scroll"}(n||(n={})),function(t){t.horizontally="horizontally",t.vertically="vertically"}(o||(o={})),function(t){t.bottom="bottom",t.center="center",t.top="top"}(a||(a={}))},fueH:function(t,e,i){"use strict";var n=i("q1tI"),o=i.n(n),a=i("scwL"),r=i.n(a),s=i("xG9w"),l=i("Mpt7"),c=i("Yk1I"),d=i.n(c),h=i("v83y"),u=i("mIwl"),p=i("w5C2"),m=i("A9VP"),g=i("zjto"),f=i("Pgkd"),v=i("zMlX"),b=i("LDvm"),y=i("Jzj8"),_=i("a68n"),w=i("HjzJ"),k=i("38uW"),S=i("IrH7"),x=i("w+s/"),C=i("zZDe"),O=i("v92f"),j=i("uU7u"),P=i("ulVh");function E(t,e){return T(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||$(t,e)||I()}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(t){if(Array.isArray(t))return t}function M(t){return function(t){if(Array.isArray(t))return R(t)}(t)||A(t)||$(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,e){if(t){if("string"==typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?R(t,e):void 0}}function A(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function D(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function B(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){D(a,n,o,r,s,"next",t)}function s(t){D(a,n,o,r,s,"throw",t)}r(void 0)}))}}function L(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function z(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?L(Object(i),!0).forEach((function(e){F(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function F(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var N=Object(f.b)({styleToHTML:function(){return o.a.createElement("span",null)},blockToHTML:function(){return o.a.createElement("p",null)},entityToHTML:function(t,e){return t.type===C.b?o.a.createElement("br",null):e}}),H=function(t,e){return h.EditorState.forceSelection(t,e||t.getSelection())},V=function(t,e){return"function"==typeof t.get?t.get(e):t[e]},W=function(t){var e={blocks:(V(t,"blocks")||[]).map((function(e){var i=(V(t,"styles")||[]).find((function(t){return t.key===e.key})),n=(V(t,"blocksMeta")||[]).find((function(t){return t.key===e.key})),o=[];return i&&(o="object"===U(i.inlineStyles)&&i.inlineStyles.hasOwnProperty("keys")&&i.inlineStyles.hasOwnProperty("values")?ht(i.inlineStyles):(null==i?void 0:i.inlineStyles)||[]),z(z({},e),{},{data:(null==n?void 0:n.data)||e.data||{},type:i?i.type:p.a.Unstyled,inlineStyleRanges:o})}))||[],entityMap:V(t,"entityMap")||{}};return Object(h.convertFromRaw)(e)},G=function(t){var e=Object(h.convertToRaw)(t),i=e.blocks.map((function(t){return{key:t.key,text:t.text,entityRanges:t.entityRanges,depth:t.depth}})),n=e.blocks.map((function(t){return{key:t.key,type:t.type,inlineStyles:ct(t.inlineStyleRanges)}})),o=e.blocks.map((function(t){return{key:t.key,data:t.data||{}}}));return{blocks:i,styles:n,entityMap:e.entityMap,blocksMeta:o}},q=function(t){var e=X(t,!0),i=t.getSelection();if(2!==e.length)return i;if(0!==i.getAnchorOffset()||0!==i.getFocusOffset())return i;var n=t.getCurrentContent(),o=i.getStartKey(),a=n.getBlockForKey(o);return new h.SelectionState({anchorKey:o,anchorOffset:0,focusKey:o,focusOffset:a.getText().length,isBackward:!1,isCollapsed:i.isCollapsed()})},K=function(t){var e=t.getCurrentInlineStyle();return Object(m.b)(e)};var Y=function(t){var e=t.editorState,i=t.blockKey,n=t.data,o=t.selection||e.getSelection(),a=e.getCurrentContent(),r=a.getBlockMap(),s=a.getBlockForKey(i),c=s.get("data"),d=s.set("data",l.a.Map(z(z({},c?c.toObject():{}),n)));return a.merge({blockMap:r.merge(F({},s.getKey(),d)),selectionBefore:o,selectionAfter:o})},X=function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t.getSelection();if(o.isCollapsed())return[o.getStartKey()];var a=t.getCurrentContent(),r=o.getIsBackward(),s=r?o.getFocusKey():o.getAnchorKey(),l=r?o.getAnchorKey():o.getFocusKey(),c=0===o.getFocusOffset()&&0===o.getAnchorOffset()&&s!==l,d=0===o.getFocusOffset()&&s!==l&&o.getAnchorOffset()===(null===(e=a.getBlockForKey(o.getAnchorKey()))||void 0===e||null===(i=e.getCharacterList())||void 0===i?void 0:i.size),h=a.getBlockMap().toIndexedSeq(),u=h.map((function(t){return t&&t.getKey()})).toJS(),p=[],m=u.indexOf(s),g=u.indexOf(l);return m>-1&&g>-1&&(p=u.slice(m,g+1)),(!n&&c||d)&&p.pop(),p},Z=function(t){var e=t.getSelection(),i=e.getIsBackward(),n=i?e.getFocusKey():e.getAnchorKey(),o=i?e.getAnchorKey():e.getFocusKey(),a=i?e.getEndOffset():e.getStartOffset(),r=i?e.getStartOffset():e.getEndOffset();if(0===a&&0===r){var s=i?o:n;return{startKey:s,endKey:s,startOffset:0,endOffset:t.getCurrentContent().getBlockForKey(s).getCharacterList().size}}return{startKey:n,endKey:o,startOffset:a,endOffset:r}},J=function(t){return t.some((function(t){return t&&t.style.length}))},Q=function(t){return t.some((function(t){return function(t){return"text"===t.type}(t)&&3===t.version}))},tt=/url\((?:"|'|)(.*?)(?:"|'|)\)/g;function et(t){return it.apply(this,arguments)}function it(){return(it=B(regeneratorRuntime.mark((function t(e){var i,n,o,a,r,s,l,c,d,h,u,p;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i={},t.t0=regeneratorRuntime.keys(document.styleSheets);case 2:if((t.t1=t.t0()).done){t.next=24;break}n=t.t1.value,o=document.styleSheets[n],a=null,t.prev=6,a=o.rules||o.cssRules,t.next=16;break;case 10:if(t.prev=10,t.t2=t.catch(6),!o.href||o.href.includes("cloudfront.net")){t.next=16;break}return t.next=15,nt(o.href);case 15:a=t.sent;case 16:if(a){t.next=21;break}if(!o.href||o.href.includes("cloudfront.net")){t.next=21;break}return t.next=20,nt(o.href);case 20:a=t.sent;case 21:if(a)for(r in a)(s=a[r])&&s instanceof CSSFontFaceRule&&(c=null===(l=s.style)||void 0===l?void 0:l.getPropertyValue("src"),(null==(d=null==c?void 0:c.match(tt))?void 0:d.length)&&(u=d[d.length-1].slice(4,-1).replace(/"/g,"").replace(/'/g,""),p=null===(h=s.style)||void 0===h?void 0:h.getPropertyValue("font-family").replace(/['"]+/g,""),i[p]=u));t.next=2;break;case 24:if(!e){t.next=26;break}return t.abrupt("return",i[e]||null);case 26:return t.abrupt("return",i);case 27:case"end":return t.stop()}}),t,null,[[6,10]])})))).apply(this,arguments)}var nt=function(){var t=B(regeneratorRuntime.mark((function t(e){var i,n,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e).then((function(t){return t.text()})).catch((function(t){console.error("Error while getting stylesheet from url ".concat(e,": "),t)}));case 2:if(!(i=t.sent)){t.next=12;break}return(n=document.createElement("style")).type="text/css",n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i)),document.head.appendChild(n),o=n.sheet||n.styleSheet,a=o&&(o.rules||o.cssRules)?o.rules||o.cssRules:null,document.head.removeChild(n),t.abrupt("return",a);case 12:return t.abrupt("return",null);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ot=function(t,e){var i=t;return"string"==typeof i&&/^\d+$/.test(i)&&(i=Number(i)),"string"==typeof i?"v":"".concat(e[0].toLowerCase()).concat(Math.floor(i/100))},at=function(){var t=B(regeneratorRuntime.mark((function t(e){var i,n,o,a,r,s,l,c,d,h,u,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.fontFamily,n=e.fontWeight,o=e.fontStyle,a={features:[],variations:[],characters:[]},r=window.RM.constructorRouter.fonts.findFontByCSSName(i),s=ot(n,o),r&&r.variations&&r.variations.includes(s)){t.next=6;break}return t.abrupt("return",a);case 6:if(l={weight:s},!r||"custom"!==r.provider){t.next=11;break}l.id=r._id,t.next=15;break;case 11:return t.next=13,et(i);case 13:(c=t.sent)&&(l.url=c);case 15:if(r&&"system"===r.provider&&(l.systemFontName=r.name),!(!l.url&&!l.id&&!l.systemFontName||l.id&&!l.weight)){t.next=19;break}return t.abrupt("return",void 0);case 19:return t.prev=19,t.next=22,Object(b.u)(l);case 22:return d=t.sent,h=d.data,(u=h&&h.features)&&u.length&&(p=Object.values(v.a),m=p.filter((function(t){return u.some((function(e){return e.toLowerCase()===t.toLowerCase()}))})),a.features=m||[]),a.variations=h&&h.variations,a.characters=h&&h.characters,t.abrupt("return",a);case 31:throw t.prev=31,t.t0=t.catch(19),new Error(t.t0||"Can't detect font features");case 34:case"end":return t.stop()}}),t,null,[[19,31]])})));return function(e){return t.apply(this,arguments)}}(),rt=function(t,e){return"".concat(t).concat(";").concat(e)},st=function(t,e){var i=gt.getSelectionOffset(t),n=i.startOffset,o=i.endOffset,a=t.getSelection(),r=gt.getSelectedBlocks(t),s=t.getCurrentContent().getBlockMap();return s.forEach((function(t){if(t){var i=t.getKey();if(r.includes(i)){var a=t.getCharacterList().map((function(t,a){if(!t||void 0===a)return t;var s=t.getStyle().filter((function(t){return!!t&&t.startsWith(e)})).toJS(),l=function(t,e){return h.CharacterMetadata.removeStyle(t,e)};if(1===r.length){if(a>=n&&a<o)return s.reduce(l,t)}else if(r[0]===i){if(a>=n)return s.reduce(l,t)}else{if(r[r.length-1]!==i)return s.reduce(l,t);if(a<o)return s.reduce(l,t)}return t})),l=t.set("characterList",a);s=s.set(i,l)}}})),gt.forceSelection(h.EditorState.push(t,h.ContentState.createFromBlockArray(s.toArray()),"change-inline-style"),a)},lt=function(t,e){return t.replace("".concat(e).concat(";"),"").split(";")},ct=function(t){var e=[],i=[],n=[];return t.forEach((function(t){var o,a=e.findIndex((function(e){return e.offset===t.offset&&e.length===t.length})),r=t.style.split(";"),s=T(o=r)||A(o)||$(o)||I(),l=s[0],c=s.slice(1).join(";"),d=i.indexOf(l);-1===d&&(i.push(l),d=i.length-1);var h=n.indexOf(c);-1===h&&(n.push(c),h=n.length-1);var u=t.style.replace(l,String(d)).replace(c,String(h));a>-1?e[a].styles.includes(t.style)||e[a].styles.push(u):e.push({offset:t.offset,length:t.length,styles:[u]})})),{styles:dt(e),keys:i,values:n}},dt=function(t){var e=null,i=[];return t.forEach((function(t,n){if(null===e)e=n,i.push(t);else if(i[i.length-1]){var o=i[i.length-1],a=o.offset,r=o.length,l=o.styles;a+r===t.offset&&Object(s.isEqual)(l,t.styles)?i[i.length-1]=z(z({},i[i.length-1]),{},{length:r+t.length}):(e=n,i.push(t))}})),i},ht=function(t){var e=t.keys,i=t.values,n=t.styles,o=[];return n.forEach((function(t){t.styles.forEach((function(n){var a=E(n.split(";"),2),r=a[0],s=a[1];o.push({offset:t.offset,length:t.length,style:"".concat(e[Number(r)]).concat(";").concat(i[Number(s)])})}))})),o},ut={},pt=Math.pow(2,24),mt=function(t){return"text"===t.type},gt={forceSelection:H,toggleInlineStyle:function(t,e){return h.RichUtils.toggleInlineStyle(t,e)},getCurrentBlock:function(t){return t.getCurrentContent().getBlockForKey(t.getSelection().getStartKey())},getCurrentBlockType:function(t){return t.getCurrentContent().getBlockForKey(t.getSelection().getStartKey()).getType()},toggleBlockType:function(t,e){return h.RichUtils.toggleBlockType(t,e)},importTextContent:W,exportTextContent:G,creatNewWidgetContent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.text,i=t.html,n=i?Object(P.b)(i):h.ContentState.createFromText(e||Object(u.a)());return G(n)},fixSelection:q,getAllTextSelection:function(t){var e=t.getCurrentContent();return t.getSelection().merge({anchorKey:e.getFirstBlock().getKey(),anchorOffset:0,focusOffset:e.getLastBlock().getText().length,focusKey:e.getLastBlock().getKey()})},clearSelection:function(t){var e=h.EditorState.moveSelectionToEnd(t).getSelection();return H(t,e)},hasSelectedText:function(t){var e=t.getSelection();return e.getAnchorKey()!==e.getFocusKey()||e.getAnchorOffset()!==e.getFocusOffset()},clearStylesFromBlock:function(t){var e,i=t.editorState,n=t.block,o=i.getCurrentContent().getBlockMap(),a=n,r="";a?r=a.getKey():(r=i.getSelection().getAnchorKey(),a=o.get(r));var s=a.getCharacterList().map((function(t){return t?t.set("style",t.get("style").clear()):t})),c=a.get("data"),d=l.a.Map(z(z({},c?c.toObject():{}),{},(F(e={},k.c,void 0),F(e,S.c,void 0),F(e,x.c,void 0),e))),u=a.set("characterList",s).set("data",d),p=o.set(r,u);return h.EditorState.push(i,h.ContentState.createFromBlockArray(p.toArray()),"change-inline-style")},getStyleFromSelection:K,getBlockData:function(t){var e,i=t.editorState,n=t.block,o=t.key;if(n)e=n;else if(i){var a=i.getSelection().getAnchorKey();e=i.getCurrentContent().getBlockMap().get(a)}if(!e)return"";var r=e.getData().toObject();return o?r&&r[o]||void 0:r},setBlockData:function(t){var e=t.editorState,i=t.block,n=t.key,o=t.value,a=q(e);if(i){var r=Y({editorState:e,selection:a,blockKey:i.getKey(),data:F({},n,o)});return h.EditorState.push(e,r,"change-block-data")}return X(e).reduce((function(t,i){var r=Y({editorState:t,selection:a,blockKey:i,data:F({},n,o)});return h.EditorState.push(e,r,"change-block-data")}),e)},getSelectedBlocks:X,isBlockSelected:function(t,e){return X(t).includes(e)},insertText:function(t){var e=t.editorState,i=t.text,n=t.selection,o=e.getCurrentInlineStyle(),a=n||e.getSelection(),r=e.getCurrentContent(),s=a.isCollapsed()?h.Modifier.insertText(r,a,i,o):h.Modifier.replaceText(r,a,i,o);return h.EditorState.push(e,s,1===i.length?"insert-characters":"insert-fragment")},removeText:function(t){var e=t.editorState,i=t.selection,n=e.getCurrentContent(),o=h.Modifier.removeRange(n,i,"forward");return h.EditorState.push(e,o,"remove-range")},getTextFromTextWidget:function(t){if(t.get("version")===g.h){var e=W(t.attributes),i=N(e);if(i){var n=document.createElement("span");return n.innerHTML=i,n.textContent||n.innerText}}return""},findSubstringIndexes:function(t,e){var i=t.getText();return Array.from(r()(i,RegExp(e,"g")),(function(t){return t.index})).filter((function(t){return"number"==typeof t}))},reverseSelection:function(t){return t.getIsBackward()?t.merge({isBackward:!1,anchorKey:t.getFocusKey(),anchorOffset:t.getFocusOffset(),focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset()}):t},getSelectionOffset:Z,doesSelectionHaveStyle:function(t){if(t.getSelection().isCollapsed()){var e=K(t);return Boolean(e&&Object.keys(e).length)}var i=t.getCurrentContent(),n=Z(t),o=n.startKey,a=n.endKey,r=n.startOffset,s=n.endOffset;if(o===a){var l=i.getBlockForKey(o).getCharacterList().slice(r,s).toJS();return J(l)}return X(t).some((function(t){var e=i.getBlockForKey(t).getCharacterList(),n=o===t?r:0,l=a===t?s:e.size,c=e.slice(n,l).toJS();return J(c)}))},selectCurrentBlock:function(t){var e=t.getSelection(),i=e.getStartKey();if(i===e.getEndKey()){var n=t.getCurrentContent(),o=e.merge({anchorKey:i,anchorOffset:0,focusOffset:n.getBlockForKey(i).getText().length,focusKey:i});return H(t,o)}return t},getWordCaretSelection:function(t,e){var i=t.getSelection();if(i.isCollapsed()){var n=t.getCurrentContent(),o=Z(t),a=o.startKey,r=o.endKey,s=o.startOffset;o.endOffset;if(a===r){var l=n.getBlockForKey(a).getText(),c=null;if("next"===e)for(var d=s+1;d<=l.length;d++)null!==c||" "!==l[d]&&d!==l.length||(c=d);else if("prev"===e)for(var h=s-1;h>=0;h--)null===c&&(" "===l[h]&&Math.abs(s-h)>1||0===h)&&(c=0===h?0:h+1);if(null!==c){var u=i.merge({anchorKey:a,anchorOffset:c,focusOffset:r,focusKey:c});return H(t,u)}}}},cloneStylesOnReturn:function(t){var e=t.getSelection();if(e.isCollapsed()){var i=t.getCurrentContent(),n=e.getStartKey(),o=i.getBlockForKey(n);if(o){var a=o.getData(),r=h.Modifier.splitBlock(t.getCurrentContent(),t.getSelection()),s=h.EditorState.push(t,r,"split-block"),l=s.getSelection(),c=h.Modifier.mergeBlockData(s.getCurrentContent(),l,a);return{status:"handled",editorState:s=h.EditorState.push(t,c,"split-block")}}}},hasNewTextWidgets:function(t){if(!t)return!1;var e=z({},t);return!(!e.pages||!e.pages.length)&&e.pages.some((function(t){return t.wids&&t.wids.length&&Q(t.wids)}))},someTextWidgets:Q,getAllEntities:function(t,e){var i,n=t.getCurrentContent().getEntityMap(),o=null==n||null===(i=n.__getAll())||void 0===i?void 0:i.toJS();return o?e?Object(s.pick)(o,(function(t){return t.type===e})):o:{}},generateRandomKey:function(){for(var t;void 0===t||ut.hasOwnProperty(t)||!isNaN(+t);)t=Math.floor(Math.random()*pt).toString(32);return ut[t]=!0,t},getLigaturesType:function(t){var e=[v.a.RequiredLigatures,v.a.StandardLigatures,v.a.HistoricalLigatures,v.a.DiscretionaryLigatures];return t.filter((function(t){return e.includes(t)}))},getStylisticSets:function(t){var e=/^ss[\d]{2}$/i,i=Object.values(v.a).filter((function(t){return e.test(t)}));return t.filter((function(t){return i.includes(t)}))},getNumericVariations:function(t){var e=[v.a.LiningFigures,v.a.OldstyleFigures,v.a.ProportionalFigures,v.a.TabularFigures];return t.filter((function(t){return e.includes(t)}))},getFontWeightString:ot,getFontWeightFromString:function(t){var e=t&&M(t),i="v"===e[0];return{style:e[0]&&"i"===e[0]?"italic":"normal",weight:i?"initial":e[1]?100*parseInt(e[1]):400}},getFontFeatures:at,getTextWidgetFontsList:function(t){var e={},i=!1,n=function(t){var e=t.fontFamily,i=t.fontStyle,n=t.fontWeight,o=[];if(e){var a=lt(e,m.a.FontFamily);if(o.push(a),a){o.push(i?lt(i,m.a.FontStyle):p.b.fontStyle);var r=n?lt(String(n),m.a.FontWeight):p.b.fontWeight;"number"!=typeof r&&"normal"===r[0]&&(r=p.b.fontWeight),o.push("initial"===String(r)?"variable":r)}}return o.length?o.join("|"):null};t&&V(t,"blocks")&&W(t).getBlockMap().forEach((function(t){if(t){var o,a=new Set([]),r=t.getType(),s=Object(_.b)({block:t});if(r||s){var l=Object(y.d)()||{project:[],global:[]};if(o=[].concat(M(l.project),M(l.global)).find((function(t){return!!t.name&&(t.name.toLowerCase()===r.toLowerCase()||t.name.toLowerCase()===s.toLowerCase())}))){var c=o.cssProperties||{},d=c.fontFamily,h=c.fontWeight,u=c.fontStyle,p=n({fontFamily:d,fontStyle:u,fontWeight:h});p&&a.add(p)}}t.getCharacterList().forEach((function(t){if(t){var e=t.getStyle().toJS(),r="";if(e&&e.length){var s=o&&o.cssProperties||{},l=e.find((function(t){return t.startsWith(m.a.FontFamily)}))||s.fontFamily,c=e.find((function(t){return t.startsWith(m.a.FontStyle)}))||s.fontStyle,d=e.find((function(t){return t.startsWith(m.a.FontWeight)}))||s.fontWeight;r=n({fontFamily:l,fontStyle:c,fontWeight:d})}r?a.add(r):i=!0}}));var g=Object(w.d)({block:t});if(g){var f=Object(y.c)()||{project:[],global:[]},v=[].concat(M(f.project),M(f.global)).find((function(t){return!!t.name&&t.name.toLowerCase()===g}));if(v){var b=v.cssProperties||{},k=b.fontFamily,S=b.fontWeight,x=b.fontStyle,C=n({fontFamily:k,fontStyle:x,fontWeight:S});C&&a.add(C)}}a.forEach((function(t){e[t]=1}))}}));if(i){var o=[p.b.fontFamily,p.b.fontStyle,p.b.fontWeight].join("|");e[o]=1}return e},INLINE_STYLE_DELIMITER:";",getStyleValueString:rt,applyInlineStyle:function(t){var e=t.key,i=t.value,n=t.editorState;if(n.getSelection().isCollapsed())return n;var o=st(n,e);if(void 0===U(i))return o;var a=Array.isArray(i)?i.filter((function(t){return t})).length?i.filter((function(t){return t})).join(";"):null:i;return"string"==typeof a||"number"==typeof a||Array.isArray(a)?gt.toggleInlineStyle(o,rt(e,a)):o},removeInlineStyle:st,getCurrentInlineStylesFromString:lt,getCurrentInlineStyles:function(t,e){var i=t.getCurrentInlineStyle().toJS();if(!e)return i;var n=i.find((function(t){return t.startsWith(e)}));return n?lt(n,e):[]},minifyStyles:ct,unminifyStyles:ht,getInlineStyleForSelection:function(t){var e=t.editorState,i=t.key,n=t.defaultValue,o=gt.fixSelection(e),a=e.getCurrentContent(),r=gt.getSelectedBlocks(e).map((function(t){return a.getBlockForKey(t)})),l=[];if(!o.isCollapsed()){var c=function(t){var e=Object(s.uniq)(null==t?void 0:t.getStyle().toJS()).filter((function(t){return!l.includes(t)})).filter((function(t){return!i||t.startsWith(i)}));e.length?l.push.apply(l,M(e)):n&&i&&l.push(gt.getStyleValueString(i,n))};if(1===r.length)r[0].getCharacterList().slice(o.getStartOffset(),o.getEndOffset()).forEach(c);else r.length>1&&r.forEach((function(t,e){var i=t.getCharacterList();0===e?i.slice(o.getStartOffset()).forEach(c):e===r.length-1&&i.slice(0,o.getEndOffset()).forEach(c),i.forEach(c)}))}return Object(s.uniq)(l)},getUsedTextStyles:function(t){var e=t.filter((function(t){return mt(t)&&3===t.version})),i=Object(y.d)(),n=e.reduce((function(t,e){var i=(e.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[_.i]}));return O.b.viewport_listall.map((function(t){var n=e[t];n&&i.push.apply(i,M((n.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[_.i]}))))})),i.length?[].concat(M(t),M(i)):t}),[]).filter((function(t){return t})),o=Object(s.uniq)(n);return[].concat(M(i.global),M(i.project)).filter((function(t){return o.includes(t.name)}))},getUsedLinkStyles:function(t){var e=t.filter((function(t){return mt(t)&&3===t.version})),i=Object(y.b)(),n=e.reduce((function(t,e){var i=Object.values(e.entityMap||{}).filter((function(t){return t.type===j.f&&!!t.data})).map((function(t){return t.data.linkStyle}));return O.b.viewport_listall.map((function(t){var n=e[t];n&&i.push.apply(i,M(Object.values(n.entityMap||{}).filter((function(t){return t.type===j.f&&!!t.data})).map((function(t){return t.data.linkStyle}))))})),i.length?[].concat(M(t),M(i)).filter((function(t){return t})):t}),[]),o=Object(s.uniq)(n);return[].concat(M(i.global),M(i.project)).filter((function(t){return o.includes(t.name)}))},getUsedListStyles:function(t){var e=t.filter((function(t){return mt(t)&&3===t.version})),i=Object(y.c)(),n=e.reduce((function(t,e){var i=(e.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[w.h]}));return O.b.viewport_listall.map((function(t){var n=e[t];n&&i.push.apply(i,M((n.blocksMeta||[]).filter((function(t){return!!t.data})).map((function(t){return t.data[w.h]}))))})),i.length?[].concat(M(t),M(i)):t}),[]).filter((function(t){return t})),o=Object(s.uniq)(n);return[].concat(M(i.global),M(i.project)).filter((function(t){return o.includes(t.name)}))},canUseCustomFonts:function(t){return window.RM.constructorRouter.isOwner?(window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("permissions")||{}).can_use_custom_fonts:t.get("permissions").can_use_custom_fonts},getStringDifference:function(t,e){var i=d()(t,e),n=i.find((function(t){return 1===t[0]}));if(n){var o=n[1];return{added:!0,text:o,offset:e.indexOf(o),length:o.length}}var a=i.find((function(t){return-1===t[0]}));if(a){var r=a[1];return{added:!1,text:r,offset:t.indexOf(r),length:r.length}}},insertBreakLine:function(t){return h.RichUtils.insertSoftNewline(t)},moveText:function(t){var e=t.editorState,i=t.dropSelection,n=h.Modifier.moveText(e.getCurrentContent(),e.getSelection(),i);return h.EditorState.push(e,n,"insert-fragment")},isWholeBlockSelected:function(t){var e=t.getSelection(),i=t.getCurrentContent();if(!e.isCollapsed()){var n=X(t);if(!n.length)return!1;if(1===n.length&&e.getStartKey()===e.getEndKey()){var o=i.getBlockForKey(e.getStartKey()).getText().length;if(e.getEndOffset()-e.getStartOffset()===o)return!0}else{if(1===n.length&&0===e.getStartOffset()&&0===e.getEndOffset()&&e.getStartKey()!==e.getEndKey())return!0;var a=i.getBlockForKey(e.getEndKey()).getText().length,r=e.getStartOffset(),s=e.getEndOffset();if(0===r&&s===a)return!0}}return!1}};e.a=gt},gHxz:function(module,exports){module.exports={"template-common-hotspot-widget":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n    <div class="common-hotspot">\n\n\t    <div class="pin"></div>\n\n    </div>\n\n';return __p},"template-common-hotspot-widget-mobile-wrapper":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n    <div class="hotspot-fullscreen-wrapper invisible">\n        <div class="center-table">\n            <div class="center-cell">\n\n            </div>\n        </div>\n    </div>\n\n';return __p}}},gP9L:function(t,e,i){"use strict";var n=i("xi34"),o=i("amZL"),a={model:{event:"change"},props:{family:{type:[String,Array],default:function(){return[""]}},disabled:{type:Boolean,default:!1},vAlign:{type:String,default:"auto"},hAlign:{type:String,default:"right"},hOffset:{type:Number,default:0}},data:function(){return{visibleBox:!1,boxStyles:{}}},computed:{fontFamily:function(){return"string"==typeof this.family?[this.family]:this.family},exStyle:function(){return this.getFontFamilyStyle()},caption:function(){var t=this,e="";return this.fontFamily.forEach((function(i,n){e+=i,n+1<t.fontFamily.length&&(e+=", ")})),e}},watch:{family:function(t){!t&&this.visibleBox&&(this.visibleBox=!this.visibleBox)}},mounted:function(){if("auto"===this.vAlign){var t=this.$el.getBoundingClientRect(),e="top";t.top>window.innerHeight/2&&(e="bottom"),this.boxStyles[e]=t.height+"px"}this.boxStyles[this.hAlign]=this.hOffset+"px",this.fontselector=new o.a({$parent:Object(n.a)(this.$el.querySelector(".box_container"))}),this.fontselector.on("selectfont",this.fontChanged),this.fontselector.show()},methods:{getFontFamilyStyle:function(){return{"font-family":1===this.fontFamily.length?this.fontFamily[0]:"-apple-system, system-ui, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Fira Sans', Roboto, 'Avenir Next', 'Helvetica Neue', Helvetica, Arial, sans-serif"}},fontChanged:function(t){this.$emit("change",t)},toggleVisible:function(){this.disabled||(this.visibleBox||this.$emit("showPopup",this),this.visibleBox=!this.visibleBox)}}},r=(i("HOx4"),i("KHd+")),s=Object(r.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:{"font-family-container":!0,"container-disabled":t.disabled}},[i("span",{staticClass:"example",style:t.exStyle,on:{click:t.toggleVisible}},[t._v(t._s(t.caption))]),t._v(" "),i("div",{staticClass:"expand-arrow",on:{click:t.toggleVisible}}),t._v(" "),i("div",{staticClass:"box_container",class:{visible:t.visibleBox},style:t.boxStyles})])}),[],!1,null,null,null);e.a=s.exports},gdoY:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("4m+J"),l=i.n(s),c=i("DqjY"),d=i("pFlR"),h=i("roQd"),u=i("m41J"),p=i("OTSC"),m=i("tf3M"),g=i("I0kf"),f=1,v=a.a.View.extend({template:l.a["template-viewer-widget"],initialize:function(t,e,i){return r.a.bindAll(this),this.model=new m.default(t),this.updateWidgetData(t,e,i),this.destroyed=!1,this.$document=Object(n.a)(document),this._id=this._id||f++,this},render:function(){return this.makeBox("some-widget-class"),this.rendered=!0,this.checkLink(),this},redraw:function(){return this.checkLink(),this},updatePage:function(t){var e=this.page;(!e||t&&e.num!==t.num)&&(this.page=t,this.redraw())},canRenderImmediately:function(){return Boolean(this.DO_NOT_WAIT_FOR_PRELOAD)},widgetIsLoaded:function(){this.loaded||this.destroyed||(this.loaded=!0,this.started&&this.start(),this.trigger("loaded"))},isValid:function(){return!0},hasFontsToLoad:function(){return!1},seamlessFontsShow:function(t,e){this._id;if(c.a.isFastFontLoadCheckAvailable()&&!RM.screenshot&&!this.insideHotspot&&this.hasFontsToLoad()){e();this.makeSureFontsLoaded().then((function(e){window.requestAnimationFrame(t)})).catch((function(e){t()}))}},makeSureFontsLoaded:function(){var t=this.page.getFontsVariations([this],!0),e=[];return r.a.each(t,(function(t){var i=c.a.fastWaitForFontLoad(t.fontFamily,t.fontWeight,t.fontStyle);e.push(i)})),window.Promise.all(e)},hasAnimation:function(){return Boolean(this.getAnimations().find((function(t){return!h.a.isEmpty(t)})))},hasLoadAnimation:function(){return Boolean(this.getAnimations().find((function(t){return"load"===t.type})))},start:function(){return this.started=!0,this},stop:function(){return this.started=!1,this},hide:function(){return this.stop(),this.$el.hide(),this.wasHidden=!0,this.trigger("hidden"),this},show:function(){return this.$el.show(),this.start(),this.wasHidden=!1,this.trigger("shown"),this},destroy:function(){return this.stop(),this.destroyed=!0,this.trigger("destroyed"),delete this.animationObj,this.$el.off(),this.remove()},BringToTopZ:function(){if(this.animationObj){var t=this.animationObj.getAnimationContainer();this.animationObj.resetTimeout&&clearTimeout(this.animationObj.resetTimeout),this.animationObj.savedAnimationContainerZIndex||(this.animationObj.savedAnimationContainerZIndex=t.css("z-index")),t.css("z-index",99999+this.z)}this.$el.css("z-index",99999+this.z)},BackToNormalZ:function(){var t=function(){this.animationObj&&this.animationObj.savedAnimationContainerZIndex&&(this.animationObj.getAnimationContainer().css("z-index",this.animationObj.savedAnimationContainerZIndex||this.z),delete this.animationObj.savedAnimationContainerZIndex);delete this.animationObj.resetTimeout}.bind(this);this.animationObj&&this.animationObj.savedAnimationContainerZIndex&&(this.animationObj.resetTimeout&&clearTimeout(this.animationObj.resetTimeout),this.animationObj.resetTimeout=setTimeout(t,200)),this.$el.css("z-index",this.z)},makeBox:function(t){this.setElement(this.template({id:this._id}));var e=this.fixed_position?this.$fixedContainer:this.$pageContainer;this.animationObj&&(e=this.animationObj.getAnimationContainer()),this.$el.appendTo(e).addClass(t).toggleClass("full-width",!!this.is_full_width).toggleClass("full-height",!!this.is_full_height).toggleClass("inside-hotspot",!!this.insideHotspot),this.applyBoxStyle(),(this.is_full_width||this.is_full_height||this.fixed_position||this.sticked)&&this.listenTo(this.page,"resize",this.onPageResize),this.trigger("rendered")},onPageResize:function(){this.applyBoxStyle()},calcBoxStyle:function(t){t=t||{};var e,i={left:this.x,top:this.y,width:this.w,height:this.h,right:"",bottom:"","margin-left":"","margin-top":"","z-index":this.z||1},o=parseInt(this.full_width_margin,10)||0,a=parseInt(this.full_height_margin,10)||0,s=parseInt(this.sticked_margin,10)||0,l=this.ignoreScale?1:this.page.scale,c=this.page.mag.getContainerSizeCached().width,h=c-Object(n.a)(window).width(),m=this.fixed_position;if(this.angle&&(i.width=Math.round(this.w),i.height=Math.round(this.h),this.angle%90==0&&i.width%2!=i.height%2&&(i.width+=1)),this.is_full_height&&(i.top=-this.page.contentPosition.top+a,m?(i.top=a/l,i.height=Object(n.a)(window).height()/l-2*a,["nw","w","sw"].indexOf(m)>-1&&(m="nw"),["n","c","s"].indexOf(m)>-1&&(m="n"),["ne","e","se"].indexOf(m)>-1&&(m="ne")):i.height=this.page.pageHeight/l-2*a),this.is_full_width){var g=this.page.mag.getViewportWidth(this.page.pageViewport);if(i.left=-this.page.contentPosition.left+o,i.width=this.page.mag.getContainerSizeCached().width/l-2*o,e=-((i.width-this.page.$content[0].clientWidth)/2).toFixed(3),d.a.isOn(this.page.pageViewport,g,this.mag.viewOpts)&&this.page.mag.getContainerSizeCached().width>this.mag.viewOpts.scalewidth&&(Modernizr.msie11?(e=-(c-this.page.$content[0].clientWidth)/2-h/2,i.left=e/l):Modernizr.firefox?(i.width=i.width+1,i.left=e-1):i.left=e),m){if(i.left=o,"horizontal"==this.page.viewerType){var f=this.page.$scrollWrapper,v=f.width()-f[0].clientWidth;i.width-=v/l}["nw","n","ne"].indexOf(m)>-1&&(m="nw"),["w","c","e"].indexOf(m)>-1&&(m="w"),["sw","s","se"].indexOf(m)>-1&&(m="sw")}}if(this.sticked){v=0;"horizontal"==this.page.viewerType&&(v=this.page.$scrollWrapper.width()-this.page.$scrollWrapper[0].clientWidth),"left"==this.sticked&&(i.left=-this.page.contentPosition.left/l+s),"right"==this.sticked&&(i.left=this.page.mag.getContainerSizeCached().width/l-s-this.w-this.page.contentPosition.left/l-v/l),"top"==this.sticked&&(i.top=-this.page.contentPosition.top/l+s),"bottom"==this.sticked&&(i.top=this.$pageContainer.height()-s-this.h+this.page.contentPosition.top/l)}if(t.calcBBox){m&&(i.left*=l,i.top*=l,i.width*=l,i.height*=l),i.sinAngle=Math.sin(-(this.angle||0)*Math.PI/180),i.cosAngle=Math.cos(-(this.angle||0)*Math.PI/180);var b=u.a.calcBoundingBox(i,m);return i.width=b.bb_width,i.height=b.bb_height,i.left=b.bb_left,i.top=b.bb_top,m&&r.a.extend(i,p.default.getFixedPositionCSS(m,i,1)),{dimensions:i}}if(m){var y=this.page.mag.getViewportWidth(this.page.pageViewport);r.a.extend(i,p.default.getFixedPositionCSS(m,i,d.a.normalize(l,"transform",this.page.pageViewport,y,this.mag.viewOpts))),d.a.isOn(this.page.pageViewport,y,this.mag.viewOpts)&&d.a.isCSSZoom()&&(i.zoom=l)}var _={rotate:this.angle?this.angle+"deg":"",scaleX:this.flip_h?-1:1,scaleY:this.flip_v?-1:1};if(m){var w=this.page.mag.getViewportWidth(this.page.pageViewport),k=d.a.normalize(l,"transform",this.page.pageViewport,w,this.mag.viewOpts);_.scaleX*=k,_.scaleY*=k}return Math.abs(_.scaleX-1)<1e-6&&(_.scaleX=""),Math.abs(_.scaleY-1)<1e-6&&(_.scaleY=""),{dimensions:i,transform:_}},applyBoxStyle:function(){var t=this.calcBoxStyle();this.animationObj&&(t=this.animationObj.modifyWidgetPosition(t)),this.$el.css(t.dimensions);var e=r.a.map(t.transform,(function(t,e){return t?e+"("+t+")":""})).join(" ");p.default.applyTransform(this.$el,n.a.trim(e))},calcDistsToPageVisibleBounds:function(){var t,e=this.page.mag.getContainerSizeCached(),i=d.a.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.viewOpts)&&d.a.isCSSZoom()?d.a.getBox(this.$el[0],this.page.scale):this.$el[0].getBoundingClientRect(),n=this.page.mag.isPreview?this.page.mag.$mag_container[0].getBoundingClientRect():{top:0,left:0},o=(i.top+i.height/2-n.top)/this.page.scale,a=(e.height-(i.top+i.height/2-n.top))/this.page.scale,r=(i.left+i.width/2-n.left)/this.page.scale,s=(e.width-(i.left+i.width/2-n.left))/this.page.scale;if(this.fixed_position){var l=this.page.$el[0].getBoundingClientRect(),c=(i.top+i.height/2-l.top)/this.page.scale,h=(l.height-(i.top+i.height/2-l.top))/this.page.scale;t={left:Math.max(0,r),right:Math.max(0,s),top:Math.max(0,Math.min(o,c)),bottom:Math.max(0,Math.min(a,h))}}else{var u=this.page.contentPosition.left/this.page.scale,p=this.page.contentPosition.top/this.page.scale,m=this.x+this.w/2,g=this.y+this.h/2;c=g+p,h=this.page.contentHeight-g+p;t={left:Math.max(0,m+u),right:Math.max(0,this.page.pageWidth-m+u),top:Math.max(0,Math.min(o,c)),bottom:Math.max(0,Math.min(a,h))}}return t},checkLink:function(){var t={};if(this.clickLink){this.clickLink=this.page.mag.matchSameDomainLink(this.clickLink);var e=/^http(s?)\:\/\//i.test(this.clickLink)||/^mailto\:/i.test(this.clickLink)||/^tel\:/i.test(this.clickLink),i=/^__rm_goback$/i.test(this.clickLink),o=this.mailchimpMatcher.test(this.clickLink),a=this.anchorRegexp.test(this.clickLink),s=this.shareRegexp.test(this.clickLink),l=this.clickLink,c=this.clickTarget||"_blank",d=e?"external-link":i?"goback-link":"maglink";if(o&&(d="mailchimp-link"),a&&(d="anchor-link"),s&&(d="share-link"),!e){var h=l;/^back\sto\stop$/i.test(l)&&(h=this.page._id);var u=this.page.mag.getPageNum(h);l=u&&this.page.mag.getPageUri?"/"+this.page.mag.getPageUri(h):"javascript:void(0)";u?c="":l="",h==this.page._id&&(d+=" back-to-top",this.is_global&&(d+=" current"))}if(i&&(l="javascript:void(0)"),o){l="javascript:void(0)";var p=this.clickLink.match(this.mailchimpMatcher)[1];t["data-mailchimp"]=p}if(a){l="javascript:void(0)",t["data-anchor-link-pos"]=this.anchor_link_pos;var m=r.a.findWhere(this.mag.pages,{_id:this.clickPage})||this.page;t["data-page-uri"]=m.uri||m.num}if(s){l="javascript:void(0)";var g=this.clickLink.match(this.shareRegexp);t["data-share-provider"]=g[1],t["data-share-type"]=g[2]}if(0!=l.indexOf("mailto")&&0!=l.indexOf("tel")&&"maglink"!=d||(c=""),l){r.a.extend(t,{class:d,href:l,target:c});var f=this.$el.parent("a");f.length?f.attr(t):(f=Object(n.a)("<a>").attr(t),this.$el.wrap(f)),!e&&RM.screenshot&&(f=this.$el.parent("a")).removeAttr("href")}}},updateWidgetData:function(t,e,i){r.a.extend(this,t,t.params),this.page=e,this.mag=this.page.mag,this.$pageContainer=i||this.page.$content,this.x=this.x||0,this.y=this.y||0},getAnimations:function(){return h.a.normalizeAnimations(this.animation)},getAnimationTriggers:function(t){var e=this.getAnimations().find((function(e){return e.UUID===t}));return h.a.normalizeAnimationTriggers(e&&e.trigger)},isGlobal:function(){return!!this.model.get("is_global")},isAbove:function(){return!!this.model.get("is_above")}}),b=i("zzMN"),y=v.extend({render:function(){var t=this,e=!1;if(RM.screenshot)window.ServerData.userPermissions&&window.ServerData.userPermissions.can_use_e_commerce&&(e=!0);else{var i=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");i&&i.can_use_e_commerce&&(e=!0)}if(e)return this.makeBox("widget-add-to-cart"),this.seamlessFontsShow(function(){this.$el.removeClass("fonts-pending")}.bind(this),function(){this.$el.addClass("fonts-pending")}.bind(this)),this.addToCartWidget=new b.a({data:this,environment:"viewer",$container:this.$el,eCommerceManager:this.mag.eCommerceManager}),RM.screenshot?(this.addToCartWidget.on("loaded",(function(){t.widgetIsLoaded()})),setTimeout((function(){t.widgetIsLoaded()}),1e4)):this.widgetIsLoaded(),this.addToCartWidget.render(),this.rendered=!0,this},destroy:function(){return this.addToCartWidget&&this.addToCartWidget.destroy(),this.addToCartWidget=null,v.prototype.destroy.apply(this,arguments)}}),_=i("hdsW"),w=i("QNiq"),k=v.extend({render:function(){return this.makeBox("audio"),this.player=new _.a({params:this,$container:this.$el,readyCallback:this.widgetIsLoaded,viewport:this.page.pageViewport,viewportWidth:this.mag.getViewportWidth(this.page.pageViewport),viewerOptions:this.mag.viewOpts}),this.player.show(),this.rendered=!0,this},isValid:function(){return this.parsed_url},start:function(){return this.started=!0,!RM.screenshot&&!this.destroyed&&this.player&&this.autoplay&&this.rendered&&this.loaded&&w.a.isDesktop&&!p.default.PageVisibilityManager.isPageHidden()&&this.player.play(),this},stop:function(){return this.started=!1,!RM.screenshot&&!this.destroyed&&this.player&&this.rendered&&this.loaded&&this.player.pause(),this},destroy:function(){return this.player&&this.player.destroy(),this.player=null,v.prototype.destroy.apply(this,arguments)}}),S=i("WoDZ"),x=i("Zuws"),C=i.n(x),O=i("0zSa"),j=i("X7yJ"),P=i("PhV8"),E=i("Vxjr"),I=function(t,e){this.playerIsReady=!1,this.queue=[],function(t,e){var i=r.a.bind(t,e);if(window.youTubeApiIsReady)return i();window.ytQueue.push({cb:i,context:e})}((function(){this.yt=new window.YT.Player(t.id,{events:{onReady:r.a.bind((function(){this.destroyed||(this.playerIsReady=!0,r.a.each(this.queue,(function(t){r.a.isFunction(t.cb)&&t.cb()})))}),this)}})}),this),this.start_time=e&&e.start_time};I.prototype={addToQueue:function(t,e){var i=r.a.bind(t,e);if(this.playerIsReady)return i();this.queue.push({cb:i,context:e})},on:function(t,e,i){var n=r.a.bind(e,i||window),o={finish:0,play:1,pause:2};"ready"!==t?this.addToQueue((function(){this.yt.addEventListener("onStateChange",(function(e){o[t]===Number(e.data)&&n()}))}),this):this.addToQueue(n,this)},mute:function(){this.addToQueue((function(){this.yt.mute()}),this)},unMute:function(){this.addToQueue((function(){this.yt.unMute()}),this)},pause:function(){this.addToQueue((function(){this.yt&&this.yt.pauseVideo&&this.yt.pauseVideo()}),this)},play:function(){this.addToQueue((function(){this.yt.playVideo()}),this)},rewind:function(t){this.addToQueue((function(){this.yt.seekTo(t||0)}),this)},loop:function(){this.rewind(this.start_time||.01)},getDuration:function(){return this.duration||(this.duration=this.yt.getDuration()),this.duration},getCurrentTime:function(){return this.yt.getCurrentTime&&this.yt.getCurrentTime()||0},checkLoop:function(){if(this.getDuration()-this.yt.getCurrentTime()<.5)return this.loop(),!0},destroy:function(){window.ytQueue=r.a.reject(window.ytQueue,(function(t){return t.context===this})),delete this.yt,delete this.queue,this.destroyed=!0}};var T=function(t,e){r.a.bindAll(this),this.id=t.id,this.start_time=e&&e.start_time};T.prototype={on:function(t,e){Object(P.a)(this.id).addEvent(t,e)},mute:function(){Object(P.a)(this.id).api("setVolume",0)},unMute:function(){return!1},pause:function(){Object(P.a)(this.id).api("pause")},play:function(){Object(P.a)(this.id).api("play")},rewind:function(t){Object(P.a)(this.id).api("seekTo",t||0)},loop:function(){this.start_time&&this.rewind(this.start_time)},getCurrentTime:function(t){Object(P.a)(this.id).api("getCurrentTime",t)},setColor:function(t){Object(P.a)(this.id).api("setColor",t)},destroy:function(){var t=Object(P.a)(this.id);t&&(t.removeEvent("ready"),t.removeEvent("play"),t.removeEvent("finish"),t.removeEvent("pause"))}};var M={Vimeo:r.a.template('<iframe src="https://player.vimeo.com/video/<%=video_id%>?wmode=opaque&api=1&loop=<%=(loop)?1:0%>&muted=<%=(mute)?1:0%>&player_id=video_<%=id%><%=(!real)?"_c":""%>&title=<%=info?1:0%>&byline=<%=info?1:0%>&portrait=<%=info?1:0%>&color=<%=color%>" id="video_<%=id%><%=(!real)?"_c":""%>" width="<%=w%>" height="<%=h%>" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allow="autoplay; fullscreen; encrypted-media"></iframe>'),YouTube:r.a.template('<iframe <% if (real) {%>id="yt_<%=video_id%>"<%}%> src="https://www.youtube.com/embed/<%=video_id%>?&wmode=opaque&enablejsapi=1&playlist=&autohide=1&loop=<%=(loop)?1:0%>&showinfo=<%=info?1:0%>&theme=<%=theme%>&controls=<%=controls? 1: 0%><%=html5 ? "&html5=1" : ""%>&rel=0&vq=hd1080&playsinline=<%=(autoplay)?1:0%>" width="<%=w%>" height="<%=h%>" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen allow="autoplay; fullscreen; encrypted-media"></iframe>')},$=v.extend({RESTART_TIMEOUT:5e3,isPlaying:!1,initialize:function(t,e,i){return v.prototype.initialize.apply(this,arguments),this.$container=i,delete this.real,this},render:function(){return this.$container?this.setElement(this.$container):this.makeBox("video"),this.rendered=!0,this.setPosterInsteadOfVideo(),this},isValid:function(){return this.video_id&&this.provider_name},_needAutoStart:function(){return this.autoplay&&!p.default.PageVisibilityManager.isPageHidden()},start:function(){return this.started=!0,this.onPlayFired=!1,RM.screenshot||!this.rendered||this.destroyed||(this.playerInitialized||(this.$el.append(this.getEmbed()),this.$iframe=this.$el.find("iframe"),this.$iframe.attr("id","video_"+this.id),this.player=this.createPlayer(this.provider_name,this.$iframe,{start_time:this.start_time,autoplay:this._needAutoStart()}),this.player&&this.player.on("ready",this.onPlayerReady),this.playerInitialized=!0),this.player&&this._needAutoStart()&&this.player.play()),this},stop:function(){return this.started=!1,clearInterval(this.loopInterval),!RM.screenshot&&!this.destroyed&&this.player&&this.rendered&&("youtube"===this.provider_name.toLowerCase()?(this._needAutoStart()&&this.player.pause(),!this._needAutoStart()&&this.onPlayFired&&this.player.pause()):this.player.pause()),this},destroy:function(){return clearInterval(this.loopInterval),this.player&&this.player.destroy(),this.player=null,v.prototype.destroy.apply(this,arguments)},setPosterInsteadOfVideo:function(){if(this.custom_thumbnail||this.thumbnail_url){var t=this.getCustomThumbnail(this);this.custom_thumbnail&&t.url?this.setCustomPosterInsteadOfVideo():this.setEmbeddedPosterInsteadOfVideo()}else this.widgetIsLoaded()},setEmbeddedPosterInsteadOfVideo:function(){this.$poster&&this.$poster.remove(),this.$poster&&this.$poster.off(),this.$poster=Object(n.a)("<img/>").addClass("poster").css("opacity",0).appendTo(this.$el),this.$poster.on("load",r.a.bind((function(){this.$poster.css({width:"",height:""}).css("opacity",1);var t=this.$poster[0].width,e=this.$poster[0].height;this.aspect_poster||(this.aspect_poster=t/e),S.a.setVideoPosition({mag:this.page.mag,$container:this.$el,$media:this.$poster,provider:this.provider_name,aspect_poster:this.aspect_poster,aspect_real:this.aspect_real,controls_remove:!!this.$container}),setTimeout(this.widgetIsLoaded,100)}),this)).on("error",r.a.bind((function(){this.oldUrl=this.thumbnail_url,this.thumbnail_url=this.thumbnail_url.replace("https://","http://"),this.oldUrl!==this.thumbnail_url?this.setEmbeddedPosterInsteadOfVideo():this.widgetIsLoaded()}),this)).attr("src",this.thumbnail_url)},setCustomPosterInsteadOfVideo:function(){this.$poster&&this.$poster.remove(),this.$poster&&this.$poster.off(),this.$poster=this.getCustomVideoPoster(this),this.$poster.css({visibility:"hidden",cursor:"pointer"}),this.$poster.on("click",r.a.bind((function(){this.onPosterClicked()}),this)),this.$poster.appendTo(this.$el),setTimeout(this.widgetIsLoaded,100)},getCustomVideoPoster:function(t){var e=Object(E.findImagePath)("./common/video-player/play.svg"),i=Object(n.a)("<div/>").addClass("poster poster-custom"),o=this.getCustomThumbnail(t),a=o.unscaledOptimizedUrl||o.url;if(j.a.useLambdaUrl(o)||j.a.useLambdaUrlOldProjects(o,"video")){var r={width:t.w};o.originalW&&(r.originalW=o.originalW),o.originalH&&(r.originalH=o.originalH);var s=h.a.normalizeAnimations(t.animation).reduce((function(t,e){return Math.max(t,h.a.maxScaleAnimation(e))}),0);r.animationScale=s&&s/100,this.page?r.scale=d.a.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.page.scale:1:r.scale=RM.constructorRouter.zoom.getZoom(),a=j.a.getLambdaUrl(o,r)}i.css({width:t.w,height:t.h}),this.mag&&this.mag.opts&&this.mag.opts.lqip&&(this.$lqipImg=Object(n.a)("<div/>").addClass("lqip").css({"background-image":"url(".concat(j.a.getLqipUrl(o),")"),width:this.w,height:this.h}).appendTo(this.$el));var l=new Image;return l.onload=function(){var t=this;this.$poster&&this.$poster.css({"background-image":"url(".concat(e,"), url(").concat(a,")"),visibility:""}),this.$iframe&&this.$iframe.addClass("fade-out"),this.$lqipImg&&this.$lqipImg.css("opacity",0),setTimeout((function(){t.$lqipImg&&t.$lqipImg.remove()}),200)}.bind(this),l.src=a,i},getCustomThumbnail:function(t){var e=t.custom_thumbnail_url||"";return t.picture||{url:e,type:r.a.last(e.split("."))}},onPosterClicked:function(){this.player.play(),r.a.delay(r.a.bind((function(){this.$poster&&(this.$poster.off(),this.$poster.remove())}),this),200)},createPlayer:function(t,e,i){return"vimeo"===t.toLowerCase()?new T(e[0],i):"youtube"===t.toLowerCase()?new I(e[0],i):null},getEmbed:function(t){if(t=t||this,r.a.defaults(t,{real:!0,w:640,h:320,theme:"dark",color:"3ab9ff",info:!1,controls:!0,id:r.a.uniqueId("video_"),origin:encodeURIComponent(window.location.protocol+"//"+window.location.hostname)}),Modernizr.safari&&(t.html5=!0),!t.video_id)return null;var e=M[t.provider_name](t),i=this.getCustomThumbnail(t);if(!t.real&&t.custom_thumbnail&&i.url){var o=Object(n.a)(e).css("visibility","hidden");return this.getCustomVideoPoster(t).add(o)}return M[t.provider_name](t)},onPlayerReady:function(){if(!this.destroyed&&this.player){if(this.$container&&(this.mute=!0),this.mute?this.player.mute():this.player.unMute(),!this.$container){var t=this.getCustomThumbnail(this);this.custom_thumbnail&&t.url||(this.$iframe&&this.$iframe.addClass("fade-out"),r.a.delay(r.a.bind((function(){this.$poster&&this.$poster.css("opacity",0)}),this),125),r.a.delay(r.a.bind((function(){this.$poster&&(this.$poster.off(),this.$poster.remove())}),this),250))}this.player.on("pause",this.onPause),this.player.on("play",this.onPlay),this.player.on("finish",this.onFinish),this.start_time&&(this.player.rewind(this.start_time),this.player.pause()),w.a.isDesktop&&"vimeo"===this.provider_name.toLowerCase()&&this.player.on("playProgress",this.onProgress),this.started&&this._needAutoStart()&&this.player.play(),this.player.setColor&&this.player.setColor(this.color)}},onPlay:function(){this.isPlaying=!0,!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Play",this.title+" / "+this.url),this.$iframe&&!this.$iframe.hasClass("fade-out")&&(this.$iframe.addClass("fade-out"),this.trigger("playStarted")),clearInterval(this.loopInterval),this.loop&&this.player.checkLoop&&(this.loopInterval=setInterval(r.a.bind((function(){this.player.checkLoop()&&(clearInterval(this.loopInterval),Modernizr.safari&&r.a.delay(function(){this.onPlay()}.bind(this),200))}),this),100)),this.onPlayFired=!0},onPause:function(){if(this.isPlaying=!1,"Vimeo"===this.provider_name)this.player.getCurrentTime(r.a.bind((function(t){t=Math.round(t),!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Pause",this.title+" / "+this.url+" / "+t+" sec.",t)}),this));else if("YouTube"===this.provider_name){var t=Math.round(this.player.getCurrentTime());!this.$container&&RM.analytics&&RM.analytics.sendEvent("Video Pause",this.title+" / "+this.url+" / "+t+" sec.",t)}},onFinish:function(){this.isPlaying=!1},onProgress:function(t){this.onPlayFired||this.onPlay(),1===t.percent&&this.loop&&this.player.loop&&this.player.loop(),0===parseFloat(t.seconds)?this.restartTimeout||(this.restartTimeout=setTimeout(r.a.bind((function(){clearInterval(this.loopInterval),this.playerInitialized=!1,this.player&&this.player.destroy(),this.player=null,this.$iframe&&this.$iframe.remove(),!this.destroyed&&this.started&&this.start(),delete this.restartTimeout}),this),this.RESTART_TIMEOUT)):(clearTimeout(this.restartTimeout),delete this.restartTimeout)},updateVideoFrameSize:function(t,e){this.$iframe&&this.$iframe.attr("width",t).attr("height",e),this.$poster&&this.$poster.css({width:t,height:e})}});$.findPlayingVideo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.find((function(t){return"video"===t.type&&t.isPlaying}))};var A=$,R=v.extend({render:function(){return this.rendered=!0,this.page.on("resize",this.onResize,this),this.template=C.a["template-viewer-widget-background"],this.setElement(this.template({data:this})),this.$el.prependTo(this.page.$fixedBgContainer),this.$picture=this.$(".picture-background"),this.$video=this.$(".video-background"),this.$videoContainer=this.$(".video-container"),this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.picture&&"picture"===this.selectedType?this.renderPicture():r.a.isEmpty(this.video)||"video"!==this.selectedType?this.slideshow&&"slideshow"===this.selectedType?this.renderSlideshow():this.widgetIsLoaded():this.renderVideo(),this},start:function(){return this.started=!0,"video"===this.selectedType&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&(this.videoWidget.start(),this.onResize()),"slideshow"!==this.selectedType||RM.screenshot||!this.rendered||this.destroyed||!this.slideshowWidget||this.slideshowWidget.isAnimationRunning||this.slideshowWidget.startAnimationLoop(),this},stop:function(){return this.started=!1,"video"===this.selectedType&&!RM.screenshot&&this.rendered&&this.videoWidget&&!this.destroyed&&this.videoWidget.stop(),"slideshow"===this.selectedType&&!RM.screenshot&&this.rendered&&!this.destroyed&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),this},destroy:function(){return this.page.off("resize",this.onResize,this),"video"===this.selectedType&&(this.videoWidget&&this.videoWidget.destroy(),this.videoWidget=null),"slideshow"===this.selectedType&&(this.slideshowWidget&&this.slideshowWidget.destroy(),this.slideshowWidget=null),v.prototype.destroy.apply(this,arguments)},hasVideoBG:function(){return!(RM.screenshot||"video"!==this.selectedType||!this.video||!this.video.url)},onResize:function(){!this.destroyed&&this.$videoContainer&&this.video&&S.a.setVideoPosition({mag:this.page.mag,$container:this.$videoContainer,$media:this.$videoContainer.children(),provider:this.video.provider_name,aspect_poster:this.video.aspect_poster||this.videoWidget&&this.videoWidget.aspect_poster,aspect_real:this.video.aspect_real,controls_remove:!0})},renderPicture:function(){if(this.picture){var t=j.a.useLambdaUrl(this.picture)||j.a.useLambdaUrlOldProjects(this.picture,"background")?j.a.getLambdaUrl(this.picture):this.picture.finalUrl||this.picture.effectUrl||this.picture.unscaledOptimizedUrl||this.picture.url;Object(n.a)("<img/>").on("load",r.a.bind((function(){this.$picture.css({"background-image":"url("+t+")"}),RM.screenshot?setTimeout(this.widgetIsLoaded,200):this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded).attr("src",t)}else this.widgetIsLoaded()},renderSlideshow:function(){this.slideshowWidget=new O.a({data:this.slideshow,container:this.$slideshow,preloadContainer:this.$slideshowPreload,name:this.page.cid}),RM.screenshot?(this.slideshowWidget.render(),this.slideshowWidget.on("loaded",function(){this.widgetIsLoaded()}.bind(this))):(this.slideshowWidget.render(!this.page.isCurrent()),this.widgetIsLoaded())},renderVideo:function(){this.video.id=this.id,this.video.mute=this.mute,this.video.loop=this.loop,this.video.controls=!1,this.videoWidget=new A(this.video,this.page,this.$videoContainer),this.videoWidget.on("loaded",r.a.bind((function(){this.widgetIsLoaded(),this.onResize()}),this)),this.videoWidget.on("playStarted",r.a.bind((function(){this.trigger("videoBGStarted")}),this)),this.videoWidget.render()}}),D=i("lRGI");function B(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function L(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?B(Object(i),!0).forEach((function(e){z(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):B(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var F=v.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){var t;return this.preloadIconImage({default:!0}),this.makeBox("widget-button"),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.seamlessFontsShow(function(){this.$el.removeClass("fonts-pending")}.bind(this),function(){this.$el.addClass("fonts-pending")}.bind(this)),t={model:this,$container:this.$el,environment:"viewer",mag:this.page&&this.page.mag,block:null},this.buttonWidget=new D.a(t),this.preloadIconImage({hover:!0}),this.$el.on(w.a.isDesktop?"mouseenter":"touchstart",this.onButtonHover),this.$el.on(w.a.isDesktop?"mouseleave":"touchend",this.onButtonHoverOut),this.$el.on("click",this.onButtonClick),this.checkLink(),RM.screenshot?(this.waitForIconImageLoad(),this.waitForUsedFontsLoad()):this.widgetIsLoaded(),this},renderButtonText:function(t){this.buttonWidget.renderButtonText(t)},renderButtonTextWithSizes:function(t,e){this.buttonWidget.renderButtonTextWithSizes(t,L(L({},this),e))},hasFontsToLoad:function(){return"text"===this.tp||"text_and_icon"===this.tp},onButtonHover:function(){this.$(".common-button").addClass("hovered")},onButtonHoverOut:function(){this.$(".common-button").removeClass("hovered")},onButtonClick:function(t){if(2!==t.which&&!t.metaKey&&!t.ctrlKey){var e=this.$el.closest("a"),i=n.a.trim(e.attr("href")).match(/\/start-with-template\/(\d+)$/i),o=i&&i[1];o&&RM.viewerRouter&&RM.viewerRouter.createMagFromTemplate&&(t.preventDefault(),RM.viewerRouter.createMagFromTemplate("template-link",o));var a=this.text?this.text:"icon"===this.tp?"icon":"empty";RM.analytics&&RM.analytics.sendEvent("Button Click",a)}},preloadIconImage:function(t){t=t||{};var e=this.tp;if("icon"===e||"text_and_icon"===e){if(t.default)(new Image).src=Modernizr.retina&&this.icon_raster2xUrl||this.icon_rasterUrl;if(t.hover)(new Image).src=Modernizr.retina&&this["hover-icon_raster2xUrl"]||this["hover-icon_rasterUrl"]}},_widgetIsLoaded:function(){this.loaded||this.destroyed||(RM.screenshot?this.iconImageLoaded&&this.fontLoaded&&this.widgetIsLoaded():this.widgetIsLoaded())},waitForIconImageLoad:function(){this.iconImageLoaded=!1,"icon"!==this.tp&&"text_and_icon"!==this.tp||!this.icon_rasterUrl?this.onIconImageLoaded():Object(n.a)("<img>").on("load",this.onIconImageLoaded).on("error",this.onIconImageLoaded).attr("src",Modernizr.retina?this.icon_raster2xUrl||this.icon_rasterUrl||"":this.icon_rasterUrl||"")},onIconImageLoaded:function(){this.iconImageLoaded=!0,this._widgetIsLoaded()},waitForUsedFontsLoad:function(){this.fontLoaded=!1,this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.onFontLoaded):this.onFontLoaded()},onFontLoaded:function(){this.fontLoaded=!0,this._widgetIsLoaded()},destroy:function(){return this.buttonWidget&&this.buttonWidget.destroy(),this.buttonWidget=null,this.$el.off(w.a.isDesktop?"mouseenter":"touchstart",this.onButtonHover),this.$el.off(w.a.isDesktop?"mouseleave":"touchend",this.onButtonHoverOut),this.$el.off("click",this.onButtonClick),v.prototype.destroy.apply(this,arguments)}}),U=i("A0Lk"),N=i.n(U),H=i("f3SV"),V=F.extend({initialize:function(){F.prototype.initialize.apply(this,arguments),this.is_above&&this.mag.on("destroyed",this.destroy)},render:function(){var t=this,e=!1;if(RM.screenshot)window.ServerData.userPermissions&&window.ServerData.userPermissions.can_use_e_commerce&&(e=!0);else{var i=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");i&&i.can_use_e_commerce&&(e=!0)}if(e){if(F.prototype.render.apply(this,arguments),!RM.screenshot){this.mag.eCommerceManager.events.on("ecommerce:cartdata:changed",this.renderTotalItems);var n=this["font-family"];if(n&&!H.a.systemFontsList.includes(n.toLowerCase())){var o=new N.a(this["font-family"]);o.load().then((function(){t.renderTotalItems(t.mag.eCommerceManager.getCartData())})).catch((function(){t.renderTotalItems(t.mag.eCommerceManager.getCartData())}))}else this.renderTotalItems(this.mag.eCommerceManager.getCartData())}return this}},renderTotalItems:function(t){if(t&&(t.skus||t.prices)){var e=0;for(var i in t.skus)t.skus.hasOwnProperty(i)&&(e+=t.skus[i].cart_count);for(var n in t.prices)t.prices.hasOwnProperty(n)&&(e+=t.prices[n].cart_count);var o=e?"".concat(this.text||""," ").concat(e):this.text||"",a=this.recalcTextInputSize(o);this.renderButtonTextWithSizes(o,a)}},onButtonClick:function(){this.mag.eCommerceManager.changeCartSidebarVisibility()},recalcTextInputSize:function(t){var e,i,o,a,r=this["font-size"],s=this["letter-spacing"],l=this["font-family"],c=this["font-style"],d=this["font-weight"];return this.$textInputSizeAdjuster||(this.$textInputSizeAdjuster=Object(n.a)("<div/>"),this.$textInputSizeAdjuster.css({position:"absolute",left:"-9999px",top:"-9999px","white-space":"pre",width:"auto"}),Object(n.a)(document.getElementById("tmp")).append(this.$textInputSizeAdjuster)),this.$textInputSizeAdjuster.addClass("for-text-size-calc").addClass(p.default.generateUUID()),this.$textInputSizeAdjuster.text(t.trim()),this.$textInputSizeAdjuster.css({"font-family":l,"font-style":c,"font-weight":d,"font-size":r+"px","letter-spacing":s+"px"}),e=this.$textInputSizeAdjuster.width(),i=this.$textInputSizeAdjuster.height(),this.$textInputSizeAdjuster.css("letter-spacing",0).text("M"),o=this.$textInputSizeAdjuster.width(),o=2*Math.ceil(o/2),a=this.$textInputSizeAdjuster.height(),0===t.length&&(e=o,i=a),e=2*Math.ceil(e/2),{text_w:e+=o,text_h:i=2*Math.ceil(i/2)}},destroy:function(){return this.mag.eCommerceManager.events.off("ecommerce:cartdata:changed",this.renderTotalItems),this.$textInputSizeAdjuster&&(this.$textInputSizeAdjuster.remove(),this.$textInputSizeAdjuster=null),F.prototype.destroy.apply(this,arguments)}}),W=i("3eHG"),G=i("wxrA"),q=i.n(G),K=v.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,initialize:function(){return v.prototype.initialize.apply(this,arguments),"type_like_box"===this.current_type&&(this.current_type="type_page",this.type_page=this.type_like_box),this},render:function(){return this.makeBox("widget-facebook"),this.rendered=!0,this.started?this.start():!RM.screenshot&&this.widgetIsLoaded(),this},start:function(){if(this.started=!0,this.destroyed||!this.rendered||this.innerRendered)return this;this.innerRendered=!0;var t,e,i=this;return this.current_type?((e=this[this.current_type]).w=this.w,e.h=this.h,"mag"===e.use_own_url?e.url=this.page.mag.getUrl():"page"!==e.use_own_url&&e.url||(e.url=this.page.getUrl()),t=q.a["template-constructor-block-facebook-"+this.current_type],this.$el.html(t({data:e})).removeClass(["type_like_button","type_page","type_comments"].join(" ")).addClass(this.current_type),"type_comments"===this.current_type?this.$el.css({"overflow-x":"hidden","overflow-y":"auto"}):"type_like_button"!==this.current_type&&this.$el.css({overflow:"hidden"}),W.a.initFacebookAPI((function(){!i.destroyed&&i.innerRendered&&window.FB.XFBML.parse(i.$el.get(0),(function(){r.a.delay((function(){!i.destroyed&&i.innerRendered&&(i.widgetIsLoaded(),"type_like_button"===i.current_type&&(i.iframe_w=i.$("iframe").width(),i.iframe_h=i.$("iframe").height()))}),500)}))})),this):(this.widgetIsLoaded(),this)},stop:function(){return this.started=!1,this}}),Y=i("gm8A");function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return J(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return J(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==i.return||i.return()}finally{if(s)throw a}}}}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Q=v.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,NUMBER_TEST_REGEX:/^[0-9.,`']+$/,events:{"focus :input":"onFocus","blur :input":"onBlur"},render:function(){var t;(this.makeBox("widget-form"),this.rendered=!0,this.captcha&&!window.recaptchaReadyPromise)&&(window.recaptchaReadyPromise=new Promise((function(e){t=e})),window.onloadRecaptchaCallback=function(){t()},Object(n.a)('<script src="https://www.google.com/recaptcha/api.js?onload=onloadRecaptchaCallback&render=explicit" async><\/script>').appendTo("head"));return this.seamlessFontsShow(function(){this.$el.removeClass("fonts-pending")}.bind(this),function(){this.$el.addClass("fonts-pending")}.bind(this)),this.formWidget=new Y.a({data:this,environment:"viewer",$container:this.$el}),this.formWidget.render(),this.$button=this.$(".button"),this.$button.on("click",this.onButtonClick),this.$(".js-input").on("keydown",this.onInputKeyDown),this.$(".js-input").on("input",this.onInput),this.$("select").on("change",this.onInput),RM.screenshot?this.waitForUsedFontsLoad():this.widgetIsLoaded(),this},hasFontsToLoad:function(){return!0},destroy:function(){return this.formWidget&&this.formWidget.destroy(),this.formWidget=null,this.$(".button").off("click",this.onButtonClick),v.prototype.destroy.apply(this,arguments)},waitForUsedFontsLoad:function(){this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.widgetIsLoaded):this.widgetIsLoaded()},onFocus:function(){Backbone.trigger("form:focus",this._id)},onBlur:function(){Backbone.trigger("form:blur",this._id)},onButtonClick:function(){var t=this;this.$button.hasClass("submitted")||(this.setButtonState("pending"),this.formWidget.executeCaptcha((function(){t.sendForm()})))},sendForm:function(){this.validateForm()?("Text after submit"===this.button_caption_after_submit||!this.button_caption_after_submit||this.submit_mode&&"textAfterSubmit"!==this.submit_mode?this.$button.addClass("empty-submitted-text"):this.$button.find(".caption").text(this.button_caption_after_submit),RM.common.isDownloadedSource&&!RM.common.homepageRewrite?this.submitToIframe(function(t){t?(this.setButtonState("error"),RM.analytics&&RM.analytics.sendEvent("Form Submit Error",t)):this.setButtonState("submitted")}.bind(this)):this.submitForm(function(t){t?(this.setButtonState("error"),t.responseJSON&&"email_not_confirmed"===t.responseJSON.name&&r.a.delay((function(){alert(t.responseJSON.message)}),100),RM.analytics&&RM.analytics.sendEvent("Form Submit Error",t)):this.setButtonState("submitted")}.bind(this)),this.link_after_submit&&this.submit_mode&&"textAfterSubmit"!==this.submit_mode&&this.applyLink()):this.setButtonState()},applyLink:function(){var t;"toUrlAfterSubmit"===this.submit_mode?this.openInNewTab(this.link_after_submit):(t=this.page.mag.getPageUri?"/"+this.page.mag.getPageUri(this.link_after_submit):"javascript:void(0)",this.mag.router.navigate(t,{trigger:!0}))},openInNewTab:function(t){Object.assign(document.createElement("a"),{target:"_blank",rel:"noopener",href:t}).click()},getDataBySort:function(t){return t=parseInt(t,10),r.a.findWhere(this.fields,{sort:t})},validateForm:function(){var t=this.$(".js-input"),e=!0;return!(this.captcha&&!this.formWidget.captchaResponse)&&(r.a.each(t,function(t){var i=Object(n.a)(t),o=i.val().trim(),a=this.getDataBySort(i.attr("data-sort")),r=!0;if(o)switch(a.tp){case"name":case"text":case"dropdown":break;case"email":p.default.isValidEmail(o)||(r=!1);break;case"phone":/^[0123456789 +-]+$/.test(o)||(r=!1);break;case"number":this.NUMBER_TEST_REGEX.test(o)&&!isNaN(parseFloat(o))||(r=!1);break;case"checkbox":a.optional||i.prop("checked")||(r=!1);break;case"captcha":this.formWidget.captchaResponse||(r=!1)}else r=a.optional;r||(this.formWidget.applyInputsStyle(i.closest(".input-wrapper"),{invalid:!0}),e=!1)}.bind(this)),e)},onInput:function(t){var e=Object(n.a)(t.currentTarget).parent().find(".js-input");this.formWidget.applyInputsStyle(e.closest(".input-wrapper")),this.setButtonState()},onInputKeyDown:function(t){t.keyCode!==n.a.keycodes.enter||Object(n.a)(t.target).is("textarea")||(t.preventDefault(),this.onButtonClick()),!Object(n.a)(t.target).is("textarea")||t.keyCode!==n.a.keycodes.up&&t.keyCode!==n.a.keycodes.down||t.stopPropagation()},getFormData:function(){var t={wid:this._id,mag_num_id:this.page.mag.num_id,is_preview:!(!RM.constructorRouter||!RM.constructorRouter.preview),fields:[]};return this.captcha&&(t.captcha=this.formWidget.captchaResponse),r.a.each(this.fields,function(e){if("captcha"!==e.tp){var i=this.$(".js-input[data-sort="+e.sort+"]");if(0!==i.length){var n=i.val().trim();if("checkbox"===e.tp&&(n=i.prop("checked")?"On":"Off"),"number"===e.tp){var o=parseFloat(n);n=isNaN(o)?n:o}"file"!==e.tp&&t.fields.push({caption:e.caption,type:e.tp,value:n})}}else t.captcha=this.formWidget.captchaResponse}.bind(this)),t},submitForm:function(t){this.xhr&&this.xhr.abort();var e=this.$el.find("form");e.length||(e=this.$el.find(".form-wrapper").wrap('<form enctype="multipart/form-data" method="post" target="form_submit_iframe"></form>').parent().attr("action","/api/connect/forms/send/"+this.page.mag.num_id));var i=new FormData(e.get(0)),o=this.getFormData();if(o&&o.fields){var a,r=Z(o.fields);try{for(r.s();!(a=r.n()).done;){var s=a.value;i.delete(s.name)}}catch(t){r.e(t)}finally{r.f()}}for(var l=0,c=Object.keys(o);l<c.length;l++){var d=c[l];i.append(d,"object"===X(o[d])&&null!==o[d]?JSON.stringify(o[d]):o[d])}var h=i.get("formfiles");!h||h.size&&h.name||i.delete("formfiles"),this.xhr=n.a.ajax({url:"/api/connect/forms/send/"+this.page.mag.num_id,method:"POST",dataType:"json",data:i,cache:!1,contentType:!1,processData:!1,success:function(){t()},error:function(e){t({status:e.status,responseJSON:e.responseJSON,responseText:e.responseText})}}),RM.analytics&&RM.analytics.sendEvent("Form Submit Click")},submitToIframe:function(t){var e,i=this.endpoint_url&&this.endpoint_url.custom_url;if(!i)return t("No custom URL specified for submit");Object(n.a)("#form_submit_iframe").length||Object(n.a)('<iframe id="form_submit_iframe" name="form_submit_iframe" style="display:none;"></iframe>').appendTo("body"),(e=this.$el.find("form")).length||(e=this.$el.find(".form-wrapper").wrap('<form method="post" target="form_submit_iframe" enctype="multipart/form-data"></form>')),e.attr("action",i),e.get(0).submit(),t(null),RM.analytics&&RM.analytics.sendEvent("Form Submit Click")},setButtonState:function(t){t=t||"";this.$button.removeClass(["error","submitted","pending"].join(" ")).addClass(t)}}),tt=i("udqo");function et(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function it(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var nt=v.extend({antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){this.makeBox("widget-picture"),this.canShowPreview()&&this.initPreview(),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.$lqipImg=null,this.useLqip=this.mag&&this.mag.opts&&this.mag.opts.lqip&&(j.a.useLambdaUrl(this.picture)||j.a.useLambdaUrlOldProjects(this.picture));var t=this.getPictureUrl();if(/\.gif/.test(t)&&(this.isGIF=!0),this.$el.html(""),this.isVector(t)&&!H.a.IS_FILE_PROTOCOL)this.loadVector(t);else{var e=!!(this.border_size>0||this.border_radius>0||this.border_radius_max||this.border_radius_independent&&(this.border_radius_tl>0||this.border_radius_tr>0||this.border_radius_bl>0||this.border_radius_br>0)||this.is_full_width||this.is_full_height),i=void 0===this.opacity?1:this.opacity;if(this.insideHotspot&&this.isGIF){var o=this.scale;Object(n.a)("<div/>").appendTo(this.$el).css({position:"absolute","background-image":"url("+t+")","background-position":"50% 50%",width:Math.max(Math.round(this.originalW*o),this.w),height:Math.max(Math.round(this.originalH*o),this.h),top:-Math.round(this.cropY*o),left:-Math.round(this.cropX*o)}).attr("url",t)}else e&&Object(n.a)("<div/>").appendTo(this.$el).addClass("bgpic").css({"background-image":this.useLqip?"":"url(".concat(t,")"),"background-position":(this.fhpos?this.fhpos:50)+"% "+(this.fwpos?this.fwpos:50)+"%","box-shadow":this.border_size>0?"inset 0 0 0 "+this.border_size+"px #"+(this.border_color||"000000"):"none","border-radius":this.getBorderRadius(),opacity:this.useLqip?0:i}).attr("url",this.useLqip?"":t);if(j.a.useLambdaUrl(this.picture)||j.a.useLambdaUrlOldProjects(this.picture)){var a=j.a.getSrcset(this.picture,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?et(Object(i),!0).forEach((function(e){it(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):et(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},this.getPictureOptions()));Object(n.a)("<img/>").attr("srcset",a).attr("alt",this.getAltText()).attr("src",t).addClass("viewable").toggleClass("saveable",!!(e||this.insideHotspot&&this.isGIF)).css("opacity",0).load(r.a.bind((function(){var e=this.$el.find(".viewable"),n=e&&e.get(0)&&e.get(0).currentSrc||t,o=this.$el.find(".bgpic");o&&o.css({opacity:i,"background-image":"url(".concat(n,")")}).attr("url",n),e&&e.css("opacity",i),this.$lqipImg&&this.$lqipImg.css("opacity",0),r.a.delay(r.a.bind((function(){this.$el.css({overflow:"","border-radius":""}),this.$lqipImg&&this.$lqipImg.remove(),this.$lqipImg=null,this.widgetIsLoaded()}),this),200)}),this)).on("error",r.a.bind((function(){this.$lqipImg&&this.$lqipImg.remove(),this.$lqipImg=null,this.widgetIsLoaded()}),this)).appendTo(this.$el),this.useLqip&&(this.$el.css("overflow","hidden"),(this.border_radius||this.border_radius_max||this.border_radius_independent)&&this.$el.css("border-radius",this.getBorderRadius()),this.$lqipImg=Object(n.a)("<div/>").addClass("lqip").css({"background-image":"url(".concat(j.a.getLqipUrl(this.picture,{cropX:this.cropX,cropY:this.cropY,cropW:this.cropW,cropH:this.cropH,originalW:this.originalW,originalH:this.originalH}),")"),"background-position":"50% 50%",opacity:i}).appendTo(this.$el))}else Object(n.a)("<img/>").appendTo(this.$el).toggleClass("saveable",!!(e||this.insideHotspot&&this.isGIF)).css("opacity",void 0===this.opacity?1:this.opacity).addClass("viewable").load(r.a.bind((function(){this.$el.find("img").attr("url",t),this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded).attr("srcset",this.getSrcset()).attr("alt",this.getAltText()).attr("src",t)}return this.checkLink(),this},getBorderRadius:function(){return this.border_radius_independent?"".concat(this.border_radius_tl||0,"px ").concat(this.border_radius_tr||0,"px ").concat(this.border_radius_bl||0,"px ").concat(this.border_radius_br||0,"px"):"".concat(this.border_radius_max?"9999":this.border_radius||0,"px")},canShowPreview:function(){var t=Boolean(this.getAnimations().find((function(t){return"click"===t.type&&t.steps&&t.steps.length}))),e=!!this.clickLink;return this.preview_enabled&&!t&&!e},isValid:function(){return Boolean(this.picture&&(this.picture.type||this.picture.unscaledUrl||this.picture.finalUrl||this.picture.editedVectorUrl||this.picture.url))},isVector:function(t,e){var i=t||this.picture&&this.picture.url;return"svg"===(e||this.picture&&this.picture.type)||i&&0===r.a.last(i.split(".")).indexOf("svg")},start:function(){return this.started=!0,Modernizr.safari&&this.isGIF&&this.$el.flashClass("fix-safari-gif",100),this},getPictureOptions:function(){var t=this.getAnimations().reduce((function(t,e){return Math.max(t,h.a.maxScaleAnimation(e))}),0);return{width:this.w,height:this.h,cropX:this.cropX,cropY:this.cropY,cropW:this.cropW,cropH:this.cropH,originalW:this.originalW,originalH:this.originalH,scale:d.a.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.page.scale:1,animationScale:t&&t/100,isStretched:this.is_full_width||this.is_full_height}},getPictureUrl:function(){return this.picture?j.a.useLambdaUrl(this.picture)||j.a.useLambdaUrlOldProjects(this.picture)?j.a.getLambdaUrl(this.picture,this.getPictureOptions()):this.picture.finalUrl&&0===r.a.last(this.picture.finalUrl.split(".")).indexOf("svg")?this.picture.finalUrl:(t=d.a.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final2xUrl||this.picture.finalUrl:Modernizr.retina&&(window.devicePixelRatio>=3&&(this.picture.final3xUrl||this.picture.unscaledOptimizedUrl)||this.picture.final2xUrl||this.picture.unscaledOptimizedUrl)||this.picture.finalUrl,(this.is_full_width||this.is_full_height)&&(t=this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final2xUrl||this.picture.finalUrl),t||this.picture.effectUrl||this.picture.editedVectorUrl||this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.url):"";var t},getAltText:function(){return this.picture&&this.alt?r.a.escape(this.alt):void 0},getSrcset:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.picture)return[];if(!this.originalW)return[];if(this.isGIF)return[];if(d.a.isOn(this.page.pageViewport,this.mag.getViewportWidth(this.page.pageViewport),this.mag.viewOpts))return[];if(this.getAnimations().length)return[];if(RM.screenshot)return[];if(this.picture.finalUrl&&0===r.a.last(this.picture.finalUrl.split(".")).indexOf("svg"))return[];var e=Math.floor(this.w),i=[{url:this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl,size:this.originalW},{url:this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl),size:3*e},{url:this.picture.final2xUrl,size:2*e},{url:this.picture.finalUrl,size:e}];if(i=i.filter(function(t){return!!t.url&&this.originalW>=t.size}.bind(this)).map((function(t){return"".concat(t.url," ").concat(t.size,"w")})),!t)return i;var n=["".concat(this.picture.finalUrl||this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl," 1x")];return this.picture.final2xUrl&&n.push("".concat(this.picture.final2xUrl," 2x")),this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl)&&n.push("".concat(this.picture.final2xUrl&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl)," 3x")),n.concat(i)},cleanupSVG:function(t){var e=Object(n.a)(Object(n.a)(t).find("svg").get(0).cloneNode(!0)),i=e[0].outerHTML;return r.a.chain(e.find("[id]")).map((function(t){return{id:t.getAttribute("id"),newId:p.default.generateUUID()}})).sortBy((function(t){return-t.id.length})).each((function(t){i=(i=i.split("#"+t.id).join("#"+t.newId)).split('id="'+t.id+'"').join('id="'+t.newId+'"')})),i},loadVector:function(t){this.$el.addClass("svg"),this.svgAjax=n.a.get(t+"?c",r.a.bind((function(e){(e=Object(n.a)(this.cleanupSVG(e))).get(0).removeAttribute("width"),e.get(0).removeAttribute("height"),this.$svg=e;var i=e.get(0).cloneNode(!0);this.$svg.find("title").remove();var o=new Image;Object(n.a)(o).on("load error",r.a.bind((function(){Object(n.a)(o).appendTo(window.document.body).css({width:"100%",height:"100%"});var t=Object(n.a)(i);t.get(0).setAttribute("viewBox","0 0 "+Object(n.a)(o).width()+" "+Object(n.a)(o).height()),t.appendTo(window.document.body);var e=t.get(0).getBBox();this.$svg.get(0).setAttribute("viewBox",e.x+" "+e.y+" "+e.width+" "+e.height),this.$svg.get(0).setAttribute("preserveAspectRatio","xMidYMid meet"),Object(n.a)(o).remove(),t.remove();var a=Object(n.a)('<div class="svg-scale-wrapper"></div>');this.$svg.appendTo(a),a.appendTo(this.$el),this.widgetIsLoaded()}),this)),o.src=t}),this)).fail(this.widgetIsLoaded)},initPreview:function(){this.preview=new tt.a({$container:Object(n.a)("body"),$el:this.$el,picture:this.picture,overlayColor:this.preview_overlay_color,originalW:this.originalW,width:this.w,viewportWidth:this.mag.getViewportWidth(this.page.pageViewport),viewport:this.page.pageViewport,viewerOptions:this.mag.viewOpts}),this.$el.addClass("preview-enabled"),this.$el.on("click",function(){this.preview.render(),this.preview.bindClick()}.bind(this))}}),ot=v.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,render:function(){this.makeBox("widget-gmaps"),this.$el.html(Object(n.a)('<div class="map-container"></div>')),this.rendered=!0;var t=this.api_key;return this.mag&&this.mag.opts&&this.mag.opts.gmaps_key&&this.mag.opts.gmaps_key!==this.api_key&&(t=this.mag.opts.gmaps_key),W.a.initGMapsAPI(t,function(){this.destroyed||r.a.defer(function(){this.destroyed||(d.a.isOn(this.page.pageViewport,this.mag.getViewportWidth(this.page.pageViewport),this.mag.opts)&&this.scale(),this.map=new google.maps.Map(this.$(".map-container").get(0),{zoom:this.map_zoom,center:new google.maps.LatLng(this.center_lat,this.center_lng),mapTypeId:this.map_type_id||google.maps.MapTypeId.ROADMAP,disableDefaultUI:!this.show_controls,streetViewControl:!1,scrollwheel:void 0===this.scrollwheel||!!this.scrollwheel}),this.marker_lat&&this.marker_lng&&"directions"!==this.current_type&&(this.marker=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(this.marker_lat,this.marker_lng)}),google.maps.event.addListener(this.marker,"click",function(){this.infowindow&&this.infowindow.open(this.map,this.marker)}.bind(this)),this.infowindow=new google.maps.InfoWindow({maxWidth:this.w-100}),this.formatted_address?this.infowindow.setContent(this.formatted_address):(new google.maps.Geocoder).geocode({latLng:new google.maps.LatLng(this.marker_lat,this.marker_lng)},function(t,e){e===google.maps.GeocoderStatus.OK&&t[0]&&this.infowindow.setContent(t[0].formatted_address)}.bind(this))),"directions"===this.current_type&&this.direction_start_lat&&this.direction_start_lng&&this.direction_end_lat&&this.direction_end_lng&&this.direction_route_type?(this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer({preserveViewport:!0}),this.directionsService.route({origin:new google.maps.LatLng(this.direction_start_lat,this.direction_start_lng),destination:new google.maps.LatLng(this.direction_end_lat,this.direction_end_lng),travelMode:google.maps.TravelMode[this.direction_route_type.toUpperCase()]},function(t,e){e===google.maps.DirectionsStatus.OK&&(this.directionsDisplay.setDirections(t),this.directionsDisplay.setMap(this.map),google.maps.event.addListener(this.map,"tilesloaded",function(){this.widgetIsLoaded()}.bind(this)))}.bind(this))):google.maps.event.addListener(this.map,"tilesloaded",function(){this.widgetIsLoaded()}.bind(this)),"custom"===this.current_type&&this.custom_json&&this.map.setOptions({styles:JSON.parse(this.custom_json)}))}.bind(this))}.bind(this)),this},scale:function(){var t=this.mag.getScale(this.page.pageViewport),e=this.$(".map-container");if(d.a.isCSSZoom())e.css("zoom",1/t);else if(d.a.isCSSTransform()){var i=100*t,n=(i-100)/2;e.css({transform:"scale("+1/t+") translate(-"+n+"%, -"+n+"%)",width:i+"%",height:i+"%"})}},start:function(){return this.started=!0,this.rendered&&!this.destroyed&&this.map?(google.maps.event.trigger(this.map,"resize"),this.map.setCenter(new google.maps.LatLng(this.center_lat,this.center_lng)),this):this},destroy:function(){return this.map&&google.maps.event.clearListeners(this.map,"tilesloaded"),this.marker&&google.maps.event.clearListeners(this.marker,"click"),v.prototype.destroy.apply(this,arguments)}}),at=i("gHxz"),rt=i.n(at),st=i("z79a"),lt=i("cBBe"),ct=i("D12m"),dt=i("YNoo"),ht=i.n(dt),ut=i("RX7I"),pt=v.extend({DO_NOT_WAIT_FOR_PRELOAD:!0,antialiasRotation:!0,mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){Object(g.a)("viewer.textOverflow")?this.makeBox("text text-overflow-disabled"):this.makeBox("text"),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.bg_color=null==this.bg_color?"ffffff":this.bg_color,this.bg_opacity=null==this.bg_opacity?0:this.bg_opacity,this.column_count=null==this.column_count?1:this.column_count,this.column_gap=null==this.column_gap?16:this.column_gap;var t=[parseInt(this.bg_color.substring(0,2),16),parseInt(this.bg_color.substring(2,4),16),parseInt(this.bg_color.substring(4,6),16)];this.bg_opacity>.99?this.bg="rgb("+t[0]+","+t[1]+","+t[2]+")":this.bg="rgba("+t[0]+","+t[1]+","+t[2]+", "+this.bg_opacity+")",this.text=this.switchTextToViewport(this.text,this.insideHotspot?"default":this.page.pageViewport);var e=this.mag.model.attributes&&this.mag.model.attributes.edit_params&&this.mag.model.attributes.edit_params.paragraph_styles||[],i=n.a.parseHTML(this.text);i=i.map((function(t){var i=Object(n.a)(t),o=i.attr("class");if(o){var a=e.find((function(t){return t._name.toLowerCase()===o.toLowerCase()}));if(a&&a.tag&&"p"!==a.tag&&H.a.AVAILABLE_TEXT_TAGS.includes(a.tag))return Object(n.a)("<"+a.tag+' class="'+o+'" style="'+(i.attr("style")||"")+'" />').append(i.contents())[0].outerHTML}return t.outerHTML})).filter((function(t){return t})),this.text=i.join(""),this.isNotChrome=!(Modernizr.webkit&&!Modernizr.safari&&!Modernizr.safari5)&&this.text.includes("justify");var o=ht.a["template-viewer-widget-text"],a=Object(n.a)(o(this));this.seamlessFontsShow(function(){this.$el.removeClass("fonts-pending")}.bind(this),function(){this.$el.addClass("fonts-pending")}.bind(this)),d.a.isOn(this.mag.getViewportWidth(this.page.pageViewport))&&d.a.isCSSZoom()&&this.transformInsteadOfZoom(a),this.$el.append(a),this.$content=a,this.$el.on(w.a.isDesktop?"mouseenter":"touchstart","a",this.onLinkMouseEnter),this.$el.on(w.a.isDesktop?"mouseleave":"touchend","a",this.onLinkMouseLeave),this.$el.on("click","a",this.onLinkClick),a.addClass("v"+(this.version||1));var s=this;return this.$el.find("a").each((function(){var t=Object(n.a)(this),e=t.attr("data-pid"),i=t.attr("href"),o=decodeURIComponent(i),a=/^back\sto\stop$/i,l=e,c=!1;(a.test(i)||a.test(o))&&(l=s.page._id);var d=i&&s.page.mag.matchSameDomainLink(i);if((d==t.attr("href")||l)&&(d=void 0),l=l||d){var h=s.page.mag.getPageNum(l),u=h&&s.page.mag.getPageUri?"/".concat(s.page.mag.getPageUri(l)):"javascript:void(0)";if(h){t.addClass("maglink").attr("target","");var p=document.querySelector("base");if(RM.common.isDownloadedSource&&p){var m=p.getAttribute("href");"/"!==m&&t.attr("href","".concat(m).concat(u.substring(1))).data("link",u)}else t.attr("href",u)}else t.removeAttr("href");l==s.page._id&&(t.addClass("back-to-top"),e&&(s.is_global||s.hasGlobalParent)&&t.addClass("current"))}else if(/^__rm_goback$/i.test(t.attr("href")))t.attr("href","javascript:void(0)").addClass("goback-link");else if(s.mailchimpMatcher.test(t.attr("href"))){var g=t.attr("href").match(s.mailchimpMatcher)[1];t.attr("href","javascript:void(0)").attr("data-mailchimp",g).addClass("mailchimp-link"),W.a.initMailchimpAPI()}else if(s.shareRegexp.test(t.attr("href"))){var f=t.attr("href").match(s.shareRegexp);t.attr("href","javascript:void(0)").attr("data-share-provider",f[1]).attr("data-share-type",f[2]).addClass("share-link")}else if(s.anchorRegexp.test(t.attr("href"))){t.attr("href","javascript:void(0)").addClass("anchor-link");var v=t.attr("data-page-uri"),b=r.a.findWhere(s.mag.pages,{_id:v})||s.page;t.attr("data-page-uri",b.uri||b.num)}else c=!0,t.addClass("external-link");!t.attr("href")||0!=t.attr("href").indexOf("mailto")&&0!=t.attr("href").indexOf("tel")||t.attr("target",""),!c&&RM.screenshot&&t.removeAttr("href")})),RM.screenshot&&!this.insideHotspot?this.waitForUsedFontsLoad():this.widgetIsLoaded(),this.$el.find("span.soundcite").each((function(t,e){RM.screenshot||ut.a.createPlayer(e)})),d.a.isDesktopDefault(this.mag.viewport)&&d.a.isScaleLayout(this.mag.viewOpts)&&d.a.isCSSZoom()&&this.listenTo(this.page,"resize",this.onScaleChange),this},onScaleChange:function(){this.transformInsteadOfZoom(this.$content)},transformInsteadOfZoom:function(t){var e=this.page.scale;d.a.isOnForRatio(this.page.pageViewport,e,this.mag.opts)&&d.a.isCSSZoom()&&t.css({zoom:1/e,transform:"scale(".concat(e,")"),width:"".concat(1/e*100,"%"),height:"".concat(1/e*100,"%"),"transform-origin":"left top"})},isValid:function(){var t=Object(n.a)("<div>").html(this.text).text();return""!=n.a.trim(t)},hasFontsToLoad:function(){return!0},start:function(){return this.started=!0,Modernizr.chrome&&this.$el.addClass("force-repaint-content"),this},stop:function(){return this.started=!1,this.$el.removeClass("force-repaint-content"),RM.screenshot||this.destroyed||!this.rendered||this.$el&&this.$el.find("span.soundcite").each((function(t,e){ut.a.pausePlayer(e)})),this},destroy:function(){return this.$el&&this.$el.find("span.soundcite").each((function(t,e){ut.a.destroyPlayer(e)})),v.prototype.destroy.apply(this,arguments)},waitForUsedFontsLoad:function(){this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.widgetIsLoaded):this.widgetIsLoaded()},checkLink:function(){if(this.is_global||this.hasGlobalParent){var t=this.$el.find("a[data-pid]");t.removeClass("current back-to-top"),this.page&&t.filter('[data-pid="'+this.page._id+'"]').addClass("current back-to-top").removeClass("hovered")}v.prototype.checkLink.apply(this,arguments)},onLinkMouseEnter:function(t){var e=Object(n.a)(t.currentTarget).attr("data-uuid");this.$el.find("a[data-uuid='"+e+"']").addClass("hovered")},onLinkMouseLeave:function(t){var e=Object(n.a)(t.currentTarget).attr("data-uuid");this.$el.find("a[data-uuid='"+e+"']").removeClass("hovered")},onLinkClick:function(t){if(2!=t.which&&!t.metaKey&&!t.ctrlKey){var e=Object(n.a)(t.currentTarget),i=n.a.trim(e.attr("href")).match(/\/start\-with\-template\/(\d+)$/i),o=i&&i[1];o&&RM.viewerRouter&&RM.viewerRouter.createMagFromTemplate&&(t.preventDefault(),RM.viewerRouter.createMagFromTemplate("template-link",o))}}}).extend(ct.a.prototype),mt=i("q1tI"),gt=i.n(mt),ft=i("8AXF"),vt=i("DwEc"),bt=i("zjto"),yt=v.extend({antialiasRotation:!0,render:function(){var t=this;this.makeBox("widget-text-v3"),this.propsModel=new a.a.Model({page:this.page,currentPage:this.mag.currentPage||this.page,scale:this.page.scale,viewport:this.page.pageViewport,viewerOptions:this.mag.opts});return Object(ft.renderReact)({component:function(){return gt.a.createElement(ft.CreateContextProvider,{context:vt.b,model:t.propsModel},gt.a.createElement(bt.b,null))},domElement:this.$el[0],model:this.model}),this.rendered=!0,window.RM.screenshot&&!this.insideHotspot?this.waitForUsedFontsLoad():this.widgetIsLoaded(),this.seamlessFontsShow((function(){t.$el.removeClass("fonts-pending")}),(function(){t.$el.addClass("fonts-pending")})),d.a.isDesktopDefault(this.mag.viewport)&&d.a.isScaleLayout(this.mag.viewOpts)&&d.a.isCSSZoom()&&this.page.on("resize",this.onScaleChange),this},hasFontsToLoad:function(){return!0},updatePage:function(t){var e=this.page;(!e||t&&e.num!==t.num)&&(this.page=t,this.propsModel.set({currentPage:t}))},onScaleChange:function(){this.propsModel.set({scale:this.page.scale})},waitForUsedFontsLoad:function(){this.hasFontsToLoad()?this.page.addFontsToLoad(this,this.widgetIsLoaded):this.widgetIsLoaded()},destroy:function(){this.mag.off("pageChanged",this.onPageChanged),this.page.off("resize",this.onScaleChange);for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return v.prototype.destroy.apply(this,e)}}),_t=v.extend(st.a.prototype).extend({DO_NOT_WAIT_FOR_PRELOAD:!0,PHONE_TIP_WIDTH:280,MOUSE_LEAVE_TIMEOUT:100,EDGE_GAP:16,events:{"click .pin":"onPinClick",mouseenter:"onMouseenter",mouseleave:"onMouseleave"},render:function(){var t;if(this.makeBox("widget-hotspot"),this.rendered=!0,this.phoneTipWrapperTemplate=rt.a["template-common-hotspot-widget-mobile-wrapper"],this.isPreview=!(!RM.constructorRouter||!RM.constructorRouter.preview),t={model:this,$container:this.$el,environment:"viewer",mag:this.page&&this.page.mag,block:null},this.hotspotWidget=new lt.a(t),this.$pin=this.$(".pin").addClass("viewer"),this.started&&this.renderTip(),"icon"===this.pin_type){if(this.$el.addClass("icon"),!this.rasterUrl)return this.widgetIsLoaded(),this;var e=Object(n.a)("<img>");e.on("load",r.a.bind((function(){this.$(".pin").html(e),this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded),e.attr("src",this.raster3xUrl||this.raster2xUrl||this.rasterUrl||"")}else this.renderPinShape(),this.widgetIsLoaded();return this},renderPinShape:function(){var t,e=new Backbone.Model(this);e.id=this._id,t=this.generateShapeSVG("viewer",e,this.w,this.h),this.$pin.html(t)},renderTip:function(){this.isTipRendered||(this.$tip=Object(n.a)('<div class="tip viewer invisible"></div>'),this.$tip.toggleClass("box-shadow",this["tip_box-shadow"]),this.$tip.css({"border-radius":this["tip_border-radius"]}),this.$blocksWrapper=Object(n.a)('<div class="blocks-wrapper"></div>'),this.$blocksWrapper.appendTo(this.$tip),this.$blocksWrapper.css({"background-color":p.default.getRGBA(this["tip_background-color"],this["tip_background-color-opacity"]/100),"border-radius":this["tip_border-radius"]}),this.$(".common-hotspot").append(this.$tip),this.pictureData=r.a.findWhere(this.wids||[],{type:"picture"}),this.textData=r.a.findWhere(this.wids||[],{type:"text"}),this.hasPictureWidget=!(!this.pictureData||this.pictureData.hidden),this.hasTextWidget=!(!this.textData||this.textData.hidden),this.hasPictureWidget&&(this.pictureData.insideHotspot=!0,this.pictureWidget=new nt(this.pictureData,this.page,this.$blocksWrapper),this.pictureWidget.isValid()?(this.pictureData.w=Math.min(this.tip_w,this.pictureData.w),this.pictureWidget.render()):(this.tip_h-=this.pictureWidget.h||0,this.textData&&(this.textData.y=0),this.pictureWidget=null,this.hasPictureWidget=!1)),this.hasTextWidget&&(this.textData.insideHotspot=!0,this.textData.hasGlobalParent=this.is_global,Object(g.a)("constructor.textv3")&&3===this.textData.version?this.textWidget=new yt(this.textData,this.page,this.$blocksWrapper):this.textWidget=new pt(this.textData,this.page,this.$blocksWrapper),this.textWidget.w=Math.min(this.tip_w,this.textWidget.w),this.textWidget.render()),this.hasPictureWidget||this.hasTextWidget?(this.$closeButton=Object(n.a)('<div class="hotspot-phone-close"></div>'),this.$tip.append(this.$closeButton),this.isTipRendered=!0):this.$tip.remove())},updatePage:function(t){v.prototype.updatePage.apply(this,arguments),this.textWidget&&this.textWidget.updatePage(t)},start:function(){return this.started=!0,this.rendered&&!this.destroyed&&this.renderTip(),this},stop:function(){return this.started=!1,this.isTipVisible&&this.hideTip(),this},applyTipPosition:function(){var t,e,i,n,o,a,s,l=this.calcDistsToPageVisibleBounds(),c=this.w,d=this.h,h=this.$tip.width(),u=this.$tip.height(),p=this.hotspotWidget.TIP_GAP,m=this.tip_pos,g=r.a.pick(this,"w","h","tip_w","tip_h","tip_pos"),f=!1,v=!1;function b(t){var e,i,n,o;switch(t){case"top":e=l.top-d/2-p-u,n=l.bottom+d/2+p,o=l.left-h/2,i=l.right-h/2;break;case"right":e=l.top-u/2,n=l.bottom-u/2,o=l.left+c/2+p,i=l.right-c/2-p-h;break;case"bottom":e=l.bottom+d/2+p,n=l.bottom-d/2-p-u,o=l.left-h/2,i=l.right-h/2;break;case"left":e=l.top-u/2,n=l.bottom-u/2,o=l.left-c/2-p-h,i=l.right+c/2+p}return{top:e,left:o,bottom:n,right:i}}i=this.tip_pos,o=i,a=-1/0,s=!1,r.a.each(["top","right","bottom","left"],(function(t){if(!s){var e=b(t);n=r.a.min(e),t===i&&e[t]>0?(o=t,s=!0):n>a&&e[t]>=0&&(a=n,o=t)}})),m=o,g.tip_pos=m,e=this.hotspotWidget.apply_tip_position(g),t=b(m),r.a.each(t,function(t,i){if(t<0)switch(i){case"top":e.top-=t-this.EDGE_GAP,f=!0;break;case"bottom":f||(e.top+=t-this.EDGE_GAP);break;case"left":e.left-=t-this.EDGE_GAP,v=!0;break;case"right":v||(e.left+=t-this.EDGE_GAP)}}.bind(this)),this.$tip.css(e)},adjustPictureSize:function(){var t,e=this.tip_w/this.PHONE_TIP_WIDTH;this.pictureWidget&&(t=this.isPhone()?{width:this.PHONE_TIP_WIDTH,height:this.pictureData.h/e}:{width:this.pictureData.w,height:this.pictureData.h},this.pictureWidget.$el.css(t))},onPinClick:function(){this.isHoverable()||(this.isTipVisible?this.hideTip():this.isTipRendered&&this.showTip(),RM.analytics&&this.isTipVisible&&RM.analytics.sendEvent("Hotspot Click"))},onMouseenter:function(){this.isHoverable()&&this.isTipRendered&&(clearTimeout(this.mouseLeaveTimeout),this.isTipVisible||this.showTip(),RM.analytics&&RM.analytics.sendEvent("Hotspot Hover"))},onMouseleave:function(){this.isHoverable()&&(clearTimeout(this.mouseLeaveTimeout),this.mouseLeaveTimeout=setTimeout(function(){this.hideTip()}.bind(this),this.MOUSE_LEAVE_TIMEOUT))},showTip:function(){this.isTipRendered&&(this.adjustPictureSize(),this.isPhone()?(this.$phoneTipWrapper=this.$phoneTipWrapper||Object(n.a)(this.phoneTipWrapperTemplate()),this.$phoneTipWrapper.toggleClass("preview",this.isPreview),this.$phoneTipWrapper.detach().appendTo(this.isPreview?".mag-pages-container":"body"),this.$phoneTipWrapper.on("touchstart",this.onTipTouchStart),this.$phoneTipWrapper.on("touchmove",this.onTipTouchMove),this.$tipParent=this.$tip.parent(),this.$tip.detach().appendTo(this.$phoneTipWrapper.find(".center-cell")),r.a.defer(function(){this.$phoneTipWrapper.removeClass("invisible")}.bind(this)),this.$phoneTipWrapper.on("click",function(t){Object(n.a)(t.target).closest(".tip").is(this.$tip)||(this.hideTip(),this.$phoneTipWrapper.off())}.bind(this)),this.$closeButton.on("click",this.onCloseButtonClick)):(this.hotspotWidget.apply_tip_container_size({width:this.tip_w,height:this.tip_h}),this.applyTipPosition(),this.$tip.removeClass("invisible"),this.BringToTopZ(),this.page.mag.router.$mags_container.on("mousedown touchstart",this.onGlobalMouseDown),this.isHoverable()||Object(n.a)("body").on("keydown",this.onBodyKeyDown)),this.listenTo(this.page.mag,"change:viewport",this.onMagViewportBeforeChange),this.isTipVisible=!0)},hideTip:function(){this.isTipVisible&&(this.isTipVisible=!1,clearTimeout(this.mouseLeaveTimeout),this.isPhone()?(this.$phoneTipWrapper.addClass("invisible"),this.$phoneTipWrapper.off("touchstart",this.onTipTouchStart),this.$phoneTipWrapper.off("touchmove",this.onTipTouchMove),r.a.delay(function(){this.$tip.detach().appendTo(this.$tipParent),this.$phoneTipWrapper&&this.$phoneTipWrapper.detach()}.bind(this),200)):(this.$tip.addClass("invisible"),this.BackToNormalZ(),Object(n.a)("body").off("keydown",this.onBodyKeyDown)),this.stopListening(this.page.mag,"change:viewport"))},onTipTouchStart:function(t){this.tipScrollY=t.originalEvent.touches.item(0).clientY},onTipTouchMove:function(t){t.stopPropagation();var e=Object(n.a)(t.currentTarget),i=this.tipScrollY-t.originalEvent.touches.item(0).clientY;(i<0&&e.scrollTop()<=0||i>0&&e.scrollTop()+e.height()>=e[0].scrollHeight)&&t.preventDefault(),this.tipScrollY=t.originalEvent.touches.item(0).clientY},onCloseButtonClick:function(){this.$closeButton.off("click",this.onCloseButtonClick),this.hideTip()},onMagViewportBeforeChange:function(){this.hideTip()},onGlobalMouseDown:function(t){var e=Object(n.a)(t.target),i=e.closest(".pin"),o=e.closest(".tip");i.is(this.$pin)||o.is(this.$tip)||(this.page.mag.router.$mags_container.off("mousedown touchstart",this.onGlobalMouseDown),this.hideTip())},isPhone:function(){return w.a.isPhone||this.isPreview&&"phone_portrait"===this.page.mag.viewport},isHoverable:function(){return"hover"===this.tip_show_on&&w.a.isDesktop&&!this.isPhone()&&"tablet_portrait"!==this.page.mag.viewport},onBodyKeyDown:function(t){t.keyCode===n.a.keycodes.esc&&this.hideTip()},destroy:function(){return this.hotspotWidget&&this.hotspotWidget.destroy(),this.hotspotWidget=null,v.prototype.destroy.apply(this,arguments)}}),wt=i("60Nw"),kt=v.extend({render:function(){this.makeBox("widget-iframe"),this.rendered=!0;var t=this.getPluginClass();return t?(this.plugin=new t({widget:this}),this.$el.addClass(this.plugin.embed_type),this.started?this.drawPlugin():(this.contentCleared=!0,!RM.screenshot&&!this.drawInProgress&&this.widgetIsLoaded()),this):(this.widgetIsLoaded(),this)},drawPlugin:function(){this.$el.empty(),this.contentCleared=!1,this.drawInProgress=!0,this.plugin.parse(this.code,function(t){if(this.$data=this.plugin.sanitize(t),RM.screenshot&&setTimeout(r.a.bind((function(){this.widgetIsLoaded()}),this),5e3),this.plugin.draw(this.$data,this.$el,function(t,e){var i=RM.screenshot?5e3:2e3;this.loadTimeout=setTimeout(function(){this.drawInProgress=!1,this.destroyed||(this.widgetIsLoaded(),this.$data.off&&this.$data.off("load"),this.started||this.clearContent())}.bind(this),i)}.bind(this)),!RM.screenshot){if(!r.a.isFunction(this.$data.one))return;this.$data.one("load",function(){this.drawInProgress=!1,!this.destroyed&&this.started&&(this.widgetIsLoaded(),clearTimeout(this.loadTimeout))}.bind(this))}}.bind(this))},widgetIsLoaded:function(){this.loaded||this.destroyed||(this.loaded=!0,this.trigger("loaded"))},isValid:function(){return this.code&&this.getPluginClass()},start:function(){return this.started=!0,this.destroyed||!this.rendered||this.contentCleared&&this.drawPlugin(),this},stop:function(){return this.started=!1,this.plugin?(this.widgetIsLoaded(),this.drawInProgress?void 0:(this.clearContent(),this)):this},clearContent:function(){this.clear_content&&(this.$el.empty(),this.contentCleared=!0)},getPluginClass:function(){return wt.a.findPlugin(this)},destroy:function(){return this.clearContent(),this.plugin&&this.plugin.remove(),v.prototype.destroy.apply(this,arguments)}}),St=v.extend(st.a.prototype).extend({mailchimpMatcher:/__rm_mailchimp_(.+)/i,anchorRegexp:/__rm_anchor/i,shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,render:function(){if(this.makeBox("widget-shape"),this.hasHoverAnimation&&this.$el.addClass("has-onhover-animation"),this.rendered=!0,this.requiresImageLoad()){if(!this.rasterUrl)return this.widgetIsLoaded(),this;this.$el.addClass("icon"),this.antialiasRotation=!0;var t=Object(n.a)("<img>");t.on("load",r.a.bind((function(){this.$el.html(t),this.widgetIsLoaded()}),this)).on("error",this.widgetIsLoaded),t.attr("src",Modernizr.retina||d.a.isOnForRatio(this.page.pageViewport,this.page.scale,this.mag.opts)?this.raster2xUrl||this.rasterUrl||"":this.rasterUrl||"")}else this.redrawSVG(),this.widgetIsLoaded();return this.checkLink(),this},start:function(){Modernizr.firefox&&!this.requiresImageLoad()&&this.borders>0&&this.redrawSVG()},redrawSVG:function(){var t=this,e={id:t._id,get:function(e){return t[e]}};if("rectangle"!==this.tp||1!==this.opacity||w.a.isDesktop&&0!==this.borders){var i=this.generateShapeSVG("viewer-"+p.default.generateUUID(),e,this.$el.width(),this.$el.height());this.$el.html(i)}else{var n=p.default.hex2rgb(this.bg_color),o=p.default.hex2rgb(this.color);n&&n.push(this.bg_opacity),this.$el.css({"background-color":n?"rgba("+n.join(",")+")":"transparent","border-color":o?"rgb("+o.join(",")+")":"transparent","border-radius":this.radius||0,"border-style":"solid","border-width":this.borders,"box-sizing":"border-box"}),this.$el.addClass("div-instead-of-svg")}},requiresImageLoad:function(){return"icon"===this.tp},canRenderImmediately:function(){return!this.requiresImageLoad()},onPageResize:function(t){v.prototype.onPageResize.apply(this,arguments),this.requiresImageLoad()||this.redrawSVG()}}),xt=i("tcpm"),Ct=v.extend({MIN_TOP_SCROLL_SPACE:5,TIME_OF_STOPPED_SCROLL:55,render:function(){var t=this;(this.makeBox("widget-slideshow"),this.pictures=r.a.filter(this.pictures,(function(t){return!t.error})),this.player=new xt.a(this,this.$el,"viewer",null,this.page&&this.page.mag),void 0!==this.play_method&&"scroll"===this.play_method)&&(Object(n.a)(window).on("scroll",this.onScrollTransition),this.innerContentTop=this.page.contentPosition.top/this.page.scale,this.innerContainerHeight=this.page.mag.getContainerSizeCached().height/this.page.scale,this.isScrolling=!1,this.$image=this.$el.find(".image"),this.lastScrollTop=0,this.isCrossfade="crossfade"===this.transition_type,this.delay=(this.theme_data.scroll_delay>0?this.theme_data.scroll_delay:1)+(this.isCrossfade?this.theme_data.crossfade:0),this.picsID=[],this.player.$images_wrapper.children(".image").each((function(e,i){t.picsID.push(Object(n.a)(i).attr("data-id"))})));return this.player.on("ready",r.a.bind((function(){setTimeout(this.widgetIsLoaded,100)}),this)),!this.theme_data.arrows||"library"!==this.theme_data.arrows_type&&"noun"!==this.theme_data.arrows_type||this.renderNounIcons(),this.rendered=!0,this},onScrollTransition:function(t){var e=this,i=window.pageYOffset||document.documentElement.scrollTop,n=this.y+this.innerContentTop,o=n-this.innerContainerHeight,a=0*(n-o)+o+this.theme_data.start_offset||0,r=this.isCrossfade?10*this.theme_data.crossfade:this.TIME_OF_STOPPED_SCROLL,s=this.picsID.length,l=a>0?(i-a*this.page.scale)/this.page.scale:i/this.page.scale,c=Math.floor(l/this.delay),d=c+1,h=d>=s?d-Math.floor(d/s)*s:d;this.isScrolling&&(this.setFreezeStyles(i),h>=0&&this.player.currentImageID!==this.picsID[h]&&this.changeImage(i,c,this.picsID[h])),a<=0&&i<this.MIN_TOP_SCROLL_SPACE?setTimeout((function(){e.changeImage(i,c,e.picsID[0]),e.isScrolling=!1}),r):(clearTimeout(this.isScrolling),this.isScrolling=setTimeout((function(){e.setFreezeStyles(i)}),r))},changeImage:function(t,e,i){(t>this.lastScrollTop&&t>=e*this.delay||t<this.lastScrollTop&&t>=(e-1)*this.delay)&&this.player.moveToImage(i,!0,"switch-to-image-scroll"),this.lastScrollTop=t<=0?0:t},setFreezeStyles:function(t){var e=this.$el.find(".center-image"),i=this.$el.find(".prev-image"),n=this.getRealOpacity(e.css("opacity")),o=this.getRealOpacity(i.css("opacity"));this.isCrossfade&&(e.css({opacity:n>o?n:1-o}),i.css({opacity:o>n?o:1-n}),e.hasClass("changed-opacity")||i.hasClass("changed-opacity")||i.addClass("changed-opacity"))},getRealOpacity:function(t){return t<.1?10*t:t},renderNounIcons:function(){var t,e,i=this.theme_data.arrows_position;if(t=this.theme_data&&this.theme_data.left_icon_noun&&this.theme_data.left_icon_noun.rm_id?this.theme_data.left_icon_noun:this.left_arrow_noun&&this.left_arrow_noun.rasterUrl?this.left_arrow_noun:this.theme_data.left_icon_noun,e=this.theme_data&&this.theme_data.right_icon_noun&&this.theme_data.right_icon_noun.rm_id?this.theme_data.right_icon_noun:this.right_arrow_noun&&this.right_arrow_noun.rasterUrl?this.right_arrow_noun:this.theme_data.right_icon_noun,t&&t.rasterUrl){var o=Object(n.a)("<img>");o.on("load",r.a.bind((function(){"bottom"===i?this.$el.find(".prev-picture-arrow-bottom").empty().html(o.clone()):this.$el.find(".prev-picture-arrow-middle").empty().html(o.clone())}),this)).on("error",this.widgetIsLoaded),o.attr("src",t.raster3xUrl||t.raster2xUrl||t.rasterUrl||"")}if(e&&e.rasterUrl){var a=Object(n.a)("<img>");a.on("load",r.a.bind((function(){"bottom"===i?this.$el.find(".next-picture-arrow-bottom").empty().html(a.clone()):this.$el.find(".next-picture-arrow-middle").empty().html(a.clone())}),this)).on("error",this.widgetIsLoaded),a.attr("src",e.raster3xUrl||e.raster2xUrl||e.rasterUrl||"")}},isValid:function(){return this.pictures&&this.pictures.length},start:function(){return this.started=!0,!RM.screenshot&&!this.destroyed&&this.player&&(this.theme_data.autoplay&&void 0===this.play_method||"autoplay"===this.play_method)&&this.rendered&&this.loaded&&this.player.startAutoplay(),this},stop:function(){return this.started=!1,!RM.screenshot&&!this.destroyed&&this.player&&this.rendered&&this.loaded&&this.player.stopAutoplay(),this},destroy:function(){return this.player&&this.player.off(),this.player&&this.player.destroy(),this.player=null,"scroll"===this.play_method&&Object(n.a)(window).off("scroll",this.onScrollTransition),v.prototype.destroy.apply(this,arguments)}}),Ot=i("5ta/"),jt=i("Vc8N"),Pt=i.n(jt),Et=v.extend({CONTENT_WAIT_TICK:100,CONTENT_WAIT_MAX_TICKS:20,CONTENT_IMG_WAIT:1e3,DO_NOT_WAIT_FOR_PRELOAD:!0,render:function(){var t,e;return this.makeBox("widget-twitter"),this.rendered=!0,this.current_type?("mag"===(e=this[this.current_type]).use_own_url?e.url=this.page.mag.getUrl():"page"!==e.use_own_url&&e.url||(e.url=this.page.getUrl()),RM.screenshot||(e.text=Ot.getFinalShare(this.page,r.a.extend(this.page.mag.model.toJSON(),{user:this.page.mag.user}),{forProject:"mag"===e.use_own_url,customDomain:RM.common.isDomainViewer}).tweet),t=Pt.a["template-constructor-block-twitter-"+this.current_type],this.$el.html(t(e)),"type_timeline"===this.current_type&&this.$el.find("a").attr({width:this.w,height:this.h}),W.a.initTwitterAPI(function(){this.destroyed||(window.twttr&&window.twttr.widgets&&r.a.isFunction(window.twttr.widgets.load)&&window.twttr.widgets.load(),Object(r.a)(["type_timeline","type_embed"]).contains(this.current_type)?this.waitForTwitterContent():this.widgetIsLoaded())}.bind(this)),this):(this.widgetIsLoaded(),this)},waitForTwitterContent:function(){var t,e,i,n=0,o=!1,a={type_timeline:".timeline-Widget",type_embed:"blockquote.tweet"};clearInterval(t),t=setInterval(r.a.bind((function(){n++,this.destroyed?clearInterval(t):(1==(e=this.$el.find("iframe")).length&&(i=a[this.current_type],o=e.contents().find(i).length>0),(o||n>this.CONTENT_WAIT_MAX_TICKS)&&("type_embed"==this.current_type&&e.css({margin:0,"max-width":"100%"}),"type_timeline"==this.current_type&&(console.log("$frame : ",e),e.css({width:"100%",height:"100%!important","max-width":"100%"})),clearInterval(t),setTimeout(r.a.bind((function(){this.widgetIsLoaded()}),this),this.CONTENT_IMG_WAIT)))}),this),this.CONTENT_WAIT_TICK)}}),It=i("i8i4"),Tt=i.n(It),Mt=i("LazK"),$t=v.extend({ignoreScale:!0,render:function(){this.makeBox("widget-rm-header"),this.$header=Object(n.a)("<div>").appendTo(this.$el).get(0);var t=new a.a.Model({activeLink:this.activeLink});return Object(ft.renderReact)({component:Mt.a,domElement:this.$header,model:t}),this.rendered=!0,this.widgetIsLoaded(),this},destroy:function(){return Tt.a.unmountComponentAtNode(this.$header),v.prototype.destroy.apply(this,arguments)}}),At=i("1cLU");function Rt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Dt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Bt=v.extend({ignoreScale:!0,render:function(){return this.makeBox("widget-rm-footer"),Object(n.a)(".widget-rm-footer").css({background:"rgb(40, 40, 40)"}),this.propsModel=new Backbone.Model(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Rt(Object(i),!0).forEach((function(e){Dt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Rt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({isMobileViewport:!1},this.getStyles())),this.$footer=Object(n.a)("<div>").appendTo(this.$el).get(0),Object(ft.renderReact)({component:At.a,domElement:this.$footer,model:this.propsModel}),this.rendered=!0,this.widgetIsLoaded(),this},destroy:function(){return Tt.a.unmountComponentAtNode(this.$footer),v.prototype.destroy.apply(this,arguments)},getStyles:function(){var t=this.mag.getViewportWidth(this.page.pageViewport);if(d.a.isOn(this.page.pageViewport,t,this.mag.viewOpts)){var e=1/d.a.getRatio(t),i=d.a.isCSSZoom(),n=d.a.isCSSTransform();return{zoom:i?"".concat(e):null,transform:n?"scale(".concat(e,")"):null}}},onPageResize:function(){v.prototype.onPageResize.apply(this,arguments),this.propsModel.set(this.getStyles())}}),Lt=i("3TY3"),zt=i("fEUr");function Ft(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return Ut(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ut(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==i.return||i.return()}finally{if(s)throw a}}}}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Nt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ht(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(i),!0).forEach((function(e){Vt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Nt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Vt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Wt(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Gt(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Wt(a,n,o,r,s,"next",t)}function s(t){Wt(a,n,o,r,s,"throw",t)}r(void 0)}))}}var qt,Kt,Yt,Xt=v.extend({triggerWidgets:[],render:(Yt=Gt(regeneratorRuntime.mark((function t(){var e,n,o,r,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.basePath&&this.numberOfImages){t.next=2;break}return t.abrupt("return");case 2:return this.makeBox("widget-shots"),t.next=5,Promise.resolve().then(i.bind(null,"8AXF"));case 5:return e=t.sent,n=e.renderReact,t.next=9,Promise.resolve().then(i.bind(null,"3TY3"));case 9:return o=t.sent,r=o.Shots,this.stateModel=new a.a.Model(this.getCurrentState()),n({component:function(){return gt.a.createElement(ft.CreateContextProvider,{context:Lt.ShotsStateContext,model:s.stateModel},gt.a.createElement(r,{mode:window.RM.screenshot?"screenshoter":"viewer",onFirstRender:s.onFirstRender,onFirstFrameLoaded:s.widgetIsLoaded}))},domElement:this.el,model:this.model}),t.abrupt("return",this);case 15:case"end":return t.stop()}}),t,this)}))),function(){return Yt.apply(this,arguments)}),getCurrentState:function(){return{pageScale:this.page.scale,pageContentTop:this.page.contentPosition.top,magContainerHeight:this.page.mag.getContainerSizeCached().height,widgetBoxTop:this.calcBoxStyle({calcBBox:!0}).dimensions.top}},getViewerType:function(){return this.page.mag&&this.page.mag.viewOpts&&this.page.mag.viewOpts.viewertype||"vertical"},onFirstRender:function(){var t;(this.rendered=!0,this._scheduleStart&&this.start(),this.playbackType===zt.b.scroll)&&(t=this.isAbove()&&"vertical"===this.getViewerType()?this.page.mag.getScroll():this.page.getScroll(),this.handleScroll(t))},handleScroll:function(t){this.rendered&&this.stateModel.set(Ht(Ht({},this.getCurrentState()),{},{currentScrollOffset:t}))},handlePointerMovement:function(t){if(this.rendered){"touches"in t&&"horizontal"===this.getViewerType()&&this.hoverDirection===zt.a.horizontally&&t.stopPropagation();var e="touches"in t?t.touches[0].clientX:t.clientX,i="touches"in t?t.touches[0].clientY:t.clientY,n=t.target;if(n){var o=n.getBoundingClientRect(),a=Modernizr.firefox?1:this.page.scale,r=e/a-o.left,s=i/a-o.top;this.hoverDirection===zt.a.horizontally?this.stateModel.set({hoverPercent:r/o.width}):this.hoverDirection===zt.a.vertically&&this.stateModel.set({hoverPercent:s/o.height})}}},getTriggerWidgets:(Kt=Gt(regeneratorRuntime.mark((function t(){var e,i,n,o,a=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=[],i=Ft(this.triggers),t.prev=2,o=regeneratorRuntime.mark((function t(){var i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.value,o=void 0,t.prev=2,t.next=5,a.page.mag.getWidgetById(i,a.page);case 5:o=t.sent,t.next=11;break;case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return","continue");case 11:if(o){t.next=13;break}return t.abrupt("return","continue");case 13:if(!o.rendered){t.next=17;break}e.push(o),t.next=20;break;case 17:return t.next=19,new Promise((function(t){return a.listenToOnce(o,"rendered",t)}));case 19:e.push(o);case 20:case"end":return t.stop()}}),t,null,[[2,8]])})),i.s();case 5:if((n=i.n()).done){t.next=12;break}return t.delegateYield(o(),"t0",7);case 7:if("continue"!==t.t0){t.next=10;break}return t.abrupt("continue",10);case 10:t.next=5;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t.catch(2),i.e(t.t1);case 17:return t.prev=17,i.f(),t.finish(17);case 20:return e.length||e.push(this),t.abrupt("return",e);case 22:case"end":return t.stop()}}),t,this,[[2,14,17,20]])}))),function(){return Kt.apply(this,arguments)}),bindTriggers:(qt=Gt(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getTriggerWidgets();case 2:this.triggerWidgets=t.sent,this.triggerWidgets.forEach((function(t){t.el instanceof HTMLElement&&(t.el.addEventListener("mousemove",e.handlePointerMovement),t.el.addEventListener("touchmove",e.handlePointerMovement))}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return qt.apply(this,arguments)}),unbindTriggers:function(){var t=this;this.triggerWidgets.forEach((function(e){e.el instanceof HTMLElement&&(e.el.removeEventListener("mousemove",t.handlePointerMovement),e.el.removeEventListener("touchmove",t.handlePointerMovement))}))},start:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];v.prototype.start.apply(this,i),this.rendered?(this.playbackType===zt.b.scroll?this.isAbove()&&"vertical"===this.getViewerType()?this.listenTo(this.page.mag,"mag scroll",this.handleScroll):this.listenTo(this.page,"page scroll",this.handleScroll):this.playbackType===zt.b.hover&&this.bindTriggers(),setTimeout((function(){t.stateModel.set({isStarted:!0})}),1)):this._scheduleStart=!0},stop:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];v.prototype.stop.apply(this,e),this.rendered&&(this.stopListening(),this.unbindTriggers(),this.stateModel.set({isStarted:!1}))},destroy:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];v.prototype.destroy.apply(this,e)}});e.a={addtocart:y,audio:k,background:R,button:F,ecommercecart:V,facebook:K,form:Q,picture:nt,gmaps:ot,hotspot:_t,iframe:kt,shape:St,slideshow:Ct,text:function(t,e,i){switch(t.version){case 3:return new yt(t,e,i);default:return new pt(t,e,i)}},twitter:Et,video:A,rmheader:$t,rmfooter:Bt,shots:Xt}},gm8A:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("OTSC"),l=i("HuYI"),c=i.n(l),d=i("QNiq"),h=i("f3SV"),u=i("I0kf");function p(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return r=t.done,t},e:function(t){s=!0,a=t},f:function(){try{r||null==i.return||i.return()}finally{if(s)throw a}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var g=a.a.View.extend({MIN_FIELD_WIDTH:50,MIN_FIELD_HEIGHT:30,CAPTCHA_WIDTH:304,CAPTCHA_HEIGHT:78,CAPTCHA_INVISIBLE:!0,LINE_HEIGHT_FACTOR:1.2,INVALID_COLOR:"ff4828",INVALID_BORDER_WIDTH:2,DROPDOWN_TRIANGLE:{SVG:'<svg class="form-dropdown-triangle" width="9" height="6" preserveAspectRatio="none" viewBox="0 0 9 6" xmlns="http://www.w3.org/2000/svg"><path d="M3.763 5.196L.536 1.676A1 1 0 0 1 1.273 0h6.454a1 1 0 0 1 .737 1.676l-3.227 3.52a1 1 0 0 1-1.474 0z" fill-rule="evenodd"/></svg>',OPACITY_MULTIPLIER:.4,W:9,H:6,FONT_SIZE:18},CHECKBOX_TICK:{SVG:'<svg width="19" height="14" preserveAspectRatio="none" viewBox="0 0 19 14" xmlns="http://www.w3.org/2000/svg"><path d="M6.657 10.9L17.263.292a1 1 0 1 1 1.415 1.414L7.364 13.021a.997.997 0 0 1-1.414 0L.293 7.364A1 1 0 1 1 1.707 5.95l4.95 4.95z" fill-rule="evenodd"/></svg>',W:19,H:14,FONT_SIZE:18},initialize:function(t){r.a.bindAll(this),this.data=t.data,this.$container=t.$container,this.environment=t.environment,this.buttonTemplate=c.a["template-common-form-button"]},render:function(t){var e=this;t=t||{},this.rendered?t.force&&this.$el&&this.$el.empty():(this.setElement(Object(n.a)("<div>")),this.$el.addClass("form-wrapper").appendTo(this.$container),"constructor"!==this.environment&&this.$el.on(d.a.isDesktop?"mouseenter":"touchstart",".button",this.onButtonHover).on(d.a.isDesktop?"mouseleave":"touchend",".button",this.onButtonHoverOut),this.$el.on("change","select",this.onDropdownChange).on("mouseenter",".input-wrapper",this.onInputHover).on("mouseleave",".input-wrapper",this.onInputHoverOut),this.rendered=!0);var i,o,a=this.data,r=a.fields,l=Object(n.a)('<div><form enctype="multipart/form-data" method="post" target="form_submit_iframe"></form></div>'),c=l.find("form"),h=RM.constructorRouter&&RM.constructorRouter.previewMode,p=!!RM.constructorRouter,m=!1;if(RM.screenshot)window.ServerData.userPermissions&&window.ServerData.userPermissions.can_use_forms_file_upload&&(m=!0);else{var g=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");g&&g.can_use_forms_file_upload&&(m=!0),g&&!g.can_use_forms&&Object(u.a)("constructor.canUseFormPermission")&&!1}for(var f=0;f<r.length;f++){var v=r[f];if(("file"!==v.tp||m||p)&&("captcha"!==v.tp||Object(u.a)("viewer.formsCaptcha")||p)){i="vertical"===a.layout&&"text"===v.tp,(o=Object(n.a)(i?"<textarea>":"<input>")).addClass("js-input"),o.attr("type","text").attr("autocapitalize","name"===v.tp?"on":"off").attr("autocomplete","off").attr("autocorrect","off").attr("name",v.caption).attr("placeholder",v.caption+(v.optional&&"viewer"!==this.environment?" (optional)":"")).attr("spellcheck",!1).attr("data-sort",v.sort),"email"===v.tp&&o.attr("inputmode","email"),"phone"===v.tp&&o.attr("inputmode","tel"),"number"===v.tp&&o.attr("inputmode","numeric"),"checkbox"===v.tp&&o.attr("type","checkbox"),"dropdown"===v.tp&&(o.attr({tabindex:-1}),o.prop({readonly:!0}),o.addClass("fake-dropdown"));var b=Object(n.a)('<div class="input-wrapper js-input-wrapper"/>');if(b.append(o),b.append('<div class="overlay"></div>'),"viewer"!==this.environment&&i){var y=Object(n.a)('<span class="input-line-control input-line-control-add js-add-line"></span>'),_=Object(n.a)('<span class="input-line-control input-line-control-remove js-remove-line"></span>');b.append(y).append(_)}if("file"===v.tp){"viewer"===this.environment&&o.attr("type","file");var w="formfiles-".concat(this.data._id).concat("viewer"!==this.environment?"-constructor":"");o.attr("name","formfiles"),o.attr("id",w),o.attr("multiple",""),o.attr("accept",(window.ServerData.config.FORMS_ACCEPTED_MIMES||[]).join(",")),o.addClass("input-file");var k=v.caption+(v.optional&&"viewer"!==this.environment?" (optional)":"")||"Add files";b.append(Object(n.a)("<label ".concat(m?'for="'.concat(w,'"'):"",' class="input-file-label').concat("viewer"!==this.environment?" no-hover":"",'" data-empty-text="').concat(k).concat(h&&!m?" (Pro plan only)":"",'"><span class="files-name">').concat(k).concat(h&&!m?" (Pro plan only)":"",'</span><span class="files-count"></span></label>'))),"viewer"===this.environment&&b.append(Object(n.a)('<span class="input-file-control input-file-control-add"></span><span class="input-file-control input-file-control-remove"></span>'))}if(b.appendTo(c),"dropdown"===v.tp&&v.items){var S=Object(n.a)("<select>"),x=Object(n.a)(this.DROPDOWN_TRIANGLE.SVG);S.attr("name",v.caption),Object(n.a)('<option value="" selected></option>').prop("disabled",!v.optional).appendTo(S);for(var C=0;C<v.items.length;C++)Object(n.a)("<option>").attr("value",v.items[C]).text(v.items[C]).appendTo(S);o.parent().append(x).append(S)}if("checkbox"===v.tp){var O=d.a.isDesktop?"":"input-checkbox-wrapper-mobile";o.wrap('<label class="input-checkbox-wrapper '+O+'"></label>'),o.after('\t\t\t\t\t\t<div class="input-checkbox-inner"> \t\t\t\t\t\t\t<span class="label">'+o.attr("placeholder")+'</span> \t\t\t\t\t\t\t<span class="tick">'+this.CHECKBOX_TICK.SVG+"</span> \t\t\t\t\t\t</div>")}}}if(Object(n.a)(this.buttonTemplate()).appendTo(c),this.$el.html(l.html()).addClass("common-form"),this.data.captcha&&Object(u.a)("viewer.formsCaptcha")&&!RM.common.isDownloadedSource){var j=s.default.generateUUID(),P=Object(n.a)('<div id="'.concat(j,'" class="captcha-holder captcha-invisible"></div>'));this.$el.find("form").append(P),window.recaptchaReadyPromise&&window.recaptchaReadyPromise.then((function(){e.captcha=window.grecaptcha.render(j,{sitekey:window.ServerData.config.RECAPTCHA_SITEKEY,callback:e.captchaCallback.bind(e),theme:P.data("type")||"light",size:"invisible"})}))}this.$button=this.$(".button"),this.$buttonIcons=this.$(".button svg"),this.$inputs=this.$(".input-wrapper"),this.$triangles=this.$(".form-dropdown-triangle"),this.$fileInputLabel=this.$inputs.find(".input-file-label"),this.$fileInputLabelText=this.$inputs.find(".input-file-label > .files-name"),this.$fileInputLabelCount=this.$inputs.find(".input-file-label > .files-count"),"viewer"===this.environment&&(this.$fileInput=this.$inputs.find(".input-file"),this.$fileInput&&this.$fileInput.on("change",this.onFileChange),this.$fileAddCtrl=this.$(".input-file-control-add"),this.$fileRemoveCtrl=this.$(".input-file-control-remove"),this.$fileRemoveCtrl&&this.$fileRemoveCtrl.on("click",this.onFileRemove)),this.recalcStyles()},executeCaptcha:function(t){this.hasOwnProperty("captcha")?(this.captchaExecuteCallback=t,window.grecaptcha.reset(this.captcha),window.grecaptcha.execute()):t()},captchaCallback:function(t){var e=this;this.captchaResponse=t,setTimeout((function(){return e.captchaExecuteCallback(t)}),0)},validateFiles:function(t){if(!t||!t.length)return!0;var e=RM.viewerRouter?RM.viewerRouter.getUserPermissions():RM.constructorRouter.me.get("permissions");if(t.length>e.forms_file_upload_count)return alert(h.a.MSG_UPLOAD_FORMS_FILES_ERROR),!1;var i,n=p(t);try{for(n.s();!(i=n.n()).done;){if(i.value.size>e.forms_file_upload_limit)return alert(h.a.MSG_UPLOAD_FORMS_SIZE_ERROR),!1}}catch(t){n.e(t)}finally{n.f()}return!0},onFileChange:function(){var t=this.$fileInput.get(0).files;if(!t||!t.length)return this.$fileRemoveCtrl&&this.$fileRemoveCtrl.hide(),this.$fileAddCtrl&&this.$fileAddCtrl.show(),this.$fileInputLabelText.text(this.$fileInputLabel.data("emptyText")),this.$fileInputLabelCount.text(""),void this.$fileInputLabel.removeClass("has-files");if(!this.validateFiles(t))return this.onFileRemove();this.$fileInputLabel.addClass("has-files"),this.$fileRemoveCtrl&&this.$fileRemoveCtrl.show(),this.$fileAddCtrl&&this.$fileAddCtrl.hide();var e=(t[0].name||"Filename").split("\\").join("/").split("/").pop();this.$fileInputLabelText.text(e),this.$fileInputLabelCount.text(t.length>1?" +".concat(t.length-1):"")},onFileRemove:function(){this.$fileInput.val(""),this.onFileChange()},onDropdownChange:function(t){Object(n.a)(t.currentTarget).parent().find(".js-input").val(Object(n.a)(t.currentTarget).val())},setButtonHoverState:function(){this.forcePseudoState="hover",this.applyButtonStyle()},unsetButtonHoverState:function(){this.forcePseudoState=!1,this.applyButtonStyle()},recalcStyles:function(t){this.$el.attr("data-layout",this.data.layout).attr("data-style",this.data.style),this.$button.find(".caption").text(this.data["button-caption"]),this.resizeElements(t),this.applyInputsStyle(this.$inputs),this.applyButtonStyle(t)},getMinimalDimensions:function(){var t,e=this.data,i=e.fields,n=e["style-"+e.style+"-fields"],o=e["style-"+e.style+"-button-default"],a=this.getButtonValue.bind(this,o,n),r=i.find((function(t){return"captcha"===t.tp})),s=o.gutter+(i.length-(r&&this.CAPTCHA_INVISIBLE?1:0))*n.gutter,l=n["underline-width"]||0,c=Math.max(Math.ceil(a("font-size")*this.LINE_HEIGHT_FACTOR),this.MIN_FIELD_HEIGHT)+l,d=Math.max(Math.ceil(n["font-size"]*this.LINE_HEIGHT_FACTOR),this.MIN_FIELD_HEIGHT)+l,h=Math.max(c,d);return"vertical"===e.layout&&(t={width:Math.max(r&&!this.CAPTCHA_INVISIBLE?this.CAPTCHA_WIDTH:0,this.MIN_FIELD_WIDTH),height:s+this.getTotalInputsHeight(i,h)+h}),"horizontal"===e.layout&&(t={width:s+i.length*this.MIN_FIELD_WIDTH+r&&!this.CAPTCHA_INVISIBLE?this.CAPTCHA_WIDTH:this.MIN_FIELD_WIDTH,height:Math.max(h,r&&!this.CAPTCHA_INVISIBLE?this.CAPTCHA_HEIGHT:0)}),t},getTotalInputsHeight:function(t,e){return r.a.reduce(t,function(t,i){return"text"===i.tp?t+this.getExtraTextareaDimensions(i.rows,e).height:"captcha"===i.tp?t+this.CAPTCHA_INVISIBLE?0:this.CAPTCHA_HEIGHT:t+e}.bind(this),0)},getRowsCount:function(t){return r.a.reduce(t,(function(t,e){return t+("captcha"===e.tp?0:"text"===e.tp&&e.rows||1)}),0)},getInputDimensions:function(t){var e,i,n=this.data,o=n.fields,a=o.length+1,r=n["style-"+n.style+"-button-default"],s=n["style-"+n.style+"-fields"],l=o.find((function(t){return"captcha"===t.tp})),c=r.gutter+(o.length+(l?-1:0))*s.gutter,d=t&&void 0!==t.w?t.w:n.w,h=t&&void 0!==t.h?t.h:n.h,u="vertical"===n.layout,p=Math.floor(u?h:d),m=u?this.CAPTCHA_HEIGHT:this.CAPTCHA_WIDTH,g=p-c-(l&&!this.CAPTCHA_INVISIBLE?m+s.gutter:0);if(u){var f=this.getLineHeight(),v=g-this.getRowsCount(o)*f.input-f.input,b=Math.ceil(v/(a-(l?1:0)));e=f.input+b,i=this.getTotalInputsHeight(o,e)+e+c-p}else i=(e=Math.ceil(g/(a-(l?1:0))))*(o.length+1)+c-p;return{overflow:i,itemSize:e,itemOtherSize:u?d:h,gutter:s.gutter,lastGutter:r.gutter+s.gutter}},getLineHeight:function(){var t=this.data||{},e=this.LINE_HEIGHT_FACTOR,i=this.getButtonValue(t["style-"+t.style+"-button-default"],t["style-"+t.style+"-fields"],"font-size"),n=t["style-"+t.style+"-fields"]["font-size"];return{input:Math.floor(e<10?e*n:e),button:Math.floor(e<10?e*i:e)}},getExtraTextareaDimensions:function(t,e){t=t||1;var i=this.getLineHeight(),n=Math.round(e-i.input),o=this.data&&"underlined"==this.data.style,a=o?n:Math.ceil(n/2),r=o?0:Math.floor(n/2);return{height:t*i.input+a+r,top:a,bottom:r}},resizeElements:function(t){var e=this.data,i="vertical"===e.layout,o=e.fields,a=o.length,r=this.getInputDimensions(t),s=r.overflow,l=e["style-"+e.style+"-fields"],c=(l&&l["underline-width"]||0)+2;this.$inputs.add(this.$button).each(function(t,e){var l={},d=r.itemSize,h=t===a-1,u=t<a,p=o[t],m=Object(n.a)(e),g=t>=a+1-s;if(g&&d--,l[i?"height":"width"]=d+"px",l[i?"width":"height"]=r.itemOtherSize+"px",u&&(l[i?"margin-bottom":"margin-right"]=h?r.lastGutter:r.gutter),l[i?"margin-right":"margin-bottom"]="",i&&p&&"captcha"===p.tp&&delete l.height,!i&&p&&"captcha"===p.tp&&delete l.width,i&&p&&"text"===p.tp){var f=p.rows||1,v=m.find(".js-input"),b=m.find(".js-add-line"),y=m.find(".js-remove-line"),_=this.getExtraTextareaDimensions(f,r.itemSize);l.height=_.height+(g?-1:0)+"px",v.css({top:_.top-c,bottom:_.bottom}),v.attr({rows:f}),b.css({top:_.top-c}),y.css({bottom:_.bottom+c}),m.toggleClass("is-multiline",f>1)}m.css(l)}.bind(this))},showInputPlaceholdersAsValues:function(t){this.$inputs.each((function(e,i){var o=Object(n.a)(i).find(".js-input");"checkbox"===o.attr("type")?o.parent().find(".label").addClass("input-checkbox-preview"):o.val(t?o.attr("placeholder"):"")}))},applyInputsStyle:function(t,e){var i=this;e=e||{};var o,a=this.data,s=(a.fields,r.a.clone(a["style-"+a.style+"-fields"]));"underlined"===a.style?(e.invalid&&(s["underline-color"]=this.INVALID_COLOR,s["underline-opacity"]=100,s["underline-width"]=s["underline-width"]||this.INVALID_BORDER_WIDTH),o={"background-color":"transparent","border-radius":0,"box-shadow":"inset 0 "+-s["underline-width"]+"px 0 0 "+this.getRgba(s["underline-color"],s["underline-opacity"])}):(e.invalid&&(s["border-color"]=this.INVALID_COLOR,s["border-opacity"]=100,s["border-width"]=s["border-width"]||this.INVALID_BORDER_WIDTH),o={"background-color":this.getRgba(s.color,s.opacity),"border-radius":s["border-radius"]+"px","box-shadow":"inset 0 0 0 "+s["border-width"]+"px "+this.getRgba(s["border-color"],s["border-opacity"])});var l={"font-family":s["font-family"],"font-style":s["font-style"],"font-weight":s["font-weight"],color:this.getRgba(s["text-color"],s["text-opacity"]),"font-size":s["font-size"],"letter-spacing":s["letter-spacing"],"margin-bottom":s["underline-width"]?s["underline-width"]+"px":0};t.filter(":not(.captcha-wrapper)").css(o).find(".js-input:not(.captcha-wrapper), select").css(l),t.find(".input-checkbox-inner .label").css(l),t.find(".input-file-label").css(l),t.find(".js-add-line, .js-remove-line").css({"font-size":s["font-size"]}),t.find(".form-dropdown-triangle").each(function(t,e){var i=Object(n.a)(e),o=i.parent(),a=o.find(".js-input"),r=a.position().top,l=o.height()-a.height()-r,c=this.getSvgSizesFromFontSize(s["font-size"],"DROPDOWN_TRIANGLE");i.css({fill:this.getRgba(s["text-color"],s["text-opacity"]*this.DROPDOWN_TRIANGLE.OPACITY_MULTIPLIER),top:r,bottom:l,width:c.w,height:c.h})}.bind(this)),t.find(".input-checkbox-inner svg").each((function(t,e){var o=Object(n.a)(e),a=i.getSvgSizesFromFontSize(s["font-size"],"CHECKBOX_TICK");o.css({fill:i.getRgba(s["text-color"],s["text-opacity"]),width:a.w,height:a.h})}))},applyButtonStyle:function(){var t=this.data,e=(t.fields,t["style-"+t.style+"-fields"]),i=t["style-"+t.style+"-button-default"],n=t["style-"+t.style+"-button-hover"],o=this.getButtonValue.bind(this,i,e),a=this.getHoverValue.bind(this,n,i,e),r=o("letter-spacing");this.$button.css({"line-height":this.$button.height()+"px","background-color":this.getRgba(o("color"),o("opacity")),"border-radius":o("border-radius")+"px","box-shadow":"inset 0 0 0 "+o("border-width")+"px "+this.getRgba(o("border-color"),o("border-opacity")),"font-family":o("font-family"),"font-style":o("font-style"),"font-weight":o("font-weight"),color:this.getRgba(o("text-color"),o("text-opacity")),"font-size":o("font-size"),"letter-spacing":r,"text-align":o("text-align"),"text-indent":r/2||0}),this.$buttonIcons.css({fill:this.getRgba(o("text-color"),o("text-opacity"))}),this.$button.attr("data-default",this.$button.attr("style")),this.$button.css({"background-color":this.getRgba(a("color"),a("opacity")),"box-shadow":"inset 0 0 0 "+a("border-width")+"px "+this.getRgba(a("border-color"),a("border-opacity")),color:this.getRgba(a("text-color"),a("text-opacity"))}),this.$button.attr("data-hover",this.$button.attr("style")),this.forcePseudoState||this.$button.attr("style",this.$button.attr("data-default")),this.$button.outerHeight(),this.$button.toggleClass("with-transition",!!n.transition&&"viewer"==this.environment)},getRgba:function(t,e){var i=s.default.hex2rgb(t);return"rgba("+i[0]+", "+i[1]+","+i[2]+","+e/100+")"},getButtonValue:function(t,e,i){return"inherit"===t[i]?e[i]:t[i]},getHoverValue:function(t,e,i,n){return"inherit"===t[n]?this.getButtonValue(e,i,n):t[n]},onInputHover:function(t){var e=this.data,i=r.a.clone(e["style-"+e.style+"-fields"]);Object(n.a)(t.currentTarget).find(".form-dropdown-triangle").css("fill",this.getRgba(i["text-color"],i["text-opacity"]))},onInputHoverOut:function(t){var e=this.data,i=r.a.clone(e["style-"+e.style+"-fields"]);Object(n.a)(t.currentTarget).find(".form-dropdown-triangle").css("fill",this.getRgba(i["text-color"],i["text-opacity"]*this.DROPDOWN_TRIANGLE.OPACITY_MULTIPLIER))},onButtonHover:function(t){this.$button.hasClass("submitted")||this.$button.attr("style",this.$button.attr("data-hover"))},onButtonHoverOut:function(t){this.$button.attr("style",this.$button.attr("data-default"))},destroy:function(){this.$fileInput&&this.$fileInput.off("change",this.onFileChange),this.$el.off(d.a.isDesktop?"mouseenter":"touchstart",".button",this.onButtonHover).off(d.a.isDesktop?"mouseleave":"touchend",".button",this.onButtonHoverOut).off("change","select",this.onDropdownChange),this.$el&&this.$el.remove()},getSvgSizesFromFontSize:function(t,e){var i=this[e].H,n=this[e].W,o=this[e].FONT_SIZE;return{h:t*i/o,w:t*n/o}}});e.a=g},hQZz:function(t,e,i){"use strict";i.r(e);var n=i("I0kf"),o=i("rFsW"),a=i("5BZr"),r=i("Kx3/"),s=i.n(r),l=a.a.extend({name:"common_layer",className:"control common_layer",BASE_ZINDEX:100,initialize:function(t){this.template=s.a["template-constructor-control-common_layer"],this.initControl(t),this.blocks&&Array.isArray(this.blocks)&&(this.block=this.blocks[0],this.model=this.block.model),t.noInit||(this.selectedModels=o.a.pluck(this.blocks,"model"),this.fixBadZIndexes())},normalizeZIndexes:function(){var t=this.allModels,e=this.BASE_ZINDEX,i=!1;return Object(o.a)(t).chain().sortBy((function(t){return t.get("z")})).each((function(t){var n=t.get("z"),o=e++;t.set("z",o,{first:!0}),n!==o&&(i=!0)})).value(),i},fixBadZIndexes:o.a.debounce((function(){if(!Object(n.a)("constructor.zIndex")){this.allModels=Object(o.a)(this.master.workspace.blocks).chain().filter((function(t){return!t.outofbox})).pluck("model").map((function(t){return o.a.isNumber(t.get("z"))||t.set("z",this.BASE_ZINDEX),t}),this).value();var t=this.moveToFixLayers(1,{fixOnlyBad:!0}),e=this.moveToAboveAllLayers(),i=this.normalizeZIndexes();(t||i||e)&&this.save({silent:!0,skipHistory:!0})}}),10),moveToFixLayers:function(t,e){var i=!1,n=o.a.filter(this.allModels,(function(t){return!t.get("fixed_position")&&!t.get("hidden")&&!t.get("is_above")}));if(!o.a.isEmpty(n)){var a=o.a.min(n,(function(t){return t.get("z")})).get("z"),r=o.a.max(n,(function(t){return t.get("z")})).get("z"),s=0;o.a.filter(this.allModels,(function(t){return t.get("fixed_position")}));return o.a.chain(this.allModels).filter((function(e){return e.get("fixed_position")&&(t>0?e.get("z")>a:e.get("z")<r)})).sortBy((function(t){return t.get("z")})).each((function(n){if(!(e&&e.fixOnlyBad&&(n.get("z")<a||n.get("z")>r))){var o=t>0?1e4:-1e4;if(e&&e.fixOnlyBad){s++;var l=(t>0?r:a)+1e-4*s*(t>0?1:-1);n.set("z",l,{first:!0})}else n.set("z",o+n.get("z"),{first:!0});i=!0}})),i}},moveToAboveAllLayers:function(){var t=[],e=o.a.filter(this.allModels,(function(t){return!t.get("is_above")&&!t.get("hidden")}));o.a.filter(this.allModels,(function(t){return t.get("is_above")&&!t.get("hidden")}));if(!o.a.isEmpty(e)){var i=o.a.max(e,(function(t){return t.get("z")})).get("z");return o.a.chain(this.allModels).filter((function(t){return t.get("is_above")&&t.get("z")<i})).each((function(e){e.set("z",2e4+e.get("z"),{first:!0}),t.push(e)})),o.a.isEmpty(t)||o.a.chain(this.allModels).filter((function(e){return e.get("is_above")&&-1==t.indexOf(e)})).each((function(t){t.set("z",2e4+t.get("z"),{first:!0})})),!o.a.isEmpty(t)}},restrictions:function(t){return t.getSelectableBlocks().length>1},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-common_layer")}))},bindLogic:function(){this.$panel.on("click",".forward",this.forward),this.$panel.on("click",".backward",this.backward),this.$panel.on("click",".forward-all",this.forwardAll),this.$panel.on("click",".backward-all",this.backwardAll),RM.constructorRouter.bindGlobalKeyPress([{key:"[",handler:this.backward,optionKeys:Modernizr.mac?"meta":"ctrl"},{key:"]",handler:this.forward,optionKeys:Modernizr.mac?"meta":"ctrl"},{key:"[",handler:this.backwardAll,optionKeys:Modernizr.mac?["alt","meta"]:["alt","ctrl"]},{key:"]",handler:this.forwardAll,optionKeys:Modernizr.mac?["alt","meta"]:["alt","ctrl"]}])},unBindLogic:function(){this.$panel.off("click",".forward",this.forward),this.$panel.off("click",".backward",this.backward),this.$panel.off("click",".forward-all",this.forwardAll),this.$panel.off("click",".backward-all",this.backwardAll),RM.constructorRouter.unbindGlobalKeyPress("[",this.backward),RM.constructorRouter.unbindGlobalKeyPress("]",this.forward),RM.constructorRouter.unbindGlobalKeyPress("[",this.backwardAll),RM.constructorRouter.unbindGlobalKeyPress("]",this.forwardAll)},forward:function(t){RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","bring forward"),Object(n.a)("constructor.zIndex")?(RM.constructorRouter.indexController.moveWidget(this.master.workspace.page,this.selectedModels,1),this.save()):this._move(1)},backward:function(t){RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","bring backward"),Object(n.a)("constructor.zIndex")?(RM.constructorRouter.indexController.moveWidget(this.master.workspace.page,this.selectedModels,-1),this.save()):this._move(-1)},forwardAll:function(t){RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","send to front"),Object(n.a)("constructor.zIndex")?(RM.constructorRouter.indexController.moveWidget(this.master.workspace.page,this.selectedModels,999),this.save()):this._move(999,!0)},backwardAll:function(t){RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","send to back"),Object(n.a)("constructor.zIndex")?(RM.constructorRouter.indexController.moveWidget(this.master.workspace.page,this.selectedModels,-999),this.save()):this._move(-999,!0)},_getBlocks:function(){var t={},e={};return{groupLayers:e,blocks:Object(o.a)(this.master.workspace.blocks).chain().filter((function(t){return"background"!=t.model.get("type")})).sortBy((function(t){return t.model.get("z")})).reduce((function(e,i){var n=i.model.get("pack_id");return n?t[n]?t[n].push(i):(t[n]=[i],e.push(t[n])):e.push(i),e}),[]).reduce((function(t,i){for(var n=t[t.length-1],o=i;n instanceof Array;)n=n[n.length-1];for(;o instanceof Array;)o=o[o.length-1];return!n||!!n.model.get("is_above")==!!o.model.get("is_above")&&!!n.model.get("fixed_position")==!!o.model.get("fixed_position")?(n||(o.model.get("is_above")?e.above_all=t[t.length-1]:o.model.get("fixed_position")?e.regular?e.fixed_top=t[t.length-1]:e.fixed_bottom=t[t.length-1]:e.regular=t[t.length-1]),t[t.length-1].push(i)):(t.push([i]),o.model.get("is_above")?e.above_all=t[t.length-1]:o.model.get("fixed_position")?e.regular?e.fixed_top=t[t.length-1]:e.fixed_bottom=t[t.length-1]:e.regular=t[t.length-1]),t}),[[]]).value(),packs:t}},_getBlockGroup:function(t,e){if(-1!=t.indexOf(e))return t;var i=null;return o.a.each(t,(function(t){t instanceof Array&&(i=i||this._getBlockGroup(t,e))}),this),i},_recalcZindex:function(t){var e=o.a.flatten(t),i=100,n=[];return o.a.each(e,(function(t){t.model.get("z")!=i&&(t.model.set("z",i),n.push({_id:t.model.get("_id"),z:i})),i++})),n},_checkForMovedGroup:function(t,e){if(!t.model.get("pack_id"))return t;var i=this._getBlockGroup(e,t),n=!0;return o.a.each(i,(function(t){n=n&&t.selected})),n?i:t},_move:function(t,e){for(var i=this._getBlocks(),n=i.blocks,a=i.packs,r=[],s=o.a.chain(this.blocks.slice()).sortBy((function(t){return t.model.get("z")})).reduce((function(t,e,i){if(-1!==r.indexOf(e))return t;r.push(e);var n=e.model.get("pack_id");if(n){var s=!0;o.a.each(a[n],(function(t){s=s&&t.selected})),s?(t.push(a[n]),r=r.concat(a[n])):t.push(e)}else t.push(e);return t}),[]).value();s&&s.length;){var l=s[0],c=this._getBlockGroup(n,l),d=o.a.reduce(c,(function(t,e,i){return-1!=s.indexOf(e)&&c[i-1]&&-1!=s.indexOf(c[i-1])?t[t.length-1].push(e):-1!=s.indexOf(e)&&t.push([e]),t}),[[]]),h=o.a.find(d,(function(t){return-1!=t.indexOf(l)})),u=c.indexOf(h[0]);c.splice(u,h.length);var p=u+t;p<0&&(c==i.groupLayers.fixed_top?(i.groupLayers.fixed_bottom||(i.groupLayers.fixed_bottom=[],n.splice(0,0,i.groupLayers.fixed_bottom)),c=i.groupLayers.fixed_bottom,p=e?0:c.length):p=0),p>c.length&&(c==i.groupLayers.fixed_bottom?(i.groupLayers.fixed_top||(i.groupLayers.fixed_top=[],i.groupLayers.above_all?n.splice(n.length-1,0,i.groupLayers.fixed_top):n.push(i.groupLayers.fixed_top)),c=i.groupLayers.fixed_top,p=e?c.length:0):p=c.length),Array.prototype.splice.apply(c,[p,0].concat(h)),s=o.a.difference(s,h)}this.allModels=this._recalcZindex(n),this.save()},save:function(t){var e=(t=t||{}).success;t.success=o.a.bind((function(t){this._saving=!1,e&&e(t),this._saveOptions&&(this.save(this._saveOptions),this._saveOptions=null)}),this),this._saving?this._saveOptions=t:(t.skipInitial=!0,this._saving=!0,Object(n.a)("constructor.zIndex")?this.master.workspace.page.save(null,t):this.master.workspace.save_group(this.allModels,t))}}),c=i("j6/F"),d=i.n(c),h=a.a.extend({name:"common_align",className:"control common_align",initialize:function(t){this.template=d.a["template-constructor-control-common_align"],this.initControl(t)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-common_align")}))},bindLogic:function(){this.$panel.on("click","div",this.storeFixed),this.$panel.on("click",".left",this.left),this.$panel.on("click",".top",this.top),this.$panel.on("click",".bottom",this.bottom),this.$panel.on("click",".right",this.right),this.$panel.on("click",".center",this.center),this.$panel.on("click",".middle",this.middle),this.$panel.on("click","div",this.restoreFixed)},storeFixed:function(){o.a.invoke(this.blocks,"storeFixedPosition")},restoreFixed:function(){o.a.invoke(this.blocks,"restoreFixedPosition"),this.master.workspace.save_group(o.a.pluck(this.blocks,"model"))},setParam:function(t,e){var i=o.a.map(this.blocks,(function(i){var n={_id:i.model.id};return n[t]=o.a.isFunction(e)?e(i):e,n}));this.master.workspace.set_group(i)},restrictions:function(t){var e=t.getSelectedBlocks().length>1,i=Object(o.a)(t.getSelectedBlocks()).chain().map((function(t){return t.model.get("fixed_position")})).compact().uniq().value().length<=1;return e&&i},getPacksDimensions:function(t){var e={},i=1===o.a.chain(t).map((function(t){return t.model.get("pack_id")})).uniq().value().length;return o.a.each(t,(function(t){var n=t.model.get("pack_id");if(n&&!i){e[n]=e[n]||{t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY};var o=e[n],a=t.getBoxData({includeBoundingBox:!0});o.t=Math.min(o.t,a.bb_y),o.l=Math.min(o.l,a.bb_x),o.b=Math.max(o.b,a.bb_y+a.bb_h),o.r=Math.max(o.r,a.bb_x+a.bb_w)}})),o.a.each(e,(function(t){t.x=t.l,t.y=t.t,t.w=t.r-t.l,t.h=t.b-t.t,delete t.t,delete t.l,delete t.b,delete t.r})),e},top:function(t){var e=this.getPacksDimensions(this.blocks),i=Math.min.apply(null,o.a.map(this.blocks,(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],n=t.getBoxData({includeBoundingBox:!0});return i?i.y:n.bb_y})));this.setParam("y",(function(t){var n=t.model.get("pack_id")&&e[t.model.get("pack_id")],o=t.getBoxData({includeBoundingBox:!0});return n?o.y+(i-n.y):i-(o.bb_y-o.y)}))},left:function(t){var e=this.getPacksDimensions(this.blocks),i=Math.min.apply(null,o.a.map(this.blocks,(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],n=t.getBoxData({includeBoundingBox:!0});return i?i.x:n.bb_x})));this.setParam("x",(function(t){var n=t.model.get("pack_id")&&e[t.model.get("pack_id")],o=t.getBoxData({includeBoundingBox:!0});return n?o.x+(i-n.x):i-(o.bb_x-o.x)}))},right:function(t){var e=this.getPacksDimensions(this.blocks),i=Math.max.apply(null,o.a.map(this.blocks,(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],n=t.getBoxData({includeBoundingBox:!0});return i?i.x+i.w:n.bb_x+n.bb_w})));this.setParam("x",(function(t){var n=t.model.get("pack_id")&&e[t.model.get("pack_id")],o=t.getBoxData({includeBoundingBox:!0});return n?o.x+(i-n.w-n.x):i-(o.bb_w-(o.bb_w-o.w)/2)}))},bottom:function(t){var e=this.getPacksDimensions(this.blocks),i=Math.max.apply(null,o.a.map(this.blocks,(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],n=t.getBoxData({includeBoundingBox:!0});return i?i.y+i.h:n.bb_y+n.bb_h})));this.setParam("y",(function(t){var n=t.model.get("pack_id")&&e[t.model.get("pack_id")],o=t.getBoxData({includeBoundingBox:!0});return n?o.y+(i-n.h-n.y):i-(o.bb_h-(o.bb_h-o.h)/2)}))},middle:function(t){var e=this.getPacksDimensions(this.blocks),i=o.a.map(this.blocks,(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],n=t.getBoxData({includeBoundingBox:!0});return i?i.y+i.h/2:n.bb_y+n.bb_h/2})),n=i[Math.floor(i.length/2)];this.setParam("y",(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],o=t.getBoxData({includeBoundingBox:!0});return i?o.y+(n-i.h/2-i.y):n-o.h/2}))},center:function(t){var e=this.getPacksDimensions(this.blocks),i=0,n=0,a=o.a.map(this.blocks,(function(t,o){var a=t.model.get("pack_id")&&e[t.model.get("pack_id")],r=t.getBoxData({includeBoundingBox:!0}),s=a?a.w:r.bb_w;return(t.isFullWidth()||s>i)&&(i=s,n=o),a?a.x+a.w/2:r.bb_x+r.bb_w/2}))[n];this.setParam("x",(function(t){var i=t.model.get("pack_id")&&e[t.model.get("pack_id")],n=t.getBoxData({includeBoundingBox:!0});return i?n.x+(a-i.w/2-i.x):a-n.w/2}))}}),u=i("xi34"),p=i("q1z7"),m=i.n(p),g=a.a.extend({MIN_PANEL_HEIGHT:100,MAX_PANEL_HEIGHT:672,PANEL_MARGIN:20,SCROLL_GAP_START:16,SCROLL_GAP_END:16,render:function(){this.panelSizes={resizable:this.getControlParam("height")||this.MIN_PANEL_HEIGHT},a.a.prototype.render.apply(this,arguments),this.$el.addClass("control-resizable"),this.resizableScroll=Object(u.a)(this.$el.find(".resizable-scroll-wrapper")).RMScroll({$container:this.$el.find(".resizable-content-wrapper"),$content:this.$el.find(".resizable-content"),$handle:this.$el.find(".resizable-scroll"),wheelScrollSpeed:.4,gap_start:this.SCROLL_GAP_START,gap_end:this.SCROLL_GAP_END,onScroll:this.onPanelScroll}).data("scroll"),this.__scrollRecalc_debounced=o.a.debounce(o.a.bind((function(){this.resizableScroll.recalc(),this.onScrollRecalc("control-resize")}),this),300),Object(u.a)(this.$(".resize-handle-top")).RMDrag({start:this.startHandleDrag,move:this.moveHandleDrag,end:this.endHandleDrag,silent:!0,preventDefault:!0}),Object(u.a)(this.$(".resize-handle-bottom")).RMDrag({start:this.startHandleDrag,move:this.moveHandleDrag,end:this.endHandleDrag,silent:!0,preventDefault:!0}),this.updatePanelHeight()},onResize:function(t){this.updatePanelHeight()},updatePanelHeight:function(t){if(!this.destroyed){if(t=t||this.panelSizes[this.fixedPanelSize?"fixed":"resizable"],!this.fixedPanelSize){var e=2*Math.ceil(this.MIN_PANEL_HEIGHT/2),i=2*Math.ceil(this.MAX_PANEL_HEIGHT/2),n=Object(u.a)(window).height()-2*this.PANEL_MARGIN,o=2*Math.ceil(n/2);t=Math.max(t,e),t=Math.min(t,i),t=Math.min(t,o)}if(this.$panel.height(t),this.panelSizes[this.fixedPanelSize?"fixed":"resizable"]=t,this.fixedPanelSize)this.$panel.css("top",-Math.ceil((t-this.master.ICON_HEIGHT)/2));else{var a=parseInt(this.$el.css("top"));this.$panel.css("top",-Math.ceil(t/2)-a)}this.fixedPanelSize||this.__scrollRecalc_debounced&&this.__scrollRecalc_debounced()}},startHandleDrag:function(t){var e=Object(u.a)(t.currentTarget);this.resizeParams={$handle:e,dir:e.hasClass("resize-handle-top")?-1:1,initial_h:this.panelSizes.resizable},e.addClass("dragging"),this.$panel.addClass("no-transitions")},moveHandleDrag:function(t){var e=this.resizeParams.initial_h+t.deltaY*this.resizeParams.dir*2;this.updatePanelHeight(e),this.resizableScroll&&this.resizableScroll.recalc(),this.onScrollRecalc("control-resize")},endHandleDrag:function(t){this.resizeParams.$handle.removeClass("dragging"),this.$panel.removeClass("no-transitions")},toggleFixedPanelSize:function(t,e){this.fixedPanelSize=t,this.$(".resize-handle-top").toggle(!t),this.$(".resize-handle-bottom").toggle(!t),this.updatePanelHeight(t?e:this.panelSizes.resizable)},onScrollRecalc:function(t){},onPanelScroll:function(){},select:function(){a.a.prototype.select.apply(this,arguments),this.resizableScroll&&this.resizableScroll.recalc(),this.onScrollRecalc("control-show"),this.resizeScrollBinded||(Object(u.a)(window).on("resize",this.onResize),this.resizeScrollBinded=!0)},deselect:function(){a.a.prototype.deselect.apply(this,arguments),this.$panel&&(this.panelSizes.resizable!=this.getControlParam("height")&&this.saveControlParam({height:this.panelSizes.resizable}),Object(u.a)(window).off("resize",this.onResize),this.resizeScrollBinded=!1)},destroy:function(){this.panelSizes.resizable!=this.getControlParam("height")&&this.saveControlParam({height:this.panelSizes.resizable}),Object(u.a)(window).off("resize",this.onResize),this.resizeScrollBinded=!1,a.a.prototype.destroy.apply(this,arguments)}}),f=i("j0jp"),v=i.n(f),b=i("roQd"),y=i("onY4"),_=i("OTSC"),w=i("q7tt"),k=i("q5gH"),S=i("wHgl"),x=i.n(S),C=w.a.extend({controls:[],initialize:function(t){o.a.extend(this,t),this.uuid=t.uuid,this.isStandalone=!0,this.proportional=!0,this.resizeFromCenter=!0,this.addButtonTemplate=x.a["template-constructor-helpers-animation_steps_add_button"],this.frameClass=k.a.extend({minwidth:0,minheight:0}),this.initBlock(this.model,this.workspace)},render:function(){this.create(),this.$el.addClass("animation-step"),this.$mainContent=this.$(".content"),this.$addButton=Object(u.a)(this.addButtonTemplate()),this.$addButton.find('.effect-popup-item[data-value="use_rotate"]').toggle(!this.hideRotateEffect),this.$addButton.on("click",".effect-popup-item",this.addStepWithEffectClick),this.$el.append(this.$addButton),this.$mainContent.addClass("main-content")},addStepWithEffectClick:function(t){this.trigger("add-step",Object(u.a)(t.currentTarget).attr("data-value")),t.stopPropagation()},select:function(){w.a.prototype.select.apply(this,arguments),this.updateAddButtonPos()},setContent:function(t){this.$innerContent=t,this.$innerContent.addClass("fantoms"),this.$mainContent.html(this.$innerContent),this.redrawOpacity(),this.redrawScale()},show:function(){this.$el.show()},hide:function(){this.$el.hide()},onClick:function(){this.selected||this.select()},flashTransitions:function(){clearTimeout(this.flashTransitionsTimeout),this.$el.addClass("animation-transitions"),this.flashTransitionsTimeout=setTimeout(o.a.bind((function(){this.$el.removeClass("animation-transitions")}),this),200)},redrawOpacity:function(){this.$innerContent&&this.$innerContent.css({opacity:this.model.get("opacity")/100})},redrawScale:function(){this.$innerContent&&_.default.applyTransform(this.$innerContent,100==this.model.get("scale")?"":"scale("+this.model.get("scale")/100+")")},updateAddButtonPos:function(){if(this.selected&&this.$addButton){var t=RM.constructorRouter.zoom.getZoom(),e=o.a.extend({},this.latestPosSizeAngle,{width:this.latestPosSizeAngle.width*t,height:this.latestPosSizeAngle.height*t}),i=e.height+18,n=e.width/2,a=e.height/2,r=a-i,s=n+e.sinAngle*r;i=a-e.cosAngle*r,this.$addButton.css({left:Math.round(s),top:Math.round(i),zoom:1/RM.constructorRouter.zoom.getZoom()}),_.default.applyTransform(this.$addButton,"");var l=this.$addButton.offset(),c=l.top+15,d=l.left+15,h=0,p=0,m=Object(u.a)(window).height(),g=Object(u.a)(window).width();c<32?h=c-32:c>m-32&&(h=c-(m-32)),d<32?p=d-32:d>g-32&&(p=d-(g-32)),(h||p)&&_.default.applyTransform(this.$addButton,"translate("+Math.round(-p)+"px, "+Math.round(-h)+"px)")}},updateAddButtonPopupPos:function(){if(this.$addButton&&this.selected){var t=this.$addButton.offset(),e=t.top+15,i=t.left+15,n=Object(u.a)(window).height(),o=Object(u.a)(window).width(),a=this.$addButton.find(".effect-popup"),r=a.height(),s=a.width();a.css("margin-top","").find(".corner-wrapper").css("margin-top",""),i>12+s/2&&i<o-s/2?e>12+r+15+15?a.attr("data-pos","top"):a.attr("data-pos","bottom"):(i<o/2?a.attr("data-pos","right"):a.attr("data-pos","left"),e<r/2+12&&a.css("margin-top",r/2+12-e).find(".corner-wrapper").css("margin-top",-(r/2+12-e)),e>n-(r/2+12)&&a.css("margin-top",-(e-n+r/2+12)).find(".corner-wrapper").css("margin-top",e-n+r/2+12))}},css:function(){w.a.prototype.css.apply(this,arguments),this.updateAddButtonPos()},redraw:function(){this.$mainContent&&(this.redrawOpacity(),this.redrawScale(),w.a.prototype.redraw.apply(this,arguments))}}),O=m.a.View.extend({className:"animation-steps-container",StepModel:m.a.Model.extend({save:function(){return this.set.apply(this,arguments),null},sync:function(){return null},getViewport:function(){return self.blocks[0].model.getViewport()},getAnimations:function(){return[]}}),initialize:function(t){o.a.bindAll(this),o.a.extend(this,t),this.someModel=this.blocks[0].model,this.workspace.switchOnAnimationMode(this),this.$el.appendTo(this.workspace.$el.children().first()),this.$workspaceScroll=this.workspace.$el.parent(),Object(u.a)(this.$el).drag("start",(function(t){t.stopPropagation()})),this.$stepsLinesWrapper=Object(u.a)('<div class="steps-lines-wrapper">'),this.$el.append(this.$stepsLinesWrapper),this.$previewAnimator=Object(u.a)('<div class="preview-animator">'),this.$el.append(this.$previewAnimator),this.popupManager.addPopup({$parent:this.$el,name:"add-step-selector",selector:".block .add-button",popupSelector:".block .add-button .effect-popup",cbOpen:function(t){this.currentStep&&this.currentStep.updateAddButtonPopupPos(),o.a.each(this.blocks,(function(e){e.trigger("animation:stepsPopup:open",t)}))}.bind(this),cbClose:function(){o.a.each(this.blocks,(function(t){t.trigger("animation:stepsPopup:closed")}))}.bind(this)}),this.updateContainerDims(),this.updateFantoms(),this.updateSteps(),o.a.each(this.blocks,(function(t){t.toggleAnimationMode(!0)})),this.$previewAnimator.css({visibility:"hidden"}),this.isPreviewMode=!1,Object(u.a)(window).on("resize",this.onResize),this.$workspaceScroll.on("scroll",this.onWorkspaceScroll)},startPreviewMode:function(){this.isPreviewMode||(this.isPreviewMode=!0,this.$previewAnimator.css({visibility:"inherit"}),this.$stepsLinesWrapper.css({visibility:"hidden"}),this.updatePreviewMode({immediate:!0}))},updatePreviewMode:function(t){if(t=t||{},this.isPreviewMode){var e=RM.constructorRouter.workspace.page.getCurrentViewport(),i=RM.constructorRouter.workspace.mag.getViewportWidth(e),n=RM.constructorRouter.workspace.mag.get("opts"),o=this;clearTimeout(this.updatePreviewModeTimeout),t.immediate?a():this.updatePreviewModeTimeout=setTimeout(a,500)}function a(){o.previewTimeline&&o.previewTimeline.destroy();var t=b.a.getNormalizedAnimation(o.uuid?o.someModel.getAnimations().find((function(t){return t.UUID===o.uuid})):o.someModel.getAnimations()[0],o.isFixed,o.isFullwidth,o.isFullheight,RM.constructorRouter.zoom.getZoom(),e,i,n);o.previewTimeline=b.a.createAnimationTimeline({el:o.$previewAnimator,steps:t.steps,type:t.type,force3d:!1,loop:b.a.normalizeLoopValue(t.loop),animationTrigger:t.trigger,screenshotMode:!1}),"scroll"!=t.type?o.previewTimeline.play():o.onWorkspaceScroll()}},stopPreviewMode:function(){this.isPreviewMode&&(this.isPreviewMode=!1,this.$previewAnimator.css({visibility:"hidden"}),this.$stepsLinesWrapper.css({visibility:"inherit"}),this.previewTimeline&&this.previewTimeline.destroy())},togglePreviewMode:function(){this.isPreviewMode?this.stopPreviewMode():this.startPreviewMode()},onWorkspaceScroll:function(){var t=this;if(this.currentStep&&this.currentStep.updateAddButtonPos(),this.previewTimeline&&this.isPreviewMode){var e=this.uuid?this.someModel.getAnimations().find((function(e){return e.UUID===t.uuid})):this.someModel.getAnimations()[0];if("scroll"===e.type&&e){var i=Math.max(0,this.$workspaceScroll.scrollTop()),n=RM.constructorRouter.zoom.getZoom();if(this.isFixed)this.previewTimeline.seek(i);else{var o=this.baseDimensions.top,a=o-this.$workspaceScroll.height()/n,r={top:1,center:.5,bottom:0}[e.steps[0].start_point||"bottom"]*(o-a)+a+e.steps[0].start_offset||0;r<=0?this.previewTimeline.seek(i/n):this.previewTimeline.seek(Math.max(0,i-r*n)/n)}}}},updateContainerDims:function(){var t;o.a.each(this.blocks,(function(e){var i=e.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0});(t=t||{t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY}).t=Math.min(t.t,i.bb_y),t.l=Math.min(t.l,i.bb_x),t.b=Math.max(t.b,i.bb_y+i.bb_h),t.r=Math.max(t.r,i.bb_x+i.bb_w)}),this),this.baseDimensions={left:t.l+(this.isFixed?this.workspace.position.left:0),top:t.t+(this.isFixed?this.workspace.position.top:0),width:t.r-t.l,height:t.b-t.t},this.$el.css({width:t.r-t.l,height:t.b-t.t,position:this.isFixed?"fixed":"absolute"}),this.$previewAnimator.css(this.baseDimensions)},createStep:function(t){t=t||{};var e=new C({model:new this.StepModel,workspace:this.workspace,constraintHorzMove:this.isFullwidth,constraintVertMove:this.isFullheight,hideRotateEffect:this.isFullwidth||this.isFullheight,$standaloneContainer:this.$stepsLinesWrapper}),i=this;return e.on("select",(function(){if(i.currentStep=this,i.steps)for(var t=0;t<=i.steps.length;t++){var e=i.$lines&&i.$lines[t]&&i.$lines[t].find("line"),n=t==i.steps.length?i.initialStep:i.steps[t];this!=n?(n.deselect(),e&&e.attr("stroke-dasharray","4,2")):(i.isIndirectSelect||i.trigger("select","initial"==n.model.get("id")?0:n.model.get("id")),e&&e.removeAttr("stroke-dasharray"))}})),e.model.set({id:t.id,is_locked:"initial"==t.id}),e.render(),e.setContent(this.getFantom()),"initial"!=t.id&&e.on("move",o.a.bind((function(t){this.trigger("move",{id:e.model.get("id"),dx:Math.round(t.left-this.baseDimensions.left+(t.width-this.baseDimensions.width)/2),dy:Math.round(t.top-this.baseDimensions.top+(t.height-this.baseDimensions.height)/2)}),this.updateSteps({exceptStep:e})}),this)),e.on("resize",o.a.bind((function(i){"initial"==t.id?this.trigger("scale",{id:0,from_scale:Math.round(100*i.width/this.baseDimensions.width)}):this.trigger("scale",{id:e.model.get("id"),scale:Math.round(100*i.width/this.baseDimensions.width)}),e.model.set({scale:100*i.width/this.baseDimensions.width},{silent:!0}),e.redrawScale(),this.updateSteps({exceptStep:e})}),this)),e.on("add-step",o.a.bind((function(t){this.trigger("add-step",{after_step:e.model.get("id"),use_effect:t}),this.popupManager.closePopup("add-step-selector")}),this)),e},setStepModel:function(t,e){var i=this.baseDimensions,n=i.width*e.scale/100,o=i.height*e.scale/100;t.model.set({x:i.left+i.width/2+e.dx-n/2,y:i.top+i.height/2+e.dy-o/2,w:n,h:o,z:1,angle:e.rotate,opacity:e.opacity,scale:e.scale,aspect:i.width/i.height},{silent:!0}),t.redraw(t.model)},getFantom:function(t){var e=t?t.$el.clone():this.$fantoms.clone();if(t&&"picture"===t.model.get("type")&&t.model.get("picture")){var i=t.model.get("picture"),n=t.useLambdaUrl&&t.useLambdaUrl()?t.getLambdaUrl():i.unscaledOptimizedUrl||i.unscaledUrl||i.url;n&&e.find(".content div").css("background-image","url(".concat(n,")"))}var o=[];if(e.find("defs mask, defs clippath").each((function(){o.push(Object(u.a)(this).attr("id"))})),t&&"hotspot"===t.model.get("type")&&e.find(".tip").remove(),e.find(".size-tool").remove(),e.find(".animation-trigger-tooltip").remove(),o.length){for(var a=e[0].outerHTML,r=0;r<o.length;r++){var s=_.default.generateUUID(),l=new RegExp("("+_.default.escapeSpecial(o[r],!1)+")","g");a=a.replace(l,s)}e=Object(u.a)(a)}return e},updateFantoms:function(){this.$fantoms&&this.$fantoms.remove(),this.$fantoms=Object(u.a)("<div>").css({position:"relative",left:0,top:0,width:this.baseDimensions.width,height:this.baseDimensions.height}),o.a.each(this.blocks,o.a.bind((function(t){var e=this.getFantom(t);e.find(".frameborder").remove(),e.find(".animation-trigger-tooltip").remove(),e.removeClass("animation-mode"),this.isFixed?e.css({position:"absolute",left:"50%",top:"50%",bottom:"",right:"","margin-left":-t.model.get("w")/2,"margin-top":-t.model.get("h")/2}):e.css({left:"-="+this.baseDimensions.left,top:"-="+this.baseDimensions.top}),this.$fantoms.append(e)}),this)),this.$previewAnimator.html(this.getFantom())},updateSteps:function(t){var e=this;this.updateLines(),t=t||{};var i=RM.constructorRouter.workspace.page.getCurrentViewport(),n=b.a.getNormalizedAnimation(this.uuid?this.someModel.getAnimations().find((function(t){return t.UUID===e.uuid})):this.someModel.getAnimations()[0],this.isFixed,this.isFullwidth,this.isFullheight,1,i,RM.constructorRouter.workspace.mag.getViewportWidth(i),RM.constructorRouter.workspace.mag.get("opts"));this.initialStep=this.initialStep||this.createStep({id:"initial"}),0===t.animateStepInd&&this.initialStep.flashTransitions(),t.exceptStep!=this.initialStep&&this.setStepModel(this.initialStep,{dx:0,dy:0,opacity:n.steps[0].from_opacity,rotate:n.steps[0].from_rotate,scale:n.steps[0].from_scale}),this.steps=this.steps||[];for(var o=0;o<n.steps.length;o++)this.steps[o]=this.steps[o]||this.createStep({id:o}),null!=t.animateStepInd&&t.animateStepInd<=o&&this.steps[o].flashTransitions(),t.exceptStep!=this.steps[o]&&this.setStepModel(this.steps[o],n.steps[o]);for(o=n.steps.length;o<this.steps.length;o++)this.steps[o].model.destroy(),this.steps[o].destroy(),this.steps[o].off();this.steps.length=n.steps.length},updateLines:function(){var t=this,e=0,i=0;this.$lines=this.$lines||[];for(var n=RM.constructorRouter.workspace.page.getCurrentViewport(),o=b.a.getNormalizedAnimation(this.uuid?this.someModel.getAnimations().find((function(e){return e.UUID===t.uuid})):this.someModel.getAnimations()[0],this.isFixed,this.isFullwidth,this.isFullheight,1,n,RM.constructorRouter.workspace.mag.getViewportWidth(n),RM.constructorRouter.workspace.mag.get("opts")),a=0;a<o.steps.length;a++){this.$lines[a]||(this.$lines[a]=Object(u.a)('<svg class="step-line"><line /></svg>'),this.$lines[a].appendTo(this.$stepsLinesWrapper));var r=o.steps[a],s=this.$lines[a].find("line").get(0),l=this.baseDimensions.width/2+e,c=this.baseDimensions.height/2+i,d=this.baseDimensions.width/2+r.dx,h=this.baseDimensions.height/2+r.dy,p=Math.abs(l-d)+8,m=Math.abs(c-h)+8;this.$lines[a].css({width:p,height:m,left:this.baseDimensions.left+Math.min(l,d)-4,top:this.baseDimensions.top+Math.min(c,h)-4}),this.$lines[a].show(),s.setAttributeNS(null,"x1",4),s.setAttributeNS(null,"x2",p-4),l<d&&c<h||l>d&&c>h?(s.setAttributeNS(null,"y1",4),s.setAttributeNS(null,"y2",m-4)):(s.setAttributeNS(null,"y1",m-4),s.setAttributeNS(null,"y2",4)),e=r.dx,i=r.dy}for(a=o.steps.length;a<this.$lines.length;a++)this.$lines[a].hide()},selectStep:function(t){this.isIndirectSelect=!0,this.steps[t].select(),this.isIndirectSelect=!1},moveSelected:function(t,e){var i=o.a.filter(o.a.union(this.steps,this.initialStep),(function(t){return!t.isLocked()&&t.selected}));if(!o.a.isEmpty(i)&&!(this.isFullwidth&&Object(o.a)(["left","right"]).contains(e)||this.isFullheight&&Object(o.a)(["up","down"]).contains(e))){var n=t.shiftKey?10:1,a=RM.constructorRouter.gg.snap;RM.constructorRouter.gg.snap=!1;var r={deltaY:0,deltaX:0};switch(e){case"up":r.deltaY=-n;break;case"right":r.deltaX=n;break;case"down":r.deltaY=n;break;case"left":r.deltaX=-n}C.prototype.moveBlocks(null,i,r),RM.constructorRouter.gg.snap=a,t.stopPropagation(),t.preventDefault()}},removeSelected:function(){var t=o.a.filter(o.a.union(this.steps,this.initialStep),(function(t){return t.selected}));o.a.isEmpty(t)||this.trigger("remove-step",t[0].model.get("id"))},onResize:function(){(this.isFullwidth||this.isFullheight||this.isFixed||this.isSticked)&&(this.updateContainerDims(),this.updateSteps()),this.isFullwidth&&(clearTimeout(this.updateFantomsTimer),this.updateFantomsTimer=setTimeout(o.a.bind((function(){this.updateFantoms(),this.initialStep.setContent(this.getFantom());for(var t=0;t<this.steps.length;t++)this.steps[t].setContent(this.getFantom())}),this),100)),this.onWorkspaceScroll()},destroy:function(){if(this.stopPreviewMode(),o.a.each(this.blocks,(function(t){t.toggleAnimationMode(!1)})),this.$fantoms&&this.$fantoms.remove(),this.initialStep&&(this.initialStep.model.destroy(),this.initialStep.destroy(),this.initialStep.off()),this.steps)for(var t=0;t<this.steps.length;t++)this.steps[t].model.destroy(),this.steps[t].destroy(),this.steps[t].off();this.remove(),this.workspace.switchOffAnimationMode(),Object(u.a)(window).off("resize",this.onResize),this.$workspaceScroll.off("scroll",this.onWorkspaceScroll)}}),j=i("SUqF"),P=i("/Sry");function E(t){return function(t){if(Array.isArray(t))return I(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return I(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return I(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function T(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function M(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?T(Object(i),!0).forEach((function(e){$(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function $(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var A=g.extend({name:"common_animation",className:"control common_animation",MIN_PANEL_HEIGHT:560,MAX_PANEL_HEIGHT:640,DISABLED_HEIGHT:138,DISABLED_HEIGHT_RESET:138,MESSAGE_MIXED_HEIGHT:128,MESSAGE_MULTIPLE_HEIGHT:112,MESSAGE_NON_ANIMATABLE_HEIGHT:96,MESSAGE_UNITE_HEIGHT:160,DEFAULT_ANIMATION_STEP:{duration:.5,delay:0,speed:1,delay_px:0,dx:void 0,dy:void 0,opacity:void 0,rotate:void 0,scale:void 0,acceleration:"none",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:100,use_move:!1,use_opacity:!1,use_rotate:!1,use_scale:!1},PRESETS:{"fade-and-scale":{loop:!1,selected:0,steps:[{duration:1.2,delay:0,speed:1,delay_px:0,opacity:100,scale:100,acceleration:"ease-out",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:80,use_move:!1,use_opacity:!0,use_rotate:!1,use_scale:!0}]},"fade-in":{loop:!1,selected:0,steps:[{duration:1.6,delay:0,speed:1,delay_px:0,opacity:100,scale:100,acceleration:"ease-out",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:80,use_move:!1,use_opacity:!0,use_rotate:!1,use_scale:!1}]},"scale-big":{loop:!1,selected:0,steps:[{duration:.8,delay:0,speed:1,delay_px:0,opacity:100,scale:100,acceleration:"ease-out",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:256,use_move:!1,use_opacity:!0,use_rotate:!1,use_scale:!0}]},"move-and-fade":{loop:!1,selected:0,steps:[{duration:.8,delay:0,speed:1,delay_px:0,dx:0,dy:-32,opacity:100,acceleration:"ease-both",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:100,use_move:!0,use_opacity:!0,use_rotate:!1,use_scale:!1}]},pulse:{loop:"swing",selected:0,steps:[{duration:1.2,delay:0,speed:1,delay_px:0,dx:142,dy:0,scale:90,acceleration:"ease-both",start_point:"bottom",start_offset:0,from_opacity:100,from_rotate:0,from_scale:100,use_move:!1,use_opacity:!1,use_rotate:!1,use_scale:!0}]},rotate:{loop:"repeat",selected:0,steps:[{duration:1.8,delay:0,speed:1,delay_px:0,dx:0,dy:0,rotate:360,acceleration:"none",start_point:"bottom",start_offset:0,from_opacity:100,from_rotate:0,from_scale:100,use_move:!1,use_opacity:!1,use_rotate:!0,use_scale:!1}]}},TRIGGER_COUNT_LIMIT:3,events:{"click .js-trigger-button":"onTriggerButtonClick","click .js-cancel-trigger":"onTriggerCancelClick","click .js-remove-trigger":"onTriggerRemoveClick","mouseenter .js-trigger-name":"onTriggerNameMouseEnter","mouseleave .js-trigger-name":"onTriggerNameMouseLeave","mouseenter .js-remove-trigger":"onTriggerRemoveMouseEnter","mouseleave .js-remove-trigger":"onTriggerRemoveMouseLeave"},initialize:function(t){var e=this;this.typeSelectorTemplate=v.a["template-constructor-control-common_animation-type-popup"],this.template=function(t){return v.a["template-constructor-control-common_animation"](M(M({},t),{},{renderInitialTypePopup:function(){return e.typeSelectorTemplate({isInitial:!0,type:void 0,uuid:void 0,cssClass:"js-change-type-popup",currentType:void 0,availableTypes:b.a.EVENT_TYPES})},renderAddTypePopup:function(){return e.typeSelectorTemplate({isInitial:!1,cssClass:"js-add-animation-popup",type:void 0,uuid:void 0,currentType:void 0,availableTypes:b.a.EVENT_TYPES})}}))},this.step_template=v.a["template-constructor-control-common_animation-step"],this.typeTemplate=v.a["template-constructor-control-common_animation-type"],this.initControl(t),this.isPreviewMode=!1,this.isSwitcherVisible=!1,this.amountOfAnimations=0,this.block=this.blocks&&this.blocks[0],this.someModel=this.models&&this.models[0],this.triggerButtonsState={},this.currentUuid=void 0,this.updateControlState()},bindLogic:function(){this.master.workspace.on("paste-animation",this.onAnimationPaste),this.$loop_types=this.$panel.find(".js-loop-types"),this.$loop_repeat=this.$panel.find(".js-loop-repeat"),this.$loop_swing=this.$panel.find(".js-loop-swing"),this.$displayTypes=this.$panel.find(".js-display-types"),this.$displayTypeReset=this.$panel.find(".js-display-type-reset"),this.$displayTypeOnce=this.$panel.find(".js-display-type-once"),this.$startWhenInView=this.$panel.find(".js-start-when-in-view"),this.$preview_switcher=this.$panel.find(".bottom-block .preview"),this.$steps_container=this.$panel.find(".resizable-content"),this.$step_selector=this.$panel.find(".js-step-selector"),this.$step_selector.find(".js-prev-step").on("click",this.prevStepClick),this.$step_selector.find(".js-next-step").on("click",this.nextStepClick),this.$steps_container.on("click",".param-wrapper.start-block .start-popup-item",this.startItemClick),this.$steps_container.on("click",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemClick),this.$steps_container.on("mouseenter mouseleave",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemMouseEnterLeave),this.$steps_container.on("click",".remove-effect",this.removeEffectClick),this.$steps_container.on("click",".effects-presets-wrapper .effects-item",this.addStepClick),this.$steps_container.on("click",".effects-presets-wrapper .presets-item",this.usePresetClick),this.$steps_container.on("click",".effects-presets-wrapper .presets-item .preview",this.previewPresetClick),this.$panel.on("click",".unite-button",this.uniteClick),this.$loop_repeat.on("click",this.onLoopTypeClick),this.$loop_swing.on("click",this.onLoopTypeClick),this.$displayTypeReset.on("click",this.onDisplayTypeClick),this.$displayTypeOnce.on("click",this.onDisplayTypeClick),this.$startWhenInView.on("click",this.onStartWhenInViewClick),this.$preview_switcher.on("click",this.togglePreviewMode),this.$panel.on("click",".js-type-popup-item",this.typeSelectorItemClick),this.$panel.on("click",".bottom-block .add-effect .effect-popup-item",this.addEffectItemClick),this.$panel.on("click",".js-change-animation",this.onAnimationSelect),this.$panel.on("click",".js-remove-animation",this.onAnimationRemove),this.popupManager=new D,this.popupManager.addPopup({$parent:this.$panel,name:"type-selector",selector:".js-change-type",popupSelector:".js-change-type-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"add-animation",selector:".js-add-animation",popupSelector:".js-add-animation-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"steps",selector:".js-step-selector:not(.one-step)",popupSelector:".js-step-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"add-effect",selector:".bottom-block .add-effect",popupSelector:".bottom-block .effect-popup",cbOpen:this.updateEffectPopupState}),this.popupManager.addPopup({$parent:this.$panel,name:"start-selector",selector:".resizable-content .param-wrapper.start-block",popupSelector:".resizable-content .param-wrapper.start-block .start-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"acceleration-selector",selector:".resizable-content .param-wrapper.acceleration-block",popupSelector:".resizable-content .param-wrapper.acceleration-block .acceleration-popup",cbOpen:this.updateAccelerationPopupState}),RM.constructorRouter.bindGlobalKeyPress([{key:"a",handler:this.onClick}]),this.listenTo(this.someModel,"animation:trigger:add",this.onAnimationTriggerAdd),this.listenTo(this.someModel,"animation:trigger:remove",this.onAnimationTriggerRemove),this.$step_selector.find(".js-step-popup").sortable({items:".js-step-popup-item",distance:10,axis:"y",scrollSpeed:10,containment:"parent",tolerance:"pointer",start:this.onStepsSortStart.bind(this),stop:this.onStepsSortEnd.bind(this)}),Object(u.a)("").add(this.$loop_swing).add(this.$loop_repeat).RMAltText({cssClass:"loop-type-tooltip",offset:-4}),this.$displayTypeOnce.RMAltText({text:"Perform animation only once per user",cssClass:"display-type-tooltip",offset:-4}),this.$displayTypeReset.RMAltText({text:"Reset animation every time a user scrolls to the widget, so it starts again",cssClass:"display-type-tooltip",offset:-4})},unBindLogic:function(){this.master.workspace.off("paste-animation",this.onAnimationPaste),this.$step_selector.find(".js-prev-step").off("click",this.prevStepClick),this.$step_selector.find(".js-next-step").off("click",this.nextStepClick),this.$steps_container.off("click",".param-wrapper.start-block .start-popup-item",this.startItemClick),this.$steps_container.off("click",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemClick),this.$steps_container.off("mouseenter mouseleave",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemMouseEnterLeave),this.$steps_container.off("click",".remove-effect",this.removeEffectClick),this.$steps_container.off("click",".effects-presets-wrapper .effects-item",this.addStepClick),this.$steps_container.off("click",".effects-presets-wrapper .presets-item",this.usePresetClick),this.$steps_container.off("click",".effects-presets-wrapper .presets-item .preview",this.previewPresetClick),this.$panel.off("click",".unite-button",this.uniteClick),this.removeTriggerButtons(),this.$loop_repeat.off("click",this.onLoopTypeClick),this.$loop_swing.off("click",this.onLoopTypeClick),this.$displayTypeReset.off("click",this.onDisplayTypeClick),this.$displayTypeOnce.off("click",this.onDisplayTypeClick),this.$preview_switcher.off("click",this.togglePreviewMode),this.$panel.off("click",".js-type-popup-item",this.typeSelectorItemClick),this.$panel.off("click",".bottom-block .add-effect .effect-popup-item",this.addEffectItemClick),this.popupManager.destroy(),delete this.popupManager,RM.constructorRouter.unbindGlobalKeyPress("a",this.onClick),this.stopListening(this.someModel,"animation:trigger:add"),this.stopListening(this.someModel,"animation:trigger:remove")},onDisplayTypeClick:function(t){var e=this,i=Object(u.a)(t.currentTarget).data("value"),n=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}));"once"===i?this.setAnimation({playOnce:!(null==n?void 0:n.playOnce),resetWhenOutOfView:!1},this.currentUuid):"reset"===i&&this.setAnimation({resetWhenOutOfView:!(null==n?void 0:n.resetWhenOutOfView),playOnce:!1},this.currentUuid),this.updateDisplayType()},updateDisplayType:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid}));this.$displayTypes.toggleClass("checked",Boolean((null==e?void 0:e.playOnce)||(null==e?void 0:e.resetWhenOutOfView))),this.$displayTypeOnce.toggleClass("checked",Boolean(null==e?void 0:e.playOnce)),this.$displayTypeReset.toggleClass("checked",Boolean(null==e?void 0:e.resetWhenOutOfView))},startPreviewMode:function(){this.isPreviewMode||(this.isPreviewMode=!0,this.$preview_switcher.text("Stop").addClass("active"),this.animationSteps&&this.animationSteps.startPreviewMode())},updatePreviewMode:function(){this.isPreviewMode&&this.animationSteps&&this.animationSteps.updatePreviewMode()},stopPreviewMode:function(){this.isPreviewMode&&(this.isPreviewMode=!1,this.$preview_switcher.text("Preview").removeClass("active"),this.animationSteps&&this.animationSteps.stopPreviewMode())},togglePreviewMode:function(){this.isPreviewMode?this.stopPreviewMode():this.startPreviewMode()},onAnimationPaste:function(){this.selected?this.updateAll():this.onClick()},renderStep:function(t,e){var i,n,a=this.block.getAnimationTriggers(this.currentUuid),r=a&&a.length>0,s=this.block.id,l=a&&1===a.length&&a.includes(s);this.isSwitcherVisible=r&&!l&&0===e&&this.doesOpacityHaveDefaultvalues(),i=o.a.extend({index:e,isSwitcherVisible:this.isSwitcherVisible},t),n=Object(u.a)(this.step_template(i)),e>0?this.$steps_container.find(".step").eq(e-1).after(n):this.$steps_container.append(n),n.find("input").each(o.a.bind((function(t,e){var i=Object(u.a)(e).RMNumericInput({onChange:this.onParamInputChange,labelSelector:".units:not(.for-centering)",autoSize:!0}).data("changeValue");Object(u.a)(e).data("cb",i)}),this));var c=n.find(".js-hide-in-editor-switcher");c.length&&c.RMSwitcher({state:i.hideInEditor,height:26,width:44,"color-0":"#0078ff","color-1":"#c9c8c9","text-color-0":"transparent","text-color-1":"transparent"},this.onHidingSwitcherChange.bind(this))},destroyStep:function(t){this.$steps_container.find(".step").eq(t).remove()},destroyAllSteps:function(t){this.$steps_container.find(".step").remove()},updateStepsIndexes:function(){this.$steps_container.find(".step").each((function(t,e){Object(u.a)(e).attr("data-ind",t)}))},prevStepClick:function(t){var e=this;t.stopPropagation(),this.switchStep({updateWorkspaceSelectedStep:!0,cur:(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected||0)-1})},nextStepClick:function(t){var e=this;t.stopPropagation(),this.switchStep({updateWorkspaceSelectedStep:!0,cur:(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected||0)+1})},onStepPopupItemClick:function(t){var e=this,i=Object(u.a)(t.target).closest(".js-step-popup-item"),n=parseInt(i.data("ind"),10);n!==this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected&&this.switchStep({updateWorkspaceSelectedStep:!0,cur:n})},onAnimationStepsSelect:function(t){this.switchStep({updateWorkspaceSelectedStep:!1,cur:t})},onStepsSortStart:function(){this.$(".js-step-popup").addClass("grabbing")},onStepsSortEnd:function(){this.$(".js-step-popup").removeClass("grabbing"),this.reorderSteps()},reorderSteps:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})),i=e.steps,n=e.selected,a=[];o.a.each(this.$step_selector.find(".js-step-popup-item"),function(t,e){var o=Object(u.a)(t).data("ind");o===n&&this.setAnimation({selected:e},this.currentUuid);var r=i[o];a.push(r)}.bind(this)),this.setAnimation({steps:a},this.currentUuid),this.animationSteps&&this.animationSteps.updateSteps(),this.showSelectedStep({updateWorkspaceSelectedStep:!0})},switchStep:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=i.steps.length;t.cur>=n||t.cur<0||(this.setAnimation({selected:t.cur},this.currentUuid,{historyMergeID:"selected",skipPreviewUpdate:!0}),this.showSelectedStep({updateWorkspaceSelectedStep:t.updateWorkspaceSelectedStep}),this.updateLoop(),this.$panel.toggleClass("show-start-condition","load"===i.type&&!t.cur),this.__scrollRecalc_debounced(),RM.analytics&&RM.analytics.sendEvent("Animation Switch Steps"))},addStepClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-value");this.addStep({use_effect:e}),RM.constructorRouter.trigger("notice:triggerMetrics",P.a.CountAnimatedWidgetCreated),RM.analytics&&RM.analytics.sendEvent("Animation Choose Effect",e.split("_").pop())},addStep:function(t){var e=this;t=t||{};var i,n=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps),a=o.a.cloneWithObjects(this.DEFAULT_ANIMATION_STEP),r={};if("initial"!=t.after_step?i=null!=t.after_step?t.after_step+1:n.length:(i=0,r.from_opacity=n[0].from_opacity,r.from_rotate=n[0].from_rotate,r.from_scale=n[0].from_scale,n[0].use_opacity&&(r.use_opacity=!0,r.opacity=n[0].from_opacity),n[0].use_rotate&&(r.use_rotate=!0,r.rotate=n[0].from_rotate),n[0].use_scale&&(r.use_scale=!0,r.scale=n[0].from_scale),o.a.extend(a,r)),n.splice(i,0,a),this.setAnimation({selected:i,steps:n},this.currentUuid),1==n.length)return this.updateAll(),void this.addEffectItem(t.use_effect);this.renderStep(a,i),this.updateStepsIndexes(),this.animationSteps&&this.animationSteps.updateSteps(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}),this.__scrollRecalc_debounced(),this.addEffectItem(t.use_effect),RM.analytics&&RM.analytics.sendEvent("Animation Add Step",i)},usePresetClick:function(t){if(!Object(u.a)(t.target).closest(".preview").length){var e=Object(u.a)(t.currentTarget).attr("data-value");this.setAnimation(this.PRESETS[e],this.currentUuid),this.updateAll(),RM.analytics&&RM.analytics.sendEvent("Animation Use Preset",e)}},previewPresetClick:function(t){},removeStep:function(t){var e=this,i=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps),n={};if((0==t||"initial"==t)&&1==i.length)return this.setAnimation({selected:void 0,steps:[]},this.currentUuid),void this.updateAll();if(0==t&&i.length>1){var a=RM.constructorRouter.workspace.page.getCurrentViewport(),r=b.a.getNormalizedAnimation(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),this.isFixed,this.isFullwidth,this.isFullheight,1,a,RM.constructorRouter.workspace.mag.getViewportWidth(a),RM.constructorRouter.workspace.mag.get("opts"));n.from_opacity=i[0].from_opacity,n.from_rotate=i[0].from_rotate,n.from_scale=i[0].from_scale,i[0].use_opacity&&(n.opacity=r.steps[1].opacity,n.use_opacity=!0),i[0].use_rotate&&(n.rotate=r.steps[1].rotate,n.use_rotate=!0),i[0].use_scale&&(n.scale=r.steps[1].scale,n.use_scale=!0),o.a.extend(i[1],n)}"initial"!=t&&(i.splice(t,1),this.setAnimation({selected:t==i.length?t-1:t,steps:i},this.currentUuid),this.destroyStep(t),this.updateStepsIndexes(),this.animationSteps&&this.animationSteps.updateSteps({animateStepInd:t}),this.showSelectedStep({updateWorkspaceSelectedStep:!0}),this.__scrollRecalc_debounced())},resetClick:function(){this.setAnimation({},this.currentUuid),this.updateAll()},uniteClick:function(){var t={},e=0,i=null;this.models.forEach((function(n){var o=b.a.getUuidHash(n.getAnimations())||"none";t[o]=(t[o]||0)+1,"none"!==o&&t[o]>e&&(i=n,e=t[o])})),this.setAnimations(i.getAnimations(),{skipHistory:!0}),this.updateAll()},onAnimationStepsChange:function(t){var e=this,i=t.id,n=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps),a=!1;delete t.id,n[i]&&(o.a.extend(n[i],t),null==t.dx||n[i].use_move||(n[i].use_move=!0,a=!0),null==t.scale&&null==t.from_scale||n[i].use_scale||(n[i].use_scale=!0,a=!0),this.setAnimation({steps:n},this.currentUuid,{historyMergeID:o.a.keys(t).join("-")}),a&&this.updateCurrentStepParams({visibility:!0}),i==this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected&&this.updateCurrentStepInputs(o.a.keys(t)))},onAnimationSelect:function(t){var e=Object(u.a)(t.currentTarget).data("uuid");this.switchToAnimation(e)},onAnimationRemove:function(t){var e=Object(u.a)(t.currentTarget).data("uuid"),i=this.someModel.getAnimations();if(i.length>1){var n=i.filter((function(t){return t.UUID!==e}));this.setAnimations(n),this.currentUuid===e?this.switchToAnimation(n[n.length-1].UUID):this.updateType()}else this.setAnimations([]),this.updateAll()},typeSelectorItemClick:function(t){var e=Object(u.a)(t.currentTarget).data("uuid")||_.default.generateUUID(),i=Object(u.a)(t.currentTarget).attr("data-value"),n=this.someModel.getAnimations().find((function(t){return t.UUID===e})),o=(n&&n.type)!==i;this.setAnimation({type:i},e),this.switchToAnimation(e,o)},switchToAnimation:function(t,e){var i=this.someModel.getAnimations().find((function(e){return e.UUID===t})),n=i&&i.type,o=this.checkPreviewEnabled(n),a=this.currentUuid!==t||e;if(o)return this.setAnimation({type:n},t),this.popupManager.closePopup("type-selector"),this.updateAll(),this.setAnimation({type:"none"},t),this.someModel.trigger("animation:type:change","none",t),void(this.animationSteps&&this.animationSteps.destroy());this.currentUuid=t,n&&this.setAnimation({type:n},t),this.popupManager.closePopup("type-selector"),a||this.someModel.get("preview_enabled")?this.updateAll():(this.updateType(),this.updateCurrentStepParams({visibility:!0,start:!0,delay:!0,duration:!0,delay_px:!0}),this.updateCurrentStepInputs()),e&&this.someModel.trigger("animation:type:change",n,t),RM.analytics&&RM.analytics.sendEvent("Animation Type Change",n)},addType:function(t){t.preventDefault()},addEffectItemClick:function(t){this.addEffectItem(Object(u.a)(t.currentTarget).attr("data-value")),this.popupManager.closePopup("add-effect")},addEffectItem:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=i.selected||0,a={};if(!i.steps[n][t]){var r=o.a.cloneWithObjects(i.steps),s=RM.constructorRouter.workspace.page.getCurrentViewport(),l=b.a.getNormalizedAnimation(i,this.isFixed,this.isFullwidth,this.isFullheight,1,s,RM.constructorRouter.workspace.mag.getViewportWidth(s),RM.constructorRouter.workspace.mag.get("opts"));r[n][t]=!0,"use_move"==t&&null==r[n].dx&&(a.dx=l.steps[n].dx,a.dy=l.steps[n].dy+10),"use_opacity"==t&&null==r[n].opacity&&(a.opacity=Math.round(l.steps[n].opacity)),"use_rotate"==t&&null==r[n].rotate&&(a.rotate=l.steps[n].rotate+45),"use_scale"==t&&null==r[n].scale&&(a.scale=Math.round(.7*l.steps[n].scale)),o.a.extend(r[n],a),this.setAnimation({steps:r},this.currentUuid),this.updateCurrentStepParams({visibility:!0}),this.animationSteps&&this.animationSteps.updateSteps({animateStepInd:n}),this.__scrollRecalc_debounced(),this.updateCurrentStepInputs()}},removeEffectClick:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=Object(u.a)(t.target).closest(".step").attr("data-ind")-0,a=Object(u.a)(t.currentTarget).attr("data-value"),r=o.a.cloneWithObjects(i.steps);r[n][a]=!1,this.setAnimation({steps:r},this.currentUuid),this.updateCurrentStepParams({visibility:!0}),this.animationSteps&&this.animationSteps.updateSteps({animateStepInd:n}),this.__scrollRecalc_debounced()},onTriggerButtonClick:function(t){var e=Object(u.a)(t.target).closest("[data-id]").data("id"),i=this.getTriggerButtonState(e),n=this.block.id;"none"===i.status?this.updateTriggerButton(e,"pending"):"onOtherPage"===i.status&&i.pageNumber&&(t.stopPropagation(),RM.constructorRouter.once("pageChange",(function(t){setTimeout((function(){var e=o.a.find(t.blocks,(function(t){return t.id==n}));e&&e.onClick()}),0)})),RM.constructorRouter.showWorkspace(i.pageNumber))},onTriggerCancelClick:function(t){var e=Object(u.a)(t.target).closest("[data-id]").data("id");t.stopPropagation(),this.removeTriggerButton(e)},onTriggerRemoveClick:function(t){t.stopPropagation();var e=Object(u.a)(t.target).closest("[data-id]").data("id"),i=this.block.getAnimationTriggers(this.currentUuid);-1!==i.indexOf(e)&&(j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,e,!1,!0),this.setAnimation({trigger:o.a.without(i,e)},this.currentUuid),this.someModel.trigger("animation:trigger:remove",e))},onTriggerNameMouseEnter:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!0,!1)},onTriggerNameMouseLeave:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!1,!1)},onTriggerRemoveMouseEnter:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!0,!0)},onTriggerRemoveMouseLeave:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!1,!0)},onTriggerClick:function(t){this.setAnimation({trigger:this.removeMissingTriggers(this.block.getAnimationTriggers(this.currentUuid)).concat(t)},this.currentUuid),this.someModel.trigger("animation:trigger:add",t),RM.analytics&&RM.analytics.sendEvent("Animation Trigger Click")},onTriggerMouseEnter:function(t){this.highlightPendingTriggerBlock(Object(u.a)(t.target).closest(".block").data("id"),!0)},onTriggerMouseLeave:function(t){this.highlightPendingTriggerBlock(Object(u.a)(t.target).closest(".block").data("id"),!1)},onLoopTypeClick:function(t){var e=this,i=Object(u.a)(t.currentTarget);if(!this.$loop_types.hasClass("disabled")&&!i.hasClass("included")){var n=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),a=n.selected||0,r=o.a.cloneWithObjects(n.steps).map((function(t){return M(M({},t),{},{loop:!1})}));r[a].loop=!i.hasClass("checked")&&i.data("value"),this.setAnimation({steps:r,loop:!1},this.currentUuid),this.updateLoop(),this.updateStepsPopup()}},highlightPendingTriggerBlock:function(t,e){var i=t&&this.master.workspace.findBlock(t);i&&i.highlight(e&&j.a.canBeExternalTrigger(i,this.block),b.a.ACTIVE_TRIGGER_HIGHLIGHT_CLASS)},updateTriggerButtonHandlers:function(t){var e=o.a.map(t,(function(t){return t.status}));switch(-1!==e.indexOf("pending")?"pending":-1!==e.indexOf("active")?"active":"none"){case"pending":this.waitingForTriggerClick=!0,j.a.enterPickTriggerMode(this.master.workspace,this.block,this.block.getAnimationTriggers(this.currentUuid),this.onTriggerClick),this.block.animationMode&&(this.willRestoreAnimationMode=!0,this.destroyAnimationSteps());break;case"active":case"onOtherPage":case"none":o.a.delay(function(){this.waitingForTriggerClick=!1}.bind(this)),j.a.leavePickTriggerMode(this.master.workspace),this.willRestoreAnimationMode&&(this.willRestoreAnimationMode=!1,this.initializeAnimationSteps())}},renderTriggerButton:function(t,e,i){var n=t&&this.master.workspace.findBlock(t),o=n&&1===this.blocks.length&&this.block.id===n.id;return v.a["template-constructor-control-common_animation-trigger"]({id:t,status:e,pageNumber:i,isSelf:o,triggerBlockName:n&&n.model.get("name")||n&&n.getStandardName()||"Trigger"})},getTriggerButtonState:function(t){return this.triggerButtonsState&&this.triggerButtonsState[t]||{}},getStepIndex:function(t){return Object(u.a)(t).closest(".step").attr("data-ind")-0},changeStepField:function(t,e){var i=this,n=this.someModel.getAnimations().find((function(t){return t.UUID===i.currentUuid})),a=o.a.cloneWithObjects(n.steps);o.a.extend(a[t],e),this.setAnimation({steps:a},this.currentUuid)},onStartWhenInViewClick:function(){var t,e,i=this,n=this.someModel.getAnimations().find((function(t){return t.UUID===i.currentUuid}));this.changeStepField(0,{startWhenInView:!(null==n||null===(t=n.steps)||void 0===t||null===(e=t[0])||void 0===e?void 0:e.startWhenInView)}),this.updateStartWhenInView()},updateStartWhenInView:function(){var t,e,i=this,n=this.someModel.getAnimations().find((function(t){return t.UUID===i.currentUuid}));this.$startWhenInView.toggleClass("checked",Boolean(null==n||null===(t=n.steps)||void 0===t||null===(e=t[0])||void 0===e?void 0:e.startWhenInView))},onHidingSwitcherChange:function(t){this.changeStepField(0,{hideInEditor:t})},startItemClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-value");this.changeStepField(this.getStepIndex(t.target),{start_point:e}),this.updateCurrentStepParams({start:!0})},accelerationItemClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-value");this.changeStepField(this.getStepIndex(t.target),{acceleration:e}),this.popupManager.closePopup("acceleration-selector"),this.updateCurrentStepParams({acceleration:!0})},accelerationItemMouseEnterLeave:function(t){var e=Object(u.a)(t.currentTarget).siblings(".acceleration-popup-preview").find(".ball"),i="mouseenter"==t.type?Object(u.a)(t.currentTarget).attr("data-value"):"";if(e.attr("data-acceleration")||""){var n=b.a.ANIMATION_PROPERTIES.animationIterationJS;e.off().one(n,(function(t){0==Math.round(t.originalEvent.elapsedTime/.7)%2?(e.attr("data-acceleration",""),e.outerHeight(),e.attr("data-acceleration",i)):e.off().one(n,(function(t){e.attr("data-acceleration",""),e.outerHeight(),e.attr("data-acceleration",i)}))}))}else e.attr("data-acceleration",i)},onParamInputChange:function(t,e){var i=this,n=this.getStepIndex(t),a=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===i.currentUuid})).steps),r=Object(u.a)(".move-block .numeric-input.left-align")[0].value,s=Object(u.a)(".move-block .numeric-input.right-align")[0].value,l=t.attr("data-param");if(r>9999||r<-9999||s>9999||s<-9999?Object(u.a)(".move-block .numeric-input").css("font-size","18px"):Object(u.a)(".move-block .numeric-input").css("font-size","22px"),a[n]&&(a[n][l]=e,this.setAnimation({steps:a},this.currentUuid,{historyMergeID:l}),o.a.contains(["rotate","scale","opacity","dx","dy","from_rotate","from_scale","from_opacity"],l)&&this.animationSteps&&this.animationSteps.updateSteps(),o.a.contains(["opacity","from_opacity"],l)&&0===n&&this.onOpacityChange(),"start_offset"==l&&this.updateCurrentStepParams({start:!0}),o.a.contains(["delay","duration","delay_px"],l))){var c={};c[l]=!0,this.updateCurrentStepParams(c)}},onOpacityChange:function(){this.doesOpacityHaveDefaultvalues()||this.changeStepField(0,{hideInEditor:!1}),(this.doesOpacityHaveDefaultvalues()&&!this.isSwitcherVisible||!this.doesOpacityHaveDefaultvalues()&&this.isSwitcherVisible)&&(this.updateSteps(),this.updateStepsIndexes(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}))},doesOpacityHaveDefaultvalues:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})),i=e&&e.steps&&e.steps[0]&&e.steps[0].from_opacity,n=e&&e.steps&&e.steps[0]&&e.steps[0].opacity;return 0===i&&100===n},onAnimationTriggerAdd:function(t){this.updateTriggerButton(t,"active")},onAnimationTriggerRemove:function(t){this.removeTriggerButton(t)},initializeAnimationSteps:function(){this.animationSteps=new O({uuid:this.currentUuid,blocks:this.blocks,workspace:this.master.workspace,isFixed:this.isFixed,isFullwidth:this.isFullwidth,isFullheight:this.isFullheight,isSticked:this.isSticked,popupManager:this.popupManager});var t=parseInt(this.animationSteps.$el.css("z-index"),10),e=o.a.max(o.a.map(this.blocks,(function(t){return t.model.attributes.z})));o.a.each(this.block.getTriggerBlocks(),(function(i,n){var o=i.$el.css("z-index"),a=i.model.attributes.z;e<a&&i.$el.css({"z-index":t+n+1}),i.$el.data({"original-element-z-index":o})})),this.updateSteps(),this.updateStepsIndexes(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}),this.animationSteps.on("move scale",this.onAnimationStepsChange),this.animationSteps.on("add-step",this.addStep),this.animationSteps.on("remove-step",this.removeStep),this.animationSteps.on("select",this.onAnimationStepsSelect)},destroyAnimationSteps:function(){this.animationSteps&&this.animationSteps.destroy(),o.a.each(this.block.getTriggerBlocks(),(function(t){var e=t.$el.data("original-element-z-index");t.$el.css({"z-index":e&&"auto"!==e?e:null})}))},updateAll:function(t){if(t=t||{},this.isFullwidth=!!this.someModel.get("is_full_width"),this.isFullheight=!!this.someModel.get("is_full_height"),this.isFixed=!!this.someModel.get("fixed_position"),this.isSticked=!!this.someModel.get("sticked"),this.isMobileViewport="default"!=this.master.workspace.page.getCurrentViewport(),this.$panel.find('.type-selector .type-popup-item[data-value="hover"]').toggle(!this.isMobileViewport),this.updateControlState(),this.destroyAnimationSteps(),this.updateType(),!this.checkWidgetsCompatibility())return this.__scrollRecalc_debounced(),void this.stopPreviewMode();this.__scrollRecalc_debounced(),this.popupManager&&this.popupManager.closeAllPopups(),this.initializeAnimationSteps(),this.updateLoop(),this.updateDisplayType(),this.updateStartWhenInView(),this.resetTriggerButtons(),this.__scrollRecalc_debounced&&this.__scrollRecalc_debounced()},updateControlState:function(){this.$el.toggleClass("has-animation",o.a.any(this.models,(function(t){return t.getAnimations().filter((function(t){return"none"!==t.type})).length})))},checkWidgetsCompatibility:function(){var t=this,e=0,i=0,n=[],a=0,r=0,s=0,l=0,c={};if(o.a.each(this.models,o.a.bind((function(t){t.get("fixed_position")&&(i++,n.push(t.get("fixed_position"))),t.get("is_full_width")&&a++,t.get("is_full_height")&&r++,t.get("sticked")&&s++,b.a.canHaveAnimation(t)||l++,t.get("fixed_position")||t.get("is_full_width")||t.get("is_full_height")||t.get("sticked")||e++,c[b.a.getUuidHash(t.getAnimations())||"none"]=!0}),this)),this.$panel.removeClass("show-mixed-types show-multiple-fixeds show-multiple-stickeds show-multiple-fullwidths show-multiple-fullheights show-multiple-animations animation-disabled animation-without-steps show-non-animatable"),this.models.length>1){if(e&&(i||a||r||s)||!e&&(i&&a||i&&r||i&&s||s&&a||s&&r||a&&r))return this.$panel.addClass("show-mixed-types"),this.toggleFixedPanelSize(!0,this.MESSAGE_MIXED_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Mixed Types"),!1;if(i)return this.$panel.addClass("show-multiple-fixeds"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Fixed"),!1;if(s)return this.$panel.addClass("show-multiple-stickeds"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Sticky"),!1;if(a)return this.$panel.addClass("show-multiple-fullwidths"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Full Width"),!1;if(r)return this.$panel.addClass("show-multiple-fullheights"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Full Height"),!1;if(l)return this.$panel.addClass("show-non-animatable"),this.toggleFixedPanelSize(!0,this.MESSAGE_NON_ANIMATABLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Cannot Animate Group"),!1;if(o.a.keys(c).length>1)return this.$panel.addClass("show-multiple-animations"),this.toggleFixedPanelSize(!0,this.MESSAGE_UNITE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Unite Animations Confirm"),!1}var d=this.someModel.getAnimations(),h=d.find((function(e){return e.UUID===t.currentUuid}));if(!d.length)return this.$panel.addClass("animation-disabled"),this.toggleFixedPanelSize(!0,Object(u.a)(".js-top-block").height()),!1;if("none"===h.type){var p=E(this.$panel.children(":visible").map((function(t,e){return"absolute"!==Object(u.a)(e).css("position")?Object(u.a)(e).height():0}))).reduce((function(t,e){return t+e}),0);return this.toggleFixedPanelSize(!0,p),!1}return o.a.isEmpty(h.steps)?(this.$panel.addClass("animation-without-steps"),this.$panel.find('.effects-presets-wrapper .effects-item[data-value="use_rotate"]').toggle(!(this.isFullwidth||this.isFullheight)),this.$panel.find('.effects-presets-wrapper .presets-item[data-value="rotate"]').toggle(!(this.isFullwidth||this.isFullheight)),this.destroyAllSteps(),this.toggleFixedPanelSize(!1),this.resizableScroll&&this.resizableScroll.changeGaps({gap_start:16}),this.__scrollRecalc_debounced&&this.__scrollRecalc_debounced(),!1):(this.resizableScroll&&this.resizableScroll.changeGaps({gap_start:88}),this.toggleFixedPanelSize(!1),!0)},updateEffectPopupState:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{},n=i.selected||0,a=i.steps[n];t.find('.effect-popup-item[data-value="use_rotate"]').toggle(!(this.isFullwidth||this.isFullheight)),o.a.each(["use_move","use_opacity","use_rotate","use_scale"],(function(e){t.find('.effect-popup-item[data-value="'+e+'"]').toggleClass("used",!!a[e])}))},updateAccelerationPopupState:function(t){var e=t.position().top<130;t.toggleClass("shift-popup",e)},updateType:function(){var t=this,e=[].concat(E(b.a.EVENT_TYPES),["none"]),i=E(this.someModel.getAnimations()).sort((function(t,i){return e.indexOf(t.type)-e.indexOf(i.type)})),n=i.find((function(e){return e.UUID===t.currentUuid}))||{},a=n&&n.type,r=Object(u.a)(document.createDocumentFragment());this.$panel.attr("data-animation",a),this.$el.find(".js-animation-type").remove();var s=o.a.without.apply(o.a,[b.a.EVENT_TYPES].concat(E(i.map((function(t){return t.type})))));i.forEach((function(n,o){r.append(t.typeTemplate({index:o,animation:n,currentType:a,allowTriggers:function(t){return b.a.POINTER_EVENTS.includes(t.type)},currentUuid:t.currentUuid,total:i.length,renderTypePopup:function(i){var n=i.type,o=i.uuid;return t.typeSelectorTemplate({type:n,isInitial:!1,uuid:o,cssClass:"js-change-type-popup",availableTypes:("none"!==n?[n].concat(E(s)):s).sort((function(t,i){return e.indexOf(t)-e.indexOf(i)})),currentType:a})}}))}));var l=Object(u.a)(this.typeSelectorTemplate({isInitial:!1,cssClass:"js-add-animation-popup",type:void 0,uuid:void 0,currentType:void 0,availableTypes:s}));r.insertBefore(this.$el.find(".js-step-selector")),this.$panel.toggleClass("show-add-block",i.length<4&&i.length>0),this.$el.find(".js-add-animation-popup").replaceWith(l),this.resetTriggerButtons(),this.$panel.toggleClass("show-trigger",b.a.isExternalTriggerAllowed(a)&&!o.a.isEmpty(n&&n.steps)),this.$panel.toggleClass("show-loops","scroll"!==a),this.$panel.toggleClass("show-start-condition","load"===a&&!n.selected),this.$panel.toggleClass("show-display-types","click"===a),this.toggleRequiresTrigger(),this.checkPreviewEnabled(),window.requestAnimationFrame(this.resizableScroll.recalc.bind(this.resizableScroll)),this.__scrollRecalc_debounced()},toggleRequiresTrigger:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid}))||{};this.$panel.toggleClass("show-requires-trigger",Boolean("click"===e.type&&!this.block.getAnimationTriggers(this.currentUuid).length&&"video"===this.someModel.get("type"))&&!o.a.isEmpty(e.steps)),this.updateCurrentStepInputs()},checkPreviewEnabled:function(t){var e=this,i=t||(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{}).type,n=Boolean(this.someModel.get("preview_enabled")),o=Boolean("click"===i&&n);return this.$panel.toggleClass("show-cannot-use-with-picture-preview",o),this.updateCurrentStepInputs(),o},resetTriggerButtons:function(){this.updateTriggerButtons(o.a.reduce(this.block.getAnimationTriggers(this.currentUuid),function(t,e){return t[e]=this.verifyTriggerState(e,"active"),t}.bind(this),{}))},removeTriggerButton:function(t){if(t)var e="new"===t?o.a.extend({},this.triggerButtonsState,{new:{status:"none"}}):o.a.omit(this.triggerButtonsState,t);this.updateTriggerButtons(e),this.isSwitcherVisible&&(this.changeStepField(0,{hideInEditor:!1}),this.updateSteps(),this.updateStepsIndexes(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}))},removeTriggerButtons:function(){this.updateTriggerButtons({})},updateTriggerButton:function(t,e){if(t){var i={};i[t]=this.verifyTriggerState(t,e);var n=o.a.extend({},o.a.omit(this.triggerButtonsState,"new"),i);this.updateTriggerButtons(n)}},updateTriggerButtons:function(t){!(t=o.a.omit(t,(function(t,e){return"new"!==e&&t&&"none"===t.status}))).new&&o.a.keys(t).length<this.TRIGGER_COUNT_LIMIT&&(t.new={status:"none"});var e=Object(u.a)(document.createDocumentFragment());o.a.each(t,function(t,i){e.append(this.renderTriggerButton(i,t.status,t.pageNumber))}.bind(this)),this.$panel.find(".js-trigger-buttons-container").empty().append(e),this.updateTriggerButtonHandlers(t),this.triggerButtonsState=t,this.__scrollRecalc_debounced(),this.toggleRequiresTrigger(),this.checkPreviewEnabled()},verifyTriggerState:function(t,e){if(-1!==["pending","none"].indexOf(e))return{status:e};var i=t&&this.master.workspace.findBlock(t),n=t&&!i?this.master.workspace.mag.getWidgetPage(t):null;return i?{status:"active"}:n&&n.id!==this.master.workspace.page.id?{status:"onOtherPage",pageNumber:n.attributes.num}:{status:"none"}},removeMissingTriggers:function(t){return o.a.filter(t,function(t){return t&&this.master.workspace.findBlock(t)||this.master.workspace.mag.getWidgetPage(t)}.bind(this))},updateCurrentStepParams:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{},n=i.type||"none",a=i.selected||0,r=i.steps;if(!o.a.isEmpty(r)){var s=this.$steps_container.find(".step").eq(a),l=r[a];if(t.visibility&&(Object(u.a)(" .param-wrapper.delay-block, .param-wrapper.duration-block",s).toggleClass("hide-unallowed","scroll"==n),Object(u.a)(".param-wrapper.delay_px-block",s).toggleClass("hide-unallowed","scroll"!=n||0==a&&!this.isFixed),Object(u.a)(".param-wrapper.speed-block",s).toggleClass("hide-unallowed","scroll"!=n),Object(u.a)(".param-wrapper.start-block",s).toggleClass("hide-unallowed","scroll"!=n||a>0||this.isFixed),Object(u.a)(".param-wrapper.move-block",s).toggleClass("hide-dx-input",this.isFullwidth),Object(u.a)(".param-wrapper.move-block",s).toggleClass("hide-dy-input",this.isFullheight),Object(u.a)(".param-wrapper.rotate-block",s).toggleClass("hide-unallowed",this.isFullwidth||this.isFullheight),Object(u.a)(".param-wrapper.opacity-block, .param-wrapper.rotate-block, .param-wrapper.scale-block",s).toggleClass("hide-from-input",a>0),Object(u.a)(".param-wrapper.move-block",s).toggleClass("hide-unused",!l.use_move),Object(u.a)(".param-wrapper.opacity-block",s).toggleClass("hide-unused",!l.use_opacity),Object(u.a)(".param-wrapper.rotate-block",s).toggleClass("hide-unused",!l.use_rotate),Object(u.a)(".param-wrapper.scale-block",s).toggleClass("hide-unused",!l.use_scale)),t.start&&!Object(u.a)(".param-wrapper.start-block",s).hasClass("hide-unallowed")){var c;(c=Object(u.a)('.param-wrapper.start-block .start-popup .start-popup-item[data-value="'+l.start_point+'"]',s)).addClass("curr").siblings(".start-popup-item").removeClass("curr"),Object(u.a)(".param-wrapper.start-block .start-value",s).text(c.text()),Object(u.a)(".param-wrapper.start-block .start-popup",s).toggleClass("has-offset",!!l.start_offset);var d=63*{top:0,center:.5,bottom:1}[l.start_point],h=-63*l.start_offset/Object(u.a)(window).height(),p=Math.max(Math.min(d+h,63),0);Object(u.a)(".param-wrapper.start-block .start-preview .start-point",s).css("top",d),Object(u.a)(".param-wrapper.start-block .start-preview .start-dist",s).css({top:Math.min(d,p),bottom:63-Math.max(d,p)}),Object(u.a)(".param-wrapper.start-block .start-preview .start-offset",s).css("top",p)}if(t.acceleration)(c=Object(u.a)('.param-wrapper.acceleration-block .acceleration-popup .acceleration-popup-item[data-value="'+l.acceleration+'"]',s)).addClass("curr").siblings(".acceleration-popup-item").removeClass("curr"),Object(u.a)(".param-wrapper.acceleration-block .acceleration-value",s).text(c.text());o.a.each(["delay","duration","delay_px"],(function(e){if(t[e]&&!Object(u.a)(".param-wrapper."+e+"-block",s).hasClass("hide-unallowed")){var i;i="delay_px"==e?Math.min(76*l[e]/Object(u.a)(window).height(),76):Math.min(20*l[e],76),Object(u.a)(".param-wrapper."+e+"-block .bg",s).height(i)}}))}},updateCurrentStepInputs:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{},n=i.selected||0;t=t||["start_offset","delay","duration","delay_px","speed","dx","dy","opacity","rotate","scale"];if(!o.a.isEmpty(i.steps)){var a=this.$steps_container.find(".step").eq(n);o.a.each(t,(function(t){var e;((e=a.find('input[data-param="'+t+'"]').data("cb"))&&e(i.steps[n][t],!0),"opacity"==t||"rotate"==t||"scale"==t)&&(t="from_"+t,(e=a.find('input[data-param="'+t+'"]').data("cb"))&&e(i.steps[n][t],!0))}))}},updateStepsPopup:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})),i=e.steps,n=e.selected||0,a=this.$step_selector.find(".js-step-popup-content"),r=v.a["template-constructor-control-common_animation-step-popup-item"],s=e.loop?0:i?i.findIndex((function(t){return t.loop})):-1,l=Object(u.a)(document.createDocumentFragment());o.a.each(i,(function(t,e){var i=r({index:e,text:"Step "+(e+1),isSelected:e===n,isInLoop:s>-1&&e>=s});l.append(i)})),a.empty().append(l),a.off("click.popup-item"),a.on("click.popup-item",".js-step-popup-item",this.onStepPopupItemClick)},updateLoop:function(){var t=this;this.$loop_types.find("[data-value]").removeClass("checked included");var e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid}));if(e&&e.steps&&e.steps.length){var i=e.selected||0,n=b.a.normalizeLoopValue(e.loop||e.steps.map((function(t){return t.loop})).find((function(t){return t}))),o=e.loop?0:e.steps.findIndex((function(t){return t.loop})),a=this.$loop_types.find("[data-value="+n+"]");i===o&&a.addClass("checked"),o>-1&&i>o&&a.addClass("included"),this.$loop_types.toggleClass("first",0===i),this.$loop_types.toggleClass("checked",i===o)}},updateSteps:function(){var t=this;this.destroyAllSteps(),o.a.each(this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})).steps,this.renderStep)},showSelectedStep:function(t){var e=this;t=t||{};var i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=i.steps.length,o=i.selected||0;this.$step_selector.toggleClass("one-step",1==n),this.$step_selector.find(".js-step-caption").text(1==n?"Step 1":"Step "+(o+1)+"/"+n),this.$step_selector.find(".js-prev-step").toggleClass("disabled",0==o),this.$step_selector.find(".js-next-step").toggleClass("disabled",o==n-1),this.$steps_container.find(".step").hide().eq(o).show(),this.updateCurrentStepParams({visibility:!0,acceleration:!0,start:!0,delay:!0,duration:!0,delay_px:!0}),this.updateCurrentStepInputs(),this.updateStepsPopup(),t.updateWorkspaceSelectedStep&&this.animationSteps.selectStep(o)},setAnimation:function(t,e,i){var n=!e||!this.someModel.getAnimations().find((function(t){return t.UUID===e}))?[].concat(E(this.someModel.getAnimations()),[M({loop:!1,selected:0,steps:[],UUID:e||_.default.generateUUID()},t||{})]):this.someModel.getAnimations().map((function(i){return i.UUID===e?M(M({},o.a.cloneWithObjects(i)),t||{}):i}));this.setAnimations(n,i);var a=this.someModel.getAnimations().length;this.amountOfAnimations!==a&&a>1&&(RM.analytics&&RM.analytics.sendEvent("Animation Add Type",a.toString()),this.amountOfAnimations=a)},setAnimations:function(t,e){e=e||{};var i=o.a.map(this.models,(function(e){return{_id:e.get("_id"),animation:t}}));e.skipHistory||e.redo||e.undo||!this.undoController||(this.undoController.isEmpty()&&this.undoController.add(o.a.cloneWithObjects(this.someModel.getAnimations())),this.undoController.add.__debounced(t,{historyMergeID:e.historyMergeID})),this.master.workspace.set_group(i),!e.skipPreviewUpdate&&this.isPreviewMode&&this.updatePreviewMode(),this.hasChanges=!0},save:function(){this.hasChanges&&(this.setAnimations(this.someModel.getAnimations().map((function(t){return M(M({},t),{},{UUID:_.default.generateUUID()})})),{skipHistory:!0,skipPreviewUpdate:!0}),this.master.workspace.save_group(this.models,{skipHistory:!0}),delete this.hasChanges),g.prototype.save.apply(this,arguments)},onPanelScroll:function(t){},select:function(){g.prototype.select.apply(this,arguments),this.undoController=new R({control:this,pid:this.models[0].get("pid")});var t=this.someModel.getAnimations(),e=t.find((function(t){return!t.steps||!t.steps.length}))||t.find((function(t){return"none"!==t.type}))||t[0];e&&!e.UUID&&(e.UUID=_.default.generateUUID()),this.currentUuid=e&&e.UUID,this.updateAll(),this.$panel.hide(),this.$panel.outerHeight(),this.$panel.show()},deselect:function(){this.stopPreviewMode(),this.destroyAnimationSteps(),this.popupManager&&this.popupManager.closeAllPopups&&this.popupManager.closeAllPopups(),this.save(),this.undoController&&this.undoController.destroy(),delete this.undoController,g.prototype.deselect.apply(this,arguments)},onClick:function(){this.selected&&this.popupManager.openedPopup&&this.popupManager.closeAllPopups()||a.a.prototype.onClick.apply(this,arguments)},onEscKey:function(){this.isPreviewMode?this.stopPreviewMode():this.selected&&this.popupManager.openedPopup&&this.popupManager.closeAllPopups()||a.a.prototype.onEscKey.apply(this,arguments)},restrictions:function(t){var e=t.getSelectedBlocks();return o.a.find(e,(function(t){return b.a.canHaveAnimation(t)}))},canControlBeClosed:function(){return!(!this.popupManager.openedPopup||!this.popupManager.closeAllPopups())||(!!this.waitingForTriggerClick||a.a.prototype.canControlBeClosed.apply(this,arguments))},destroy:function(){this.selected&&this.deselect(),this.willRestoreAnimationMode=!1,this.removeTriggerButtons(),g.prototype.destroy.apply(this,arguments)}}),R=m.a.Model.extend({initialize:function(t){o.a.bindAll(this),this.control=t.control,this.pid=t.pid,this.undoIndex=-1,this.undoStack=[],this.add.__debounced=o.a.debounce(this.add,300),this.historyTriggers=y.a.setCustomHandlers({undo:this.undo,redo:this.redo,getLength:this.getLength})},isEmpty:function(){return-1==this.undoIndex},add:function(t,e){e=e||{},-1!=this.undoIndex&&o.a.isEqual(this.undoStack[this.undoIndex].animation,t)||(o.a.isEmpty(t)&&(t={}),this.undoIndex>=0&&e.historyMergeID&&e.historyMergeID==this.undoStack[this.undoIndex].historyMergeID||this.undoIndex++,this.undoStack[this.undoIndex]={animation:t,historyMergeID:e.historyMergeID},this.undoStack.length=this.undoIndex+1,this.historyTriggers.triggerChange(this.pid))},undo:function(t){this.undoIndex>0&&(this.undoIndex--,this.control.setAnimations(this.undoStack[this.undoIndex].animation,{undo:!0}),this.control.updateAll({undo:!0}),this.historyTriggers.triggerChange(this.pid),this.historyTriggers.triggerUndo(this.pid))},redo:function(t){this.undoIndex<this.undoStack.length-1&&(this.undoIndex++,this.control.setAnimations(this.undoStack[this.undoIndex].animation,{redo:!0}),this.control.updateAll({redo:!0}),this.historyTriggers.triggerChange(this.pid),this.historyTriggers.triggerRedo(this.pid))},getLength:function(t){return{undo:this.undoIndex,redo:this.undoStack.length-1-this.undoIndex,page:t}},destroy:function(){y.a.removeCustomHandlers()}});function D(t){this.popups={},this.openedPopup="",o.a.bindAll(this),this.closeAllPopups.__debounced=o.a.debounce(this.closeAllPopups,50)}D.prototype.addPopup=function(t){t.onClick=o.a.bind((function(e){e&&Object(u.a)(e.target).closest(t.popupSelector).length>0||this.onClick(t.name,e.currentTarget)}),this),t.$parent.on("click",t.selector,t.onClick),t.$parent.on("click",this.closeAllPopups.__debounced),this.popups[t.name]=t},D.prototype.onClick=function(t,e){this.openedPopup==t?this.closePopup(t):this.openPopup(t,e)},D.prototype.closePopup=function(t){this.openedPopup==t&&this.popups[t]&&(this.openedPopup="",Object(u.a)(this.popups[t].selector,this.popups[t].$parent).removeClass("opened"),this.popups[t].cbClose&&this.popups[t].cbClose())},D.prototype.openPopup=function(t,e){this.openedPopup!=t&&this.popups[t]&&(this.openedPopup&&this.closePopup(this.openedPopup),this.openedPopup=t,Object(u.a)(e).addClass("opened"),this.popups[t].cbOpen&&this.popups[t].cbOpen(Object(u.a)(e)))},D.prototype.closeAllPopups=function(t){return!this.openedPopup||!(t&&Object(u.a)(t.target).closest(this.popups[this.openedPopup].selector).length>0)&&(this.closePopup(this.openedPopup),!0)},D.prototype.destroy=function(){for(var t in this.popups)this.popups[t].$parent.off("click",this.popups[t].selector,this.popups[t].onClick),this.popups[t].$parent.off("click",this.closeAllPopups.__debounced);delete this.popups};var B=A,L=i("HW3E"),z=i.n(L);function F(t){return function(t){if(Array.isArray(t))return U(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return U(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return U(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function N(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function H(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?N(Object(i),!0).forEach((function(e){V(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function V(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var W=g.extend({name:"common_animation_without_display_types",className:"control common_animation_without_display_types",MIN_PANEL_HEIGHT:560,MAX_PANEL_HEIGHT:640,DISABLED_HEIGHT:138,DISABLED_HEIGHT_RESET:138,MESSAGE_MIXED_HEIGHT:128,MESSAGE_MULTIPLE_HEIGHT:112,MESSAGE_NON_ANIMATABLE_HEIGHT:96,MESSAGE_UNITE_HEIGHT:160,DEFAULT_ANIMATION_STEP:{duration:.5,delay:0,speed:1,delay_px:0,dx:void 0,dy:void 0,opacity:void 0,rotate:void 0,scale:void 0,acceleration:"none",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:100,use_move:!1,use_opacity:!1,use_rotate:!1,use_scale:!1},PRESETS:{"fade-and-scale":{loop:!1,selected:0,steps:[{duration:1.2,delay:0,speed:1,delay_px:0,opacity:100,scale:100,acceleration:"ease-out",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:80,use_move:!1,use_opacity:!0,use_rotate:!1,use_scale:!0}]},"fade-in":{loop:!1,selected:0,steps:[{duration:1.6,delay:0,speed:1,delay_px:0,opacity:100,scale:100,acceleration:"ease-out",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:80,use_move:!1,use_opacity:!0,use_rotate:!1,use_scale:!1}]},"scale-big":{loop:!1,selected:0,steps:[{duration:.8,delay:0,speed:1,delay_px:0,opacity:100,scale:100,acceleration:"ease-out",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:256,use_move:!1,use_opacity:!0,use_rotate:!1,use_scale:!0}]},"move-and-fade":{loop:!1,selected:0,steps:[{duration:.8,delay:0,speed:1,delay_px:0,dx:0,dy:-32,opacity:100,acceleration:"ease-both",start_point:"bottom",start_offset:0,from_opacity:0,from_rotate:0,from_scale:100,use_move:!0,use_opacity:!0,use_rotate:!1,use_scale:!1}]},pulse:{loop:"swing",selected:0,steps:[{duration:1.2,delay:0,speed:1,delay_px:0,dx:142,dy:0,scale:90,acceleration:"ease-both",start_point:"bottom",start_offset:0,from_opacity:100,from_rotate:0,from_scale:100,use_move:!1,use_opacity:!1,use_rotate:!1,use_scale:!0}]},rotate:{loop:"repeat",selected:0,steps:[{duration:1.8,delay:0,speed:1,delay_px:0,dx:0,dy:0,rotate:360,acceleration:"none",start_point:"bottom",start_offset:0,from_opacity:100,from_rotate:0,from_scale:100,use_move:!1,use_opacity:!1,use_rotate:!0,use_scale:!1}]}},TRIGGER_COUNT_LIMIT:3,events:{"click .js-trigger-button":"onTriggerButtonClick","click .js-cancel-trigger":"onTriggerCancelClick","click .js-remove-trigger":"onTriggerRemoveClick","mouseenter .js-trigger-name":"onTriggerNameMouseEnter","mouseleave .js-trigger-name":"onTriggerNameMouseLeave","mouseenter .js-remove-trigger":"onTriggerRemoveMouseEnter","mouseleave .js-remove-trigger":"onTriggerRemoveMouseLeave"},initialize:function(t){var e=this;this.typeSelectorTemplate=z.a["template-constructor-control-common_animation-type-popup"],this.template=function(t){return z.a["template-constructor-control-common_animation"](H(H({},t),{},{renderInitialTypePopup:function(){return e.typeSelectorTemplate({isInitial:!0,type:void 0,uuid:void 0,cssClass:"js-change-type-popup",currentType:void 0,availableTypes:b.a.EVENT_TYPES})},renderAddTypePopup:function(){return e.typeSelectorTemplate({isInitial:!1,cssClass:"js-add-animation-popup",type:void 0,uuid:void 0,currentType:void 0,availableTypes:b.a.EVENT_TYPES})}}))},this.step_template=z.a["template-constructor-control-common_animation-step"],this.typeTemplate=z.a["template-constructor-control-common_animation-type"],this.initControl(t),this.isPreviewMode=!1,this.isSwitcherVisible=!1,this.amountOfAnimations=0,this.block=this.blocks&&this.blocks[0],this.someModel=this.models&&this.models[0],this.triggerButtonsState={},this.currentUuid=void 0,this.updateControlState()},bindLogic:function(){this.master.workspace.on("paste-animation",this.onAnimationPaste),this.$loop_types=this.$panel.find(".js-loop-types"),this.$loop_repeat=this.$panel.find(".js-loop-repeat"),this.$loop_swing=this.$panel.find(".js-loop-swing"),this.$playOnce=this.$panel.find(".js-play-once"),this.$preview_switcher=this.$panel.find(".bottom-block .preview"),this.$steps_container=this.$panel.find(".resizable-content"),this.$step_selector=this.$panel.find(".js-step-selector"),this.$step_selector.find(".js-prev-step").on("click",this.prevStepClick),this.$step_selector.find(".js-next-step").on("click",this.nextStepClick),this.$steps_container.on("click",".param-wrapper.start-block .start-popup-item",this.startItemClick),this.$steps_container.on("click",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemClick),this.$steps_container.on("mouseenter mouseleave",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemMouseEnterLeave),this.$steps_container.on("click",".remove-effect",this.removeEffectClick),this.$steps_container.on("click",".effects-presets-wrapper .effects-item",this.addStepClick),this.$steps_container.on("click",".effects-presets-wrapper .presets-item",this.usePresetClick),this.$steps_container.on("click",".effects-presets-wrapper .presets-item .preview",this.previewPresetClick),this.$panel.on("click",".unite-button",this.uniteClick),this.$loop_repeat.on("click",this.onLoopTypeClick),this.$loop_swing.on("click",this.onLoopTypeClick),this.$playOnce.on("click",this.onPlayOnceClick),this.$preview_switcher.on("click",this.togglePreviewMode),this.$panel.on("click",".js-type-popup-item",this.typeSelectorItemClick),this.$panel.on("click",".bottom-block .add-effect .effect-popup-item",this.addEffectItemClick),this.$panel.on("click",".js-change-animation",this.onAnimationSelect),this.$panel.on("click",".js-remove-animation",this.onAnimationRemove),this.popupManager=new q,this.popupManager.addPopup({$parent:this.$panel,name:"type-selector",selector:".js-change-type",popupSelector:".js-change-type-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"add-animation",selector:".js-add-animation",popupSelector:".js-add-animation-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"steps",selector:".js-step-selector:not(.one-step)",popupSelector:".js-step-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"add-effect",selector:".bottom-block .add-effect",popupSelector:".bottom-block .effect-popup",cbOpen:this.updateEffectPopupState}),this.popupManager.addPopup({$parent:this.$panel,name:"start-selector",selector:".resizable-content .param-wrapper.start-block",popupSelector:".resizable-content .param-wrapper.start-block .start-popup"}),this.popupManager.addPopup({$parent:this.$panel,name:"acceleration-selector",selector:".resizable-content .param-wrapper.acceleration-block",popupSelector:".resizable-content .param-wrapper.acceleration-block .acceleration-popup",cbOpen:this.updateAccelerationPopupState}),RM.constructorRouter.bindGlobalKeyPress([{key:"a",handler:this.onClick}]),this.listenTo(this.someModel,"animation:trigger:add",this.onAnimationTriggerAdd),this.listenTo(this.someModel,"animation:trigger:remove",this.onAnimationTriggerRemove),this.$step_selector.find(".js-step-popup").sortable({items:".js-step-popup-item",distance:10,axis:"y",scrollSpeed:10,containment:"parent",tolerance:"pointer",start:this.onStepsSortStart.bind(this),stop:this.onStepsSortEnd.bind(this)}),Object(u.a)("").add(this.$loop_swing).add(this.$loop_repeat).RMAltText({cssClass:"loop-type-tooltip",offset:-4})},unBindLogic:function(){this.master.workspace.off("paste-animation",this.onAnimationPaste),this.$step_selector.find(".js-prev-step").off("click",this.prevStepClick),this.$step_selector.find(".js-next-step").off("click",this.nextStepClick),this.$steps_container.off("click",".param-wrapper.start-block .start-popup-item",this.startItemClick),this.$steps_container.off("click",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemClick),this.$steps_container.off("mouseenter mouseleave",".param-wrapper.acceleration-block .acceleration-popup-item",this.accelerationItemMouseEnterLeave),this.$steps_container.off("click",".remove-effect",this.removeEffectClick),this.$steps_container.off("click",".effects-presets-wrapper .effects-item",this.addStepClick),this.$steps_container.off("click",".effects-presets-wrapper .presets-item",this.usePresetClick),this.$steps_container.off("click",".effects-presets-wrapper .presets-item .preview",this.previewPresetClick),this.$panel.off("click",".unite-button",this.uniteClick),this.removeTriggerButtons(),this.$loop_repeat.off("click",this.onLoopTypeClick),this.$loop_swing.off("click",this.onLoopTypeClick),this.$playOnce.off("click",this.onPlayOnceClick),this.$preview_switcher.off("click",this.togglePreviewMode),this.$panel.off("click",".js-type-popup-item",this.typeSelectorItemClick),this.$panel.off("click",".bottom-block .add-effect .effect-popup-item",this.addEffectItemClick),this.popupManager.destroy(),delete this.popupManager,RM.constructorRouter.unbindGlobalKeyPress("a",this.onClick),this.stopListening(this.someModel,"animation:trigger:add"),this.stopListening(this.someModel,"animation:trigger:remove")},onPlayOnceClick:function(){var t=this;this.setAnimation({playOnce:!(this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid}))||{}).playOnce},this.currentUuid),this.updatePlayOnce()},updatePlayOnce:function(){var t=this;this.$playOnce.toggleClass("active",Boolean(this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})).playOnce))},startPreviewMode:function(){this.isPreviewMode||(this.isPreviewMode=!0,this.$preview_switcher.text("Stop").addClass("active"),this.animationSteps&&this.animationSteps.startPreviewMode())},updatePreviewMode:function(){this.isPreviewMode&&this.animationSteps&&this.animationSteps.updatePreviewMode()},stopPreviewMode:function(){this.isPreviewMode&&(this.isPreviewMode=!1,this.$preview_switcher.text("Preview").removeClass("active"),this.animationSteps&&this.animationSteps.stopPreviewMode())},togglePreviewMode:function(){this.isPreviewMode?this.stopPreviewMode():this.startPreviewMode()},onAnimationPaste:function(){this.selected?this.updateAll():this.onClick()},renderStep:function(t,e){var i,n,a=this.block.getAnimationTriggers(this.currentUuid),r=a&&a.length>0,s=this.block.id,l=a&&1===a.length&&a.includes(s);this.isSwitcherVisible=r&&!l&&0===e&&this.doesOpacityHaveDefaultvalues(),i=o.a.extend({index:e,isSwitcherVisible:this.isSwitcherVisible},t),n=Object(u.a)(this.step_template(i)),e>0?this.$steps_container.find(".step").eq(e-1).after(n):this.$steps_container.append(n),n.find("input").each(o.a.bind((function(t,e){var i=Object(u.a)(e).RMNumericInput({onChange:this.onParamInputChange,labelSelector:".units:not(.for-centering)",autoSize:!0}).data("changeValue");Object(u.a)(e).data("cb",i)}),this));var c=n.find(".js-start-when-in-view-switcher");c.length&&c.RMSwitcher({state:i.startWhenInView,height:26,width:44,"color-0":"#0078ff","color-1":"#c9c8c9","text-color-0":"transparent","text-color-1":"transparent"},this.onSwitcherChange.bind(this));var d=n.find(".js-hide-in-editor-switcher");d.length&&d.RMSwitcher({state:i.hideInEditor,height:26,width:44,"color-0":"#0078ff","color-1":"#c9c8c9","text-color-0":"transparent","text-color-1":"transparent"},this.onHidingSwitcherChange.bind(this))},destroyStep:function(t){this.$steps_container.find(".step").eq(t).remove()},destroyAllSteps:function(t){this.$steps_container.find(".step").remove()},updateStepsIndexes:function(){this.$steps_container.find(".step").each((function(t,e){Object(u.a)(e).attr("data-ind",t)}))},prevStepClick:function(t){var e=this;t.stopPropagation(),this.switchStep({updateWorkspaceSelectedStep:!0,cur:(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected||0)-1})},nextStepClick:function(t){var e=this;t.stopPropagation(),this.switchStep({updateWorkspaceSelectedStep:!0,cur:(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected||0)+1})},onStepPopupItemClick:function(t){var e=this,i=Object(u.a)(t.target).closest(".js-step-popup-item"),n=parseInt(i.data("ind"),10);n!==this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected&&this.switchStep({updateWorkspaceSelectedStep:!0,cur:n})},onAnimationStepsSelect:function(t){this.switchStep({updateWorkspaceSelectedStep:!1,cur:t})},onStepsSortStart:function(){this.$(".js-step-popup").addClass("grabbing")},onStepsSortEnd:function(){this.$(".js-step-popup").removeClass("grabbing"),this.reorderSteps()},reorderSteps:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})),i=e.steps,n=e.selected,a=[];o.a.each(this.$step_selector.find(".js-step-popup-item"),function(t,e){var o=Object(u.a)(t).data("ind");o===n&&this.setAnimation({selected:e},this.currentUuid);var r=i[o];a.push(r)}.bind(this)),this.setAnimation({steps:a},this.currentUuid),this.animationSteps&&this.animationSteps.updateSteps(),this.showSelectedStep({updateWorkspaceSelectedStep:!0})},switchStep:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps.length;t.cur>=i||t.cur<0||(this.setAnimation({selected:t.cur},this.currentUuid,{historyMergeID:"selected",skipPreviewUpdate:!0}),this.showSelectedStep({updateWorkspaceSelectedStep:t.updateWorkspaceSelectedStep}),this.updateLoop(),this.__scrollRecalc_debounced(),RM.analytics&&RM.analytics.sendEvent("Animation Switch Steps"))},addStepClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-value");this.addStep({use_effect:e}),RM.constructorRouter.trigger("notice:triggerMetrics",P.a.CountAnimatedWidgetCreated),RM.analytics&&RM.analytics.sendEvent("Animation Choose Effect",e.split("_").pop())},addStep:function(t){var e=this;t=t||{};var i,n=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps),a=o.a.cloneWithObjects(this.DEFAULT_ANIMATION_STEP),r={};if("initial"!=t.after_step?i=null!=t.after_step?t.after_step+1:n.length:(i=0,r.from_opacity=n[0].from_opacity,r.from_rotate=n[0].from_rotate,r.from_scale=n[0].from_scale,n[0].use_opacity&&(r.use_opacity=!0,r.opacity=n[0].from_opacity),n[0].use_rotate&&(r.use_rotate=!0,r.rotate=n[0].from_rotate),n[0].use_scale&&(r.use_scale=!0,r.scale=n[0].from_scale),o.a.extend(a,r)),n.splice(i,0,a),this.setAnimation({selected:i,steps:n},this.currentUuid),1==n.length)return this.updateAll(),void this.addEffectItem(t.use_effect);this.renderStep(a,i),this.updateStepsIndexes(),this.animationSteps&&this.animationSteps.updateSteps(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}),this.__scrollRecalc_debounced(),this.addEffectItem(t.use_effect),RM.analytics&&RM.analytics.sendEvent("Animation Add Step",i)},usePresetClick:function(t){if(!Object(u.a)(t.target).closest(".preview").length){var e=Object(u.a)(t.currentTarget).attr("data-value");this.setAnimation(this.PRESETS[e],this.currentUuid),this.updateAll(),RM.analytics&&RM.analytics.sendEvent("Animation Use Preset",e)}},previewPresetClick:function(t){},removeStep:function(t){var e=this,i=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps),n={};if((0==t||"initial"==t)&&1==i.length)return this.setAnimation({selected:void 0,steps:[]},this.currentUuid),void this.updateAll();if(0==t&&i.length>1){var a=RM.constructorRouter.workspace.page.getCurrentViewport(),r=b.a.getNormalizedAnimation(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),this.isFixed,this.isFullwidth,this.isFullheight,1,a,RM.constructorRouter.workspace.mag.getViewportWidth(a),RM.constructorRouter.workspace.mag.get("opts"));n.from_opacity=i[0].from_opacity,n.from_rotate=i[0].from_rotate,n.from_scale=i[0].from_scale,i[0].use_opacity&&(n.opacity=r.steps[1].opacity,n.use_opacity=!0),i[0].use_rotate&&(n.rotate=r.steps[1].rotate,n.use_rotate=!0),i[0].use_scale&&(n.scale=r.steps[1].scale,n.use_scale=!0),o.a.extend(i[1],n)}"initial"!=t&&(i.splice(t,1),this.setAnimation({selected:t==i.length?t-1:t,steps:i},this.currentUuid),this.destroyStep(t),this.updateStepsIndexes(),this.animationSteps&&this.animationSteps.updateSteps({animateStepInd:t}),this.showSelectedStep({updateWorkspaceSelectedStep:!0}),this.__scrollRecalc_debounced())},resetClick:function(){this.setAnimation({},this.currentUuid),this.updateAll()},uniteClick:function(){var t={},e=0,i=null;this.models.forEach((function(n){var o=b.a.getUuidHash(n.getAnimations())||"none";t[o]=(t[o]||0)+1,"none"!==o&&t[o]>e&&(i=n,e=t[o])})),this.setAnimations(i.getAnimations(),{skipHistory:!0}),this.updateAll()},onAnimationStepsChange:function(t){var e=this,i=t.id,n=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).steps),a=!1;delete t.id,n[i]&&(o.a.extend(n[i],t),null==t.dx||n[i].use_move||(n[i].use_move=!0,a=!0),null==t.scale&&null==t.from_scale||n[i].use_scale||(n[i].use_scale=!0,a=!0),this.setAnimation({steps:n},this.currentUuid,{historyMergeID:o.a.keys(t).join("-")}),a&&this.updateCurrentStepParams({visibility:!0}),i==this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})).selected&&this.updateCurrentStepInputs(o.a.keys(t)))},onAnimationSelect:function(t){var e=Object(u.a)(t.currentTarget).data("uuid");this.switchToAnimation(e)},onAnimationRemove:function(t){var e=Object(u.a)(t.currentTarget).data("uuid"),i=this.someModel.getAnimations();if(i.length>1){var n=i.filter((function(t){return t.UUID!==e}));this.setAnimations(n),this.currentUuid===e?this.switchToAnimation(n[n.length-1].UUID):this.updateType()}else this.setAnimations([]),this.updateAll()},typeSelectorItemClick:function(t){var e=Object(u.a)(t.currentTarget).data("uuid")||_.default.generateUUID(),i=Object(u.a)(t.currentTarget).attr("data-value"),n=this.someModel.getAnimations().find((function(t){return t.UUID===e})),o=(n&&n.type)!==i;this.setAnimation({type:i},e),this.switchToAnimation(e,o)},switchToAnimation:function(t,e){var i=this.someModel.getAnimations().find((function(e){return e.UUID===t})),n=i&&i.type,o=this.checkPreviewEnabled(n),a=this.currentUuid!==t||e;if(o)return this.setAnimation({type:n},t),this.popupManager.closePopup("type-selector"),this.updateAll(),this.setAnimation({type:"none"},t),this.someModel.trigger("animation:type:change","none",t),void(this.animationSteps&&this.animationSteps.destroy());this.currentUuid=t,n&&this.setAnimation({type:n},t),this.popupManager.closePopup("type-selector"),a||this.someModel.get("preview_enabled")?this.updateAll():(this.updateType(),this.updateCurrentStepParams({visibility:!0,start:!0,delay:!0,duration:!0,delay_px:!0}),this.updateCurrentStepInputs()),e&&this.someModel.trigger("animation:type:change",n,t),RM.analytics&&RM.analytics.sendEvent("Animation Type Change",n)},addType:function(t){t.preventDefault()},addEffectItemClick:function(t){this.addEffectItem(Object(u.a)(t.currentTarget).attr("data-value")),this.popupManager.closePopup("add-effect")},addEffectItem:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=i.selected||0,a={};if(!i.steps[n][t]){var r=o.a.cloneWithObjects(i.steps),s=RM.constructorRouter.workspace.page.getCurrentViewport(),l=b.a.getNormalizedAnimation(i,this.isFixed,this.isFullwidth,this.isFullheight,1,s,RM.constructorRouter.workspace.mag.getViewportWidth(s),RM.constructorRouter.workspace.mag.get("opts"));r[n][t]=!0,"use_move"==t&&null==r[n].dx&&(a.dx=l.steps[n].dx,a.dy=l.steps[n].dy+10),"use_opacity"==t&&null==r[n].opacity&&(a.opacity=Math.round(l.steps[n].opacity)),"use_rotate"==t&&null==r[n].rotate&&(a.rotate=l.steps[n].rotate+45),"use_scale"==t&&null==r[n].scale&&(a.scale=Math.round(.7*l.steps[n].scale)),o.a.extend(r[n],a),this.setAnimation({steps:r},this.currentUuid),this.updateCurrentStepParams({visibility:!0}),this.animationSteps&&this.animationSteps.updateSteps({animateStepInd:n}),this.__scrollRecalc_debounced(),this.updateCurrentStepInputs()}},removeEffectClick:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=Object(u.a)(t.target).closest(".step").attr("data-ind")-0,a=Object(u.a)(t.currentTarget).attr("data-value"),r=o.a.cloneWithObjects(i.steps);r[n][a]=!1,this.setAnimation({steps:r},this.currentUuid),this.updateCurrentStepParams({visibility:!0}),this.animationSteps&&this.animationSteps.updateSteps({animateStepInd:n}),this.__scrollRecalc_debounced()},onTriggerButtonClick:function(t){var e=Object(u.a)(t.target).closest("[data-id]").data("id"),i=this.getTriggerButtonState(e),n=this.block.id;"none"===i.status?this.updateTriggerButton(e,"pending"):"onOtherPage"===i.status&&i.pageNumber&&(t.stopPropagation(),RM.constructorRouter.once("pageChange",(function(t){setTimeout((function(){var e=o.a.find(t.blocks,(function(t){return t.id==n}));e&&e.onClick()}),0)})),RM.constructorRouter.showWorkspace(i.pageNumber))},onTriggerCancelClick:function(t){var e=Object(u.a)(t.target).closest("[data-id]").data("id");t.stopPropagation(),this.removeTriggerButton(e)},onTriggerRemoveClick:function(t){t.stopPropagation();var e=Object(u.a)(t.target).closest("[data-id]").data("id"),i=this.block.getAnimationTriggers(this.currentUuid);-1!==i.indexOf(e)&&(j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,e,!1,!0),this.setAnimation({trigger:o.a.without(i,e)},this.currentUuid),this.someModel.trigger("animation:trigger:remove",e))},onTriggerNameMouseEnter:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!0,!1)},onTriggerNameMouseLeave:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!1,!1)},onTriggerRemoveMouseEnter:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!0,!0)},onTriggerRemoveMouseLeave:function(t){j.a.highlightActiveTriggerBlock(this.master.workspace,this.block,Object(u.a)(t.target).closest("[data-id]").data("id"),!1,!0)},onTriggerClick:function(t){this.setAnimation({trigger:this.removeMissingTriggers(this.block.getAnimationTriggers(this.currentUuid)).concat(t)},this.currentUuid),this.someModel.trigger("animation:trigger:add",t),RM.analytics&&RM.analytics.sendEvent("Animation Trigger Click")},onTriggerMouseEnter:function(t){this.highlightPendingTriggerBlock(Object(u.a)(t.target).closest(".block").data("id"),!0)},onTriggerMouseLeave:function(t){this.highlightPendingTriggerBlock(Object(u.a)(t.target).closest(".block").data("id"),!1)},onLoopTypeClick:function(t){var e=this,i=Object(u.a)(t.currentTarget);if(!this.$loop_types.hasClass("disabled")&&!i.hasClass("included")){var n=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),a=n.selected||0,r=o.a.cloneWithObjects(n.steps).map((function(t){return H(H({},t),{},{loop:!1})}));r[a].loop=!i.hasClass("checked")&&i.data("value"),this.setAnimation({steps:r,loop:!1},this.currentUuid),this.updateLoop(),this.updateStepsPopup()}},highlightPendingTriggerBlock:function(t,e){var i=t&&this.master.workspace.findBlock(t);i&&i.highlight(e&&j.a.canBeExternalTrigger(i,this.block),b.a.ACTIVE_TRIGGER_HIGHLIGHT_CLASS)},updateTriggerButtonHandlers:function(t){var e=o.a.map(t,(function(t){return t.status}));switch(-1!==e.indexOf("pending")?"pending":-1!==e.indexOf("active")?"active":"none"){case"pending":this.waitingForTriggerClick=!0,j.a.enterPickTriggerMode(this.master.workspace,this.block,this.block.getAnimationTriggers(this.currentUuid),this.onTriggerClick),this.block.animationMode&&(this.willRestoreAnimationMode=!0,this.destroyAnimationSteps());break;case"active":case"onOtherPage":case"none":o.a.delay(function(){this.waitingForTriggerClick=!1}.bind(this)),j.a.leavePickTriggerMode(this.master.workspace),this.willRestoreAnimationMode&&(this.willRestoreAnimationMode=!1,this.initializeAnimationSteps())}},renderTriggerButton:function(t,e,i){var n=t&&this.master.workspace.findBlock(t),o=n&&1===this.blocks.length&&this.block.id===n.id;return z.a["template-constructor-control-common_animation-trigger"]({id:t,status:e,pageNumber:i,isSelf:o,triggerBlockName:n&&n.model.get("name")||n&&n.getStandardName()||"Trigger"})},getTriggerButtonState:function(t){return this.triggerButtonsState&&this.triggerButtonsState[t]||{}},getStepIndex:function(t){return Object(u.a)(t).closest(".step").attr("data-ind")-0},changeStepField:function(t,e){var i=this,n=this.someModel.getAnimations().find((function(t){return t.UUID===i.currentUuid})),a=o.a.cloneWithObjects(n.steps);o.a.extend(a[t],e),this.setAnimation({steps:a},this.currentUuid)},onSwitcherChange:function(t){this.changeStepField(0,{startWhenInView:t})},onHidingSwitcherChange:function(t){this.changeStepField(0,{hideInEditor:t})},startItemClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-value");this.changeStepField(this.getStepIndex(t.target),{start_point:e}),this.updateCurrentStepParams({start:!0})},accelerationItemClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-value");this.changeStepField(this.getStepIndex(t.target),{acceleration:e}),this.popupManager.closePopup("acceleration-selector"),this.updateCurrentStepParams({acceleration:!0})},accelerationItemMouseEnterLeave:function(t){var e=Object(u.a)(t.currentTarget).siblings(".acceleration-popup-preview").find(".ball"),i="mouseenter"==t.type?Object(u.a)(t.currentTarget).attr("data-value"):"";if(e.attr("data-acceleration")||""){var n=b.a.ANIMATION_PROPERTIES.animationIterationJS;e.off().one(n,(function(t){0==Math.round(t.originalEvent.elapsedTime/.7)%2?(e.attr("data-acceleration",""),e.outerHeight(),e.attr("data-acceleration",i)):e.off().one(n,(function(t){e.attr("data-acceleration",""),e.outerHeight(),e.attr("data-acceleration",i)}))}))}else e.attr("data-acceleration",i)},onParamInputChange:function(t,e){var i=this,n=this.getStepIndex(t),a=o.a.cloneWithObjects(this.someModel.getAnimations().find((function(t){return t.UUID===i.currentUuid})).steps),r=Object(u.a)(".move-block .numeric-input.left-align")[0].value,s=Object(u.a)(".move-block .numeric-input.right-align")[0].value,l=t.attr("data-param");if(r>9999||r<-9999||s>9999||s<-9999?Object(u.a)(".move-block .numeric-input").css("font-size","18px"):Object(u.a)(".move-block .numeric-input").css("font-size","22px"),a[n]&&(a[n][l]=e,this.setAnimation({steps:a},this.currentUuid,{historyMergeID:l}),o.a.contains(["rotate","scale","opacity","dx","dy","from_rotate","from_scale","from_opacity"],l)&&this.animationSteps&&this.animationSteps.updateSteps(),o.a.contains(["opacity","from_opacity"],l)&&0===n&&this.onOpacityChange(),"start_offset"==l&&this.updateCurrentStepParams({start:!0}),o.a.contains(["delay","duration","delay_px"],l))){var c={};c[l]=!0,this.updateCurrentStepParams(c)}},onOpacityChange:function(){this.doesOpacityHaveDefaultvalues()||this.changeStepField(0,{hideInEditor:!1}),(this.doesOpacityHaveDefaultvalues()&&!this.isSwitcherVisible||!this.doesOpacityHaveDefaultvalues()&&this.isSwitcherVisible)&&(this.updateSteps(),this.updateStepsIndexes(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}))},doesOpacityHaveDefaultvalues:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})),i=e&&e.steps&&e.steps[0]&&e.steps[0].from_opacity,n=e&&e.steps&&e.steps[0]&&e.steps[0].opacity;return 0===i&&100===n},onAnimationTriggerAdd:function(t){this.updateTriggerButton(t,"active")},onAnimationTriggerRemove:function(t){this.removeTriggerButton(t)},initializeAnimationSteps:function(){this.animationSteps=new O({uuid:this.currentUuid,blocks:this.blocks,workspace:this.master.workspace,isFixed:this.isFixed,isFullwidth:this.isFullwidth,isFullheight:this.isFullheight,isSticked:this.isSticked,popupManager:this.popupManager});var t=parseInt(this.animationSteps.$el.css("z-index"),10),e=o.a.max(o.a.map(this.blocks,(function(t){return t.model.attributes.z})));o.a.each(this.block.getTriggerBlocks(),(function(i,n){var o=i.$el.css("z-index"),a=i.model.attributes.z;e<a&&i.$el.css({"z-index":t+n+1}),i.$el.data({"original-element-z-index":o})})),this.updateSteps(),this.updateStepsIndexes(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}),this.animationSteps.on("move scale",this.onAnimationStepsChange),this.animationSteps.on("add-step",this.addStep),this.animationSteps.on("remove-step",this.removeStep),this.animationSteps.on("select",this.onAnimationStepsSelect)},destroyAnimationSteps:function(){this.animationSteps&&this.animationSteps.destroy(),o.a.each(this.block.getTriggerBlocks(),(function(t){var e=t.$el.data("original-element-z-index");t.$el.css({"z-index":e&&"auto"!==e?e:null})}))},updateAll:function(t){if(t=t||{},this.isFullwidth=!!this.someModel.get("is_full_width"),this.isFullheight=!!this.someModel.get("is_full_height"),this.isFixed=!!this.someModel.get("fixed_position"),this.isSticked=!!this.someModel.get("sticked"),this.isMobileViewport="default"!=this.master.workspace.page.getCurrentViewport(),this.$panel.find('.type-selector .type-popup-item[data-value="hover"]').toggle(!this.isMobileViewport),this.updateControlState(),this.destroyAnimationSteps(),this.updateType(),!this.checkWidgetsCompatibility())return this.__scrollRecalc_debounced(),void this.stopPreviewMode();this.__scrollRecalc_debounced(),this.popupManager&&this.popupManager.closeAllPopups(),this.initializeAnimationSteps(),this.updateLoop(),this.updatePlayOnce(),this.resetTriggerButtons(),this.__scrollRecalc_debounced&&this.__scrollRecalc_debounced()},updateControlState:function(){this.$el.toggleClass("has-animation",o.a.any(this.models,(function(t){return t.getAnimations().filter((function(t){return"none"!==t.type})).length})))},checkWidgetsCompatibility:function(){var t=this,e=0,i=0,n=[],a=0,r=0,s=0,l=0,c={};if(o.a.each(this.models,o.a.bind((function(t){t.get("fixed_position")&&(i++,n.push(t.get("fixed_position"))),t.get("is_full_width")&&a++,t.get("is_full_height")&&r++,t.get("sticked")&&s++,b.a.canHaveAnimation(t)||l++,t.get("fixed_position")||t.get("is_full_width")||t.get("is_full_height")||t.get("sticked")||e++,c[b.a.getUuidHash(t.getAnimations())||"none"]=!0}),this)),this.$panel.removeClass("show-mixed-types show-multiple-fixeds show-multiple-stickeds show-multiple-fullwidths show-multiple-fullheights show-multiple-animations animation-disabled animation-without-steps show-non-animatable"),this.models.length>1){if(e&&(i||a||r||s)||!e&&(i&&a||i&&r||i&&s||s&&a||s&&r||a&&r))return this.$panel.addClass("show-mixed-types"),this.toggleFixedPanelSize(!0,this.MESSAGE_MIXED_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Mixed Types"),!1;if(i)return this.$panel.addClass("show-multiple-fixeds"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Fixed"),!1;if(s)return this.$panel.addClass("show-multiple-stickeds"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Sticky"),!1;if(a)return this.$panel.addClass("show-multiple-fullwidths"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Full Width"),!1;if(r)return this.$panel.addClass("show-multiple-fullheights"),this.toggleFixedPanelSize(!0,this.MESSAGE_MULTIPLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Multiple Full Height"),!1;if(l)return this.$panel.addClass("show-non-animatable"),this.toggleFixedPanelSize(!0,this.MESSAGE_NON_ANIMATABLE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Cannot Animate Group"),!1;if(o.a.keys(c).length>1)return this.$panel.addClass("show-multiple-animations"),this.toggleFixedPanelSize(!0,this.MESSAGE_UNITE_HEIGHT),RM.analytics&&RM.analytics.sendEvent("Animation Message Unite Animations Confirm"),!1}var d=this.someModel.getAnimations(),h=d.find((function(e){return e.UUID===t.currentUuid}));if(!d.length)return this.$panel.addClass("animation-disabled"),this.toggleFixedPanelSize(!0,Object(u.a)(".js-top-block").height()),!1;if("none"===h.type){var p=F(this.$panel.children(":visible").map((function(t,e){return"absolute"!==Object(u.a)(e).css("position")?Object(u.a)(e).height():0}))).reduce((function(t,e){return t+e}),0);return this.toggleFixedPanelSize(!0,p),!1}return o.a.isEmpty(h.steps)?(this.$panel.addClass("animation-without-steps"),this.$panel.find('.effects-presets-wrapper .effects-item[data-value="use_rotate"]').toggle(!(this.isFullwidth||this.isFullheight)),this.$panel.find('.effects-presets-wrapper .presets-item[data-value="rotate"]').toggle(!(this.isFullwidth||this.isFullheight)),this.destroyAllSteps(),this.toggleFixedPanelSize(!1),this.resizableScroll&&this.resizableScroll.changeGaps({gap_start:16}),this.__scrollRecalc_debounced&&this.__scrollRecalc_debounced(),!1):(this.resizableScroll&&this.resizableScroll.changeGaps({gap_start:88}),this.toggleFixedPanelSize(!1),!0)},updateEffectPopupState:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{},n=i.selected||0,a=i.steps[n];t.find('.effect-popup-item[data-value="use_rotate"]').toggle(!(this.isFullwidth||this.isFullheight)),o.a.each(["use_move","use_opacity","use_rotate","use_scale"],(function(e){t.find('.effect-popup-item[data-value="'+e+'"]').toggleClass("used",!!a[e])}))},updateAccelerationPopupState:function(t){var e=t.position().top<130;t.toggleClass("shift-popup",e)},updateType:function(){var t=this,e=[].concat(F(b.a.EVENT_TYPES),["none"]),i=F(this.someModel.getAnimations()).sort((function(t,i){return e.indexOf(t.type)-e.indexOf(i.type)})),n=i.find((function(e){return e.UUID===t.currentUuid}))||{},a=n&&n.type,r=Object(u.a)(document.createDocumentFragment());this.$panel.attr("data-animation",a),this.$el.find(".js-animation-type").remove();var s=o.a.without.apply(o.a,[b.a.EVENT_TYPES].concat(F(i.map((function(t){return t.type})))));i.forEach((function(n,o){r.append(t.typeTemplate({index:o,animation:n,currentType:a,allowTriggers:function(t){return b.a.POINTER_EVENTS.includes(t.type)},currentUuid:t.currentUuid,total:i.length,renderTypePopup:function(i){var n=i.type,o=i.uuid;return t.typeSelectorTemplate({type:n,isInitial:!1,uuid:o,cssClass:"js-change-type-popup",availableTypes:("none"!==n?[n].concat(F(s)):s).sort((function(t,i){return e.indexOf(t)-e.indexOf(i)})),currentType:a})}}))}));var l=Object(u.a)(this.typeSelectorTemplate({isInitial:!1,cssClass:"js-add-animation-popup",type:void 0,uuid:void 0,currentType:void 0,availableTypes:s}));r.insertBefore(this.$el.find(".js-step-selector")),this.$panel.toggleClass("show-add-block",i.length<4&&i.length>0),this.$el.find(".js-add-animation-popup").replaceWith(l),this.resetTriggerButtons(),this.$panel.toggleClass("show-trigger",b.a.isExternalTriggerAllowed(a)&&!o.a.isEmpty(n&&n.steps)),this.$panel.toggleClass("show-loops","scroll"!==a),this.$panel.toggleClass("show-start-condition","load"===a),this.$panel.toggleClass("show-play-once","click"===a),this.toggleRequiresTrigger(),this.checkPreviewEnabled(),window.requestAnimationFrame(this.resizableScroll.recalc.bind(this.resizableScroll)),this.__scrollRecalc_debounced()},toggleRequiresTrigger:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid}))||{};this.$panel.toggleClass("show-requires-trigger",Boolean("click"===e.type&&!this.block.getAnimationTriggers(this.currentUuid).length&&"video"===this.someModel.get("type"))&&!o.a.isEmpty(e.steps)),this.updateCurrentStepInputs()},checkPreviewEnabled:function(t){var e=this,i=t||(this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{}).type,n=Boolean(this.someModel.get("preview_enabled")),o=Boolean("click"===i&&n);return this.$panel.toggleClass("show-cannot-use-with-picture-preview",o),this.updateCurrentStepInputs(),o},resetTriggerButtons:function(){this.updateTriggerButtons(o.a.reduce(this.block.getAnimationTriggers(this.currentUuid),function(t,e){return t[e]=this.verifyTriggerState(e,"active"),t}.bind(this),{}))},removeTriggerButton:function(t){if(t)var e="new"===t?o.a.extend({},this.triggerButtonsState,{new:{status:"none"}}):o.a.omit(this.triggerButtonsState,t);this.updateTriggerButtons(e),this.isSwitcherVisible&&(this.changeStepField(0,{hideInEditor:!1}),this.updateSteps(),this.updateStepsIndexes(),this.showSelectedStep({updateWorkspaceSelectedStep:!0}))},removeTriggerButtons:function(){this.updateTriggerButtons({})},updateTriggerButton:function(t,e){if(t){var i={};i[t]=this.verifyTriggerState(t,e);var n=o.a.extend({},o.a.omit(this.triggerButtonsState,"new"),i);this.updateTriggerButtons(n)}},updateTriggerButtons:function(t){!(t=o.a.omit(t,(function(t,e){return"new"!==e&&t&&"none"===t.status}))).new&&o.a.keys(t).length<this.TRIGGER_COUNT_LIMIT&&(t.new={status:"none"});var e=Object(u.a)(document.createDocumentFragment());o.a.each(t,function(t,i){e.append(this.renderTriggerButton(i,t.status,t.pageNumber))}.bind(this)),this.$panel.find(".js-trigger-buttons-container").empty().append(e),this.updateTriggerButtonHandlers(t),this.triggerButtonsState=t,this.__scrollRecalc_debounced(),this.toggleRequiresTrigger(),this.checkPreviewEnabled()},verifyTriggerState:function(t,e){if(-1!==["pending","none"].indexOf(e))return{status:e};var i=t&&this.master.workspace.findBlock(t),n=t&&!i?this.master.workspace.mag.getWidgetPage(t):null;return i?{status:"active"}:n&&n.id!==this.master.workspace.page.id?{status:"onOtherPage",pageNumber:n.attributes.num}:{status:"none"}},removeMissingTriggers:function(t){return o.a.filter(t,function(t){return t&&this.master.workspace.findBlock(t)||this.master.workspace.mag.getWidgetPage(t)}.bind(this))},updateCurrentStepParams:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{},n=i.type||"none",a=i.selected||0,r=i.steps;if(!o.a.isEmpty(r)){var s=this.$steps_container.find(".step").eq(a),l=r[a];if(t.visibility&&(Object(u.a)(" .param-wrapper.delay-block, .param-wrapper.duration-block",s).toggleClass("hide-unallowed","scroll"==n),Object(u.a)(".param-wrapper.delay_px-block",s).toggleClass("hide-unallowed","scroll"!=n||0==a&&!this.isFixed),Object(u.a)(".param-wrapper.speed-block",s).toggleClass("hide-unallowed","scroll"!=n),Object(u.a)(".param-wrapper.start-block",s).toggleClass("hide-unallowed","scroll"!=n||a>0||this.isFixed),Object(u.a)(".param-wrapper.move-block",s).toggleClass("hide-dx-input",this.isFullwidth),Object(u.a)(".param-wrapper.move-block",s).toggleClass("hide-dy-input",this.isFullheight),Object(u.a)(".param-wrapper.rotate-block",s).toggleClass("hide-unallowed",this.isFullwidth||this.isFullheight),Object(u.a)(".param-wrapper.opacity-block, .param-wrapper.rotate-block, .param-wrapper.scale-block",s).toggleClass("hide-from-input",a>0),Object(u.a)(".param-wrapper.move-block",s).toggleClass("hide-unused",!l.use_move),Object(u.a)(".param-wrapper.opacity-block",s).toggleClass("hide-unused",!l.use_opacity),Object(u.a)(".param-wrapper.rotate-block",s).toggleClass("hide-unused",!l.use_rotate),Object(u.a)(".param-wrapper.scale-block",s).toggleClass("hide-unused",!l.use_scale)),t.start&&!Object(u.a)(".param-wrapper.start-block",s).hasClass("hide-unallowed")){var c;(c=Object(u.a)('.param-wrapper.start-block .start-popup .start-popup-item[data-value="'+l.start_point+'"]',s)).addClass("curr").siblings(".start-popup-item").removeClass("curr"),Object(u.a)(".param-wrapper.start-block .start-value",s).text(c.text()),Object(u.a)(".param-wrapper.start-block .start-popup",s).toggleClass("has-offset",!!l.start_offset);var d=63*{top:0,center:.5,bottom:1}[l.start_point],h=-63*l.start_offset/Object(u.a)(window).height(),p=Math.max(Math.min(d+h,63),0);Object(u.a)(".param-wrapper.start-block .start-preview .start-point",s).css("top",d),Object(u.a)(".param-wrapper.start-block .start-preview .start-dist",s).css({top:Math.min(d,p),bottom:63-Math.max(d,p)}),Object(u.a)(".param-wrapper.start-block .start-preview .start-offset",s).css("top",p)}if(t.acceleration)(c=Object(u.a)('.param-wrapper.acceleration-block .acceleration-popup .acceleration-popup-item[data-value="'+l.acceleration+'"]',s)).addClass("curr").siblings(".acceleration-popup-item").removeClass("curr"),Object(u.a)(".param-wrapper.acceleration-block .acceleration-value",s).text(c.text());o.a.each(["delay","duration","delay_px"],(function(e){if(t[e]&&!Object(u.a)(".param-wrapper."+e+"-block",s).hasClass("hide-unallowed")){var i;i="delay_px"==e?Math.min(76*l[e]/Object(u.a)(window).height(),76):Math.min(20*l[e],76),Object(u.a)(".param-wrapper."+e+"-block .bg",s).height(i)}}))}},updateCurrentStepInputs:function(t){var e=this,i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid}))||{},n=i.selected||0;t=t||["start_offset","delay","duration","delay_px","speed","dx","dy","opacity","rotate","scale"];if(!o.a.isEmpty(i.steps)){var a=this.$steps_container.find(".step").eq(n);o.a.each(t,(function(t){var e;((e=a.find('input[data-param="'+t+'"]').data("cb"))&&e(i.steps[n][t],!0),"opacity"==t||"rotate"==t||"scale"==t)&&(t="from_"+t,(e=a.find('input[data-param="'+t+'"]').data("cb"))&&e(i.steps[n][t],!0))}))}},updateStepsPopup:function(){var t=this,e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})),i=e.steps,n=e.selected||0,a=this.$step_selector.find(".js-step-popup-content"),r=z.a["template-constructor-control-common_animation-step-popup-item"],s=e.loop?0:i?i.findIndex((function(t){return t.loop})):-1,l=Object(u.a)(document.createDocumentFragment());o.a.each(i,(function(t,e){var i=r({index:e,text:"Step "+(e+1),isSelected:e===n,isInLoop:s>-1&&e>=s});l.append(i)})),a.empty().append(l),a.off("click.popup-item"),a.on("click.popup-item",".js-step-popup-item",this.onStepPopupItemClick)},updateLoop:function(){var t=this;this.$loop_types.find("[data-value]").removeClass("checked included");var e=this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid}));if(e&&e.steps&&e.steps.length){var i=e.selected||0,n=b.a.normalizeLoopValue(e.loop||e.steps.map((function(t){return t.loop})).find((function(t){return t}))),o=e.loop?0:e.steps.findIndex((function(t){return t.loop})),a=this.$loop_types.find("[data-value="+n+"]");i===o&&a.addClass("checked"),o>-1&&i>o&&a.addClass("included"),this.$loop_types.toggleClass("first",0===i)}},updateSteps:function(){var t=this;this.destroyAllSteps(),o.a.each(this.someModel.getAnimations().find((function(e){return e.UUID===t.currentUuid})).steps,this.renderStep)},showSelectedStep:function(t){var e=this;t=t||{};var i=this.someModel.getAnimations().find((function(t){return t.UUID===e.currentUuid})),n=i.steps.length,o=i.selected||0;this.$step_selector.toggleClass("one-step",1==n),this.$step_selector.find(".js-step-caption").text(1==n?"Step 1":"Step "+(o+1)+"/"+n),this.$step_selector.find(".js-prev-step").toggleClass("disabled",0==o),this.$step_selector.find(".js-next-step").toggleClass("disabled",o==n-1),this.$steps_container.find(".step").hide().eq(o).show(),this.updateCurrentStepParams({visibility:!0,acceleration:!0,start:!0,delay:!0,duration:!0,delay_px:!0}),this.updateCurrentStepInputs(),this.updateStepsPopup(),t.updateWorkspaceSelectedStep&&this.animationSteps.selectStep(o)},setAnimation:function(t,e,i){var n=!e||!this.someModel.getAnimations().find((function(t){return t.UUID===e}))?[].concat(F(this.someModel.getAnimations()),[H({loop:!1,selected:0,steps:[],UUID:e||_.default.generateUUID()},t||{})]):this.someModel.getAnimations().map((function(i){return i.UUID===e?H(H({},o.a.cloneWithObjects(i)),t||{}):i}));this.setAnimations(n,i);var a=this.someModel.getAnimations().length;this.amountOfAnimations!==a&&a>1&&(RM.analytics&&RM.analytics.sendEvent("Animation Add Type",a.toString()),this.amountOfAnimations=a)},setAnimations:function(t,e){e=e||{};var i=o.a.map(this.models,(function(e){return{_id:e.get("_id"),animation:t}}));e.skipHistory||e.redo||e.undo||!this.undoController||(this.undoController.isEmpty()&&this.undoController.add(o.a.cloneWithObjects(this.someModel.getAnimations())),this.undoController.add.__debounced(t,{historyMergeID:e.historyMergeID})),this.master.workspace.set_group(i),!e.skipPreviewUpdate&&this.isPreviewMode&&this.updatePreviewMode(),this.hasChanges=!0},save:function(){this.hasChanges&&(this.setAnimations(this.someModel.getAnimations().map((function(t){return H(H({},t),{},{UUID:_.default.generateUUID()})})),{skipHistory:!0,skipPreviewUpdate:!0}),this.master.workspace.save_group(this.models,{skipHistory:!0}),delete this.hasChanges),g.prototype.save.apply(this,arguments)},onPanelScroll:function(t){},select:function(){g.prototype.select.apply(this,arguments),this.undoController=new G({control:this,pid:this.models[0].get("pid")});var t=this.someModel.getAnimations(),e=t.find((function(t){return!t.steps||!t.steps.length}))||t.find((function(t){return"none"!==t.type}))||t[0];e&&!e.UUID&&(e.UUID=_.default.generateUUID()),this.currentUuid=e&&e.UUID,this.updateAll(),this.$panel.hide(),this.$panel.outerHeight(),this.$panel.show()},deselect:function(){this.stopPreviewMode(),this.destroyAnimationSteps(),this.popupManager&&this.popupManager.closeAllPopups&&this.popupManager.closeAllPopups(),this.save(),this.undoController&&this.undoController.destroy(),delete this.undoController,g.prototype.deselect.apply(this,arguments)},onClick:function(){this.selected&&this.popupManager.openedPopup&&this.popupManager.closeAllPopups()||a.a.prototype.onClick.apply(this,arguments)},onEscKey:function(){this.isPreviewMode?this.stopPreviewMode():this.selected&&this.popupManager.openedPopup&&this.popupManager.closeAllPopups()||a.a.prototype.onEscKey.apply(this,arguments)},restrictions:function(t){var e=t.getSelectedBlocks();return o.a.find(e,(function(t){return b.a.canHaveAnimation(t)}))},canControlBeClosed:function(){return!(!this.popupManager.openedPopup||!this.popupManager.closeAllPopups())||(!!this.waitingForTriggerClick||a.a.prototype.canControlBeClosed.apply(this,arguments))},destroy:function(){this.selected&&this.deselect(),this.willRestoreAnimationMode=!1,this.removeTriggerButtons(),g.prototype.destroy.apply(this,arguments)}}),G=m.a.Model.extend({initialize:function(t){o.a.bindAll(this),this.control=t.control,this.pid=t.pid,this.undoIndex=-1,this.undoStack=[],this.add.__debounced=o.a.debounce(this.add,300),this.historyTriggers=y.a.setCustomHandlers({undo:this.undo,redo:this.redo,getLength:this.getLength})},isEmpty:function(){return-1==this.undoIndex},add:function(t,e){e=e||{},-1!=this.undoIndex&&o.a.isEqual(this.undoStack[this.undoIndex].animation,t)||(o.a.isEmpty(t)&&(t={}),this.undoIndex>=0&&e.historyMergeID&&e.historyMergeID==this.undoStack[this.undoIndex].historyMergeID||this.undoIndex++,this.undoStack[this.undoIndex]={animation:t,historyMergeID:e.historyMergeID},this.undoStack.length=this.undoIndex+1,this.historyTriggers.triggerChange(this.pid))},undo:function(t){this.undoIndex>0&&(this.undoIndex--,this.control.setAnimations(this.undoStack[this.undoIndex].animation,{undo:!0}),this.control.updateAll({undo:!0}),this.historyTriggers.triggerChange(this.pid),this.historyTriggers.triggerUndo(this.pid))},redo:function(t){this.undoIndex<this.undoStack.length-1&&(this.undoIndex++,this.control.setAnimations(this.undoStack[this.undoIndex].animation,{redo:!0}),this.control.updateAll({redo:!0}),this.historyTriggers.triggerChange(this.pid),this.historyTriggers.triggerRedo(this.pid))},getLength:function(t){return{undo:this.undoIndex,redo:this.undoStack.length-1-this.undoIndex,page:t}},destroy:function(){y.a.removeCustomHandlers()}});function q(t){this.popups={},this.openedPopup="",o.a.bindAll(this),this.closeAllPopups.__debounced=o.a.debounce(this.closeAllPopups,50)}q.prototype.addPopup=function(t){t.onClick=o.a.bind((function(e){e&&Object(u.a)(e.target).closest(t.popupSelector).length>0||this.onClick(t.name,e.currentTarget)}),this),t.$parent.on("click",t.selector,t.onClick),t.$parent.on("click",this.closeAllPopups.__debounced),this.popups[t.name]=t},q.prototype.onClick=function(t,e){this.openedPopup==t?this.closePopup(t):this.openPopup(t,e)},q.prototype.closePopup=function(t){this.openedPopup==t&&this.popups[t]&&(this.openedPopup="",Object(u.a)(this.popups[t].selector,this.popups[t].$parent).removeClass("opened"),this.popups[t].cbClose&&this.popups[t].cbClose())},q.prototype.openPopup=function(t,e){this.openedPopup!=t&&this.popups[t]&&(this.openedPopup&&this.closePopup(this.openedPopup),this.openedPopup=t,Object(u.a)(e).addClass("opened"),this.popups[t].cbOpen&&this.popups[t].cbOpen(Object(u.a)(e)))},q.prototype.closeAllPopups=function(t){return!this.openedPopup||!(t&&Object(u.a)(t.target).closest(this.popups[this.openedPopup].selector).length>0)&&(this.closePopup(this.openedPopup),!0)},q.prototype.destroy=function(){for(var t in this.popups)this.popups[t].$parent.off("click",this.popups[t].selector,this.popups[t].onClick),this.popups[t].$parent.off("click",this.closeAllPopups.__debounced);delete this.popups};var K=W,Y=i("Kw5r"),X=i("G50q"),Z=i.n(X),J=a.a.extend({name:"common_pack",className:"control common_pack",initialize:function(t){this.template=Z.a["template-constructor-control-common_pack"],this.initControl(t)},bindLogic:function(){RM.constructorRouter.bindGlobalKeyPress([{key:"g",handler:this.onClick,optionKeys:Modernizr.mac?"meta":"ctrl"}])},unBindLogic:function(){RM.constructorRouter.unbindGlobalKeyPress("g",this.onClick)},restrictions:function(t){var e={},i=o.a.reduce(t.getSelectedBlocks(),(function(t,i){var n=i.model.get("pack_id"),o=n&&e[n]?0:1;return e[n]=1,t+o}),0)>1,n=o.a.uniq(o.a.map(t.getSelectedBlocks(),(function(t){var e=!!t.model.get("fixed_position");return e=e||!1}))).length<=1,a=o.a.uniq(o.a.map(t.getSelectedBlocks(),(function(t){return!!t.model.get("is_global")}))).length<=1,r=o.a.uniq(o.a.map(t.getSelectedBlocks(),(function(t){return!!t.model.get("is_above")}))).length<=1;return i&&n&&a&&r},onClick:function(){var t=_.default.generateUUID();Y.default.nextTick(function(){var e=o.a.map(this.models,(function(e){var i={_id:e.id,pack_id:t};return e.get("is_locked")&&(e.set("is_locked",!1),o.a.extend(i,{is_locked:!1})),i}));this.master.workspace.set_group(e),Object(n.a)("constructor.zIndex")?(RM.constructorRouter.indexController.doPack(this.models,this.master.workspace.page,this.master.workspace.page.getCurrentViewport(),t),this.master.workspace.save_group(this.models),RM.constructorRouter.indexController.saveAffectedPages()):this.master.workspace.save_group(this.models),this.master.deselect()}.bind(this))}}),Q=i("HIJs"),tt=i.n(Q),et=a.a.extend({name:"common_unpack",className:"control common_unpack",initialize:function(t){this.template=tt.a["template-constructor-control-common_unpack"],this.initControl(t)},bindLogic:function(){RM.constructorRouter.bindGlobalKeyPress([{key:"g",handler:this.onClick,optionKeys:Modernizr.mac?["meta","shift"]:["ctrl","shift"]}])},unBindLogic:function(){RM.constructorRouter.unbindGlobalKeyPress("g",this.onClick)},restrictions:function(t){return o.a.reduce(t.getSelectedBlocks(),(function(t,e){return t+(e.model.get("pack_id")?1:0)}),0)>0},onClick:function(){var t=o.a.map(this.models,(function(t){var e={_id:t.id,pack_id:null};return t.get("is_locked")&&(t.set("is_locked",!1),o.a.extend(e,{is_locked:!1})),e}));this.master.workspace.set_group(t),Object(n.a)("constructor.zIndex")?(RM.constructorRouter.indexController.doUnpack(this.models,this.master.workspace.page,this.master.workspace.page.getCurrentViewport()),this.master.workspace.save_group(this.models),RM.constructorRouter.indexController.saveAffectedPages()):this.master.workspace.save_group(this.models),this.master.deselect()}}),it={props:{selected:!1,alt:null,svgIcon:null,iconClass:null}},nt=i("KHd+"),ot=Object(nt.a)(it,(function(){var t,e=this.$createElement,i=this._self._c||e;return i("div",{directives:[{name:"svginject",rawName:"v-svginject"}],staticClass:"icon preloader noarrow",class:(t={},t[this.iconClass]=!!this.iconClass,t["rmalttext-disable"]=this.selected,t),attrs:{"data-alt":this.alt,"data-alt-pos":"left","data-alt-offset":"9"}},[this.svgIcon?i("img",{staticClass:"svg svg-icon",attrs:{src:this.svgIcon}}):this._e()])}),[],!1,null,null,null).exports,at={props:{block:Object,raw_block:Object},data:function(){return{m:{}}},computed:{Globals:function(){return window}},created:function(){this.assignBlockState(this.block)},mounted:function(){var t=this;this.$watch("m",(function(e){t.$parent.$emit("change",e)}),{deep:!0})},watch:{block:{handler:function(t){this.assignBlockState(t)},deep:!0}},methods:{$:function(t){return Object(u.a)(this.$el.querySelector(t))},assignBlockState:function(t){var e=this;o.a.each(t,(function(t,i){return e.$set(e.m,i,t)}))},canClose:function(){var t=!0;return o.a.each(this.$children,(function(e){t=!e.visibleBox&&t,e.visibleBox=!1})),t},closeOthersPopups:function(t){t&&o.a.each(this.$children,(function(e){e!=t&&(e.visibleBox=!1)}))},hide:function(){this.$parent.deselect()}}},rt=Object(nt.a)(at,void 0,void 0,!1,null,null,null).exports,st=i("tRog"),lt={mixins:[rt],components:{NumericInput:st.a},data:function(){return{m:{angle:0,flip_v:!1,flip_h:!1}}},methods:{onEnter:function(){this.$parent.$emit("deselect")},onInputChange:function(t){this.setAngle(t)},onRotate90Click:function(){this.setAngle((this.m.angle||0)+90)},onFirstFocus:function(){this.transparentSelection=!1},setAngle:function(t){if(t=(t=t>=360?t-360:t)<=-360?t+360:t,this.raw_block.workspace.spacesController){var e=Math.abs(Math.cos(this.m.angle/180*Math.PI)),i=Math.abs(Math.sin(this.m.angle/180*Math.PI)),n=Math.abs(Math.cos(t/180*Math.PI)),o=Math.abs(Math.sin(t/180*Math.PI)),a=(this.m.w,this.m.h,this.m.w*o+this.m.h*n),r=this.m.y-a/2+this.m.h/2,s=this.raw_block.workspace.spacesController.getRestriction(this.raw_block.model,[this.raw_block.model]);(!s.canMoveTop||r<s.top)&&(this.m.y+=s.top-r)}this.m.angle=t},flipVertical:function(){this.flip("vertical")},flipHorizontal:function(){this.flip("horizontal")},flip:function(t){var e=(this.m.angle+360)%360,i=this.m.flip_v,n=this.m.flip_h,a=this.m.angle;e<=45||e>=135&&e<=225||e>=315?a=-this.m.angle:(e>45&&e<135||e>225&&e<315)&&(a=180-this.m.angle),"vertical"===t?i=!this.m.flip_v:n=!this.m.flip_h;var r={angle:a,flip_v:i,flip_h:n};o.a.extend(this.m,r)}}},ct=Object(nt.a)(lt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel"},[i("div",{staticClass:"param-caption"},[t._v("Rotate")]),t._v(" "),i("div",{staticClass:"input-wrapper",class:{negative:t.m.angle<0}},[i("span",{staticClass:"balance-deg"},[t._v("°")]),t._v(" "),i("numeric-input",{attrs:{value:t.m.angle,autofocus:!0,autosize:!0,wait:200,min:-360,max:360,dir:"v",speed:4,"shift-step":15},on:{change:t.onInputChange},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnter(e)}}}),t._v(" "),i("span",{staticClass:"deg"},[t._v("°")]),t._v(" "),i("span",{staticClass:"balance-minus"},[t._v("-")])],1),t._v(" "),i("div",{staticClass:"separator"}),t._v(" "),i("div",{staticClass:"flip-h",on:{click:t.flipHorizontal}}),t._v(" "),i("div",{staticClass:"flip-v",on:{click:t.flipVertical}}),t._v(" "),i("div",{staticClass:"rotate90",on:{click:t.onRotate90Click}})])}),[],!1,null,null,null).exports,dt=i("gP9L"),ht=i("RLXn"),ut=i("uGDn"),pt=i("XHB6"),mt={components:{FontFamilySelector:dt.a,FontStyleSelector:ht.a,RmSwitcher:ut.a,NumericInput:st.a,ColorPicker:pt.a},mixins:[rt],data:function(){return{shapes:["rectangle","circle","square"],states:["default","hover","current"],state:"default"}},computed:{maxBorderWidth:function(){return Math.ceil(Math.min(this.w,this.h)/2)}},watch:{state:function(t){Object(u.a)(".common-button",this.raw_block.$el).toggleClass("hovered","hover"===t),Object(u.a)(".common-button",this.raw_block.$el).toggleClass("current","current"===t)}},destroyed:function(){this.setCorrectIconColor("default"),Object(u.a)(".common-button",this.raw_block.$el).toggleClass("hovered",!1),Object(u.a)(".common-button",this.raw_block.$el).toggleClass("current",!1)},mounted:function(){var t=this.m.clickLink;if(t&&this.m.is_global&&Object(u.a)(".controls .control.picture_link .placeholder-selector").hasClass("hidden"))if(/^http(s?)\:\/\//i.test(t)||/^mailto\:/i.test(t)||/^tel\:/i.test(t))this.states.pop();else{var e=t;RM.constructorRouter.mag.getPageUri(e)||this.states.pop()}else this.states.pop()},methods:{changeShapeHandler:function(t){this.m.form=t,this.closeOthersPopups(null)},changeStateHandler:function(t){this.state=t,this.closeOthersPopups(null),this.setCorrectIconColor(t)},changePropHandler:function(t,e){this.m[t]=e},setCorrectIconColor:function(t){this.raw_block.onIconColorChange(this.m,null,{},t)}}},gt=Object(nt.a)(mt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel"},[i("div",{staticClass:"row shape-type"},t._l(t.shapes,(function(e){var n;return i("div",{key:e,class:(n={shape:!0},n[e]=!0,n.current=t.m.form===e,n),on:{click:function(i){return t.changeShapeHandler(e)}}})})),0),t._v(" "),i("div",{staticClass:"row state-switcher-wrapper"},t._l(t.states,(function(e){var n;return i("div",{key:e,class:(n={"state-switcher":!0},n["caption-"+e]=!0,n.current=e===t.state,n),on:{click:function(i){return t.changeStateHandler(e)}}},[t._v("\n      "+t._s(e)+"\n    ")])})),0),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["background-color"],alpha:t.m["background-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("background-color",e)},"update:alpha":function(e){return t.changePropHandler("background-color-opacity",e)}}})],1):t._e(),t._v(" "),"hover"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-background-color"],alpha:t.m["hover-background-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-background-color",e)},"update:alpha":function(e){return t.changePropHandler("hover-background-color-opacity",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["current-background-color"],alpha:t.m["current-background-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("current-background-color",e)},"update:alpha":function(e){return t.changePropHandler("current-background-color-opacity",e)}}})],1):t._e(),t._v(" "),"default"===t.state&&"circle"!==t.m.form?i("div",{staticClass:"row"},[i("div",{staticClass:"caption input-correction"},[t._v("Radius")]),t._v(" "),i("numeric-input",{class:{"num-input":!0,"one-digit":t.m["border-radius"]<10,"two-digit":t.m["border-radius"]<100&&t.m["border-radius"]>9,"three-digit":t.m["border-radius"]>99},attrs:{autosize:!0,value:t.m["border-radius"],min:0,max:999},on:{change:function(e){return t.changePropHandler("border-radius",e)}}})],1):t._e(),t._v(" "),"current"===t.state&&"circle"!==t.m.form?i("div",{staticClass:"row"},[i("div",{staticClass:"caption input-correction"},[t._v("Radius")]),t._v(" "),i("numeric-input",{class:{"num-input":!0,"one-digit":t.m["current-border-radius"]<10,"two-digit":t.m["current-border-radius"]<100&&t.m["current-border-radius"]>9,"three-digit":t.m["current-border-radius"]>99},attrs:{autosize:!0,value:t.m["current-border-radius"],min:0,max:999},on:{change:function(e){return t.changePropHandler("current-border-radius",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption input-correction"},[t._v("Border")]),t._v(" "),i("numeric-input",{class:{"num-input":!0,"one-digit":t.m["border-width"]<10,"two-digit":t.m["border-width"]<100&&t.m["border-width"]>9,"three-digit":t.m["border-width"]>99},attrs:{autosize:!0,value:t.m["border-width"],min:0,max:999},on:{change:function(e){return t.changePropHandler("border-width",e)}}})],1):t._e(),t._v(" "),"hover"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption input-correction"},[t._v("Border")]),t._v(" "),i("numeric-input",{class:{"num-input":!0,"one-digit":t.m["hover-border-width"]<10,"two-digit":t.m["hover-border-width"]<100&&t.m["hover-border-width"]>9,"three-digit":t.m["hover-border-width"]>99},attrs:{autosize:!0,value:t.m["hover-border-width"]},on:{change:function(e){return t.changePropHandler("hover-border-width",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption input-correction"},[t._v("Border")]),t._v(" "),i("numeric-input",{class:{"num-input":!0,"one-digit":t.m["current-border-width"]<10,"two-digit":t.m["current-border-width"]<100&&t.m["current-border-width"]>9,"three-digit":t.m["current-border-width"]>99},attrs:{autosize:!0,value:t.m["current-border-width"],min:0,max:999},on:{change:function(e){return t.changePropHandler("current-border-width",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["border-color"],alpha:t.m["border-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("border-color",e)},"update:alpha":function(e){return t.changePropHandler("border-color-opacity",e)}}})],1):t._e(),t._v(" "),"hover"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-border-color"],alpha:t.m["hover-border-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-border-color",e)},"update:alpha":function(e){return t.changePropHandler("hover-border-color-opacity",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["current-border-color"],alpha:t.m["current-border-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("current-border-color",e)},"update:alpha":function(e){return t.changePropHandler("current-border-color-opacity",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row font-family-click-area",attrs:{title:"Font Family"}},[i("font-family-selector",{attrs:{family:t.m["font-family"]},on:{showPopup:t.closeOthersPopups,change:function(e){return t.changePropHandler("font-family",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row font-family-click-area",attrs:{title:"Font Family"}},[i("font-family-selector",{attrs:{family:t.m["current-font-family"]},on:{showPopup:t.closeOthersPopups,change:function(e){return t.changePropHandler("current-font-family",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row font-style-click-area",attrs:{title:"Font Style"}},[i("font-style-selector",{style:{"font-family":t.m["font-family"]},attrs:{"font-style":[t.m["font-style"]],"font-weight":[t.m["font-weight"]],"font-family":[t.m["font-family"]]},on:{showPopup:t.closeOthersPopups,"update:fontStyle":function(e){return t.changePropHandler("font-style",e)},"update:fontWeight":function(e){return t.changePropHandler("font-weight",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row font-style-click-area",attrs:{title:"Font Style"}},[i("font-style-selector",{style:{"font-family":t.m["current-font-family"]},attrs:{"font-style":[t.m["current-font-style"]],"font-weight":[t.m["current-font-weight"]],"font-family":[t.m["current-font-family"]]},on:{showPopup:t.closeOthersPopups,"update:fontStyle":function(e){return t.changePropHandler("current-font-style",e)},"update:fontWeight":function(e){return t.changePropHandler("current-font-weight",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m.color,alpha:t.m["color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("color",e)},"update:alpha":function(e){return t.changePropHandler("color-opacity",e)}}})],1):t._e(),t._v(" "),"hover"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-color"],alpha:t.m["hover-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-color",e)},"update:alpha":function(e){return t.changePropHandler("hover-color-opacity",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["current-color"],alpha:t.m["current-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("current-color",e)},"update:alpha":function(e){return t.changePropHandler("current-color-opacity",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m.icon_color,alpha:t.m.icon_color_opacity},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("icon_color",e)},"update:alpha":function(e){return t.changePropHandler("icon_color_opacity",e)}}})],1):t._e(),t._v(" "),"hover"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-icon_color"],alpha:t.m["hover-icon_color_opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-icon_color",e)},"update:alpha":function(e){return t.changePropHandler("hover-icon_color_opacity",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon Color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["current-icon_color"],alpha:t.m["current-icon_color_opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("current-icon_color",e)},"update:alpha":function(e){return t.changePropHandler("current-icon_color_opacity",e)}}})],1):t._e(),t._v(" "),"hover"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Transition")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#2d90ff"},model:{value:t.m.transition,callback:function(e){t.$set(t.m,"transition",e)},expression:"m['transition']"}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"font-size-icon"}),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["font-size"],min:8,max:999},on:{change:function(e){return t.changePropHandler("font-size",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"font-size-icon"}),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["current-font-size"],min:8,max:999},on:{change:function(e){return t.changePropHandler("current-font-size",e)}}})],1):t._e(),t._v(" "),"default"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"letter-spacing-icon"}),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["letter-spacing"],min:-99,max:999,step:.1,"use-float":!0},on:{change:function(e){return t.changePropHandler("letter-spacing",e)}}})],1):t._e(),t._v(" "),"current"===t.state?i("div",{staticClass:"row"},[i("div",{staticClass:"letter-spacing-icon"}),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["current-letter-spacing"],min:-99,max:999,step:.1,"use-float":!0},on:{change:function(e){return t.changePropHandler("current-letter-spacing",e)}}})],1):t._e()])}),[],!1,null,null,null).exports,ft={props:{data:{type:Object}},data:function(){return{url:""}},ounted:function(){this.url=this.updateUrl()},methods:{updateUrl:function(){return"page"===this.data.use_own_url?"Using the page URL":"mag"===this.data.use_own_url?"Using the project URL":this.data.url},updateUrlData:function(t,e){this.data.url=t,this.data.use_own_url=e,this.url=this.updateUrl()}}},vt=(i("F+PN"),Object(nt.a)(ft,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"variant-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],staticClass:"input tweet-url",attrs:{readonly:!!t.data.use_own_url,placeholder:"URL"},domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}}),t._v(" "),t.data.use_own_url||t.data.url&&t.data.url===t.url?i("div",{staticClass:"input-control clear",on:{click:function(e){return e.stopPropagation(),t.updateUrlData("","")}}}):t.data.use_own_url||t.data.url||t.url?t.url!==t.data.url?i("div",{staticClass:"input-control apply",on:{click:function(e){return e.stopPropagation(),t.updateUrlData(t.url,"")}}}):t._e():i("div",{staticClass:"input-control target"},[i("div",{staticClass:"use-url-popup"},[i("ul",[i("li",{on:{click:function(e){return e.stopPropagation(),t.updateUrlData("","mag")}}},[t._v("Using the project URL")]),t._v(" "),i("li",{on:{click:function(e){return e.stopPropagation(),t.updateUrlData("","page")}}},[t._v("Using the page URL")])]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"hover-zone"})])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"corner-wrapper"},[e("div",{staticClass:"corner"})])}],!1,null,null,null).exports),bt={props:{value:{},options:{type:Array,default:function(){return[]}},arrowSize:{default:"small"},showTitles:{type:Boolean,default:!1},callback:{type:Function,default:function(){}}},data:function(){return{isOpened:!1}},computed:{caption:function(){return(o.a.findWhere(this.options,{value:this.value})||{}).caption}},methods:{onClick:function(t){this.isOpened=!this.isOpened},emitValue:function(t){t.disabled||(this.$emit("input",t.value),this.callback(t))}}},yt=(i("muOB"),Object(nt.a)(bt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"selector",class:{opened:t.isOpened},on:{click:t.onClick}},[i("div",{staticClass:"types-popup"},t._l(t.options,(function(e){return i("div",{key:e.value,staticClass:"type-item",class:{curr:e.value===t.value,disabled:!!e.disabled},attrs:{title:t.showTitles?e.caption:""},on:{click:function(i){return t.emitValue(e)}}},[t._t("listitem",[t._v("\n        "+t._s(e.caption)+"\n        "),i("div",{staticClass:"point"})],{option:e,value:t.value})],2)})),0),t._v(" "),i("div",{staticClass:"caption"},[i("div",{staticClass:"caption-inner"},[t._v(t._s(t.caption))])]),t._v(" "),"small"===this.arrowSize?i("div",{staticClass:"popup-arrow"}):t._e(),t._v(" "),"big"===this.arrowSize?i("div",{staticClass:"popup-arrow-big"},[i("svg",{attrs:{width:"12",height:"7",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M5.24 6.114L1.416 1.651A1 1 0 0 1 2.175 0h7.65a1 1 0 0 1 .76 1.65L6.759 6.115a1 1 0 0 1-1.518 0z","fill-rule":"evenodd"}})])]):t._e()])}),[],!1,null,"473f91c6",null).exports),_t={props:{value:{type:String},prefix:{type:String,default:""}},data:function(){return{text:""}},mounted:function(){this.text=this.value}},wt=(i("/0Qt"),Object(nt.a)(_t,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"apply-input"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"input",class:{"no-prefix":!t.prefix},attrs:{placeholder:"Username"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}}),t._v(" "),i("div",{staticClass:"input-prefix"},[t._v(t._s(t.prefix))]),t._v(" "),t.value!=t.text?i("div",{staticClass:"input-control apply",on:{click:function(e){return e.stopPropagation(),t.$emit("input",t.text)}}}):t.value?i("div",{staticClass:"input-control clear",on:{click:function(e){e.stopPropagation(),t.$emit("input",""),t.text=""}}}):t._e()])}),[],!1,null,null,null).exports),kt={mixins:[rt],components:{RmVariantInput:vt,RmSwitcher:ut.a,RmSelect:yt,RmApplyInput:wt}},St=Object(nt.a)(kt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel"},[i("div",{staticClass:"panel-title"},[t._v("Twitter")]),t._v(" "),i("rm-select",{attrs:{options:[{value:"type_timeline",caption:"User Timeline"},{value:"type_embed",caption:"Embed Tweet"},{value:"type_tweet",caption:"Tweet Button"},{value:"type_follow",caption:"Follow Button"},{value:"type_hashtag",caption:"Hashtag Button"}]},model:{value:t.m.current_type,callback:function(e){t.$set(t.m,"current_type",e)},expression:"m.current_type"}}),t._v(" "),"type_timeline"==t.m.current_type?i("div",[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.m.type_timeline.code,expression:"m.type_timeline.code"}],staticClass:"textarea",attrs:{placeholder:"Paste embed code here"},domProps:{value:t.m.type_timeline.code},on:{input:function(e){e.target.composing||t.$set(t.m.type_timeline,"code",e.target.value)}}}),t._v(" "),t._m(0)]):t._e(),t._v(" "),"type_embed"==t.m.current_type?i("div",[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.m.type_embed.code,expression:"m.type_embed.code"}],staticClass:"textarea",attrs:{placeholder:"Paste embed code here"},domProps:{value:t.m.type_embed.code},on:{input:function(e){e.target.composing||t.$set(t.m.type_embed,"code",e.target.value)}}}),t._v(" "),t._m(1)]):t._e(),t._v(" "),"type_tweet"==t.m.current_type?i("div",[i("div",{staticClass:"input-wrapper"},[i("rm-variant-input",{attrs:{data:t.m.type_tweet}})],1),t._v(" "),i("div",{staticClass:"sep-line"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Large button")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#3366cc","color-off":"rgba(75, 75, 75, 0.4)"},model:{value:t.m.type_tweet.large_button,callback:function(e){t.$set(t.m.type_tweet,"large_button",e)},expression:"m.type_tweet.large_button"}})],1)]):t._e(),t._v(" "),"type_follow"==t.m.current_type?i("div",[i("div",{staticClass:"input-wrapper"},[i("rm-apply-input",{attrs:{prefix:"@"},model:{value:t.m.type_follow.username,callback:function(e){t.$set(t.m.type_follow,"username",e)},expression:"m.type_follow.username"}})],1),t._v(" "),i("div",{staticClass:"sep-line"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Show name")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#3366cc","color-off":"rgba(75, 75, 75, 0.4)"},model:{value:t.m.type_follow.show_name,callback:function(e){t.$set(t.m.type_follow,"show_name",e)},expression:"m.type_follow.show_name"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Large button")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#3366cc","color-off":"rgba(75, 75, 75, 0.4)"},model:{value:t.m.type_follow.large_button,callback:function(e){t.$set(t.m.type_follow,"large_button",e)},expression:"m.type_follow.large_button"}})],1)]):t._e(),t._v(" "),"type_hashtag"==t.m.current_type?i("div",[i("div",{staticClass:"input-wrapper"},[i("rm-apply-input",{attrs:{prefix:"#"},model:{value:t.m.type_hashtag.hash,callback:function(e){t.$set(t.m.type_hashtag,"hash",e)},expression:"m.type_hashtag.hash"}})],1),t._v(" "),i("div",{staticClass:"sep-line"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Large button")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#3366cc","color-off":"rgba(75, 75, 75, 0.4)"},model:{value:t.m.type_hashtag.large_button,callback:function(e){t.$set(t.m.type_hashtag,"large_button",e)},expression:"m.type_hashtag.large_button"}})],1)]):t._e()],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"center"},[e("a",{staticClass:"embed-tutorial",attrs:{target:"_blank",href:"https://dev.twitter.com/docs/embedded-timelines"}},[this._v("How to embed Timeline")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"center"},[e("a",{staticClass:"embed-tutorial",attrs:{target:"_blank",href:"https://dev.twitter.com/docs/embedded-tweets"}},[this._v("How to embed Tweet")])])}],!1,null,null,null).exports,xt=i("VZqm"),Ct={mixins:[rt],components:{RmVariantInput:vt,RmSwitcher:ut.a,RmSpinner:xt.a,RmSelect:yt,RmApplyInput:wt,NumericInput:st.a}},Ot=Object(nt.a)(Ct,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel"},[i("div",{staticClass:"panel-title"},[t._v("Facebook")]),t._v(" "),i("rm-select",{attrs:{options:[{value:"type_like_button",caption:"Like Button"},{value:"type_page",caption:"Page"},{value:"type_comments",caption:"Comments"}]},model:{value:t.m.current_type,callback:function(e){t.$set(t.m,"current_type",e)},expression:"m.current_type"}}),t._v(" "),"type_like_button"==t.m.current_type?i("div",[i("div",{staticClass:"input-wrapper"},[i("rm-variant-input",{attrs:{data:t.m.type_like_button}})],1),t._v(" "),i("div",[i("rm-spinner",{attrs:{variants:[{value:"standard",title:"Standard Layout"},{value:"button_count",title:"Button Count"},{value:"box_count",title:"Box Count"}]},model:{value:t.m.type_like_button.layout,callback:function(e){t.$set(t.m.type_like_button,"layout",e)},expression:"m.type_like_button.layout"}})],1),t._v(" "),i("div",{staticClass:"sep-line"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Share Button")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#2d90ff","color-off":"#313131"},model:{value:t.m.type_like_button.share_button,callback:function(e){t.$set(t.m.type_like_button,"share_button",e)},expression:"m.type_like_button.share_button"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Show Faces")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#2d90ff","color-off":"#313131"},model:{value:t.m.type_like_button.show_faces,callback:function(e){t.$set(t.m.type_like_button,"show_faces",e)},expression:"m.type_like_button.show_faces"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Color")]),t._v(" "),i("div",{staticClass:"theme-picker",class:t.m.type_like_button.theme},[i("div",{staticClass:"theme light",on:{click:function(e){e.stopPropagation(),t.m.type_like_button.theme="light"}}}),t._v(" "),i("div",{staticClass:"theme dark",on:{click:function(e){e.stopPropagation(),t.m.type_like_button.theme="dark"}}})])])]):t._e(),t._v(" "),"type_page"==t.m.current_type?i("div",[i("div",{staticClass:"input-wrapper"},[i("rm-apply-input",{model:{value:t.m.type_page.url,callback:function(e){t.$set(t.m.type_page,"url",e)},expression:"m.type_page.url"}})],1),t._v(" "),i("div",{staticClass:"sep-line"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Show Stream")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#2d90ff","color-off":"#313131"},model:{value:t.m.type_page.show_stream,callback:function(e){t.$set(t.m.type_page,"show_stream",e)},expression:"m.type_page.show_stream"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Small Header")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#2d90ff","color-off":"#313131"},model:{value:t.m.type_page.small_header,callback:function(e){t.$set(t.m.type_page,"small_header",e)},expression:"m.type_page.small_header"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Show Faces")]),t._v(" "),i("rm-switcher",{attrs:{"color-on":"#2d90ff","color-off":"#313131"},model:{value:t.m.type_page.show_faces,callback:function(e){t.$set(t.m.type_page,"show_faces",e)},expression:"m.type_page.show_faces"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Color")]),t._v(" "),i("div",{staticClass:"theme-picker",class:t.m.type_page.theme},[i("div",{staticClass:"theme light",on:{click:function(e){e.stopPropagation(),t.m.type_page.theme="light"}}}),t._v(" "),i("div",{staticClass:"theme dark",on:{click:function(e){e.stopPropagation(),t.m.type_page.theme="dark"}}})])])]):t._e(),t._v(" "),"type_comments"==t.m.current_type?i("div",[i("div",{staticClass:"input-wrapper"},[i("rm-variant-input",{attrs:{data:t.m.type_comments}})],1),t._v(" "),i("div",{staticClass:"sep-line"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Number of posts")]),t._v(" "),i("numeric-input",{attrs:{autosize:!0,min:1,max:99},model:{value:t.m.type_comments.num_posts,callback:function(e){t.$set(t.m.type_comments,"num_posts",e)},expression:"m.type_comments.num_posts"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Color")]),t._v(" "),i("div",{staticClass:"theme-picker",class:t.m.type_comments.theme},[i("div",{staticClass:"theme light",on:{click:function(e){e.stopPropagation(),t.m.type_comments.theme="light"}}}),t._v(" "),i("div",{staticClass:"theme dark",on:{click:function(e){e.stopPropagation(),t.m.type_comments.theme="dark"}}})])])]):t._e()],1)}),[],!1,null,null,null).exports,jt={components:{RmSwitcher:ut.a,RmSelect:yt},mixins:[rt],data:function(){return{m:{direction_route_type:"driving",custom_json:"",api_key:"",scrollwheel:!0},mapTypes:[{value:"standard",caption:"Standard"},{value:"directions",caption:"Directions"},{value:"custom",caption:"Custom map"}],directions:[{value:"driving",icon:"car"},{value:"transit",icon:"train"},{value:"walking",icon:"walk"},{value:"bicycling",icon:"bicycle"}],custom_json:"",api_key:"",is_json_invalid:!1}},mounted:function(){this.custom_json=this.m.custom_json,this.api_key=this.m.api_key},methods:{validateJSON:function(t){try{JSON.parse(t)}catch(t){return!1}return!0},validateApiKey:function(t){if(t)return 39===t.length},onRemove:function(){this.api_key="",this.m.api_key=""}},watch:{custom_json:o.a.debounce((function(t){!t||this.validateJSON(t)?(this.m.custom_json=t,this.is_json_invalid=!1):this.is_json_invalid=!0}),500),api_key:o.a.debounce((function(t){t&&!this.validateApiKey(t)||(this.m.api_key=t)}),500),"m.api_key":function(){this.api_key=this.m.api_key}}},Pt=Object(nt.a)(jt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel"},[i("div",{staticClass:"param-caption"},[t._v("Google Maps")]),t._v(" "),i("div",{staticClass:"param",attrs:{"data-param":"code"}},[t.m.api_key&&t.validateApiKey(t.m.api_key)?t._e():i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.api_key,expression:"api_key"}],staticClass:"input",class:[{error:t.api_key&&!t.validateApiKey(t.api_key)}],attrs:{placeholder:"API Key",minlength:"39",maxlength:"39",required:""},domProps:{value:t.api_key},on:{input:function(e){e.target.composing||(t.api_key=e.target.value)}}})]),t._v(" "),t.m.api_key&&t.validateApiKey(t.m.api_key)?i("div",{staticClass:"gmap-api-enabled"},[i("span",[t._v("API Key Enabled")]),t._v(" "),i("div",{ref:"remove",staticClass:"remove map-icon",attrs:{"data-alt":"Delete Google Maps API Key "+t.m.api_key,"data-alt-style":"controls-gmap-icon-tooltip"},on:{click:t.onRemove}},[i("svg",{attrs:{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("circle",{attrs:{cx:"12",cy:"12",r:"12"}}),t._v(" "),i("path",{attrs:{d:"M12 10.586l4.536-4.536a1 1 0 0 1 1.414 1.414L13.414 12l4.536 4.536a1 1 0 0 1-1.414 1.414L12 13.414 7.464 17.95a1 1 0 0 1-1.414-1.414L10.586 12 6.05 7.464A1 1 0 0 1 7.464 6.05L12 10.586z","fill-rule":"nonzero"}})])])]),t._v(" "),i("a",{ref:"question-enabled",staticClass:"question map-icon",attrs:{href:"https://help.readymag.com/hc/en-us/articles/360020526932-Google-Maps",rel:"noreferrer noopener",target:"_blank","data-alt-style":"controls-gmap-icon-tooltip"}},[i("svg",{attrs:{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("circle",{attrs:{cx:"12",cy:"12",r:"12"}}),t._v(" "),i("path",{attrs:{d:"M8 9.259C8.06 7.371 9.294 6 11.542 6 13.615 6 15 7.259 15 9.02c0 1.219-.575 2.072-1.604 2.717-.992.614-1.272 1.02-1.272 1.809V14H10.37l-.008-.542c-.068-1.195.37-1.912 1.415-2.558.939-.597 1.256-1.02 1.256-1.808 0-.83-.635-1.427-1.589-1.427-.976 0-1.604.622-1.665 1.594H8zM11.5 18c-.904 0-1.5-.592-1.5-1.495 0-.913.596-1.505 1.5-1.505.922 0 1.5.592 1.5 1.505 0 .903-.578 1.495-1.5 1.495z"}})])])])]):t._e(),t._v(" "),t.m.api_key||t.api_key?t._e():i("a",{ref:"question-disabled",staticClass:"question map-icon",attrs:{href:"http://help.readymag.com/hc/en-us/articles/360020526932-Google-Maps",rel:"noreferrer noopener",target:"_blank","data-alt-style":"controls-gmap-icon-tooltip"}},[i("svg",{attrs:{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("circle",{attrs:{cx:"12",cy:"12",r:"12"}}),t._v(" "),i("path",{attrs:{d:"M8 9.259C8.06 7.371 9.294 6 11.542 6 13.615 6 15 7.259 15 9.02c0 1.219-.575 2.072-1.604 2.717-.992.614-1.272 1.02-1.272 1.809V14H10.37l-.008-.542c-.068-1.195.37-1.912 1.415-2.558.939-.597 1.256-1.02 1.256-1.808 0-.83-.635-1.427-1.589-1.427-.976 0-1.604.622-1.665 1.594H8zM11.5 18c-.904 0-1.5-.592-1.5-1.495 0-.913.596-1.505 1.5-1.505.922 0 1.5.592 1.5 1.505 0 .903-.578 1.495-1.5 1.495z"}})])])])]),t._v(" "),i("rm-select",{staticClass:"map-type-select",class:[{"no-line":"directions"===t.m.current_type||"custom"===t.m.current_type}],attrs:{options:t.mapTypes,"arrow-size":"big"},model:{value:t.m.current_type,callback:function(e){t.$set(t.m,"current_type",e)},expression:"m.current_type"}}),t._v(" "),i("div",{staticClass:"types-param"},["custom"==t.m.current_type?i("div",{staticClass:"type-param",attrs:{"data-type":"custom"}},[i("div",{staticClass:"param",attrs:{"data-param":"code"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.custom_json,expression:"custom_json"}],staticClass:"custom-json",class:{error:t.is_json_invalid,empty:!t.custom_json},attrs:{placeholder:"Paste JSON code",required:""},domProps:{value:t.custom_json},on:{input:function(e){e.target.composing||(t.custom_json=e.target.value)}}})]),t._v(" "),t._m(0)]):t._e(),t._v(" "),"directions"==t.m.current_type?i("div",{staticClass:"type-param",attrs:{"data-type":"directions"}},[i("div",{staticClass:"param",attrs:{"data-param":"route_type"}},[i("div",{staticClass:"route-switcher"},t._l(t.directions,(function(e,n){return i("div",{key:n,staticClass:"route-item",class:{active:t.m.direction_route_type===e.value},on:{click:function(i){t.m.direction_route_type=e.value}}},[i("div",{staticClass:"route-icon",class:[e.icon]})])})),0)])]):t._e()]),t._v(" "),i("div",{staticClass:"map-controls"},[i("div",{staticClass:"map-control"},[i("div",{staticClass:"caption"},[t._v("Controls")]),t._v(" "),i("rm-switcher",{staticClass:"controls-switcher",attrs:{"color-off":"#B8B8B8","color-on":"#0080FF",height:24,width:40},model:{value:t.m.show_controls,callback:function(e){t.$set(t.m,"show_controls",e)},expression:"m.show_controls"}})],1),t._v(" "),i("div",{staticClass:"map-control"},[i("div",{staticClass:"caption"},[t._v("Zoom on scroll")]),t._v(" "),i("rm-switcher",{staticClass:"controls-switcher",attrs:{"color-off":"#B8B8B8","color-on":"#0080FF",height:24,width:40},model:{value:t.m.scrollwheel,callback:function(e){t.$set(t.m,"scrollwheel",e)},expression:"m.scrollwheel"}})],1)])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wizard-link"},[e("a",{attrs:{target:"_blank",href:"https://mapstyle.withgoogle.com/"}},[this._v("Launch Maps Wizard")])])}],!1,null,null,null).exports,Et=i("X7yJ"),It=i("TBxE"),Tt=i("wrlV"),Mt=i("Wa0v"),$t=i("Ragx"),At=(i("RLiD"),Object(nt.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"26",height:"26",viewBox:"0 0 26 26",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M8 1V0C3.58172 0 0 3.58172 0 8H1C1 4.13401 4.13401 1 8 1Z"}}),this._v(" "),e("path",{attrs:{d:"M0 18H1C1 21.866 4.13401 25 8 25V26C3.58172 26 0 22.4183 0 18Z"}}),this._v(" "),e("path",{attrs:{d:"M18 26V25C21.866 25 25 21.866 25 18H26C26 22.4183 22.4183 26 18 26Z"}}),this._v(" "),e("path",{attrs:{d:"M26 8H25C25 4.13401 21.866 1 18 1V0C22.4183 0 26 3.58172 26 8Z"}})])}),[],!1,null,"25dfac1a",null).exports),Rt=(i("SH8X"),Object(nt.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24.2969 10.6761C23.8281 10.2254 23.2625 10 22.6 10H20.5L20.0219 8.77404C19.9031 8.47957 19.6859 8.22566 19.3703 8.01232C19.0547 7.79898 18.7312 7.69231 18.4 7.69231H13.6C13.2687 7.69231 12.9453 7.79898 12.6297 8.01232C12.3141 8.22566 12.0969 8.47957 11.9781 8.77404L11.5 10H9.4C8.7375 10 8.17188 10.2254 7.70312 10.6761C7.23438 11.1268 7 11.6707 7 12.3077V19.6923C7 20.3293 7.23438 20.8732 7.70312 21.3239C8.17188 21.7746 8.7375 22 9.4 22H22.6C23.2625 22 23.8281 21.7746 24.2969 21.3239C24.7656 20.8732 25 20.3293 25 19.6923V12.3077C25 11.6707 24.7656 11.1268 24.2969 10.6761ZM20 16C20 18.2091 18.2091 20 16 20C13.7909 20 12 18.2091 12 16C12 13.7909 13.7909 12 16 12C18.2091 12 20 13.7909 20 16ZM18 16C18 17.1046 17.1046 18 16 18C14.8954 18 14 17.1046 14 16C14 14.8954 14.8954 14 16 14C17.1046 14 18 14.8954 18 16Z"}})])}),[],!1,null,"5dafcb28",null).exports),Dt=(i("Q/Wd"),Object(nt.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.99768 21C12.7575 21 14.9949 18.7614 14.9949 16C14.9949 13.2386 12.7575 11 9.99768 11C7.23781 11 5.00049 13.2386 5.00049 16C5.00049 18.7614 7.23781 21 9.99768 21ZM21.9972 21C24.7571 21 26.9944 18.7614 26.9944 16C26.9944 13.2386 24.7571 11 21.9972 11C19.2373 11 17 13.2386 17 16C17 18.7614 19.2373 21 21.9972 21Z"}})])}),[],!1,null,"108f96df",null).exports),Bt=i("C84a"),Lt={components:{NumericInput:st.a,ColorPicker:pt.a,SearchIcon:Mt.a,ArrowRightIcon:$t.a,CornersIcon:At,UnsplashLogo:Rt,FlickrLogo:Dt,XMarkIcon:Bt.a},mixins:[rt],data:function(){return{searchText:"",searchInputInFocus:!1,uploading:!1,dragging:!1,opacityActive:!1,originalSizeInactive:!1,m:{border_size:0,border_color:"F4F4F4",border_radius:0,border_radius_tl:0,border_radius_tr:0,border_radius_bl:0,border_radius_br:0,border_radius_max:!1,border_radius_independent:!1,opacity:1}}},computed:{trimmedSearchText:function(){return u.a.trim(this.searchText)},opacityInPercents:function(){return parseInt(100*this.m.opacity)},hasPicture:function(){return Y.default.nextTick(function(){this.$emit("resize")}.bind(this)),this.block.picture&&this.block.picture.url&&!this.uploading||!this.uploading&&this.raw_block&&(this.raw_block.useLambdaUrl&&this.raw_block.useLambdaUrl()||this.raw_block.tempPicture)},hasVectorPicture:function(){return this.hasPicture&&this.raw_block&&this.raw_block.isVector&&this.raw_block.isVector()},captionUploadText:function(){return this.hasPicture?this.dragging?"Drop file here":"Replace":"Drop file here"}},mounted:function(){this.uploader=new It.a(this),this.uploader.on("start",this.onStartUpload),this.uploader.on("done",this.onDoneUpload),this.uploader.on("fail",this.onFailUpload),this.uploader.on("uploadFromUrl",this.uploadFromUrl),this.raw_block.workspace.on("main-dragover",this.highlightDropZone,this),this.$watch("block.picture",(function(){var t=this.raw_block&&(this.raw_block.isVector()||this.raw_block.isAnimated());(this.block.picture&&this.block.picture.finalUrl||t&&this.block.picture.url)&&(this.uploading=!1,this.searchText="")})),this.$watch("raw_block.isLoading",(function(){this.uploading=this.raw_block.isLoading})),this.$emit("resize"),this.onScaleChange.__debounced=o.a.debounce(this.onScaleChange,100),this.raw_block.model.on("change",this.onScaleChange.__debounced),this.raw_block.on("modechanged",this.onScaleChange),this.onScaleChange()},beforeDestroy:function(){this.raw_block.workspace.off("main-dragover",this.highlightDropZone,this),this.raw_block.model.off("change",this.onScaleChange.__debounced,this),this.raw_block.off("modechanged",this.onScaleChange)},methods:{uploadOrDelete:function(t){Object(u.a)(t.target).hasClass("uploadInput")||Object(u.a)(this.$refs.uploadInput).trigger("click","stop")},uploadFromSearch:function(t){var e=u.a.trim(this.searchText);e&&(this.isURL(e)?this.uploadFromUrl(e):RM.views.searchUnsplash&&RM.views.searchUnsplash.show(e,{upload:this.uploadFromUrl}))},uploadFromUrl:function(t){var e=this;this.uploading=!0,this.raw_block.showIconLoader(),this.raw_block.loadFromUrl(t,{success:function(){},error:function(){e.onFailUpload()},save:!1}),t&&Object(Tt.b)(t).then((function(i){if(e.uploading){var n={width:i.width,height:i.height,content:t};e.uploading=!1,e.raw_block.setTempPicture(n)}})).catch((function(t){}))},cancelUpload:function(){this.uploading=!1,this.raw_block.removeTempPicture()},searchFlickr:function(){RM.views.searchFlickr&&RM.views.searchFlickr.show("",{upload:this.uploadFromUrl})},searchUnsplash:function(){RM.views.searchUnsplash&&RM.views.searchUnsplash.show("",{upload:this.uploadFromUrl,preview:this.block.setPreviewImage})},onStartUpload:function(t,e){var i=this;this.raw_block.showTempPreloader&&this.raw_block.showTempPreloader(),this.uploading=!0;var n=t.target&&t.target.files.length&&t.target.files[0];n&&Object(Tt.a)(n).then((function(t){i.uploading&&(i.uploading=!1,i.raw_block.setTempPicture(t))})).catch((function(t){}))},onDoneUpload:function(t,e){e&&e.result?this.raw_block.changePicture(e.result):this.onFailUpload()},onFailUpload:function(){this.uploading=!1,this.searchText="",this.raw_block.removeTempPicture()},highlightDropZone:function(t){var e=this;this.dragging=!0,Object(u.a)(this.$el).find(t.target).length&&this.raw_block.$el.removeClass(".replace"),clearTimeout(this.highlightTimeout),this.highlightTimeout=setTimeout((function(){e.dragging=!1}),500)},updateColor:function(t){this.m.border_color=t},showPercents:function(t){this.opacityActive=t},toggleBorderRadiusMax:function(){this.m.border_radius_max=!this.m.border_radius_max},toggleBorderRadiusIndependent:function(){this.m.border_radius_independent=!this.m.border_radius_independent,this.m.border_radius_max=!1},onBorderRadiusChange:function(){this.m.border_radius_max=!1,this.m.border_radius_independent=!1},onBorderRadiusIndependentChange:function(){this.m.border_radius_max=!1},onOpacityChange:function(t){this.m.opacity=t/100},setOriginalSize:function(){this.saving||!this.raw_block.$picture||this.originalSizeInactive||(this.raw_block.cropmode&&this.raw_block.leaveCropMode(!0),this.saving=!0,this.raw_block.model.once("sync",(function(){delete this.saving}),this),this.raw_block.setActualScale(),RM.analytics&&RM.analytics.sendEvent("Picture Scale","actual size"))},onScaleChange:function(){var t=0===this.raw_block.model.get("cropX")&&0===this.raw_block.model.get("cropY")&&this.raw_block.model.get("cropW")===this.raw_block.model.get("originalW")&&this.raw_block.model.get("cropH")===this.raw_block.model.get("originalH");this.originalSizeInactive=Math.abs(this.raw_block.model.get("scale")-1)<.01&&t||this.raw_block.isFullWidth&&this.raw_block.isFullWidth()||this.raw_block.isFullHeight&&this.raw_block.isFullHeight()||this.raw_block.isVector&&this.raw_block.isVector()},isURL:_.default.filters.isURL}},zt=(i("0HwJ"),Object(nt.a)(Lt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel picture-settings",class:{uploading:t.uploading,dragging:t.dragging,"has-picture":t.hasPicture,"has-extended-settings":!t.hasVectorPicture}},[i("div",{staticClass:"panel-caption"},[t._v("Picture")]),t._v(" "),i("div",{staticClass:"upload"},[t.searchInputInFocus?t._e():i("div",{staticClass:"upload-wrapper"},[i("div",{staticClass:"center-wrapper",on:{click:t.uploadOrDelete}},[i("div",{staticClass:"caption-upload-dop"},[t._v(t._s(t.captionUploadText))])])]),t._v(" "),i("input",{ref:"uploadInput",staticClass:"uploadInput",attrs:{type:"file",name:"upload","data-url":"/api/upload/lambda/"}}),t._v(" "),i("div",{staticClass:"search"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],class:{"has-icon":""!=t.searchText},attrs:{type:"text",spellcheck:"false",placeholder:"Search or paste URL"},domProps:{value:t.searchText},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.uploadFromSearch(e)},focus:function(e){t.searchInputInFocus=!0},blur:function(e){t.searchInputInFocus=!1},input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),t._v(" "),i("div",{staticClass:"search-icon",on:{click:t.uploadFromSearch}},[t.trimmedSearchText&&!t.isURL(t.trimmedSearchText)?i("search-icon"):t._e(),t._v(" "),t.isURL(t.trimmedSearchText)?i("arrow-right-icon"):t._e()],1)]),t._v(" "),i("div",{staticClass:"social-icons"},[i("div",{staticClass:"flickr",attrs:{title:"Flickr"},on:{click:t.searchFlickr}},[i("flickr-logo")],1),t._v(" "),i("div",{staticClass:"unsplash",attrs:{title:"Unsplash"},on:{click:t.searchUnsplash}},[i("unsplash-logo")],1)])]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"loading"},[i("div",{staticClass:"delete",on:{click:t.cancelUpload}},[i("x-mark-icon",{attrs:{width:32,height:32}})],1)]),t._v(" "),i("div",{staticClass:"panel-settings"},[i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Border")]),t._v(" "),i("numeric-input",{attrs:{autofocus:!0,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.m.border_size,callback:function(e){t.$set(t.m,"border_size",e)},expression:"m.border_size"}}),t._v(" "),i("div",{staticClass:"border-color",attrs:{title:"Color"}},[i("color-picker",{ref:"colorpicker",staticClass:"color round",attrs:{color:t.m.border_color,"show-alpha":!1},on:{"update:color":t.updateColor}})],1)],1),t._v(" "),i("div",{staticClass:"param radius"},[i("div",{staticClass:"param-caption"},[t._v("Radius")]),t._v(" "),t.m.border_radius_independent?t._e():i("div",[i("numeric-input",{class:{inactive:t.m.border_radius_max},attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},on:{change:t.onBorderRadiusChange},model:{value:t.m.border_radius,callback:function(e){t.$set(t.m,"border_radius",e)},expression:"m.border_radius"}})],1),t._v(" "),i("div",{staticClass:"border-radius-independent",class:{active:t.m.border_radius_independent},attrs:{title:"Independent corners"},on:{click:t.toggleBorderRadiusIndependent}},[i("corners-icon")],1),t._v(" "),t.m.border_radius_independent?i("div",{staticClass:"border-radius-independent-params-wrapper"},[i("div",{staticClass:"border-radius-independent-params"},[i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},on:{change:t.onBorderRadiusIndependentChange},model:{value:t.m.border_radius_tl,callback:function(e){t.$set(t.m,"border_radius_tl",e)},expression:"m.border_radius_tl"}}),t._v(" "),i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},on:{change:t.onBorderRadiusIndependentChange},model:{value:t.m.border_radius_tr,callback:function(e){t.$set(t.m,"border_radius_tr",e)},expression:"m.border_radius_tr"}})],1),t._v(" "),i("div",{staticClass:"border-radius-independent-params"},[i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},on:{change:t.onBorderRadiusIndependentChange},model:{value:t.m.border_radius_br,callback:function(e){t.$set(t.m,"border_radius_br",e)},expression:"m.border_radius_br"}}),t._v(" "),i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},on:{change:t.onBorderRadiusIndependentChange},model:{value:t.m.border_radius_bl,callback:function(e){t.$set(t.m,"border_radius_bl",e)},expression:"m.border_radius_bl"}})],1)]):t._e()]),t._v(" "),t.hasVectorPicture?t._e():i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Opacity")]),t._v(" "),i("numeric-input",{attrs:{autosize:!1,min:0,max:100,value:t.opacityInPercents,dir:"v"},on:{change:t.onOpacityChange}})],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"picture_preloader rmpreloader"},[e("div",{staticClass:"shadow"}),this._v(" "),e("div",{staticClass:"arc"})])}],!1,null,"2cfc994e",null).exports),Ft=i("f3SV"),Ut={methods:{getAudioFromUrl:function(t){var e;if(/soundcloud\.com\/.+/.test(t)||/snd\.sc\/.+/.test(t)){var i=t.replace(/\/?#?$/,""),n={url:i};e="http://soundcloud.com/oembed?format=json&url="+encodeURIComponent(i),this.audioEmbedXHR&&this.audioEmbedXHR.abort(),this.audioEmbedXHR=u.a.ajax({type:"GET",url:"/api/proxy/",dataType:"json",data:{url:e},global:!1,success:o.a.bind((function(t){t.parsed_url=this.parseUrl(t.html),t.thumbnail_url=t.thumbnail_url.replace("-large","-t300x300"),t.thumbnail_url=t.thumbnail_url.replace("-t500x500","-t300x300"),t.parsed_url?this.loadTracksData(o.a.extend(t,n),[{url:i}]):this.$emit("audioEmbedError")}),this),error:o.a.bind((function(t,e,i){"abort"!==e&&this.$emit("audioEmbedError")}),this)}),this.$emit("audioDataObtained",n)}else this.$emit("audioWrongUrl")},parseUrl:function(t){var e=t.match(/.*?src=\"(.*?)\".*?/);if(e&&e.length&&e[1]){var i=e[1].split("?"),n=i[0],a=i[1].split("&"),r=["auto_play","buying","liking","download","sharing","show_artwork","show_comments","show_playcount","color","auto_advance","show_user","visual"],s=[];return o.a.each(a,(function(t){var e=t.split("=");e[0]&&!o.a.contains(r,e[0])&&s.push(t)})),n+"?"+s.join("&")}},isURL:function(t){return/^http(s?)\:\/\//i.test(t)},scApiUrl:function(t){var e=t,i="https:"===document.location.protocol,n=(i||/^https/i.test(e)?"https":"http")+"://api.soundcloud.com/resolve?url=",o="format=json&client_id="+this.apiKey;return i&&(e=e.replace(/^http:/,"https:")),/api\./.test(e)?e+"?"+o:n+e+"&"+o},loadTracksData:function(t,e){var i=0,n={tracks:[]},o=this;if(this.apiKey){!function a(r){var s=o.scApiUrl(r.url);u.a.ajax({url:s,method:"GET",dataType:"json",success:function(s){i+=1,s.tracks?n.tracks=n.tracks.concat(s.tracks):s.duration?(s.permalink_url=r.url,n.tracks.push(s)):s.creator?e.push({url:s.uri+"/tracks"}):s.username?/favorites/.test(r.url)?e.push({url:s.uri+"/favorites"}):e.push({url:s.uri+"/tracks"}):u.a.isArray(s)&&(n.tracks=n.tracks.concat(s)),e[i]?a(e[i]):o.tracksDataIsLoaded(t,n.tracks)},error:function(t){o.$emit("audioEmbedError"),console.log("xhr : ",t)},context:this})}(e[i])}else this.$emit("audioEmbedError","No SoundCloud API key configured.")},tracksDataIsLoaded:function(t,e){e.length?((/tracks/i.test(t.parsed_url)||t.thumbnail_url&&/fb_placeholder/.test(t.thumbnail_url))&&(e[0].artwork_url?t.thumbnail_url=e[0].artwork_url.replace("-large","-t300x300"):e[0].user&&e[0].user.avatar_url&&(t.thumbnail_url=e[0].user.avatar_url.replace("-large","-t300x300")),t.title=e[0].title),t.thumbnail_url&&_.default.toHttps(t.thumbnail_url),this.$emit("audioEmbedLoaded",t)):this.$emit("audioEmbedError")}}},Nt=Object(nt.a)(Ut,void 0,void 0,!1,null,null,null).exports,Ht={props:{width:{default:32},height:{default:32}}},Vt=(i("YWqI"),Object(nt.a)(Ht,(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:this.width,height:this.height,viewBox:"0 0 32 32",fill:"none"}},[e("path",{attrs:{d:"M5 20.0014C5 20.2744 5.09897 20.4808 5.29688 20.6207C5.49481 20.7606 5.70638 20.8101 5.9316 20.7692C6.14316 20.7282 6.2916 20.6531 6.37694 20.5439C6.46224 20.4347 6.50491 20.2539 6.50491 20.0014V17.0325C6.50491 16.8209 6.43155 16.6418 6.2848 16.4951C6.13808 16.3483 5.95893 16.275 5.74735 16.275C5.5426 16.275 5.36687 16.3483 5.22012 16.4951C5.07338 16.6418 5 16.8209 5 17.0325V20.0014ZM7.35458 21.2708C7.35458 21.4687 7.42455 21.6172 7.56445 21.7161C7.70437 21.8151 7.88353 21.8646 8.10191 21.8646C8.32713 21.8646 8.50968 21.8151 8.6496 21.7161C8.78951 21.6172 8.85947 21.4687 8.85947 21.2708V14.3504C8.85947 14.1456 8.78609 13.9699 8.63937 13.8231C8.49262 13.6764 8.31347 13.603 8.10191 13.603C7.89716 13.603 7.72141 13.6764 7.57469 13.8231C7.42794 13.9699 7.35458 14.1456 7.35458 14.3504V21.2708ZM9.69893 21.5984C9.69893 21.7963 9.77059 21.9447 9.91391 22.0437C10.0572 22.1427 10.2415 22.1922 10.4667 22.1922C10.6851 22.1922 10.8643 22.1427 11.0042 22.0437C11.1441 21.9447 11.2141 21.7963 11.2141 21.5984V15.282C11.2141 15.0704 11.1407 14.8895 10.994 14.7394C10.8472 14.5892 10.6715 14.5142 10.4667 14.5142C10.2552 14.5142 10.0743 14.5892 9.92417 14.7394C9.77403 14.8895 9.69895 15.0704 9.69895 15.282V21.5984H9.69893ZM12.0535 21.6291C12.0535 22.0045 12.306 22.1922 12.8111 22.1922C13.3161 22.1922 13.5686 22.0045 13.5686 21.6291V11.3918C13.5686 10.8185 13.3946 10.4943 13.0465 10.4192C12.8213 10.3646 12.5995 10.4295 12.3811 10.6137C12.1627 10.798 12.0535 11.0573 12.0535 11.3918V21.6291H12.0535ZM14.4491 21.926V10.7878C14.4491 10.4329 14.5548 10.2213 14.7664 10.1531C15.2237 10.0439 15.6775 9.98926 16.128 9.98926C17.1722 9.98926 18.1447 10.235 19.0456 10.7263C19.9465 11.2177 20.6751 11.8883 21.2313 12.738C21.7875 13.5877 22.11 14.5244 22.1987 15.5481C22.615 15.3707 23.0586 15.282 23.5295 15.282C24.485 15.282 25.3023 15.6198 25.9814 16.2955C26.6604 16.9712 27 17.7833 27 18.732C27 19.6875 26.6604 20.503 25.9814 21.1787C25.3023 21.8544 24.4884 22.1922 23.5398 22.1922L14.6333 22.1819C14.5719 22.1615 14.5258 22.1239 14.4951 22.0693C14.4644 22.0148 14.4491 21.9669 14.4491 21.926Z"}})])}),[],!1,null,"1a0ae6aa",null).exports),Wt={components:{RmSwitcher:ut.a,RmSpinner:xt.a,ColorPicker:pt.a,SoundCloudLogoButton:Vt,ArrowRightIcon:$t.a,XMarkIcon:Bt.a},mixins:[rt,Nt],data:function(){return{state:"default",errorMessage:"",apiKey:Ft.a.SOUNDCLOUD_API,search:this.url,playerVar:["visual","standard","minimal"],playerTitle:["Visual Player","Original Player","Minimal"]}},computed:{isUrl:function(){return this.isURL(this.search)},currInd:function(){var t=this.playerVar.indexOf(this.m.current_type);return t<0?0:t}},mounted:function(){this.$on("audioWrongUrl",this.onAudioWrongUrl),this.$on("audioEmbedError",this.onAudioEmbedError),this.$on("audioEmbedLoaded",this.onAudioEmbedLoaded),this.$on("audioDataObtained",this.onAudioDataObtained),this.search=this.m.url},methods:{spinType:function(t){this.m.current_type=this.playerVar[(this.currInd+t)%3]},loadAudio:function(){this.getAudioFromUrl(this.search)},resetAudio:function(){var t={url:"",parsed_url:"",thumbnail_url:"",title:"",embed_height:void 0,resized:!1};this.search="",this.$parent.$emit("change",t),this.errorMessage=""},onAudioWrongUrl:function(){console.log("onAudioWrongUrl",arguments)},onAudioEmbedError:function(){console.log("onAudioEmbedError",arguments),this.errorMessage="Can't add track due to it's privacy settings. Try change the sharing settings of your track"},onAudioEmbedLoaded:function(t){if(t.thumbnail_url){var e=o.a.pick(t,"url","thumbnail_url","title","parsed_url","height");e.embed_height=e.height,e.height=void 0,e.resized=!1,this.$parent.$emit("change",e),this.errorMessage=""}else this.onAudioEmbedError()},onAudioDataObtained:function(){console.log("onAudioDataObtained",arguments),this.errorMessage=""}}},Gt=Object(nt.a)(Wt,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel"},[i("div",{staticClass:"panel-caption"},[t._v("SoundCloud")]),t._v(" "),i("div",{staticClass:"search"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"search-input",class:{"has-icon":t.isUrl&&!t.m.url||t.m.url},attrs:{placeholder:"Paste URL to track"},domProps:{value:t.search},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadAudio(e)},input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._v(" "),t.isUrl&&!t.m.url?i("div",{staticClass:"search-icon",on:{click:function(e){return e.stopPropagation(),t.loadAudio(e)}}},[i("arrow-right-icon")],1):t._e(),t._v(" "),t.m.url?i("div",{staticClass:"search-icon",on:{click:function(e){return e.stopPropagation(),t.resetAudio(e)}}},[i("x-mark-icon")],1):t._e()]),t._v(" "),t.m.url?t._e():i("a",{staticClass:"soundcloud-logo-button",attrs:{href:"https://soundcloud.com/",target:"_blank"}},[i("sound-cloud-logo-button")],1),t._v(" "),t.errorMessage?i("div",{staticClass:"error-message"},[t._v(t._s(t.errorMessage))]):t._e(),t._v(" "),t.m.url?i("div",{staticClass:"settings"},[i("div",{staticClass:"description"},[t._v(t._s(t.m.title))]),t._v(" "),i("rm-spinner",{attrs:{variants:[{value:"visual",title:"Visual Player"},{value:"standard",title:"Original Player"},{value:"minimal",title:"Minimal"}]},model:{value:t.m.current_type,callback:function(e){t.$set(t.m,"current_type",e)},expression:"m.current_type"}}),t._v(" "),i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Comments")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24},model:{value:t.m.comments,callback:function(e){t.$set(t.m,"comments",e)},expression:"m.comments"}})],1),t._v(" "),i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Artwork")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24},model:{value:t.m.artwork,callback:function(e){t.$set(t.m,"artwork",e)},expression:"m.artwork"}})],1),t._v(" "),i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Social")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24},model:{value:t.m.socials,callback:function(e){t.$set(t.m,"socials",e)},expression:"m.socials"}})],1),t._v(" "),i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Color")]),t._v(" "),i("color-picker",{attrs:{color:t.m.color,"show-alpha":!1},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.m.color=e}}})],1)],1):t._e()])}),[],!1,null,null,null).exports,qt=i("Vxjr");function Kt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Yt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Xt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Yt(this,"prevSVGSearch",{}),Yt(this,"defaultIcons",[{rm_id:"rm0",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/00-dots-vertical.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/00-dots-vertical.svg")},{rm_id:"rm1",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/01-dots-horizontal.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/01-dots-horizontal.svg")},{rm_id:"rm2",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/02-align-left.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/02-align-left.svg")},{rm_id:"rm3",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/03-minus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/03-minus.svg")},{rm_id:"rm4",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/04-sandwich-two-lines.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/04-sandwich-two-lines.svg")},{rm_id:"rm5",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/05-sandwich-three-lines.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/05-sandwich-three-lines.svg")},{rm_id:"rm6",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/06-plus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/06-plus.svg")},{rm_id:"rm7",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/07-checkbox.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/07-checkbox.svg")},{rm_id:"rm8",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/08-delete.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/08-delete.svg")},{rm_id:"rm9",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/09-arrow-1.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/09-arrow-1.svg")},{rm_id:"rm10",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/10-arrow-2.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/10-arrow-2.svg")},{rm_id:"rm11",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/11-arrow-3.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/11-arrow-3.svg")},{rm_id:"rm12",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/12-edit-thin.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/12-edit-thin.svg")},{rm_id:"rm13",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/13-edit-thick.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/13-edit-thick.svg")},{rm_id:"rm14",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/14-file.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/14-file.svg")},{rm_id:"rm15",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/15-flag.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/15-flag.svg")},{rm_id:"rm16",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/16-geolocation.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/16-geolocation.svg")},{rm_id:"rm17",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/17-geopin.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/17-geopin.svg")},{rm_id:"rm18",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/18-star.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/18-star.svg")},{rm_id:"rm19",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/19-heart.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/19-heart.svg")},{rm_id:"rm20",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/20-bag.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/20-bag.svg")},{rm_id:"rm21",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/21-user.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/21-user.svg")},{rm_id:"rm22",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/22-eye.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/22-eye.svg")},{rm_id:"rm23",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/23-lock.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/23-lock.svg")},{rm_id:"rm24",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/24-instacamera.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/24-instacamera.svg")},{rm_id:"rm25",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/25-camera.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/25-camera.svg")},{rm_id:"rm26",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/26-lightning.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/26-lightning.svg")},{rm_id:"rm27",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/27-play.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/27-play.svg")},{rm_id:"rm28",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/28-video.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/28-video.svg")},{rm_id:"rm29",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/29-pause.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/29-pause.svg")},{rm_id:"rm30",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/30-music-note.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/30-music-note.svg")},{rm_id:"rm31",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/31-sound-on.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/31-sound-on.svg")},{rm_id:"rm32",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/32-sound-off.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/32-sound-off.svg")},{rm_id:"rm33",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/33-mobile.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/33-mobile.svg")},{rm_id:"rm34",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/34-desktop.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/34-desktop.svg")},{rm_id:"rm35",icon_url:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/35-monitor.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/shape/default-collection/35-monitor.svg")}]),Yt(this,"defaultSlideshowRightIcons",[{rm_id:"rm_right_0",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/00-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/00-right-arrow.svg")},{rm_id:"rm_right_1",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/01-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/01-right-arrow.svg")},{rm_id:"rm_right_2",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/02-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/02-right-arrow.svg")},{rm_id:"rm_right_3",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/03-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/03-right-arrow.svg")},{rm_id:"rm_right_4",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/04-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/04-right-arrow.svg")},{rm_id:"rm_right_5",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/05-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/05-right-arrow.svg")},{rm_id:"rm_right_6",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/06-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/06-right-arrow.svg")},{rm_id:"rm_right_7",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/07-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/07-right-arrow.svg")},{rm_id:"rm_right_8",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/08-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/08-right-arrow.svg")},{rm_id:"rm_right_9",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/09-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/09-right-arrow.svg")},{rm_id:"rm_right_10",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/10-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/10-right-arrow.svg")},{rm_id:"rm_right_11",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/11-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/11-right-arrow.svg")},{rm_id:"rm_right_12",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/12-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/12-right-arrow.svg")},{rm_id:"rm_right_13",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/13-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/13-right-arrow.svg")},{rm_id:"rm_right_14",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/14-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/14-right-arrow.svg")},{rm_id:"rm_right_15",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/15-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/15-right-arrow.svg")},{rm_id:"rm_right_16",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/16-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/16-right-arrow.svg")},{rm_id:"rm_right_17",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/17-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/17-right-arrow.svg")},{rm_id:"rm_right_18",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/18-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/18-right-arrow.svg")},{rm_id:"rm_right_19",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/19-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/19-right-arrow.svg")},{rm_id:"rm_right_20",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/20-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/20-right-arrow.svg")},{rm_id:"rm_right_21",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/21-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/21-right-arrow.svg")},{rm_id:"rm_right_22",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/22-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/22-right-arrow.svg")},{rm_id:"rm_right_23",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/23-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/right/23-right-arrow.svg")}]),Yt(this,"defaultSlideshowLeftIcons",[{rm_id:"rm_left_0",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/00-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/00-left-arrow.svg")},{rm_id:"rm_left_1",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/01-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/01-left-arrow.svg")},{rm_id:"rm_left_2",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/02-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/02-left-arrow.svg")},{rm_id:"rm_left_3",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/03-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/03-left-arrow.svg")},{rm_id:"rm_left_4",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/04-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/04-left-arrow.svg")},{rm_id:"rm_left_5",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/05-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/05-left-arrow.svg")},{rm_id:"rm_left_6",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/06-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/06-left-arrow.svg")},{rm_id:"rm_left_7",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/07-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/07-left-arrow.svg")},{rm_id:"rm_left_8",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/08-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/08-left-arrow.svg")},{rm_id:"rm_left_9",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/09-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/09-left-arrow.svg")},{rm_id:"rm_left_10",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/10-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/10-left-arrow.svg")},{rm_id:"rm_left_11",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/11-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/11-left-arrow.svg")},{rm_id:"rm_left_12",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/12-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/12-left-arrow.svg")},{rm_id:"rm_left_13",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/13-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/13-left-arrow.svg")},{rm_id:"rm_left_14",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/14-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/14-left-arrow.svg")},{rm_id:"rm_left_15",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/15-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/15-left-arrow.svg")},{rm_id:"rm_left_16",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/16-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/16-left-arrow.svg")},{rm_id:"rm_left_17",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/17-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/17-left-arrow.svg")},{rm_id:"rm_left_18",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/18-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/18-left-arrow.svg")},{rm_id:"rm_left_19",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/19-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/19-left-arrow.svg")},{rm_id:"rm_left_20",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/20-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/20-left-arrow.svg")},{rm_id:"rm_left_21",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/21-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/21-left-arrow.svg")},{rm_id:"rm_left_22",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/22-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/22-left-arrow.svg")},{rm_id:"rm_left_23",icon_url:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/23-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/slideshow/default-collection/left/23-left-arrow.svg")}])}var e,i,n;return e=t,(i=[{key:"fetchIconsPage",value:function(t){var e;if(!t||this.searchInProgress)return Promise.resolve();var i=this.prevSVGSearch.nextPage||0;return this.prevSVGSearch.query!==t&&(i=0,this.prevSVGSearch.icons=[]),e="/icons/"+t+"?page="+i,new Promise(function(n,o){this.requestIcons(e,function(e,o){return e?(delete this.prevSVGSearch.nextPage,n(this.prevSVGSearch.icons)):(this.prevSVGSearch.icons=this.prevSVGSearch.icons.concat(o.icons),this.prevSVGSearch.query=t,this.prevSVGSearch.nextPage=i+1,n(this.prevSVGSearch.icons))}.bind(this))}.bind(this))}},{key:"requestIcons",value:function(t,e){this.destroyed||(this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!0,this.searchXhr=u.a.ajax({method:"GET",url:"/api/authservice/noun?uri="+encodeURIComponent(t),dataType:"json",success:function(t){e(null,t)},error:function(t){e(t)},complete:function(){this.searchInProgress=!1},context:this}))}},{key:"clearSearch",value:function(){this.prevSVGSearch={},this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!1}},{key:"findIcon",value:function(t){return t.rm_id?o.a.findWhere(this.defaultIcons,t):o.a.findWhere(this.prevSVGSearch.icons,{id:t.noun_id})}},{key:"destroy",value:function(){this.clearSearch(),this.destroyed=!0}}])&&Kt(e.prototype,i),n&&Kt(e,n),t}();function Zt(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var Jt,Qt,te={components:{RmScroll:i("0DSZ").a},props:{iconsCollection:{type:String,default:"defaultIcons"},rawBlock:Object,placeholder:{type:String,default:"Search"}},data:function(){var t=new Xt;return{iconsutils:t,icons:t.prevSVGSearch.icons||this.getCollection(this.iconsCollection,t),searchString:t.prevSVGSearch.query,currentSearchString:t.prevSVGSearch.query,isSearch:!!t.prevSVGSearch.query,iconsListLoading:!1,iconLoading:null,iconSelected:!1,savedScrollPosition:t.prevSVGSearch.savedScrollPosition||0}},watch:{"block.tp":{handler:function(){Y.default.nextTick(function(){this.$emit("resize")}.bind(this))},immediate:!0},iconsCollection:function(t){this.icons=this.iconsutils.prevSVGSearch.icons||this.getCollection(t)}},mounted:function(){this.iconSelected=this.iconsutils.findIcon(o.a.pick(this.block,"noun_id","rm_id")),this._scroll=this.$refs.rmscroll},beforeDestroy:function(){this.iconsutils&&this.iconsutils.destroy()},methods:{onLoupeClick:function(t){this.isSearch?this.clearSearch():this.doSearch()},getCollection:function(t,e){var i=e||this.iconsutils;return"left"===t?i.defaultSlideshowLeftIcons:"right"===t?i.defaultSlideshowRightIcons:i.defaultIcons},doSearch:function(){this.searchString&&this.currentSearchString!==this.searchString&&!this.iconsutils.searchInProgress&&(this.savedScrollPosition=0,this.currentSearchString=this.searchString,this.icons=[],delete window.prevSVGSearch,this.isSearch=!0,this.fetchIcons())},clearSearch:function(){this.savedScrollPosition=0,this.isSearch=!1,this.searchString="",this.currentSearchString="",this.icons=this.getCollection(this.iconsCollection),this.iconsutils.clearSearch()},onPanelScroll:function(t){this.iconsutils.prevSVGSearch.savedScrollPosition=t.scroll_pos,this.savedScrollPosition=t.scroll_pos,t.content_size-t.container_size-t.scroll_pos<32&&this.iconsutils.prevSVGSearch.nextPage&&!this.iconsutils.searchInProgress&&this.fetchIcons()},fetchIcons:(Jt=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.iconsListLoading=!0,t.next=3,this.iconsutils.fetchIconsPage(this.searchString);case 3:this.icons=t.sent,this.iconsListLoading=!1,this._scroll.recalcScroll();case 6:case"end":return t.stop()}}),t,this)})),Qt=function(){var t=this,e=arguments;return new Promise((function(i,n){var o=Jt.apply(t,e);function a(t){Zt(o,i,n,a,r,"next",t)}function r(t){Zt(o,i,n,a,r,"throw",t)}a(void 0)}))},function(){return Qt.apply(this,arguments)}),onIconItemClick:function(t){this.iconLoading||(this.$emit("dataObtained",t),this.iconLoading=!1)}}},ee=(i("oaeQ"),Object(nt.a)(te,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"icons"},[i("div",{staticClass:"search-block"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchString,expression:"searchString"}],staticClass:"search",attrs:{type:"text",placeholder:t.placeholder,rawBlock:t.rawBlock},domProps:{value:t.searchString},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearch(e)},input:function(e){e.target.composing||(t.searchString=e.target.value)}}}),t._v(" "),i("div",{staticClass:"loupe",class:{clear:t.isSearch,preloading:t.iconsListLoading},on:{click:t.onLoupeClick}},[t._m(0)])]),t._v(" "),i("div",{staticClass:"common-wrapper"},[i("rm-scroll",{ref:"rmscroll",attrs:{"on-panel-scroll":t.onPanelScroll,"scroll-gap-start":8,"scroll-gap-end":8,"saved-scroll-position":t.savedScrollPosition}},t._l(t.icons||[],(function(e){return i("div",{key:e.id,staticClass:"icon-item",class:{preloading:t.iconLoading==e,selected:t.iconSelected==e},on:{click:function(i){return t.onIconItemClick(e)}}},[i("div",{staticClass:"noun-icon",style:{"background-image":"url('"+e.preview_url_42+"')"},attrs:{"data-id":e.id,"data-rm_id":e.rm_id,"data-url":e.icon_url}}),t._v(" "),t.iconLoading==e?i("div",{staticClass:"rmpreloader"},[i("div",{staticClass:"arc"})]):t._e()])})),0)],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"rmpreloader hidden"},[e("div",{staticClass:"arc"})])}],!1,null,"1d9e2760",null).exports),ie={components:{NumericInput:st.a,ColorPicker:pt.a,ShapeSearch:ee,CornersIcon:At},mixins:[rt],data:function(){var t=new Xt;return{iconsutils:t,stroke_popup_visible:!1,icons:t.prevSVGSearch.icons||t.defaultIcons}},watch:{"block.tp":{handler:function(){Y.default.nextTick(function(){this.$emit("resize")}.bind(this))},immediate:!0}},mounted:function(){this.iconSelected=this.iconsutils.findIcon(o.a.pick(this.block,"noun_id","rm_id"))},beforeDestroy:function(){this.iconsutils&&this.iconsutils.destroy()},methods:{selectShape:function(t){this.block.tp=t,"icon"!==t?this.abortRequests():this.updateShapeSearchScroll()},isSearchAvailable:function(){return _.default.isNounSearchAvailable()},updateShapeSearchScroll:function(){this.$refs.shapeSearch.$refs.rmscroll.recalcScroll()},onInputChange:function(t,e){this.block[t]=e},updateColor:function(t){this.block.color=t.color,this.block.opacity=t.alpha},closeOtherPopups:function(t){Object(n.a)("constructor.newColorpicker")&&t&&t.target&&t.target.closest(".colorbox_container")||(this.$refs.colorpicker.hide(),this.stroke_popup_visible=!1)},toggleStrokePopup:function(t){Object(u.a)(t.target).closest(".stroke-selector .stroke-popup").length>0||(this.stroke_popup_visible=!this.stroke_popup_visible)},selectStroke:function(t){this.block.stroke=t,this.stroke_popup_visible=!1},onDataObtained:function(t){var e=this;this.raw_block.getIconSVG(t.id||t.rm_id,t.icon_url,{noCache:!0},(function(i){if(!i){var n={noun_url:t.icon_url};t.id?o.a.extend(n,{noun_id:t.id,rm_id:null}):t.rm_id&&o.a.extend(n,{noun_id:null,rm_id:t.rm_id}),e.raw_block.model.set(n)}}))},abortRequests:function(){this.iconsutils.clearSearch()},toggleBorderRadiusIndependent:function(){this.block.radius_rect_independent=!this.block.radius_rect_independent}}},ne=Object(nt.a)(ie,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel resizable",class:{"overflow-visible":t.stroke_popup_visible,"no-search":!t.isSearchAvailable()},attrs:{"data-current-type":t.block.tp},on:{click:t.closeOtherPopups}},[i("div",{staticClass:"panel-caption"},[t._v("Shape")]),t._v(" "),i("div",{staticClass:"selector",attrs:{"data-current-type":t.block.tp}},t._l(["rectangle","polygon","line","icon","ellipse"],(function(e){return i("div",{key:e,staticClass:"shape",attrs:{"data-type":e},on:{click:function(i){return t.selectShape(e)}}})})),0),t._v(" "),i("div",{staticClass:"details"},[i("div",{staticClass:"weight param"},[i("div",{staticClass:"param-caption"},[t._v("Weight")]),t._v(" "),i("numeric-input",{attrs:{autofocus:!0,autosize:!1,min:1,max:999,dir:"v",speed:5},model:{value:t.block.weight,callback:function(e){t.$set(t.block,"weight",e)},expression:"block.weight"}})],1),t._v(" "),i("div",{staticClass:"sides param"},[i("div",{staticClass:"param-caption"},[t._v("Sides")]),t._v(" "),i("numeric-input",{attrs:{autofocus:!0,autosize:!1,min:3,max:30,dir:"v",speed:10},model:{value:t.block.sides,callback:function(e){t.$set(t.block,"sides",e)},expression:"block.sides"}})],1),t._v(" "),i("div",{staticClass:"borders param"},[i("div",{staticClass:"param-caption name-border"},[t._v(t._s("ellipse"==t.block.tp?"Border":"Borders"))]),t._v(" "),i("numeric-input",{attrs:{autofocus:!0,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.borders,callback:function(e){t.$set(t.block,"borders",e)},expression:"block.borders"}}),t._v(" "),i("div",{staticClass:"border-color",attrs:{title:"Color"}},[i("color-picker",{ref:"colorpicker",staticClass:"color round",attrs:{color:t.block.color,alpha:t.block.opacity,"opacity-multiplier":120,"show-alpha":!0,"vertical-align":"top"},on:{"update:all":t.updateColor}})],1),t._v(" "),i("div",{staticClass:"colorbox_container"})],1),t._v(" "),i("div",{staticClass:"radius param"},[i("div",{staticClass:"param-caption"},[t._v("Radius")]),t._v(" "),t.block.radius_rect_independent?t._e():i("div",[i("numeric-input",{attrs:{autofocus:!0,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.radius,callback:function(e){t.$set(t.block,"radius",e)},expression:"block.radius"}})],1),t._v(" "),"rectangle"===t.block.tp?i("div",{staticClass:"border-radius-independent",class:{active:t.block.radius_rect_independent},attrs:{title:"Independent corners"},on:{click:t.toggleBorderRadiusIndependent}},[i("corners-icon")],1):t._e(),t._v(" "),"rectangle"===t.block.tp&&t.block.radius_rect_independent?i("div",{staticClass:"border-radius-independent-params-wrapper"},[i("div",{staticClass:"border-radius-independent-params"},[i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.radius_rect_tl,callback:function(e){t.$set(t.block,"radius_rect_tl",e)},expression:"block.radius_rect_tl"}}),t._v(" "),i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.radius_rect_tr,callback:function(e){t.$set(t.block,"radius_rect_tr",e)},expression:"block.radius_rect_tr"}})],1),t._v(" "),i("div",{staticClass:"border-radius-independent-params"},[i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.radius_rect_bl,callback:function(e){t.$set(t.block,"radius_rect_bl",e)},expression:"block.radius_rect_bl"}}),t._v(" "),i("numeric-input",{staticClass:"numeric-input",attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.radius_rect_br,callback:function(e){t.$set(t.block,"radius_rect_br",e)},expression:"block.radius_rect_br"}})],1)]):t._e()]),t._v(" "),i("div",{staticClass:"stroke param"},[i("div",{staticClass:"param-caption"},[t._v("Stroke")]),t._v(" "),i("div",{staticClass:"stroke-selector",class:{opened:t.stroke_popup_visible},attrs:{"data-current-type":t.block.stroke},on:{click:function(e){return e.stopPropagation(),t.toggleStrokePopup(e)}}},[i("div",{staticClass:"stroke-popup"},t._l(["solid","double","dotted","dashed"],(function(e){return i("div",{key:e,staticClass:"stroke-item",attrs:{"data-type":e},on:{click:function(i){return t.selectStroke(e)}}})})),0),t._v(" "),i("div",{staticClass:"current"})])])]),t._v(" "),i("shape-search",{ref:"shapeSearch",on:{dataObtained:t.onDataObtained}})],1)}),[],!1,null,null,null).exports,oe={components:{RmSwitcher:ut.a,ColorPicker:pt.a,ShapeSearch:ee,NumericInput:st.a,XMarkIcon:Bt.a},mixins:[rt],data:function(){var t=new Xt;return{iconsutils:t,uploading:!1,dragging:!1,activeNounArrow:"left",icons:t.prevSVGSearch.icons||t.defaultSlideshowLeftIcons,m:{pictures:[]}}},computed:{hasPictures:function(){return!o.a.isEmpty(this.m.pictures)},compoundProperty:function(){return[this.raw_block.queue,this.block.theme_data.captions].join()}},watch:{compoundProperty:{handler:function(){Y.default.nextTick(function(){this.$emit("resize")}.bind(this))},immediate:!0}},mounted:function(){this.uploader=this.raw_block.uploader,this.uploader.on("start",this.showPreloader),this.uploader.on("done fail",this.checkFinishUpload),this.raw_block.settingsPanel=this,this.raw_block.updateDropZone(),this.raw_block.colorbox_visible=!1,this.raw_block.workspace.on("main-dragover",this.highlightDropZone,this)},beforeDestroy:function(){this.raw_block.workspace.off("main-dragover",this.highlightDropZone,this),this.iconsutils&&this.iconsutils.destroy()},methods:{upload:function(t){this.raw_block.$(".uploadInput").trigger("click","stop")},closePopups:function(t){Object(n.a)("constructor.newColorpicker")&&t&&t.target&&t.target.closest(".colorbox_container")||o.a.each(this.$children,(function(e){e!==t&&(e.visibleBox=!1)}))},onShowPopup:function(t){this.closePopups(t),this.raw_block.colorbox_visible=!0},onUpdateColor:function(t){this.block.theme_data.controls_color=t,this.raw_block.needRasterize=!0},updateShapeSearchScroll:function(){this.$refs.shapeSearch.$refs.rmscroll.recalcScroll()},getCapitalizedName:function(t){return _.default.capitalize(t)},isSearchAvailable:function(){return _.default.isNounSearchAvailable()},onCountersTypeClick:function(t){if(Object(u.a)(t.target).hasClass("dots")){if(Object(u.a)(t.target).hasClass("disabled"))return void t.preventDefault();this.block.theme_data.counters_type="dots"}else this.block.theme_data.counters_type="numbers"},onCrossfadeValueChange:function(t){this.block.theme_data.autoplay_delay<t&&(this.block.theme_data.autoplay_delay=t)},onThumbnailsChange:function(t){t&&(this.block.theme_data.counters_type="numbers",this.block.theme_data.captions=!1)},onCaptionsChange:function(t){this.raw_block.trigger("captions_changed",t),t&&(this.block.theme_data.thumbnails=!1)},onArrowsTypeChange:function(t){"library"!==t&&"noun"!==t||this.updateShapeSearchScroll(),this.block.theme_data.arrows_type=t,this.block.current_mode=t,this.raw_block.trigger("arrow_type_changed")},onDataObtained:function(t){var e=this,i="left"===this.activeNounArrow?"left_arrow_noun":"right_arrow_noun";this.raw_block.getIconSVG(t.id||t.rm_id,t.icon_url,i,(function(i,n){var a;e.raw_block.needRasterize=!0,i||(a={noun_url:t.icon_url},t.id?o.a.extend(a,{noun_id:t.id,rm_id:null}):t.rm_id&&o.a.extend(a,{noun_id:null,rm_id:t.rm_id}),"left"===e.activeNounArrow?e.block.theme_data.left_icon_noun=a:e.block.theme_data.right_icon_noun=a)}))},canUpload:function(){return!this.hasPictures&&!this.uploading},checkFinishUpload:function(){o.a.isEmpty(this.raw_block.queue)&&(this.uploading=!1)},highlightDropZone:function(t){var e=this;this.dragging=!0,clearTimeout(this.highlightTimeout),this.highlightTimeout=setTimeout((function(){e.dragging=!1}),500)},showPreloader:function(){this.uploading=!0},cancelUpload:function(){this.uploading=!1,this.raw_block.removePictures()}}},ae=(i("zoxU"),Object(nt.a)(oe,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel slideshow-panel resizable",class:{noun:"library"===t.block.current_mode||"noun"===t.block.current_mode,"has-upload-images":t.hasPictures,uploading:t.uploading&&!t.hasPictures,dragging:t.dragging},on:{click:t.closePopups}},[t.hasPictures?t._e():i("div",{staticClass:"panel-caption"},[t._v("Images")]),t._v(" "),i("div",{staticClass:"upload"},[i("div",{staticClass:"upload-wrapper"},[i("div",{staticClass:"center-wrapper",on:{click:function(e){return t.upload(e)}}},[i("div",{staticClass:"icon"}),t._v(" "),i("div",{staticClass:"caption-upload-dop"},[t._v("Drop file here")])])])]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"loading"},[i("div",{staticClass:"delete",on:{click:t.cancelUpload}},[i("x-mark-icon",{attrs:{width:32,height:32}})],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"default"===t.block.current_mode,expression:"block.current_mode === 'default'"}],staticClass:"settings"},[i("div",{staticClass:"colorbox_container"}),t._v(" "),i("div",{staticClass:"params",attrs:{"data-current-theme":t.block.current_theme}},[i("div",{staticClass:"param param-arrows solid-separator",class:{invisible:t.block.theme_data.arrows}},[i("div",{staticClass:"caption"},[t._v("Arrows")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.arrows,callback:function(e){t.$set(t.block.theme_data,"arrows",e)},expression:"block.theme_data.arrows"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.block.theme_data.arrows,expression:"block.theme_data.arrows"}],staticClass:"param param-arrows-type"},t._l(["default","library"],(function(e){var n;return i("div",{key:e,staticClass:"arrows-type",class:(n={active:t.block.theme_data.arrows_type===e},n[e]=!0,n),on:{click:function(i){return t.onArrowsTypeChange(e)}}},[t._v("\n          "+t._s(t.getCapitalizedName(e))+"\n        ")])})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.block.theme_data.arrows,expression:"block.theme_data.arrows"}],staticClass:"param param-arrows-view-mode solid-separator",class:{invisible:"normal"===t.block.theme_data.arrows_view_mode}},t._l(["normal","mouseover"],(function(e){var n;return i("div",{key:e,staticClass:"arrows-view-mode",class:(n={active:t.block.theme_data.arrows_view_mode===e},n[e]=!0,n),on:{click:function(i){t.block.theme_data.arrows_view_mode=e}}},[t._v("\n          "+t._s(t.getCapitalizedName(e))+"\n        ")])})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.block.theme_data.arrows&&"normal"===t.block.theme_data.arrows_view_mode,expression:"block.theme_data.arrows && block.theme_data.arrows_view_mode === 'normal'"}],staticClass:"param param-arrows-position solid-separator"},t._l(["sides","bottom"],(function(e){var n;return i("div",{key:e,staticClass:"arrows-position",class:(n={active:t.block.theme_data.arrows_position===e},n[e]=!0,n),on:{click:function(i){t.block.theme_data.arrows_position=e}}},[t._v("\n          "+t._s(t.getCapitalizedName(e))+"\n        ")])})),0),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{staticClass:"param param-counters solid-separator",class:{invisible:t.block.theme_data.counters}},[i("div",{staticClass:"caption"},[t._v("Counter")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.counters,callback:function(e){t.$set(t.block.theme_data,"counters",e)},expression:"block.theme_data.counters"}})],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.block.theme_data.counters,expression:"block.theme_data.counters"}],staticClass:"param param-counters-type solid-separator",class:{invisible:"numbers"!==t.block.theme_data.counters_type}},t._l(["numbers","dots"],(function(e){var n;return i("div",{key:e,staticClass:"counters-type",class:(n={active:t.block.theme_data.counters_type===e,disabled:"dots"===e&&t.block.theme_data.thumbnails},n[e]=!0,n),on:{click:t.onCountersTypeClick}},[t._v("\n          "+t._s(t.getCapitalizedName(e))+"\n        ")])})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.block.theme_data.counters&&"dots"===t.block.theme_data.counters_type,expression:"block.theme_data.counters && block.theme_data.counters_type === 'dots'"}],staticClass:"param param-counters-position solid-separator"},t._l(["inside","outside"],(function(e){var n;return i("div",{key:e,staticClass:"counters-position",class:(n={active:t.block.theme_data.counters_position===e,disabled:"dots"===e&&t.block.theme_data.thumbnails},n[e]=!0,n),on:{click:function(i){t.block.theme_data.counters_position=e}}},[t._v("\n          "+t._s(t.getCapitalizedName(e))+"\n        ")])})),0),t._v(" "),i("div",{staticClass:"param param-fullscreen solid-separator"},[i("div",{staticClass:"caption"},[t._v("Fullscreen")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.fullscreen,callback:function(e){t.$set(t.block.theme_data,"fullscreen",e)},expression:"block.theme_data.fullscreen"}})],1),t._v(" "),i("div",{staticClass:"param param-controls"},[i("div",{staticClass:"caption"},[t._v("Icons color")]),t._v(" "),i("color-picker",{attrs:{color:t.block.theme_data.controls_color,"show-alpha":!1},on:{showPopup:t.onShowPopup,"update:color":function(e){return t.onUpdateColor(e)}}})],1),t._v(" "),i("div",{staticClass:"param param-controls-bg"},[i("div",{staticClass:"caption"},[t._v("Background")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.controls_bg,callback:function(e){t.$set(t.block.theme_data,"controls_bg",e)},expression:"block.theme_data.controls_bg"}})],1),t._v(" "),i("div",{staticClass:"param param-show-on-hover solid-separator"},[i("div",{staticClass:"caption"},[t._v("Show on hover")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.show_on_hover,callback:function(e){t.$set(t.block.theme_data,"show_on_hover",e)},expression:"block.theme_data.show_on_hover"}})],1),t._v(" "),i("div",{staticClass:"param param-captions"},[i("div",{staticClass:"caption"},[t._v("Captions")]),t._v(" "),i("rm-switcher",{attrs:{callback:t.onCaptionsChange,width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.captions,callback:function(e){t.$set(t.block.theme_data,"captions",e)},expression:"block.theme_data.captions"}})],1),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{staticClass:"param param-thumbnails"},[i("div",{staticClass:"caption"},[t._v("Thumbs")]),t._v(" "),i("rm-switcher",{attrs:{callback:t.onThumbnailsChange,width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.thumbnails,callback:function(e){t.$set(t.block.theme_data,"thumbnails",e)},expression:"block.theme_data.thumbnails"}})],1)]),t._v(" "),i("div",{staticClass:"param param-fill solid-separator",class:{invisible:t.block.theme_data.thumbnails||!t.block.theme_data.fill||t.block.theme_data.radius>0}},[i("div",{staticClass:"caption"},[t._v("Fill")]),t._v(" "),i("rm-switcher",{attrs:{width:40,height:24,"color-on":"#282828","color-off":"#B8B8B8"},model:{value:t.block.theme_data.fill,callback:function(e){t.$set(t.block.theme_data,"fill",e)},expression:"block.theme_data.fill"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.block.theme_data.thumbnails||!t.block.theme_data.fill||t.block.theme_data.radius>0,expression:"block.theme_data.thumbnails || !block.theme_data.fill || block.theme_data.radius > 0"}],staticClass:"param param-backgroundr solid-separator"},[i("div",{staticClass:"caption"},[t._v("Bg color")]),t._v(" "),i("color-picker",{attrs:{"vertical-align":"top",color:t.block.theme_data.background_color,alpha:t.block.theme_data.background_opacity,"opacity-multiplier":100,"show-alpha":!0},on:{"update:color":function(e){return t.block.theme_data.background_color=e},"update:alpha":function(e){return t.block.theme_data.background_opacity=e},showPopup:t.onShowPopup}})],1),t._v(" "),i("div",{staticClass:"param param-radius"},[i("div",{staticClass:"caption"},[t._v("Radius")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.radius>0},attrs:{autofocus:!1,autosize:!1,min:0,max:999,dir:"v",speed:5},model:{value:t.block.theme_data.radius,callback:function(e){t.$set(t.block.theme_data,"radius",e)},expression:"block.theme_data.radius"}})],1)],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"library"===t.block.current_mode||"noun"===t.block.current_mode,expression:"block.current_mode === 'library' || block.current_mode === 'noun'"}],staticClass:"noun-settings",class:{"no-search":!t.isSearchAvailable()}},[i("div",{staticClass:"noun-wrapper ",class:{"solid-separator":t.isSearchAvailable()}},t._l(["left","right"],(function(e){var n;return i("span",{key:e,staticClass:"arrow-noun",class:(n={active:t.activeNounArrow==e},n[e]=!0,n),on:{click:function(i){t.activeNounArrow=e}}},[t._v(t._s(t.getCapitalizedName(e)))])})),0),t._v(" "),i("shape-search",{ref:"shapeSearch",attrs:{"icons-collection":t.activeNounArrow},on:{dataObtained:t.onDataObtained}})],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"picture_preloader rmpreloader"},[e("div",{staticClass:"shadow"}),this._v(" "),e("div",{staticClass:"arc"})])}],!1,null,"584d73e8",null).exports),re={components:{NumericInput:st.a},mixins:[rt],data:function(){return{isPlayOnScrollEnabled:Object(n.a)("constructor.playOnScroll"),isHoverDisabled:!1,methodsObject:{click:"Play on click",hover:"Play on hover",scroll:"On scroll",autoplay:"Autoplay"}}},computed:{},mounted:function(){this.raw_block.workspace.page.on("change:viewport",this.onChangeViewport),this.onChangeViewport()},methods:{onTransitionsValueChange:function(t){(this.block.theme_data.autoplay_delay<t||this.block.theme_data.hover_delay<t)&&(this.block.theme_data.autoplay_delay=t,this.block.theme_data.hover_delay=t)},onTransitionsTypeChange:function(t){this.block.transition_type=t,this.resetTransition()},resetTransition:function(){"scroll"===this.block.play_method&&"slider"===this.block.transition_type&&(this.block.theme_data.slider_transition=0)},onPlayMethodsChange:function(t){this.block.play_method=t,this.resetTransition()},onChangeViewport:function(){var t=this.raw_block.workspace.page.getCurrentViewport(),e=this.raw_block.workspace.page.getViewportParam("phone_portrait","enabled"),i=this.raw_block.workspace.page.getViewportParam("tablet_portrait","enabled");this.isHoverDisabled="default"!==t,(e||i)&&this.isHoverDisabled&&"hover"===this.block.play_method&&(this.block.play_method="autoplay")},getPlayMethods:function(){var t,e=this.raw_block.workspace.page.getCurrentViewport();return t=this.isPlayOnScrollEnabled?this.methodsObject:o.a.omit(this.methodsObject,"scroll"),t="default"!==e?o.a.omit(t,"hover"):t}}},se=Object(nt.a)(re,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel slideshow-transition-panel transitions resizable"},[i("div",{staticClass:"settings"},[i("div",{staticClass:"params"},[i("div",{staticClass:"param param-transition-type"},t._l(["slider","crossfade"],(function(e){var n;return i("div",{key:e,staticClass:"transition-type",class:(n={active:t.block.transition_type===e},n[e]=!0,n),on:{click:function(i){return t.onTransitionsTypeChange(e)}}},[t._v("\n          "+t._s(e.charAt(0).toUpperCase()+e.slice(1))+"\n        ")])})),0),t._v(" "),i("div",{staticClass:"param param-play-method",class:{click:"click"===t.block.play_method,hover:"hover"===t.block.play_method,autoplay:"autoplay"===t.block.play_method,scroll:"scroll"===t.block.play_method,scroll_enabled:t.isPlayOnScrollEnabled,hover_disabled:t.isHoverDisabled}},t._l(t.getPlayMethods(),(function(e,n){var o;return i("div",{key:n,staticClass:"play-method",class:(o={active:t.block.play_method===n},o[n]=!0,o),on:{click:function(e){return t.onPlayMethodsChange(n)}}},[t._v("\n          "+t._s(e)+"\n        ")])})),0),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"autoplay"===t.block.play_method,expression:"block.play_method === 'autoplay'"}],staticClass:"param param-autoplay-delay"},[i("div",{staticClass:"caption"},[t._v("Delay")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.autoplay_delay>0},attrs:{autofocus:!1,min:"crossfade"===t.block.transition_type?t.block.theme_data.crossfade:t.block.theme_data.slider_transition,max:60,dir:"v",step:.1,"use-float":!0,speed:5},model:{value:t.block.theme_data.autoplay_delay,callback:function(e){t.$set(t.block.theme_data,"autoplay_delay",e)},expression:"block.theme_data.autoplay_delay"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"hover"===t.block.play_method,expression:"block.play_method === 'hover'"}],staticClass:"param param-hover-delay"},[i("div",{staticClass:"caption"},[t._v("Delay")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.hover_delay>0},attrs:{autofocus:!1,min:"crossfade"===t.block.transition_type?t.block.theme_data.crossfade:t.block.theme_data.slider_transition,max:60,dir:"v",step:.1,"use-float":!0,speed:5},model:{value:t.block.theme_data.hover_delay,callback:function(e){t.$set(t.block.theme_data,"hover_delay",e)},expression:"block.theme_data.hover_delay"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"scroll"===t.block.play_method,expression:"block.play_method === 'scroll'"}],staticClass:"param param-start-offset"},[i("div",{staticClass:"caption"},[t._v("Start offset")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.start_offset>0},attrs:{autofocus:!1,min:0,max:3e3,dir:"v",step:1,"use-float":!0,speed:5},model:{value:t.block.theme_data.start_offset,callback:function(e){t.$set(t.block.theme_data,"start_offset",e)},expression:"block.theme_data.start_offset"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"crossfade"===t.block.transition_type,expression:"block.transition_type === 'crossfade'"}],staticClass:"param param-crossfade",class:{scroll:"scroll"===t.block.play_method}},[i("div",{staticClass:"caption"},[t._v("Сrossfade")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.crossfade>0},attrs:{autofocus:!1,min:0,max:60,dir:"v",step:.1,"use-float":!0,speed:5},on:{change:t.onTransitionsValueChange},model:{value:t.block.theme_data.crossfade,callback:function(e){t.$set(t.block.theme_data,"crossfade",e)},expression:"block.theme_data.crossfade"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"slider"===t.block.transition_type,expression:"block.transition_type === 'slider'"}],staticClass:"param param-slider-transition",class:{scroll:"scroll"===t.block.play_method}},[i("div",{staticClass:"caption"},[t._v("Transition")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.slider_transition>0},attrs:{autofocus:!1,min:0,max:"scroll"===t.block.play_method?0:60,dir:"v",step:.1,"use-float":!0,speed:5,readonly:"scroll"===t.block.play_method},on:{change:t.onTransitionsValueChange},model:{value:t.block.theme_data.slider_transition,callback:function(e){t.$set(t.block.theme_data,"slider_transition",e)},expression:"block.theme_data.slider_transition"}})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"scroll"===t.block.play_method,expression:"block.play_method === 'scroll'"}],staticClass:"param param-scroll-delay"},[i("div",{staticClass:"caption"},[t._v("Delay")]),t._v(" "),i("numeric-input",{class:{active:t.block.theme_data.scroll_delay>0},attrs:{autofocus:!1,min:0,max:3e3,dir:"v",step:.1,"use-float":!0,speed:5},model:{value:t.block.theme_data.scroll_delay,callback:function(e){t.$set(t.block.theme_data,"scroll_delay",e)},expression:"block.theme_data.scroll_delay"}})],1)])])])}),[],!1,null,null,null).exports,le={props:{href:String}},ce=(i("896M"),Object(nt.a)(le,(function(){var t=this.$createElement;return(this._self._c||t)("a",{staticClass:"info",attrs:{href:this.href,rel:"noreferrer noopener",target:"_blank"}})}),[],!1,null,"4b1e125a",null).exports),de=i("vIxw"),he=(i("jnxn"),Object(nt.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19 8C19 7.44772 19.4477 7 20 7C27.1797 7 33 12.8203 33 20C33 20.5523 32.5523 21 32 21C31.4477 21 31 20.5523 31 20C31 13.9249 26.0751 9 20 9C19.4477 9 19 8.55228 19 8ZM8 19C8.55228 19 9 19.4477 9 20C9 26.0751 13.9249 31 20 31C20.5523 31 21 31.4477 21 32C21 32.5523 20.5523 33 20 33C12.8203 33 7 27.1797 7 20C7 19.4477 7.44772 19 8 19Z"}})])}),[],!1,null,"01455914",null).exports);function ue(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function pe(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var me={components:{InlineHelp:ce,VideoSearch:de.a,RmSwitcher:ut.a,ColorPicker:pt.a,ReplaceIcon:he},mixins:[rt],data:function(){return{isLoading:!1,isError:!1,isUploading:!1,isDragging:!1,isDropZoneEnter:!1,isCustomThumbnail:!1,errorText:"",m:{url:null,video_id:null,provider_name:null,thumbnail_url:null,custom_thumbnail:!1,picture:null,title:null,start_time:null,autoplay:!1,loop:!1,mute:!1,info:!1,theme:null,color:null}}},computed:{logoClass:function(){var t={};return t[this.m.provider_name&&this.m.provider_name.toLowerCase()]=!0,t},hasVideo:function(){return Boolean(this.m.video_id)},providerName:function(){var t=this.m&&this.m.provider_name;return t&&t.toLowerCase()},isYoutube:function(){return"youtube"===this.providerName},isVimeo:function(){return"vimeo"===this.providerName},previewBackground:function(){if(!this.m.custom_thumbnail)return null;var t=this.getCustomThumbnail(),e=t.thumbUrl||t.url;if(Et.a.useLambdaUrlOldProjects(t,"video")){var i={width:Ft.a.THUMB_SIZE_VIDEO_COVER,height:Ft.a.THUMB_SIZE_VIDEO_COVER};e=Et.a.getThumbnailUrl(t,i)}return e?"url(".concat(e,")"):null},isPrivate:function(){return this.hasVideo&&!this.m.title&&!this.m.thumbnail_url},backgroundColor:function(){return this.m.color||"3ab9ff"},showPreview:function(){return this.isLoading||this.hasVideo},isAutoplay:{get:function(){return this.m.autoplay},set:function(t){this.m.autoplay=t,this.m.mute=t,t&&(this.isCustomThumbnail=!t)}},hasCustomThumbnail:{get:function(){return this.isCustomThumbnail},set:function(t){var e=this;this.isCustomThumbnail=t,this.m.custom_thumbnail=t,t?(setTimeout((function(){e.$dropCaption=Object(u.a)(".video-panel-dropzone-container .caption-upload-dop"),e.$replaceIcon=Object(u.a)(".video-panel-icon-replace"),e.$dropCaption.css("opacity",0)}),0),setTimeout((function(){e.$dropCaption.show()}),150),setTimeout((function(){e.$dropCaption.css("opacity",.9)}),200),setTimeout((function(){e.$replaceIcon.show()}),300)):this.$dropCaption&&(this.$dropCaption.hide(),this.$replaceIcon.hide(),this.$dropCaption.css("opacity",0))}}},beforeDestroy:function(){this.abortAjaxLoading(),this.raw_block.workspace.off("main-dragover",this.highlightDropZone,this)},created:function(){this.isCustomThumbnail=!0===this.m.custom_thumbnail,this.m.custom_thumbnail_url&&!this.m.picture&&(this.m.picture=this.getCustomThumbnail(this))},mounted:function(){Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-video_settings")})),this.mountUploader()},methods:{abortAjaxLoading:function(){this.videoEmbedXHR&&this.videoEmbedXHR.abort(),this.isLoading=!1},onLoaded:function(t){var e=this,i=t;if(this.isLoading=!1,i.html){i=o.a.pick(i,"url","video_id","provider_name","thumbnail_url","title","start_time"),this.m.start_time&&(i.start_time=i.start_time||null);var n=o.a.extend(i,{autoplay:Boolean(this.m.autoplay),loop:Boolean(this.m.loop),mute:Boolean(this.m.mute),info:Boolean(this.m.info),theme:this.m.theme||"dark",color:this.m.color||"3ab9ff"});o.a.extend(this.m,n);var a=this.getCustomThumbnail();this.isCustomThumbnail=Boolean(this.m.custom_thumbnail&&a&&a.url),setTimeout((function(){e.mountUploader()}),0)}else this.onVideoSearchError()},onRemove:function(){o.a.extend(this.m,{video_id:"",provider_name:"",thumbnail_url:"",custom_thumbnail:!1,picture:null,title:""})},onDataObtained:function(t){clearTimeout(this.errorRemovalTimeout),this.m.url===t.url?this.abortAjaxLoading():(this.isLoading=!0,this.isError=!1,this.m.provider_name=t.provider_name,this.m.url=t.url)},onVideoSearchError:function(){this.showError("Sorry, but we can't get this video due to its limitations")},showError:function(t){var e=this;this.errorText=t,this.isError=!0,this.isLoading=!1,this.errorRemovalTimeout=setTimeout((function(){e.isError=!1,e.errorText=""}),2e3)},dismissError:function(){this.isError=!1,this.errorText="",clearTimeout(this.errorRemovalTimeout)},mountUploader:function(){this.$refs.uploadInput&&this.$refs.uploadInputDropZone&&!this.uploader&&(this.uploader=new It.a(this,{fileInput:Object(u.a)(this.$refs.uploadInput),dropZone:Object(u.a)(this.$refs.uploadInputDropZone)}),this.uploader.on("start",this.onStartUpload),this.uploader.on("done",this.onDoneUpload),this.uploader.on("fail",this.onFailUpload),this.uploader.on("dragover",this.highlightDropZoneEnter),this.raw_block.workspace.on("main-dragover",this.highlightDropZone,this))},uploadCustomThumbnail:function(t){t&&Object(u.a)(t.target).hasClass("uploadInput")||(this.isUploading&&Object(u.a)(this.$refs.uploadInput).trigger("click","stop"),Object(u.a)(this.$refs.uploadInput).trigger("click"))},replaceCustomThumbnail:function(){this.isCustomThumbnail&&Object(u.a)(this.$refs.uploadInput).trigger("click")},getCustomThumbnail:function(){return this.m.picture?this.m.picture:{url:this.m.custom_thumbnail_url,type:o.a.last((this.m.custom_thumbnail_url||"").split("."))}},onStartUpload:function(t,e){this.isUploading=!0},onDoneUpload:function(t,e){if(this.isUploading=!1,!e||!e.result)return this.showError("Sorry, but we couldn't upload the custom thumbnail"),void(this.isCustomThumbnail=!1);if(e.result.picture){this.isCustomThumbnail=!0;var i=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(i),!0).forEach((function(e){pe(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ue(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({originalW:e.result.size.width,originalH:e.result.size.height},e.result.picture);o.a.extend(this.m,{picture:i})}else this.isCustomThumbnail=!1,this.showError("Sorry, but we couldn't upload the custom thumbnail")},onFailUpload:function(){this.isUploading=!1},cancelUpload:function(){this.isUploading=!1},highlightDropZone:function(t){var e=this;this.isDragging=!0,clearTimeout(this.highlightTimeout),this.highlightTimeout=setTimeout((function(){e.isDragging=!1}),500)},highlightDropZoneEnter:function(t){var e=this;this.isDropZoneEnter=!0,clearTimeout(this.dropZoneTimeout),this.dropZoneTimeout=setTimeout((function(){e.isDropZoneEnter=!1}),500)}}},ge=(i("Ib1Q"),Object(nt.a)(me,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel control-panel video-panel",class:{error:t.isError,loading:t.isLoading,loaded:t.hasVideo,youtube:t.isYoutube,vimeo:t.isVimeo,"custom-thumb":t.isCustomThumbnail}},[i("div",{staticClass:"panel-caption"},[t._v("Video")]),t._v(" "),i("video-search",{attrs:{"is-video-processed":t.m.video_id,"show-social":!t.isLoading&&!t.hasVideo,"highlight-on-error":!0},on:{dataObtained:t.onDataObtained,loaded:t.onLoaded,error:t.onVideoSearchError,remove:t.onRemove},model:{value:t.m.url,callback:function(e){t.$set(t.m,"url",e)},expression:"m.url"}}),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.hasVideo?i("div",{staticClass:"video-panel-preview-caption"},[t._v(t._s(t.m.title))]):t._e(),t._v(" "),t.isPrivate?i("div",{staticClass:"video-panel-preview-caption video-panel-preview-caption-private"},[t._v("Private video")]):t._e()]),t._v(" "),i("transition",{attrs:{name:"slide"}},[t.showPreview?i("div",{staticClass:"video-panel-preview-wrapper"},[i("div",{staticClass:"video-panel-preview",class:{"custom-thumb":t.isCustomThumbnail,vimeo:t.isVimeo}},[i("transition",{attrs:{name:"fade"}},[t.hasVideo?i("div",{staticClass:"params"},[i("div",{staticClass:"param autoplay"},[i("div",{staticClass:"param-caption"},[t._v("Autoplay")]),t._v(" "),i("rm-switcher",{attrs:{state:t.isAutoplay,width:40,height:24},model:{value:t.isAutoplay,callback:function(e){t.isAutoplay=e},expression:"isAutoplay"}})],1),t._v(" "),i("div",{staticClass:"param loop"},[i("div",{staticClass:"param-caption"},[t._v("Loop")]),t._v(" "),i("rm-switcher",{attrs:{state:t.m.loop,width:40,height:24},model:{value:t.m.loop,callback:function(e){t.$set(t.m,"loop",e)},expression:"m.loop"}})],1),t._v(" "),i("div",{staticClass:"param mute"},[i("div",{staticClass:"param-caption"},[t._v("\n                Mute\n                "),i("inline-help",{attrs:{href:"http://help.readymag.com/hc/en-us/articles/360020792871-Video"}})],1),t._v(" "),i("rm-switcher",{attrs:{state:t.m.mute,"is-disabled":t.isAutoplay,width:40,height:24},model:{value:t.m.mute,callback:function(e){t.$set(t.m,"mute",e)},expression:"m.mute"}})],1),t._v(" "),t.isYoutube?t._e():i("div",{staticClass:"param info"},[i("div",{staticClass:"param-caption"},[t._v("Show Info")]),t._v(" "),i("rm-switcher",{attrs:{state:t.m.info,width:40,height:24},model:{value:t.m.info,callback:function(e){t.$set(t.m,"info",e)},expression:"m.info"}})],1),t._v(" "),t.isVimeo?i("div",{staticClass:"param video-panel-setting-color video-panel-setting-color-vimeo"},[i("div",{staticClass:"param-caption"},[t._v("Color")]),t._v(" "),i("div",{staticClass:"video-panel-switcher video-panel-switcher-vimeo"},[i("color-picker",{staticClass:"video-panel-color-picker-vimeo",attrs:{color:t.backgroundColor,"show-alpha":!1},on:{"update:color":function(e){return t.m.color=e}}})],1)]):t._e(),t._v(" "),i("div",{staticClass:"param"},[i("div",{staticClass:"param-caption"},[t._v("Thumbnail")]),t._v(" "),i("rm-switcher",{attrs:{state:t.hasCustomThumbnail,"is-disabled":t.isAutoplay,width:40,height:24},model:{value:t.hasCustomThumbnail,callback:function(e){t.hasCustomThumbnail=e},expression:"hasCustomThumbnail"}})],1)]):t._e()]),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.isCustomThumbnail?i("div",{staticClass:"video-panel-preview-image-container",class:{vimeo:t.isVimeo,dragging:t.isDragging}},[t.m.picture&&t.m.picture.url&&!t.isDragging&&!t.isUploading?i("div",{staticClass:"video-panel-preview-image-wrapper"},[i("div",{staticClass:"video-panel-preview-image",style:{backgroundImage:t.previewBackground}})]):t._e()]):t._e()]),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.isLoading?i("div",{staticClass:"video-panel-preview-preloader rmpreloader"},[i("div",{staticClass:"shadow"}),t._v(" "),i("div",{staticClass:"arc"})]):t._e()]),t._v(" "),i("input",{ref:"uploadInput",staticClass:"uploadInput",attrs:{type:"file",name:"upload","data-url":"/api/upload/lambda/"}}),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{ref:"uploadInputDropZone"},[t.isCustomThumbnail?i("div",{staticClass:"video-panel-dropzone-container"},[t.m.picture&&t.m.picture.url&&!t.isDragging&&!t.isUploading?i("div",{staticClass:"video-panel-icon-replace",on:{click:function(e){return t.replaceCustomThumbnail()}}},[i("replace-icon")],1):t._e(),t._v(" "),i("div",{staticClass:"video-panel-thumb-upload-container"},[i("div",{staticClass:"upload"},[i("div",{staticClass:"upload-wrapper"},[i("div",{staticClass:"center-wrapper",on:{click:function(e){return t.uploadCustomThumbnail(e)}}},[t.isUploading?t._e():i("div",{staticClass:"caption-upload-dop"},[t.m.picture&&t.m.picture.url?i("span",[t._v(t._s(t.isDragging?"Drop here":""))]):i("span",[t._v("Drop file here")])])])])])]),t._v(" "),t.isUploading?i("div",{staticClass:"video-panel-thumb-preloader preloader"},[i("div",{staticClass:"rmpreloader"},[i("div",{staticClass:"arc"})])]):t._e()]):t._e()])])],1)]):t._e()]),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.isError?i("div",{staticClass:"video-panel-error",on:{click:t.dismissError}},[i("div",{staticClass:"error-text"},[t._v(t._s(t.errorText))])]):t._e()])],1)}),[],!1,null,null,null).exports),fe={components:{ColorPicker:pt.a,NumericInput:st.a,FontFamilySelector:dt.a,FontStyleSelector:ht.a},mixins:[rt],data:function(){return{stylingState:"default"}},computed:{maxBorderWidth:function(){return Math.ceil(Math.min(this.m.w,this.m.h)/2)}},watch:{stylingState:function(t){Object(u.a)(".common-button",this.raw_block.$el).toggleClass("hovered","hover"===t),Object(u.a)(".common-button",this.raw_block.$el).toggleClass("current","current"===t)}},destroyed:function(){this.setCorrectIconColor("default"),Object(u.a)(".common-button",this.raw_block.$el).toggleClass("hovered",!1),Object(u.a)(".common-button",this.raw_block.$el).toggleClass("current",!1)},methods:{onChangeStylingState:function(t){t&&t!==this.stylingState&&(this.stylingState=t),this.closeOthersPopups(null),this.setCorrectIconColor(t)},changePropHandler:function(t,e){this.m[t]=e},setCorrectIconColor:function(t){this.raw_block.onIconColorChange(this.m,null,{},t)}}},ve=(i("6ouf"),Object(nt.a)(fe,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel cart-settings-panel",class:{"default-tab":"default"===t.stylingState,"hover-tab":"hover"===t.stylingState}},[t._m(0),t._v(" "),i("div",{staticClass:"styling-state-switcher"},[i("span",{class:{btn:!0,active:"default"===t.stylingState},on:{click:function(e){return t.onChangeStylingState("default")}}},[t._v("Default")]),t._v(" "),i("span",{class:{btn:!0,active:"hover"===t.stylingState},on:{click:function(e){return t.onChangeStylingState("hover")}}},[t._v("Hover")])]),t._v(" "),i("div",{staticClass:"separator-filled"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"default"===t.stylingState,expression:"stylingState === 'default'"}],staticClass:"settings-panel"},[i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["background-color"],alpha:t.m["background-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("background-color",e)},"update:alpha":function(e){return t.changePropHandler("background-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Radius")]),t._v(" "),i("numeric-input",{staticClass:"num-input",class:{"one-digit":t.m["border-radius"]<10,"two-digit":t.m["border-radius"]<100&&t.m["border-radius"]>9,"three-digit":t.m["border-radius"]>99},attrs:{autosize:!0,value:t.m["border-radius"],min:0,max:999},on:{change:function(e){return t.changePropHandler("border-radius",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border")]),t._v(" "),i("numeric-input",{staticClass:"num-input",class:{"one-digit":t.m["border-width"]<10,"two-digit":t.m["border-width"]<100&&t.m["border-width"]>9,"three-digit":t.m["border-width"]>99},attrs:{autosize:!0,value:t.m["border-width"],min:0,max:t.maxBorderWidth},on:{change:function(e){return t.changePropHandler("border-width",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["border-color"],alpha:t.m["border-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("border-color",e)},"update:alpha":function(e){return t.changePropHandler("border-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("font-family-selector",{attrs:{family:t.m["font-family"]},on:{showPopup:t.closeOthersPopups,change:function(e){return t.changePropHandler("font-family",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("font-style-selector",{style:{"font-family":t.m["font-family"]},attrs:{"font-style":[t.m["font-style"]],"font-weight":[t.m["font-weight"]],"font-family":[t.m["font-family"]]},on:{showPopup:t.closeOthersPopups,"update:fontStyle":function(e){return t.changePropHandler("font-style",e)},"update:fontWeight":function(e){return t.changePropHandler("font-weight",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Size")]),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["font-size"],min:8,max:999},on:{change:function(e){return t.changePropHandler("font-size",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Letter spacing")]),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["letter-spacing"],min:-99,max:999,step:.1,"use-float":!0},on:{change:function(e){return t.changePropHandler("letter-spacing",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m.color,alpha:t.m["color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("color",e)},"update:alpha":function(e){return t.changePropHandler("color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m.icon_color,alpha:t.m.icon_color_opacity},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("icon_color",e)},"update:alpha":function(e){return t.changePropHandler("icon_color_opacity",e)}}})],1)]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"hover"===t.stylingState,expression:"stylingState === 'hover'"}],staticClass:"settings-panel"},[i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-background-color"],alpha:t.m["hover-background-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-background-color",e)},"update:alpha":function(e){return t.changePropHandler("hover-background-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Radius")]),t._v(" "),i("numeric-input",{staticClass:"num-input",class:{"one-digit":t.m["hover-border-radius"]<10,"two-digit":t.m["hover-border-radius"]<100&&t.m["hover-border-radius"]>9,"three-digit":t.m["hover-border-radius"]>99},attrs:{autosize:!0,value:t.m["hover-border-radius"],min:0,max:999},on:{change:function(e){return t.changePropHandler("hover-border-radius",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border")]),t._v(" "),i("numeric-input",{staticClass:"num-input",class:{"one-digit":t.m["hover-border-width"]<10,"two-digit":t.m["hover-border-width"]<100&&t.m["hover-border-width"]>9,"three-digit":t.m["hover-border-width"]>99},attrs:{autosize:!0,value:t.m["hover-border-width"],min:0,max:t.maxBorderWidth},on:{change:function(e){return t.changePropHandler("hover-border-width",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-border-color"],alpha:t.m["hover-border-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-border-color",e)},"update:alpha":function(e){return t.changePropHandler("hover-border-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-color"],alpha:t.m["hover-color-opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-color",e)},"update:alpha":function(e){return t.changePropHandler("hover-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-icon_color"],alpha:t.m["hover-icon_color_opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("hover-icon_color",e)},"update:alpha":function(e){return t.changePropHandler("hover-icon_color_opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Transition")]),t._v(" "),i("numeric-input",{staticClass:"num-input",class:{"one-digit":t.m["hover-border-radius"]<10,"two-digit":t.m["hover-border-radius"]<100&&t.m["hover-border-radius"]>9,"three-digit":t.m["hover-border-radius"]>99},attrs:{autosize:!0,value:t.m["hover-tansition-duration"],min:0,max:2,step:.1,"use-float":!0},on:{change:function(e){return t.changePropHandler("hover-tansition-duration",e)}}})],1)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-row"},[e("div",{staticClass:"title"},[this._v("Cart button")])])}],!1,null,null,null).exports),be={components:{RmSelect:yt},mixins:[rt],data:function(){return{productsOptions:this.getProductsOptions()}},computed:{thereAreProducts:function(){return this.productsOptions&&this.productsOptions.length>1},isCurrentProductInactive:function(){return!this.getCurrentProductActiveStatus()}},methods:{getProductsOptions:function(t){var e=t||this.raw_block.model.get("selected_product_id");return this.raw_block.workspace.eCommerceManager.getProductsLikeOptionsList(e)},getCurrentProductActiveStatus:function(t){var e=t||this.raw_block.model.get("selected_product_id");return this.raw_block.workspace.eCommerceManager.checkProductActive(e)},onProductSelect:function(t){this.isCurrentProductInactive&&(this.productsOptions=this.getProductsOptions(t.value),this.raw_block.workspace.eCommerceManager.getInvalidAddToCartWidgets().length<=1&&RM.constructorRouter.trigger("notice:hide","ecommHasInvalidAddToCartWidget"))}}},ye=(i("P89F"),Object(nt.a)(be,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:{panel:!0,"select-product-panel":!0,"no-products-wrap":!t.thereAreProducts}},[t.thereAreProducts?t._e():i("div",{staticClass:"no-products-alert"},[t._v("You have no active products to choose")]),t._v(" "),t.thereAreProducts?i("rm-select",{staticClass:"select-wrap",attrs:{options:t.productsOptions,"arrow-size":"big",callback:t.onProductSelect},scopedSlots:t._u([{key:"listitem",fn:function(e){return[i("span",{class:{"inactive-product":e.option.value===e.value&&!t.getCurrentProductActiveStatus()},attrs:{title:e.option.value!==e.value||t.getCurrentProductActiveStatus()?e.option.caption:"inactive product"}},[t._v(t._s(e.option.caption))]),t._v(" "),i("div",{staticClass:"point"})]}}],null,!1,3753225650),model:{value:t.m.selected_product_id,callback:function(e){t.$set(t.m,"selected_product_id",e)},expression:"m.selected_product_id"}}):t._e()],1)}),[],!1,null,"b5cd50ce",null).exports),_e=i("VxDd"),we=i.n(_e),ke=i("5bt+"),Se=i.n(ke),xe=i("Cmem"),Ce=i.n(xe),Oe=i("VsGE"),je=i.n(Oe),Pe={components:{ColorPicker:pt.a,NumericInput:st.a,FontFamilySelector:dt.a,FontStyleSelector:ht.a},mixins:[rt],data:function(){return{stylingState:"default",haveProductAttributes:this.raw_block.haveProductAttributes(),layoutHorizontalImg:we.a,layoutVerticalImg:Se.a,colorDisabledImg:Ce.a,numberDisabledImg:je.a,outOfStockEditing:!1}},computed:{maxBtnBorderWidth:function(){return Math.ceil(Math.min(this.m.btn_w,this.m.btn_h)/2)},selectionState:function(){return this.raw_block.selectionState},outOfStock:function(){return this.raw_block.workspace.eCommerceManager.getTextValue("out_of_stock")}},watch:{stylingState:function(t){this.raw_block.$el.toggleClass("hovered","hover"===t)}},destroyed:function(){this.onChangeStylingState("default")},methods:{onEditOutOfStockClick:function(){this.$refs.outOfStockInput.focus(),this.outOfStockEditing=!0},onOutOfStockBlur:function(t){this.raw_block.workspace.eCommerceManager.saveTextValue("out_of_stock",t.target.value.trim()),this.outOfStockEditing=!1},onChangeLayout:function(t){var e=t.currentTarget.dataset.layoutType;e&&this.m.layout&&this.m.layout!==e&&(this.m.layout=e)},onChangeStylingState:function(t){t&&t!==this.stylingState&&(this.stylingState=t,this.raw_block.changeStylingState(this.stylingState))},changeSinglePropHandler:function(t,e){this.m[t]=e},changeSelectIconProp:function(t,e){var i={"attrs-icon-w":e,"attrs-icon-h":this.m["attrs-icon-h"]+(e-this.m["attrs-icon-w"])};this.m=Object.assign(this.m,i)},changeIconPropHandler:function(t,e){var i={};i[t]=e,this.m[t]===this.m["hover-"+t]&&(i["hover-"+t]=e),this.m=Object.assign(this.m,i)},changeHoverPropHandler:function(t,e){var i={};"both"===this.selectionState&&(i[t]=e,i["attrs-"+t]=e),"button"===this.selectionState&&(i[t]=e),"selects"===this.selectionState&&(i["attrs-"+t]=e),this.m=Object.assign(this.m,i)},changePropHandler:function(t,e){var i={};"both"===this.selectionState&&(i[t]=e,i["attrs-"+t]=e,this.m[t]===this.m["hover-"+t]&&this.m["attrs-"+t]===this.m["attrs-hover-"+t]&&(i["hover-"+t]=e,i["attrs-hover-"+t]=e)),"button"===this.selectionState&&(i[t]=e,this.m[t]===this.m["hover-"+t]&&(i["hover-"+t]=e)),"selects"===this.selectionState&&(i["attrs-"+t]=e,this.m["attrs-"+t]===this.m["attrs-hover-"+t]&&(i["attrs-hover-"+t]=e)),this.m=Object.assign(this.m,i)},getFontFamilyValue:function(t){return"both"===this.selectionState?this.m[t]===this.m["attrs-"+t]?this.m[t]:[this.m[t],this.m["attrs-"+t]]:"button"===this.selectionState?this.m[t]:"selects"===this.selectionState?this.m["attrs-"+t]:void 0},getFontParam:function(t){return"both"===this.selectionState?"font-style"===t?this.m[t]===this.m["attrs-"+t]&&this.m["font-weight"]===this.m["attrs-font-weight"]?[this.m[t]]:[this.m[t],this.m["attrs-"+t]]:"font-weight"===t?this.m[t]===this.m["attrs-"+t]&&this.m["font-style"]===this.m["attrs-font-style"]?[this.m[t]]:[this.m[t],this.m["attrs-"+t]]:this.m[t]===this.m["attrs-"+t]?[this.m[t]]:[this.m[t],this.m["attrs-"+t]]:"button"===this.selectionState?[this.m[t]]:"selects"===this.selectionState?[this.m["attrs-"+t]]:void 0},getColorValue:function(t){return"both"===this.selectionState?this.m[t]===this.m["attrs-"+t]?this.m[t]:"000000":"button"===this.selectionState?this.m[t]:"selects"===this.selectionState?this.m["attrs-"+t]:void 0},getNumValue:function(t){return"both"===this.selectionState?this.m[t]===this.m["attrs-"+t]?this.m[t]:Math.min(this.m[t],this.m["attrs-"+t]):"button"===this.selectionState?this.m[t]:"selects"===this.selectionState?this.m["attrs-"+t]:void 0},isDisabledValue:function(t){return"both"===this.selectionState&&this.m[t]!==this.m["attrs-"+t]}}},Ee=(i("+/R+"),Object(nt.a)(Pe,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel addtocart-settings-panel",class:{"panel-default":"default"===t.stylingState,"panel-hover":"hover"===t.stylingState,"panel-both":"both"===t.selectionState,"panel-selects":"selects"===t.selectionState,"panel-button":"button"===t.selectionState}},[i("div",{staticClass:"title-row"},["both"===t.selectionState&&t.haveProductAttributes?i("div",{staticClass:"both-header header"},[i("div",{staticClass:"title"},[t._v("Layout")]),t._v(" "),i("div",{directives:[{name:"svginject",rawName:"v-svginject"}],staticClass:"layout-controls"},[i("div",{class:{"layout-btn":!0,"horizontal-layout":!0,active:"horizontal"===t.m.layout},attrs:{"data-layout-type":"horizontal"},on:{click:t.onChangeLayout}},[i("img",{staticClass:"svg layout-icon",attrs:{title:"horizontal layout",src:t.layoutHorizontalImg}})]),t._v(" "),i("div",{class:{"layout-btn":!0,"vertical-layout":!0,active:"vertical"===t.m.layout},attrs:{"data-layout-type":"vertical"},on:{click:t.onChangeLayout}},[i("img",{staticClass:"svg layout-icon",attrs:{title:"vertical layout",src:t.layoutVerticalImg}})])])]):t._e(),t._v(" "),"button"===t.selectionState||"both"===t.selectionState&&!t.haveProductAttributes?i("div",{staticClass:"button-header header"},[t._v("\n      Button\n    ")]):t._e(),t._v(" "),"selects"===t.selectionState?i("div",{staticClass:"selects-header header"},[t._v("Dropdown")]):t._e()]),t._v(" "),i("div",{staticClass:"styling-state-switcher"},[i("span",{class:{btn:!0,active:"default"===t.stylingState},on:{click:function(e){return t.onChangeStylingState("default")}}},[t._v("Default")]),t._v(" "),i("span",{class:{btn:!0,active:"hover"===t.stylingState},on:{click:function(e){return t.onChangeStylingState("hover")}}},[t._v("Hover")])]),t._v(" "),i("div",{staticClass:"separator-filled"}),t._v(" "),"default"===t.stylingState?i("div",{staticClass:"settings-panel"},[i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.getColorValue("background-color"),alpha:t.getColorValue("background-color-opacity"),"custom-icon":t.isDisabledValue("background-color")||t.isDisabledValue("background-color-opacity")?t.colorDisabledImg:null},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("background-color",e)},"update:alpha":function(e){return t.changePropHandler("background-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Radius")]),t._v(" "),i("div",{staticClass:"num-input-wrap"},[i("img",{class:{"disabled-numeric":!0,"show-disabled-icon":t.isDisabledValue("border-radius")},attrs:{src:t.numberDisabledImg}}),t._v(" "),i("numeric-input",{class:{"num-input":!0,"hidden-num-input":t.isDisabledValue("border-radius")},attrs:{autosize:!0,value:t.getNumValue("border-radius"),min:0,max:999},on:{change:function(e){return t.changePropHandler("border-radius",e)}}})],1)]),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border")]),t._v(" "),i("div",{staticClass:"num-input-wrap"},[i("img",{class:{"disabled-numeric":!0,"show-disabled-icon":t.isDisabledValue("border-width")},attrs:{src:t.numberDisabledImg}}),t._v(" "),i("numeric-input",{class:{"num-input":!0,"hidden-num-input":t.isDisabledValue("border-width")},attrs:{autosize:!0,value:t.getNumValue("border-width"),min:0,max:t.maxBtnBorderWidth},on:{change:function(e){return t.changePropHandler("border-width",e)}}})],1)]),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.getColorValue("border-color"),alpha:t.getColorValue("border-color-opacity"),"custom-icon":t.isDisabledValue("border-color")||t.isDisabledValue("border-color-opacity")?t.colorDisabledImg:null},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("border-color",e)},"update:alpha":function(e){return t.changePropHandler("border-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("font-family-selector",{attrs:{family:t.getFontFamilyValue("font-family")},on:{showPopup:t.closeOthersPopups,change:function(e){return t.changePropHandler("font-family",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("font-style-selector",{style:{"font-family":1===t.getFontParam("font-family").length?t.getFontParam("font-family")[0]:"inherit"},attrs:{"font-style":t.getFontParam("font-style"),"font-weight":t.getFontParam("font-weight"),"font-family":t.getFontParam("font-family")},on:{showPopup:t.closeOthersPopups,"update:fontStyle":function(e){return t.changePropHandler("font-style",e)},"update:fontWeight":function(e){return t.changePropHandler("font-weight",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Size")]),t._v(" "),i("div",{staticClass:"num-input-wrap"},[i("img",{class:{"disabled-numeric":!0,"show-disabled-icon":t.isDisabledValue("font-size")},attrs:{src:t.numberDisabledImg}}),t._v(" "),i("numeric-input",{class:{"num-input":!0,"hidden-num-input":t.isDisabledValue("font-size")},attrs:{autosize:!0,value:t.getNumValue("font-size"),min:8,max:999},on:{change:function(e){return t.changePropHandler("font-size",e)}}})],1)]),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Letter spacing")]),t._v(" "),i("div",{staticClass:"num-input-wrap"},[i("img",{class:{"disabled-numeric":!0,"show-disabled-icon":t.isDisabledValue("letter-spacing")},attrs:{src:t.numberDisabledImg}}),t._v(" "),i("numeric-input",{class:{"num-input":!0,"hidden-num-input":t.isDisabledValue("letter-spacing")},attrs:{autosize:!0,value:t.getNumValue("letter-spacing"),min:-99,max:999,step:.1,"use-float":!0},on:{change:function(e){return t.changePropHandler("letter-spacing",e)}}})],1)]),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.getColorValue("color"),alpha:t.getColorValue("color-opacity"),"custom-icon":t.isDisabledValue("color")||t.isDisabledValue("color-opacity")?t.colorDisabledImg:null},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changePropHandler("color",e)},"update:alpha":function(e){return t.changePropHandler("color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),"selects"!==t.selectionState?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m.icon_color,alpha:t.m.icon_color_opacity},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changeIconPropHandler("icon_color",e)},"update:alpha":function(e){return t.changeIconPropHandler("icon_color_opacity",e)}}})],1):t._e(),t._v(" "),"selects"===t.selectionState?i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon size")]),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["attrs-icon-w"],min:5,max:100},on:{change:function(e){return t.changeSelectIconProp("attrs-icon-w",e)}}})],1):t._e(),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("input",{ref:"outOfStockInput",class:{"out-of-stock-input":!0,"full-width":t.outOfStockEditing},attrs:{readonly:!t.outOfStockEditing,placeholder:"Out of stock",maxlength:"32",spellcheck:"false"},domProps:{value:t.outOfStock},on:{blur:function(e){return e.preventDefault(),t.onOutOfStockBlur(e)}}}),t._v(" "),t.outOfStockEditing?t._e():i("button",{staticClass:"edit-out-of-stock-button",on:{click:function(e){return e.preventDefault(),t.onEditOutOfStockClick(e)}}},[t._v("\n        Edit text\n      ")])])]):t._e(),t._v(" "),"hover"===t.stylingState?i("div",{staticClass:"settings-panel"},[i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Shape color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.getColorValue("hover-background-color"),alpha:t.getColorValue("hover-background-color-opacity"),"custom-icon":t.isDisabledValue("hover-background-color")||t.isDisabledValue("hover-background-color-opacity")?t.colorDisabledImg:null},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changeHoverPropHandler("hover-background-color",e)},"update:alpha":function(e){return t.changeHoverPropHandler("hover-background-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Radius")]),t._v(" "),i("div",{staticClass:"num-input-wrap"},[i("img",{class:{"disabled-numeric":!0,"show-disabled-icon":t.isDisabledValue("hover-border-radius")},attrs:{src:t.numberDisabledImg}}),t._v(" "),i("numeric-input",{class:{"num-input":!0,"hidden-num-input":t.isDisabledValue("hover-border-radius")},attrs:{autosize:!0,value:t.getNumValue("hover-border-radius"),min:0,max:999},on:{change:function(e){return t.changeHoverPropHandler("hover-border-radius",e)}}})],1)]),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border")]),t._v(" "),i("div",{staticClass:"num-input-wrap"},[i("img",{class:{"disabled-numeric":!0,"show-disabled-icon":t.isDisabledValue("hover-border-width")},attrs:{src:t.numberDisabledImg}}),t._v(" "),i("numeric-input",{class:{"num-input":!0,"hidden-num-input":t.isDisabledValue("hover-border-width")},attrs:{autosize:!0,value:t.getNumValue("hover-border-width"),min:0,max:t.maxBtnBorderWidth},on:{change:function(e){return t.changeHoverPropHandler("hover-border-width",e)}}})],1)]),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Border color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.getColorValue("hover-border-color"),alpha:t.getColorValue("hover-border-color-opacity"),"custom-icon":t.isDisabledValue("hover-border-color")||t.isDisabledValue("hover-border-color-opacity")?t.colorDisabledImg:null},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changeHoverPropHandler("hover-border-color",e)},"update:alpha":function(e){return t.changeHoverPropHandler("hover-border-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Text color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.getColorValue("hover-color"),alpha:t.getColorValue("hover-color-opacity"),"custom-icon":t.isDisabledValue("hover-color")||t.isDisabledValue("hover-color-opacity")?t.colorDisabledImg:null},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changeHoverPropHandler("hover-color",e)},"update:alpha":function(e){return t.changeHoverPropHandler("hover-color-opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Icon color")]),t._v(" "),i("color-picker",{staticClass:"round",attrs:{color:t.m["hover-icon_color"],alpha:t.m["hover-icon_color_opacity"]},on:{showPopup:t.closeOthersPopups,"update:color":function(e){return t.changeSinglePropHandler("hover-icon_color",e)},"update:alpha":function(e){return t.changeSinglePropHandler("hover-icon_color_opacity",e)}}})],1),t._v(" "),i("div",{staticClass:"separator-dotted"}),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"caption"},[t._v("Transition")]),t._v(" "),i("numeric-input",{staticClass:"num-input",attrs:{autosize:!0,value:t.m["hover-tansition-duration"],min:0,max:2,step:.1,"use-float":!0},on:{change:function(e){return t.changeSinglePropHandler("hover-tansition-duration",e)}}})],1)]):t._e()])}),[],!1,null,null,null).exports),Ie={components:{RmSwitcher:ut.a},mixins:[rt],data:function(){var t=this.raw_block.workspace.eCommerceManager,e=t.getConnectedProvider();return{eCommerceManager:t,connectedProvider:e,connectedToStripe:"stripe"===e,connectedToEcwid:"ecwid"===e}},computed:{switcherStripe:{get:function(){return this.connectedToStripe},set:function(t){this.connectedToStripe=t}},switcherEcwid:{get:function(){return this.connectedToEcwid},set:function(t){this.connectedToEcwid=t}}},mounted:function(){Object(u.a)(this.$el).find("div[data-alt]:not(.rmalttext, .viewport), li[data-alt]:not(.rmalttext)").RMAltText()},methods:{switcherStripeChange:function(t){var e=this;if(!this.connectedToEcwid)if(t){if(!this.eCommerceManager.canBeConnectedTo("stripe"))return;RM.analytics&&RM.analytics.sendEvent("Ecommerce","Enable: stripe"),this.eCommerceManager.connectToStripe().then((function(){e.switcherStripe=!0,e.eCommerceManager.updateEcommerceDataFromServer(),e.checkControlsRestrictions(),e.eCommerceManager.getProducts("stripe"),RM.analytics&&RM.analytics.sendEvent("Ecommerce","Connect: stripe")})).catch((function(t){e.switcherStripe=!1,e.checkControlsRestrictions()}))}else RM.analytics&&RM.analytics.sendEvent("Ecommerce","Disable: stripe"),this.eCommerceManager.disconnectFrom("stripe").then((function(t){e.switcherStripe=!1,e.eCommerceManager.updateEcommerceDataFromServer(),e.checkControlsRestrictions(),RM.analytics&&RM.analytics.sendEvent("Ecommerce","Disconnect: stripe")})).catch((function(t){e.switcherStripe=!0,e.checkControlsRestrictions()}))},switcherEcwidChange:function(t){var e=this;if(!this.connectedToStripe)if(t){if(!this.eCommerceManager.canBeConnectedTo("ecwid"))return;RM.analytics&&RM.analytics.sendEvent("Ecommerce","Enable: ecwid"),this.startOauth("ecwid")}else RM.analytics&&RM.analytics.sendEvent("Ecommerce","Disable: ecwid"),this.eCommerceManager.disconnectFrom("ecwid").then((function(t){e.switcherEcwid=!1,e.eCommerceManager.updateEcommerceDataFromServer(),e.checkControlsRestrictions(),RM.analytics&&RM.analytics.sendEvent("Ecommerce","Disconnect: ecwid")})).catch((function(t){e.switcherEcwid=!0,e.checkControlsRestrictions()}))},startOauth:function(t){this.AuthWindow&&this.AuthWindow.close(),this.requestedProvider=t,RM.analytics&&RM.analytics.sendEvent("Ecommerce","Enable: "+t),Object(u.a)(window).on("message",this.processWindowMessage);var e=screen.width,i=screen.height,n=Math.min(1e3,e),o=Math.min(700,i-40),a=Math.ceil((e-n)/2),r=Math.ceil((i-o)/2),s="?num_id=".concat(this.raw_block.workspace.mag.get("num_id"));this.AuthWindow=window.open("/api/connect/ecommerce/".concat(t,"/connect").concat(s),"_blank",["toolbar=no","location="+(window.opera?"no":"yes"),"directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no","width="+n,"height="+o,"top="+r,"left="+a].join())},processWindowMessage:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.originalEvent||{};if(i.origin===Ft.a.readymag_auth_host){try{t=JSON.parse(decodeURIComponent(i.data))}catch(i){console.log("Error parsing uri data")}t&&"social-auth"===t.event&&(Object(u.a)(window).off("message",this.processWindowMessage),this.AuthWindow&&this.AuthWindow.close(),this.AuthWindow=null,this.handleAuthResult(t.message))}},handleAuthResult:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=((t.data||{}).provider||"").toLowerCase();if(this.requestedProvider)if(t.error)alert("Connection error".concat(t.error.message?": ".concat(t.error.message):""));else{if(!e||e!==this.requestedProvider)return this["switcher".concat(this.requestedProvider.charAt(0).toUpperCase()+this.requestedProvider.slice(1))]=!1,void(this.requestedProvider=null);this["switcher".concat(e.charAt(0).toUpperCase()+e.slice(1))]=!0,this.eCommerceManager.updateEcommerceDataFromServer(),this.eCommerceManager.getProducts(e),this.checkControlsRestrictions(),RM.analytics&&RM.analytics.sendEvent("Ecommerce","Connect: "+e),this.requestedProvider=null}},checkControlsRestrictions:function(){this.raw_block.workspace.controls.setControls(this.raw_block.controls,this.raw_block)}}},Te=(i("EvVy"),Object(nt.a)(Ie,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel connect-panel"},[i("div",{staticClass:"title-row"},[i("span",{staticClass:"title"},[t._v(t._s(t.connectedToStripe||t.connectedToEcwid?"Connected":"Connect")+" to")]),t._v(" "),i("a",{ref:"question-enabled",staticClass:"question-icon",attrs:{href:"https://help.readymag.com/hc/en-us/articles/360035903372",rel:"noreferrer noopener",target:"_blank","data-alt-style":"controls-ecommerce-connection-icon-tooltip"}},[t._v("\n      ?\n    ")])]),t._v(" "),i("div",{staticClass:"providers-container"},[i("div",{staticClass:"provider-row"},[i("span",{staticClass:"provider-name"},[t._v("Stripe")]),t._v(" "),i("div",{class:{"rmalttext-disable":t.eCommerceManager.canBeConnectedTo("stripe")},attrs:{"data-alt":"Disconnect Ecwid to proceed","data-alt-pos":"top","data-alt-offset":"12"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.connectedToStripe,expression:"!connectedToStripe"}],staticClass:"connect-button",class:{disabled:!t.eCommerceManager.canBeConnectedTo("stripe")},on:{click:function(e){return t.switcherStripeChange(!0)}}})]),t._v(" "),i("rm-switcher",{directives:[{name:"show",rawName:"v-show",value:t.connectedToStripe,expression:"connectedToStripe"}],attrs:{value:t.switcherStripe,width:40,height:24,"color-on":"#0080FF","color-off":"#B8B8B8","is-disabled":t.connectedToEcwid,callback:t.switcherStripeChange}})],1),t._v(" "),i("div",{staticClass:"divider"}),t._v(" "),i("div",{staticClass:"provider-row"},[i("span",{staticClass:"provider-name"},[t._v("Ecwid")]),t._v(" "),i("div",{class:{"rmalttext-disable":t.eCommerceManager.canBeConnectedTo("ecwid")},attrs:{"data-alt":"Disconnect Stripe to proceed","data-alt-pos":"top","data-alt-offset":"12"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.connectedToEcwid,expression:"!connectedToEcwid"}],staticClass:"connect-button",class:{disabled:!t.eCommerceManager.canBeConnectedTo("ecwid")},on:{click:function(e){return t.switcherEcwidChange(!0)}}})]),t._v(" "),i("rm-switcher",{directives:[{name:"show",rawName:"v-show",value:t.connectedToEcwid,expression:"connectedToEcwid"}],attrs:{value:t.switcherEcwid,width:40,height:24,"color-on":"#0080FF","color-off":"#B8B8B8","is-disabled":t.connectedToStripe,callback:t.switcherEcwidChange}})],1)])])}),[],!1,null,null,null).exports),Me={mixins:[rt],data:function(){return{m:{alt:""}}}},$e=(i("UyQn"),Object(nt.a)(Me,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel picture-alt"},[i("div",{staticClass:"param-caption"},[i("span",[t._v("Semantics")]),t._v(" "),i("a",{staticClass:"question-icon",attrs:{href:"https://help.readymag.com/hc/en-us/articles/360019989052-Picture",rel:"noreferrer noopener",target:"_blank","data-alt-style":"controls-picture-alt-tooltip"}},[i("svg",{attrs:{width:"24",height:"24",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[i("circle",{attrs:{cx:"12",cy:"12",r:"12"}}),t._v(" "),i("path",{attrs:{d:"M8 9.259C8.06 7.371 9.294 6 11.542 6 13.615 6 15 7.259 15 9.02c0 1.219-.575 2.072-1.604 2.717-.992.614-1.272 1.02-1.272 1.809V14H10.37l-.008-.542c-.068-1.195.37-1.912 1.415-2.558.939-.597 1.256-1.02 1.256-1.808 0-.83-.635-1.427-1.589-1.427-.976 0-1.604.622-1.665 1.594H8zM11.5 18c-.904 0-1.5-.592-1.5-1.495 0-.913.596-1.505 1.5-1.505.922 0 1.5.592 1.5 1.505 0 .903-.578 1.495-1.5 1.495z"}})])])])]),t._v(" "),i("div",{staticClass:"param",attrs:{"data-param":"alt_text"}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.m.alt,expression:"m.alt"}],attrs:{placeholder:"Descriptive alt text",maxlength:"100"},domProps:{value:t.m.alt},on:{input:function(e){e.target.composing||t.$set(t.m,"alt",e.target.value)}}})])])}),[],!1,null,"60cc4a0c",null).exports),Ae={mixins:[rt],components:{RmSelect:yt},data:function(){return{m:{activeLink:""}}}},Re=(i("Y+fa"),{components:{ControlIcon:ot,PanelAddtocartSettings:Ee,PanelRotation:ct,PanelButtonSettings:gt,PanelTwitterSettings:St,PanelFacebookSettings:Ot,PanelGmapsSettings:Pt,PanelPictureSettings:zt,PanelPictureAlt:$e,PanelAudioSettings:Gt,PanelShapeSettings:ne,PanelSlideshowSettings:ae,PanelSlideshowTransitions:se,PanelVideo:ge,PanelCartConnections:Te,PanelCartSettings:ve,PanelProductSelector:ye,PanelRmheaderSettings:Object(nt.a)(Ae,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"panel rmheader_settings"},[t._m(0),t._v(" "),i("rm-select",{attrs:{options:[{value:"none",caption:"None"},{value:"features",caption:"Features"},{value:"pricing",caption:"Pricing"},{value:"examples",caption:"Examples"},{value:"learn",caption:"Learn"}]},model:{value:t.m.activeLink,callback:function(e){t.$set(t.m,"activeLink",e)},expression:"m.activeLink"}})],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"param-caption"},[e("span",[this._v("RM Header")])])}],!1,null,null,null).exports},computed:{cssClasses:function(){var t={fade:this.faded&&!this.selected||this.disabled,checked:this.selected,loading:this.loading};if(this.raw_block.controlsClasses&&"function"==typeof this.raw_block.controlsClasses){var e=this.raw_block.controlsClasses(this.panelComponent);e&&(t[e]=!0)}return t[this.cssClass]=!0,t},svgIcon:function(){return this.raw_block.controlsSvgIcons&&this.raw_block.controlsSvgIcons[this.panelComponent]?this.raw_block.controlsSvgIcons[this.panelComponent]:null},iconClass:function(){if(this.raw_block.controlsIconClasses&&"function"==typeof this.raw_block.controlsIconClasses){var t=this.raw_block.controlsIconClasses();return t&&t[this.panelComponent]?"function"==typeof t[this.panelComponent]?t[this.panelComponent]():t[this.panelComponent]:null}return null}},methods:{onIconClick:function(){this.selected||this.disabled?this.selected&&this.deselect():this.select()},deselect:function(){this.$emit("deselect")},select:function(){this.$emit("select")},canClosePanel:function(){if(!this.selected)return!0;var t=null;return o.a.each(this.$children,(function(e){e.canClose&&null===t&&(t=e.canClose())})),null===t||t},closePopups:function(){this.$refs.panel.closeOthersPopups()},onPanelResize:function(){this.$emit("panel-resize",this.$refs.panel.$el)}}}),De=(i("Tjx0"),Object(nt.a)(Re,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"control",appear:t.appearanceAnimation},on:{"after-leave":t.afterLeave}},[t.visible?i("div",{staticClass:"control",class:t.cssClasses,style:{top:t.y+"px"}},[i("control-icon",{attrs:{selected:t.selected,alt:t.alt,"svg-icon":t.svgIcon,"icon-class":t.iconClass},nativeOn:{click:function(e){return t.onIconClick(e)}}}),t._v(" "),i("transition",{attrs:{name:"panel"}},[t.selected?i(t.panelComponent,{ref:"panel",tag:"component",attrs:{block:t.block,raw_block:t.raw_block},on:{resize:t.onPanelResize},nativeOn:{click:function(e){return t.closePopups(e)}}}):t._e()],1)],1):t._e()])}),[],!1,null,null,null).exports),Be=a.a.extend({name:null,panelComponent:null,$el:null,alt:null,saveOnDeselect:!0,saveOnDestroy:!0,waitForRender:function(t,e){return this.isRendered()?t.apply(this,e):Y.default.nextTick(function(){return t.apply(this,e)}.bind(this))},initialize:function(t){t=t||{},a.a.prototype.initialize.apply(this,arguments),this.block=this.blocks[0],this.model=t.models&&t.models.length&&t.models[0],this.y=t.y||t.fromY,this.bindShortcuts()},getData:function(){return{cssClass:this.name,panelComponent:this.panelComponent,faded:!1,selected:!1,disabled:!1,y:this.y,visible:!1,alt:this.alt,block:JSON.parse(JSON.stringify(this.model.attributes)),raw_block:this.blocks[0],loading:!1,appearanceAnimation:this.appearanceAnimation}},onModelChange:function(){this.waitForRender(this._onModelChange.bind(this),arguments)},_onModelChange:function(t){this.vue.block=o.a.extend({},this.vue.block,o.a.pick(o.a.cloneWithObjects(t.attributes),(function(t){return void 0!==t})))},onPanelChange:function(t){this.model.set(o.a.cloneWithObjects(t))},render:function(){if(!this.isRendered()){var t=this,e=function(e){var i=e.$emit;e.$emit=function(){t.trigger.apply(t,arguments),i.apply(e,arguments)}};this.vue=new Y.default({mixins:[De],data:this.getData(),mounted:function(){e.called||(e(this),e.called=!0)},updated:function(){e.called||(e(this),e.called=!0)},methods:{afterLeave:function(){this.$el.remove(),this.$destroy()}}}),this.vue.$on("panel-resize",this.onPanelResize),this.vue.visible=!0,this.$container.append('<div id="'+this.name+'">'),this.vue.$mount("#"+this.name),this.$el=Object(u.a)(this.vue.$el),this.on("select",function(){this.master.select(this)}.bind(this)),this.on("deselect",function(){this.master.deselect()}.bind(this)),this.on("change",this.onPanelChange.bind(this)),this.listenTo(this.model,"change",this.onModelChange.bind(this)),this.setControlsStatusByBlockData(),this.block.on("disabledControls:changed",this.onDisabledControlsChanged.bind(this)),this.bindLogic()}},bindShortcuts:function(){this.shortcutHandler=this.master.select.bind(this.master,this),this.keyboardShortcut&&RM.constructorRouter.bindGlobalKeyPress([{key:this.keyboardShortcut,handler:this.shortcutHandler}]),this.onWindowKeyUpBound=this.onWindowKeyUp.bind(this),Object(u.a)(window).on("keyup",this.onWindowKeyUpBound)},unbindShortcuts:function(){this.keyboardShortcut&&RM.constructorRouter.unbindGlobalKeyPress(this.keyboardShortcut,this.shortcutHandler),Object(u.a)(window).off("keyup",this.onWindowKeyUpBound)},isRendered:function(){return Boolean(this.vue)},onPanelResize:function(t){this.$panel=Object(u.a)(t),this.updatePanelVerticalPosition()},select:function(){this.waitForRender(this._select.bind(this),arguments)},_select:function(){this.makeModelSnapshot(),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls")})),o.a.extend(this.vue,{selected:!0,faded:!1}),this.selected=!0},deselect:function(){this.waitForRender(this._deselect.bind(this),arguments)},_deselect:function(){if(this.vue){var t=this.vue.selected;o.a.extend(this.vue,{selected:!1,faded:!1}),this.selected=!1,this.clearModelSnapshot(t)}},fade:function(){this.waitForRender(this._fade.bind(this),arguments)},_fade:function(){this.deselect(),o.a.extend(this.vue,{faded:!0})},setEnabled:function(){this.waitForRender(this._setEnabled.bind(this),arguments)},_setEnabled:function(){this.vue.disabled=!1},setDisabled:function(){this.waitForRender(this._setDisabled.bind(this),arguments)},_setDisabled:function(){o.a.extend(this.vue,{selected:!1,disabled:!0})},canControlBeClosed:function(){this.waitForRender(this._canControlBeClosed.bind(this),arguments)},_canControlBeClosed:function(){return!(!this.vue||!this.vue.selected)&&(this.vue.canClosePanel()&&this.master.deselect(),!0)},moveToNewPos:function(){this.waitForRender(this._moveToNewPos.bind(this),arguments)},_moveToNewPos:function(t){this.vue?this.vue.y=t:this.y=t},onEscKey:function(){this.waitForRender(this._onEscKey.bind(this),arguments)},_onEscKey:function(){this.vue.selected&&this.master.deselect()},save:function(){this.model.save({})},destroy:function(t){this.vue&&(this.vue.visible=!1,t||(this.vue.$el.remove(),this.vue.$destroy()),this.block.off("disabledControls:changed",this.onDisabledControlsChanged),this.unBindLogic(),this.unbindShortcuts(),this.stopListening(this.model,"change"),this.clearModelSnapshot(this.vue.selected))}}),Le=Be.extend({name:"common_rotation",alt:"Rotation",panelComponent:"panel-rotation",keyboardShortcut:"r",onPanelChange:function(t){Be.prototype.onPanelChange.apply(this,arguments),(this.model.changed.hasOwnProperty("flip_v")||this.model.changed.hasOwnProperty("flip_h"))&&this.model.save({})},select:function(){Be.prototype.select.apply(this,arguments),this.block.frame.setRotationState()},deselect:function(){this.block.frame.removeRotationState(),Be.prototype.deselect.apply(this,arguments)},restrictions:function(t){var e=t.getSelectedBlocks();return e.length&&!e[0].isFullWidth()&&!e[0].isFullHeight()}}),ze=i("v92f"),Fe=i("rVpV"),Ue=i("L3tv"),Ne=i.n(Ue),He=(i("jamO"),a.a.extend({saveOnDeselect:!0,saveOnDestroy:!0,name:"common_position",className:"control common_position",events:{"click li":"toggleFixed","click .position-wrapper .sticked-left":"toggleSticked","click .position-wrapper .sticked-right":"toggleSticked","click .position-wrapper .sticked-top":"toggleSticked","click .position-wrapper .sticked-bottom":"toggleSticked","click .position-wrapper .full-width:not(.margin-input):not(.full-screen-video)":"toggleFullWidth","click .position-wrapper .full-height:not(.margin-input):not(.full-screen-video)":"toggleFullHeight","click .position-wrapper .full-screen-video.full-height":"toggleFullScreen","click .position-wrapper .full-screen-video.full-width":"toggleFullScreen","mouseover .position-wrapper .margin-input":"addHoveredClass","mouseleave .position-wrapper .margin-input":"removeHoveredClass","mouseover .position-wrapper .togglers-wrapper .full-height.active":"addFullWidthClass","mouseleave .position-wrapper .togglers-wrapper .full-height":"removeFullWidthClass","focus .position-wrapper .margin-input":"addHoveredClass","focusout .position-wrapper .margin-input":"removeHoveredClass"},POS_LIST:["nw","n","ne","w","c","e","sw","s","se"],ALLOW_FULL_WIDTH:["shape","picture","video","iframe","rmfooter","rmheader","shots"],ALLOW_FULL_HEIGHT:["shape","picture","video","iframe","shots"],initialize:function(t){this.template=Ne.a["template-constructor-control-common_position"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},restrictions:function(t){var e={},i=t.getSelectedBlocks();return o.a.reduce(i,(function(n,a){if(!n)return n;if(a.model.get("pack_id")){var r=a.model.get("pack_id");return e[r]?n:(e[r]=o.a.filter(t.blocks,(function(t){return t.model.get("pack_id")===r})),n&&o.a.filter(i,(function(t){return t.model.get("pack_id")===r})).length===e[r].length)}return n}),!0)},bindLogic:function(){var t=Object(o.a)(["fixed_position","is_full_width","full_width_margin","is_full_height","full_height_margin","sticked","sticked_margin","is_global","is_above"]).map((function(t){return"change:"+t})).join(" ");this.listenTo(this.model,t,function(){o.a.defer(this.updatePanel)}.bind(this))},unBindLogic:function(){this.stopListening(this.model)},select:function(){this.updatePanel(),a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-common_position")}))},updateModel:function(t){this.model.set(t)},render:function(){var t=!!a.a.prototype.render.apply(this,arguments);if(t){this.$fullwidthMarginInput=Object(u.a)(this.$(".full-width.margin-input")),this.$fullwidthMarginInput.RMNumericInput({onChange:function(t,e){this.setFullwidth()}.bind(this)}),this.$fullheightMarginInput=Object(u.a)(this.$(".full-height.margin-input")),this.$fullheightMarginInput.RMNumericInput({onChange:function(t,e){this.setFullheight()}.bind(this)}),Object(u.a)(this.$(".margin-input")).RMDrag({start:this.addHoveredClass,end:this.removeHoveredClass,silent:!0});var e={width:40,height:24,"color-0":"#0078ff","color-1":"#c9c8c9","text-0":"","text-1":""},i=!1;if(this.blocks&&this.blocks[0]&&this.blocks[0].mag&&this.blocks[0].workspace.eCommerceManager.haveEcommerceCartWidget){var n=this.blocks.find((function(t){return t.blockName===Ft.a.ecommerceCartBlockName}));n&&(i=!0)}var r=function(t,e){var i=!0,n=!0;o.a.each(this.blocks,(function(t){t.model.get(e)||(i=!1),t.model.get(e)&&(n=!1)})),i||n?t.setState(i,!0):t.setUndefinedState()}.bind(this);return this.globalSwitcher=Object(u.a)(this.$(".switcher.global")).RMSwitcher(i?Object.assign({},e,{disabled:!0}):e,function(t){this.setGlobal(t)}.bind(this)).data("switcher"),r(this.globalSwitcher,"is_global"),this.aboveSwitcher=Object(u.a)(this.$(".switcher.above")).RMSwitcher(e,function(t){this.setAbove(t)}.bind(this)).data("switcher"),r(this.aboveSwitcher,"is_above"),this.updatePanel(),this}this.updatePanel()},addFullWidthClass:function(){Object(u.a)(".position-wrapper .togglers-wrapper .full-width.active").addClass("light-blue")},removeFullWidthClass:function(){var t=Object(u.a)(".position-wrapper .togglers-wrapper .full-width");t.hasClass("light-blue")&&t.removeClass("light-blue")},addHoveredClass:function(t){Object(u.a)(t.currentTarget).hasClass("full-width")?this.$el.removeClass("full-height-hovered"):this.$el.removeClass("full-width-hovered"),this.$el.addClass(t.currentTarget.classList[0]+"-hovered")},removeHoveredClass:function(t){o.a.defer(function(){Object(u.a)(t.target).hasClass("dragging")||Object(u.a)(t.target).hasClass("focused")||this.$el.removeClass(this.$el.hasClass("full-width-hovered")?"full-width-hovered":"full-height-hovered")}.bind(this))},toggleFixed:function(t){var e=Object(u.a)(t.currentTarget),i=this.POS_LIST[e.index()];e.hasClass("active")?this.resetFixed(i):(this.setFixed(i),RM.constructorRouter.trigger("notice:triggerMetrics",P.a.CountFixedWidgetCreated))},toggleFullScreen:function(){var t=Object(u.a)(".position-wrapper .full-width:not(.margin-input)"),e=Object(u.a)(".position-wrapper .full-height:not(.margin-input)");t.hasClass("disabled")||e.hasClass("disabled")||(t.hasClass("active")&&!e.hasClass("active")?this.setFullheight({storeHeight:!0}):t.hasClass("active")||e.hasClass("active")?(this.resetFullheight(),this.resetFullwidth()):(this.setFullheight({storeHeight:!0}),this.setFullwidth({storeWidth:!0})))},setFixedPositionInViewports:function(){var t=this,e=this.master.workspace.page.getCurrentViewport(),i=this.getBlocksWithHotspotBlocks(),n={};o.a.each(i,function(t){var i=t.model,a=e;o.a.each(ze.b.viewport_listall,function(e){var r=(e=e.replace("viewport_",""))!==a?i["viewport_"+e]:i.attributes,s=!o.a.isEmpty(r),l=s&&!r.fixed_position,c=s&&!r.hidden;s&&l&&(e!==a&&c?(a=e,n[e]=n[e]||[],n[e].push(t)):c?(n[e]=n[e]||[],n[e].push(t)):r.fixed_position="n")}.bind(this))}.bind(this)),o.a.each(n,(function(i,n){n=n.replace("viewport_",""),o.a.each(i,(function(t){if(n!==e){var i=t.model;i.storeViewport(e),i.restoreViewport(n)}})),t.setFixed("c",i),o.a.each(i,(function(t){if(n!==e){var i=t.model;i.storeViewport(n),i.restoreViewport(e)}}))})),this.master.workspace.set_group(o.a.pluck(i,"model"))},updatePageIndex:function(t){Object(n.a)("constructor.zIndex")&&RM.constructorRouter.indexController.updateIndex(this.master.workspace.page,o.a.map(t,(function(t){return t.model})),!1)},setFixed:function(t,e){e=e?o.a.isArray(e)?e:[e]:this.blocks,this.resetSticked(e);var i=[],a={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY},r=this,s=o.a.max(this.master.workspace.blocks,(function(t){return t.model.get("z")})).model.get("z"),l=o.a.min(this.blocks,(function(t){return t.model.get("z")})).model.get("z");o.a.each(e||this.blocks,(function(t){var e=t.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0});a.t=Math.min(a.t,e.bb_y),a.l=Math.min(a.l,e.bb_x),a.b=Math.max(a.b,e.bb_y+e.bb_h),a.r=Math.max(a.r,e.bb_x+e.bb_w)})),o.a.each(e,(function(e){var c=0,d=0,h=e.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0});-1!=["n","c","s"].indexOf(t)&&(c=h.w/2-(a.r-a.l)/2),-1!=["w","c","e"].indexOf(t)&&(d=h.h/2-(a.b-a.t)/2),t.indexOf("s")>-1?0!==(d=h.y-a.b+h.h-d)&&(d*=-1):d+=h.y-a.t,t.indexOf("e")>-1?0!==(c=h.x-a.r+h.w-c)&&(c*=-1):c+=h.x-a.l;var u={_id:e.model.id,fixed_position:t,x:c,y:d};Object(n.a)("constructor.zIndex")||e.model.get("fixed_position")||(u.z=e.model.get("z")+s-l+1),o.a.defer(function(){e.model.get("is_full_height")&&r.setFullheight()}.bind(r)),i.push(u)})),this.master.workspace.set_group(i),this.updatePageIndex(e),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Fixed: On")},resetFixed:function(t){var e=[],i=this;o.a.each(this.blocks,(function(n){if(n.model.get("fixed_position")&&(!t||n.model.get("fixed_position")==t)){var a=n.$el.offset(),r=n.workspace.position;e.push({_id:n.model.id,fixed_position:"",x:a.left-r.left,y:a.top-r.top}),o.a.defer(function(){n.model.get("is_full_height")&&i.setFullheight()}.bind(i))}})),o.a.isEmpty(e)||(this.master.workspace.set_group(e),this.setAbove(!1)),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Fixed: Off")},toggleFullHeight:function(t){var e=Object(u.a)(t.currentTarget);e.hasClass("disabled")||(e.hasClass("active")?(this.removeFullWidthClass(),this.resetFullheight()):this.setFullheight({storeHeight:!0}))},toggleFullWidth:function(t){var e=Object(u.a)(t.currentTarget);e.hasClass("disabled")||e.hasClass(".full-screen-video")||(e.hasClass("active")?this.resetFullwidth():this.setFullwidth({storeWidth:!0}))},setFullheight:function(t){this.resetSticked(null,{vertical_only:!0}),t=t||{};var e=[],i=parseInt(this.$fullheightMarginInput.val(),10)||0,n=this.block.getFullHeightDims(i);o.a.each(this.blocks,(function(a){var r={_id:a.model.get("_id"),is_full_height:!0,h:n.h,full_height_margin:i};t.storeHeight&&(o.a.extend(r,{full_height_initial_y:a.model.get("y"),full_height_initial_h:a.model.get("h")}),a.model.get("angle")&&(r.angle=0),a.model.get("flip_v")&&(r.flip_v=!1),a.model.get("flip_h")&&(r.flip_h=!1)),e.push(r)})),this.master.workspace.set_group(e),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Full height: On")},setFullwidth:function(t){this.resetSticked(null,{horizontal_only:!0}),t=t||{};var e=[],i=parseInt(this.$fullwidthMarginInput.val(),10)||0,n=this.block.getFullWidthDims(i);o.a.each(this.blocks,(function(a){var r={_id:a.model.get("_id"),is_full_width:!0,w:n.w,full_width_margin:i};t.storeWidth&&(o.a.extend(r,{full_width_initial_x:a.model.get("x"),full_width_initial_w:a.model.get("w")}),a.model.get("angle")&&(r.angle=0),a.model.get("flip_v")&&(r.flip_v=!1),a.model.get("flip_h")&&(r.flip_h=!1)),e.push(r)})),this.master.workspace.set_group(e),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Full width: On")},resetFullheight:function(){var t=[],e=this;o.a.each(this.blocks,(function(i){i.model.get("is_full_height")&&t.push({_id:i.model.get("_id"),is_full_height:!1,y:i.model.get("full_height_initial_y")||i.model.get("y"),h:i.model.get("full_height_initial_h")||i.model.get("h")}),i.model.get("is_full_width")&&t.push({_id:i.model.get("_id"),w:i.getFullWidthDims().w}),o.a.defer(function(){i.model.get("fixed_position")&&e.setFixed(i.model.get("fixed_position"),i)}.bind(e))})),o.a.isEmpty(t)||this.master.workspace.set_group(t),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Full height: Off")},resetFullwidth:function(){var t=[],e=this;o.a.each(this.blocks,(function(i){i.model.get("is_full_width")&&t.push({_id:i.model.get("_id"),is_full_width:!1,x:i.model.get("full_width_initial_x")||i.model.get("x"),w:i.model.get("full_width_initial_w")||i.model.get("w")}),i.model.get("is_full_height")&&t.push({_id:i.model.get("_id"),h:i.getFullHeightDims().h}),o.a.defer(function(){i.model.get("fixed_position")&&e.setFixed(i.model.get("fixed_position"),i)}.bind(e))})),o.a.isEmpty(t)||this.master.workspace.set_group(t),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Full width: Off")},toggleSticked:function(t){var e=Object(u.a)(t.currentTarget),i=e.attr("data-side");e.hasClass("disabled")||(e.hasClass("active")?this.resetSticked(null,{side:i}):this.setSticked(i))},setSticked:function(t){this.resetFixed(),"left"!=t&&"right"!=t||this.resetFullwidth(),"top"!=t&&"bottom"!=t||this.resetFullheight();var e={t:Number.POSITIVE_INFINITY,l:Number.POSITIVE_INFINITY,b:Number.NEGATIVE_INFINITY,r:Number.NEGATIVE_INFINITY};o.a.each(this.blocks,(function(t){var i=t.getBoxData({includeBoundingBox:!0});e.t=Math.min(e.t,i.bb_y),e.l=Math.min(e.l,i.bb_x),e.b=Math.max(e.b,i.bb_y+i.bb_h),e.r=Math.max(e.r,i.bb_x+i.bb_w)}));var i=[];o.a.each(this.blocks,(function(n){var o=0,a=n.getBoxData({includeBoundingBox:!0});"left"==t?o=a.x-e.l:"right"==t?o=(e.r-(a.x+a.w))/RM.constructorRouter.zoom.getZoom():"top"==t?o=a.y-e.t:"bottom"==t&&(o=e.b-(a.y+a.h));var r=n.getStickedDims(t,o);i.push({_id:n.model.id,sticked:t,sticked_margin:o,x:r.x,y:r.y})})),o.a.isEmpty(i)||(this.master.workspace.set_group(i),this.setAbove(!1)),"top"==t?this.master.workspace.scrollToTop():"bottom"==t&&this.master.workspace.scrollToBottom(),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Position: On")},resetSticked:function(t,e){e=e||{};var i=[];o.a.each(t||this.blocks,(function(t){var n=t.model.get("sticked");if(n&&(!e.side||n==e.side)){if(e.horizontal_only&&"left"!==n&&"right"!==n)return;if(e.vertical_only&&"bottom"!==n&&"top"!==n)return;var o=t.getStickedDims();i.push({_id:t.model.id,sticked:"",x:o.x,y:o.y})}})),o.a.isEmpty(i)||this.master.workspace.set_group(i),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Position: Off")},setGlobal:function(t){var e,i=[],n=this.getBlocksWithHotspotBlocks();o.a.each(n,(function(e){i.push({_id:e.model.id,is_global:t})})),t?(RM.constructorRouter.trigger("notice:triggerMetrics",P.a.OnAllPagesWidgetUsed),o.a.each(n,function(t){var e=this.master.workspace.page.getCurrentViewport();Fe.a.resetGlobalData(t.model,e)}.bind(this))):(e=this.master.workspace.mag.changeParentPage(o.a.pluck(n,"model"),this.master.workspace.page,{silent:!0}),this.changedPages=this.changedPages||new Backbone.Collection,this.changedPages.add(e),this.aboveSwitcher.setState(t)),o.a.isEmpty(i)||(this.master.workspace.set_group(i),this.updatePageIndex(n),this.master.workspace.trigger("widget:context:change",n)),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","On all pages: "+(t?"On":"Off"))},setAbove:function(t){var e=[],i=this.getBlocksWithHotspotBlocks();void 0!==t&&this.aboveSwitcher&&this.aboveSwitcher.setState(t),t&&this.globalSwitcher.setState(t),o.a.each(i,(function(i){e.push({_id:i.model.id,is_above:t})})),t&&this.setFixedPositionInViewports(),RM.constructorRouter.workspace.common_layer&&RM.constructorRouter.workspace.common_layer.fixBadZIndexes(),o.a.isEmpty(e)||(this.master.workspace.set_group(e),this.updatePageIndex(i),this.master.workspace.trigger("widget:context:change",i)),RM.analytics&&RM.analytics.sendEvent("Fixed and Global","Above pages: "+(t?"On":"Off"))},getBlocksWithHotspotBlocks:function(){var t=[];return o.a.each(this.blocks,(function(e){"hotspot"==e.model.get("type")&&(t=o.a.union(t,e.getGroupBlocks()))})),o.a.union(t,this.blocks)},updatePanel:function(){var t=!0,e=!0,i=!1,n=!1,a=!1,r=!1,s=!1,l=!1,c=!1,d=!1,h=!1,u=!0,p=0,m=0,g=!1,f=this.$("ul li").removeClass("active"),v="default"==this.master.workspace.page.getCurrentViewport();o.a.each(this.blocks,function(v){if(i=i||"left"==v.model.get("sticked"),n=n||v.model.get("is_full_width"),a=a||v.model.get("is_full_height"),r=r||"right"==v.model.get("sticked"),s=s||"top"==v.model.get("sticked"),l=l||"bottom"==v.model.get("sticked"),d=d||v.model.get("fixed_position"),h=d||v.model.get("is_global"),u=u&&v.model.get("is_global"),c=v.model.get("video_id"),g=g||v.model.get("type")===Ft.a.ecommerceCartBlockName,t=t&&o.a.contains(this.ALLOW_FULL_WIDTH,v.model.get("type"))&&!("shape"==v.model.get("type")&&"icon"==v.model.get("tp")),e=e&&o.a.contains(this.ALLOW_FULL_HEIGHT,v.model.get("type"))&&!("shape"==v.model.get("type")&&("icon"==v.model.get("tp")||"line"==v.model.get("tp"))),v.model.get("fixed_position")&&!v.restoreFixed){var b=this.POS_LIST.indexOf(v.model.get("fixed_position"));f.eq(b).addClass("active")}v.model.get("is_full_width")&&(p=Math.max(p,v.model.get("full_width_margin")||0)),v.model.get("is_full_height")&&(m=Math.max(m,v.model.get("full_height_margin")||0))}.bind(this)),u&&this.globalSwitcher.setState(!0,!0),g&&this.globalSwitcher.setDisabled(!0),this.$fullwidthMarginInput.val(p),this.$fullheightMarginInput.val(m),this.$(".position-wrapper .sticked-left").toggleClass("disabled",!v).toggleClass("active",!!i),this.$(".position-wrapper .full-width").toggleClass("disabled",!v).toggleClass("hidden",!t).toggleClass("active",!!n).toggleClass("full-screen-video",!!c&&!!n&&!!a),this.$(".position-wrapper .full-height").toggleClass("disabled",!v).toggleClass("hidden",!e).toggleClass("active",!!a).toggleClass("full-screen-video",!!c),this.$(".position-wrapper .sticked-right").toggleClass("disabled",!v).toggleClass("active",!!r),this.$(".position-wrapper .sticked-top").toggleClass("disabled",!v).toggleClass("active",!!s),this.$(".position-wrapper .sticked-bottom").toggleClass("active",!!l),this.$el.toggleClass("full-width-margin",!(!t||!n)&&v).toggleClass("full-height-margin",!(!e||!a)&&v).toggleClass("control-active",!!(i||n||a||r||s||l||d||h)),this.updatePanelVerticalPosition()},save:function(){var t=o.a.pluck(this.getBlocksWithHotspotBlocks(),"model");o.a.isEmpty(this.changedPages)||(t=t.concat(this.changedPages.models));var e=this.master.workspace.page.getCurrentViewport();"default"!=e&&o.a.each(t,(function(t){t.storeViewport(e)})),this.master.workspace.save_group(t,{viewport:"default"}),Object(n.a)("constructor.zIndex")&&o.a.each(RM.constructorRouter.indexController.getPagesToSave(),(function(t){t.save(null,{silent:!0})})),"default"!==e&&o.a.each(t,(function(t){t.restoreViewport(e)})),this.master.workspace.common_layer.fixBadZIndexes()}})),Ve=i("Fts9"),We=i("amZL"),Ge=i("qOkM"),qe=i.n(Ge),Ke=g.extend({name:"text_styles",className:"control text_styles",MIN_PANEL_HEIGHT:275,MAX_PANEL_HEIGHT:640,STYLE_PROPERTIES:["color","opacity","font-family","font-size","font-style","font-weight","letter-spacing","line-height","text-align","text-decoration","text-transform","vertical-align","padding-top","padding-right","padding-bottom","padding-left"],saveOnDestroy:!0,initialize:function(t){this.template=qe.a["template-constructor-control-text_styles"],this.style_template=qe.a["template-constructor-control-text_styles-style"],this.initControl(t),this.block=this.blocks[0],this.refreshEditorCssDebounced=o.a.debounce(this.refreshEditorCss,100)},bindLogic:function(){this.textStyles=RM.constructorRouter.textStyles,this.textStyles.on("change:paragraph_styles",this.onStylesChange),this.$panel.on("click",".add-block .add",this.addClick),this.$panel.on("click",".paragraph-style",this.onParagraphStyleClick),this.$panel.on("click",".paragraph-style .tag-changer",this.changeStyleTag),this.$panel.on("click",".paragraph-style .menu-button",this.toggleMenu),this.$panel.on("click",".style-menu .redefine-button",this.onRedefineClick),this.$panel.on("click",".style-menu .revert-button",this.onRevertClick),this.$panel.on("click",".style-menu .edit-button",this.onEditClick),this.$panel.on("click",".style-menu .duplicate-button",this.onDuplicateClick),this.$panel.on("click",".style-menu .delete-button",this.onDeleteClick),this.params=this.block&&this.block.params||{},this.block&&this.block.on("selection_styles_all_changed",this.selectionStylesAllChanged.bind(this)),Object(u.a)(this.$panel.find(".styles-wrapper")).sortable({distance:10,axis:"y",scrollSpeed:20,containment:"parent",tolerance:"pointer",start:o.a.bind((function(t,e){this.closeMenu(!1)}),this),stop:o.a.bind((function(t,e){this.reorder()}),this)}),this.renderParagraphStyles(),this.$panel.on("click",".add-block .save",this.saveEditClick),this.$panel.on("click",".add-block .cancel",this.cancelEditClick),this.$panel.on("input",".edit-content .caption",this.onEditCaptionChange),this.$panel.on("click",".edit-content .switcher",this.onSwitcherClick),this.$panel.on("click",".edit-content .color-click-area",this.onColorboxShowClick),this.$panel.on("click",".edit-content .font-family-click-area",this.onFontSelectorShowClick),this.$panel.on("click",".edit-content .font-style-click-area",this.onFontStyleShowClick),this.$panel.on("click",".edit-scroll-wrapper",this.closeAllEditPopups),this.$panel.on("dblclick",".paragraph-style",this.onDoubleClick),this.$panel.on("click",".edit-content .tag-changer",this.changeStyleTag),this.colorbox=new Ve.a({$parent:this.$(".colorbox_container"),type:"small"}),this.colorbox.on("colorchange",this.colorOpacityChanged),this.colorbox.on("opacitychange",this.colorOpacityChanged),this.fontselector=new We.a({$parent:this.$(".fontselector_container")}),this.fontselector.on("selectfont",this.fontChanged),this.editFontSizeChangeValue=Object(u.a)(this.$panel.find(".edit-content .font-size")).RMNumericInput({min:this.params.minFontSize,max:this.params.maxFontSize,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editLineHeightChangeValue=Object(u.a)(this.$panel.find(".edit-content .line-height")).RMNumericInput({min:this.params.minLineHeight,max:this.params.maxLineHeight,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editLetterSpacingChangeValue=Object(u.a)(this.$panel.find(".edit-content .letter-spacing")).RMNumericInput({min:this.params.minLetterSpacing,max:this.params.maxLetterSpacing,mouseDir:"h",useFloat:!0,step:.2,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editPaddingLeftChangeValue=Object(u.a)(this.$panel.find(".edit-content .padding-left")).RMNumericInput({min:0,max:999,mouseSpeed:4,mouseDir:"h",onChange:this.onEditInputChanged}).data("changeValue"),this.editPaddingRightChangeValue=Object(u.a)(this.$panel.find(".edit-content .padding-right")).RMNumericInput({min:0,max:999,mouseSpeed:4,mouseDir:"h",invertMouse:!0,onChange:this.onEditInputChanged}).data("changeValue"),this.editPaddingTopChangeValue=Object(u.a)(this.$panel.find(".edit-content .padding-top")).RMNumericInput({min:0,max:999,mouseSpeed:4,invertMouse:!0,onChange:this.onEditInputChanged}).data("changeValue"),this.editPaddingBottomChangeValue=Object(u.a)(this.$panel.find(".edit-content .padding-bottom")).RMNumericInput({min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editScroll=Object(u.a)(this.$el.find(".edit-scroll-wrapper")).RMScroll({$container:this.$el.find(".edit-content-wrapper"),$content:this.$el.find(".edit-content"),$handle:this.$el.find(".edit-scroll"),wheelScrollSpeed:.4,gap_start:16,gap_end:16,onScroll:this.onEditScroll.bind(this)}).data("scroll")},unBindLogic:function(){this.block.off(null,null,this),this.textStyles.off("change:paragraph_styles",this.onStylesChange),this.$panel.off("click",".add-block .add",this.addClick),this.$panel.off("click",".paragraph-style",this.onParagraphStyleClick),this.$panel.off("click",".paragraph-style .tag-changer",this.changeStyleTag),this.$panel.off("click",".paragraph-style .menu-button",this.toggleMenu),this.$panel.off("click",".style-menu .redefine-button",this.onRedefineClick),this.$panel.off("click",".style-menu .revert-button",this.onRevertClick),this.$panel.off("click",".style-menu .edit-button",this.onEditClick),this.$panel.off("click",".style-menu .duplicate-button",this.onDuplicateClick),this.$panel.off("click",".style-menu .delete-button",this.onDeleteClick),this.$panel.off("dblclick",".paragraph-style",this.onDoubleClick),this.$panel.off("click",".edit-content .tag-changer",this.changeStyleTag),this.block&&this.block.off("selection_styles_all_changed",this.selectionStylesAllChanged),this.$panel.off("click",".add-block .save",this.saveEditClick),this.$panel.off("click",".add-block .cancel",this.cancelEditClick),this.$panel.off("input",".edit-content .caption",this.onEditCaptionChange),this.$panel.off("click",".edit-content .switcher",this.onSwitcherClick),this.$panel.off("click",".edit-content .color-click-area",this.onColorboxShowClick),this.$panel.off("click",".edit-content .font-family-click-area",this.onFontSelectorShowClick),this.$panel.off("click",".edit-content .font-style-click-area",this.onFontStyleShowClick),this.$panel.off("click",".edit-scroll-wrapper",this.closeAllEditPopups),this.colorbox&&this.colorbox.off("colorchange",this.colorOpacityChanged),this.colorbox&&this.colorbox.off("opacitychange",this.colorOpacityChanged),this.colorbox&&this.colorbox.destroy(),this.colorbox=null,this.fontselector&&this.fontselector.off("selectfont",this.fontChanged),this.fontselector&&this.fontselector.destroy(),this.fontselector=null},onStylesChange:function(t,e,i){(i=i||{}).socketUpdate&&this.renderParagraphStyles()},renderParagraphStyles:function(){var t=this.textStyles.getStylesListSorted("paragraph"),e="";o.a.each(t,(function(t){e+=this.style_template(t)}),this),this.$panel.find(".styles-wrapper").html(e),this.resizableScroll&&this.resizableScroll.recalc(),Object(u.a)(this.$panel.find(".styles-wrapper")).sortable("refresh")},reorder:function(){var t=[];this.$(".paragraph-style").each((function(){t.push(Object(u.a)(this).attr("data-id"))})),this.textStyles.reorder("paragraph",t)},selectionStylesAllChanged:function(t){if(this.selected){var e={};this.$(".paragraph-style.active").each((function(){e[Object(u.a)(this).attr("data-id")]=!0})),this.closeMenu(!0);var i={},n={};o.a.each(t,o.a.bind((function(t,e){var a=this.textStyles.findStyle("paragraph",t["paragraph-class"]),r=a?a._name:"",s=o.a.pick.apply(void 0,o.a.union([t],this.STYLE_PROPERTIES)),l=o.a.values(s).join("|");if(i[r]||(i[r]={}),n[l]=!0,0==e&&this.$panel.find(".add-block .add").attr("data-redefine",l),a){var c=o.a.pick.apply(void 0,o.a.union([a],this.STYLE_PROPERTIES));l!=o.a.values(c).join("|")&&(i[r][l]=!0)}else i[r][l]=!0}),this)),this.$(".paragraph-style").removeClass("active is-changed can-redefine can-override"),o.a.each(i,o.a.bind((function(t,e){if(e){var i=this.$('.paragraph-style[data-id="'+e+'"]');i.addClass("active"),o.a.isEmpty(t)||i.addClass("is-changed can-override")}else this.$('.paragraph-style[data-id="paragraph-none"]').addClass("active")}),this));var a=o.a.keys(n).length;if(a<=2){var r=o.a.keys(n);this.$(".paragraph-style").each(o.a.bind((function(t,e){var i=Object(u.a)(e),n=this.textStyles.findStyle("paragraph",i.attr("data-id"));if(n){var s,l=o.a.pick.apply(void 0,o.a.union([n],this.STYLE_PROPERTIES)),c=o.a.values(l).join("|");1==a&&c!=r[0]&&(s=r[0]),2==a&&c==r[0]&&(s=r[1]),2==a&&c==r[1]&&(s=r[0]),s&&i.addClass("can-redefine").attr("data-redefine",s)}}),this))}var s={};if(this.$(".paragraph-style.active").each((function(){s[Object(u.a)(this).attr("data-id")]=!0})),!o.a.isEqual(e,s)){var l=this.$(".paragraph-style.active").first();if(l.length){var c,d=this.$panel.find(".resizable-content-wrapper"),h=l.position().top,p=d.height(),m=l.outerHeight();h+m-d.scrollTop()>p-8?c=h+m-p+8:h-d.scrollTop()<8&&(c=h-8),null!=c&&d.stop().animate({scrollTop:c},200)}}}},onParagraphStyleClick:function(t){if(!Object(u.a)(t.target).closest(".menu-button").length&&!Object(u.a)(t.target).closest(".tag-changer").length){var e=Object(u.a)(t.target).closest(".paragraph-style").attr("data-id");this.block&&("paragraph-none"==e?this.block.trigger("changeClassParagraph",{remove:!0}):this.block.trigger("changeClassParagraph",{class:e}))}},getNextStyleTag:function(t){var e=Ft.a.AVAILABLE_TEXT_TAGS,i=e.indexOf(t);return i>-1?e[i+1]||e[0]:t},changeStyleTag:function(t){if(this.currentEditStyle){var e=this.getNextStyleTag(this.currentEditStyle.tag||"p");this.currentEditStyle.tag=e,this.setEditParams(this.currentEditStyle),this.refreshEditorCssDebounced(),this.renderParagraphStyles()}else{var i=Object(u.a)(t.target),n=i.closest(".paragraph-style"),o=n.attr("data-id"),a=n.attr("data-tag"),r=this.textStyles.findStyle("paragraph",o);r.tag=this.getNextStyleTag(a),this.textStyles.changeStyle("paragraph",r._name),i.text(r.tag),n.attr("data-tag",r.tag)}},toggleMenu:function(t){var e=Object(u.a)(t.currentTarget),i=e.hasClass("active"),n=this.$(".style-menu");i?this.closeMenu(!0):(this.$(".paragraph-style .menu-button.active").length>0&&this.closeMenu(!1),setTimeout(o.a.bind((function(){var t=e.closest(".paragraph-style"),i=t.position().top+e.position().top+e.height()-this.$panel.find(".resizable-content-wrapper").scrollTop()-5;n.css("top",i).addClass("shown").attr("data-id",t.attr("data-id")).toggleClass("can-redefine",t.hasClass("can-redefine")).toggleClass("can-override",t.hasClass("can-override")),e.addClass("active")}),this),40))},closeMenu:function(t){var e=this.$(".style-menu");t||e.removeClass("transition-enable"),e.removeClass("shown"),t||setTimeout((function(){e.addClass("transition-enable")}),20),this.$(".paragraph-style .menu-button").removeClass("active")},onPanelScroll:function(t){this.closeMenu(!0)},onRedefineClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu"),i=this.$('.paragraph-style[data-id="'+e.attr("data-id")+'"]').attr("data-redefine"),n=o.a.object(this.STYLE_PROPERTIES,i.split("|"));this.textStyles.redefineStyle("paragraph",e.attr("data-id"),n),RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("paragraph","constructor",document),this.resizableScroll&&this.resizableScroll.recalc(),this.block.somethingChangedInEditor("styleRedefined")},onRevertClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu").attr("data-id");this.block&&("paragraph-none"==e?this.block.trigger("changeClassParagraph",{remove:!0,override:!0}):this.block.trigger("changeClassParagraph",{class:e,override:!0}))},onDuplicateClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu").attr("data-id"),i=this.textStyles.duplicateStyle("paragraph",e),n=this.$('.paragraph-style[data-id="'+e+'"]');if(i){RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("paragraph","constructor",document),this.block.somethingChangedInEditor("styleAdded");var a=Object(u.a)(this.style_template(i));a.addClass("enable-transition").css("margin-top",-n.outerHeight()),a.insertAfter(n),setTimeout(o.a.bind((function(){a.css("margin-top",0),setTimeout(o.a.bind((function(){a.removeClass("enable-transition"),Object(u.a)(this.$panel.find(".styles-wrapper")).sortable("refresh"),this.resizableScroll&&this.resizableScroll.recalc()}),this),270)}),this),50)}},onDeleteClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu").attr("data-id"),i=this.$('.paragraph-style[data-id="'+e+'"]');this.closeMenu(!0),i.addClass("enable-transition"),setTimeout(o.a.bind((function(){i.addClass("shift-left"),setTimeout(o.a.bind((function(){i.css("margin-top",-i.outerHeight()),setTimeout(o.a.bind((function(){i.remove(),Object(u.a)(this.$panel.find(".styles-wrapper")).sortable("refresh"),this.resizableScroll&&this.resizableScroll.recalc(),RM.constructorRouter.textStyles.deleteStyle("paragraph",e),RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("paragraph","constructor",document),this.block.somethingChangedInEditor("styleDeleted")}),this),270)}),this),270)}),this),50)},addClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-redefine"),i=o.a.object(this.STYLE_PROPERTIES,e.split("|")),n=this.textStyles.addStyle("paragraph",i);RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("paragraph","constructor",document),this.block.somethingChangedInEditor("styleAdded");var a=Object(u.a)(this.style_template(n));a.addClass("enable-transition").addClass("collapsed"),this.$panel.find(".styles-wrapper").append(a);var r=Object(u.a)(a).closest(".paragraph-style").attr("data-id");this.block&&this.block.trigger("changeClassParagraph",{class:r}),this.$el.find(".resizable-content-wrapper").scrollTop(9999),setTimeout(o.a.bind((function(){a.removeClass("collapsed"),setTimeout(o.a.bind((function(){a.removeClass("enable-transition"),Object(u.a)(this.$panel.find(".styles-wrapper")).sortable("refresh"),this.resizableScroll&&this.resizableScroll.recalc()}),this),270)}),this),50)},onScrollRecalc:function(t){this.editScroll&&this.editScroll.recalc()},openMenu:function(t){var e=this.textStyles.findStyle("paragraph",t);this.originalEditStyle=o.a.clone(e),this.currentEditStyle=e,this.setEditParams(this.currentEditStyle),this.$panel.addClass("toggle-opaque"),this.closeMenu(!0),setTimeout(o.a.bind((function(){this.$panel.addClass("show-style-edit")}),this),300)},onEditClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu").attr("data-id");this.openMenu(e)},onDoubleClick:function(t){var e=Object(u.a)(t.target).closest(".paragraph-style").attr("data-id");this.openMenu(e)},editClose:function(){this.closeAllEditPopups(),RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("paragraph","constructor",document),this.resizableScroll&&this.resizableScroll.recalc(),this.block.somethingChangedInEditor("styleChanged"),this.$panel.removeClass("show-style-edit"),setTimeout(o.a.bind((function(){this.$panel.removeClass("toggle-opaque")}),this),400),this.currentEditStyle=void 0},setEditParams:function(t){var e=this.$panel.find(".edit-content");e.find(".caption").val(t._caption);var i=RM.constructorRouter.fonts.findFontByCSSName(t["font-family"]);e.find(".font-family").text(i.name).css("font-family",i.css_name);var n=RM.constructorRouter.fonts.getStyleName(t["font-weight"],t["font-style"],i.name);e.find(".font-style").text(n).css({"font-family":i.css_name,"font-style":t["font-style"],"font-weight":t["font-weight"]}),e.find(".color-value").text("#"+t.color),e.find(".color-circle").css({background:"#"+t.color,opacity:t.opacity/100}),this.editFontSizeChangeValue(t["font-size"],!0),this.editLineHeightChangeValue(t["line-height"],!0),this.editLetterSpacingChangeValue(t["letter-spacing"],!0),e.find(".text-align-left").toggleClass("active","left"==t["text-align"]),e.find(".text-align-center").toggleClass("active","center"==t["text-align"]),e.find(".text-align-right").toggleClass("active","right"==t["text-align"]),e.find(".text-align-justify").toggleClass("active","justify"==t["text-align"]),e.find(".text-transform").toggleClass("active","uppercase"==t["text-transform"]),e.find(".text-underline").toggleClass("active","underline"==t["text-decoration"]),e.find(".text-strike").toggleClass("active","line-through"==t["text-decoration"]),this.editPaddingLeftChangeValue(t["padding-left"],!0),this.editPaddingRightChangeValue(t["padding-right"],!0),this.editPaddingTopChangeValue(t["padding-top"],!0),this.editPaddingBottomChangeValue(t["padding-bottom"],!0),e.find(".tag-changer span").text(t.tag||"p")},onEditCaptionChange:function(t){this.currentEditStyle._caption=Object(u.a)(t.target).val()},onEditInputChanged:function(t,e){this.currentEditStyle[t.attr("data-param")]=e,this.refreshEditorCssDebounced()},onSwitcherClick:function(t){var e=Object(u.a)(t.target).attr("data-param"),i=Object(u.a)(t.target).attr("data-val");this.currentEditStyle[e]==i?this.currentEditStyle[e]="text-align"==e?"start":"none":this.currentEditStyle[e]=i,this.setEditParams(this.currentEditStyle),this.refreshEditorCssDebounced()},colorOpacityChanged:function(t,e,i,n){this.currentEditStyle.color=this.colorbox&&this.colorbox.rgb2hex([t,e,i]),this.currentEditStyle.opacity=100*n,this.setEditParams(this.currentEditStyle),this.refreshEditorCssDebounced()},fontChanged:function(t){this.currentEditStyle["font-family"]=t,this.setEditParams(this.currentEditStyle),this.refreshEditorCssDebounced()},styleChanged:function(t){this.currentEditStyle["font-weight"]=Object(u.a)(t.currentTarget).attr("data-font-weight"),this.currentEditStyle["font-style"]=Object(u.a)(t.currentTarget).attr("data-font-style"),this.setEditParams(this.currentEditStyle),this.refreshEditorCssDebounced(),this.closeFontStyle()},refreshEditorCss:function(){RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.block.iframe_document),this.block.somethingChangedInEditor("styleChanging")},onColorboxShowClick:function(t){this.colorbox_visible?this.closeColorBox():(this.closeAllEditPopups(),this.colorbox_visible=!0,this.$(".colorbox_container").fadeIn(200),this.colorbox.setOpacity(this.currentEditStyle.opacity/100),this.colorbox.setColor(this.currentEditStyle.color),this.positionPopup(this.$(".colorbox_container"),this.$(".edit-content .color-click-area")))},onFontSelectorShowClick:function(t){this.fontselector_visible?this.closeFontSelector():(this.closeAllEditPopups(),this.fontselector_visible=!0,this.fontselector&&this.fontselector.show([this.currentEditStyle["font-family"]]),this.positionPopup(this.$(".fontselector_container"),this.$(".edit-content .font-family-click-area")))},onFontStyleShowClick:function(t){if(this.fontstyle_visible)this.closeFontStyle();else{this.closeAllEditPopups();var e=this.$(".fontstyle_container .font-style-wrapper");e.empty();var i=RM.constructorRouter.fonts.findFontByCSSName(this.currentEditStyle["font-family"]);i&&(o.a.each(i.variations,o.a.bind((function(t){var n=100*(t.substr(1,1)-0),o="n"==t.substr(0,1)?"normal":"italic",a=RM.constructorRouter.fonts.getStyleName(n,o,i.name),r=Object(u.a)("<div>").appendTo(e).addClass("font-style-item").text(a).css({"font-family":i.css_name,"font-weight":n+"","font-style":o}).attr("data-font-weight",n).attr("data-font-style",o).on("click",this.styleChanged);Object(u.a)("<div>").appendTo(r).addClass("point");n==this.currentEditStyle["font-weight"]&&o==this.currentEditStyle["font-style"]&&r.addClass("curr")}),this)),this.fontstyle_visible=!0,this.$(".fontstyle_container").fadeIn(200),this.positionPopup(this.$(".fontstyle_container"),this.$(".edit-content .font-style-click-area")))}},positionPopup:function(t,e){var i=t.children().first().height(),n=this.$panel.height(),o=Math.floor((n-i)/2),a=e.position().top-this.$panel.find(".edit-content-wrapper").scrollTop();t.css({top:Math.min(o,a)})},closeColorBox:function(){this.colorbox_visible=!1,this.$(".colorbox_container").fadeOut(200)},closeFontSelector:function(){this.fontselector_visible=!1,this.fontselector.hide()},closeFontStyle:function(){this.fontstyle_visible=!1,this.$(".fontstyle_container").fadeOut(200)},closeAllEditPopups:function(t){if(t){if(Object(u.a)(t.target).closest(".colorbox_container").length>0)return;if(Object(u.a)(t.target).closest(".color-click-area").length>0)return;if(Object(u.a)(t.target).closest(".fontselector_container").length>0)return;if(Object(u.a)(t.target).closest(".font-family-click-area").length>0)return;if(Object(u.a)(t.target).closest(".fontstyle_container").length>0)return;if(Object(u.a)(t.target).closest(".font-style-click-area").length>0)return}this.colorbox_visible&&this.closeColorBox(),this.fontselector_visible&&this.closeFontSelector(),this.fontstyle_visible&&this.closeFontStyle()},onEditScroll:function(){this.closeAllEditPopups()},saveEditClick:function(){this.$('.paragraph-style[data-id="'+this.currentEditStyle._name+'"]').find(".style-caption").text(this.currentEditStyle._caption),this.textStyles.changeStyle("paragraph",this.currentEditStyle._name),this.editClose()},onEnterKey:function(){this.$panel.hasClass("show-style-edit")&&this.saveEditClick()},cancelEditClick:function(){this.textStyles.restoreStyle("paragraph",this.currentEditStyle._name,this.originalEditStyle),this.editClose()},save:function(){o.a.isEqual(this.textStyles.getOrder("paragraph"),this.textStyles.orderBefore.paragraph)||this.textStyles.save()},deselect:function(){this.closeAllEditPopups(),g.prototype.deselect.apply(this,arguments)},destroy:function(){this.$panel.hasClass("show-style-edit")&&this.saveEditClick(),this.save(),g.prototype.destroy.apply(this,arguments)},select:function(){g.prototype.select.apply(this,arguments),this.block&&this.selectionStylesAllChanged(this.block.cur_selection_styles_all),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_styles")}))},onClick:function(){if(this.selected){if(this.colorbox_visible||this.fontselector_visible||this.fontstyle_visible)return void this.closeAllEditPopups();if(this.$(".style-menu").hasClass("shown"))return void this.closeMenu(!0)}g.prototype.onClick.apply(this,arguments)},onEscKey:function(){if(this.selected){if(this.colorbox_visible||this.fontselector_visible||this.fontstyle_visible)return void this.closeAllEditPopups();if(this.$(".style-menu").hasClass("shown"))return void this.closeMenu(!0)}g.prototype.onEscKey.apply(this,arguments)},canControlBeClosed:function(){return this.colorbox_visible||this.fontselector_visible||this.fontstyle_visible?(this.closeAllEditPopups(),!0):this.$(".style-menu").hasClass("shown")?(this.closeMenu(!0),!0):g.prototype.canControlBeClosed.apply(this,arguments)}}),Ye=i("+teE"),Xe=i.n(Ye),Ze=a.a.extend({name:"text_typography",className:"control text_typography",initialize:function(t){this.template=Xe.a["template-constructor-control-text_typography"],this.initControl(t)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_typography")}))},bindLogic:function(){this.$panel.on("click",this.closeAllPopups),this.fontselector=new We.a({$parent:this.$panel,css:{left:-79,top:-33}}),this.fontselector.on("selectfont",this.fontChanged),this.params=this.blocks&&this.blocks[0].params||{},this.$panel.on("click",".linked",this.onLinkedClick),this.$panel.on("click",".font-family-popup",this.onFontPopupClick),this.$panel.on("click",".font-style-popup",this.onFontStylePopupClick),this.editFontSizeChangeValue=Object(u.a)(this.$panel.find(".font-size")).RMNumericInput({min:this.params.minFontSize,max:this.params.maxFontSize,mouseSpeed:4,onChange:this.onInputChanged}).data("changeValue"),this.editLineHeightChangeValue=Object(u.a)(this.$panel.find(".line-height")).RMNumericInput({min:this.params.minLineHeight,max:this.params.maxLineHeight,mouseSpeed:4,onChange:this.onInputChanged}).data("changeValue"),this.editLetterSpacingChangeValue=Object(u.a)(this.$panel.find(".letter-spacing")).RMNumericInput({min:this.params.minLetterSpacing,max:this.params.maxLetterSpacing,mouseDir:"h",useFloat:!0,step:.2,shiftStep:1,mouseSpeed:4,onChange:this.onLetterSpacingChanged}).data("changeValue"),this.blocks&&this.blocks[0].on("selection_styles_changed",this.selectionStylesChanged),this.blocks&&this.blocks[0].on("selection_styles_all_changed",this.selectionStylesAllChanged),this.blocks&&this.selectionStylesChanged(this.blocks[0].cur_selection_styles),this.blocks&&this.selectionStylesAllChanged(this.blocks[0].cur_selection_styles_all)},unBindLogic:function(){this.$panel.off("click",this.closeAllPopups),this.fontselector&&this.fontselector.off("selectfont",this.fontChanged),this.fontselector&&this.fontselector.destroy(),this.font_selector_visible=!1,this.fontselector=null,this.$panel.off("click",".linked",this.onLinkedClick),this.$panel.off("click",".font-family-popup",this.onFontPopupClick),this.$panel.off("click",".font-style-popup, .font-style",this.onFontStylePopupClick),this.blocks&&this.blocks[0].off("selection_styles_changed",this.selectionStylesChanged),this.blocks&&this.blocks[0].off("selection_styles_all_changed",this.selectionStylesAllChanged)},plusAnimation:function(){this.$el.flashClass("plus-animation",1200)},selectionStylesAllChanged:function(t){this.$panel.find(".font-style").fadeOut(200),this.font_style_visible=!1,this.fonts_in_selection=[],this.styles_in_selection=[];var e,i=[],n=[],a=[];if(t&&RM.constructorRouter.fonts&&t.length>0){for(var r=0;r<t.length;r++){n.push(t[r]["font-family"]);var s=RM.constructorRouter.fonts.getVisualRenderedFontStyles(t[r]["font-family"],t[r]["font-weight"],t[r]["font-style"]);a.push(s["font-weight"]+"-"+s["font-style"])}if(n=o.a.uniq(n),a=o.a.uniq(a),n.length>0&&(this.fonts_in_selection=n),1==n.length&&(e=n[0]),a.length>0&&o.a.each(a,o.a.bind((function(t){var i=t.split("-");2==i.length&&this.styles_in_selection.push({name:RM.constructorRouter.fonts.getStyleName(i[0],i[1],e),"font-weight":i[0],"font-style":i[1]})}),this)),n.length>0&&a.length>0){var l=RM.constructorRouter.fonts.findCommonFontsStylesAvailable(n);o.a.each(l,(function(t){var n=t.split("-");2==n.length&&i.push({name:RM.constructorRouter.fonts.getStyleName(n[0],n[1],e),"font-weight":n[0],"font-style":n[1]})}))}}var c=o.a.map(this.fonts_in_selection,(function(t){return RM.constructorRouter.fonts.findFontByCSSName(t).name}));this.$panel.find(".font-family-popup .popup-caption").text(c.join(", ")).css("font-family",this.fonts_in_selection.length>0?this.fonts_in_selection[0]:"Arial");var d=o.a.pluck(this.styles_in_selection,"name");this.$panel.find(".font-style-popup .popup-caption").text(d.join(", ")).css({"font-family":this.fonts_in_selection.length>0?this.fonts_in_selection[0]:"Arial","font-weight":this.styles_in_selection.length>0?this.styles_in_selection[0]["font-weight"]:"400","font-style":this.styles_in_selection.length>0?this.styles_in_selection[0]["font-style"]:"normal"});var h=this.$panel.find(".font-style-wrapper");if(h.empty(),o.a.each(i,o.a.bind((function(t,e){var i=Object(u.a)("<div>").appendTo(h).addClass("font-style-item").text(t.name).css({"font-family":this.fonts_in_selection.length>0?this.fonts_in_selection[0]:"Arial","font-weight":t["font-weight"]+"","font-style":t["font-style"]}).attr("font-weight",t["font-weight"]).attr("font-style",t["font-style"]).on("click",this.styleChanged);Object(u.a)("<div>").appendTo(i).addClass("point");o.a.indexOf(d,t.name)+1&&i.addClass("curr")}),this)),this.$panel.find(".font-style-popup").toggleClass("disabled",0==i.length),this.font_selector_visible){var p=this.blocks[0].initiatorControl==this.name?void 0:300;this.fontselector&&this.fontselector.setActiveFont(this.fonts_in_selection||[],p)}t.length&&this.$panel.find(".linked").toggleClass("active",t[0]["size-leading-linked"])},selectionStylesChanged:function(t){"text_typography"!==this.blocks[0].initiatorControl&&this.blocks[0].initiatorControl==this.name||this.updateState(t)},updateState:function(t){null!=t["font-size"]&&this.setMultipleState(this.$panel.find(".font-size"),this.editFontSizeChangeValue,t,"font-size",!0),null!=t["line-height"]&&this.setMultipleState(this.$panel.find(".line-height"),this.editLineHeightChangeValue,t,"line-height",!0),null!=t["letter-spacing"]&&this.setMultipleState(this.$panel.find(".letter-spacing"),this.editLetterSpacingChangeValue,t,"letter-spacing",!1)},setMultipleState:function(t,e,i,n,o){if(this.blocks){var a,r=t.parent().find(".multiple-layer");i[n]==this.blocks[0].params.multipleName?(r.css("display","block"),t.css("opacity",0),a=this.blocks[0].cur_selection_styles_all.length>0?this.blocks[0].cur_selection_styles_all[0][n]:"line-height"==n?this.params.minLineHeight:this.params.minFontSize):(r.css("display","none"),t.css("opacity",1),a=i[n]),e(a=parseFloat(a),!0),o&&this.onInputChanged(t,a,!0,!0)}},onLinkedClick:function(){var t=this.$panel.find(".linked"),e=(this.$panel.find(".font-size"),this.blocks[0].cur_selection_styles_all);if(t.toggleClass("active"),t.hasClass("active")?t.attr("title","Unbind Font Size and Line Height"):t.attr("title","Bind Font Size and Line Height"),this.blocks[0].cur_selection_styles["size-leading-linked"]!=this.blocks[0].params.multipleName&&this.blocks[0].cur_selection_styles["size-leading-ratio"]!=this.blocks[0].params.multipleName){var i={"size-leading-linked":this.$panel.find(".linked").hasClass("active"),"size-leading-ratio":parseInt(e[0]["line-height"],10)/parseInt(e[0]["font-size"],10)};isNaN(i["size-leading-ratio"])&&(i["size-leading-ratio"]=this.params.fontSizeLineHeightRatio),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleParagraph",i))}},onInputChanged:function(t,e,i,n){if(this.blocks){var a=t.attr("data-class"),r="line-height"==a?this.params.minLineHeight:this.params.minFontSize;"line-height"==a?this.params.maxLineHeight:this.params.maxFontSize;this["springEffect-"+a]=this["springEffect-"+a]||0;try{var s=this.blocks[0].cur_selection_styles_all[0]["size-leading-ratio"];if(isNaN(s))s=this.params.fontSizeLineHeightRatio}catch(t){console.log(t.message,t.stack),this.blocks&&(console.log(this.blocks),this.blocks[0]&&(console.log(this.blocks[0]),this.blocks[0].cur_selection_styles_all&&(console.log(this.blocks[0].cur_selection_styles_all),this.blocks[0].cur_selection_styles_all[0]&&console.log(this.blocks[0].cur_selection_styles_all[0]))));s=this.params.fontSizeLineHeightRatio}if(this.$panel.find(".linked").hasClass("active")&&!i&&"font-size"==a){var l=Math.round(e*s);this.editLineHeightChangeValue(l,!0),this.onInputChanged(this.$panel.find(".line-height"),l,!0)}if(this.$panel.find(".linked").hasClass("active")&&!i&&"line-height"==a){l=Math.round(e/s);this.editFontSizeChangeValue(l,!0),this.onInputChanged(this.$panel.find(".font-size"),l,!0)}t.toggleClass("big-number",e>99);var c=0;this["oldVal-"+a]>e&&(c=-1),this["oldVal-"+a]<e&&(c=1),this["oldVal-"+a]=e;var d=(e-r)/63;if(d>1){if(clearTimeout(this["springTimeout-"+a]),this["springEffect-"+a]-=1*c,this["springEffect-"+a]>100&&(this["springEffect-"+a]=100),this["springEffect-"+a]<-100&&(this["springEffect-"+a]=-100),this["springEffect-"+a]>0)var h=Math.sqrt(this["springEffect-"+a]);else h=-Math.sqrt(-this["springEffect-"+a]);t.parent().removeClass("spring-effect"),t.parent().css({"margin-top":-25+h}),this["springTimeout-"+a]=setTimeout(o.a.bind((function(){t.parent().addClass("spring-effect").css({"margin-top":"-25px"}),this["springEffect-"+a]=0}),this),200),d=1}var u=188+-63*d;if(t.parent().css({top:u}),this.$panel.find("."+a+"-gauge").height(188-u+17),!n){var p={};p[a]=e+"px",this.updateState(p),this.$panel.find(".linked").hasClass("active")&&(p["font-size"]=this.$panel.find(".font-size").val()+"px",p["line-height"]=this.$panel.find(".line-height").val()+"px"),p["size-leading-linked"]=this.$panel.find(".linked").hasClass("active"),p["size-leading-ratio"]=s,this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleParagraph",p))}}},onLetterSpacingChanged:function(t,e){var i={"letter-spacing":e+"px"};this.updateState(i),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",i))},onFontPopupClick:function(t){this.fontselector&&this.fontselector.show(this.fonts_in_selection||[]),this.font_selector_visible=!0},onFontStylePopupClick:function(t){this.$panel.find(".font-style-popup").hasClass("disabled")||(this.font_style_visible=!this.$panel.find(".font-style").is(":visible"),this.$panel.find(".font-style").fadeToggle(200))},fontChanged:function(t){var e={"font-family":t};this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},styleChanged:function(t){var e=Object(u.a)(t.currentTarget),i={"font-weight":e.attr("font-weight"),"font-style":e.attr("font-style")};this.closeFontStyle(),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",i))},closeFontSelector:function(){this.font_selector_visible=!1,this.fontselector&&this.fontselector.hide()},closeFontStyle:function(){this.font_style_visible=!1,this.$panel.find(".font-style").fadeOut(200)},closeAllPopups:function(t){if(t){if(Object(u.a)(t.target).closest(".rmfontselector").length>0)return;if(Object(u.a)(t.target).closest(".font-family-popup").length>0)return;if(Object(u.a)(t.target).closest(".font-style-wrapper").length>0)return;if(Object(u.a)(t.target).closest(".font-style-popup").length>0)return}this.font_selector_visible&&this.fontselector.handleEscape()&&this.closeFontSelector(),this.font_style_visible&&this.closeFontStyle()},onClick:function(){this.selected&&(this.font_selector_visible||this.font_style_visible)?this.closeAllPopups():a.a.prototype.onClick.apply(this,arguments)},onEscKey:function(){this.selected&&(this.font_selector_visible||this.font_style_visible)?this.closeAllPopups():a.a.prototype.onEscKey.apply(this,arguments)},deselect:function(){this.closeAllPopups(),a.a.prototype.deselect.apply(this,arguments)},canControlBeClosed:function(){return this.font_selector_visible||this.font_style_visible?(this.closeAllPopups(),!0):a.a.prototype.canControlBeClosed.apply(this,arguments)}}),Je=i("+uCx"),Qe=i.n(Je),ti=a.a.extend({name:"text_bius",className:"control text_bius",initialize:function(t){this.template=Qe.a["template-constructor-control-text_bius"],this.initControl(t),o.a.bindAll(this)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_bius")}))},bindLogic:function(){this.$panel.on("click",".all-caps",this.allСaps),this.$panel.on("click",".small-caps",this.smallСaps),this.$panel.on("click",".sup",this.sup),this.$panel.on("click",".sub",this.sub),this.$panel.on("click",".bold",this.bold),this.$panel.on("click",".italic",this.italic),this.$panel.on("click",".underline",this.underline),this.$panel.on("click",".strike",this.strike),this.blocks&&this.blocks[0].on("selection_styles_changed",this.selectionStylesChanged),this.blocks&&this.selectionStylesChanged(this.blocks[0].cur_selection_styles)},unBindLogic:function(){this.$panel.off("click",".all-caps",this.allСaps),this.$panel.off("click",".small-caps",this.smallСaps),this.$panel.off("click",".sup",this.sup),this.$panel.off("click",".sub",this.sub),this.$panel.off("click",".bold",this.bold),this.$panel.off("click",".italic",this.italic),this.$panel.off("click",".underline",this.underline),this.$panel.off("click",".strike",this.strike),this.blocks&&this.blocks[0].off("selection_styles_changed",this.selectionStylesChanged)},selectionStylesChanged:function(t){this.blocks[0].initiatorControl!=this.name&&this.updateState(t)},updateState:function(t){t["text-transform"]&&(this.$panel.find(".all-caps").toggleClass("curr","uppercase"==t["text-transform"]),this.$panel.find(".small-caps").toggleClass("curr","lowercase"==t["text-transform"])),t["vertical-align"]&&(this.$panel.find(".sup").toggleClass("curr","super"==t["vertical-align"]),this.$panel.find(".sub").toggleClass("curr","sub"==t["vertical-align"])),t["font-weight"]&&this.$panel.find(".bold").toggleClass("curr","700"==t["font-weight"]),t["font-style"]&&this.$panel.find(".italic").toggleClass("curr","italic"==t["font-style"]),t["text-decoration"]&&(this.$panel.find(".underline").toggleClass("curr","underline"==t["text-decoration"]),this.$panel.find(".strike").toggleClass("curr","line-through"==t["text-decoration"]))},"allСaps":function(t){var e={"text-transform":"uppercase"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-transform":"none"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},"smallСaps":function(t){var e={"text-transform":"lowercase"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-transform":"none"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},sup:function(t){var e={"vertical-align":"super"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"vertical-align":"baseline"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},sub:function(t){var e={"vertical-align":"sub"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"vertical-align":"baseline"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},bold:function(t){var e={"font-weight":"700"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"font-weight":"400"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},italic:function(t){var e={"font-style":"italic"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"font-style":"normal"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},underline:function(t){var e={"text-decoration":"underline"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-decoration":"none"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))},strike:function(t){var e={"text-decoration":"line-through"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-decoration":"none"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",e))}}),ei=i("P6JF"),ii=i.n(ei),ni=a.a.extend({name:"text_align",className:"control text_align",initialize:function(t){this.template=ii.a["template-constructor-control-text_align"],this.initControl(t)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_align")}))},bindLogic:function(){this.$panel.on("click",".left",this.left),this.$panel.on("click",".center",this.center),this.$panel.on("click",".right",this.right),this.$panel.on("click",".justify",this.justify),this.blocks&&this.blocks[0].on("selection_styles_changed",this.selectionStylesChanged),this.blocks&&this.selectionStylesChanged(this.blocks[0].cur_selection_styles)},unBindLogic:function(){this.$panel.off("click",".left",this.left),this.$panel.off("click",".center",this.center),this.$panel.off("click",".right",this.right),this.$panel.off("click",".justify",this.justify),this.blocks&&this.blocks[0].off("selection_styles_changed",this.selectionStylesChanged)},selectionStylesChanged:function(t){this.blocks[0].initiatorControl!=this.name&&this.updateState(t)},updateState:function(t){t["text-align"]&&(this.$panel.find(".left").toggleClass("curr","left"==t["text-align"]),this.$panel.find(".center").toggleClass("curr","center"==t["text-align"]),this.$panel.find(".right").toggleClass("curr","right"==t["text-align"]),this.$panel.find(".justify").toggleClass("curr","justify"==t["text-align"]),this.$icon.toggleClass("left","right"!=t["text-align"]&&"center"!=t["text-align"]&&"justify"!=t["text-align"]),this.$icon.toggleClass("right","right"==t["text-align"]),this.$icon.toggleClass("center","center"==t["text-align"]),this.$icon.toggleClass("justify","justify"==t["text-align"]))},left:function(t){var e={"text-align":"left"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-align":"inherit"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleParagraph",e))},center:function(t){var e={"text-align":"center"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-align":"inherit"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleParagraph",e))},right:function(t){var e={"text-align":"right"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-align":"inherit"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleParagraph",e))},justify:function(t){var e={"text-align":"justify"};Object(u.a)(t.currentTarget).hasClass("curr")&&(e={"text-align":"inherit"}),this.updateState(e),this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleParagraph",e))}}),oi=i("7E8S"),ai=i.n(oi),ri=a.a.extend({name:"text_autosize",className:"control text_autosize",initialize:function(t){this.template=ai.a["template-constructor-control-text_autosize"],this.initControl(t)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_autosize")}))},bindLogic:function(){o.a.each(this.models,function(t){this.listenTo(t,"change:autosize",this.updateState)}.bind(this))},unBindLogic:function(){},onClick:function(){var t=this.models[0].get("autosize");this.models[0].save("autosize",!t)},updateState:function(){var t=!!this.models[0].get("autosize");this.$el.toggleClass("autosize",t),this.$(".icon").attr("data-alt",t?"Auto-size on":"Auto-size off")},render:function(){a.a.prototype.render.apply(this,arguments),this.updateState()}}),si=i("vetb"),li=i.n(si),ci=m.a.View.extend({template:li.a["template-constructor-control-anchor_picker"],initialize:function(t){o.a.bindAll(this),o.a.extend(this,t)},render:function(){return this.setElement(Object(u.a)(this.template())),this.$picker=this.$el.find(".anchor-picker"),this.$popup=this.$el.find(".popup"),this.workspace=RM.constructorRouter.workspace,this.listenTo(this.workspace,"workspace-resize",this.setOverlayPosition),this.setOverlayPosition(),this},show:function(){this.render(),this.$el.insertAfter(this.$after),Object(u.a)(window).on("resize",this.onWindowResize)},hide:function(){this.stopFollowing(),Object(u.a)(window).off("resize",this.onWindowResize),this.remove()},startFollowing:function(){Object(u.a)(window).on("mousemove",this.onMouseMove),this.$el.on("click",this.onMouseClick),this.$el.addClass("target-mode"),this.containerInitialScroll=this.$container.scrollTop()},stopFollowing:function(){Object(u.a)(window).off("mousemove",this.onMouseMove),this.$el.off("click",this.onMouseClick),this.$el.removeClass("target-mode"),void 0!==this.containerInitialScroll&&this.$container.animate({scrollTop:this.containerInitialScroll},500)},onMouseMove:function(t){this.updateY(t.pageY+this.$container.scrollTop()-this.top),this.$popup.css("left",t.pageX)},onMouseClick:function(t){this.stopFollowing(),this.trigger("target-select",{y:Math.round(t.offsetY/RM.constructorRouter.zoom.getZoom())})},updateY:function(t){this.$picker.css("top",t)},onWindowResize:function(t){this.setOverlayPosition()},setOverlayPosition:function(){var t=this.$after.height(),e=parseInt(this.$after.css("top"),10),i=parseInt(this.$after.css("border-top-width"),10);this.top=e+i,this.$el.height(t*RM.constructorRouter.zoom.getZoom()),this.$el.css("top",this.top)}}),di=i("HxOx"),hi=i.n(di),ui=a.a.extend({name:"text_link",className:"control text_link",urlRegexp:/^http(s?)\:\/\//i,shortUrlRegexp:/^[\da-z\.-]+\.[a-z-]{2,}.*/i,telRegexp:/\+(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/i,backRegexp:/^(back|scroll)\sto\stop$/i,backLink:"Back to Top",backDisplayName:"Scroll to Top",gobackRegexp:/^(__rm_goback|go\sback)$/i,gobackLink:"__rm_goback",gobackDisplayName:"Go Back",mailchimpRegexp:/^(__rm_mailchimp_.*|<script.*mailchimp\.com.*\{.*baseUrl.*uuid.*lid.*\}.*)$/i,mailchimpMatcher:/start\((\{.*\})\).*\}\)/i,mailchimpLink:"__rm_mailchimp_",mailchimpDisplayName:"Mailchimp Popup",anchorRegexp:/^(__rm_anchor|\d+px)$/i,anchorMatcher:/^(\d+)px$/i,anchorLink:"__rm_anchor",shareRegexp:/^share\.(facebook|twitter|pinterest|gplus|linkedin|email)\.(mag|page)$/i,NEW_DEFAULT_STYLE:{color:"0078ff",opacity:100,"u-style":"solid","u-color":"0078ff","u-opacity":100,"u-size":1,"u-offset":0,"hover-color":"inherit","hover-opacity":"inherit","hover-u-style":"none","hover-u-color":"inherit","hover-u-opacity":"inherit","hover-u-size":"inherit","hover-u-offset":"inherit","current-color":"inherit","current-opacity":"inherit","current-u-style":"none","current-u-color":"inherit","current-u-opacity":"inherit","current-u-size":"inherit","current-u-offset":"inherit"},saveOnDestroy:!0,initialize:function(t){this.template=hi.a["template-constructor-control-text_link"],this.style_template=hi.a["template-constructor-control-text_link-style"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.refreshEditorCssDebounced=o.a.debounce(this.refreshEditorCss,100)},bindLogic:function(){this.bindLogicCommon(),this.bindLogicSpecific()},bindLogicCommon:function(){this.$input=this.$panel.find(".search-wrapper input"),this.$action_icon=this.$panel.find(".search-wrapper .action-icon"),this.$placeholder=this.$panel.find(".search-wrapper .placeholder"),this.$placeholder_icon=this.$panel.find(".search-wrapper .placeholder-selector"),this.$target_input=this.$panel.find(".target-wrapper input"),this.$target_wrapper=this.$panel.find(".target-wrapper"),this.$search_wrapper=this.$panel.find(".search-wrapper"),this.$target_icon=this.$panel.find(".target-icon"),this.$input.on("input",this.onInputChange),this.$input.on("keyup",this.onInputKey),this.$action_icon.on("click",this.inputIconClick),this.$target_input.on("change",this.onTargetInputChange),this.$target_icon.on("click",this.anchorOnTargetClick),this.$panel.on("click",".placeholder-selector",this.togglePlaceholderPopup),this.$panel.on("click",".placeholder-selector .placeholder-item",this.clickPlaceholder),this.$panel.on("click",this.closePlaceholderPopup)},bindLogicSpecific:function(){this.resizableScroll=this.$el.find(".resizable-scroll-wrapper").RMScroll({$container:this.$el.find(".resizable-content-wrapper"),$content:this.$el.find(".resizable-content"),$handle:this.$el.find(".resizable-scroll"),wheelScrollSpeed:.4,gap_start:8,gap_end:8,onScroll:this.onPanelScroll.bind(this)}).data("scroll"),Object(u.a)(window).on("resize",this.repositionPanel),this.textStyles=RM.constructorRouter.textStyles,this.textStyles.on("change:link_styles",this.onStylesChange),this.$panel.on("click",".add-block .add",this.addClick),this.$panel.on("click",".link-style",this.onLinkStyleClick),this.$panel.on("click",".link-style .menu-button",this.toggleMenu),this.$panel.on("click",".style-menu .edit-button",this.onEditClick),this.$panel.on("dblclick",".link-style .style-caption",this.onEditClick),this.$panel.on("click",".style-menu .duplicate-button",this.onDuplicateClick),this.$panel.on("click",".style-menu .delete-button",this.onDeleteClick),this.$panel.find(".styles-wrapper").sortable({distance:10,axis:"y",scrollSpeed:20,containment:"parent",tolerance:"pointer",start:o.a.bind((function(t,e){this.closeMenu(!1)}),this),stop:o.a.bind((function(t,e){this.reorder()}),this)}),this.renderLinkStyles(),this.block&&this.block.on("selection_styles_changed",this.selectionStylesChanged),this.block&&this.selectionStylesChanged(this.block.cur_selection_styles),this.$panel.on("click",".add-block .save",this.saveEditClick),this.$panel.on("click",".add-block .cancel",this.cancelEditClick),this.$panel.on("click",".edit-wrapper .state-switcher-wrapper .state-switcher",this.onStateSwitchClick),this.$panel.on("input",'.edit-wrapper .edit-item[data-field="_caption"] input',this.onEditCaptionChange),this.$panel.on("click",".edit-wrapper .color-click-area",this.onColorboxShowClick),this.$panel.on("click",".edit-wrapper .underline-style-click-area",this.onUnderlineStyleShowClick),this.$panel.on("click",".underline_style_container .underline-style-item",this.underlineStyleChanged),this.$panel.on("click",".edit-wrapper",this.closeAllEditPopups),this.colorbox=new Ve.a({$parent:this.$(".colorbox_container"),type:"small"}),this.colorbox.on("colorchange",this.colorOpacityChanged),this.colorbox.on("opacitychange",this.colorOpacityChanged),this.editUnderlineWidthChangeValue=this.$panel.find('.edit-wrapper .edit-item[data-field="u-size"] input').RMNumericInput({min:1,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editPaddingChangeValue=this.$panel.find('.edit-wrapper .edit-item[data-field="u-offset"] input').RMNumericInput({min:-99,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editHoverUnderlineWidthChangeValue=this.$panel.find('.edit-wrapper .edit-item[data-field="hover-u-size"] input').RMNumericInput({min:1,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editHoverPaddingChangeValue=this.$panel.find('.edit-wrapper .edit-item[data-field="hover-u-offset"] input').RMNumericInput({min:-99,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editCurrentUnderlineWidthChangeValue=this.$panel.find('.edit-wrapper .edit-item[data-field="current-u-size"] input').RMNumericInput({min:1,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.editCurrentPaddingChangeValue=this.$panel.find('.edit-wrapper .edit-item[data-field="current-u-offset"] input').RMNumericInput({min:-99,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue")},unBindLogic:function(){this.unBindLogicCommon(),this.unBindLogicSpecific()},unBindLogicCommon:function(){this.$input.off("input",this.onInputChange),this.$input.off("keyup",this.onInputKey),this.$action_icon.off("click",this.inputIconClick),this.$target_input.off("change",this.onTargetInputChange),this.$panel.off("click",".placeholder-selector",this.togglePlaceholderPopup),this.$panel.off("click",".placeholder-selector .placeholder-item",this.clickPlaceholder),this.$panel.off("click",this.closePlaceholderPopup)},unBindLogicSpecific:function(){Object(u.a)(window).off("resize",this.repositionPanel),this.block&&this.block.off(null,null,this),this.textStyles.off("change:link_styles",this.onStylesChange),this.$panel.off("click",".add-block .add",this.addClick),this.$panel.off("click",".link-style",this.onLinkStyleClick),this.$panel.off("click",".link-style .menu-button",this.toggleMenu),this.$panel.off("click",".style-menu .edit-button",this.onEditClick),this.$panel.off("click",".style-menu .duplicate-button",this.onDuplicateClick),this.$panel.off("click",".style-menu .delete-button",this.onDeleteClick),this.$panel.off("click",".add-block .save",this.saveEditClick),this.$panel.off("click",".add-block .cancel",this.cancelEditClick),this.$panel.off("click",".edit-wrapper .state-switcher-wrapper .state-switcher",this.onStateSwitchClick),this.$panel.off("input",'.edit-wrapper .edit-item[data-field="_caption"] input',this.onEditCaptionChange),this.$panel.off("click",".edit-wrapper .color-click-area",this.onColorboxShowClick),this.$panel.off("click",".edit-wrapper .underline-style-click-area",this.onUnderlineStyleShowClick),this.$panel.off("click",".edit-wrapper",this.closeAllEditPopups),this.colorbox&&this.colorbox.off("colorchange",this.colorOpacityChanged),this.colorbox&&this.colorbox.off("opacitychange",this.colorOpacityChanged),this.colorbox&&this.colorbox.destroy(),this.colorbox=null,this.block&&this.block.off("selection_styles_changed",this.selectionStylesChanged)},repositionPanel:function(){this.$panel.css("margin-top","");var t=this.$panel.height(),e=this.$panel.offset().top,i=Math.max(Object(u.a)(window).height(),324)-10;t+e>i&&this.$panel.css("margin-top",i-t-e)},toggleCurrentStateSwitch:function(t){var e=this.hasCurrentState(t);this.isInState("current")&&!e&&this.switchState("default"),this.$panel.find(".state-switcher.caption-current").toggle(e)},canHaveCurrentState:function(){var t=this.model.get("is_global"),e=this.block.workspace,i=e&&e.block&&e.block.model&&e.block.model.get("is_global");return Boolean(t||i)},hasCurrentState:function(t){return Boolean(this.canHaveCurrentState()&&t)},initCurrentStyle:function(){var t=function(t){return o.a.pick(t,(function(t,e){return/^current/.test(e)}))},e=t(this.currentEditStyle),i=t(this.NEW_DEFAULT_STYLE);this.canHaveCurrentState()&&o.a.values(e).length<o.a.values(i).length&&o.a.extend(this.currentEditStyle,i,e)},togglePlaceholderPopup:function(t){t&&Object(u.a)(t.target).closest(".placeholder-selector .placeholder-popup").length>0||(this.placeholder_popup_visible?this.closePlaceholderPopup():(this.anchorExitTargetMode(),this.placeholder_popup_visible=!0,this.$(".placeholder-selector").addClass("opened")))},closePlaceholderPopup:function(t){t&&Object(u.a)(t.target).closest(".placeholder-selector").length>0||(this.placeholder_popup_visible=!1,this.$(".placeholder-selector").removeClass("opened"))},clickPlaceholder:function(t){var e=Object(u.a)(t.currentTarget).attr("data-type");this.setPlaceholder(e),"back"==e&&(this.$input.val(this.backDisplayName),this.onInputChange(),this.applyLink()),"goback"==e&&(this.$input.val(this.gobackDisplayName),this.onInputChange(),this.applyLink()),"anchor"==e?(this.anchorEnterMode(),this.$input.val()||this.anchorEnterTargetMode()):this.anchorExitMode(),this.focusInputField()},setPlaceholder:function(t){var e=this.$panel.find('.search-wrapper .placeholder-selector .placeholder-item[data-type="'+t+'"]');this.$placeholder.text(this.$placeholder.attr("data-"+(t||"initial"))),this.closePlaceholderPopup(),this.$panel.find(".search-wrapper .placeholder-selector .placeholder-item").removeClass("active"),e.addClass("active")},anchorEnterMode:function(t){this.isAnchorMode||(this.$search_wrapper.addClass("anchor-mode"),this.anchorPicker=new ci({$container:Object(u.a)("#main"),$after:Object(u.a)(".workspace:visible")}),this.anchorPicker.show()),t&&this.anchorPicker.updateY(t),this.isAnchorMode=!0},anchorExitMode:function(){this.isAnchorMode&&(this.$search_wrapper.removeClass("anchor-mode"),this.anchorPicker&&(this.anchorPicker.hide(),this.anchorPicker=null),this.isAnchorMode=!1)},anchorOnTargetClick:function(){this.$target_icon.hasClass("active")?this.anchorExitTargetMode():this.anchorEnterTargetMode()},anchorEnterTargetMode:function(){this.$target_icon.addClass("active"),this.anchorPicker.startFollowing(),this.listenToOnce(this.anchorPicker,"target-select",this.anchorOnTargetSelect),this.isAnchorTargetMode=!0},anchorExitTargetMode:function(){o.a.defer(function(){this.isAnchorTargetMode=!1}.bind(this)),this.anchorPicker&&(this.$target_icon.removeClass("active"),this.anchorPicker.stopFollowing())},anchorOnTargetSelect:function(t){var e=t.y;this.anchorExitTargetMode(),this.$input.val(e+"px"),this.applyLink()},onStylesChange:function(t,e,i){(i=i||{}).socketUpdate&&this.renderLinkStyles()},renderLinkStyles:function(){var t=this.textStyles.getStylesListSorted("link"),e="";o.a.each(t,(function(t){e+=this.style_template(t)}),this),this.$panel.find(".styles-wrapper").html(e),this.resizableScroll&&this.resizableScroll.recalc(),this.$panel.find(".styles-wrapper").sortable("refresh")},reorder:function(){var t=[];this.$(".link-style").each((function(){t.push(Object(u.a)(this).attr("data-id"))})),this.textStyles.reorder("link",t)},selectionStylesChanged:function(t){this.updateState(t)},onTargetInputChange:function(){var t=this.$target_input.prop("checked");this.block&&this.block.trigger("changeLink",{action:"change-target",target:t?"_blank":null})},updateState:function(t){var e,i=t&&t.link_nodes,n=!(!i||!i.length);if(this.$panel.toggleClass("collapsed",!n),this.anchorExitMode(),setTimeout(this.repositionPanel,400),this.closeMenu(!1),this.placeholder_popup_visible&&this.closePlaceholderPopup(),n){var a=[],r=[],s=[];if(o.a.each(i,(function(t){a.push(Object(u.a)(t).attr("data-uuid")),s.push(Object(u.a)(t).attr("target")),r.push(t.className)})),a=o.a.uniq(a),r=o.a.uniq(r),s=o.a.uniq(s),this.$target_wrapper.addClass("disabled"),a.length>1)this.$input.val(""),this.setPlaceholder("multiple");else{var l=Object(u.a)(i[0]);if(e=l.attr("data-pid")){this.setPlaceholder("page");var c=RM.constructorRouter.mag.getPageUri(e);c?this.$input.val(c):(this.$input.val(""),this.setPlaceholder("no-page"))}else{var d=l.attr("href");if(/^mailto\:/i.test(d))this.setPlaceholder("email");else if(/^tel\:/i.test(d))this.setPlaceholder("phone");else if(this.backRegexp.test(d))this.setPlaceholder("back"),d=this.backDisplayName;else if(this.gobackRegexp.test(d))this.setPlaceholder("goback"),d=this.gobackDisplayName;else if(this.mailchimpRegexp.test(d))this.setPlaceholder("mailchimp"),d=this.mailchimpDisplayName;else if(this.anchorRegexp.test(d)){this.setPlaceholder("anchor");var h=parseInt(l.attr("data-anchor-link-pos"),10)||0;d=h+"px",this.anchorEnterMode(h)}else this.setPlaceholder("url"),this.$target_wrapper.removeClass("disabled");this.$input.val(d.replace(/^mailto\:/i,"").replace(/^tel\:/i,""))}}this.onInputChange(),this.$action_icon.addClass("remove-icon"),this.$action_icon.removeClass("hidden"),this.$placeholder_icon.addClass("hidden"),this.$target_input.prop("checked",1==s.length&&"_blank"==s[0]),this.$target_input.prop("indeterminate",s.length>1),this.showActiveStyles(r)}else this.$input.val(""),this.onInputChange(),this.setPlaceholder("initial");this.toggleCurrentStateSwitch(e),this.$icon.toggleClass("highlighted",!(!i||!i.length))},onInputChange:function(){this.$action_icon.toggleClass("hidden",!this.getUrlData(this.$input.val()).result),this.$action_icon.removeClass("remove-icon"),this.$placeholder_icon.toggleClass("hidden",""!=this.$input.val())},getUrlData:function(t){var e=RM.constructorRouter.mag,i=RM.constructorRouter.me;t=u.a.trim(t);var n=this.urlRegexp.test(t),o=new RegExp("/(edit|"+i.get("uri")+")/(\\d+|"+e.get("uri")+")/(preview/)?(.*)","i"),a=t.match(o);!a||e.get("uri")!=a[2]&&e.get("num_id")!=a[2]||(t=(a[4]||"1").replace("/",""));var r=""!=t&&!!e.getPageId(t);t=t.replace(/^mailto\:/i,"");var s=_.default.isValidEmailLink(t);t=t.replace(/^tel\:/i,"");var l=this.telRegexp.test(t),c=this.backRegexp.test(t),d=this.gobackRegexp.test(t),h=this.mailchimpRegexp.test(t),p=this.anchorRegexp.test(t),m=this.shareRegexp.test(t);return n||r||s||l||h||m||(n=this.shortUrlRegexp.test(t))&&(t="http://"+t),h&&(t=this.mailchimpLink+this.getMailchimpData(t)),p&&(t=t.match(this.anchorMatcher)[1]),{result:n||r||s||l||c||d||h||p||m,isURL:n,isEmail:s,isTel:l,isValidPageNumber:r,isBack:c,isGoBack:d,isMailchimp:h,isAnchor:p,isShare:m,url:t}},getMailchimpData:function(t){var e,i=t.match(this.mailchimpMatcher);try{e=i&&i[1]&&!!JSON.parse(i[1])}catch(t){e=!1}return e?i[1]:""},inputIconClick:function(t){this.$action_icon.hasClass("remove-icon")?(this.removeLink(),this.anchorExitMode()):this.applyLink()},onInputKey:function(t){var e=this.block&&this.block.cur_selection_styles&&this.block.cur_selection_styles.link_nodes;t.keyCode==u.a.keycodes.enter&&this.applyLink(),t.keyCode==u.a.keycodes.del&&""==this.$input.val()&&e&&e.length&&this.removeLink()},applyLink:function(){var t,e,i=this.$input.val(),n=this.getUrlData(i);if(n.result){n.isEmail&&(n.url="mailto:"+n.url),n.isTel&&(n.url="tel:"+n.url),n.isBack&&(n.url=this.backLink),n.isGoBack&&(n.url=this.gobackLink),n.isAnchor&&(t=n.url,n.url=this.anchorLink);var a=this.block&&this.block.cur_selection_styles&&this.block.cur_selection_styles.link_nodes,r="link-1",s=n.isURL?"_blank":null;a.length&&(r=a[0].className,r=/^link\-/.test(r)?r:null,n.isURL&&(s="_blank"==(s=Object(u.a)(a[0]).attr("target"))?s:null)),this.block&&(e={action:"create",url:n.url,class:r,target:s},t&&o.a.extend(e,{anchor_pos:t,clickPage:this.blocks[0].workspace.page.id}),this.block.trigger("changeLink",e))}},removeLink:function(){this.block&&this.block.trigger("changeLink",{action:"remove"})},focusInputField:function(){this.$panel.find(".search-wrapper input").focus()},showActiveStyles:function(t){if(this.selected&&t){var e={},i={};this.$(".link-style.active").each((function(){e[Object(u.a)(this).attr("data-id")]=!0})),this.closeMenu(!0),this.$(".link-style").removeClass("active");for(var n=0;n<t.length;n++)this.$('.link-style[data-id="'+t[n]+'"]').addClass("active");if(this.$(".link-style.active").each((function(){i[Object(u.a)(this).attr("data-id")]=!0})),!o.a.isEqual(e,i)){var a=this.$(".link-style.active").first();if(a.length){var r,s=this.$panel.find(".resizable-content-wrapper"),l=a.position().top,c=s.height(),d=a.outerHeight();l+d-s.scrollTop()>c-0?r=l+d-c+0:l-s.scrollTop()<0&&(r=l-0),null!=r&&s.stop().animate({scrollTop:r},200)}}}},onLinkStyleClick:function(t){if(!Object(u.a)(t.target).closest(".menu-button").length){var e=Object(u.a)(t.target).closest(".link-style").attr("data-id");this.block&&this.block.trigger("changeLink",{action:"change-class",class:e})}},toggleMenu:function(t){var e=Object(u.a)(t.currentTarget),i=e.hasClass("active"),n=this.$(".style-menu");i?this.closeMenu(!0):(this.$(".link-style .menu-button.active").length>0&&this.closeMenu(!1),setTimeout(o.a.bind((function(){var t=e.closest(".link-style"),i=this.$(".resizable-scroll-wrapper").position().top+t.position().top+e.position().top-this.$panel.find(".resizable-content-wrapper").scrollTop(),o=e.height(),a=i+7,r=Math.max(Object(u.a)(window).height(),304)-10;n.css("top",a).addClass("shown").addClass("shift-bottom").removeClass("shift-left").attr("data-id",t.attr("data-id"));var s=n.offset().top+n.height();if(s+8>r){var l=s-r,c=o/2+7,d=c+n.height()-o;l=Math.min(Math.max(l,c+4),d-8);n.css("top",a-l).addClass("shift-left").removeClass("shift-bottom").find(".corner-wrapper").css("top",l-c+4),e.addClass("shift-left")}else e.removeClass("shift-left");e.addClass("active")}),this),40))},closeMenu:function(t){var e=this.$(".style-menu");t||e.removeClass("transition-enable"),e.removeClass("shown"),t||setTimeout((function(){e.addClass("transition-enable")}),20),this.$(".link-style .menu-button").removeClass("active")},onPanelScroll:function(t){this.closeMenu(!0)},onDuplicateClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu").attr("data-id"),i=this.textStyles.duplicateStyle("link",e),n=this.$('.link-style[data-id="'+e+'"]');if(i){RM.constructorRouter.textStyles.generateCSS("link","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("link","constructor",document),this.block.somethingChangedInEditor("styleAdded");var a=Object(u.a)(this.style_template(i));a.addClass("enable-transition").css("margin-top",-n.outerHeight()),a.insertAfter(n),setTimeout(o.a.bind((function(){a.css("margin-top",0),setTimeout(o.a.bind((function(){a.removeClass("enable-transition"),this.$panel.find(".styles-wrapper").sortable("refresh"),this.resizableScroll&&this.resizableScroll.recalc()}),this),270)}),this),50)}},onDeleteClick:function(t){var e=Object(u.a)(t.currentTarget).closest(".style-menu").attr("data-id"),i=this.$('.link-style[data-id="'+e+'"]');this.closeMenu(!0),i.addClass("enable-transition"),setTimeout(o.a.bind((function(){i.addClass("shift-left"),setTimeout(o.a.bind((function(){i.css("margin-top",-i.outerHeight()),setTimeout(o.a.bind((function(){i.remove(),this.$panel.find(".styles-wrapper").sortable("refresh"),this.resizableScroll&&this.resizableScroll.recalc(),RM.constructorRouter.textStyles.deleteStyle("link",e),RM.constructorRouter.textStyles.generateCSS("link","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("link","constructor",document),this.block.somethingChangedInEditor("styleDeleted")}),this),270)}),this),270)}),this),50)},addClick:function(t){var e=this.textStyles.addStyle("link",this.NEW_DEFAULT_STYLE);RM.constructorRouter.textStyles.generateCSS("link","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("link","constructor",document),this.block.somethingChangedInEditor("styleAdded");var i=Object(u.a)(this.style_template(e));i.addClass("enable-transition").addClass("collapsed"),this.$panel.find(".styles-wrapper").append(i),this.$el.find(".resizable-content-wrapper").scrollTop(9999),setTimeout(o.a.bind((function(){i.removeClass("collapsed"),setTimeout(o.a.bind((function(){i.removeClass("enable-transition"),this.$panel.find(".styles-wrapper").sortable("refresh"),this.resizableScroll&&this.resizableScroll.recalc()}),this),270)}),this),50)},refreshEditorCss:function(){var t=("hover"===this.currentStyleEditMode||"current"===this.currentStyleEditMode)&&this.currentStyleEditMode,e={forcePseudoState:t,forcePseudoClass:!!t&&this.getEditValue("_name")};RM.constructorRouter.textStyles.generateCSS("link","editor",this.block.iframe_document,e),this.block.somethingChangedInEditor("styleChanging")},onEditClick:function(t){var e={dblclick:function(t){return Object(u.a)(t.currentTarget).closest(".link-style")},click:function(){return Object(u.a)(t.currentTarget).closest(".style-menu")}}[t.type](t),i=Object(u.a)(t.currentTarget).closest(e).attr("data-id"),n=this.textStyles.findStyle("link",i);this.originalEditStyle=o.a.clone(n),this.currentEditStyle=n,this.initCurrentStyle(),this.setEditParams(),this.switchState("default"),this.$panel.addClass("toggle-opaque"),this.closeMenu(!0),setTimeout(o.a.bind((function(){this.$panel.addClass("show-style-edit")}),this),300)},editClose:function(){this.closeAllEditPopups(),RM.constructorRouter.textStyles.generateCSS("link","editor",this.block.iframe_document),RM.constructorRouter.textStyles.generateCSS("link","constructor",document),this.resizableScroll&&this.resizableScroll.recalc(),this.block.somethingChangedInEditor("styleChanged"),this.$panel.removeClass("show-style-edit"),setTimeout(o.a.bind((function(){this.$panel.removeClass("toggle-opaque")}),this),400)},isInState:function(t){return this.$panel.find(".edit-wrapper").hasClass(t+"-state")},onStateSwitchClick:function(t){this.colorbox_visible||this.underline_style_visible||(Object(u.a)(t.currentTarget).hasClass("caption-default")&&this.switchState("default"),Object(u.a)(t.currentTarget).hasClass("caption-hover")&&this.switchState("hover"),Object(u.a)(t.currentTarget).hasClass("caption-current")&&this.switchState("current"))},switchState:function(t){var e=this.$panel.find(".edit-wrapper");e.removeClass("hover-state default-state current-state"),e.addClass(t+"-state"),"hover"!==t&&"current"!==t||this.setEditParams(),this.currentStyleEditMode=t,this.refreshEditorCssDebounced()},getEditValue:function(t){if(this.currentEditStyle){var e=o.a.isUndefined(this.currentEditStyle[t])&&/^current/.test(t)?this.NEW_DEFAULT_STYLE[t]:this.currentEditStyle[t];return"inherit"==e&&(e=this.currentEditStyle[t.replace(/^(hover|current)\-/,"")]),e}},setEditParams:function(){var t=this.$panel.find(".edit-wrapper");t.find('.edit-item[data-field="_caption"] input').val(this.getEditValue("_caption")),t.find('.edit-item[data-field="u-style"] .underline-style').attr("data-type",this.getEditValue("u-style")),t.find('.edit-item[data-field="hover-u-style"] .underline-style').attr("data-type",this.getEditValue("hover-u-style")),t.find('.edit-item[data-field="current-u-style"] .underline-style').attr("data-type",this.getEditValue("current-u-style")),t.find('.edit-item[data-field="color"] .color-circle').css({background:"#"+this.getEditValue("color"),opacity:this.getEditValue("opacity")/100}),t.find('.edit-item[data-field="u-color"] .color-circle').css({background:"#"+this.getEditValue("u-color"),opacity:this.getEditValue("u-opacity")/100}),t.find('.edit-item[data-field="hover-color"] .color-circle').css({background:"#"+this.getEditValue("hover-color"),opacity:this.getEditValue("hover-opacity")/100}),t.find('.edit-item[data-field="current-color"] .color-circle').css({background:"#"+this.getEditValue("current-color"),opacity:this.getEditValue("current-opacity")/100}),t.find('.edit-item[data-field="hover-u-color"] .color-circle').css({background:"#"+this.getEditValue("hover-u-color"),opacity:this.getEditValue("hover-u-opacity")/100}),t.find('.edit-item[data-field="current-u-color"] .color-circle').css({background:"#"+this.getEditValue("current-u-color"),opacity:this.getEditValue("current-u-opacity")/100}),this.editUnderlineWidthChangeValue(this.getEditValue("u-size"),!0),this.editPaddingChangeValue(this.getEditValue("u-offset"),!0),this.editHoverUnderlineWidthChangeValue(this.getEditValue("hover-u-size"),!0),this.editHoverPaddingChangeValue(this.getEditValue("hover-u-offset"),!0),this.editCurrentUnderlineWidthChangeValue(this.getEditValue("current-u-size"),!0),this.editCurrentPaddingChangeValue(this.getEditValue("current-u-offset"),!0),this.fixInputsPadding(),this.checkNoUnderline()},fixInputsPadding:function(){for(var t=["u-size","u-offset","hover-u-size","hover-u-offset","current-u-size","current-u-offset"],e=0;e<t.length;e++){var i=this.$panel.find('.edit-wrapper .edit-item[data-field="'+t[e]+'"] input');i.toggleClass("padding-for-one",Math.abs(i.val())%10==1)}},onEditCaptionChange:function(t){this.currentEditStyle._caption=Object(u.a)(t.target).val()},onEditInputChanged:function(t,e){this.currentEditStyle[t.closest(".edit-item").attr("data-field")]=e,this.fixInputsPadding(),this.refreshEditorCssDebounced()},onColorboxShowClick:function(t){var e=Object(u.a)(t.currentTarget),i=e.attr("data-field"),n=e.attr("data-field-dop"),o=200;if(this.colorbox_visible){if(i==this.colorbox_for_field)return void this.closeColorBox();this.closeColorBox(!0),o=0}this.closeAllEditPopups(),this.colorbox_visible=!0,this.$(".colorbox_container").fadeIn(o),this.colorbox_for_field=i,this.colorbox_for_field_dop=n,this.synchonizeColors="color"==i&&this.getEditValue("color")==this.getEditValue("u-color")&&this.getEditValue("opacity")==this.getEditValue("u-opacity"),this.colorbox.setOpacity(this.getEditValue(n)/100),this.colorbox.setColor(this.getEditValue(i))},colorOpacityChanged:function(t,e,i,n){this.currentEditStyle[this.colorbox_for_field]=this.colorbox&&this.colorbox.rgb2hex([t,e,i]),this.currentEditStyle[this.colorbox_for_field_dop]=100*n,this.synchonizeColors&&(this.currentEditStyle["u-color"]=this.colorbox&&this.colorbox.rgb2hex([t,e,i]),this.currentEditStyle["u-opacity"]=100*n),this.setEditParams(),this.refreshEditorCssDebounced()},onUnderlineStyleShowClick:function(t){if(this.underline_style_visible)this.closeUnderlineStyle();else{this.closeAllEditPopups(),this.underline_style_visible=!0,this.$(".underline_style_container").fadeIn(200);var e=Object(u.a)(t.currentTarget).attr("data-field");this.underline_style_for_field=e,this.$('.underline_style_container .underline-style-item[data-type="'+this.getEditValue(e)+'"]').addClass("active").siblings(".underline-style-item").removeClass("active")}},underlineStyleChanged:function(t){this.currentEditStyle[this.underline_style_for_field]=Object(u.a)(t.currentTarget).attr("data-type"),this.setEditParams(),this.checkNoUnderline(),this.refreshEditorCssDebounced(),this.closeUnderlineStyle()},checkNoUnderline:function(){for(var t=["u-style","hover-u-style","current-u-style"],e=0;e<t.length;e++){var i=this.getEditValue(t[e]);this.$panel.find('.edit-wrapper .edit-item[data-field="'+t[e]+'"]').closest(".params-block").toggleClass("no-underline","none"==i)}},closeColorBox:function(t){this.colorbox_visible=!1,this.$(".colorbox_container").fadeOut(t?0:200)},closeUnderlineStyle:function(){this.underline_style_visible=!1,this.$(".underline_style_container").fadeOut(200)},closeAllEditPopups:function(t){if(t){if(Object(u.a)(t.target).closest(".colorbox_container").length>0)return;if(Object(u.a)(t.target).closest(".color-click-area").length>0)return;if(Object(u.a)(t.target).closest(".underline_style_container").length>0)return;if(Object(u.a)(t.target).closest(".underline-style-click-area").length>0)return}this.colorbox_visible&&this.closeColorBox(),this.underline_style_visible&&this.closeUnderlineStyle()},saveEditClick:function(){this.$('.link-style[data-id="'+this.getEditValue("_name")+'"]').find(".style-caption").text(this.getEditValue("_caption")),this.textStyles.changeStyle("link",this.getEditValue("_name")),this.editClose()},cancelEditClick:function(){this.textStyles.restoreStyle("link",this.getEditValue("_name"),this.originalEditStyle),this.editClose()},save:function(){o.a.isEqual(this.textStyles.getOrder("link"),this.textStyles.orderBefore.link)||this.textStyles.save()},deselect:function(){this.closeAllEditPopups(),this.placeholder_popup_visible&&this.closePlaceholderPopup(),this.anchorExitMode(),a.a.prototype.deselect.apply(this,arguments)},destroy:function(){this.$panel.hasClass("show-style-edit")&&this.saveEditClick(),this.anchorExitMode(),this.save(),a.a.prototype.destroy.apply(this,arguments)},select:function(){a.a.prototype.select.apply(this,arguments),this.block&&this.selectionStylesChanged(this.block.cur_selection_styles),this.resizableScroll&&this.resizableScroll.recalc(),this.repositionPanel(),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_link")}))},onClick:function(){if(this.selected){if(this.colorbox_visible||this.underline_style_visible)return void this.closeAllEditPopups();if(this.$(".style-menu").hasClass("shown"))return void this.closeMenu(!0);if(this.placeholder_popup_visible)return void this.closePlaceholderPopup()}a.a.prototype.onClick.apply(this,arguments)},onEscKey:function(){if(this.selected){if(this.colorbox_visible||this.underline_style_visible)return void this.closeAllEditPopups();if(this.$(".style-menu").hasClass("shown"))return void this.closeMenu(!0);if(this.placeholder_popup_visible)return void this.closePlaceholderPopup();if(this.isAnchorTargetMode)return void this.anchorExitTargetMode()}a.a.prototype.onEscKey.apply(this,arguments)},canControlBeClosed:function(){return this.colorbox_visible||this.underline_style_visible?(this.closeAllEditPopups(),!0):this.$(".style-menu").hasClass("shown")?(this.closeMenu(!0),!0):this.placeholder_popup_visible?(this.closePlaceholderPopup(),!0):!!this.isAnchorTargetMode||a.a.prototype.canControlBeClosed.apply(this,arguments)}}),pi=i("s1Hx"),mi=i.n(pi),gi=a.a.extend({name:"text_color",className:"control text_color",initialize:function(t){this.template=mi.a["template-constructor-control-text_color"],this.initControl(t)},bindLogic:function(){this.colorbox=new Ve.a({$parent:this.$panel,type:"small"}),this.colorbox.on("colorchange",this.colorChanged),this.colorbox.on("opacitychange",this.colorChanged),this.blocks&&this.blocks[0].on("selection_styles_changed",this.selectionStylesChanged),this.blocks&&this.selectionStylesChanged(this.blocks[0].cur_selection_styles)},unBindLogic:function(){this.colorbox&&this.colorbox.off("colorchange",this.colorChanged),this.colorbox&&this.colorbox.off("opacitychange",this.colorChanged),this.colorbox&&this.colorbox.destroy(),this.blocks&&this.blocks[0].off("selection_styles_changed",this.selectionStylesChanged)},selectionStylesChanged:function(t){if(this.blocks&&this.blocks[0].initiatorControl!=this.name){var e=t.color,i=t.opacity;if(e==this.blocks[0].params.multipleName){if(!(this.blocks[0].cur_selection_styles_all.length>0))return;e=this.blocks[0].cur_selection_styles_all[0].color}if(i==this.blocks[0].params.multipleName){if(!(this.blocks[0].cur_selection_styles_all.length>0))return;i=this.blocks[0].cur_selection_styles_all[0].opacity}this.updateIconState(e,i/100),this.updateColorboxState(e,i/100)}},updateIconState:function(t,e){t&&e&&this.$icon&&this.$icon.find(".color-circle").css({background:"#"+t,opacity:e})},updateColorboxState:function(t,e){t&&null!=e&&this.colorbox&&(this.colorbox.setOpacity(e),this.colorbox.setColor(t))},colorChanged:function(t,e,i,n){var o="";o=n>.99?"rgb("+t+","+e+","+i+")":"rgba("+t+","+e+","+i+", "+n+")";var a=this.colorbox&&this.colorbox.rgb2hex([t,e,i]);this.blocks&&(this.blocks[0].initiatorControl=this.name,this.blocks[0].trigger("changeStyleSpan",{color:o},{color:a,opacity:100*n})),this.updateIconState(a,n)}}),fi=i("DA8H"),vi=i.n(fi),bi=a.a.extend({name:"text_columns",className:"control text_columns",MAX_COLUMN_COUNT:12,initialize:function(t){this.template=vi.a["template-constructor-control-text_columns"],this.initControl(t)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_columns")}))},bindLogic:function(){this.$panel.on("click",".substract",this.substract),this.$panel.on("click",".add",this.add),this.$panel.on("click",".bg-color",this.toggleColorbox),this.$panel.on("click",this.closeColorBox),Object(u.a)(this.$(this.$panel.find(".gap"))).RMNumericInput({min:0,max:999,mouseDir:"h",mouseSpeed:1,onChange:this.onGapChanged}),this.colorbox=new Ve.a({$parent:this.$(".colorbox_container"),type:"small"}),this.colorbox.on("colorchange",this.colorChanged),this.colorbox.on("opacitychange",this.opacityChanged),this.blocks&&this.updateState({column_count:this.blocks[0].model.get("column_count"),column_gap:this.blocks[0].model.get("column_gap"),bg_color:this.blocks[0].model.get("bg_color"),bg_opacity:this.blocks[0].model.get("bg_opacity")})},unBindLogic:function(){this.$panel.off("click",".substract",this.substract),this.$panel.off("click",".add",this.add),this.$panel.off("click",".bg-color",this.toggleColorbox),this.$panel.off("click",this.closeColorBox),this.colorbox&&this.colorbox.off("colorchange",this.colorChanged),this.colorbox&&this.colorbox.off("opacitychange",this.opacityChanged),this.colorbox&&this.colorbox.destroy()},updateState:function(t){null!=t.column_count&&(this.$panel.find(".number").text(t.column_count),this.$panel.toggleClass("one-column",1==t.column_count),t.column_count>1?this.$panel.find(".gap, .grid").css("display","block"):setTimeout(o.a.bind((function(){this.$panel.find(".gap, .grid").css("display","none")}),this),500)),null!=t.column_gap&&this.$panel.find(".gap").val(t.column_gap),null!=t.bg_color&&null!=t.bg_opacity&&this.$(".bg-color .color").css({"background-color":"#"+t.bg_color,opacity:t.bg_opacity})},substract:function(t){var e=this.$panel.find(".number").text()-0;if(1!=e){--e<1&&(e=1);var i={column_count:e};this.updateState(i),this.blocks&&this.blocks[0].trigger("changeColumns",i)}},add:function(t){var e=this.$panel.find(".number").text()-0;if(e!=this.MAX_COLUMN_COUNT){++e>this.MAX_COLUMN_COUNT&&(e=this.MAX_COLUMN_COUNT);var i={column_count:e};this.updateState(i),this.blocks&&this.blocks[0].trigger("changeColumns",i)}},onGapChanged:function(t,e){var i={column_gap:e};this.updateState(i),this.blocks&&this.blocks[0].trigger("changeColumns",i)},toggleColorbox:function(t){this.colorbox_visible?this.closeColorBox():(this.colorbox_visible=!0,this.$(".colorbox_container").fadeIn(200),this.colorbox.setOpacity(this.blocks[0].model.get("bg_opacity")),this.colorbox.setColor(this.blocks[0].model.get("bg_color")))},closeColorBox:function(t){if(t){if(Object(u.a)(t.target).closest(".colorbox_container").length>0)return;if(Object(u.a)(t.target).closest(".bg-color").length>0)return}this.colorbox_visible=!1,this.$(".colorbox_container").fadeOut(200)},colorChanged:function(t,e,i,n){"ffffff"!=this.blocks[0].model.get("bg_color")||0!=this.blocks[0].model.get("bg_opacity")||this.firstColorChange||(this.firstColorChange=!0,this.colorbox.setOpacity(1,!0),n=1),this.colorOpacityChanged(t,e,i,n)},opacityChanged:function(t,e,i,n){this.colorOpacityChanged(t,e,i,n)},colorOpacityChanged:function(t,e,i,n){var o={bg_color:this.colorbox&&this.colorbox.rgb2hex([t,e,i]),bg_opacity:n};this.updateState(o),this.blocks&&this.blocks[0].trigger("changeColumns",o)},deselect:function(){this.colorbox_visible&&this.closeColorBox(),a.a.prototype.deselect.apply(this,arguments)},onClick:function(){this.selected&&this.colorbox_visible?this.closeColorBox():a.a.prototype.onClick.apply(this,arguments)},onEscKey:function(){this.selected&&this.colorbox_visible?this.closeColorBox():a.a.prototype.onEscKey.apply(this,arguments)},canControlBeClosed:function(){return this.colorbox_visible?(this.closeColorBox(),!0):a.a.prototype.canControlBeClosed.apply(this,arguments)}}),yi=i("oRHT"),_i=i.n(yi),wi=a.a.extend({name:"text_edit",className:"control text_edit",initialize:function(t){this.template=_i.a["template-constructor-control-text_edit"],this.initControl(t)},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_edit")})),o.a.defer(function(){this.blocks&&this.blocks[0].enterEditMode()}.bind(this))}}),ki=i("NEuE"),Si=i.n(ki),xi=a.a.prototype,Ci=a.a.extend({name:"picture_crop",className:"control picture_crop",events:{"click .equilateral":"equilateral","click .fill":"fill","click .fit":"fit","click .scale":"setScale"},scaleParams:{min:.01,max:5},snapParams:{lastZoom:null,activeSnap:null,delta:.01,points:[.5,1]},HANDLER_SIZE:26,initialize:function(t){this.template=Si.a["template-constructor-control-picture_crop"],this.initControl(t),this.block=this.blocks[0],this.block.model.get("picture")||this.block.tempPicture||this.$el.hide(),this.onFullWidthChange(),this.onFullHeightChange()},onClick:function(){this.block.$picture&&(this.$el.hasClass("inactive")||xi.onClick.apply(this,arguments))},render:function(){xi.render.apply(this,arguments),this.initScale(),this.onScaleChange(),this.block.has_parent_block&&this.$el.addClass("hide-all-except-scale"),this.$equilateral=this.$(".equilateral")},select:function(){this.block.enterCropMode(),this.$el.removeClass("fade"),this.$handler.css("top",this.toScale(this.block.model.get("scale"))),this.$helper.text(Math.floor(100*this.block.model.get("scale"))+"%"),this.snapParams.lastZoom=Number((+this.block.model.get("scale")||0).toFixed(2)),this.snapParams.activeSnap=null,this.toggleSnappedStyle()},deselect:function(){this.block.leaveCropMode(),xi.deselect.apply(this,arguments)},toggleEnabled:function(t,e){clearTimeout(this.cancelLoadingTimeout),t&&e?this.block.originalLoaded||this.$el.addClass("loading"):(this.$el.addClass("checked"),this.$icon.addClass("rmalttext-disable"),this.cancelLoadingTimeout=setTimeout(o.a.bind((function(){this.$el.removeClass("loading")}),this),200),t&&xi.select.apply(this,arguments))},onPictureLoaded:function(){this.$el.show()},bindLogic:function(){this.block.model.on("change:scale",this.onScaleChange),this.block.model.on("change:w change:h",this.onSizeChange),this.block.model.on("change:is_full_width",this.onFullWidthChange),this.block.model.on("change:is_full_height",this.onFullHeightChange),this.block.on("picture_added",this.onPictureLoaded),this.$scale=this.$panel.find(".scale"),this.$handler=this.$panel.find(".handler"),this.$helper=this.$panel.find(".helper"),this.$handler.on("dragstart",this.onScaleStart),this.$handler.on("drag",this.onScale),this.$handler.on("dragend",this.onScaleStop),this.block.on("crop_click",this.onClick),this.block.on("transitionmode",this.toggleEnabled)},unBindLogic:function(){this.block.off("transitionmode",this.toggleEnabled),this.block.off("crop_click",this.onClick),this.$handler&&(this.$handler.off("dragstart",this.onScaleStart),this.$handler.off("drag",this.onScale),this.$handler.off("dragend",this.onScaleStop),this.block.model.off("change:scale",this.onScaleChange),this.block.model.off("change:w change:h",this.onSizeChange),this.block.model.off("change:is_full_width",this.onFullWidthChange),this.block.model.off("change:is_full_height",this.onFullHeightChange),this.block.off("picture_added",this.onPictureLoaded))},equilateral:function(){if(!this.$equilateral.hasClass("fade")){var t=this.block.getBoxData();if(t.w>t.h){var e={width:t.h,height:t.h,left:t.x+(t.w-t.h)/2,top:t.y};this.block.frame.doResize(e),this.block.onCropResize(e),this.block.onResizeEnd()}else{e={width:t.w,height:t.w,top:t.y+(t.h-t.w)/2,left:t.x};this.block.frame.doResize(e),this.block.onCropResize(e),this.block.onResizeEnd()}this.$equilateral.addClass("fade")}},fill:function(){this.block.fill()},fit:function(){this.block.fit()},toggleSnappedStyle:function(){this.$handler.toggleClass("snapped",Boolean(this.snapParams.activeSnap))},onScaleStart:function(t,e){e.offset=parseInt(this.$handler.css("top")),this.$handler.addClass("dragging")},onScale:function(t,e){var i=this,n=Number(this.fromScale(e.deltaY+e.offset).toFixed(2));n<this.scaleParams.min&&(n=this.scaleParams.min),n>this.scaleParams.max&&(n=this.scaleParams.max),this.snapParams.lastZoom!==n&&(this.snapParams.lastZoom=n,this.snapParams.activeSnap&&(n>this.snapParams.activeSnap+this.snapParams.delta||n<this.snapParams.activeSnap-this.snapParams.delta)?this.snapParams.activeSnap=null:this.snapParams.activeSnap&&(n=this.snapParams.activeSnap),this.snapParams.activeSnap=null,this.snapParams.points.forEach((function(t){n===t&&n!==i.snapParams.activeSnap&&(i.snapParams.activeSnap=t)})),this.toggleSnappedStyle(),this.block.rescale(n))},onScaleChange:function(t,e,i){var n=i&&i.smooth?"animate":"css";this.$handler[n]({top:this.toScale(e)}),this.$helper.text(Math.round(100*e)+"%")},onSizeChange:function(t,e,i){t.get("w")!==t.get("h")&&this.$equilateral.hasClass("fade")&&this.$equilateral.removeClass("fade")},onScaleStop:function(){this.$handler.removeClass("dragging"),this.snapParams.activeSnap=null},setScale:function(t){if(!Object(u.a)(t.target).closest(".handler").length){var e=t.pageY-Object(u.a)(t.target).offset().top-this.HANDLER_SIZE/2;this.block.rescale(this.fromScale(e).toFixed(2),{smooth:!0})}},initScale:function(){this._scaleHeight=parseInt(this.$scale.css("height"))-parseInt(this.$handler.css("height"))-4;var t=this.scaleParams.min,e=this.scaleParams.max,i=this._scaleHeight,n=Math.floor(this._scaleHeight/2),a=(1-t)*i/((e-1)*i/n-e+t),r=(e-1)*(a/n+1)*a,s=e-r/a;o.a.extend(this.scaleParams,{a:s,b:r,c:a})},toScale:function(t){(t-=0)>this.scaleParams.max&&(this.scaleParams.max=t,this.initScale());var e=this.scaleParams.a;return this.scaleParams.b/(t-e)-this.scaleParams.c},fromScale:function(t){return t<0?this.scaleParams.max:this.scaleParams.a+this.scaleParams.b/(this.scaleParams.c+t)},restrictions:function(t){var e=t.getSelectedBlocks();return!(1==e.length&&(e[0].isPictureEmpty&&e[0].isPictureEmpty()||e[0].isFullWidth()||e[0].isFullHeight()))},onEnterKey:function(){this.selected&&this.master.deselect()},onFullWidthChange:function(){this.$el.toggleClass("inactive",!!this.block.model.get("is_full_width"))},onFullHeightChange:function(){this.$el.toggleClass("inactive",!!this.block.model.get("is_full_height"))}}),Oi=i("5jX/"),ji=i.n(Oi),Pi=a.a.prototype,Ei=a.a.extend({name:"picture_fwpos",className:"control picture_fwpos",initialize:function(t){this.template=ji.a["template-constructor-control-picture_fwpos"],this.initControl(t),this.block=this.blocks[0],this.block.model.get("picture")||this.block.tempPicture||this.$el.hide()},onClick:function(){this.block.$picture&&(this.$el.hasClass("inactive")||Pi.onClick.apply(this,arguments))},select:function(){this.block.enterFWPosMode(),this.$el.addClass("active"),Pi.select.apply(this,arguments)},deselect:function(){this.block.leaveFWPosMode(),this.$el.removeClass("active"),Pi.deselect.apply(this,arguments)},onPictureLoaded:function(){this.$el.show()},bindLogic:function(){this.block.on("picture_added",this.onPictureLoaded),this.block.on("fwpos_click",this.onClick)},unBindLogic:function(){this.block.off("crop_click",this.onClick),this.block.off("picture_added",this.onPictureLoaded)},restrictions:function(t){var e=t.getSelectedBlocks();return 1==e.length&&!(e[0].isPictureEmpty&&e[0].isPictureEmpty())&&(e[0].isFullWidth()||e[0].isFullHeight())},onEnterKey:function(){this.selected&&this.master.deselect()}}),Ii=ui.extend({name:"picture_link",className:"control picture_link",saveOnDestroy:!1,bindLogicSpecific:function(){this.listenTo(this.blocks[0].model,"change:clickLink change:clickTarget",this.updateState),this.updateState()},unBindLogicSpecific:function(){this.stopListening(this.model)},onTargetInputChange:function(){var t=this.$target_input.prop("checked");this.models[0].save({clickTarget:t?"_blank":"_self"})},updateState:function(t){var e=this.models[0].get("clickLink"),i=this.models[0].get("clickTarget");if(this.$panel.toggleClass("collapsed",!e),this.placeholder_popup_visible&&this.closePlaceholderPopup(),e){if(this.$target_wrapper.addClass("disabled"),/^mailto\:/i.test(e)?this.setPlaceholder("email"):/^tel\:/i.test(e)?this.setPlaceholder("phone"):this.backRegexp.test(e)?this.setPlaceholder("back"):this.gobackRegexp.test(e)?this.setPlaceholder("goback"):this.mailchimpRegexp.test(e)?this.setPlaceholder("mailchimp"):this.anchorRegexp.test(e)?this.setPlaceholder("anchor"):(this.setPlaceholder("url"),this.$target_wrapper.removeClass("disabled")),e=(e=e.replace(/^mailto\:/i,"")).replace(/^tel\:/i,""),this.urlRegexp.test(e)||this.shortUrlRegexp.test(e)||_.default.isValidEmailLink(e)||this.telRegexp.test(e))this.$input.val(e);else if(this.backRegexp.test(e))this.setPlaceholder("back"),this.$input.val(this.backDisplayName);else if(this.gobackRegexp.test(e))this.setPlaceholder("goback"),this.$input.val(this.gobackDisplayName);else if(this.mailchimpRegexp.test(e))this.$input.val(this.mailchimpDisplayName);else if(this.anchorRegexp.test(e)){var n=this.models[0].get("anchor_link_pos")||0;this.anchorEnterMode(n),this.$input.val(n+"px")}else{this.setPlaceholder("page"),this.$target_wrapper.addClass("disabled");var o=RM.constructorRouter.mag.getPageUri(e);o?this.$input.val(o):(this.$input.val(""),this.setPlaceholder("no-page"))}this.onInputChange(),this.$action_icon.addClass("remove-icon"),this.$action_icon.removeClass("hidden"),this.$placeholder_icon.addClass("hidden"),this.$target_input.prop("checked","_blank"==i)}else this.$input.val(""),this.onInputChange(),this.setPlaceholder("initial");this.$icon.toggleClass("highlighted",!!e)},onInputKey:function(t){t.keyCode==u.a.keycodes.enter&&this.applyLink(),t.keyCode==u.a.keycodes.del&&""==this.$input.val()&&this.models[0].get("clickLink")&&this.removeLink()},applyLink:function(){var t=this.$input.val(),e={},i=this.getUrlData(t);if(i.result){i.isEmail&&(i.url="mailto:"+i.url),i.isTel&&(i.url="tel:"+i.url),i.isBack&&(i.url=this.backLink),i.isGoBack&&(i.url=this.gobackLink),i.isAnchor?(e.anchor_link_pos=parseInt(i.url,10)||0,i.url=this.anchorLink,i.page=this.blocks[0].workspace.page.id):this.anchorExitMode(),i.isValidPageNumber&&(i.url=RM.constructorRouter.mag.getPageId(i.url));var n=i.isURL?"_blank":"_self";o.a.extend(e,{clickLink:i.url,clickTarget:n}),i.page&&(e.clickPage=i.page),this.models[0].save(e),this.updateState(),Object(u.a)("#main").focus()}},removeLink:function(){this.models[0].unset("clickLink"),this.models[0].unset("clickTarget"),this.models[0].save(),this.updateState()},restrictions:function(t){var e=t.getSelectedBlocks();return 1!=e.length||"Picture"!=e[0].name||!e[0].isPictureEmpty()},save:function(){},destroy:function(){this.anchorExitMode(),a.a.prototype.destroy.apply(this,arguments)},select:function(){if(a.a.prototype.select.apply(this,arguments),this.isPreviewEnabled())return this.$panel.addClass("show-picture-preview-error");this.$panel.removeClass("show-picture-preview-error"),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-text_link")}))},isPreviewEnabled:function(){return!!this.model.get("preview_enabled")}}),Ti=i("btdP"),Mi=i.n(Ti),$i=a.a.extend({name:"picture_color",className:"control picture_color",saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(t){this.template=Mi.a["template-constructor-control-picture-color"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.block.on("picture_added",(function(){this.$el.toggle(this.block.isVector())}),this),this.block.model.get("picture")||this.block.tempPicture||this.$el.hide()},bindLogic:function(){this.colorbox=new Ve.a({$parent:this.$panel,type:"small"}),this.colorbox.on("colorchange",this.colorChanged),this.colorbox.on("opacitychange",this.colorChanged),this.model.on("change:pic_color",this.onColorChange),this.model.on("change:pic_opacity",this.onColorChange),this.updateState()},unBindLogic:function(){this.colorbox&&this.colorbox.off("colorchange",this.colorChanged),this.colorbox&&this.colorbox.off("opacitychange",this.colorChanged),this.colorbox&&this.colorbox.destroy(),this.model.off("change:pic_color",this.onColorChange),this.model.off("change:pic_opacity",this.onColorChange)},updateIconState:function(t,e){t&&null!=e&&this.$icon&&this.$icon.find(".color-circle").css({background:"#"+t,opacity:e})},updateColorboxState:function(t,e){t&&null!=e&&this.colorbox&&(this.colorbox.setOpacity(e),this.colorbox.setColor(t))},colorChanged:function(t,e,i,n){var o=this.colorbox&&this.colorbox.rgb2hex([t,e,i]);this.updateIconState(o,n),this.model.set({pic_color:o,pic_opacity:n}),this.block.$svg&&this.block.setVectorColor(o,n)},updateState:function(){var t=this.model.get("pic_color")||"000000",e=this.model.get("pic_opacity")||1;this.updateIconState(t,e),this.updateColorboxState(t,e),this.block.$svg},onColorChange:function(t,e,i){(i.undo||i.redo)&&this.updateState()},save:function(){this.block.saveSvg(o.a.bind(this.model.save,this.model))}}),Ai=Be.extend({name:"picture_settings",alt:"Picture",panelComponent:"panel-picture-settings",select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-picture_settings")}))}}),Ri=i("kwFJ"),Di=i.n(Ri),Bi=g.extend({name:"slideshow_manager",className:"control slideshow_manager",events:{},MIN_PANEL_HEIGHT:275,MAX_PANEL_HEIGHT:640,CREATE_SPEED:270,initialize:function(t){o.a.bindAll(this),this.template=Di.a["template-constructor-control-slideshow_manager"],this.image_template=Di.a["template-constructor-control-slideshow_manager-image"],this.initControl(t),this.block=this.blocks[0],this.block.manager=this,this.block.workspace.on("main-dragover",this.highlightDropZone),this.slideshowPlayer=this.block.slideshowPlayer},bindLogic:function(){this.block.on("addUpload",this.onAddImage,this),this.block.on("addUpload replaceUpload",this.showLoader,this),this.block.on("nowUploading",this.onStartUploading,this),this.block.on("doneUpload",this.onDoneUpload,this),this.block.on("failUpload",this.onFailUpload,this),this.block.model.on("change:pictures",this.redrawAll,this),this.block.on("clear",this.clearImages),this.$panel.on("click",".add-block .add",this.addClick),this.$panel.on("click",".slideshow-image-wrapper .remove",this.onRemoveImage),this.$panel.on("click",".slideshow-image-wrapper .update",this.onUpdateImage),this.$panel.on("mouseenter",".slideshow-image-wrapper .image",this.onImageMouseEnter),this.$panel.on("mouseleave",".slideshow-image-wrapper .image",this.onImageMouseLeave),this.$panel.on("click",".slideshow-image-wrapper .image",this.onImageClick),this.$resizableContent=Object(u.a)(this.$panel.find(".resizable-content")),this.block.on("reorder",this.reorder,this),this.$resizableContent.sortable({distance:10,axis:"y",scrollSpeed:20,containment:this.$(".resizable-scroll-wrapper"),tolerance:"pointer",cursorAt:{top:50},start:o.a.bind((function(t,e){this.onImageMouseLeave(),e.item.find(".slideshow-image").addClass("dragging"),this.$resizableContent.css("height",this.$resizableContent.height()+30)}),this),stop:o.a.bind((function(t,e){setTimeout(o.a.bind((function(){e.item.find(".slideshow-image").removeClass("dragging")}),this),50),e.position.top>this.$resizableContent.height()-30-e.item.height()&&e.item.detach().closest(".slideshow-image-wrapper").appendTo(this.$resizableContent),this.block.swapPictures(e.item.data("num"),e.item.index()+1),this.$resizableContent.css("height","auto")}),this)}),this.$uploadDropZone=this.$el,this.block.updateDropZone(),this.renderPictures(),this.slideshowPlayer&&this.slideshowPlayer.on("currentImageChanged",this.onCurrentImageChanged),this.block.queue.length&&this.showLoader()},unBindLogic:function(){this.block.off(null,null,this),this.$panel.off("click",".add-block .add",this.addClick),this.$panel.off("click",".slideshow-image-wrapper .remove",this.onRemoveImage),this.$panel.off("click",".slideshow-image-wrapper .update",this.onUpdateImage),this.$panel.off("mouseenter",".slideshow-image-wrapper .image",this.onImageMouseEnter),this.$panel.off("mouseleave",".slideshow-image-wrapper .image",this.onImageMouseLeave),this.$panel.off("click",".slideshow-image-wrapper .image",this.onImageClick),this.slideshowPlayer&&this.slideshowPlayer.off(),delete this.$uploadDropZone},renderPictures:function(t){var e=o.a.sortBy(this.block.getAllPics(),(function(t){return t.num})),i="";o.a.each(e,(function(t){i+=this.image_template({pic:t,thumbUrl:this.getThumbUrl(t)})}),this),t&&t.clear&&this.$panel.find(".resizable-content").html(""),this.$panel.find(".resizable-content").append(i);var n=this.block.queue[0];n&&this.onStartUploading(n),this.rendered=!0,this.resizableScroll&&this.resizableScroll.recalc(),Object(u.a)(this.$panel.find(".resizable-content")).sortable("refresh")},redrawAll:function(t,e,i){i&&(i.undo||i.redo)&&this.rendered&&(this.$el.addClass("updating"),setTimeout(o.a.bind((function(){this.renderPictures({clear:!0}),this.$el.removeClass("updating"),this.slideshowPlayer&&this.onCurrentImageChanged(this.slideshowPlayer.currentImageID,!1,"change-pictures")}),this),50)),o.a.isEmpty(t.get("pictures"))&&this.clearImages()},clearImages:function(){this.$(".resizable-content").empty(),this.resizableScroll&&this.resizableScroll.recalc();var t=Object(u.a)(this.$panel.find(".resizable-content"));t.data("ui-sortable")&&t.sortable("refresh")},reorder:function(){this.$(".slideshow-image-wrapper:not(.deleting)").each((function(t){Object(u.a)(this).data("num",t+1).find(".num").text(t+1)}))},onCurrentImageChanged:function(t,e,i){var n=this.$panel.find('.slideshow-image-wrapper .image[data-id="'+t+'"]');if(n.length||(n=this.$panel.find(".slideshow-image-wrapper .image:first")),n.length&&(this.$panel.find(".slideshow-image").removeClass("active"),n.closest(".slideshow-image").addClass("active"),"switch-to-image"==i||"control-show"==i)){n=n.closest(".slideshow-image-wrapper");var o,a=this.$panel.find(".resizable-content-wrapper"),r=n.position().top,s=a.height(),l=n.height();r+2*l-a.scrollTop()>s-8?o=r+2*l-s+8:r-l-a.scrollTop()<8&&(o=r-l-8),null!=o&&(e?a.stop().animate({scrollTop:o},200):a.scrollTop(o))}},onScrollRecalc:function(t){this.slideshowPlayer&&this.onCurrentImageChanged(this.slideshowPlayer.currentImageID,!1,t)},onImageClick:function(t){var e=Object(u.a)(t.target).attr("data-id");e&&this.slideshowPlayer&&this.slideshowPlayer.moveToImage(e,!0,"switch-to-image")},onImageMouseEnter:function(t){var e=Object(u.a)(t.currentTarget),i=e.closest(".slideshow-image-wrapper"),n=this.$(".error-panel");if(!e.closest(".slideshow-image").hasClass("dragging")&&i.hasClass("error")){var o=e.width(),a=e.offset().left-this.$panel.offset().left,r=e.offset().top-this.$panel.offset().top;n.find(".error-panel-text").text(i.attr("data-error")),n.addClass("shown").css({left:a+o/2,top:r-n.outerHeight()})}},onImageMouseLeave:function(t){this.$(".error-panel").removeClass("shown")},addClick:function(){this.block.$(".uploadInput").trigger("click","stop")},onAddImage:function(t){var e=Object(u.a)(this.image_template({pic:t,thumbUrl:this.getThumbUrl(t)}));e.appendTo(this.$panel.find(".resizable-content")),e.addClass("enable-transition").addClass("collapsed").addClass("collapsed-half"),setTimeout(o.a.bind((function(){e.removeClass("collapsed"),setTimeout(o.a.bind((function(){e.removeClass("collapsed-half"),setTimeout(o.a.bind((function(){e.removeClass("enable-transition"),this.resizableScroll&&this.resizableScroll.recalc(),Object(u.a)(this.$panel.find(".resizable-content")).sortable("refresh")}),this),this.CREATE_SPEED)}),this),this.CREATE_SPEED)}),this),50)},showLoader:function(){this.$el.addClass("loading")},onStartUploading:function(t){this.getImage(t).addClass("loading")},getThumbUrl:function(t){if(!Et.a.useLambdaUrl(t))return t.thumbUrl;var e={width:Ft.a.THUMB_SIZE_SLIDESHOW,height:Ft.a.THUMB_SIZE_SLIDESHOW,originalW:t.width,originalH:t.height};return Et.a.getThumbnailUrl(t,e)},onDoneUpload:function(t){var e=this.getImage(t);e.find(".rmpreloader").fadeOut("fast",(function(){e.removeClass("loading"),Object(u.a)(this).attr("style","")})),e.find(".image").css("background-image",'url("'.concat(this.getThumbUrl(t),'")')).attr("data-id",t.id),this.block.queue.length||this.$el.removeClass("loading")},onFailUpload:function(t,e){var i=this.getImage(t);t.error&&i.addClass("error").attr("data-error",e),this.block.queue.length||this.$el.removeClass("loading")},onRemoveImage:function(t){var e=Object(u.a)(t.target).closest(".slideshow-image-wrapper"),i=e.addClass("deleting").data("num");this.block.deletePic(i),e.addClass("enable-transition"),setTimeout(o.a.bind((function(){e.addClass("removed-half"),setTimeout(o.a.bind((function(){e.addClass("removed"),setTimeout(o.a.bind((function(){e.removeClass("enable-transition").remove(),this.resizableScroll&&this.resizableScroll.recalc()}),this),this.CREATE_SPEED)}),this),this.CREATE_SPEED)}),this),50)},getImage:function(t){return this.$(".slideshow-image-wrapper").filter((function(){return Object(u.a)(this).data("num")===t.num}))},onUpdateImage:function(t){var e=Object(u.a)(t.target).closest(".slideshow-image-wrapper").removeClass("error").data("error","").attr("style","").data("num");this.block.updatePic(e)},highlightDropZone:function(){this.$panel.addClass("show-dropzone"),clearTimeout(this.highlightTimeout),this.highlightTimeout=setTimeout(o.a.bind((function(){this.$panel.removeClass("show-dropzone")}),this),500)},select:function(){g.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-slideshow_manager")}))},restrictions:function(t){var e=o.a.pluck(t.getSelectedBlocks(),"model");return o.a.all(e,(function(t){return"slideshow"==!t.get("type")||(t.get("pictures")||[]).length>0}))},destroy:function(){g.prototype.destroy.apply(this,arguments),this.rendered=!1}}),Li=i("u/SR"),zi=i.n(Li),Fi=a.a.extend({name:"shape_color",className:"control shape_color",saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(t){this.template=zi.a["template-constructor-control-shape_color"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,o.a.bindAll(this)},bindLogic:function(){this.colorbox=new Ve.a({$parent:this.$panel,type:"small"}),this.colorbox.on("colorchange",this.colorChanged),this.colorbox.on("opacitychange",this.colorChanged),this.model.on("change:bg_color",this.onColorChange),this.model.on("change:bg_opacity",this.onColorChange),this.updateState()},unBindLogic:function(){this.colorbox&&this.colorbox.off("colorchange",this.colorChanged),this.colorbox&&this.colorbox.off("opacitychange",this.colorChanged),this.colorbox&&this.colorbox.destroy(),this.model.off("change:bg_color",this.onColorChange),this.model.off("change:bg_opacity",this.onColorChange)},updateIconState:function(t,e){t&&null!=e&&this.$icon&&this.$icon.find(".color-circle").css({background:"#"+t,opacity:e})},updateColorboxState:function(t,e){t&&null!=e&&this.colorbox&&(this.colorbox.setOpacity(e),this.colorbox.setColor(t))},colorChanged:function(t,e,i,n){var o=this.colorbox&&this.colorbox.rgb2hex([t,e,i]);this.updateIconState(o,n),this.model.set({bg_color:o,bg_opacity:n})},updateState:function(){var t=this.model.get("bg_color"),e=this.model.get("bg_opacity");this.updateIconState(t,e),this.updateColorboxState(t,e)},onColorChange:function(t,e,i){(i.undo||i.redo)&&this.updateState()},save:function(){"icon"!==this.model.get("tp")?this.model.save({}):this.block.saveNewColor()}}),Ui=Be.extend({name:"shape_settings",alt:"Settings",panelComponent:"panel-shape-settings",onPanelChange:function(t){Be.prototype.onPanelChange.apply(this,arguments)},select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-shape_settings")}))},deselect:function(){this.colorbox_visible&&this.closeColorBox(),this.stroke_popup_visible&&this.closeStrokePopup(),Be.prototype.deselect.apply(this,arguments)}}),Ni=i("2d4q"),Hi=i.n(Ni),Vi=a.a.extend({name:"shape_1x1",className:"control shape_1x1",initialize:function(t){this.template=Hi.a["template-constructor-control-shape_1x1"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.onScaleChange.__debounced=o.a.debounce(this.onScaleChange,100)},bindLogic:function(){this.model.on("change",this.onScaleChange.__debounced),this.onScaleChange()},unBindLogic:function(){this.model.off("change",this.onScaleChange.__debounced)},onScaleChange:function(){if(this.model){var t=this.model.get("h")==this.model.get("w");this.$el.toggleClass("inactive",t)}},onClick:function(){this.$el.hasClass("inactive")||(this.block.makeSquare(),this.model.save(),this.master.deselect())},restrictions:function(t){var e=t.getSelectedBlocks();return e.length&&!e[0].isFullWidth()&&!e[0].isFullHeight()}}),Wi=i("voD7"),Gi=i.n(Wi),qi=g.extend({name:"shape_icon",className:"control shape_icon",MIN_PANEL_HEIGHT:264,MAX_PANEL_HEIGHT:640,SCROLL_GAP_START:0,SCROLL_GAP_END:8,API_URL:"/api/authservice/noun?uri=",LIMIT_TO_PUBLIC_DOMAIN:!1,DEFAULT_COLLECTION_ID:1335,saveOnDestroy:!0,saveOnDeselect:!0,events:{"click .icon-item":"onIconItemClick"},initialize:function(t){this.template=Gi.a["template-constructor-control-shape_icon"],this.templateItem=Gi.a["template-constructor-control-shape_icon-item"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},render:function(){g.prototype.render.apply(this,arguments),this.$result=this.$(".panel .resizable-content"),window.prevSVGSearch?(this.nextPage=window.prevSVGSearch.nextPage,this.$(".search").val(window.prevSVGSearch.phrase),this.search_string=window.prevSVGSearch.phrase,this.drawSearchResults(window.prevSVGSearch),this.$(".loupe").addClass("clear")):this.getDefaultCollection()},bindLogic:function(){this.$(".search").on("keyup",this.onSearchKeyUp),this.$(".loupe:not(.preloading)").on("click",this.onLoupeClick),this.listenTo(this.block.model,"change:tp",this.onShapeTypeChange)},unBindLogic:function(){this.$(".search").off("keyup",this.onSearchKeyUp),this.$(".loupe").off("click",this.onLoupeClick),this.stopListening(this.block.model)},onSearchKeyUp:function(t){t.keyCode===u.a.keycodes.enter&&this.doSearch()},onLoupeClick:function(t){this.$(".loupe").hasClass("clear")?this.clearSearch():this.doSearch()},doSearch:function(){var t=this.$(".search").val().trim();t&&this.search_string!=t&&!this.requestInProgress&&(this.search_string=t,this.$result.empty(),delete window.prevSVGSearch,this.$(".loupe").addClass("clear"),this.nextPage=1,this.getDataPage(this.nextPage))},clearSearch:function(){this.$(".loupe").removeClass("clear"),delete window.prevSVGSearch,this.$(".search").val(""),this.search_string="",this.$result.empty(),this.getDefaultCollection()},getDataPage:function(t){var e;this.search_string&&!this.requestInProgress&&(e="/icons/"+this.search_string+"?page="+t,this.LIMIT_TO_PUBLIC_DOMAIN&&(e+="&limit_to_public_domain=1"),this.requestIcons(e,function(t,e){t?delete this.nextPage:(window.prevSVGSearch=window.prevSVGSearch||{icons:[]},window.prevSVGSearch.icons=window.prevSVGSearch.icons.concat(e.icons),window.prevSVGSearch.phrase=this.search_string,window.prevSVGSearch.nextPage=this.nextPage,this.drawSearchResults(e))}.bind(this)))},requestIcons:function(t,e){this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!0,this.showSearchPreloader(),this.searchXhr=u.a.ajax({method:"GET",url:this.API_URL+encodeURIComponent(t),dataType:"json",success:function(t){e(null,t)},error:function(t){e(t)},complete:function(){this.searchInProgress=!1,this.hideSearchPreloader()},context:this})},getDefaultCollection:function(){this.drawSearchResults(this.defaultCollection)},drawSearchResults:function(t){o.a.isArray(t.icons)&&t.icons.length?(o.a.each(t.icons,function(t){this.$result.append(this.templateItem({icon:t}))}.bind(this)),this.__scrollRecalc_debounced()):delete this.nextPage},select:function(){g.prototype.select.apply(this,arguments),o.a.delay(function(){this.$(".search").focus().select()}.bind(this),400)},save:function(){this.model.save(),g.prototype.save.apply(this,arguments)},onIconItemClick:function(t){var e=Object(u.a)(t.currentTarget),i=e.find(".noun-icon"),n=i.attr("data-id"),a=i.attr("data-rm_id"),r=i.attr("data-url");this.$(".resizable-content").hasClass("preloading")||(this.hideIconPreloader(),this.showIconPreloader(e),this.block.getIconSVG(n||a,r,function(t,i){var s;this.hideIconPreloader(),t||(this.$(".icon-item").removeClass("selected"),e.addClass("selected"),s={noun_url:r},n?o.a.extend(s,{noun_id:n,rm_id:null}):a&&o.a.extend(s,{noun_id:null,rm_id:a}),this.block.model.set(s))}.bind(this)))},onPanelScroll:function(t){this.selected&&t.content_size-t.container_size-t.scroll_pos<32&&this.nextPage&&!this.searchInProgress&&this.getDataPage(++this.nextPage)},abortRequests:function(){this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!1},onShapeTypeChange:function(){"icon"!==this.block.model.get("tp")&&this.abortRequests()},showSearchPreloader:function(){this.$(".loupe").addClass("preloading")},hideSearchPreloader:function(){this.$(".loupe").removeClass("preloading")},showIconPreloader:function(t){t.append(Object(u.a)('<div class="rmpreloader"><div class="arc"></div></div>')),this.$(".resizable-content").add(t).addClass("preloading")},hideIconPreloader:function(t){this.$(".resizable-content").find(".rmpreloader").remove(),this.$(".resizable-content").add(this.$(".icon-item")).removeClass("preloading")},destroy:function(){this.abortRequests(),g.prototype.destroy.apply(this,arguments)}}),Ki=i("0SXY"),Yi=i.n(Ki),Xi=a.a.extend({name:"gmaps_edit",className:"control gmaps_edit",saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(t){this.template=Yi.a["template-constructor-control-gmaps_edit"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},select:function(){a.a.prototype.select.apply(this,arguments),this.block.enterEditState(),this.$(".icon").addClass("edit")},deselect:function(){this.block.exitEditState(),a.a.prototype.deselect.apply(this,arguments),this.$(".icon").removeClass("edit")},bindLogic:function(){this.block.on("editMapClick",this.onClick)},unBindLogic:function(){this.block.off("editMapClick",this.onClick)},save:function(){this.model.save({})}}),Zi=Be.extend({name:"gmaps_settings",alt:"Settings",panelComponent:"panel-gmaps-settings"}),Ji=i("TGSb"),Qi=i.n(Ji),tn=a.a.extend({name:"common_lock",className:"control common_lock",initialize:function(t){this.template=Qi.a["template-constructor-control-common_lock"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},render:function(){a.a.prototype.render.apply(this,arguments),this.updateState()},bindLogic:function(){RM.constructorRouter.bindGlobalKeyPress([{key:"l",handler:this.onClick}]),o.a.each(this.models,function(t){this.listenTo(t,"change:is_locked",this.onLockChange)}.bind(this))},unBindLogic:function(){RM.constructorRouter.unbindGlobalKeyPress("l",this.onClick),o.a.each(this.models,function(t){this.stopListening(t,"change:is_locked")}.bind(this))},onClick:function(){if(!this.isOnClickDisabled()){var t=o.a.all(this.models,(function(t){return!t.get("is_locked")})),e=o.a.map(this.models,(function(e){return{_id:e.id,is_locked:t}}));this.master.workspace.save_group(e),this.master.deselect()}},onLockChange:function(){this.updateState()},updateState:function(){var t=o.a.any(this.models,(function(t){return t.get("is_locked")}));this.$el.toggleClass("locked",t),this.$(".icon").attr("data-alt",t?"Unlock":"Lock"),o.a.each(this.models,(function(e){var i=e.get("pack_id");i&&Object(u.a)("#pack_"+i).toggleClass("no-drag",t)}))}}),en=i("ibKe"),nn=i.n(en),on=a.a.extend({name:"button_edit",className:"control button_edit",saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(t){this.template=nn.a["template-constructor-control-button_edit"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-button_edit")}))},onClick:function(){if(!this.isOnClickDisabled()){var t=this.blocks&&this.blocks[0];t.isEditMode?t.leaveEditMode({deselectControl:!0}):t.enterEditMode()}},onEscKey:function(){var t=this.blocks&&this.blocks[0];t.isEditMode&&t.leaveEditMode({deselectControl:!0,saveWidgetData:!0})},onEnterKey:function(){var t=this.blocks&&this.blocks[0];t.isEditMode&&t.leaveEditMode({deselectControl:!0,saveWidgetData:!0})},save:function(){(this.blocks&&this.blocks[0]).saveWidgetData()},canControlBeClosed:function(){return!1},deselect:function(){var t=this.blocks&&this.blocks[0];t.isEditMode&&t.leaveEditMode(),a.a.prototype.deselect.apply(this,arguments)},destroy:function(){var t=this.blocks&&this.blocks[0];t&&t.isEditMode&&t.leaveEditMode(),a.a.prototype.destroy.apply(this,arguments)}}),an=Be.extend({name:"button_settings",alt:"Settings",panelComponent:"panel-button-settings"}),rn=i("a3mI"),sn=i.n(rn),ln=g.extend({name:"button_icon",className:"control button_icon",MIN_PANEL_HEIGHT:274,MAX_PANEL_HEIGHT:640,SCROLL_GAP_START:4,SCROLL_GAP_END:4,API_URL:"/api/authservice/noun?uri=",LIMIT_TO_PUBLIC_DOMAIN:!1,DEFAULT_COLLECTION_ID:1335,saveOnDestroy:!0,saveOnDeselect:!0,initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.template=sn.a["template-constructor-control-button_icon"],this.templateItem=sn.a["template-constructor-control-button_icon-item"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.applyIconSizeParamVisualState.__debounced=o.a.debounce(this.applyIconSizeParamVisualState,20),this.bindModelEvents()},render:function(){g.prototype.render.apply(this,arguments),this.$result=this.$(".panel .resizable-content"),_.default.isNounSearchAvailable()||this.$panel.addClass("no-search"),window.prevSVGSearch?(this.nextPage=window.prevSVGSearch.nextPage,this.$(".search").val(window.prevSVGSearch.phrase),this.search_string=window.prevSVGSearch.phrase,this.drawSearchResults(window.prevSVGSearch),this.$(".loupe").addClass("clear")):this.getDefaultIconsCollection()},bindLogic:function(){this.$el.on("click",".icon-item",this.onIconItemClick),this.$(".search").on("keyup",this.onSearchKeyUp),this.$(".loupe:not(.preloading)").on("click",this.onLoupeClick),this.$iconPositionParam=this.$panel.find('.edit-item[data-field="icon_pos"]'),this.$iconPositions=this.$iconPositionParam.find(".position"),this.$disableIcon=this.$panel.find(".disable-icon"),this.$lastIcon=this.$panel.find(".last-icon"),this.$disableIcon.on("click",this.onDisableIconClick),this.iconSizeEditParamInput=Object(u.a)(this.$panel.find('.edit-item[data-field="icon_h"] input')).RMNumericInput({min:this.block.MIN_FONT_SIZE,max:this.block.MAX_FONT_SIZE,mouseSpeed:4,onChange:this.onEditInputChanged}).data("changeValue"),this.$iconPositionParam.find(".position").on("click",this.onPositionClick),this.applyIconEnabledVisualState(),this.applyIconSizeParamVisualState(),this.applyIconPositionParamVisualState()},unBindLogic:function(){this.$el.off("click",".icon-item",this.onIconItemClick),this.$(".search").off("keyup",this.onSearchKeyUp),this.$(".loupe:not(.preloading)").off("click",this.onLoupeClick),this.$iconPositions.off("click",this.onPositionClick),this.$disableIcon.off("click",this.onDisableIconClick),this.model&&this.model.off(null,null,this)},bindModelEvents:function(){this.model.on("change:icon_h",this.applyIconSizeParamVisualState.__debounced,this),this.model.on("change:icon_pos",this.applyIconPositionParamVisualState,this),this.model.on("change:icon_enabled",this.applyIconEnabledVisualState)},onEditInputChanged:function(t,e){this.model.set(t.closest(".edit-item").attr("data-field"),e)},onPositionClick:function(t){var e=Object(u.a)(t.currentTarget).data("position");this.model.set("icon_pos",e)},applyIconEnabledVisualState:function(){var t=this.model.get("icon_enabled");this.$disableIcon.add(this.$lastIcon).removeClass("active"),t?this.$lastIcon.addClass("active"):this.$disableIcon.addClass("active")},applyIconSizeParamVisualState:function(){this.iconSizeEditParamInput(this.model.get("icon_h"),!0)},applyIconPositionParamVisualState:function(){this.$iconPositionParam.find(".current").removeClass("current"),this.$iconPositionParam.find("."+this.model.get("icon_pos")).addClass("current")},onSearchKeyUp:function(t){t.keyCode===u.a.keycodes.enter&&this.doSearch()},onLoupeClick:function(t){this.$(".loupe").hasClass("clear")?this.clearSearch():this.doSearch()},doSearch:function(){var t=this.$(".search").val().trim();t&&this.search_string!==t&&!this.requestInProgress&&(this.search_string=t,this.$result.find(".icon-item").remove(),delete window.prevSVGSearch,this.$(".loupe").addClass("clear"),this.nextPage=1,this.getDataPage(this.nextPage))},clearSearch:function(){this.$(".loupe").removeClass("clear"),delete window.prevSVGSearch,this.$(".search").val(""),this.search_string="",this.$result.find(".icon-item").remove(),this.getDefaultIconsCollection()},getDataPage:function(t){var e;this.search_string&&!this.requestInProgress&&(e="/icons/"+this.search_string+"?page="+t,this.LIMIT_TO_PUBLIC_DOMAIN&&(e+="&limit_to_public_domain=1"),this.requestIcons(e,function(t,e){t?delete this.nextPage:(window.prevSVGSearch=window.prevSVGSearch||{icons:[]},window.prevSVGSearch.icons=window.prevSVGSearch.icons.concat(e.icons),window.prevSVGSearch.phrase=this.search_string,window.prevSVGSearch.nextPage=this.nextPage,this.drawSearchResults(e))}.bind(this)))},requestIcons:function(t,e){this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!0,this.showSearchPreloader(),this.searchXhr=u.a.ajax({method:"GET",url:this.API_URL+encodeURIComponent(t),dataType:"json",success:function(t){e(null,t)},error:function(t){e(t)},complete:function(){this.searchInProgress=!1,this.hideSearchPreloader()}.bind(this),context:this})},getDefaultIconsCollection:function(){this.drawSearchResults(this.defaultIconsCollection)},drawSearchResults:function(t){o.a.isArray(t.icons)&&t.icons.length?(o.a.each(t.icons,function(t){this.$result.append(this.templateItem({icon:t}))}.bind(this)),this.__scrollRecalc_debounced()):delete this.nextPage},select:function(){g.prototype.select.apply(this,arguments),o.a.delay(function(){this.$(".search").focus().select()}.bind(this),400)},save:function(){this.block.saveWidgetData(),g.prototype.save.apply(this,arguments)},onIconItemClick:function(t){var e=Object(u.a)(t.currentTarget),i=e.find(".noun-icon"),n=i.attr("data-id"),a=i.attr("data-rm_id"),r=i.attr("data-url");this.$(".resizable-content").hasClass("preloading")||(this.hideIconPreloader(),this.showIconPreloader(e),this.block.getIconSVG(n||a,r,function(t,i){var s,l=this.model.get("icon_enabled");this.hideIconPreloader(),t||(this.$(".icon-item.selected").removeClass("selected"),e.addClass("selected"),s={icon_noun_url:r},n?o.a.extend(s,{icon_noun_id:n,icon_rm_id:null}):a&&o.a.extend(s,{icon_noun_id:null,icon_rm_id:a}),l||o.a.extend(s,{icon_enabled:!0}),this.block.model.set(s),this.$lastIcon.find(".noun-icon").css({"background-image":'url("'+i.noun_url+'")'}))}.bind(this)))},onDisableIconClick:function(){var t=this.model.get("icon_enabled");this.$(".icon-item.selected").removeClass("selected"),t&&(this.model.set("icon_enabled",!1),this.block.$buttonIcon.empty(),this.block.recalcButtonSize())},onPanelScroll:function(t){this.selected&&t.content_size-t.container_size-t.scroll_pos<32&&this.nextPage&&!this.searchInProgress&&this.getDataPage(++this.nextPage)},abortRequests:function(){this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!1},showSearchPreloader:function(){this.$(".loupe").addClass("preloading")},hideSearchPreloader:function(){this.$(".loupe").removeClass("preloading")},showIconPreloader:function(t){t.append(Object(u.a)('<div class="rmpreloader"><div class="arc"></div></div>')),this.$(".resizable-content").add(t).addClass("preloading")},hideIconPreloader:function(t){this.$(".resizable-content").find(".rmpreloader").remove(),this.$(".resizable-content").add(this.$(".icon-item")).removeClass("preloading")},destroy:function(){this.abortRequests(),g.prototype.destroy.apply(this,arguments)}});ln.prototype.defaultIconsCollection={icons:[{rm_id:"rm0",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/00-plus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/00-plus.svg")},{rm_id:"rm1",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/01-checkbox.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/01-checkbox.svg")},{rm_id:"rm2",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/02-delete.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/02-delete.svg")},{rm_id:"rm3",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/03-minus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/03-minus.svg")},{rm_id:"rm4",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/04-sandwich-two-lines.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/04-sandwich-two-lines.svg")},{rm_id:"rm5",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/05-sandwich-three-lines.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/05-sandwich-three-lines.svg")},{rm_id:"rm6",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/06-edit-thin.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/06-edit-thin.svg")},{rm_id:"rm7",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/07-edit-thick.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/07-edit-thick.svg")},{rm_id:"rm8",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/08-file.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/08-file.svg")},{rm_id:"rm9",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/09-flag.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/09-flag.svg")},{rm_id:"rm10",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/10-geolocation.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/10-geolocation.svg")},{rm_id:"rm11",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/11-geopin.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/11-geopin.svg")},{rm_id:"rm12",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/12-star.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/12-star.svg")},{rm_id:"rm13",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/13-heart.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/13-heart.svg")},{rm_id:"rm14",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/14-bag.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/14-bag.svg")},{rm_id:"rm15",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/15-user.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/15-user.svg")},{rm_id:"rm16",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/16-eye.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/16-eye.svg")},{rm_id:"rm17",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/17-lock.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/17-lock.svg")},{rm_id:"rm18",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/18-instacamera.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/18-instacamera.svg")},{rm_id:"rm19",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/19-camera.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/19-camera.svg")},{rm_id:"rm20",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/20-lightning.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/20-lightning.svg")},{rm_id:"rm21",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/21-play.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/21-play.svg")},{rm_id:"rm22",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/22-video.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/22-video.svg")},{rm_id:"rm23",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/23-pause.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/23-pause.svg")},{rm_id:"rm24",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/24-music-note.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/24-music-note.svg")},{rm_id:"rm25",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/25-sound-on.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/25-sound-on.svg")},{rm_id:"rm26",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/26-sound-off.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/26-sound-off.svg")},{rm_id:"rm27",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/27-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/27-left-arrow.svg")},{rm_id:"rm28",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/28-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/28-left-arrow.svg")},{rm_id:"rm29",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/29-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/29-left-arrow.svg")},{rm_id:"rm30",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/30-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/30-left-arrow.svg")},{rm_id:"rm31",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/31-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/31-left-arrow.svg")},{rm_id:"rm32",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/32-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/32-left-arrow.svg")},{rm_id:"rm33",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/33-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/33-left-arrow.svg")},{rm_id:"rm34",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/34-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/34-left-arrow.svg")},{rm_id:"rm35",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/35-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/35-left-arrow.svg")},{rm_id:"rm36",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/36-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/36-left-arrow.svg")},{rm_id:"rm37",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/37-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/37-left-arrow.svg")},{rm_id:"rm38",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/38-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/38-left-arrow.svg")},{rm_id:"rm39",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/39-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/39-left-arrow.svg")},{rm_id:"rm40",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/40-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/40-left-arrow.svg")},{rm_id:"rm41",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/41-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/41-left-arrow.svg")},{rm_id:"rm42",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/42-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/42-left-arrow.svg")},{rm_id:"rm43",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/43-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/43-left-arrow.svg")},{rm_id:"rm44",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/44-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/44-left-arrow.svg")},{rm_id:"rm45",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/45-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/45-left-arrow.svg")},{rm_id:"rm46",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/46-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/46-left-arrow.svg")},{rm_id:"rm47",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/47-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/47-left-arrow.svg")},{rm_id:"rm48",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/48-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/48-left-arrow.svg")},{rm_id:"rm49",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/49-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/49-left-arrow.svg")},{rm_id:"rm50",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/50-left-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/50-left-arrow.svg")},{rm_id:"rm51",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/51-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/51-right-arrow.svg")},{rm_id:"rm52",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/52-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/52-right-arrow.svg")},{rm_id:"rm53",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/53-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/53-right-arrow.svg")},{rm_id:"rm54",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/54-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/54-right-arrow.svg")},{rm_id:"rm55",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/55-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/55-right-arrow.svg")},{rm_id:"rm56",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/56-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/56-right-arrow.svg")},{rm_id:"rm57",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/57-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/57-right-arrow.svg")},{rm_id:"rm58",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/58-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/58-right-arrow.svg")},{rm_id:"rm59",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/59-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/59-right-arrow.svg")},{rm_id:"rm60",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/60-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/60-right-arrow.svg")},{rm_id:"rm61",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/61-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/61-right-arrow.svg")},{rm_id:"rm62",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/62-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/62-right-arrow.svg")},{rm_id:"rm63",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/63-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/63-right-arrow.svg")},{rm_id:"rm64",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/64-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/64-right-arrow.svg")},{rm_id:"rm65",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/65-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/65-right-arrow.svg")},{rm_id:"rm66",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/66-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/66-right-arrow.svg")},{rm_id:"rm67",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/67-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/67-right-arrow.svg")},{rm_id:"rm68",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/68-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/68-right-arrow.svg")},{rm_id:"rm69",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/69-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/69-right-arrow.svg")},{rm_id:"rm70",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/70-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/70-right-arrow.svg")},{rm_id:"rm71",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/71-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/71-right-arrow.svg")},{rm_id:"rm72",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/72-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/72-right-arrow.svg")},{rm_id:"rm73",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/73-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/73-right-arrow.svg")},{rm_id:"rm74",icon_url:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/74-right-arrow.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/button/default-collection/74-right-arrow.svg")}]};var cn=ln,dn=i("sviH"),hn=i("7TSX"),un=i.n(hn),pn=a.a.extend({name:"hotspot_add",className:"control hotspot_add",pin_attributes:["hotspots_group_id","pin_type","w","h","bg_color","bg_opacity","color","opacity","borders","noun_id","rm_id","noun_url","rasterUrl","raster2xUrl","raster3xUrl","tip_show_on","tip_background-color","tip_background-color-opacity","tip_border-radius","tip_box-shadow","is_global","is_above"],initialize:function(t){this.template=un.a["template-constructor-control-hotspot_add"],this.initControl(t)},onClick:function(){a.a.prototype.onClick.apply(this,arguments);var t=this.blocks[0],e=o.a.clone(t.model.attributes),i=dn.a.hotspot.defaults,n={type:"hotspot"};o.a.extend(n,i);var r={};e.is_above&&(r={fixed_position:"n",x:0,y:460}),o.a.extend(n,o.a.pick(e,this.pin_attributes),r),RM.constructorRouter.workspace.addWidget(n)}}),mn=i("Rn2B"),gn=i.n(mn),fn=g.extend({name:"hotspot_pin_settings",className:"control hotspot_pin_settings",MIN_PANEL_HEIGHT:274,MAX_PANEL_HEIGHT:640,SCROLL_GAP_START:4,SCROLL_GAP_END:4,API_URL:"/api/authservice/noun?uri=",LIMIT_TO_PUBLIC_DOMAIN:!1,DEFAULT_COLLECTION_ID:1335,saveOnDestroy:!0,saveOnDeselect:!0,initialize:function(t){this.template=gn.a["template-constructor-control-hotspot-pin-settings"],this.templateItem=gn.a["template-constructor-control-hotspot-pin-settings-icon-item"],t=t||{},this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},render:function(){g.prototype.render.apply(this,arguments),this.$result=this.$(".panel .resizable-content"),_.default.isNounSearchAvailable()||this.$panel.addClass("no-search"),window.prevSVGSearch?(this.nextPage=window.prevSVGSearch.nextPage,this.$(".search").val(window.prevSVGSearch.phrase),this.search_string=window.prevSVGSearch.phrase,this.drawSearchResults(window.prevSVGSearch),this.$(".loupe").addClass("clear")):this.getDefaultIconsCollection(),this.apply_type_related_visual_state(),this.apply_edit_params_visual_state()},bindLogic:function(){this.bind_model_events(),this.$el.on("click",".resizable-content .item",this.on_icon_click),this.$(".search").on("keyup",this.onSearchKeyUp),this.$(".loupe:not(.preloading)").on("click",this.onLoupeClick),this.$rectangleIcon=this.$panel.find(".rectangle-icon"),this.$circleIcon=this.$panel.find(".circle-icon"),this.$border_edit_param=this.$panel.find('[data-field="borders"]'),this.$borderWidthInput=Object(u.a)(this.$border_edit_param.children("input")),this.$bg_color_edit_param=this.$panel.find('[data-field="bg_color"]'),this.$colorbox_container=this.$panel.find(".colorbox_container"),this.$panel.find('.edit-item[data-field="tip_show_on"] .switcher').on("click",this.toggleShowMode),this.$panel.on("click",".edit-wrapper",this.closeAllEditPopups),this.$panel.on("click",".color-click-area",this.onColorboxShowClick),this.colorbox=new Ve.a({$parent:this.$colorbox_container,type:"small"}),this.colorbox.on("colorchange",this.on_color_or_opacity_changed),this.colorbox.on("opacitychange",this.on_color_or_opacity_changed),this.borderWidthEditParamInput=this.$borderWidthInput.RMNumericInput({min:0,max:999,mouseSpeed:4,onChange:this.on_edit_input_changed}).data("changeValue")},unBindLogic:function(){this.$el.off("click",".resizable-content .item",this.on_icon_click),this.$(".search").off("keyup",this.onSearchKeyUp),this.$(".loupe:not(.preloading)").off("click",this.onLoupeClick),this.model&&this.model.off(null,null,this)},toggleShowMode:function(){var t=this.$panel.find('.edit-item[data-field="tip_show_on"] .switcher').attr("data-active");t="click"==t?"hover":"click";var e=[];this.block.hotspots_group_collection.models.forEach((function(i){e.push({_id:i.get("_id"),tip_show_on:t})})),this.block.workspace.set_group(e)},getEditValue:function(t){return this.model.get(t)},closeAllEditPopups:function(t){t&&Object(u.a)(t.target).closest(".color-click-area").length>0||this.colorbox_visible&&this.closeColorBox()},bind_model_events:function(){this.listenTo(this.model,"change:pin_type",this.apply_type_related_visual_state),this.listenTo(this.model,"change:bg_color change:bg_opacity change:color change:opacity change:borders change:tip_show_on",this.apply_edit_params_visual_state)},on_edit_input_changed:function(t,e){var i=[];this.block.hotspots_group_collection.models.forEach((function(t){i.push({_id:t.get("_id"),borders:e})})),this.block.workspace.set_group(i)},on_color_or_opacity_changed:function(t,e,i,n){var a={};a[this.colorbox_for_field]=this.colorbox.rgb2hex([t,e,i]),a[this.colorbox_for_field_dop]=n;var r=[];this.block.hotspots_group_collection.models.forEach((function(t){r.push(o.a.extend({_id:t.get("_id")},a))})),this.block.workspace.set_group(r),this.needRasterize=!0},onClick:function(){this.selected&&this.colorbox_visible?this.closeAllEditPopups():g.prototype.onClick.apply(this,arguments)},apply_edit_params_visual_state:function(){this.$panel.find('.edit-item[data-field="tip_show_on"] .switcher').attr("data-active",this.getEditValue("tip_show_on")),this.apply_type_related_visual_state(),this.$panel.find('.edit-item[data-field="bg_color"] .color-circle').css("background-color",_.default.getRGBA(this.getEditValue("bg_color"),this.getEditValue("bg_opacity"))),this.$panel.find('.edit-item[data-field="color"] .color-circle').css("background-color",_.default.getRGBA(this.getEditValue("color"),this.getEditValue("opacity"))),this.borderWidthEditParamInput(this.getEditValue("borders"),!0)},apply_type_related_visual_state:function(){var t=this.model.get("pin_type");this.$rectangleIcon.add(this.$circleIcon).removeClass("selected"),"ellipse"===t?(this.$circleIcon.addClass("selected"),this.$bg_color_edit_param.removeClass("hidden"),this.$border_edit_param.removeClass("hidden"),this.$(".icon-item").removeClass("selected")):"icon"===t?(this.$bg_color_edit_param.removeClass("hidden"),this.$border_edit_param.addClass("hidden")):"rectangle"===t&&(this.$rectangleIcon.addClass("selected"),this.$bg_color_edit_param.addClass("hidden"),this.$border_edit_param.addClass("hidden"),this.$(".icon-item").removeClass("selected"));var e=this.$(".params-wrapper"),i=0;e.children(".edit-item").filter(":not(.hidden)").each((function(){i+=Object(u.a)(this).height()})),e.height(i),this.$(".resizable-scroll-wrapper").height("calc(100% - "+i+"px)"),this.__scrollRecalc_debounced()},onSearchKeyUp:function(t){t.keyCode===u.a.keycodes.enter&&this.doSearch()},onLoupeClick:function(t){this.$(".loupe").hasClass("clear")?this.clearSearch():this.doSearch()},doSearch:function(){var t=this.$(".search").val().trim();t&&this.search_string!=t&&!this.requestInProgress&&(this.search_string=t,this.$result.find(".icon-item").remove(),delete window.prevSVGSearch,this.$(".loupe").addClass("clear"),this.nextPage=1,this.getDataPage(this.nextPage))},clearSearch:function(){this.$(".loupe").removeClass("clear"),delete window.prevSVGSearch,this.$(".search").val(""),this.search_string="",this.$result.find(".icon-item").remove(),this.getDefaultIconsCollection()},getDataPage:function(t){var e;this.search_string&&!this.requestInProgress&&(e="/icons/"+this.search_string+"?page="+t,this.LIMIT_TO_PUBLIC_DOMAIN&&(e+="&limit_to_public_domain=1"),this.requestIcons(e,function(t,e){t?delete this.nextPage:(window.prevSVGSearch=window.prevSVGSearch||{icons:[]},window.prevSVGSearch.icons=window.prevSVGSearch.icons.concat(e.icons),window.prevSVGSearch.phrase=this.search_string,window.prevSVGSearch.nextPage=this.nextPage,this.drawSearchResults(e))}.bind(this)))},requestIcons:function(t,e){this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!0,this.showSearchPreloader(),this.searchXhr=u.a.ajax({method:"GET",url:this.API_URL+encodeURIComponent(t),dataType:"json",success:function(t){e(null,t)},error:function(t){e(t)},complete:function(){this.searchInProgress=!1,this.hideSearchPreloader()}.bind(this),context:this})},getDefaultIconsCollection:function(){this.drawSearchResults(this.defaultIconsCollection)},drawSearchResults:function(t){o.a.isArray(t.icons)&&t.icons.length?(o.a.each(t.icons,function(t){this.$result.append(this.templateItem({icon:t}))}.bind(this)),this.__scrollRecalc_debounced()):delete this.nextPage},select:function(){g.prototype.select.apply(this,arguments),o.a.delay(function(){this.$(".search").focus().select()}.bind(this),400)},save:function(){this.block.workspace.save_group(this.block.hotspots_group_collection.models),this.needRasterize&&(this.block.rasterize_icon_SVG(),delete this.needRasterize),g.prototype.save.apply(this,arguments)},on_icon_click:function(t){if(!this.$(".resizable-content").hasClass("preloading")){this.$(".resizable-content .item").removeClass("selected");var e,i,n=Object(u.a)(t.currentTarget),a=[];if(!n.hasClass("selected")&&(n.hasClass("icon-item")&&(e="icon"),n.hasClass("circle-icon")&&(e="ellipse"),n.hasClass("rectangle-icon")&&(e="rectangle"),"ellipse"!=e&&"rectangle"!=e||(n.addClass("selected"),this.block.icon_XHR&&this.block.icon_XHR.abort(),i={pin_type:e,noun_url:null,noun_id:null,rm_id:null},this.block.hotspots_group_collection.models.forEach((function(t){var n={};if("ellipse"==e){var r=t.get("x"),s=t.get("w"),l=t.get("h"),c=Math.floor((s-l)/2);n.w=l,n.x=r+c}a.push(o.a.extend({_id:t.get("_id")},i,n))})),this.block.workspace.set_group(a)),"icon"==e)){var r=n.find(".noun-icon"),s=r.attr("data-id"),l=r.attr("data-rm_id"),c=r.attr("data-url");this.hideIconPreloader(),this.showIconPreloader(n),this.block.get_icon_SVG(s||l,c,function(t,e){if(this.hideIconPreloader(),!t){n.addClass("selected"),i={pin_type:"icon",noun_url:c,noun_id:s||null,rm_id:l||null},this.block.render_pin_shape({pin_type:"icon"});var r=this.block.adjust_box_to_icon(),d=r.x-this.model.get("x"),h=r.y-this.model.get("y");this.block.hotspots_group_collection.models.forEach(function(t){a.push(o.a.extend({_id:t.get("_id")},i,r,{x:t.get("x")+d,y:t.get("y")+h}))}.bind(this)),this.block.workspace.set_group(a),this.needRasterize=!0}}.bind(this))}}},onColorboxShowClick:function(t){var e=Object(u.a)(t.currentTarget),i=e.attr("data-field"),n=e.attr("data-field-dop"),o=200;if(this.colorbox_visible){if(i==this.colorbox_for_field)return void this.closeColorBox();this.closeColorBox(!0),o=0}this.closeAllEditPopups(),this.colorbox_visible=!0,"bg_color"!==i&&"color"!==i||("color"===i?this.$colorbox_container.css({top:e.parent(".edit-item").position().top-this.$colorbox_container.height()+this.$panel.find(".resizable-content-wrapper").height()+this.$panel.find(".common-wrapper").position().top+"px"}):this.$colorbox_container.css({top:e.position().top-this.$colorbox_container.height()+this.$panel.find(".resizable-content-wrapper").height()+this.$panel.find(".common-wrapper").position().top+"px"})),this.$colorbox_container.fadeIn(o),this.colorbox_for_field=i,this.colorbox_for_field_dop=n,this.colorbox.setOpacity(this.getEditValue(n)),this.colorbox.setColor(this.getEditValue(i))},closeColorBox:function(t){this.colorbox_visible=!1,this.$colorbox_container.fadeOut(t?0:200)},onPanelScroll:function(t){this.selected&&t.content_size-t.container_size-t.scroll_pos<32&&this.nextPage&&!this.searchInProgress&&this.getDataPage(++this.nextPage)},abortRequests:function(){this.searchXhr&&this.searchXhr.abort(),this.searchInProgress=!1},showSearchPreloader:function(){this.$(".loupe").addClass("preloading")},hideSearchPreloader:function(){this.$(".loupe").removeClass("preloading")},showIconPreloader:function(t){t.append(Object(u.a)('<div class="rmpreloader"><div class="arc"></div></div>')),this.$(".resizable-content").add(t).addClass("preloading")},hideIconPreloader:function(t){this.$(".resizable-content").find(".rmpreloader").remove(),this.$(".resizable-content").add(this.$(".icon-item")).removeClass("preloading")},canControlBeClosed:function(){return this.colorbox_visible?(this.closeAllEditPopups(),!0):a.a.prototype.canControlBeClosed.apply(this,arguments)},deselect:function(){this.closeAllEditPopups(),a.a.prototype.deselect.apply(this,arguments)},destroy:function(){this.abortRequests(),g.prototype.destroy.apply(this,arguments)}});fn.prototype.defaultIconsCollection={icons:[{rm_id:"rm36",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/36-circle-2.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/36-circle-2.svg")},{rm_id:"rm37",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/37-circle-3.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/37-circle-3.svg")},{rm_id:"rm38",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/38-circle-exclamation.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/38-circle-exclamation.svg")},{rm_id:"rm39",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/39-circle-plus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/39-circle-plus.svg")},{rm_id:"rm40",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/40-circle-question.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/40-circle-question.svg")},{rm_id:"rm41",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/41-info-grotesk.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/41-info-grotesk.svg")},{rm_id:"rm42",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/42-info-monospace.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/42-info-monospace.svg")},{rm_id:"rm43",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/43-circle-plus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/43-circle-plus.svg")},{rm_id:"rm0",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/00-dots-vertical.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/00-dots-vertical.svg")},{rm_id:"rm1",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/01-dots-horizontal.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/01-dots-horizontal.svg")},{rm_id:"rm2",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/02-align-left.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/02-align-left.svg")},{rm_id:"rm3",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/03-minus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/03-minus.svg")},{rm_id:"rm4",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/04-sandwich-two-lines.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/04-sandwich-two-lines.svg")},{rm_id:"rm5",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/05-sandwich-three-lines.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/05-sandwich-three-lines.svg")},{rm_id:"rm6",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/06-plus.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/06-plus.svg")},{rm_id:"rm7",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/07-checkbox.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/07-checkbox.svg")},{rm_id:"rm8",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/08-delete.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/08-delete.svg")},{rm_id:"rm9",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/09-arrow-1.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/09-arrow-1.svg")},{rm_id:"rm10",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/10-arrow-2.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/10-arrow-2.svg")},{rm_id:"rm11",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/11-arrow-3.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/11-arrow-3.svg")},{rm_id:"rm12",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/12-edit-thin.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/12-edit-thin.svg")},{rm_id:"rm13",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/13-edit-thick.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/13-edit-thick.svg")},{rm_id:"rm14",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/14-file.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/14-file.svg")},{rm_id:"rm15",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/15-flag.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/15-flag.svg")},{rm_id:"rm16",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/16-geolocation.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/16-geolocation.svg")},{rm_id:"rm17",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/17-geopin.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/17-geopin.svg")},{rm_id:"rm18",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/18-star.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/18-star.svg")},{rm_id:"rm19",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/19-heart.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/19-heart.svg")},{rm_id:"rm20",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/20-bag.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/20-bag.svg")},{rm_id:"rm21",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/21-user.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/21-user.svg")},{rm_id:"rm22",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/22-eye.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/22-eye.svg")},{rm_id:"rm23",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/23-lock.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/23-lock.svg")},{rm_id:"rm24",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/24-instacamera.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/24-instacamera.svg")},{rm_id:"rm25",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/25-camera.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/25-camera.svg")},{rm_id:"rm26",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/26-lightning.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/26-lightning.svg")},{rm_id:"rm27",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/27-play.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/27-play.svg")},{rm_id:"rm28",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/28-video.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/28-video.svg")},{rm_id:"rm29",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/29-pause.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/29-pause.svg")},{rm_id:"rm30",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/30-music-note.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/30-music-note.svg")},{rm_id:"rm31",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/31-sound-on.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/31-sound-on.svg")},{rm_id:"rm32",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/32-sound-off.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/32-sound-off.svg")},{rm_id:"rm33",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/33-mobile.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/33-mobile.svg")},{rm_id:"rm34",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/34-desktop.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/34-desktop.svg")},{rm_id:"rm35",icon_url:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/35-monitor.svg"),preview_url_42:Object(qt.findImagePath)("./constructor/blocks/hotspot/default-collection/35-monitor.svg")}]};var vn=fn,bn=i("s0L4"),yn=i.n(bn),_n=a.a.extend({name:"hotspot_tip_settings",className:"control hotspot_tip_settings",saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(t){this.template=yn.a["template-constructor-control-hotspot-tip-settings"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.apply_edit_params_visual_state.__debounced=o.a.debounce(this.apply_edit_params_visual_state,20),this.bind_model_events()},bindLogic:function(){this.$colorbox_container=this.$(".colorbox_container"),this.$border_radius_param=this.$panel.find('.edit-wrapper .edit-item[data-field="tip_border-radius"]'),this.$shadow_param=this.$panel.find('.edit-wrapper .edit-item[data-field="tip_box-shadow"]'),this.$position_param=this.$panel.find('.edit-item[data-field="tip_pos"]'),this.$panel.on("click",".edit-wrapper",this.close_all_edit_popups),this.$position_param.find(".position").on("click",this.on_position_click),this.$panel.on("click",".edit-wrapper .color-click-area",this.on_colorbox_show_click),this.colorbox=new Ve.a({$parent:this.$colorbox_container,type:"small"}),this.colorbox.on("colorchange",this.color_opacity_changed),this.colorbox.on("opacitychange",this.color_opacity_changed),this.border_radius_edit_param_input=Object(u.a)(this.$border_radius_param.find("input")).RMNumericInput({min:0,max:999,mouseSpeed:4,onChange:this.on_edit_input_changed}).data("changeValue"),this.shadow_switcher=Object(u.a)(this.$shadow_param.find(".switcher")).RMSwitcher({state:this.model.get("tip_box-shadow"),width:50,height:28,"text-size-0":12,"text-size-1":12,"color-0":"#0078ff"},function(t){o.a.delay(function(){this.model.set("tip_box-shadow",t)}.bind(this),300)}.bind(this)).data("switcher"),this.apply_edit_params_visual_state(),this.apply_tip_position_param_visual_state(),this.bind_model_events()},unBindLogic:function(){},on_position_click:function(t){var e=Object(u.a)(t.currentTarget).data("position");this.model.set("tip_pos",e)},on_edit_input_changed:function(t,e){var i={};i[t.closest(".edit-item").attr("data-field")]=e,this.model.set(i),this.adjust_inputs_padding()},adjust_inputs_padding:function(){for(var t=["tip_border-radius"],e=0;e<t.length;e++){var i=this.$panel.find('.edit-wrapper .edit-item[data-field="'+t[e]+'"] input'),n=i.val();i.toggleClass("extra-padding-for-one-symbol",1===n.length),i.toggleClass("extra-padding-for-two-symbols",2===n.length)}},bind_model_events:function(){var t=["tip_pos","tip_background-color","tip_background-color-opacity","tip_border-radius"];t.forEach((function(t,e,i){i[e]="change:"+t})),t=t.join(" "),this.listenTo(this.model,t,this.apply_edit_params_visual_state),this.listenTo(this.model,"change:tip_pos",this.apply_tip_position_param_visual_state)},apply_edit_params_visual_state:function(){this.$panel.find(".edit-wrapper").find('.edit-item[data-field="tip_background-color"] .color-circle').css("background-color",_.default.getRGBA(this.get_edit_value("tip_background-color"),this.get_edit_value("tip_background-color-opacity")/100)),this.border_radius_edit_param_input(this.get_edit_value("tip_border-radius"),!0),this.adjust_inputs_padding()},apply_tip_position_param_visual_state:function(){this.$position_param.find(".current").removeClass("current"),this.$position_param.find("."+this.model.get("tip_pos")).addClass("current")},get_edit_value:function(t){return this.model.get(t)},on_colorbox_show_click:function(t){var e=Object(u.a)(t.currentTarget),i=e.attr("data-field"),n=e.attr("data-field-dop"),o=200;if(this.colorbox_visible){if(i===this.colorbox_for_field)return void this.close_colorbox();this.close_colorbox(!0),o=0}this.close_all_edit_popups(),this.colorbox_visible=!0,this.$colorbox_container.css({top:e.position().top+e.height()+"px"}),this.$colorbox_container.fadeIn(o),this.colorbox_for_field=i,this.colorbox_for_field_dop=n,this.colorbox.setOpacity(this.get_edit_value(n)/100),this.colorbox.setColor(this.get_edit_value(i))},close_colorbox:function(t){this.colorbox_visible=!1,this.$colorbox_container.fadeOut(t?0:200)},color_opacity_changed:function(t,e,i,n){o.a.clone(this.model.attributes);var a=this.colorbox.rgb2hex([t,e,i]),r=100*n,s={};s[this.colorbox_for_field]=a,s[this.colorbox_for_field_dop]=r,this.model.set(s)},onClick:function(){this.selected&&this.colorbox_visible?this.close_all_edit_popups():a.a.prototype.onClick.apply(this,arguments)},close_all_edit_popups:function(t){t&&Object(u.a)(t.target).closest(".color-click-area").length>0||this.colorbox_visible&&this.close_colorbox()},select:function(){a.a.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-button_settings")}))},deselect:function(){this.close_all_edit_popups(),a.a.prototype.deselect.apply(this,arguments)},canControlBeClosed:function(){return this.colorbox_visible?(this.close_all_edit_popups(),!0):a.a.prototype.canControlBeClosed.apply(this,arguments)},save:function(){this.model.save()},destroy:function(t){a.a.prototype.destroy.apply(this,arguments)}}),wn=i("xka6"),kn=i.n(wn),Sn={text:"Text",number:"Number",name:"Name",email:"Email",phone:"Phone number",dropdown:"Dropdown",dropdownEditMode:"Edit dropdown",submit:"Text",textAfterSubmit:"Text after submit",toUrlAfterSubmit:"URL",toPageAfterSubmit:"Jump to page",option:"Edit option",checkbox:"Checkbox",file:"File"},xn=function(t,e){return!e||Cn(t,e)?null:e},Cn=function(t,e){var i=e&&e.toLowerCase(),n=i===On(t).toLowerCase();return"dropdown"!==t&&"dropdownEditMode"!==t||(n=i===On("dropdown").toLowerCase()||i===On("dropdownEditMode").toLowerCase()),n||i==="Field Text".toLowerCase()},On=function(t){return Sn[t]||"Field Text"},jn=function(t,e){var i=o.a.debounce(t,e||300);return function(e){13===e.keyCode?(t(e),Object(u.a)(e.target).blur()):i(e)}},Pn=g.prototype,En=g.extend({name:"form_content",className:"control form_content",events:{"click .js-panel":"onPanelClick","click .js-add":"onAddClick","click .js-field-type":"onFieldTypeClick","click .js-submit-field-type":"onSubmitFieldClick","click .js-dropdown-trigger":"onDropdownTriggerClick","click .js-settings-trigger":"onSettingsTriggerClick","click .js-delete-field":"onDeleteFieldClick","keydown .js-field-caption":"onFieldCaptionKeydown","click .js-submit-dropdown-trigger":"onSubmitArrowClick","click .action-icon:not(.remove-icon)":"onActionIconClick","click .remove-icon":"onRemoveIconClick","click .search-wrapper .placeholder-selector .placeholder-item":"clickPlaceholder","focus .form-fields-caption-submitAfter.toPageAfterSubmit ":"changeAfterSubmitToPageInput","focusout .form-fields-caption-submitAfter.toPageAfterSubmit ":"changeAfterSubmitToPageInput","click .form-fields-item .type-switcher":"changeCaptchaType"},MIN_PANEL_HEIGHT:350,MAX_PANEL_HEIGHT:504,SCROLL_GAP_START:4,SCROLL_GAP_END:4,FIELD_TYPES:{text:"Text",number:"Number",name:"Name",email:"Email",phone:"Phone Number",dropdown:"Dropdown",checkbox:"Checkbox",file:"File"},SUBMIT_FIELD_TYPES:{textAfterSubmit:"Text after submit",toUrlAfterSubmit:"Website URL",toPageAfterSubmit:"Jump to Page"},SUBMIT_MODES:{textAfterSubmit:"textAfterSubmit",toUrlAfterSubmit:"toUrlAfterSubmit",toPageAfterSubmit:"toPageAfterSubmit"},PAGE_AFTER_SUBMIT_SHORT_PLACEHOLDER:"Jump to p.",saveOnDestroy:!0,saveOnDeselect:!0,idMap:{},dropdownPanels:{},dropdownModels:[],initialize:function(t){this.template=kn.a["template-constructor-control-form_content"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,RM.constructorRouter.me.get("permissions").can_use_forms_file_upload||(this.FIELD_TYPES.file="File (Pro plan only)"),o.a.bindAll(this)},bindLogic:function(){this.listenTo(this.model,"field:add",this.onFieldsChange),this.listenTo(this.model,"field:delete",this.onFieldsChange),this.listenTo(this.model,"field:tp:change",this.onFieldTypeChange),this.listenTo(this.model,"field:caption:change",this.onFieldCaptionChange),this.updateCaptionDebounced=jn(this.updateCaption.bind(this),300)},unBindLogic:function(){this.stopListening(this.model)},render:function(){Pn.render.apply(this,arguments),this.$content=Object(u.a)(this.$el.find(".js-fields-container")),this.$settingsPopupContainer=this.$el.find(".js-settings-popup-container"),this.$dropdownPanelContainer=this.$el.find(".js-dropdown-panel-container"),this.$addBlock=this.$el.find(".js-add-block"),this.$scrollable=this.$el.find(".resizable-content-wrapper"),this.$content.sortable({items:".js-sortable",distance:10,axis:"y",scrollSpeed:10,containment:"parent",tolerance:"pointer",start:this.onSortStart.bind(this),stop:this.onSortEnd.bind(this)}),this.renderContent(),this.updatePanelHeight(this.MIN_PANEL_HEIGHT),this.$addBlock.append(this.buildSettingsPopup({edit:!1})),this.$addSettingsPopup=this.$el.find(".js-add-settings"),this.$submitPopup=this.$el.find(".submit-wrapper"),this.isPageMode()&&this.changeAfterSubmitToPageInput()},select:function(){Pn.select.apply(this,arguments),this.resizeToFit()},renderContent:function(){this.$content.empty().append(this.renderFields()),this.refreshSort(),this.resizableScroll&&this.resizableScroll.recalc(),this.renderFieldSettingsPopups(),this.$addBlock.append(this.renderSubmitPopup()),this.$dropdownPanelContainer.empty().append(this.renderDropdowns())},renderFields:function(){var t=Object(u.a)(document.createDocumentFragment());this.idMap={},o.a.each(this.model.get("fields"),function(e,i,n){var a="field-"+_.default.generateUUID();this.idMap[e.sort]=a;var r=this.renderField(o.a.extend({id:a,isOnly:1===n.length},e));t.append(r)}.bind(this)),t.append('<div class="button-header">Button</div>');var e=this.renderField({id:null,caption:this.model.get("button-caption"),tp:"submit"});t.append(e);var i=this.renderField({id:null,caption:this.model.get("button_caption_after_submit"),tp:"submitAfter"});return t.append(i),t},renderField:function(t){return(0,kn.a["template-constructor-control-form_content-field"])({tp:t.tp,typeLetter:"number"===t.tp?"№":t.tp[0],text:xn("submitAfter"===t.tp?this.model.get("submit_mode"):t.tp,t.caption),type:t.type,sort:t.sort,id:t.id,placeholder:On("submitAfter"===t.tp?this.model.get("submit_mode"):t.tp),showSettings:"submit"!==t.tp&&"submitAfter"!==t.tp,showDelete:"submit"!==t.tp&&!t.isOnly&&"submitAfter"!==t.tp,isSortable:"submit"!==t.tp&&"submitAfter"!==t.tp,showSubmitAfterArrow:"submitAfter"===t.tp,mode:"submitAfter"===t.tp?this.model.get("submit_mode"):"",showRemoveArrow:this.model.get("submit_mode")!==this.SUBMIT_MODES.textAfterSubmit&&this.model.get("link_after_submit")})},reRenderField:function(t,e){var i=this.model.get("fields"),n=this.getPredicate(t),a=this.getField(n),r=this.$el.find(".js-field[data-id="+t+"]"),s=this.renderField(o.a.extend({id:t,isOnly:1===i.length},a));r.replaceWith(s),this.refreshSort(),"dropdown"!==a.tp&&"dropdown"!==e||this.$dropdownPanelContainer.empty().append(this.renderDropdowns())},buildFieldSettingsPopups:function(){var t=Object(u.a)(document.createDocumentFragment());return o.a.each(this.model.get("fields"),function(e){var i=this.idMap[e.sort],n=this.buildSettingsPopup({showOptionalSwitcher:!0,selectedType:e.tp,edit:!0,optional:e.optional,id:i});t.append(n)}.bind(this)),t},buildSettingsPopup:function(t){var e=this,i=kn.a["template-constructor-control-form_content-settings"];(t=o.a.extend({types:this.FIELD_TYPES,showOptionalSwitcher:!1,selectedType:null,edit:!1,id:null,sort:null,_:o.a},t)).disabledTypes=["file","captcha"].filter((function(t){return e.isFieldExists(t)}));var n=i(t),a=Object(u.a)(n),r=Object(u.a)(a.find(".switcher"));return r.length&&r.RMSwitcher({state:t.optional,height:26,width:44,"color-0":"#0078ff","color-1":"#c9c8c9","text-color-0":"transparent","text-color-1":"transparent",id:t.id},this.onSwitcherChange.bind(this)),a},renderSettingsPopup:function(){var t=this.$addBlock.find(".js-add-settings");t&&t.remove(),this.$addBlock.append(this.buildSettingsPopup({edit:!1})),this.$addSettingsPopup=this.$el.find(".js-add-settings")},renderFieldSettingsPopups:function(){this.$settingsPopupContainer.empty().append(this.buildFieldSettingsPopups())},renderSubmitPopup:function(t){var e=(0,kn.a["template-constructor-control-form_content-after-submit"])(t=o.a.extend({types:this.SUBMIT_FIELD_TYPES,selectedType:this.model.get("submit_mode")||this.SUBMIT_MODES.textAfterSubmit,edit:!1,id:null,sort:null,_:o.a},t));return Object(u.a)(e)},renderDropdowns:function(){var t=Object(u.a)(document.createDocumentFragment()),e=o.a.where(this.model.get("fields"),{tp:"dropdown"});return this.destroyDropdowns(),o.a.each(e,function(e){var i=this.idMap[e.sort],n=this.renderDropdown(e);this.dropdownPanels[i]=n,t.append(n.el)}.bind(this)),t},renderDropdown:function(t){var e=new m.a.Model(o.a.clone(t));this.dropdownModels.push(e),this.listenTo(e,"change:caption",this.onDropdownCaptionChange),this.listenTo(e,"change:items",this.onDropdownItemsChange),this.listenTo(e,"change:height",this.onDropdownHeightChange),this.listenTo(e,"save",this.onDropdownSave);var i=new In({model:e});return i.render(),i},onSortStart:function(){this.hideSettingsPopups(),this.$el.find(":input").blur(),this.$el.addClass("grabbing")},onSortEnd:function(){this.$el.removeClass("grabbing"),this.reorder(),this.$el.find(".js-field").attr("style","")},onScrollRecalc:function(){o.a.each(this.dropdownPanels,(function(t){t.resizableScroll&&t.resizableScroll.recalc()}))},onSwitcherChange:function(t,e){var i=e.settings.id,n=this.getPredicate(i);this.block.changeField(n,{optional:t})},onPanelClick:function(t){Object(u.a)(t.target).closest(".js-settings-trigger, .js-add, .js-settings-popup, .js-submit-dropdown-trigger").length||this.hideSettingsPopups()},onAddClick:function(){this.toggleSettingsPopup(this.$addSettingsPopup)},onFieldTypeClick:function(t){t.stopPropagation();var e=Object(u.a)(t.target).closest(".js-field-type"),i=e.data("value"),n=e.data("action");if("file"!==i&&"captcha"!==i||!this.isFieldExists(i)){if("add"===n)this.addField({tp:i}),this.hideSettingsPopups(),this.scrollToBottom(),this.isPageMode()&&this.changeAfterSubmitToPageInput();else{var o=this.getPredicate(t.target);this.changeFieldType(o,i)}this.renderSettingsPopup(),this.renderFieldSettingsPopups()}},onSubmitFieldClick:function(t){t.stopPropagation();var e=Object(u.a)(event.target).data("value");e!==this.model.get("submit_mode")&&(this.setAfterSubmitMode(e),this.reRenderAfterSubmit(e)),this.hideSettingsPopups()},isFieldExists:function(t){var e=this.model.get("fields");return o.a.find(e,(function(e){return e.tp===t}))},isPageMode:function(){return this.model.get("submit_mode")&&this.model.get("submit_mode")===this.SUBMIT_MODES.toPageAfterSubmit},reRenderAfterSubmit:function(t){var e=this.$el.find(".form-fields-item-submitAfter"),i={tp:"submitAfter",selectedType:t},n=this.renderField(o.a.extend(i));this.$el.find(".js-submit-field-type").removeClass("selected"),this.$el.find(".js-submit-field-type[data-value="+t+"]").addClass("selected"),e.replaceWith(n)},changeAfterSubmitToPageInput:function(t){var e=t?Object(u.a)(t.currentTarget):this.$el.find(".js-field-caption-submitAfter"),i=e.val(),n=this.PAGE_AFTER_SUBMIT_SHORT_PLACEHOLDER,o=-1!==i.indexOf(n)?u.a.trim(i.replace(n,"")):i;-1===i.indexOf(n)&&this.getUrlData(o).result?e.val(n+" "+i):e.val(o)},getUrlData:function(t){var e=this.model.get("submit_mode"),i=RM.constructorRouter.mag,n=Nh.text_link.prototype.getUrlData(t);return t=n.url,n.isValidPageNumber&&(t=i.getPageId(t)),{result:n.isURL&&e===this.SUBMIT_MODES.toUrlAfterSubmit||n.isValidPageNumber&&this.isPageMode(),url:t}},setAfterSubmitMode:function(t){this.model.set("submit_mode",t)},onDropdownTriggerClick:function(t){var e=Object(u.a)(t.target).closest("[data-id]").data("id"),i=this.dropdownPanels[e];this.hideSettingsPopups(),i&&i.show()},onSettingsTriggerClick:function(t){var e=Object(u.a)(t.target),i=e.closest("[data-id]").data("id"),n=this.$el.find(".js-settings-popup[data-id="+i+"]"),o=e.offset().top-this.$scrollable.offset().top+e.height()/2,a=this.$scrollable.height()-o;this.toggleSettingsPopup(n,{bottom:a})},onDeleteFieldClick:function(t){var e=this.getPredicate(t.target);this.deleteField(e),this.renderSettingsPopup(),this.isPageMode()&&this.changeAfterSubmitToPageInput()},onFieldCaptionKeydown:function(t){this.updateCaptionDebounced(t);var e=this.$el.find(".form-fields-placeholder-selector");t&&t.currentTarget&&Object(u.a)(t.currentTarget).hasClass("toPageAfterSubmit")&&e.hasClass("action-icon")&&13===t.keyCode&&this.onActionIconClick()},updateCaption:function(t){var e=Object(u.a)(t.target),i=this.getPredicate(e),n=e.closest(".js-field").data("type"),o=this.model.get("submit_mode"),a=e.val();if("submit"===n)this.changeButton(a||On("submit"));else if("submitAfter"===n)this.changeButtonAfterSubmit(a||""),o!==this.SUBMIT_MODES.textAfterSubmit&&this.updateClasses(a),!this.isPageMode()&&o!==this.SUBMIT_MODES.toUrlAfterSubmit||this.getUrlData(a).result||(this.changeButtonAfterSubmit(""),this.model.set("link_after_submit",""));else{var r=this.getField(i);a=a||On(r.tp),this.block.changeField(i,{caption:a})}},updateClasses:function(t){var e=this.$el.find(".form-fields-placeholder-selector");e.hasClass("remove-icon")&&e.removeClass("remove-icon"),e.toggleClass("js-submit-dropdown-trigger",!this.getUrlData(t).result),e.toggleClass("action-icon",this.getUrlData(t).result)},onActionIconClick:function(){var t=this.$el.find(".form-fields-placeholder-selector"),e=this.model.get("button_caption_after_submit");t.addClass("remove-icon"),this.model.set("link_after_submit",this.getUrlData(e).url)},onRemoveIconClick:function(){var t=this.$el.find(".form-fields-placeholder-selector"),e=this.$el.find(".form-fields-caption-submitAfter");t.removeClass("action-icon remove-icon").addClass("js-submit-dropdown-trigger"),e.val(""),this.changeButtonAfterSubmit(""),this.model.set("link_after_submit","")},onFieldsChange:function(){this.renderContent()},onFieldTypeChange:function(t,e){var i=this.idMap[t.sort],n=this.$el.find(".js-settings-popup[data-id="+i+"]");n.find(".js-field-type").removeClass("selected"),n.find(".js-field-type[data-value="+t.tp+"]").addClass("selected"),this.reRenderField(i,e)},onFieldCaptionChange:function(t){if("dropdown"===t.tp){var e=this.idMap[t.sort];this.$el.find(".js-field[data-id="+e+"]").find(".js-field-caption").val(xn(t.tp,t.caption))}},onDropdownItemsChange:function(t,e){this.block.changeField({sort:t.get("sort")},{items:o.a.clone(e)})},onDropdownHeightChange:function(t){(t>0||t<0&&this.getContentOverflow(t)<=0)&&this.updatePanelHeight(this.$panel.height()+t)},onDropdownCaptionChange:function(t,e){this.block.changeField({sort:t.get("sort")},{caption:e||On("dropdown")})},onDropdownSave:function(t){var e={caption:t.caption,items:o.a.clone(t.items)};this.block.changeField({sort:t.sort},e),this.save()},onPanelScroll:function(){this.hideSettingsPopups()},toggleSettingsPopup:function(t,e){t.is(".shown")?this.hideSettingsPopup(t):this.showSettingsPopup(t,e)},showSettingsPopup:function(t,e){this.hideSettingsPopups(),o.a.isUndefined(e)||(t.css(e),t.removeClass("below"),t[0].getBoundingClientRect().top<0&&t.addClass("below")),t.addClass("shown")},hideSettingsPopup:function(t){t.removeClass("shown")},hideSettingsPopups:function(){this.hideSettingsPopup(this.$el.find(".js-settings-popup"))},hasSettingsPopupsOpen:function(){return Boolean(this.$el.find(".js-settings-popup.shown").length)},onSubmitArrowClick:function(t){var e=Object(u.a)(t.target),i=e.offset().top-this.$scrollable.offset().top+1.5*e.height(),n=this.$scrollable.height()-i;this.toggleSettingsPopup(this.$submitPopup,{bottom:n})},hideDropdownPanels:function(){o.a.each(this.dropdownPanels,(function(t){t.hide()}))},hasDropdownPanelsOpen:function(){return Boolean(o.a.find(this.dropdownPanels,(function(t){return t.isShown()})))},getPredicate:function(t){var e=o.a.isString(t)?t:Object(u.a)(t).closest("[data-id]").data("id"),i=o.a.invert(this.idMap)[e];return{sort:i?parseInt(i):i}},changeCaptchaType:function(t){var e=Object(u.a)(t.target),i=this.getPredicate(e);this.changeField(i,{type:e.data("type")}),e.parent().attr("data-type",e.data("type"))},addField:function(t){var e=o.a.clone(this.model.get("fields")),i=o.a.max(e,"sort").sort||0,n={tp:t.tp,caption:On(t.tp),optional:!1,sort:i+1};"dropdown"===n.tp&&(n.items=this.getDefaultDropdownItems()),"captcha"===n.tp&&(n.type="light"),e.push(n),this.model.set("fields",e),RM.analytics&&RM.analytics.sendEvent("Form widget","Add field:"+t.tp),this.model.trigger("field:add",n),o.a.defer(function(){this.block.trigger("resize")}.bind(this))},changeField:function(t,e){var i=o.a.clone(this.model.get("fields")),n=o.a.findIndex(i,t),a=i[n],r={};o.a.each(e,(function(t,e){r[e]=o.a.clone(a[e])})),null===(a=o.a.extend(o.a.clone(a),e)).items&&delete a.items,i[n]=a,this.model.set("fields",i),o.a.each(e,function(t,e){this.model.trigger("field:"+e+":change",a,r[e])}.bind(this)),this.model.trigger("field:change",a)},changeFieldType:function(t,e){var i=this.getField(t);if(i&&i.tp!==e){var n={tp:e};Cn(i.tp,i.caption)&&(n.caption=On(e)),"captcha"===e?n.type="light":"captcha"===i.tp&&(n.type=null),"dropdown"===e?n.items=this.getDefaultDropdownItems():"dropdown"===i.tp&&(n.items=null),RM.analytics&&RM.analytics.sendEvent("Form widget","Change field type:"+i.tp+"->"+e),this.block.changeField(t,n)}},getField:function(t){var e=o.a.find(this.model.get("fields"),t);return e?o.a.clone(e):e},getDefaultDropdownItems:function(){return[On("option"),On("option")]},changeButton:function(t){this.model.set("button-caption",t)},changeButtonAfterSubmit:function(t){this.model.set("button_caption_after_submit",t)},deleteField:function(t){var e=this.model.get("fields");e.length>1&&(e=o.a.reject(e,t),this.model.set("fields",e),this.model.trigger("field:delete",t))},reorder:function(){var t=[],e={};o.a.each(this.$content.find(".js-sortable"),function(i,n){var o=this.getPredicate(i),a=this.getField(o);e[n]=this.idMap[a.sort],a.sort=n,t.push(a)}.bind(this)),this.model.set("fields",t),this.idMap=e,this.$dropdownPanelContainer.empty().append(this.renderDropdowns()),this.model.trigger("fields:reorder")},refreshSort:function(){Object(u.a)(this.$content).sortable("refresh")},scrollToBottom:function(){this.$scrollable.animate({scrollTop:this.$content.height()-this.$scrollable.height()})},getContentOverflow:function(t){return this.$content.height()-(this.$content.parent().height()+(t||0))},resizeToFit:function(){var t=[];t.push(this.getContentOverflow()),o.a.each(this.dropdownPanels,(function(e){t.push(e.getContentOverflow())}));var e=Math.max.apply(null,t);this.updatePanelHeight(this.$panel.height()+e)},canControlBeClosed:function(){return this.hasSettingsPopupsOpen()?(this.hideSettingsPopups(),!0):Pn.canControlBeClosed.apply(this,arguments)},save:function(){this.model.save({})},destroyDropdowns:function(){o.a.each(this.dropdownPanels,(function(t){t.destroy()})),this.dropdownPanels={},o.a.each(this.dropdownModels,function(t){this.stopListening(t)}.bind(this)),this.dropdownModels=[]},destroy:function(){this.destroyDropdowns(),Pn.destroy.apply(this,arguments)}}),In=m.a.View.extend({SCROLL_GAP_START:4,SCROLL_GAP_END:4,originalState:null,events:{"click .js-add-option":"onAddOptionClick","click .js-delete-option":"onDeleteOptionClick","click .js-cancel-dropdown":"onCancelDropdownClick","click .js-save-dropdown":"onSaveDropdownClick","keydown .js-dropdown-caption":"onCaptionKeydown","keydown .js-dropdown-option-value":"onOptionKeydown"},initialize:function(t){this.model=t.model,this.template=kn.a["template-constructor-control-form_content-dropdown"]},rememberState:function(){var t=this.model.attributes;this.originalState=JSON.parse(JSON.stringify(t))},render:function(){var t=this.template();return this.setElement(t),this.$scrollable=this.$el.find(".resizable-content-wrapper"),this.$content=this.$el.find(".js-dropdown-content"),this.$captionContainer=this.$el.find(".js-dropdown-caption-container"),this.$optionsContainer=Object(u.a)(this.$el.find(".js-dropdown-options-container")),this.resizableScroll=Object(u.a)(this.$el.find(".resizable-scroll-wrapper")).RMScroll({$container:this.$el.find(".resizable-content-wrapper"),$content:this.$el.find(".resizable-content"),$handle:this.$el.find(".resizable-scroll"),wheelScrollSpeed:.4,gap_start:this.SCROLL_GAP_START,gap_end:this.SCROLL_GAP_END}).data("scroll"),this.$optionsContainer.sortable({items:".js-sortable",distance:10,axis:"y",scrollSpeed:10,containment:"parent",tolerance:"pointer",start:this.onSortStart.bind(this),stop:this.onSortEnd.bind(this)}),this.renderContent(),this.bindLogic(),this},renderContent:function(){this.$captionContainer.empty().append(this.renderCaption()),this.$optionsContainer.empty().append(this.renderDropdownOptions()),this.refreshSort(),this.resizableScroll&&this.resizableScroll.recalc()},renderCaption:function(){var t=kn.a["template-constructor-control-form_content-dropdown-caption"],e=this.model.get("caption");return t({text:xn("dropdownEditMode",e),placeholder:On("dropdownEditMode")})},renderDropdownOptions:function(){var t=Object(u.a)(document.createDocumentFragment()),e=kn.a["template-constructor-control-form_content-dropdown-option"];return o.a.each(this.model.get("items"),function(i,n,o){var a=e({text:xn("option",i),number:n+1,placeholder:On("option"),showDelete:o.length>1});t.append(a)}.bind(this)),t},bindLogic:function(){this.listenTo(this.model,"item:add",this.onModelChange),this.listenTo(this.model,"item:delete",this.onModelChange),this.listenTo(this.model,"revert",this.onModelChange),this.listenTo(this.model,"reorder",this.onModelChange),this.updateCaptionDebounced=jn(this.updateCaption.bind(this),300),this.updateOptionDebounced=jn(this.updateOption.bind(this),300)},unbindLogic:function(){this.stopListening(this.model)},refreshSort:function(){Object(u.a)(this.$optionsContainer).sortable("refresh")},onSortStart:function(){this.$el.find(":input").blur(),this.$el.addClass("grabbing")},onSortEnd:function(){this.$el.removeClass("grabbing"),this.reorder(),this.$el.find(".js-dropdown-option").attr("style","")},onAddOptionClick:function(){this.addOption(),this.$el.find(".js-dropdown-option-value:last").focus();var t=this.getContentOverflow();t>0&&this.model.trigger("change:height",t),this.scrollToBottom()},onDeleteOptionClick:function(t){var e=Object(u.a)(t.target).closest("[data-number]").data("number"),i=e?parseInt(e)-1:-1;this.deleteOption(i)},onCancelDropdownClick:function(){this.revert(),this.hide()},onSaveDropdownClick:function(){this.save(),this.hide()},onCaptionKeydown:function(t){this.updateCaptionDebounced(t)},onOptionKeydown:function(t){this.updateOptionDebounced(t)},updateCaption:function(t){var e=Object(u.a)(t.target).val()||On("dropdown");this.model.set("caption",e)},updateOption:function(t){var e=Object(u.a)(t.target),i=e.val(),n=parseInt(e.data("number"))-1,a=o.a.clone(this.model.get("items"));a[n]=i||On("option"),this.model.set("items",a)},onModelChange:function(){this.renderContent()},addOption:function(){var t=o.a.clone(this.model.get("items")),e=On("option");t.push(e),this.model.set("items",t),this.model.trigger("item:add",e)},deleteOption:function(t){var e=o.a.clone(this.model.get("items"));e.splice(t,1),this.model.set("items",e),this.model.trigger("item:delete",t)},reorder:function(){var t=[],e=this.model.get("items");o.a.each(this.$optionsContainer.find(".js-sortable"),(function(i){var n=parseInt(Object(u.a)(i).data("number")),o=e[n-1];t.push(o)})),this.model.set("items",t),this.model.trigger("reorder")},scrollToBottom:function(){this.$scrollable.animate({scrollTop:this.$content.height()-this.$scrollable.height()})},getContentOverflow:function(t){return this.$content.height()-(this.$content.parent().height()+(t||0))},isShown:function(){return this.$el.is(".shown")},show:function(){this.$el.addClass("shown"),this.rememberState()},hide:function(){this.$el.removeClass("shown")},save:function(){this.model.trigger("save",this.model.attributes)},revert:function(){this.model.set("caption",this.originalState.caption),this.model.set("items",o.a.clone(this.originalState.items)),this.model.trigger("revert")},destroy:function(){this.unbindLogic()}}),Tn=En,Mn=i("HwbM"),$n=i.n(Mn),An=a.a.extend({name:"form_captcha",className:"control form_captcha",initialize:function(t){this.template=$n.a["template-constructor-control-form_captcha"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},render:function(){a.a.prototype.render.apply(this,arguments),this.updateState()},bindLogic:function(){o.a.each(this.models,function(t){this.listenTo(t,"change:captcha",this.onCaptchaChange)}.bind(this))},unBindLogic:function(){o.a.each(this.models,function(t){this.stopListening(t,"change:captcha")}.bind(this))},onClick:function(){if(!this.isOnClickDisabled()){var t=!this.models[0].get("captcha"),e=o.a.map(this.models,(function(e){return{_id:e.id,captcha:t}}));this.master.workspace.save_group(e)}},onCaptchaChange:function(){this.updateState()},updateState:function(){var t=o.a.any(this.models,(function(t){return t.get("captcha")}));this.$el.toggleClass("checked",t),this.$(".icon").attr("data-alt",t?"Turn off captcha":"Turn on captcha")}}),Rn=i("tzyo"),Dn=i.n(Rn),Bn=a.a.prototype,Ln=a.a.extend({name:"form_endpoints",className:"control form_endpoints",events:{"click .connect-button:not(.disabled)":"onConnectButtonClick","click .action-icon":"onActionIconClick","input .reach-input":"onReachInputChange","change .list-select":"onListSelectChange","click .try-another":"tryAnotherClick","click .change-email":"changeEmailClick","click .cancel":"cancelRequestClick","click .resend":"resendCodeClick","click .back":"backClick","change .choice-email":"onEmailsSelectChange"},saveOnDeselect:!0,saveOnDestroy:!0,GOOGLE_DEFAULT_SHEET_NAME:"New Form",FILES_DEFAULT_FOLDER_NAME:"Folder",initialize:function(t){this.template=Dn.a["template-constructor-control-form_endpoints"],this.listOptionsTemplate=Dn.a["template-constructor-control-form_endpoints-list-selector"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.switchers={}},render:function(){var t=[],e=RM.constructorRouter.me.get("additionalEmails");e&&e.length>0&&(e.forEach((function(e){!0===e.confirmed&&t.push(e)})),this.model.set("endpoint_additonal_emails",t)),Bn.render.apply(this,arguments),this.createSwitchers(),this.$confirmationView=this.$(".panel-section.second_email .confirmation"),this.$emailNew=this.$(".panel-section.second_email .new-email"),this.$inputWrapper=this.$(".panel-section.second_email .input-wrapper"),this.$selectWrapper=this.$(".panel-section.second_email .choice-email"),this.$changeEmail=this.$(".panel-section.second_email .change-email"),this.$(".current-email").text(RM.constructorRouter.me.get("email"));var i=this.$(".input-sheet-name"),n=this.getEndpointParam("google","sheet_name");n&&(i.val(n),this.setReachInputIcon(i,"remove-icon"));var o=this.$(".input-custom-url"),a=this.getEndpointParam("url","custom_url")||"";o.val(a),this.setReachInputIcon(o,a?"remove-icon":"hidden");var r=this.$(".input-dropbox-folder-name");this.dropboxFolderName=this.getEndpointParam("dropbox","folder_name")||(RM.constructorRouter.mag.get("title")?RM.constructorRouter.mag.get("title"):this.FILES_DEFAULT_FOLDER_NAME),r.val(this.dropboxFolderName),this.setReachInputIcon(r,"remove-icon");var s=this.$(".input-googledrive-folder-name");this.googledriveFolderName=this.getEndpointParam("googledrive","folder_name")||(RM.constructorRouter.mag.get("title")?RM.constructorRouter.mag.get("title"):this.FILES_DEFAULT_FOLDER_NAME),s.val(this.googledriveFolderName),this.setReachInputIcon(s,"remove-icon"),this.$panel=this.$(".panel"),RM.constructorRouter.mag.get("shared")&&this.$el.addClass("disabled no-hover"),this.setEmailsView(),Object(u.a)(window).on("resize",this.updateSwitchers)},renderListOptions:function(t,e){this.$(".list-select").html(this.listOptionsTemplate({lists:t,selected:e,_:o.a}))},setEndpointParam:function(t,e,i,n){var a,r="endpoint_"+t,s=this.model.get(r)||{},l={};if("google"===t&&"sheet_name"===e&&i!==s.sheet_name&&delete s.sheet_id,l[e]=i,"additonal_emails"===t)return(a=o.a.isEmpty(s)?[]:s).push(l),void this.model.set(r,a);this.model.set(r,o.a.extend({},s,l),n)},getEndpointParam:function(t,e){var i="endpoint_"+t;return(this.model.get(i)||{})[e]},onReachInputChange:function(t){var e=t instanceof u.a?t:Object(u.a)(t.currentTarget),i=e.val().trim();this.setReachInputIcon(e,i&&this.validateInput(e)?"apply-icon":"hidden")},validateInput:function(t){var e=t.val().trim(),i=t.attr("data-provider");return"url"===i?/http(s?):\/\/.+/i.test(e):"second_email"===i?/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e):"confirmation-code"!==i||4===e.length&&!isNaN(e)},setReachInputIcon:function(t,e){t.closest(".input-wrapper").find(".action-icon").removeClass(["apply-icon","remove-icon","preloader-icon","hidden"].join(" ")).addClass(e)},checkPanelPosition:function(t){if(Object(u.a)(".control.form_endpoints").hasClass("checked")){var e=Object(u.a)(".panel."+t).outerHeight();Object(u.a)(window).height()<=768&&e>=450&&Object(u.a)(".panel").css({top:-Math.round(e/2.3)}),e<450&&Object(u.a)(".panel").css({top:-149})}},createSwitchers:function(){var t=this.$(".switcher"),e=["google","mailchimp","dropbox"];o.a.each(t,function(t){var i=Object(u.a)(t),n=i.attr("data-provider");this.switchers[n]=i.RMSwitcher({state:!1,height:26,width:44,"color-0":"#0078ff","color-1":"#c9c8c9","text-color-0":"transparent","text-color-1":"transparent"},this.getSwitcherHandler(n)).data("switcher"),o.a.contains(e,n)&&this.checkAccountConnected(n)}.bind(this)),this.updateState()},getSwitcherHandler:function(t){return function(e){o.a.delay(function(){this.setEndpointParam(t,"enabled",e)}.bind(this),300)}.bind(this)},checkAccountConnected:function(t,e){var i=this.$(".connect-button[data-provider="+t+"]");i.addClass("disabled"),this.xhr=u.a.ajax({dataType:"json",url:"/api/connect/forms/"+t+"/check",method:"GET",success:function(e){this.onSuccessfulConnect(t,e)}.bind(this),error:function(){this.switchers[t]&&this.switchers[t].setState(!1),"google"===t&&this.switchers.googledrive&&this.switchers.googledrive.setState(!1)}.bind(this),complete:function(){i.removeClass("disabled")}.bind(this)})},onSuccessfulConnect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.$(".connect-button[data-provider="+t+"]");if(i.closest(".switcher-wrapper").removeClass("disconnected"),"mailchimp"===t&&e.accessToken&&this.updateMailchimpList(e),"google"===t&&e.scopes&&e.scopes.includes("https://www.googleapis.com/auth/drive.file")){var n=this.$(".connect-button[data-provider=googledrive]");n&&n.closest(".switcher-wrapper").removeClass("disconnected")}},updateMailchimpList:function(t){var e=this.$(".input-list-name"),i=this.$(".list-select");this.setReachInputIcon(e,"preloader-icon"),i.prop("disabled",!0),this.xhr=u.a.ajax({dataType:"json",url:"/api/connect/forms/mailchimp/lists",method:"GET",success:function(t){var n=(t=t||{}).lists||[];if(n.length){var o=this.getEndpointParam("mailchimp","list_id");this.renderListOptions(n,o),this.onListSelectChange(),i.prop("disabled",!1)}else e.val("No lists")}.bind(this),error:function(t){console.log("xhr : ",t)}.bind(this),complete:function(){this.setReachInputIcon(e,"hidden")}.bind(this)})},onListSelectChange:function(){var t=this.$(".list-select"),e=t.val(),i=t.find("option:selected");e||(e=this.getEndpointParam("mailchimp","list_id"),i=t.find("option[value='"+e+"']")),this.$(".input-list-name").val(i.text()),this.setEndpointParam("mailchimp","list_id",i.val())},processWindowMessage:function(t){var e;if((t=t.originalEvent||{}).origin===Ft.a.readymag_auth_host){try{e=JSON.parse(decodeURIComponent(t.data))}catch(t){console.log("Error parsing uri data")}e&&"social-auth"===e.event&&(Object(u.a)(window).off("message",this.processWindowMessage),this.AuthWindow&&this.AuthWindow.close(),this.AuthWindow=null,this.handleAuthResult(e.message))}},startOauth:function(t){this.AuthWindow&&this.AuthWindow.close(),this.requestedProvider=t,Object(u.a)(window).on("message",this.processWindowMessage);var e=screen.width,i=screen.height,n=Math.min(1e3,e),o=Math.min(700,i-40),a=Math.ceil((e-n)/2),r=Math.ceil((i-o)/2);this.AuthWindow=window.open("/api/connect/forms/"+t+"/connect","_blank",["toolbar=no","location="+(window.opera?"no":"yes"),"directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,copyhistory=no","width="+n,"height="+o,"top="+r,"left="+a].join())},handleAuthResult:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(t.data||{}).provider;e&&(this.onSuccessfulConnect(e,t.data),this.switchers[this.requestedProvider||e].setState(!0),RM.analytics&&RM.analytics.sendEvent("Form widget","Successful OAuth result:"+this.requestedProvider||!1),this.requestedProvider=null)},onConnectButtonClick:function(t){var e=Object(u.a)(t.currentTarget).attr("data-provider");this.startOauth(e),RM.analytics&&RM.analytics.sendEvent("Form widget","Connect:"+this.requestedProvider||!1)},onActionIconClick:function(t){var e=Object(u.a)(t.currentTarget),i=e.closest(".input-wrapper").find("input"),n=i.val().trim(),o=i.attr("data-provider");if(e.hasClass("remove-icon"))i.val(""),this.onReachInputChange(i),"google"===o&&(this.setEndpointParam("google","sheet_name",null),this.setEndpointParam("google","sheet_id",null)),"url"===o&&this.setEndpointParam("url","custom_url",null),"dropbox"===o&&(this.setEndpointParam("dropbox","folder_name",this.dropboxFolderName),i.focus()),"googledrive"===o&&this.setEndpointParam("googledrive","folder_name",this.googledriveFolderName),RM.analytics&&RM.analytics.sendEvent("Form widget","Remove endpoint:"+o);else if(e.hasClass("apply-icon")){if(this.setReachInputIcon(i,"remove-icon"),"google"===o)this.getEndpointParam("google","sheet_name")===n||(this.setReachInputIcon(i,"preloader-icon"),this.createSheet(n,function(t,e){this.setReachInputIcon(i,t?"apply-icon":"remove-icon"),!t&&e.spreadsheetId?(this.setEndpointParam("google","sheet_name",n),this.setEndpointParam("google","sheet_id",e.spreadsheetId),RM.analytics&&RM.analytics.sendEvent("Form widget","Set endpoint param:"+o+' "'+n+'"')):RM.analytics&&RM.analytics.sendEvent("Form widget","Error set endpoint param:"+o)}.bind(this)));"url"===o&&(this.setEndpointParam("url","custom_url",n),RM.analytics&&RM.analytics.sendEvent("Form widget","Set endpoint param:"+o+' "'+n+'"')),"second_email"===o&&(this.addEmail(n,i),RM.analytics&&RM.analytics.sendEvent("Form widget","Set endpoint param:"+o+' "'+n+'"')),"dropbox"===o&&(this.setEndpointParam("dropbox","folder_name",n||this.dropboxFolderName),RM.analytics&&RM.analytics.sendEvent("Form widget","Set endpoint param:"+o+' "'+n+'"')),"googledrive"===o&&(this.setEndpointParam("googledrive","folder_name",n||this.googledriveFolderName),RM.analytics&&RM.analytics.sendEvent("Form widget","Set endpoint param:"+o+' "'+n+'"')),"confirmation-code"===o&&this.checkConfirmationCode(n,i)}},addEmail:function(t,e){var i={additonal_email:t,mag_title:RM.constructorRouter.mag.get("title")?RM.constructorRouter.mag.get("title"):"Project Title",page_number:RM.constructorRouter.workspace.getPageNum()};this.xhr=u.a.ajax({dataType:"json",url:"/api/me/addemail",method:"POST",data:i,success:function(){this.$(".panel-section.second_email .back").hasClass("hidden")||this.$(".panel-section.second_email .back").addClass("hidden"),this.$confirmationView.removeClass("hidden"),e.val(""),this.$(".panel-section.second_email .email-for-confirmation").text(t),e.attr("data-provider","confirmation-code"),this.onReachInputChange(e),e.addClass("padding-right-zero"),e.attr("type","text"),e.attr("placeholder","and paste code"),this.checkPanelPosition("second_email")}.bind(this),error:function(e){this.$inputWrapper.addClass("hidden"),this.$(".panel-section.second_email .error.email-for-confirmation").text(t),this.$(".panel-section.second_email .error-block").removeClass("hidden"),console.log("xhr : ",e)}.bind(this)})},setEmailsView:function(t){var e,i,n,o,a=this.model.get("endpoint_additonal_emails")?this.model.get("endpoint_additonal_emails").length:0,r=this.getEndpointParam("selected_email","last_selected_email")?this.getEndpointParam("selected_email","last_selected_email"):"";if(t||(t=r),0===a)this.setInputView();else if(1===a)this.$emailNew.removeClass("hidden"),this.$emailNew.text(t),r||this.setEndpointParam("selected_email","last_selected_email",t),this.$inputWrapper.addClass("hidden"),this.$changeEmail.removeClass("hidden");else{e=this.model.get("endpoint_additonal_emails"),0!==(i=Object(u.a)(".panel-section.second_email .choice-email select")).children("option").length&&i.children("option").remove(),o=e.map((function(t){return t.additonal_email})),r&&!o.includes(r)&&o.push(r);for(var s=0;s<o.length;s++)n=Object(u.a)("<option></option>").text(o[s]),i[0].add(n[0]);i.children("option").filter((function(){return Object(u.a)(this).text()===t})).prop("selected",!0),this.setEndpointParam("selected_email","last_selected_email",t),this.$inputWrapper.addClass("hidden"),this.$changeEmail.removeClass("hidden"),this.$selectWrapper.removeClass("hidden")}},checkConfirmationCode:function(t,e){var i={confirmation_code:t},n=this.$(".panel-section.second_email .confirmation .confirmation.email-for-confirmation").text();this.xhr=u.a.ajax({dataType:"json",url:"/api/me/checkcode",method:"POST",data:i,success:function(){this.setEndpointParam("additonal_emails","additonal_email",n),this.setEmailsView(n),this.$confirmationView.addClass("hidden")}.bind(this),error:function(t){e.addClass("err-code"),setTimeout(o.a.bind((function(){e.removeClass("err-code"),e.val(""),this.$(".panel-section.second_email .input-wrapper .action-icon").removeClass("remove-icon").addClass("hidden")}),this),3e3),console.log("xhr : ",t)}.bind(this)})},backClick:function(){var t=this.getEndpointParam("selected_email","last_selected_email");this.setEmailsView(t),this.$(".panel-section.second_email .back").addClass("hidden")},tryAnotherClick:function(){this.$inputWrapper.removeClass("hidden"),this.$(".panel-section.second_email .error-block").addClass("hidden")},setInputView:function(){var t=this.$(".panel-section.second_email .input-second-email");t.val(""),t.removeClass("padding-right-zero"),t.attr("type","email"),t.attr("placeholder","Add email"),this.$inputWrapper.removeClass("hidden"),t.attr("data-provider","second_email"),this.$(".panel-section.second_email .input-wrapper .action-icon").removeClass("remove-icon").addClass("hidden")},changeEmailClick:function(){this.$(".panel-section.second_email .input-second-email");this.$(".panel-section.second_email .back").removeClass("hidden"),this.model.get("endpoint_additonal_emails").length>1&&this.$(".panel-section.second_email .back").text("Back to list"),this.$selectWrapper.hasClass("hidden")||this.$selectWrapper.addClass("hidden"),this.setInputView(),this.$emailNew.addClass("hidden"),this.$changeEmail.addClass("hidden")},onEmailsSelectChange:function(){var t;Object(u.a)(".choice-email option:selected").each((function(){t=Object(u.a)(this).val()})),this.setEndpointParam("selected_email","last_selected_email",t)},resendCodeClick:function(){var t={additonal_email:this.$(".panel-section.second_email .confirmation .email-for-confirmation").text(),mag_title:RM.constructorRouter.mag.get("title")?RM.constructorRouter.mag.get("title"):"Project Title",page_number:RM.constructorRouter.workspace.getPageNum()};this.xhr=u.a.ajax({dataType:"json",url:"/api/me/resendcode",method:"POST",data:t,success:function(){setTimeout(o.a.bind((function(){this.$(".panel-section.second_email .confirmation.resend").text("Resend confirmation")}),this),4e3),this.$(".panel-section.second_email .confirmation.resend").text("Confirmation sent")}.bind(this),error:function(t){console.log("xhr : ",t)}.bind(this)})},cancelRequestClick:function(){var t={additonal_email:this.$(".panel-section.second_email .confirmation .email-for-confirmation").text()};this.xhr=u.a.ajax({dataType:"json",url:"/api/me/cancelrequest",method:"POST",data:t,success:function(){this.setEmailsView(),this.$confirmationView.addClass("hidden")}.bind(this),error:function(t){console.log("xhr : ",t)}.bind(this)})},createSheet:function(t,e){this.xhr=u.a.ajax({dataType:"json",url:"/api/connect/forms/google/createsheet",method:"POST",data:{title:t},success:function(t){e(null,t.sheet)}.bind(this),error:function(t){console.log("xhr : ",t),e(t.responseText)}.bind(this)})},setSectionCollapsed:function(t,e){this.$(".panel-section."+t).toggleClass("collapsed",e),this.$panel.toggleClass(t,!e)},hasMailchimpFields:function(){var t=this.model.get("fields");return o.a.any(t,(function(t){return"email"===t.tp&&!t.optional}))},onFieldsChange:function(){this.updateState()},onEndpointsChange:function(){this.updateState()},getEndpointProviders:function(){return o.a.map(this.$(".switcher.provider"),(function(t){return Object(u.a)(t).attr("data-provider")}))},getEndpointStorages:function(){return o.a.map(this.$(".switcher.storage"),(function(t){return Object(u.a)(t).attr("data-provider")}))},updateState:function(){var t=this.hasMailchimpFields(),e=this.getEndpointProviders(),i=this.getEndpointStorages();this.allExceptEmailDisabled=!0,this.allExceptDataStoragesDisabled=!0,this.hasEnabledEmail=!!this.getEndpointParam("email","enabled")||!!this.getEndpointParam("second_email","enabled"),o.a.each(o.a.without(e,"email"),function(e){var i=!!this.getEndpointParam(e,"enabled");"mailchimp"===e&&(t||(this.setEndpointParam(e,"enabled",!1,{silent:!0}),i=!1),this.$(".panel-section.mailchimp").find(".switcher-wrapper").toggleClass("forbidden",!t)),i&&(this.allExceptEmailDisabled=!1)}.bind(this)),this.allExceptEmailDisabled&&this.setEndpointParam("email","enabled",!0,{silent:!0}),o.a.each(o.a.without(i,"email-storage"),function(t){!!this.getEndpointParam(t,"enabled")&&(this.allExceptDataStoragesDisabled=!1)}.bind(this)),this.hasEnabledEmail?this.allExceptDataStoragesDisabled&&this.setEndpointParam("email-storage","enabled",!0,{silent:!0}):this.setEndpointParam("email-storage","enabled",!1,{silent:!0}),this.updateSwitchers()},updateSwitchers:function(){o.a.each(o.a.keys(this.switchers),function(t){var e=this.switchers[t],i=!!this.getEndpointParam(t,"enabled");e.setState(i,!0),this.setSectionCollapsed(t,!i),"email"===t&&e.setDisabled(!!this.allExceptEmailDisabled),"email-storage"===t&&e.setDisabled(!!this.allExceptDataStoragesDisabled||!this.hasEnabledEmail),i&&this.checkPanelPosition(t)}.bind(this))},bindLogic:function(){this.listenTo(this.model,"change:fields",this.onFieldsChange),this.listenTo(this.model,"change:endpoint_email change:endpoint_second_email change:endpoint_google change:endpoint_mailchimp change:endpoint_url change:endpoint_dropbox change:endpoint_googledrive",this.onEndpointsChange)},unBindLogic:function(){this.stopListening(this.model)},save:function(){this.model.save({})},deselect:function(){this.getEndpointParam("google","sheet_id")||this.setEndpointParam("google","enabled",!1),this.getEndpointParam("mailchimp","list_id")||this.setEndpointParam("mailchimp","enabled",!1),this.getEndpointParam("url","custom_url")||this.setEndpointParam("url","enabled",!1),this.updateState(),Bn.deselect.apply(this,arguments)},destroy:function(){this.xhr&&this.xhr.abort(),Object(u.a)(window).off("message",this.processWindowMessage),Bn.destroy.apply(this,arguments)}}),zn=i("tVJf"),Fn=i.n(zn),Un=a.a.extend({name:"form_styles",className:"control form_styles",saveOnDeselect:!0,saveOnDestroy:!0,initialize:function(t){this.template=Fn.a["template-constructor-control-form_styles"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model,this.state="fields",this.buttonState="default"},bindLogic:function(){var t=this;function e(e,i,n){t.inputs[e][i]=Object(u.a)(t.$panel.find(".edit-wrapper .params-block.params-"+e+' .edit-item[data-field="'+i+'"] input')).RMNumericInput(n).data("changeValue")}this.$colorbox_container=this.$(".colorbox_container"),this.$panel.on("click",".edit-wrapper",this.closeAllEditPopups),this.$panel.on("click",".edit-wrapper .layout-wrapper .layout-switcher",this.onLayoutSwitchClick),this.$panel.on("click",".edit-wrapper .style-wrapper .prev-style",this.onStyleSwitchClick),this.$panel.on("click",".edit-wrapper .style-wrapper .next-style",this.onStyleSwitchClick),this.$panel.on("click",".edit-wrapper .type-wrapper .type-switcher",this.onTypeSwitchClick),this.$panel.on("click",".edit-wrapper .button-switcher-wrapper .button-switcher",this.onButtonSwitchClick),this.$panel.on("click",".edit-wrapper .color-click-area",this.onColorboxShowClick),this.colorbox=new Ve.a({$parent:this.$colorbox_container,type:"small"}),this.colorbox.on("colorchange",this.colorOpacityChanged),this.colorbox.on("opacitychange",this.colorOpacityChanged),this.fontselector=new We.a({$parent:this.$(".fontselector_container")}),this.fontselector.on("selectfont",this.fontChanged),this.$panel.on("click",".edit-wrapper .font-family-click-area",this.onFontSelectorShowClick),this.$panel.on("click",".edit-wrapper .font-style-click-area",this.onFontStyleShowClick),this.$panel.on("click",".edit-wrapper .align",this.onAlignChangeClick),this.model.on("change",this.onChange),this.inputs={fields:{},"button-default":{},"button-hover":{}},e("fields","gutter",{min:-99,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),e("fields","border-radius",{min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),e("fields","border-width",{min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),e("fields","underline-width",{min:0,max:99,mouseSpeed:4,onChange:this.onEditInputChanged}),e("fields","font-size",{min:this.block.MIN_FONT_SIZE,max:this.block.MAX_FONT_SIZE,mouseSpeed:4,onChange:this.onEditInputChanged}),e("fields","letter-spacing",{min:this.block.MIN_LETTER_SPACING,max:this.block.MAX_LETTER_SPACING,mouseDir:"h",useFloat:!0,step:.2,mouseSpeed:4,onChange:this.onEditInputChanged}),e("button-default","gutter",{min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),e("button-default","border-radius",{min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),e("button-default","border-width",{min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),e("button-default","font-size",{min:this.block.MIN_FONT_SIZE,max:this.block.MAX_FONT_SIZE,mouseSpeed:4,onChange:this.onEditInputChanged}),e("button-default","letter-spacing",{min:this.block.MIN_LETTER_SPACING,max:this.block.MAX_LETTER_SPACING,mouseDir:"h",useFloat:!0,step:.2,mouseSpeed:4,onChange:this.onEditInputChanged}),e("button-hover","border-width",{min:0,max:999,mouseSpeed:4,onChange:this.onEditInputChanged}),Object(u.a)(this.$panel.find('.edit-wrapper .params-block.params-button-hover .edit-item[data-field="transition"] .switcher')).RMSwitcher({state:this.getCurrentStyleParam("button-hover","transition"),width:44,height:26,"text-size-0":0,"text-size-1":0,"color-0":"#0078ff"},function(t){o.a.delay(function(){this.setCurrentStyleParam("button-hover","transition",t)}.bind(this),300)}.bind(this)).data("switcher"),this.setAlignText(),this.updateControlState(),this.updateStylesState()},unBindLogic:function(){this.$panel.off("click",".edit-wrapper",this.closeAllEditPopups),this.$panel.off("click",".edit-wrapper .layout-wrapper .layout-switcher",this.onLayoutSwitchClick),this.$panel.off("click",".edit-wrapper .style-wrapper .prev-style",this.onStyleSwitchClick),this.$panel.off("click",".edit-wrapper .style-wrapper .next-style",this.onStyleSwitchClick),this.$panel.off("click",".edit-wrapper .type-wrapper .type-switcher",this.onTypeSwitchClick),this.$panel.off("click",".edit-wrapper .button-switcher-wrapper .button-switcher",this.onButtonSwitchClick),this.$panel.off("click",".edit-wrapper .color-click-area",this.onColorboxShowClick),this.$panel.off("click",".edit-wrapper .align",this.onAlignChangeClick),this.colorbox&&(this.colorbox.off("colorchange",this.colorOpacityChanged),this.colorbox.off("opacitychange",this.colorOpacityChanged),this.colorbox.destroy(),this.colorbox=null),this.fontselector&&(this.fontselector.off("selectfont",this.fontChanged),this.$panel.off("click",".edit-wrapper .font-family-click-area",this.onFontSelectorShowClick),this.$panel.off("click",".edit-wrapper .font-style-click-area",this.onFontStyleShowClick),this.fontselector.destroy(),this.fontselector=null),this.model&&this.model.off(null,null,this)},onChange:function(t,e){(e.undo||e.redo)&&(this.updateControlState(),this.updateStylesState(e))},onAlignChangeClick:function(){var t=this.getCurrentStyleParam(this.getCurrentState(),"text-align")||"center";this.setCurrentStyleParam(this.getCurrentState(),"text-align","center"===t?"left":"center"),this.setAlignText(),this.updateControlState(),this.updateStylesState()},setAlignText:function(){var t=Object(u.a)(".edit-wrapper .align .caption"),e=this.getCurrentStyleParam(this.getCurrentState(),"text-align")||"center",i="center"===e?"center":"left";this.setCurrentStyleParam(this.getCurrentState(),"text-align",e),t.text("Aligned ".concat(i))},onLayoutSwitchClick:function(t){Object(u.a)(t.currentTarget).hasClass("layout-vertical")?this.model.set({layout:"vertical"}):this.model.set({layout:"horizontal"});var e=this.block.getDefaultDimensions();this.model.set({w:e.width,h:e.height}),this.updateControlState(),this.updateStylesState()},onStyleSwitchClick:function(t){var e=Object(u.a)(t.currentTarget).hasClass("prev-style")?-1:1,i=["colored","outlined","underlined"],n=(o.a.indexOf(i,this.model.get("style"))+i.length+e)%i.length;this.model.set("style",i[n]),this.setAlignText(),this.updateControlState(),this.updateStylesState()},onTypeSwitchClick:function(t){Object(u.a)(t.currentTarget).hasClass("type-fields")?this.state="fields":this.state="button",this.updateControlState(),this.updateStylesState()},onButtonSwitchClick:function(t){Object(u.a)(t.currentTarget).hasClass("button-default")?this.buttonState="default":this.buttonState="hover",this.updateControlState(),this.updateStylesState()},getCurrentStyleParam:function(t,e){var i="style-"+this.model.get("style")+"-"+t,n=this.model.get(i)[e];return"inherit"===n&&"button-default"==t&&(i="style-"+this.model.get("style")+"-fields",n=this.model.get(i)[e]),"inherit"===n&&"button-hover"==t&&(i="style-"+this.model.get("style")+"-button-default","inherit"===(n=this.model.get(i)[e])&&(i="style-"+this.model.get("style")+"-fields",n=this.model.get(i)[e])),n},setCurrentStyleParam:function(t,e,i){var n="style-"+this.model.get("style")+"-"+t,a=o.a.clone(this.model.get(n));if(a[e]=i,"font-family"==e){var r=this.getCurrentStyleParam(this.getCurrentState(),"font-weight"),s=this.getCurrentStyleParam(this.getCurrentState(),"font-style"),l=RM.constructorRouter.fonts.findFontByCSSName(i),c=("italic"==s.toLowerCase()?"i":"n")+Math.floor(r/100);o.a.contains(l.variations,c)||(a["font-weight"]=100*(l.variations[0]||"n4").slice(1))}this.model.set(n,a)},getCurrentState:function(){var t=this.state;return"button"==t&&(t+="-"+this.buttonState),t},updateControlState:function(){this.$(".edit-wrapper").attr("data-state",this.state).attr("data-button-state",this.buttonState).attr("data-style",this.model.get("style")).attr("data-layout",this.model.get("layout")),this.$(".style-wrapper .style-caption").text(_.default.capitalize(this.model.get("style"))),"button"==this.state&&"hover"==this.buttonState?this.block.setButtonHoverState():this.block.unsetButtonHoverState()},updateStylesState:function(t){t=t||{};var e=this.getCurrentState(),i=this.inputs[e],n=this.$panel.find(".edit-wrapper .params-block.params-"+e);if(["gutter","border-radius","border-width","underline-width","font-size","letter-spacing","text-align"].forEach(function(o){var a=n.find(".edit-item[data-field="+o+"] input"),r=i[o],s=this.getCurrentStyleParam(e,o);r&&(r(s,!0),t.undo||t.redo||this.onEditInputChanged(a,s))}.bind(this)),this.getCurrentStyleParam(e,"color")&&n.find('.edit-item[data-field="color"] .color-circle').css("background-color",_.default.getRGBA(this.getCurrentStyleParam(e,"color"),this.getCurrentStyleParam(e,"opacity")/100)),this.getCurrentStyleParam(e,"border-color")&&n.find('.edit-item[data-field="border-color"] .color-circle').css("background-color",_.default.getRGBA(this.getCurrentStyleParam(e,"border-color"),this.getCurrentStyleParam(e,"border-opacity")/100)),this.getCurrentStyleParam(e,"underline-color")&&n.find('.edit-item[data-field="underline-color"] .color-circle').css("background-color",_.default.getRGBA(this.getCurrentStyleParam(e,"underline-color"),this.getCurrentStyleParam(e,"underline-opacity")/100)),this.getCurrentStyleParam(e,"text-color")&&n.find('.edit-item[data-field="text-color"] .color-circle').css("background-color",_.default.getRGBA(this.getCurrentStyleParam(e,"text-color"),this.getCurrentStyleParam(e,"text-opacity")/100)),n.find(".font-family").length){var o=RM.constructorRouter.fonts.findFontByCSSName(this.getCurrentStyleParam(e,"font-family")),a=RM.constructorRouter.fonts.getStyleName(this.getCurrentStyleParam(e,"font-weight"),this.getCurrentStyleParam(e,"font-style"),o.name);n.find(".font-family").text(o.name).css("font-family",o.css_name),n.find(".font-style").text(a).css({"font-family":o.css_name,"font-style":this.getCurrentStyleParam(e,"font-style"),"font-weight":this.getCurrentStyleParam(e,"font-weight")})}},onEditInputChanged:function(t,e){var i=t.closest(".edit-item").attr("data-field"),n=(e-this.getCurrentStyleParam(this.getCurrentState(),i))*("fields"==this.state?this.model.get("fields").length:1),o="vertical"==this.model.get("layout")?"h":"w";if(this.setCurrentStyleParam(this.getCurrentState(),i,e),"gutter"==i&&this.model.set(o,this.model.get(o)+n),"font-size"==i||"underline-width"==i){var a=this.block.getMinimalDimensions();(a.width>this.model.get("w")||a.height>this.model.get("h"))&&this.model.set({w:Math.max(a.width,this.model.get("w")),h:Math.max(a.height,this.model.get("h"))})}},fontChanged:function(t){this.setCurrentStyleParam(this.getCurrentState(),"font-family",t),this.updateStylesState()},fontStyleChanged:function(t){this.setCurrentStyleParam(this.getCurrentState(),"font-weight",Object(u.a)(t.currentTarget).attr("data-font-weight")),this.setCurrentStyleParam(this.getCurrentState(),"font-style",Object(u.a)(t.currentTarget).attr("data-font-style")),this.closeFontStyle(),this.updateStylesState()},colorOpacityChanged:function(t,e,i,n){var o=this.colorbox.rgb2hex([t,e,i]),a=100*n;this.setCurrentStyleParam(this.getCurrentState(),this.colorbox_for_field,o),this.setCurrentStyleParam(this.getCurrentState(),this.colorbox_for_field_dop,a),this.updateStylesState()},onFontSelectorShowClick:function(t){this.fontselector_visible?this.closeFontSelector():(this.closeAllEditPopups(),this.fontselector_visible=!0,this.fontselector&&this.fontselector.show([this.getCurrentStyleParam(this.getCurrentState(),"font-family")]),this.positionPopup(this.$(".fontselector_container"),Object(u.a)(t.currentTarget)))},onFontStyleShowClick:function(t){if(this.fontstyle_visible)this.closeFontStyle();else{this.closeAllEditPopups();var e=this.$(".fontstyle_container .font-style-wrapper");e.empty();var i=RM.constructorRouter.fonts.findFontByCSSName(this.getCurrentStyleParam(this.getCurrentState(),"font-family"));i&&(o.a.each(i.variations,function(t){var n=100*(t.substr(1,1)-0),o="n"==t.substr(0,1)?"normal":"italic",a=RM.constructorRouter.fonts.getStyleName(n,o,i.name),r=Object(u.a)("<div>").appendTo(e).addClass("font-style-item").text(a).css({"font-family":i.css_name,"font-weight":n+"","font-style":o}).attr("data-font-weight",n).attr("data-font-style",o).on("click",this.fontStyleChanged);Object(u.a)("<div>").appendTo(r).addClass("point");n==this.getCurrentStyleParam(this.getCurrentState(),"font-weight")&&o==this.getCurrentStyleParam(this.getCurrentState(),"font-style")&&r.addClass("curr")}.bind(this)),this.fontstyle_visible=!0,this.$(".fontstyle_container").fadeIn(200),this.positionPopup(this.$(".fontstyle_container"),Object(u.a)(t.currentTarget)))}},onColorboxShowClick:function(t){var e=Object(u.a)(t.currentTarget),i=e.attr("data-field"),n=e.attr("data-field-dop"),o=200;if(this.colorbox_visible){if(i==this.colorbox_for_field)return void this.closeColorBox();this.closeColorBox(!0),o=0}this.closeAllEditPopups(),this.colorbox_visible=!0,this.$colorbox_container.fadeIn(o),"text-color"===i&&"fields"===this.state&&this.block.toggleInputValue(!0),this.colorbox_for_field=i,this.colorbox_for_field_dop=n,this.colorbox.setOpacity(this.getCurrentStyleParam(this.getCurrentState(),n)/100),this.colorbox.setColor(this.getCurrentStyleParam(this.getCurrentState(),i)),this.positionPopup(this.$colorbox_container,Object(u.a)(t.currentTarget))},positionPopup:function(t,e){var i=t.children().first().height(),n=this.$panel.height(),o=Math.floor((n-i)/2),a=e.offset().top-this.$panel.offset().top,r=Math.max(a+i-n+16,0);t.css({top:Math.max(o,a-r)})},closeFontSelector:function(){this.fontselector_visible=!1,this.fontselector.hide()},closeFontStyle:function(){this.fontstyle_visible=!1,this.$(".fontstyle_container").fadeOut(200)},closeColorBox:function(t){this.colorbox_visible=!1,this.$colorbox_container.fadeOut(t?0:200),"text-color"===this.colorbox_for_field&&"fields"===this.state&&this.block.toggleInputValue(!1)},onClick:function(){this.selected&&(this.colorbox_visible||this.fontselector_visible||this.fontstyle_visible)?this.closeAllEditPopups():a.a.prototype.onClick.apply(this,arguments)},closeAllEditPopups:function(t){if(t){if(Object(u.a)(t.target).closest(".color-click-area").length>0)return;if(Object(u.a)(t.target).closest(".font-family-click-area").length>0)return;if(Object(u.a)(t.target).closest(".font-style-click-area").length>0)return}this.colorbox_visible&&this.closeColorBox(),this.fontselector_visible&&this.closeFontSelector(),this.fontstyle_visible&&this.closeFontStyle()},canControlBeClosed:function(){return this.colorbox_visible||this.fontselector_visible||this.fontstyle_visible?(this.closeAllEditPopups(),!0):a.a.prototype.canControlBeClosed.apply(this,arguments)},save:function(){this.model.save({})},select:function(){a.a.prototype.select.apply(this,arguments),this.updateControlState()},deselect:function(){this.closeAllEditPopups(),"button"==this.state&&"hover"==this.buttonState&&setTimeout(function(){this.block.unsetButtonHoverState()}.bind(this),250),a.a.prototype.deselect.apply(this,arguments)},destroy:function(t){"button"==this.state&&"hover"==this.buttonState&&setTimeout(function(){this.block.unsetButtonHoverState()}.bind(this),250),a.a.prototype.destroy.apply(this,arguments)}}),Nn=Be.extend({name:"video_settings",alt:"Video",panelComponent:"panel-video",select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-video_settings")}))},restrictions:function(t){var e=t.getSelectedBlocks();return 1===e.length&&"video"===e[0].model.get("type")},onPanelChange:function(t){Be.prototype.onPanelChange.apply(this,arguments),this.model.changed.hasOwnProperty("video_id")&&this.model.save({})}}),Hn=Be.extend({name:"audio_settings",alt:"Settings",panelComponent:"panel-audio-settings",select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-audio_settings")}))}}),Vn=Be.extend({name:"twitter_settings",alt:"Settings",panelComponent:"panel-twitter-settings"}),Wn=Be.extend({name:"facebook_settings",alt:"Settings",panelComponent:"panel-facebook-settings"}),Gn=Be.extend({name:"iframe_edit",alt:"Edit Code",select:function(){Be.prototype.select.apply(this,arguments),this.block.showPanel()},deselect:function(){this.block.hidePanel(),Be.prototype.deselect.apply(this,arguments)},bindLogic:function(){this.block.on("editCodeClick",this.onClick)},unBindLogic:function(){this.block.off("editCodeClick")}}),qn=Be.extend({name:"cart_connections",alt:"Cart connections",panelComponent:"panel-cart-connections"}),Kn=Be.extend({name:"cart_settings",alt:"Settings",panelComponent:"panel-cart-settings"}),Yn=i("QP/g"),Xn=i.n(Yn),Zn=i("3ED2"),Jn=i.n(Zn),Qn=a.a.extend({name:"cart_add_product_widget",className:"control cart_add_product_widget",restrictions:function(t){return Boolean(t.eCommerceManager.getConnectedProvider())},initialize:function(t){this.template=Xn.a["template-constructor-control-cart_add_product_widget"],this.initControl(t),this.block=this.blocks[0],this.model=this.block.model},render:function(){a.a.prototype.render.apply(this,arguments);var t=this.$el.find(".svg");Jn()(t)},onClick:function(){this.isOnClickDisabled()||this.block&&this.block.workspace&&this.block.workspace.createWidget(Ft.a.addToCartBlockName)}}),to=Be.extend({name:"product_selector",alt:"Select product",panelComponent:"panel-product-selector"}),eo=Be.extend({name:"add_to_cart_settings",alt:"Settings",panelComponent:"panel-addtocart-settings"}),io=Be.extend({name:"slideshow_settings",alt:"Settings",panelComponent:"panel-slideshow-settings",select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-slideshow_settings")})),this.block.updateDropZone()},setPopupToDefault:function(){this.model.set("current_mode","default")},onEscKey:function(){if(this.selected&&this.checkNeedClosePopup())return this.setPopupToDefault(),void this.closeColorBox();Be.prototype.onEscKey.apply(this,arguments)},checkNeedClosePopup:function(){return"default"!==this.model.get("current_mode")||this.block.colorbox_visible},canControlBeClosed:function(){if(this.checkNeedClosePopup())return this.closeColorBox(),this.setPopupToDefault(),!0;Be.prototype.canControlBeClosed.apply(this,arguments)},closeColorBox:function(){this.block.settingsPanel.closePopups(),this.block.colorbox_visible=!1},deselect:function(){this.setPopupToDefault(),Be.prototype.deselect.apply(this,arguments)},destroy:function(){this.block.needRasterize&&(this.block.rasterizeIconsBeforeDestroy(),delete this.block.needRasterize),Be.prototype.destroy.apply(this,arguments)}}),no=Be.extend({name:"slideshow_transitions",alt:"Transitions",panelComponent:"panel-slideshow-transitions",onPanelChange:function(t){Be.prototype.onPanelChange.apply(this,arguments)},select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-slideshow_transitions")}))},deselect:function(){Be.prototype.deselect.apply(this,arguments)}}),oo=i("RedZ"),ao=i.n(oo),ro=i("udqo"),so=a.a.extend({name:"picture_preview",className:"control picture_preview",initialize:function(t){var e=this;this.template=ao.a["template-constructor-control-picture_preview"],this.initControl(t),this.updateState();var i=this.models[0],n=this.master.workspace.page.getCurrentViewport();this.preview=new ro.a({$container:Object(u.a)("#main"),$el:this.blocks[0].$el,overlayColor:i.get("preview_overlay_color"),picture:i.get("picture"),originalW:i.get("originalW"),width:i.get("w"),viewportWidth:this.master.workspace.mag.getViewportWidth(n),viewport:n,viewerOptions:this.master.workspace.mag.get("opts")}),this.saveDebounced=o.a.debounce((function(){e.master.workspace.save_group(o.a.pluck(e.blocks,"model"))}),1e3)},select:function(){if(!this.$preview){if(a.a.prototype.select.apply(this,arguments),this.hasOnClickAnimation())return this.$panel.addClass("show-animation-error");if(this.hasLink())return this.$panel.addClass("show-link-error");this.$panel.removeClass("show-animation-error show-link-error"),1===this.models.length&&this.models[0].get("preview_enabled")&&(this.$preview=this.preview.render())}},deselect:function(){var t=this;this.selected&&this.colorboxOpened?this.colorbox.hide():(this.preview.remove((function(){delete t.$preview})),this.colorbox.hide(),a.a.prototype.deselect.apply(this,arguments))},render:function(){a.a.prototype.render.apply(this,arguments);var t=this.$el.find(".svg");Jn()(t)},bindLogic:function(){this.$(".icon-preview-toggle").on("click",this.previewToggle),this.$colorbox_container=this.$(".colorbox_container"),this.models[0].on("change",this.onPictureChange);var t=this.models[0].get("preview_overlay_color"),e=t?_.default.rgba2alpha(t):.6;if(!t){var i=this.models.map((function(t){return{_id:t.id,preview_overlay_color:"rgba(0, 0, 0, "+e+")"}}));this.master.workspace.set_group(i),this.saveDebounced()}var n=Y.default.extend(pt.a);this.colorbox=new n({el:this.$colorbox_container.get(0),propsData:{type:"small",color:t?_.default.rgba2hex(t).slice(1):"000000",alpha:100*e,hOffset:36,vOffset:-64}}),this.colorbox.$on("update:all",this.onColorChanged),this.colorbox.$on("showPopup",this.onColorboxOpened),this.colorbox.$on("hidePopup",this.onColorboxClosed)},onColorboxOpened:function(){this.colorboxOpened=!0},onColorboxClosed:function(){this.colorboxOpened=!1},unBindLogic:function(){var t=this;this.$(".icon-preview-toggle").off("click",this.previewToggle),this.models[0].off("change",this.onPictureChange),this.colorbox.$off("update:all",this.onColorChanged),this.preview.remove((function(){delete t.$preview}))},updateState:function(){this.previewEnabled=this.models[0].get("preview_enabled"),this.$el.toggleClass("enabled",!!this.previewEnabled)},onColorChanged:function(t){var e=_.default.hex2rgb(t.color),i="rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t.alpha/100+")",n=this.models.map((function(t){return{_id:t.id,preview_overlay_color:i}}));this.master.workspace.set_group(n),this.saveDebounced(),this.preview.changeColor(i)},restrictions:function(t){var e=t.getSelectedBlocks();return e.length<=1||e.map((function(t){return t.model.get("preview_enabled")})).every((function(t,e,i){return t===i[0]}))},previewToggle:function(){var t=this;if(!this.isOnClickDisabled()){this.previewEnabled=!this.previewEnabled,RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Picture Settings","Lightbox ".concat(this.previewEnabled?"enabled":"disabled"));var e=this.models.map((function(e){return{_id:e.id,preview_enabled:t.previewEnabled}}));this.master.workspace.set_group(e),this.saveDebounced(),this.updateState(),this.previewEnabled?1===this.models.length&&(this.$preview=this.preview.render()):(this.preview.remove((function(){delete t.$preview})),this.colorbox.hide())}},hasOnClickAnimation:function(){return this.models.reduce((function(t,e){return t||Boolean(e.getAnimations().find((function(t){return"click"===t.type&&t.steps&&t.steps.length})))}),!1)},hasLink:function(){return this.models.reduce((function(t,e){return t||!!e.get("clickLink")}),!1)},onPictureChange:function(){if(this.preview){var t=this.models[0].get("picture");this.preview.picture=t,this.preview.overlayColor=this.models[0].get("preview_overlay_color"),this.preview.originalW=this.models[0].get("originalW"),this.preview.height=this.models[0].get("h"),this.preview.width=this.models[0].get("w")}},onClick:function(){this.selected&&this.colorboxOpened?this.colorbox.hide():a.a.prototype.onClick.apply(this,arguments)},onEscKey:function(){this.selected&&this.colorboxOpened?this.colorbox.hide():a.a.prototype.onEscKey.apply(this,arguments)},canControlBeClosed:function(){if(this.colorboxOpened)return this.colorbox.hide(),!0;a.a.prototype.canControlBeClosed.apply(this,arguments)}}),lo=Be.extend({name:"picture_alt",alt:"Alt text for picture",panelComponent:"panel-picture-alt",select:function(){Be.prototype.select.apply(this,arguments),Promise.resolve().then(i.bind(null,"Vxjr")).then((function(t){(0,t.default)("controls-picture_alt")}))},restrictions:function(t){var e=RM.constructorRouter&&RM.constructorRouter.me&&RM.constructorRouter.me.get("permissions"),i=t.getSelectedBlocks();return 1===i.length&&i[0].isPictureEmpty&&!i[0].isPictureEmpty()&&e&&e.can_use_picture_alt}}),co=Be.extend({name:"rmheader_settings",alt:"RM Header Settings",panelComponent:"panel-rmheader-settings"}),ho=i("QNie"),uo=i("vOnD"),po=i("q1tI"),mo=i.n(po),go=i("iC7s"),fo=i("wEEd"),vo=i("8AXF");function bo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return yo(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return yo(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var _o=Object(uo.e)(go.B).withConfig({displayName:"Control___StyledFlex"})(["transition:background 0.2s ease;"]),wo=function(t,e){var i=t.children,n=t.onClick,o=t.onMouseEnter,a=t.onMouseLeave,r=t.label,s=t.figure,l=void 0===s?"circle":s,c=t.disableHover,d=void 0!==c&&c,h=t.isActive,u=void 0!==h&&h,p=Object(po.useContext)(vo.BackboneContext).destroy,m=Object(po.useContext)(ho.a).model,g=Object(fo.d)(m.visible,null,{config:{duration:200},from:m.appearanceAnimation?{opacity:0,transform:"translateX(7px)"}:{},enter:{opacity:1,transform:"translateX(0px)"},leave:{opacity:0,transform:"translateX(-7px)"},onDestroyed:function(t){t&&p()}}),f=bo(Object(po.useState)(!1),2),v=f[0],b=f[1];return mo.a.createElement(go.m,{ref:e,left:"0px",position:"absolute",top:m.y,width:30,height:30,onMouseEnter:function(t){d||b(!0),o&&o(t)},onMouseLeave:function(t){d||b(!1),a&&a(t)}},g.map((function(t){var e=t.item,o=t.key,a=t.props;return e&&mo.a.createElement(fo.a.div,{key:o,style:a},mo.a.createElement(go.Eb,{text:r,position:"left",indent:8,disabled:m.selected},mo.a.createElement(_o,{as:"button",bg:m.disabled||!v&&!u?"rgba(68, 68, 76, 0.95)":"blue",width:30,height:30,borderRadius:"circle"===l?"50%":"square"===l?"4px":void 0,disabled:m.disabled,onClick:n,justifyContent:"center",alignItems:"center",border:"none",p:"0",color:"white",opacity:m.disabled?.3:m.faded?.4:1,cursor:m.disabled||m.faded?"default":"pointer"},i)))})))},ko=mo.a.forwardRef(wo),So=i("KFoM"),xo=i("rJga"),Co=i("9P9J");function Oo(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function jo(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Oo(Object(i),!0).forEach((function(e){Po(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Oo(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Po(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Eo=function(t){var e=t.control,i=t.panel,n=t.centerPanel;return(mo.a.createElement(So.a,null,mo.a.createElement(xo.a,null,e),mo.a.createElement(Co.a,{placement:"left",modifiers:[{name:"offset",options:{offset:[0,16]}},{name:"preventOverflow",options:{padding:16}}]},(function(t){return i(jo(jo({},t),{},{style:Object.assign(t.style,n?{top:"50vh",transform:"translateY(-50%)"}:{})}))}))))},Io=i("i8i4"),To=i.n(Io);function Mo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return $o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ao(){return(Ao=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Ro(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Do(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ro(Object(i),!0).forEach((function(e){Bo(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ro(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Bo(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Lo(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var zo=mo.a.createContext({}),Fo=Object(uo.e)(go.m).withConfig({displayName:"Panel___StyledBox"})(["",""],(function(t){return t._css})),Uo=Object(uo.e)(go.m).withConfig({displayName:"Panel___StyledBox2"})(["cursor:row-resize;"]),No=function(t,e){var i=t.children,n=(t.color,t.style),o=void 0===n?{}:n,a=t.resizable,r=t.onResizeComplete,s=t.height,l=void 0===s?300:s,c=t.scrollable,d=Lo(t,["children","color","style","resizable","onResizeComplete","height","scrollable"]),h=Object(po.useContext)(ho.a).model,u=Object(fo.d)(h.selected,null,{config:{duration:200},from:{opacity:0,transform:"translateX(8px)"},enter:{opacity:1,transform:"translateX(0px)"},leave:{opacity:0,transform:"translateX(8px)"}}),p=document.getElementById("controls-portal"),m=mo.a.createRef(),g=function(t){var e=t.ref,i=t.min,n=t.max,o=t.onResizeComplete,a=t.initialHeight,r=Mo(Object(po.useState)(0),2),s=r[0],l=r[1],c=Mo(Object(po.useState)(0),2),d=c[0],h=c[1],u=Mo(Object(po.useState)(!1),2),p=u[0],m=u[1],g=function(t){var e=t;return void 0!==i&&(e=Math.max("number"==typeof i?i:i(),e)),void 0!==n&&(e=Math.min("number"==typeof n?n:n(),e)),e},f=function(t){var i=t.pageY-d,n=g(s+i);e.current&&(e.current.style.height="".concat(n,"px"))},v=function(t){var i=t.pageY-d,n=g(s+i);e.current&&e.current.style.removeProperty("height"),o&&o(n),m(!1),l(n)},b=function(){if(void 0!==n){var t="function"==typeof n?n():n;s>t&&(o&&o(t),l(t))}};return Object(po.useEffect)((function(){"number"==typeof a&&a!==s&&l(a)}),[a]),Object(po.useEffect)((function(){if(void 0!==n)return b(),window.addEventListener("resize",b),function(){window.removeEventListener("resize",b)}}),[s]),Object(po.useEffect)((function(){return p?(window.addEventListener("mousemove",f),window.addEventListener("mouseup",v)):(window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",v)),function(){window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",v)}}),[p]),{isResizable:p,onMouseDown:function(t){if(e.current){var i=e.current.getBoundingClientRect();l(i.height),m(!0),h(t.pageY)}}}}({ref:m,min:200,max:function(){return window.innerHeight-16-16},onResizeComplete:"function"==typeof r?r:void 0,initialHeight:l}),f=g.isResizable,v=g.onMouseDown;Object(po.useEffect)((function(){h.block&&h.block.onResizable&&h.block.onResizable(f)}),[f]);var b=Object(po.useRef)(null),y=Object(po.useRef)(null);return mo.a.createElement(zo.Provider,{value:{tooltipContainer:b.current||void 0,dropdownContainer:y.current||void 0}},p?To.a.createPortal(mo.a.createElement(mo.a.Fragment,null,u.map((function(t){var n=t.item,r=t.key,s=t.props;return n&&mo.a.createElement(fo.a.div,{ref:e,key:r,style:Do(Do({width:d.width||170},s),o)},mo.a.createElement(go.m,{maxHeight:c?"100vh":void 0},mo.a.createElement(Fo,Ao({ref:m,height:a?l:void 0,maxHeight:"calc(100vh - 16px - 16px)",bg:"lightGray",borderRadius:8,border:"1px solid",borderColor:"#F0F0F0"},d,{position:"relative",_css:f?"\n                                pointer-events: none;\n                                user-select: none;\n\n                                * {\n                                  pointer-events: none !important;\n                                }\n                                ":""}),c&&!a?mo.a.createElement(go.jb,null,(function(t){var e=t.ref;return(mo.a.createElement(go.m,{ref:e},i))})):i,a&&!c?mo.a.createElement(Uo,{position:"absolute",bottom:0,left:0,width:"100%",height:4,onMouseDown:v}):null)),mo.a.createElement(go.m,{ref:b}),mo.a.createElement(go.m,{ref:y}))}))),p):null)},Ho=mo.a.forwardRef(No),Vo=i("dfNU"),Wo=i("IwqK");function Go(){return(Go=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function qo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ko(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ko(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ko(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Yo=Object(uo.e)(go.m).withConfig({displayName:"PanelSelect___StyledBox"})(["transform:translateY(-50%);"]),Xo=Object(uo.e)(go.Cb).withConfig({displayName:"PanelSelect___StyledText"})(["",""],(function(t){return t._css})),Zo=function(t){var e=t.selected,i=t.label,n=t.onClick,o=t.itemStyle,a=t.isLast,r=qo(Object(po.useState)(!1),2),s=r[0],l=r[1];return mo.a.createElement(go.m,{onClick:n,position:"relative",cursor:"pointer",pl:14,mb:a?0:"6px",onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}},e&&mo.a.createElement(Yo,{bg:"black",borderRadius:"50%",width:6,height:6,position:"absolute",left:0,top:"50%"}),mo.a.createElement(Xo,{textStyle:"small",color:e||s?"black":"gray",_css:o},i))},Jo=Object(uo.e)(go.n).withConfig({displayName:"PanelSelect___StyledButton"})(["line-height:1;"]),Qo=Object(uo.e)(go.Cb).withConfig({displayName:"PanelSelect___StyledText2"})(["display:block;",""],(function(t){return t._css2})),ta=Object(uo.e)(go.n).withConfig({displayName:"PanelSelect___StyledButton2"})(["vertical-align:middle;"]),ea=function(t){var e=t.value,i=t.items,n=void 0===i?[]:i,o=t.onSelect,a=t.labelStyle,r=t.itemStyleFn,s=t.rightIcon,l=t.container,c=t.children,d=e&&n.find((function(t){return t.value===e}))||n[0]||{label:"",value:""},h=qo(Object(po.useState)(!1),2),u=h[0],p=h[1],m=Object(po.useContext)(ho.a).modelSet,g=qo(Object(po.useState)(null),2),f=g[0],v=g[1],b=qo(Object(po.useState)(null),2),y=b[0],_=b[1],w=Object(po.useMemo)((function(){return f?f.getBoundingClientRect():{}}),[f]),k=Object(Wo.a)(f,y,{placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,-1*w.height||0]}}]}),S=k.styles,x=k.attributes,C=function(t){f&&(t.target&&f&&f.contains(t.target)||(m({preventClose:!1}),p(!1)))};Object(po.useEffect)((function(){return u?window.addEventListener("click",C):window.removeEventListener("click",C),function(){window.removeEventListener("click",C)}}),[u]),Object(po.useEffect)((function(){return function(){m({preventClose:!1})}}),[]);var O=mo.a.createElement(go.m,Go({ref:_,bg:"white",width:"calc(100% + 8px + 8px)",borderRadius:8,border:"1px solid",borderColor:"#F0F0F0",py:16,px:10,zIndex:102,style:S.popper},x.popper),n.map((function(t,e){return mo.a.createElement(Zo,{key:e,isLast:e===n.length-1,selected:d.value===t.value,label:t.label,itemStyle:r?r(t):void 0,onClick:function(){o(t),p(!1)}})}))),j=function(){m({preventClose:!u}),p(!u)},P=qo(Object(po.useState)(!1),2),E=P[0],I=P[1];return mo.a.createElement(mo.a.Fragment,null,c&&"function"==typeof c?c({toggleDropdown:j,ref:v}):mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center",position:"relative",cursor:"pointer",ref:v,onClick:j,onMouseEnter:function(){return I(!0)},onMouseLeave:function(){return I(!1)}},mo.a.createElement(Jo,{display:"block",onClick:j,variant:"clean"},mo.a.createElement(Qo,{textStyle:"small",_css2:a||""},d.label)),mo.a.createElement(go.m,null,s||mo.a.createElement(ta,{onClick:j,variant:"clean"},mo.a.createElement(go.Gb,{color:E?"black":"gray"})))),u?l?To.a.createPortal(mo.a.createElement(go.m,null,O),l):O:null)},ia=i("zjto"),na=i("A9VP"),oa=i("ICos"),aa=i("WySc"),ra=i("a68n"),sa=i("uU7u"),la=i("fueH");function ca(t){return function(t){if(Array.isArray(t))return ua(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||ha(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function da(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||ha(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ha(t,e){if(t){if("string"==typeof t)return ua(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ua(t,e):void 0}}function ua(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var pa,ma=Object(uo.e)(go.m).withConfig({displayName:"TextColor___StyledBox"})(["",""],(function(t){return t._css})),ga=function(){var t=Object(po.useContext)(ho.a).model,e=da(Object(ia.g)(),1)[0],i=Object(po.useMemo)((function(){return t.project.get("_id")}),[t]),n=Object(po.useMemo)((function(){return t.user.get("_id")}),[t]),o=da(t.useSharedState({partial:!1}),2),a=o[0],r=o[1],s=Object(po.useMemo)((function(){return Object(ra.b)({editorState:a})}),[a]),l=Object(po.useMemo)((function(){return[].concat(ca(e.global),ca(e.project)).find((function(t){return t.name===s}))}),[s,e]),c=Object(po.useMemo)((function(){var t=la.a.getCurrentInlineStyles(a,na.a.Color),e=t&&t.length?t[0]:void 0,i=aa.c;return e?i=Object(oa.e)(e):l&&l.cssProperties.color&&(i=Object(oa.e)(l.cssProperties.color)),{color:i,hex:Object(oa.g)(i)}}),[a,l]),d=c.color,h=c.hex,u=Object(po.useMemo)((function(){return!!Object(sa.d)(a)}),[a]);Object(po.useEffect)((function(){u&&t.selected&&(t.deselect(),t.removeFade())}),[u,t.selected]);var p=function(t){var e=la.a.applyInlineStyle({key:na.a.Color,value:Object(oa.h)(t),editorState:a});r(e)};return(mo.a.createElement(Eo,{control:function(e){var i=e.ref;return(mo.a.createElement(ma,{opacity:u?.5:1,_css:u?"\n                &, * {\n                  cursor: not-allowed !important;\n                }":""},mo.a.createElement(ko,{ref:i,label:"Color",disableHover:!0,onClick:function(e){e.preventDefault(),t.disabled||u||t.select()}},mo.a.createElement(aa.a,{hex:"#"+h}))))},panel:function(e){var o=e.ref,a=e.style;return t.selected?mo.a.createElement(Ho,{ref:o,style:a,width:"auto",bg:"transparent",border:"none"},mo.a.createElement(aa.b,{projectId:i,userId:n,color:d,setColor:p,onChangeComplete:p})):null}}))},fa=ho.b.extend({name:"text_color_new",component:ga}),va=i("IrH7"),ba=i("8Tds"),ya=i("HjzJ"),_a=i("za5s"),wa=i("saLn"),ka=i("QuYs");function Sa(t){return function(t){if(Array.isArray(t))return Oa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ca(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Ca(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ca(t,e){if(t){if("string"==typeof t)return Oa(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Oa(t,e):void 0}}function Oa(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ja(){return(ja=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Pa(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}!function(t){t.top="top",t.left="left",t.center="center",t.right="right",t.justify="justify",t.bottom="bottom"}(pa||(pa={}));var Ea=Object(uo.e)(go.n).withConfig({displayName:"TextAlign___StyledButton"})(["&:hover g,&:hover path{fill:"," !important;}"],(function(t){return t._css})),Ia=function(t){var e=t.icon,i=t.isHovered,n=t.isActive,o=Pa(t,["icon","isHovered","isActive"]),a=e===pa.top?go.g:e===pa.bottom?go.j:e===pa.left?go.d:e===pa.center?go.b:e===pa.right?go.e:go.c;return mo.a.createElement(Ea,ja({border:"none",bg:"transparent",cursor:"pointer"},o,{_css:Object(_a.themeGet)("colors.blue")}),mo.a.createElement(a,{color:i||n?"blue":"darkGray"}))},Ta=Object(uo.e)(go.ib).withConfig({displayName:"TextAlign___StyledRoundButton"})(["&:hover g{fill:#fff;}"]),Ma=Object(uo.e)(go.ib).withConfig({displayName:"TextAlign___StyledRoundButton2"})(["&:hover g{fill:#fff;}"]),$a=function(t,e){var i=t.style,n=Object(po.useContext)(vo.BackboneContext),o=n.model,a=n.modelSet,r=n.modelSave,s=Object(po.useContext)(ho.a).model,l=xa(Object(ia.g)(),1)[0],c=Object(wa.a)(r,400).callback,d=function(t){a(t),c()},h=xa(Object(po.useState)(null),2),u=h[0],p=h[1],m=xa(s.useSharedState({partial:!1}),2),g=m[0],f=m[1],v=Object(po.useMemo)((function(){var t=Object(va.d)({editorState:g});if(t)return t;var e=Object(ra.b)({editorState:g});if(e){var i=[].concat(Sa(l.global),Sa(l.project)).find((function(t){return t.name===e}));if(i&&i.cssProperties.textAlign)return"align-".concat(i.cssProperties.textAlign)}}),[g,l]),b=o.verticalAlign,y=function(t){var e,i;if(null===(e=s.block)||void 0===e||null===(i=e.propsModel)||void 0===i?void 0:i.get("isEditMode"))f(Object(va.e)({editorState:g,align:t}));else{var n=g.getCurrentContent().getBlocksAsArray().reduce((function(e,i){var n=i.getType();return Object(ya.e)(n)&&t===va.a.AlignJustify?e:Object(va.e)({editorState:e,block:i,align:t})}),g);f(n)}},_=o.textDirection||ba.b.LTR,w=function(){var t=_===ba.b.LTR?ba.b.RTL:ba.b.LTR;ka.d.sendEvent(ka.b.TextAlignPanel,{eventLabel:t===ba.b.RTL?"RTL on":"LTR on"}),d({textDirection:t})},k=o.columns&&o.columns.count>1,S=("boolean"!=typeof o.autosize||o.autosize)&&!k,x=!o.parent_wid,C=Object(po.useMemo)((function(){return la.a.getCurrentBlockType(g)}),[g]),O=Object(po.useMemo)((function(){return Object(ya.e)(C)}),[C]);return mo.a.createElement(Ho,{ref:e,style:i},mo.a.createElement(zo.Consumer,null,(function(t){var e=t.tooltipContainer;return(mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(go.m,{px:16,pt:2},mo.a.createElement(Vo.a,{showBorderTop:!1},mo.a.createElement(go.m,{mb:3},mo.a.createElement(go.Cb,{textStyle:"small"},"Align")),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(Ia,{"aria-labelledby":"text-align-left",icon:pa.left,isHovered:u===pa.left,isActive:v===va.a.AlignLeft||!v,onMouseEnter:function(){return p(pa.left)},onMouseLeave:function(){return p(null)},onClick:function(){y(va.a.AlignLeft)}}),mo.a.createElement(Ia,{"aria-labelledby":"text-align-center",icon:pa.center,isHovered:u===pa.center,isActive:v===va.a.AlignCenter,onMouseEnter:function(){return p(pa.center)},onMouseLeave:function(){return p(null)},onClick:function(){y(va.a.AlignCenter)}}),mo.a.createElement(Ia,{"aria-labelledby":"text-align-right",icon:pa.right,isHovered:u===pa.right,isActive:v===va.a.AlignRight,onMouseEnter:function(){return p(pa.right)},onMouseLeave:function(){return p(null)},onClick:function(){y(va.a.AlignRight)}}),mo.a.createElement(Ia,{"aria-labelledby":"text-align-justify",icon:pa.justify,isHovered:u===pa.justify,isActive:v===va.a.AlignJustify,onMouseEnter:function(){return p(pa.justify)},onMouseLeave:function(){return p(null)},disabled:O,onClick:function(){y(va.a.AlignJustify)}})))),mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,mb:0},mo.a.createElement(go.m,{mb:"12px"},mo.a.createElement(go.Cb,{textStyle:"small"},"Resizing")),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Auto height",indent:4,container:e},mo.a.createElement(Ta,{"aria-labelledby":"text-align-autoheight",hoverColor:"blue",size:40,disabled:k||!x,color:S?"blue":"gray",onClick:function(){ka.d.sendEvent(ka.b.TextAlignPanel,{eventLabel:"Fixed size off"}),d({autosize:!0})}},mo.a.createElement(go.d,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Fixed size",indent:4,container:e},mo.a.createElement(Ma,{"aria-labelledby":"text-align-fixed-size",hoverColor:"black",size:40,color:S?"gray":"blue",onClick:function(){ka.d.sendEvent(ka.b.TextAlignPanel,{eventLabel:"Fixed size on"}),d({autosize:!1})}},mo.a.createElement(go.qb,{color:"white"})))),mo.a.createElement(go.m,{width:40,height:40},!S&&mo.a.createElement(go.B,{flexDirection:"column",height:"100%",justifyContent:"space-between"},mo.a.createElement(Ia,{"aria-labelledby":"text-align-top",icon:pa.top,isHovered:u===pa.top,isActive:!b||b===ba.d.top,onMouseEnter:function(){return p(pa.top)},onMouseLeave:function(){return p(null)},onClick:function(){d({verticalAlign:ba.d.top})}}),mo.a.createElement(Ia,{"aria-labelledby":"text-align-bottom",icon:pa.bottom,isHovered:u===pa.bottom,isActive:b===ba.d.bottom,onMouseEnter:function(){return p(pa.bottom)},onMouseLeave:function(){return p(null)},onClick:function(){d({verticalAlign:ba.d.bottom})}})))))),mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderBottom:!1,showBorderTop:!1,small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.Cb,{textStyle:"small"},"Writing"),mo.a.createElement(go.n,{onClick:w,"aria-labelledby":"text-align-toggle-direction"},mo.a.createElement(go.Cb,{color:"blue",textStyle:"small"},_)))))))})))},Aa=mo.a.forwardRef($a);function Ra(t){return function(t){if(Array.isArray(t))return La(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ba(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Da(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Ba(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ba(t,e){if(t){if("string"==typeof t)return La(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?La(t,e):void 0}}function La(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var za=function(){var t=Object(po.useContext)(ho.a).model,e=Da(Object(ia.g)(),1)[0],i=Object(po.useContext)(vo.BackboneContext).model,n=Da(t.useSharedState({partial:!1}),1)[0],o=Object(po.useMemo)((function(){var t=Object(va.d)({editorState:n});if(t)return t;var i=Object(ra.b)({editorState:n});if(i){var o=[].concat(Ra(e.global),Ra(e.project)).find((function(t){return t.name===i}));if(o&&o.cssProperties.textAlign)return"align-".concat(o.cssProperties.textAlign)}}),[n,e]),a=Object(po.useMemo)((function(){switch(o){case va.a.AlignCenter:return go.b;case va.a.AlignRight:return go.e;case va.a.AlignJustify:return go.c;default:return go.d}}),[o]),r=i.columns&&i.columns.count>1,s=("boolean"!=typeof i.autosize||i.autosize)&&!r;return mo.a.createElement(Eo,{control:function(e){var i=e.ref;return(mo.a.createElement(ko,{ref:i,figure:s?"circle":"square",label:"Align",onClick:function(e){e.preventDefault(),t.disabled||t.select()}},mo.a.createElement(a,{color:"white"})))},panel:function(e){var i=e.ref,n=e.style;return t.selected?mo.a.createElement(Aa,{ref:i,style:n}):null}})},Fa=ho.b.extend({name:"text_align_new",component:za}),Ua=i("zMlX"),Na=i("w5C2"),Ha=i("KiFh");function Va(t){return function(t){if(Array.isArray(t))return qa(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ga(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Ga(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ga(t,e){if(t){if("string"==typeof t)return qa(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?qa(t,e):void 0}}function qa(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ka=Object(po.createContext)({}),Ya=function(t,e){var i=t.initialScreen,n=t.children,o=t.childRef,a=t.onNavigate,r=t.onStackUpdated,s=Wa(Object(po.useState)([i]),2),l=s[0],c=s[1],d=l[l.length-1],h=l[l.length-2];Object(po.useEffect)((function(){r&&r(l)}),[l]);var u=function(t){c([].concat(Va(l),[t])),a&&a({prev:d,next:t})},p=function(){if(l.length){var t=Va(l);t.pop(),c(t),a&&a({prev:d,next:t[t.length-1]})}},m=function(){c([i]),a&&a({prev:d,next:i})};Object(po.useImperativeHandle)(e,(function(){return{stack:l,prevScreen:h,currentScreen:d,navigate:u,goBack:p,goHome:m}}),[l,a,p,m,u,h,d]);var g=(n||[]).find((function(t){return t.key===d}));return(mo.a.createElement(Ka.Provider,{value:{stack:l,prevScreen:h,currentScreen:d,navigate:u,goBack:p,goHome:m}},g?mo.a.cloneElement(g,{ref:o}):null))},Xa=Object(po.forwardRef)(Ya),Za=function(t){var e=Wa(Object(po.useState)([]),2),i=e[0],n=e[1];return{onStackUpdated:function(t){n(t)},canControlBeClosed:function(){return!!(t&&i&&i.length>1)&&(t.goBack(),!0)}}},Ja=i("nnuN");function Qa(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function tr(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Qa(Object(i),!0).forEach((function(e){er(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Qa(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function er(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ir(t){return function(t){if(Array.isArray(t))return ar(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||or(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||or(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function or(t,e){if(t){if("string"==typeof t)return ar(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ar(t,e):void 0}}function ar(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var rr=function(t,e){var i=parseInt(t.replace(/\D/g,"")),n=parseInt(e.replace(/\D/g,""));return"v"===e?-1:i!==n?i-n:t.match(/^n/)?-1:1},sr=Object(uo.e)(go.n).withConfig({displayName:"FontSelectPanel___StyledButton"})(["line-height:1;text-align:left;white-space:nowrap;overflow:hidden;width:100%;text-overflow:ellipsis;font-family:",",sans-serif;"],(function(t){return t._css})),lr=Object(uo.e)(go.n).withConfig({displayName:"FontSelectPanel___StyledButton2"})(["vertical-align:middle;"]),cr=Object(uo.e)(go.Cb).withConfig({displayName:"FontSelectPanel___StyledText"})(["display:block;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),dr=function(t){var e=t.onHeightChanged,i=t.textStyle,n=t.listStyle,o=t.onChangeTextStyle,a=t.dropdownPortal,r=Object(po.useContext)(ho.a).model,s=nr(Object(ia.g)(),1)[0],l=nr(Object(ia.f)(),1)[0],c=nr(r.useSharedState({partial:!1}),2),d=c[0],h=c[1],u=nr(Object(po.useState)(Na.b),2),p=u[0],m=u[1],g=Object(po.useContext)(Ka).navigate,f=Object(po.useMemo)((function(){return Object(ra.b)({editorState:d})}),[d]),v=Object(po.useMemo)((function(){return Object(ya.d)({editorState:d})}),[d]),b=Object(po.useMemo)((function(){if(i)return i.cssProperties.fontVariationSettings&&i.cssProperties.fontVariationSettings.split(", ")||[];var t=la.a.getCurrentInlineStyles(d,na.a.FontVariable);if(t.length)return t;if(f){var e=[].concat(ir(s.global),ir(s.project)).find((function(t){return t.name===f}));if(e&&e.cssProperties.fontVariationSettings)return e.cssProperties.fontVariationSettings.split(", ")||[]}return[]}),[i||d,f]),y=Object(po.useMemo)((function(){if(i)return[String(i.cssProperties.fontFamily)];var t=la.a.getCurrentInlineStyles(d,na.a.FontFamily);if(t.length)return t;if(f){var e=[].concat(ir(s.global),ir(s.project)).find((function(t){return t.name===f}));if(e&&e.cssProperties.fontFamily)return[e.cssProperties.fontFamily]}return[]}),[i||d,f]),_=nr(Object(po.useState)(p.fontWeight),2),w=_[0],k=_[1],S=nr(Object(po.useState)(p.fontWeights),2),x=S[0],C=S[1],O=nr(Object(po.useState)(p.fontStyle),2),j=O[0],P=O[1],E=nr(Object(po.useState)(y.length?y[0]:p.fontFamily),2),I=E[0],T=E[1],M=nr(Object(po.useState)(p.fontFamily),2),$=M[0],A=M[1],R=nr(Object(po.useState)({}),2),D=R[0],B=R[1];Object(po.useEffect)((function(){var t={};ir(b).forEach((function(e){var n,o;if(i){var a=nr(e.split(" "),2);n=a[0],o=a[1],n=n.replace(/['"]+/g,"")}else{var r=nr(e.split("|"),2);if(n=r[0],o=r[1],!n||!o){var s=nr(e.split(" "),2);n=s[0],o=s[1],n=n.replace(/['"]+/g,"")}}n&&o&&("number"==typeof D[n]&&D[n]!==Number(o)||"number"!=typeof D[n])&&(t[n]=Number(o))})),Object.keys(t).length>0&&B(tr(tr({},D),t))}),[b,f]);var L=Object(po.useMemo)((function(){if(i)return[String(i.cssProperties.fontWeight)];var t=la.a.getCurrentInlineStyles(d,na.a.FontWeight);if(t.length)return t;if(f){var e=[].concat(ir(s.global),ir(s.project)).find((function(t){return t.name===f}));if(e&&e.cssProperties.fontWeight)return[String(e.cssProperties.fontWeight)]}return[]}),[i||d,f]);Object(po.useEffect)((function(){var t=L[0],e=t?parseInt(t)||t:void 0;e&&e!==w?k(e):t||p.fontWeight===w||k(p.fontWeight)}),[L]);var z=Object(po.useMemo)((function(){if(i)return[i.cssProperties.fontStyle];var t=la.a.getCurrentInlineStyles(d,na.a.FontStyle);if(t.length)return t;if(f){var e=[].concat(ir(s.global),ir(s.project)).find((function(t){return t.name===f}));if(e&&e.cssProperties.fontStyle)return[e.cssProperties.fontStyle]}return[]}),[i||d,f]);Object(po.useEffect)((function(){var t=z[0];t&&t!==j?P(t):t||p.fontStyle===j||P(p.fontStyle)}),[z]),Object(po.useEffect)((function(){var t=y[0];if(t){var e=t&&t!==I?t:t||I?null:p.fontFamily;T(t);var i=window.RM.constructorRouter.fonts.findFontByCSSName(t);if(A(i?i.name:t),C(i?i.variations:[]),i.variations&&i.variations[0]){var n=i.variations.includes("n4")?"n4":i.variations[0],a=la.a.getFontWeightFromString(n),r=a.style,s=a.weight;if(o)r!==j&&e&&o({fontStyle:r}),s!==w&&e&&o({fontWeight:s});else{var l=d;r!==j&&e&&(l=la.a.applyInlineStyle({key:na.a.FontStyle,value:r,editorState:l}),P(r)),s!==w&&e&&(l=la.a.applyInlineStyle({key:na.a.FontWeight,value:s,editorState:l}),k(s)),h(l)}}}}),[y]),Object(po.useEffect)((function(){var t=i?[].concat(ir(s.global),ir(s.project)).find((function(t){return t.name===f})):n?[].concat(ir(l.global),ir(l.project)).find((function(t){return t.name===v})):void 0,e=tr({},Na.b);if(t&&t.name!==Na.a.Unstyled){if(t.cssProperties.fontFamily&&!y.length){e.fontFamily=t.cssProperties.fontFamily,T(t.cssProperties.fontFamily);var o=window.RM.constructorRouter.fonts.findFontByCSSName(t.cssProperties.fontFamily);A(o?o.name:t.cssProperties.fontFamily),C(o?o.variations:[])}if(t.cssProperties.fontWeight&&!L.length){var a="initial"===t.cssProperties.fontWeight?t.cssProperties.fontWeight:Object(ra.c)(t.cssProperties.fontWeight);e.fontWeight=a,k(a)}if(t.cssProperties.fontStyle&&!z.length){var r=t.cssProperties.fontStyle;e.fontStyle=r,P(r)}}else{var c=tr({},Na.b);if(m(c),!y.length){T(c.fontFamily);var d=window.RM.constructorRouter.fonts.findFontByCSSName(c.fontFamily);A(d?d.name:c.fontFamily),C(d?d.variations:[])}}}),[f,v,s,l,d]);var F=nr(Object(po.useState)([]),2),U=F[0],N=F[1],H=nr(Object(ia.d)(),1)[0];Object(po.useEffect)((function(){if(I&&w&&j){var t=H[Object(ia.c)({fontFamily:I,fontWeight:w,fontStyle:j})];if(y.length&&I!==y[0])return;if(t){var i=t.variations,n=i&&i.length?i:[];N(n),B(function(t,e){return Object.keys(t).reduce((function(i,n){return e.findIndex((function(t){return t.code===n}))>-1?tr(tr({},i),{},er({},n,t[n])):i}),{})}(D,n)),(n.length||n.length!==U.length)&&e()}else N([]),e()}}),[I,w,j,H]);var V=nr(Object(po.useState)(!1),2),W=V[0],G=V[1],q=Object(po.useContext)(ho.a).modelSet;return mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0,onMouseEnter:function(){return G(!0)},onMouseLeave:function(){return G(!1)}},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center",position:"relative",cursor:"pointer",onClick:function(){return g(ul.FontsList)}},mo.a.createElement(sr,{"aria-labelledby":"select-text-font",onClick:function(){return g(ul.FontsList)},textStyle:"small",display:"block",variant:"clean",_css:I},$||I),mo.a.createElement(go.m,null,mo.a.createElement(lr,{"aria-labelledby":"select-text-font-icon",onClick:function(){return g(ul.FontsList)},variant:"clean"},mo.a.createElement(go.Gb,{color:W?"black":"gray"}))))),U.length?mo.a.createElement(mo.a.Fragment,null,U.map((function(t,e){var n=D[t.code]||t.defaultValue,a=function(e){B(tr(tr({},D),{},er({},t.code,e)));var n=i?"'".concat(t.code,"' ").concat(e):[t.code,e].join("|"),a=ir(b),r=a.findIndex((function(e){return e.includes(t.code)}));r>-1?a[r]=n:a.push(n),i&&o?o({fontVariationSettings:a.join(", ")}):h(la.a.applyInlineStyle({key:na.a.FontVariable,value:a,editorState:d}))};return mo.a.createElement(Vo.a,{key:e,showBorderTop:!1,small:!0,isRange:!0,min:t.min,max:t.max,value:n,onChange:a},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(cr,{textStyle:"small"},t.name),mo.a.createElement(go.m,{width:50},mo.a.createElement(go.H,{textAlign:"right",textStyle:"small",value:n,min:t.min,max:t.max,onChange:function(t){a(Number(t.target.value))},p:0,border:"none !important"}))))}))):x&&x.length>1?mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(ea,{container:a,items:ir(x).sort(rr).map((function(t){return{value:t,label:Ja.WEIGHTS[t]}})),value:la.a.getFontWeightString(w,j),labelStyle:"\n              font-family: ".concat(I,", sans-serif;\n              font-weight: ").concat(w,";\n              font-style: ").concat(j,";\n              line-height: 1;\n            "),itemStyleFn:function(t){var e=la.a.getFontWeightFromString(t.value),i=e.style,n=e.weight;return"\n                font-family: ".concat(I,", sans-serif;\n                font-weight: ").concat(n,";\n                font-style: ").concat(i,";\n                color: #000;\n              ")},onSelect:function(t){var e=la.a.getFontWeightFromString(t.value),n=e.style,a=e.weight;if(P(n),k(a),q({preventClose:!1}),i&&o)o({fontWeight:a,fontStyle:n});else{var r=la.a.applyInlineStyle({key:na.a.FontStyle,value:n,editorState:d}),s=la.a.applyInlineStyle({key:na.a.FontWeight,value:a,editorState:r});h(s)}}})):void 0)},hr=i("38uW"),ur=i("LDvm"),pr=i("w+s/"),mr=i("xG9w");function gr(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function fr(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?gr(Object(i),!0).forEach((function(e){vr(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):gr(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function vr(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function br(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function yr(t){return function(t){if(Array.isArray(t))return kr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||wr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||wr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wr(t,e){if(t){if("string"==typeof t)return kr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?kr(t,e):void 0}}function kr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Sr=Object(uo.e)(go.ib).withConfig({displayName:"TypographyPanel___StyledRoundButton"})(["&:hover g{fill:none;stroke:",";}"],(function(t){return t._css})),xr=function(t){var e=t.isLinked,i=t.disabled,n=void 0!==i&&i,o=t.onClick,a=_r(Object(po.useState)(!1),2),r=a[0],s=a[1];return mo.a.createElement(go.m,{display:"inline-block",onMouseEnter:function(){return s(!n)},onMouseLeave:function(){return s(!1)}},mo.a.createElement(Sr,{color:e?"blue":"white",hoverColor:e?"blue":"white",activeColor:e?"blue":"white",mr:0,size:32,onClick:o,disabled:n,_css:e&&!r?"none":"white"},e?r?mo.a.createElement(go.O,{color:"white"}):mo.a.createElement(go.P,{color:"white"}):r?mo.a.createElement(go.P,{color:"gray"}):mo.a.createElement(go.O,{color:"gray"})))},Cr=Object(uo.e)(go.n).withConfig({displayName:"TypographyPanel___StyledButton"})(["text-overflow:ellipsis;overflow:hidden;white-space:nowrap;text-align:left;line-height:1;"]),Or=Object(uo.e)(go.ib).withConfig({displayName:"TypographyPanel___StyledRoundButton2"})(["&:hover svg{color:#fff !important;}"]),jr=Object(uo.e)(go.k).withConfig({displayName:"TypographyPanel___StyledArrowUndoIcon"})(["position:relative;left:-1px;top:-1px;"]),Pr=Object(uo.e)(go.ib).withConfig({displayName:"TypographyPanel___StyledRoundButton3"})(["&:hover svg{color:#fff !important;}"]),Er=Object(uo.e)(go.n).withConfig({displayName:"TypographyPanel___StyledButton2"})(["vertical-align:middle;"]),Ir=Object(uo.e)(go.m).withConfig({displayName:"TypographyPanel___StyledBox"})(["user-select:none;"]),Tr=function(t,e){var i=t.style,n=t.onHeightChanged,o=Object(po.useContext)(Cl).selectedFont,a=Object(po.useContext)(ho.a).model,r=_r(a.useSharedState({partial:!1}),2),s=r[0],l=r[1],c=_r(Object(ia.g)(),2),d=c[0],h=c[1],u=Object(po.useMemo)((function(){return a.project.get("_id")}),[a]),p=Object(po.useMemo)((function(){return a.user.get("_id")}),[a]),m=Object(po.useContext)(Ka).navigate,g=Object(po.useMemo)((function(){return la.a.getCurrentBlock(s)}),[s]);Object(po.useEffect)((function(){o&&l(la.a.applyInlineStyle({editorState:s,key:na.a.FontFamily,value:o.css_name}))}),[o]);var f=Object(po.useMemo)((function(){var t=Object(ra.b)({editorState:s});return[].concat(yr(d.global),yr(d.project)).find((function(e){return e.name===t}))}),[s,d]),v=Object(po.useMemo)((function(){var t=f&&f.name!==Na.a.Unstyled,e=t&&Object(ra.c)(null==f?void 0:f.cssProperties.fontSize),i=t&&Object(ra.c)(null==f?void 0:f.cssProperties.lineHeight),n=t&&Object(ra.c)(null==f?void 0:f.cssProperties.letterSpacing,!0),o=la.a.getCurrentInlineStyles(s,na.a.FontSize),a=la.a.getCurrentInlineStyles(s,na.a.LetterSpacing),r=Object(hr.a)({block:g}),l=la.a.getCurrentInlineStyles(s,na.a.IsLinkedFontSize),c=la.a.getCurrentInlineStyles(s,na.a.IsLinkedLetterSpacing),d=(null==o?void 0:o.length)?parseInt(o[0]):e||Na.b.fontSize,h=(null==a?void 0:a.length)?parseFloat(a[0]):n||0,u="number"==typeof r?r:i||Na.b.lineHeight;return{fontSize:d,lineHeight:u,ratio:d/u,letterSpacing:h,fontSizeLinkStatus:!l||!l[0]||void 0===l[0]||"true"===l[0],letterSpacingLinkStatus:!(!c||!c[0]||void 0===c[0])&&"true"===c[0]}}),[s,f]),b=v.fontSize,y=v.lineHeight,_=v.ratio,w=v.letterSpacing,k=v.fontSizeLinkStatus,S=v.letterSpacingLinkStatus,x=Object(po.useMemo)((function(){var t=la.a.getStyleFromSelection(s),e=Object(pr.a)({editorState:s}),i=Boolean(e&&Object.keys(e).length>0),n=!!Object(va.d)({editorState:s}),o=!!Object(hr.a)({editorState:s});return f?{hasOneEditedStyle:Boolean(t&&(Object.keys(t).length||i||n||o)),hasMultipleEditedStyles:la.a.doesSelectionHaveStyle(s)}:{hasOneEditedStyle:!1,hasMultipleEditedStyles:!1}}),[s,f,d.global,d.project]),C=x.hasOneEditedStyle,O=x.hasMultipleEditedStyles,j=Object(po.useMemo)((function(){var t=la.a.getSelectedBlocks(s),e=s.getCurrentContent(),i=t.map((function(t){return e.getBlockForKey(t)})),n=i.map((function(t){return Object(ra.b)({editorState:s,block:t})})),o=la.a.getInlineStyleForSelection({editorState:s,key:na.a.FontSize}),a=Object(mr.uniq)(i.map((function(t){return Object(hr.a)({editorState:s,block:t})||Na.b.lineHeight})));return{isMultipleBlockSelected:n.length>1,hasDifferentStyles:n.some((function(t){return t!==n[0]})),hasMultipleFontSizes:o.length>1,hasMultipleLineHeights:a.length>1}}),[f,s]),P=j.isMultipleBlockSelected,E=j.hasDifferentStyles,I=j.hasMultipleFontSizes,T=j.hasMultipleLineHeights,M=function(t){return d.global.includes(t)?ba.c.global:ba.c.project},$=function(){var t=function(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){br(a,n,o,r,s,"next",t)}function s(t){br(a,n,o,r,s,"throw",t)}r(void 0)}))}}(regeneratorRuntime.mark((function t(e){var i,n,o,a,r,c,m,g,f,v,b;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=M(e),n=yr(d[i]),!((o=n.findIndex((function(t){return t.name===e.name})))>-1)){t.next=20;break}return a=n[o],r=la.a.getStyleFromSelection(s),c=Object.keys(r).reduce((function(t,e){return fr(fr({},t),{},vr({},e,Object(ra.f)(e,r[e])))}),{}),1===(m=la.a.getSelectedBlocks(s)).length&&m[0]&&(g=s.getCurrentContent().getBlockForKey(m[0]),(f=Object(pr.a)({block:g}))&&(c.paddingTop="number"==typeof f.top?f.top:a.cssProperties.paddingTop,c.paddingLeft="number"==typeof f.left?f.left:a.cssProperties.paddingLeft,c.paddingRight="number"==typeof f.right?f.right:a.cssProperties.paddingRight,c.paddingBottom="number"==typeof f.bottom?f.bottom:a.cssProperties.paddingBottom),(v=Object(va.d)({block:g}))&&(c.textAlign=String(v).replace("align-","")),(b=Object(hr.a)({block:g}))&&(c.lineHeight=b)),n[o]=fr(fr({},n[o]),{},{cssProperties:fr(fr({},n[o].cssProperties),c||{})}),t.next=12,h(fr(fr({},d),{},vr({},i,n)));case 12:if(i!==ba.c.global){t.next=17;break}return t.next=15,Object(ur.S)({userId:p,styles:n});case 15:t.next=19;break;case 17:return t.next=19,Object(ur.P)({projectId:u,styles:n});case 19:l(la.a.forceSelection(la.a.clearStylesFromBlock({editorState:s}),s.getSelection()));case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=(C||O)&&!(P&&E),R=_r(Object(po.useState)(!1),2),D=R[0],B=R[1],L=Object(po.useMemo)((function(){return s.getSelection().isCollapsed()}),[s]);return mo.a.createElement(Ho,{ref:e,style:i,scrollable:!0},mo.a.createElement(zo.Consumer,null,(function(t){var e,i,o=t.tooltipContainer,a=t.dropdownContainer;return(mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0,onMouseEnter:function(){return B(!0)},onMouseLeave:function(){return B(!1)}},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1,cursor:"pointer"},mo.a.createElement(Cr,{"aria-labelledby":"select-text-style",display:"block",onClick:function(){return m(ul.Styles)},variant:"clean",width:"100%"},mo.a.createElement(go.Cb,{textStyle:"small",color:A?"tomato":"black"},f?P&&E?"...":f.label:"No style")),mo.a.createElement(go.m,null,A?mo.a.createElement(go.B,{alignItems:"center",justifyContent:"flex-end"},mo.a.createElement(go.Eb,{text:"Reset selection to style",indent:4,container:o},mo.a.createElement(Or,{mr:2,hoverColor:"tomato",color:"gray",size:24,unstyledHover:!0,onClick:function(){return f&&function(t){var e=la.a.getSelectedBlocks(s),i=s.getCurrentContent(),n=e.reduce((function(e,n){var o=i.getBlockForKey(n),a=la.a.clearStylesFromBlock({editorState:e,block:o});return a=Object(ra.g)({editorState:a,styleName:t.name})}),s);l(la.a.forceSelection(n,s.getSelection()))}(f)}},mo.a.createElement(jr,{color:"white",height:14,width:13}))),mo.a.createElement(go.Eb,{text:"Update style",indent:4,container:o},mo.a.createElement(Pr,{disabled:O&&!C,mr:0,hoverColor:"tomato",color:"gray",size:24,unstyledHover:!0,onClick:function(){return f&&$(f)}},mo.a.createElement(go.i,{color:"white",height:14,width:13})))):mo.a.createElement(Er,{onClick:function(){return m(ul.Styles)},variant:"clean"},mo.a.createElement(go.Gb,{color:D?"black":"gray"})))))),mo.a.createElement(go.m,{px:16,mb:16,position:"relative"},mo.a.createElement(dr,{dropdownPortal:a,onHeightChanged:n})),mo.a.createElement(go.m,{px:16,pb:10},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"center"},mo.a.createElement(go.m,{textAlign:"center",width:"100%"},mo.a.createElement(go.B,{justifyContent:"center"},mo.a.createElement(go.C,{color:"gray"}))),mo.a.createElement(go.m,{width:"100%"},mo.a.createElement(go.B,{width:58,justifyContent:"center"},mo.a.createElement(xr,{"aria-labelledby":"typography-font-size-linked",isLinked:k,onClick:function(){var t=!k;ka.d.sendEvent(ka.b.TypographyPanel,{eventLabel:"Line-height linking ".concat(t?"on":"off")}),l(la.a.applyInlineStyle({key:na.a.IsLinkedFontSize,value:String(t),editorState:s}))}}))),mo.a.createElement(go.m,{textAlign:"center",width:"100%"},mo.a.createElement(go.B,{justifyContent:"center"},mo.a.createElement(go.M,{color:"gray"})))),mo.a.createElement(Ir,{mx:-1},mo.a.createElement(go.D,{ratio:_,fontSize:b,lineHeight:y,linked:k,fontSizeLinked:S,multipleFontSizes:I,multipleLineHeights:T,fontSizeDisabled:L,lineHeightDisabled:L,onChange:function(t){var e=s;if(S){var i=function(t){var e=t.letterSpacing,i=t.fontSize,n=e+e/i*(t.newFontSize-i);return parseFloat((Math.round(100*n)/100).toFixed(2))}({letterSpacing:w,fontSize:b,newFontSize:t.fontSize});e=la.a.applyInlineStyle({key:na.a.LetterSpacing,value:i,editorState:e})}t.fontSize!==b&&(e=la.a.applyInlineStyle({key:na.a.FontSize,value:t.fontSize,editorState:e})),t.lineHeight!==y&&(e=Object(hr.d)({editorState:e,lineHeight:t.lineHeight})),l(e)},onChangeRatio:function(){}})),mo.a.createElement(go.B,{justifyContent:"center",mb:"8px"},mo.a.createElement(go.m,{width:32},mo.a.createElement(xr,{"aria-labelledby":"typography-letter-spacing-linked",isLinked:S,disabled:0===w,onClick:function(){var t=!S;ka.d.sendEvent(ka.b.TypographyPanel,{eventLabel:"Line-width linking ".concat(t?"on":"off")}),l(la.a.applyInlineStyle({key:na.a.IsLinkedLetterSpacing,value:String(t),editorState:s}))}}))),mo.a.createElement(go.B,{alignItems:"flex-end",justifyContent:"center"},mo.a.createElement(go.m,{textAlign:"right"},mo.a.createElement(go.Cb,{textStyle:"small",color:"gray"},"a")),mo.a.createElement(go.m,{width:58},mo.a.createElement(go.Y,{"aria-labelledby":"typography-letter-spacing",textAlign:"center",placeholder:"LetterSpacing",textStyle:"regular",direction:"x",value:(e=w,i=2,Math.floor(e*Math.pow(10,i))/Math.pow(10,i)),step:.1,min:-99,max:999,color:S?"blue":void 0,onChange:function(t){var e=t||0;l(la.a.applyInlineStyle({key:na.a.LetterSpacing,value:e,editorState:s}))}})),mo.a.createElement(go.m,{textAlign:"left"},mo.a.createElement(go.Cb,{textStyle:"small",color:"gray"},"b"))))))})))},Mr=mo.a.forwardRef(Tr),$r=i("YqYG");function Ar(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Rr(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ar(Object(i),!0).forEach((function(e){Dr(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ar(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Dr(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Br(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Lr(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Br(a,n,o,r,s,"next",t)}function s(t){Br(a,n,o,r,s,"throw",t)}r(void 0)}))}}function zr(t){return function(t){if(Array.isArray(t))return Nr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ur(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Ur(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ur(t,e){if(t){if("string"==typeof t)return Nr(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Nr(t,e):void 0}}function Nr(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Hr=function(t){var e={color:"gray"};switch(t.provider){case"google":return mo.a.createElement(go.F,e);case"typekit":return mo.a.createElement(go.Kb,e);case"typetoday":return mo.a.createElement(go.Jb,e);case"webtype":return mo.a.createElement(go.Qb,e);default:return null}},Vr=Object(uo.e)(go.m).withConfig({displayName:"FontsList___StyledBox"})(["border-radius:8px 8px 0 0;"]),Wr=Object(uo.e)(go.Cb).withConfig({displayName:"FontsList___StyledText"})(["font-family:",",sans-serif;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;text-align:left;"],(function(t){return t._css})),Gr=Object(uo.e)(go.n).withConfig({displayName:"FontsList___StyledButton"})(["&:hover svg{color:",";opacity:1;}"],(function(t){return t._css2})),qr=Object(uo.e)(go.n).withConfig({displayName:"FontsList___StyledButton2"})(["&:hover svg{color:",";opacity:1;}"],(function(t){return t._css3})),Kr=Object(uo.e)(go.n).withConfig({displayName:"FontsList___StyledButton3"})(["&:hover{color:",";opacity:1;}"],(function(t){return t._css4})),Yr=Object(uo.e)(go.n).withConfig({displayName:"FontsList___StyledButton4"})(["&:hover{color:",";opacity:1;}"],(function(t){return t._css5})),Xr=function(t,e){var i=t.style,n=t.headerSlot,o=t.currentFontFamily,a=Object(po.useContext)(ho.a).model,r=Object(po.useContext)(Ka),s=r.goBack,l=r.navigate,c=Object(po.useContext)(Cl).setSelectedFont,d=a.project.get("num_id"),h=a.user.get("_id"),u=Fr(Object(po.useState)([]),2),p=u[0],m=u[1],g=window.RM.constructorRouter.fonts.edit_params;g.on("change",(function(t){y()}));var f=Fr(Object(po.useState)(null),2),v=f[0],b=f[1],y=function(){m(zr(g.get("fonts")).sort((function(t,e){return t.name.localeCompare(e.name)})))};Object(po.useEffect)((function(){y()}),[]);var _=Fr(Object(ia.g)(),1)[0],w=Fr(a.useSharedState({partial:!1}),1)[0],k=Object(po.useMemo)((function(){var t=Object(ra.b)({editorState:w});if(t)return[].concat(zr(_.global),zr(_.project)).find((function(e){return e.name===t}))}),[w,_]),S=Object(po.useMemo)((function(){var t=k?[String(k.cssProperties.fontFamily)]:la.a.getCurrentInlineStyles(w,na.a.FontFamily);if(t&&t.length){var e=p.find((function(e){return e.css_name===t[0]}));if(e&&e.hidden&&!e.is_personal)return e}}),[w,k,p]),x=function(){var t=Lr(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.RM.constructorRouter.fonts.changeFontHidden(e.css_name,!0,!window.RM.constructorRouter.isOwner&&la.a.canUseCustomFonts(a.user)?window.RM.constructorRouter.mag.user.get("_id"):h,d);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=Lr(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.RM.constructorRouter.fonts.changeFontHidden(e.css_name,!1,!window.RM.constructorRouter.isOwner&&la.a.canUseCustomFonts(a.user)?window.RM.constructorRouter.mag.user.get("_id"):h,d);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=Fr(Object(po.useState)(Ft.a.textWidget.fontsListPanelDefaultHeight),2),j=O[0],P=O[1];Object(po.useEffect)((function(){var t=a.project.edit_params.get("controls");t&&t.FontsList&&P(t.FontsList)}),[]);var E=Object(po.useRef)(null);return Object(po.useEffect)((function(){E.current&&E.current.scrollIntoView()}),[E.current]),mo.a.createElement(Ho,{ref:e,style:i,resizable:!0,onResizeComplete:function(t){P(t);var e=a.project.edit_params.get("controls");a.project.edit_params.set("controls",Rr(Rr({},e),{},{FontsList:t})),a.project.edit_params.save()},height:j},n||null,mo.a.createElement(Vr,{height:"calc(100% - 40px - 44px)",bg:"white"},mo.a.createElement(go.jb,null,(function(t){var e=t.ref;return(mo.a.createElement(go.m,{ref:e,pt:10},p.filter((function(t){return!t.hidden||S&&t.css_name===S.css_name})).map((function(t,e){return mo.a.createElement(go.m,{ref:o&&o===t.css_name?E:void 0,key:"".concat(t.css_name,"-").concat(e),pr:16,position:"relative",onClick:function(){return function(t){c&&c(t),s()}(t)},cursor:"pointer"},mo.a.createElement(go.m,{bg:o&&o===t.css_name?"blue":"gray",opacity:o&&o===t.css_name||v===e?.2:0,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0}),mo.a.createElement(go.B,{pl:16,height:26,alignItems:"center",justifyContent:"space-between",onMouseEnter:function(){return b(e)},onMouseLeave:function(){return b(null)},position:"relative",zIndex:1},mo.a.createElement(Wr,{textStyle:"small",width:"100%",_css:t.css_name},t.name),v===e&&mo.a.createElement(go.B,{height:16,width:84,alignItems:"center",justifyContent:"flex-end"},S&&S.css_name===t.css_name?mo.a.createElement(go.n,{onClick:function(e){e.stopPropagation(),C(t)},display:"flex",height:12,variant:"clean",disabled:!a.doesUserHaveAccess},mo.a.createElement(go.eb,{color:"gray"})):mo.a.createElement(mo.a.Fragment,null,t.is_personal?mo.a.createElement(go.m,{mr:12},mo.a.createElement(Gr,{onClick:function(e){e.stopPropagation(),c&&c(t),l(ul.FontUploader)},display:"flex",height:16,variant:"clean",_css2:Object(_a.themeGet)("colors.black")},"‎",mo.a.createElement(go.lb,{color:"gray"}))):mo.a.createElement(go.B,{mr:12,height:16,alignItems:"center"},mo.a.createElement(Hr,{provider:t.provider})),mo.a.createElement(qr,{onClick:function(e){e.stopPropagation(),x(t)},display:"flex",height:12,variant:"clean",disabled:"custom"===t.provider&&!a.doesUserHaveAccess,_css3:Object(_a.themeGet)("colors.tomato")},mo.a.createElement(go.w,{color:"gray"}))))))}))))}))),mo.a.createElement(go.B,{alignItems:"center",py:10},mo.a.createElement(go.m,{width:80,textAlign:"center"},mo.a.createElement(Kr,{textStyle:"small",color:"darkGray",onClick:function(){window.RM.views.fontExplorer.toggle()},variant:"clean",_css4:Object(_a.themeGet)("colors.black")},"Library")),mo.a.createElement(go.m,{width:"2px",height:24,borderRadius:2,bg:"gray"}),mo.a.createElement(go.m,{width:80,textAlign:"center"},mo.a.createElement(Yr,{textStyle:"small",color:"darkGray",onClick:function(){la.a.canUseCustomFonts(a.user)?(c&&c(void 0),l(ul.FontUploader)):new $r.default({$parent:document.querySelector("body > .popups"),router:window.RM.constructorRouter,opts:{type:"type-upload-fonts",is_contributor:!window.RM.constructorRouter.isOwner,owner_email:a.user.get("email")},alert_source:"use custom font"}).render()},variant:"clean",_css5:Object(_a.themeGet)("colors.black")},"Upload"))))},Zr=mo.a.forwardRef(Xr);function Jr(){return(Jr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Qr(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var ts=Object(uo.e)(go.n).withConfig({displayName:"PanelFooter___StyledButton"})(["&:disabled{opacity:1;}"]),es=function(t){var e=t.cancelText,i=void 0===e?"Cancel":e,n=t.doneText,o=void 0===n?"Done":n,a=t.cancelAction,r=t.doneAction,s=t.cancelDisabled,l=t.doneDisabled,c=Qr(t,["cancelText","doneText","cancelAction","doneAction","cancelDisabled","doneDisabled"]);return(mo.a.createElement(go.B,Jr({alignItems:"flex-end",justifyContent:"space-between",height:64,pb:10},c),mo.a.createElement(go.m,null,mo.a.createElement(go.n,{"aria-labelledby":"panel-action-cancel",variant:"clean",onClick:a,disabled:s},i)),mo.a.createElement(go.m,null,mo.a.createElement(ts,{"aria-labelledby":"panel-action-done",variant:"clean",onClick:r,disabled:l,color:l?"gray":"blue"},o))))};function is(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ns(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?is(Object(i),!0).forEach((function(e){os(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):is(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function os(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function as(t){return function(t){if(Array.isArray(t))return ds(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||cs(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rs(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ss(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){rs(a,n,o,r,s,"next",t)}function s(t){rs(a,n,o,r,s,"throw",t)}r(void 0)}))}}function ls(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||cs(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cs(t,e){if(t){if("string"==typeof t)return ds(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ds(t,e):void 0}}function ds(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var hs=Object.keys(Ja.WEIGHTS),us=Object(uo.e)(go.H).withConfig({displayName:"FontUploader___StyledInlineInput"})(["border-bottom:none !important;padding:0;"]),ps=Object(uo.e)(go.n).withConfig({displayName:"FontUploader___StyledButton"})(["&:hover{color:",";}"],(function(t){return t._css})),ms=function(t,e){var i=t.style,n=t.headerSlot,o=Object(po.useContext)(ho.a).model,a=Object(po.useContext)(Ka).goBack,r=Object(po.useContext)(Cl).selectedFont,s=ls(Object(po.useState)(null),2),l=s[0],c=s[1],d=ls(Object(po.useState)(""),2),h=d[0],u=d[1],p=ls(Object(po.useState)([]),2),m=p[0],g=p[1],f=ls(Object(po.useState)(null),2),v=f[0],b=f[1],y=ls(Object(po.useState)(!1),2),_=y[0],w=y[1],k=o.project.get("num_id"),S=o.user.get("_id");Object(po.useEffect)((function(){r&&(c(r._id),Object(ur.g)(r._id).then((function(t){var e=t.data;u(e.name),g(e.variations)})))}),[]),Object(po.useEffect)((function(){v&&setTimeout((function(){b(null)}),4e3)}),[v]);var x=ls(Object(po.useState)(null),2),C=x[0],O=x[1],j=function(){var t=ss(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return w(!0),t.prev=1,t.next=4,Object(ur.U)(e);case 4:i=t.sent,n={type:C||"n4"},i.woffUrl?n.woff=i.woffUrl:i.woff2Url?n.woff2=i.woff2Url:i.otfUrl?n.otf=i.otfUrl:i.ttfUrl&&(n.ttf=i.ttfUrl),g([].concat(as(m),[n])),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),b("Uploading error");case 13:w(!1),O(null);case 15:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=ss(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(ur.b)({is_personal:!0,name:h,variations:m,mag_user:!window.RM.constructorRouter.isOwner&&la.a.canUseCustomFonts(o.user)?window.RM.constructorRouter.mag.user.get("_id"):S,mag_num_id:k});case 3:return e=t.sent,i=e.data,t.next=7,window.RM.constructorRouter.fonts.addFonts([ns(ns({},i),{},{variations:i.variations.map((function(t){return t.type}))})],"font-upload");case 7:a(),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),b("Saving error");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(){return t.apply(this,arguments)}}(),E=function(){var t=ss(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l){t.next=14;break}return t.prev=1,t.next=4,Object(ur.J)(l,{name:h,variations:m,mag_user:!window.RM.constructorRouter.isOwner&&la.a.canUseCustomFonts(o.user)?window.RM.constructorRouter.mag.user.get("_id"):S,mag_num_id:k});case 4:return e=t.sent,i=e.data,t.next=8,window.RM.constructorRouter.fonts.addFonts([ns(ns({},i),{},{variations:i.variations.map((function(t){return t.type}))})],"font-upload");case 8:a(),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),b("Update error");case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(){return t.apply(this,arguments)}}(),I=m.map((function(t){return t.type})),T=new Set(I).size!==I.length,M=m.some((function(t){return"v"===t.type})),$=hs.filter((function(t){return m.length>1&&!M?"v"!==t:t})).map((function(t){return{value:t,label:Ja.WEIGHTS[t]}})),A=Object(po.useRef)(null),R=Object(po.useRef)(null);return mo.a.createElement(Ho,{ref:e,style:i},n||null,mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(us,{textStyle:"small",value:h,onChange:function(t){return u(t.target.value)},placeholder:"Font name"}))),mo.a.createElement(go.m,{position:"relative",ref:R}),mo.a.createElement(go.m,{px:16},m.map((function(t,e){return mo.a.createElement(Vo.a,{key:e,showBorderTop:!1,small:!0},mo.a.createElement(ea,{container:R?R.current:void 0,items:$,value:t.type,onSelect:function(t){var i=as(m);i[e].type=t.value,g(i)},rightIcon:mo.a.createElement(go.n,{onClick:function(){var t=as(m);t.splice(e,1),g(t)},variant:"clean"},mo.a.createElement(go.w,{color:"gray"}))}))})),M?void 0:mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!1,small:!0},mo.a.createElement(ea,{container:R?R.current:void 0,items:$,value:void 0,onSelect:function(t){O(t.value),A.current&&A.current.click()}},(function(t){var e=t.toggleDropdown,i=t.ref;return(mo.a.createElement(go.m,{ref:i},mo.a.createElement(ps,{variant:"clean",onClick:_?void 0:e,color:v?"red":"darkGray",textStyle:"small",_css:Object(_a.themeGet)("colors.black")},v||(_?"Uploading...":m.length?"Add another weight":"Add weight"))))}))),mo.a.createElement(go.A,{ref:A,onChange:j,dropFile:!0,readFileData:!1,accept:"font/ttf,font/otf,font/woff,font/woff2"})),mo.a.createElement(es,{cancelAction:a,doneDisabled:!m.length||!h.length||T,doneAction:l?E:P})))},gs=mo.a.forwardRef(ms),fs=i("xk4V"),vs=i.n(fs);function bs(){return(bs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function ys(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return _s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ws=Object(uo.e)(go.m).withConfig({displayName:"PanelDropdown___StyledBox"})(["opacity:0.24;"]),ks=Object(uo.e)(go.n).withConfig({displayName:"PanelDropdown___StyledButton"})(["text-align:left;width:100%;&:hover{color:",";opacity:1;}"],(function(t){return t._css})),Ss=function(t){var e=t.container,i=t.listItems,n=t.headerIcons,o=t.children,a=t.isCleanVariant,r=void 0===a||a,s=t.p,l=t.width,c=ys(Object(po.useState)(!1),2),d=c[0],h=c[1],u=Object(po.useContext)(ho.a).modelSet,p=ys(Object(po.useState)(null),2),m=p[0],g=p[1],f=ys(Object(po.useState)(null),2),v=f[0],b=f[1],y=Object(po.useMemo)((function(){return m?m.getBoundingClientRect():{}}),[m]),_=Object(Wo.a)(m,v,{placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,-1*y.height||0]}}]}),w=_.styles,k=_.attributes,S=function(t){t.target&&m&&m.contains(t.target)||(u({preventClose:!1}),h(!1))};Object(po.useEffect)((function(){return function(){u({preventClose:!1})}}),[]),Object(po.useEffect)((function(){return d?window.addEventListener("click",S):window.removeEventListener("click",S),function(){window.removeEventListener("click",S)}}),[d]);var x=mo.a.createElement(go.m,bs({bg:"white",width:l||"calc(100% + 8px + 8px)",borderRadius:8,border:"1px solid",borderColor:"#F0F0F0",p:s||"16px 24px",zIndex:105,ref:b,style:w.popper},k.popper),n&&n.length?mo.a.createElement(go.B,{borderBottom:"1px solid",borderColor:"#EEEEEE",alignItems:"center",justifyContent:"flex-start",pb:14,mb:2},n.map((function(t,e){return mo.a.createElement(go.ib,{mr:e===n.length-1?0:3,key:e,onClick:t.onClick,hoverColor:"black",color:"gray",size:24,unstyledHover:!0},t.icon)}))):void 0,mo.a.createElement(go.m,null,i.map((function(t,e){return function(t){return!!t.separator}(t)?mo.a.createElement(ws,{key:e,mt:2,mb:1,height:2,bg:"gray"}):mo.a.createElement(go.m,{key:e,mb:1},mo.a.createElement(ks,{onClick:t.onClick,variant:r?"clean":"unstyled",_css:Object(_a.themeGet)("colors.blue")},"string"==typeof t.title?mo.a.createElement(go.Cb,{textStyle:"small"},t.title):t.title))}))));return mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(go.m,{position:"relative",cursor:"pointer",ref:g},o({toggleDropdown:function(){u({preventClose:!d}),h(!d)}})),d?e?To.a.createPortal(x,e):x:null)};function xs(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Cs(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Cs(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cs(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Os=function(t){return t.hasOwnProperty("tag")},js=Object(uo.e)(go.m).withConfig({displayName:"StylesListItem___StyledBox"})(["user-select:none;"]),Ps=function(t){var e=t.dropdownPortal,i=t.listItems,n=t.index,o=t.style,a=t.isActive,r=t.selectStyle,s=xs(Object(po.useState)(!1),2),l=s[0],c=s[1],d=xs(Object(po.useState)(!0),2),h=d[0],u=d[1],p=Object(po.useRef)(null);return Object(po.useEffect)((function(){a&&h&&p.current&&p.current.scrollIntoView(),u(!1)}),[p]),mo.a.createElement(Ss,{container:e?e.current:void 0,key:n,listItems:i},(function(t){var e=t.toggleDropdown;return(mo.a.createElement(js,{ref:p,position:"relative",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},cursor:"pointer",maxHeight:"80px",minHeight:"34px",overflow:"hidden"},mo.a.createElement(go.m,{bg:a?"blue":"gray",opacity:l||a?.2:0,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0}),mo.a.createElement(go.B,{maxHeight:"80px",minHeight:"34px",px:16,py:"8px",justifyContent:"space-between",alignItems:"center",position:"relative"},mo.a.createElement("div",{className:Os(o)?o.name:"".concat(o.name,"-preview"),onClick:function(){return r(o)},style:{width:"100%",padding:0,textAlign:"left",maxWidth:108,overflow:"hidden",whiteSpace:"nowrap",lineHeight:1}},o.label),mo.a.createElement(go.m,null,l?mo.a.createElement(go.n,{height:16,onClick:e,variant:"clean"},mo.a.createElement(go.Hb,{color:"black"})):void 0))))}))};function Es(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Is(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Is(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Is(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ts=Object(uo.e)(Ho).withConfig({displayName:"StylesList___StyledPanel"})(["background:linear-gradient(to right,#e2e2e2,#f4f4f4);"]),Ms=Object(uo.e)(go.n).withConfig({displayName:"StylesList___StyledButton"})(["vertical-align:middle;&:hover svg{color:",";}"],(function(t){return t._css}));function $s(t,e){var i=t.height,n=t.style,o=t.headerSlot,a=t.onResizeComplete,r=t.textStylesSection,s=t.setTextStylesSection,l=t.selectStyle,c=t.enterEditMode,d=t.duplicateStyle,h=t.currentStyle,u=t.moveStyle,p=t.deleteStyle,m=t.currentTextStyles,g=t.onAddClick,f=Object(po.useRef)(null),v=Es(Object(po.useState)(null),2),b=v[0],y=v[1];return mo.a.createElement(Ts,{ref:e,style:n,resizable:!0,onResizeComplete:a,height:i},o||null,mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0,borderTop:"none"},mo.a.createElement(go.n,{variant:"clean",onClick:function(){return s(ba.c.project)},mr:2},mo.a.createElement(go.Cb,{textStyle:"small",color:r===ba.c.project?"black":"darkGray"},"Project")),mo.a.createElement(go.n,{variant:"clean",onClick:function(){return s(ba.c.global)}},mo.a.createElement(go.Cb,{textStyle:"small",color:r===ba.c.global?"black":"darkGray"},"Global")))),mo.a.createElement(go.m,{height:"calc(100% - ".concat(o?40:0,"px - 40px - 40px)")},mo.a.createElement(go.jb,null,(function(t){var e=t.ref;return(mo.a.createElement(go.m,{ref:e},mo.a.createElement(go.m,{px:16,position:"relative",onMouseEnter:function(){return y(-1)},onMouseLeave:function(){return y(null)},onClick:function(){return l(null)},cursor:"pointer"},mo.a.createElement(go.m,{bg:h?"blue":"gray",opacity:-1!==b&&h&&h!==Na.a.Unstyled?0:.2,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0}),mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!1,small:!0},mo.a.createElement(go.Cb,{textStyle:"small"},"No style"))),m.map((function(t,e){var i=[{title:"Edit",onClick:function(){c(t)}},{title:"Duplicate",onClick:function(){d(t)}},{title:"Move to ".concat(r===ba.c.global?"Project":"Global"),onClick:function(){u(t,r===ba.c.global?ba.c.project:ba.c.global)}},{title:"Delete",onClick:function(){p(t)}}];return(mo.a.createElement(Ps,{index:e,key:"".concat(e,"-").concat(t.name),isActive:h===t.name,style:t,listItems:i,dropdownPortal:f,selectStyle:l}))}))))}))),mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderBottom:!1,small:!0},mo.a.createElement(go.m,{width:"100%",textAlign:"center"},mo.a.createElement(Ms,{"aria-labelledby":"add-text-style",onClick:g,variant:"clean",height:18,_css:Object(_a.themeGet)("colors.black")},mo.a.createElement(go.eb,{color:"darkGray"}))))),mo.a.createElement(go.m,{ref:f}))}var As=mo.a.forwardRef($s);function Rs(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ds(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Rs(Object(i),!0).forEach((function(e){Bs(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Rs(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Bs(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Ls(t){return function(t){if(Array.isArray(t))return Hs(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ns(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zs(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Fs(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){zs(a,n,o,r,s,"next",t)}function s(t){zs(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Us(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Ns(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ns(t,e){if(t){if("string"==typeof t)return Hs(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Hs(t,e):void 0}}function Hs(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Vs,Ws=function(t,e){var i=t.style,n=t.onHeightChanged,o=t.headerSlot,a=Object(po.useContext)(Ka).navigate,r=Object(po.useContext)(Cl),s=r.setSelectedTextStyle,l=r.setSelectedTextStyleSection,c=r.selectedTextStyleSection,d=r.setEditorStateBackup,h=Object(po.useContext)(ho.a).model,u=Object(po.useMemo)((function(){return h.project.get("_id")}),[h]),p=Object(po.useMemo)((function(){return h.user.get("_id")}),[h]),m=Us(h.useSharedState({partial:!1}),2),g=m[0],f=m[1],v=Us(Object(po.useState)(c||ba.c.project),2),b=v[0],y=v[1],_=Us(Object(ia.g)(),2),w=_[0],k=_[1],S=Object(po.useMemo)((function(){return b===ba.c.global?w.global:w.project}),[b,w]),x=Object(po.useMemo)((function(){return Object(ra.b)({editorState:g})}),[g]);Object(po.useEffect)((function(){x&&!c&&(w.global.some((function(t){return t.name===x}))&&b!==ba.c.global&&y(ba.c.global))}),[]),Object(po.useEffect)((function(){n()}),[]);var C=function(){var t=Fs(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Ls(S),(n=i.findIndex((function(t){return t.name===e.name})))>-1&&i.splice(n,0,Ds(Ds({},e),{},{name:"style-".concat(vs()()),label:"".concat(e.label," (Copy)")})),t.next=5,k(Ds(Ds({},w),{},Bs({},b,i)));case 5:if(b!==ba.c.global){t.next=10;break}return t.next=8,Object(ur.S)({userId:p,styles:i});case 8:t.next=12;break;case 10:return t.next=12,Object(ur.P)({projectId:u,styles:i});case 12:ka.d.sendEvent(ka.b.TextStyles,{eventLabel:("global"===b?"Global":"Project")+" style duplicate"});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=function(){var t=Fs(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Ls(S),(n=i.findIndex((function(t){return t.name===e.name})))>-1&&i.splice(n,1),t.next=5,k(Ds(Ds({},w),{},Bs({},b,i)));case 5:if(b!==ba.c.global){t.next=10;break}return t.next=8,Object(ur.S)({userId:p,styles:i});case 8:t.next=12;break;case 10:return t.next=12,Object(ur.P)({projectId:u,styles:i});case 12:ka.d.sendEvent(ka.b.TextStyles,{eventLabel:("global"===b?"Global":"Project")+" style delete"});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=Us(Object(po.useState)(Ft.a.textWidget.textStylesPanelDefaultHeight),2),P=j[0],E=j[1];Object(po.useEffect)((function(){var t=h.project.edit_params.get("controls");t&&t.TextStyles&&E(t.TextStyles)}),[]);var I=function(){var t=Fs(regeneratorRuntime.mark((function t(e,i){var n,o,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],o=[],i===ba.c.global?(n=Ls(S),(a=n.findIndex((function(t){return t.name===e.name})))>-1&&n.splice(a,1),o=[].concat(Ls(w.global),[e])):(o=Ls(S),(r=o.findIndex((function(t){return t.name===e.name})))>-1&&o.splice(r,1),n=[].concat(Ls(w.project),[e])),t.next=5,k({global:o,project:n});case 5:return t.next=7,Object(ur.P)({projectId:u,styles:n});case 7:return t.next=9,Object(ur.S)({userId:p,styles:o});case 9:y(i),ka.d.sendEvent(ka.b.TextStyles,{eventLabel:"Move to "+i});case 11:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}();return mo.a.createElement(As,{style:i,ref:e,height:P,currentStyle:x,onResizeComplete:function(t){E(t);var e=h.project.edit_params.get("controls");h.project.edit_params.set("controls",Ds(Ds({},e),{},{TextStyles:t})),h.project.edit_params.save()},headerSlot:o,onAddClick:function(){s&&s(void 0),l&&l(b),d&&d(g),ka.d.sendEvent(ka.b.TextStyles,{eventLabel:("global"===b?"Global":"Project")+" style create"}),a(ul.StyleEdit)},selectStyle:function(t){var e=Object(ra.h)({style:t,currentStyle:x,editorState:g});f(la.a.forceSelection(e,g.getSelection()))},moveStyle:I,deleteStyle:O,duplicateStyle:C,enterEditMode:function(t){s&&s(t),l&&l(b),a(ul.StyleEdit)},currentTextStyles:S,setTextStylesSection:y,textStylesSection:b})},Gs=mo.a.forwardRef(Ws);function qs(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ks(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){qs(a,n,o,r,s,"next",t)}function s(t){qs(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Ys(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Xs(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Xs(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xs(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Zs(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Js(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Zs(Object(i),!0).forEach((function(e){Qs(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Zs(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Qs(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tl(){return function(t,e){switch(e.type){case Vs.Reset:return Js({},e.payload);case Vs.SetInfo:return Js(Js({},t),e.payload);case Vs.SetCss:return Js(Js({},t),{},{cssProperties:Js(Js({},t.cssProperties),e.payload)});default:return t}}}function el(t,e){var i=t.style,n=t.headerSlot,o=t.onHeightChanged,a=t.onCancel,r=t.onDone,s=t.textStyle,l=t.setTextStyle,c=t.projectId,d=t.userId,h=t.initialTextStyle,u=t.canImediatelySave,p=Ys(Object(po.useState)(!1),2),m=p[0],g=p[1],f=Object(po.useCallback)(Ks(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,l({type:Vs.Reset,payload:Js({},h)});case 4:return t.next=6,g(!1);case 6:case"end":return t.stop()}}),t)}))),[m,h]),v=Ys(Object(po.useState)(s.cssProperties.color?Object(oa.e)(s.cssProperties.color):aa.c),2),b=v[0],y=v[1],_=function(t){return t.hasOwnProperty("tag")},w=function(){var t=Ft.a.AVAILABLE_TEXT_TAGS;if(_(s)){var e=s.tag,i=t.indexOf(e);return i>-1?t[i+1]||t[0]:e}return t[0]},k=Object(po.useMemo)((function(){switch("align-".concat(s.cssProperties.textAlign)){case va.a.AlignCenter:return go.b;case va.a.AlignRight:return go.e;case va.a.AlignJustify:return go.c;default:return go.d}}),[s.cssProperties.textAlign]),S=Object(po.useMemo)((function(){return"uppercase"===s.cssProperties.textTransform}),[s.cssProperties.textTransform]),x=Ys(Object(po.useState)([]),2),C=x[0],O=x[1];Object(po.useEffect)((function(){var t=!mr.default.isEqual(h,s);t!==m&&g(t);var e=[];Object.keys(s).forEach((function(t){s[t]!==h[t]&&e.push(t)})),Object.keys(s.cssProperties).forEach((function(t){s.cssProperties[t]!==h.cssProperties[t]&&e.push(t)})),O(e)}),[s]);var j=function(t){return C.includes(t)},P=Object(ra.c)(s.cssProperties.letterSpacing,!0),E=String(P).length>4;return mo.a.createElement(Ho,{ref:e,style:i,scrollable:!0},mo.a.createElement(zo.Consumer,null,(function(t){var e=t.dropdownContainer;return(mo.a.createElement(mo.a.Fragment,null,n||null,mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!1,small:!0},mo.a.createElement(go.H,{placeholder:"Style Name",value:s.label,onChange:function(t){l({type:Vs.SetInfo,payload:{label:t.target.value}})},p:"0 !important",border:"none !important",color:j("label")?"blue":"black"}))),mo.a.createElement(go.m,{px:16},mo.a.createElement(dr,{dropdownPortal:e,textStyle:_(s)?s:void 0,listStyle:_(s)?void 0:s,onChangeTextStyle:function(t){l({type:Vs.SetCss,payload:t})},onHeightChanged:o})),mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.Cb,{textStyle:"small"},"Text size"),mo.a.createElement(go.m,{width:50},mo.a.createElement(go.Y,{textAlign:"right",min:8,max:999,value:Object(ra.c)(s.cssProperties.fontSize),color:j("fontSize")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{fontSize:t}})}})))),_(s)&&mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.Cb,{textStyle:"small"},"Line height"),mo.a.createElement(go.m,{width:50},mo.a.createElement(go.Y,{min:8,max:999,textAlign:"right",value:Object(ra.c)(s.cssProperties.lineHeight),color:j("lineHeight")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{lineHeight:t}})}})))),mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.Cb,{textStyle:"small"},"Letter spacing"),mo.a.createElement(go.m,{width:50,mt:E?"-2px":void 0},mo.a.createElement(go.Y,{textAlign:"right",min:-99,max:999,step:.1,fontSize:E?16:void 0,direction:"y",value:P,color:j("letterSpacing")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{letterSpacing:t}})}})))),!_(s)&&mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.Cb,{textStyle:"small"},"Column width"),mo.a.createElement(go.m,{width:50},mo.a.createElement(go.Y,{textAlign:"right",min:0,max:999,step:1,direction:"y",value:Object(ra.c)(s.cssProperties.width,!0),color:j("width")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{width:t}})}})))),mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"flex-start"},mo.a.createElement(go.n,{variant:"clean",ml:"-6px",onClick:function(){l({type:Vs.SetCss,payload:{textTransform:S?void 0:"uppercase"}})}},mo.a.createElement(go.mb,{color:S?"blue":"black",width:32,height:32})),mo.a.createElement(go.n,{variant:"clean",ml:"-6px",onClick:function(){l({type:Vs.SetCss,payload:{fontWeight:700===s.cssProperties.fontWeight?400:700}})}},mo.a.createElement(go.l,{color:700===s.cssProperties.fontWeight?"blue":"black",width:25,height:25,viewBox:"-11 -9 30 30"})),mo.a.createElement(go.n,{variant:"clean",ml:"-6px",onClick:function(){l({type:Vs.SetCss,payload:{fontStyle:"italic"===s.cssProperties.fontStyle?"normal":"italic"}})}},mo.a.createElement(go.J,{color:"italic"===s.cssProperties.fontStyle?"blue":"black",width:26,height:26,viewBox:"-13 -8 30 30"})),mo.a.createElement(go.n,{variant:"clean",ml:"-6px",onClick:function(){l({type:Vs.SetCss,payload:{textDecoration:"underline"===s.cssProperties.textDecoration?void 0:"underline"}})}},mo.a.createElement(go.Mb,{color:"underline"===s.cssProperties.textDecoration?"blue":"black",width:30,height:30})),mo.a.createElement(go.n,{variant:"clean",ml:"-6px",onClick:function(){l({type:Vs.SetCss,payload:{textDecoration:"line-through"===s.cssProperties.textDecoration?void 0:"line-through"}})}},mo.a.createElement(go.sb,{color:"line-through"===s.cssProperties.textDecoration?"blue":"black",width:30,height:30})))),mo.a.createElement(Ha.a,{"aria-labelledby":"text-styles-color",container:e,showBorderTop:!1,small:!0,title:"Color",projectId:c,userId:d,color:b,setColor:y,onChangeComplete:function(t){l({type:Vs.SetCss,payload:{color:Object(oa.h)(t)}})}}),mo.a.createElement(go.m,{pt:25,pb:22},_(s)&&mo.a.createElement(go.B,{justifyContent:"center",mb:16},mo.a.createElement(go.Y,{textAlign:"center",min:0,max:999,value:Object(ra.c)(s.cssProperties.paddingTop),color:j("paddingTop")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{paddingTop:t}})}})),mo.a.createElement(go.B,{alignItems:"center",flexDirection:"row",mb:18},mo.a.createElement(go.m,{mr:19},mo.a.createElement(go.Y,{textAlign:"right",min:0,max:999,value:Object(ra.c)(s.cssProperties.paddingLeft),color:j("paddingLeft")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{paddingLeft:t}})}})),mo.a.createElement(go.m,null,mo.a.createElement(go.n,{variant:"clean",onClick:function(){var t,e,i;l({type:Vs.SetCss,payload:{textAlign:(t=["left","center","right",_(s)&&"justify"].filter((function(t){return t})),e=s.cssProperties.textAlign&&t.includes(s.cssProperties.textAlign)?s.cssProperties.textAlign:"left",i=t.indexOf(e),i>-1?t[i+1]||t[0]:e)}})}},mo.a.createElement(k,{color:j("textAlign")?"blue":"black"}))),mo.a.createElement(go.m,{ml:19},mo.a.createElement(go.Y,{textAlign:"left",min:0,max:999,value:Object(ra.c)(s.cssProperties.paddingRight),color:j("paddingRight")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{paddingRight:t}})}}))),_(s)&&mo.a.createElement(go.B,{justifyContent:"center",mb:14},mo.a.createElement(go.Y,{textAlign:"center",min:0,max:999,value:Object(ra.c)(s.cssProperties.paddingBottom),color:j("paddingBottom")?"blue":"black",onChange:function(t){l({type:Vs.SetCss,payload:{paddingBottom:t}})}}))),_(s)&&mo.a.createElement(Vo.a,{small:!0},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"HTML tag")),mo.a.createElement(go.m,null,mo.a.createElement(go.n,{onClick:function(){return l({type:Vs.SetInfo,payload:{tag:w()}})},variant:"clean"},mo.a.createElement(go.Cb,{textStyle:"small",color:j("tag")?"blue":"black"},"<",s.tag,">"))))),mo.a.createElement(es,{cancelAction:Ks(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:a();case 3:case"end":return t.stop()}}),t)}))),doneDisabled:!u&&!m,doneAction:r}))))})))}!function(t){t.SetInfo="SetInfo",t.SetCss="SetCss",t.Reset="Reset"}(Vs||(Vs={}));var il=mo.a.forwardRef(el);function nl(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ol(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){nl(a,n,o,r,s,"next",t)}function s(t){nl(a,n,o,r,s,"throw",t)}r(void 0)}))}}function al(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function rl(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?al(Object(i),!0).forEach((function(e){sl(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):al(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function sl(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ll(t){return function(t){if(Array.isArray(t))return hl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||dl(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||dl(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dl(t,e){if(t){if("string"==typeof t)return hl(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?hl(t,e):void 0}}function hl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ul,pl=function(t,e){var i=t.style,n=t.onHeightChanged,o=t.headerSlot,a=Object(po.useContext)(Ka).goBack,r=Object(po.useContext)(ho.a).model,s=Object(po.useMemo)((function(){return r.project.get("_id")}),[r]),l=Object(po.useMemo)((function(){return r.user.get("_id")}),[r]),c=cl(Object(ia.g)(),2),d=c[0],h=c[1],u=cl(r.useSharedState({partial:!1}),2),p=u[0],m=u[1],g=Object(po.useContext)(Cl),f=g.selectedFont,v=g.selectedTextStyle,b=g.selectedTextStyleSection,y=g.setChangedStyle,_=g.changedStyle,w=g.setSelectedFont,k=g.setEditorStateBackup,S=cl(Object(po.useState)(v?v.name:"style-".concat(vs()())),1)[0],x=Object(po.useMemo)((function(){var t=la.a.getCurrentBlock(p),e=Object(ra.b)({block:t}),i={label:"New style",name:S,cssProperties:{fontFamily:Na.b.fontFamily,fontWeight:String(Na.b.fontWeight),fontSize:Na.b.fontSize,lineHeight:Na.b.lineHeight},tag:"p"};if(e){var n=[].concat(ll(d.project),ll(d.global)).find((function(t){return t.name===e}));n&&(i.cssProperties=n.cssProperties)}var o=p.getCurrentInlineStyle(),a=Object(na.b)(o);i.cssProperties=rl(rl(rl({},i.cssProperties),a),{},{letterSpacing:a.letterSpacing?Object(ra.c)(a.letterSpacing,!0):i.cssProperties.letterSpacing,fontSize:a.fontSize?Object(ra.c)(a.fontSize):i.cssProperties.fontSize});var r=Object(pr.a)({block:t}),s=Object(va.d)({block:t}),l=Object(hr.a)({block:t});return i.cssProperties=rl(rl({},i.cssProperties),{},{color:a.color?Object(oa.j)(Object(oa.i)(a.color)):i.cssProperties.color,paddingLeft:r&&r.left||i.cssProperties.left,paddingRight:r&&r.right||i.cssProperties.right,paddingBottom:r&&r.bottom||i.cssProperties.bottom,paddingTop:r&&r.top||i.cssProperties.top,textAlign:s&&s.replace("align-","")||i.cssProperties.textAlign||"left",lineHeight:l||i.cssProperties.lineHeight}),i}),[]),C=Object(po.useMemo)((function(){return b||ba.c.project}),[b]),O=Object(po.useMemo)((function(){if(v)return v;var t=rl(rl({},d),{},sl({},C,[].concat(ll(d[C]),[rl({},x)])));return h(t),t[C].find((function(t){return t.name===S}))||{}}),[v]),j=cl(Object(po.useReducer)(tl(),O),2),E=j[0],I=j[1],T=C===ba.c.global?d.global:d.project;Object(po.useEffect)((function(){I({type:Vs.Reset,payload:rl({},O)})}),[v]);Object(po.useEffect)((function(){!function(){var t=T.findIndex((function(t){return t.name===E.name}));if(t>-1){var e=ll(T);e[t]=rl({},E),h(rl(rl({},d),{},sl({},C,e)))}}(),y&&y(E)}),[E]),Object(po.useEffect)((function(){_&&I({type:Vs.Reset,payload:_}),f&&(I({type:Vs.SetCss,payload:{fontFamily:f.css_name}}),w&&w(void 0))}),[]);var M=function(){var t=ol(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=ll(T),i=e.findIndex((function(t){return t.name===E.name})),y&&y(void 0),k&&k(void 0),i<0&&(e.push(E),h(rl(rl({},d),{},sl({},C,e)))),C!==ba.c.global){t.next=10;break}return t.next=8,Object(ur.S)({userId:l,styles:e});case 8:t.next=12;break;case 10:return t.next=12,Object(ur.P)({projectId:s,styles:e});case 12:window.RM.constructorRouter.trigger("notice:triggerMetrics",P.a.ParagraphStyleCreated),m(la.a.forceSelection(p,p.getSelection())),a();case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(po.useEffect)((function(){if(!v){var t=p.getSelection();m(la.a.forceSelection(Object(ra.h)({style:E,editorState:la.a.forceSelection(la.a.clearStylesFromBlock({editorState:p}),t)}),t))}}),[]);var $=function(){var t=ol(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(mo.a.createElement(il,{style:i,ref:e,onHeightChanged:n,headerSlot:o,onCancel:$,onDone:M,textStyle:E,setTextStyle:I,projectId:s,userId:l,initialTextStyle:O,canImediatelySave:!v}))},ml=mo.a.forwardRef(pl),gl=function(t){var e=t.leftSlot,i=t.centerSlot,n=t.rightSlot,o=t.showBorder,a=void 0===o||o;return(mo.a.createElement(go.m,{height:40,px:16,borderRadius:"8px 8px 0 0"},mo.a.createElement(go.B,{height:40,justifyContent:"space-between",alignItems:"center",borderBottom:a?"2px solid rgba(184,184,184,0.24)":void 0},mo.a.createElement(go.m,{width:"20%"},e),mo.a.createElement(go.m,{width:"100%",textAlign:"center"},i),mo.a.createElement(go.m,{width:"20%"},n))))},fl=i("JW7n");function vl(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function bl(t){return function(t){if(Array.isArray(t))return wl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||_l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _l(t,e){if(t){if("string"==typeof t)return wl(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?wl(t,e):void 0}}function wl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function kl(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Sl(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?kl(Object(i),!0).forEach((function(e){xl(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):kl(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function xl(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}!function(t){t.Typography="Typography",t.FontsList="FontsList",t.FontUploader="FontUploader",t.Styles="Styles",t.StyleEdit="StyleEdit"}(ul||(ul={}));var Cl=mo.a.createContext({}),Ol=function(t,e){return Sl(Sl({},t),e||{})},jl=Object(uo.e)(go.n).withConfig({displayName:"TextTypography___StyledButton"})(["&:hover svg{color:",";opacity:1;}"],(function(t){return t._css})),Pl=function(){var t=Object(po.useContext)(ho.a).model,e=yl(Object(ia.g)(),2),i=e[0],n=e[1],o=yl(t.useSharedState({partial:!1}),2),a=o[0],r=o[1],s=Object(po.useMemo)((function(){return Object(ra.b)({editorState:a})}),[a]),l=Object(po.useMemo)((function(){return[].concat(bl(i.global),bl(i.project)).find((function(t){return t.name===s}))}),[s,i]),c=function(t){u({editorStateBackup:t})},d=yl(Object(po.useReducer)(Ol,{setSelectedFont:function(t){u({selectedFont:t})},setSelectedTextStyle:function(t){u({selectedTextStyle:t})},setSelectedTextStyleSection:function(t){u({selectedTextStyleSection:t})},setChangedStyle:function(t){u({changedStyle:t})},setEditorStateBackup:c}),2),h=d[0],u=d[1],p=Object(po.useRef)(),m=yl(Object(po.useState)(""),2),g=m[0],f=m[1],v=function(){var t=function(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){vl(a,n,o,r,s,"next",t)}function s(t){vl(a,n,o,r,s,"throw",t)}r(void 0)}))}}(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(fl.b)();case 2:e=t.sent,i=e.textStyles,u({changedStyle:void 0,selectedTextStyle:void 0}),n(Sl({},i));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(po.useEffect)((function(){t.visible&&t.selected||!h.changedStyle||v()}),[t.selected,t.visible,h.changedStyle]);var b=mo.a.createElement(gl,{showBorder:g!==ul.FontsList,leftSlot:mo.a.createElement(jl,{"aria-labelledby":"text-typography-back",variant:"clean",onClick:function(){return p.current&&p.current.goBack()},_css:Object(_a.themeGet)("colors.black")},mo.a.createElement(go.h,{color:"darkGray"}))}),y=Object(po.useMemo)((function(){if(h.selectedTextStyle)return h.selectedTextStyle.cssProperties.fontFamily||Na.b.fontFamily;var t=la.a.getCurrentInlineStyles(a,na.a.FontFamily);return t.length&&t[0]?t[0]:l?String(l.cssProperties.fontFamily):Na.b.fontFamily}),[l,a,h.selectedTextStyle]),_=yl(Object(po.useState)([]),2),w=_[0],k=_[1],S=Za(p.current),x=S.canControlBeClosed,C=S.onStackUpdated;return t.injectedRefs.canControlBeClosed=x,mo.a.createElement(Eo,{centerPanel:!0,control:function(e){var i=e.ref;return(mo.a.createElement(ko,{ref:i,label:"Typography",onClick:function(e){if(e.preventDefault(),!t.disabled){if(p.current&&p.current.currentScreen!==ul.Typography){if(t.selected)return void p.current.goBack();u(Sl(Sl({},h),{},{selectedFont:void 0,selectedTextStyle:void 0})),p.current.goHome()}t.select()}}},mo.a.createElement(go.Lb,{color:"white"})))},panel:function(e){var i=e.ref,n=e.style,o=e.update;return t.selected?mo.a.createElement(Cl.Provider,{value:h},mo.a.createElement(Xa,{ref:p,initialScreen:ul.Typography,onStackUpdated:function(t){var e=w[w.length-1],i=t[t.length-1];e===ul.StyleEdit&&i!==ul.FontsList&&h.changedStyle&&(v(),h.editorStateBackup&&(r(h.editorStateBackup),c(void 0))),k(t),C(t)},onNavigate:function(t){!function(t){t.prev;var e=t.next;f(e)}(t),o()},childRef:i},mo.a.createElement(Mr,{key:ul.Typography,style:n,onHeightChanged:o}),mo.a.createElement(Zr,{key:ul.FontsList,style:n,headerSlot:b,currentFontFamily:y}),mo.a.createElement(gs,{key:ul.FontUploader,style:n}),mo.a.createElement(Gs,{key:ul.Styles,style:n,onHeightChanged:o,headerSlot:b}),mo.a.createElement(ml,{key:ul.StyleEdit,style:n,onHeightChanged:o}))):null}})};function El(t){return function(t){if(Array.isArray(t))return Ml(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Tl(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Il(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Tl(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tl(t,e){if(t){if("string"==typeof t)return Ml(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ml(t,e):void 0}}function Ml(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var $l=Object(uo.e)(go.Cb).withConfig({displayName:"TextAdvancedTypography___StyledText"})(["display:inline-block;width:86px;"]),Al=Object(uo.e)(go.ib).withConfig({displayName:"TextAdvancedTypography___StyledRoundButton"})(["&:hover g{fill:#fff;}"]),Rl=Object(uo.e)(go.ib).withConfig({displayName:"TextAdvancedTypography___StyledRoundButton2"})(["&:hover g{fill:#fff;}"]),Dl=Object(uo.e)(go.ib).withConfig({displayName:"TextAdvancedTypography___StyledRoundButton3"})(["&:hover g{fill:#fff;}"]),Bl=Object(uo.e)(go.n).withConfig({displayName:"TextAdvancedTypography___StyledButton"})(["&:hover{color:",";}"],(function(t){return t._css})),Ll=Object(uo.e)(go.n).withConfig({displayName:"TextAdvancedTypography___StyledButton2"})(["&:hover{color:",";}"],(function(t){return t._css2})),zl=Object(uo.e)(go.n).withConfig({displayName:"TextAdvancedTypography___StyledButton3"})(["text-overflow:ellipsis;overflow:hidden;white-space:nowrap;text-align:left;line-height:1;"]),Fl=Object(uo.e)(go.n).withConfig({displayName:"TextAdvancedTypography___StyledButton4"})(["vertical-align:middle;"]),Ul=function(t,e){var i=t.style,n=t.onHeightChanged,o=Object(po.useContext)(Ka).navigate,a=Object(po.useContext)(vo.BackboneContext),r=a.model,s=a.modelSet,l=a.modelSave,c=Object(po.useContext)(ho.a).model,d=Object(po.useMemo)((function(){return c.project.get("_id")}),[c]),h=Object(po.useMemo)((function(){return c.user.get("_id")}),[c]),u=Object(wa.a)(l,400).callback,p=Il(c.useSharedState({partial:!1}),2),m=p[0],g=p[1],f=Il(Object(po.useState)([]),2),v=f[0],b=f[1],y=Il(Object(po.useState)([]),2),_=y[0],w=y[1],k=Il(Object(po.useState)([]),2),S=k[0],x=k[1],C=Il(Object(po.useState)(!1),2),O=C[0],j=C[1],P=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(m,na.a.FontFamily)}),[m]),E=Il(Object(po.useState)(Na.b.fontFamily),2),I=E[0],T=E[1];Object(po.useEffect)((function(){var t=P[0];t&&t!==I?T(t):t||Na.b.fontFamily===I||T(Na.b.fontFamily)}),[P]);var M=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(m,na.a.FontStyle)}),[m]),$=Il(Object(po.useState)(Na.b.fontStyle),2),A=$[0],R=$[1];Object(po.useEffect)((function(){var t=M[0];t&&t!==A?R(t):t||Na.b.fontStyle===A||R(Na.b.fontStyle)}),[M]);var D=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(m,na.a.FontWeight)}),[m]),B=Il(Object(po.useState)(Na.b.fontWeight),2),L=B[0],z=B[1];Object(po.useEffect)((function(){var t=parseInt(D[0]);t&&t!==L?z(t):t||Na.b.fontWeight===L||z(Na.b.fontWeight)}),[D]);var F=Il(Object(ia.d)(),1)[0];Object(po.useEffect)((function(){if(I&&L&&A){var t=F[Object(ia.c)({fontFamily:I,fontWeight:L,fontStyle:A})];if(t){var e=t.features;!function(t){var e=la.a.getLigaturesType(t);b(e);var i=la.a.getStylisticSets(t);w(i);var n=la.a.getNumericVariations(t);x(n);var o=t.includes(Ua.a.Fractions);j(o)}(e&&e.length?e:[])}}}),[I,L,A,F]);var U=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(m,na.a.FontFeature)}),[m]),N=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(m,na.a.Stroke)}),[m]),H=!(!N||!N.length),V=Object(po.useMemo)((function(){return la.a.getCurrentBlockType(m)}),[m]),W=Object(po.useMemo)((function(){return Object(ya.e)(V)}),[V]);Object(po.useEffect)((function(){n()}),[W,H]);var G=Object(po.useMemo)((function(){return _.find((function(t){return U.includes(t)}))}),[_,U]),q=Object(po.useMemo)((function(){return S.find((function(t){return U.includes(t)}))}),[S,U]),K=mo.a.createElement($l,{textAlign:"center",textStyle:"small"},"Stylistic set ",G?G.replace(/\D/g,""):""),Y=Object(po.useMemo)((function(){return r.bgColor}),[r.bgColor]),X=Il(Object(po.useState)(Y?Object(oa.e)(Y):null),2),Z=X[0],J=X[1];Object(po.useEffect)((function(){if(r.bgColor){var t=Object(oa.e)(r.bgColor);!Z||t.h===Z.h&&t.s===Z.s&&t.v===Z.v||J(t)}else J(Object(oa.e)("#ffffff00"))}),[Y]);var Q=Il(Object(po.useState)(1),2),tt=Q[0],et=Q[1],it=Il(Object(po.useState)(H&&N[1]?Object(oa.e)(N[1]):{h:0,s:0,v:50,a:1}),2),nt=it[0],ot=it[1],at=Il(Object(po.useState)(""),2),rt=at[0],st=at[1];Object(po.useEffect)((function(){if(N&&N.length){var t=Il(N,2),e=t[0],i=t[1];Number(e)!==tt&&et(Number(e));var n=Object(oa.d)(i);n&&n!==rt&&(ot(Object(oa.e)(i)),st(n))}}),[N,H]);var lt=Il(Object(ia.g)(),1)[0],ct=[].concat(El(lt.global),El(lt.project)),dt=Object(po.useMemo)((function(){return Object(ra.b)({editorState:m})}),[m]),ht=Object(po.useMemo)((function(){return ct.find((function(t){return t.name===dt}))}),[dt]),ut=la.a.getCurrentInlineStyles(m,na.a.Decoration),pt=la.a.getCurrentInlineStyles(m,na.a.Transform),mt=la.a.getCurrentInlineStyles(m,na.a.Features),gt=la.a.getCurrentInlineStyles(m,na.a.FontKerning),ft=mt&&"superscript"===mt[0],vt=mt&&"subscript"===mt[0],bt=(gt&&gt[0],ut&&"overline"===ut[0]),yt=!!ht&&"uppercase"===ht.cssProperties.textTransform,_t=pt&&pt[0]?"uppercase"===pt[0]:yt,wt=pt&&"lowercase"===pt[0],kt=pt&&"capitalize"===pt[0],St=!!ht&&"underline"===ht.cssProperties.textDecoration,xt=ut&&ut[0]?"underline"===ut[0]:St,Ct=!!ht&&"line-through"===ht.cssProperties.textDecoration,Ot=ut&&ut[0]?"line-through"===ut[0]:Ct,jt=la.a.getCurrentInlineStyles(m,na.a.FontWeight),Pt=!!ht&&700===ht.cssProperties.fontWeight,Et=jt&&jt[0]?"700"===jt[0]:Pt,It=la.a.getCurrentInlineStyles(m,na.a.FontStyle),Tt=!!ht&&"italic"===ht.cssProperties.fontStyle,Mt=It&&It[0]?"italic"===It[0]:Tt,$t=Il(Object(po.useState)(!1),2),At=$t[0],Rt=$t[1],Dt=Il(Object(ia.f)(),1)[0],Bt=[].concat(El(Dt.global),El(Dt.project)),Lt=Object(po.useMemo)((function(){return Object(ya.d)({editorState:m})}),[m]),zt=Object(po.useMemo)((function(){return Bt.find((function(t){return t.name===Lt}))}),[Lt]),Ft=Object(po.useMemo)((function(){var t=la.a.getSelectedBlocks(m),e=m.getCurrentContent(),i=t.map((function(t){var i=e.getBlockForKey(t);return Object(ra.b)({editorState:m,block:i})}));return{isMultipleBlockSelected:i.length>1,hasDifferentStyles:i.some((function(t){return t!==i[0]}))}}),[zt,m]),Ut=Ft.isMultipleBlockSelected,Nt=Ft.hasDifferentStyles,Ht=function(t){var e=Object(oa.h)(t);g(la.a.applyInlineStyle({key:na.a.Stroke,value:"".concat(tt).concat(la.a.INLINE_STYLE_DELIMITER).concat(e),editorState:m}))};return mo.a.createElement(Ho,{ref:e,style:i,scrollable:!0},mo.a.createElement(zo.Consumer,null,(function(t){var e=t.tooltipContainer,i=t.dropdownContainer;return(mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(go.m,{px:16,pt:10},mo.a.createElement(Vo.a,{showBorderTop:!1},mo.a.createElement(go.m,{mb:"8px"},mo.a.createElement(go.Cb,{textStyle:"small"},"Transform")),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between",mb:"8px"},mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Uppercase",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-uppercase",hoverColor:"black",size:40,color:_t?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Transform,value:_t?"none":"uppercase"});g(t)}},mo.a.createElement(go.Nb,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Capitalize",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-capitalize",hoverColor:"black",size:40,color:kt?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Transform,value:kt?"none":"capitalize"});g(t)}},mo.a.createElement(go.o,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Lowercase",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-lowercase",hoverColor:"black",size:40,color:wt?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Transform,value:wt?"none":"lowercase"});g(t)}},mo.a.createElement(go.R,{color:"white"}))))),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Bold",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-bold",hoverColor:"black",size:40,color:Et?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.FontWeight,value:Et?Na.b.fontWeight:"700"});g(t)}},mo.a.createElement(go.l,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Italic",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-italic",hoverColor:"black",size:40,color:Mt?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.FontStyle,value:Mt?Na.b.fontStyle:"italic"});g(t)}},mo.a.createElement(go.J,{color:"white"})))),mo.a.createElement(go.m,{width:40}))),mo.a.createElement(Vo.a,{showBorderTop:!1},mo.a.createElement(go.m,{mb:"8px"},mo.a.createElement(go.Cb,{textStyle:"small"},"Decoration")),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Underline",indent:4,container:e},mo.a.createElement(Al,{"aria-labelledby":"advanced-typography-underline",hoverColor:"black",size:40,color:xt?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Decoration,value:xt?"none":"underline"});g(t)}},mo.a.createElement(go.Mb,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Strikethrough",indent:4,container:e},mo.a.createElement(Rl,{"aria-labelledby":"advanced-typography-strikethrough",hoverColor:"black",size:40,color:Ot?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Decoration,value:Ot?"none":"line-through"});g(t)}},mo.a.createElement(go.sb,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Overline",indent:4,container:e},mo.a.createElement(Dl,{"aria-labelledby":"advanced-typography-overline",hoverColor:"black",size:40,color:bt?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Decoration,value:bt?"none":"overline"});g(t)}},mo.a.createElement(go.ab,{color:"white"})))))),mo.a.createElement(Vo.a,{showBorderTop:!1,mb:"0px"},mo.a.createElement(go.m,{mb:"8px"},mo.a.createElement(go.Cb,{textStyle:"small"},"Features")),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between",mb:"8px"},mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Superscript",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-superscript",hoverColor:"black",size:40,color:ft?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Features,value:ft?"none":"superscript"});ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Superscript ".concat(ft?"off":"on")}),g(t)}},mo.a.createElement(go.wb,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Subscript",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-subscript",hoverColor:"black",size:40,color:vt?"black":"gray",onClick:function(){var t=la.a.applyInlineStyle({editorState:m,key:na.a.Features,value:vt?"none":"subscript"});ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Subscript ".concat(vt?"off":"on")}),g(t)}},mo.a.createElement(go.vb,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Fractions",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-fractions",hoverColor:"black",size:40,disabled:!O,color:U.includes(Ua.a.Fractions)?"black":"gray",onClick:function(){var t=El(U),e=t.indexOf(Ua.a.Fractions);e>-1?(t.splice(e,1),ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Fractions off"})):(t.push(Ua.a.Fractions),ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Fractions on"})),g(la.a.applyInlineStyle({key:na.a.FontFeature,value:t,editorState:m}))}},mo.a.createElement(go.E,{color:"white"}))))),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Small caps",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-smallcaps",hoverColor:"black",size:40,color:U.includes(Ua.a.Smallcaps)?"black":"gray",onClick:function(){var t=El(U),e=t.indexOf(Ua.a.Smallcaps);e>-1?t.splice(e,1):t.push(Ua.a.Smallcaps),g(la.a.applyInlineStyle({key:na.a.FontFeature,value:t,editorState:m}))}},mo.a.createElement(go.mb,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:"Ligatures",indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-ligatures",hoverColor:"black",size:40,disabled:!v||!v.length,color:U.includes(Ua.a.StandardLigatures)?"black":"gray",onClick:function(){var t=El(U),e=t.indexOf(Ua.a.StandardLigatures);e>-1?(t.splice(e,1),ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Ligatures off"})):(t.push(Ua.a.StandardLigatures),ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Ligatures on"})),g(la.a.applyInlineStyle({key:na.a.FontFeature,value:t,editorState:m}))}},mo.a.createElement(go.K,{color:"white"})))),mo.a.createElement(go.m,{width:40},mo.a.createElement(go.Eb,{text:K,indent:4,container:e},mo.a.createElement(go.ib,{"aria-labelledby":"advanced-typography-stylistic-set",hoverColor:"black",size:40,disabled:!_||!_.length,color:G?"black":"gray",onClick:function(){var t=El(U),e=G?t.indexOf(G):null;if(null!==e&&e>-1&&t.splice(e,1),G){var i=_.indexOf(G);if(i>-1){var n=_[i+1];n&&t.push(n)}}else t.push(_[0]);g(la.a.applyInlineStyle({key:na.a.FontFeature,value:t,editorState:m}))}},mo.a.createElement(go.Ob,{color:"white"}))))))),S&&S.length?mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(ea,{container:i,items:[{label:"Default figure",value:"default"}].concat(El(S.map((function(t){return{label:Ua.b[t],value:t}})))),value:q||"default",onSelect:function(t){var e=El(U),i=q?e.indexOf(q):null;null!==i&&i>-1&&e.splice(i,1),"default"!==t.value&&e.push(t.value),g(la.a.applyInlineStyle({key:na.a.FontFeature,value:e,editorState:m}))}}))):void 0,mo.a.createElement(go.m,{px:16,pb:10},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"List")),mo.a.createElement(go.m,null,mo.a.createElement(go.zb,{"aria-labelledby":"advanced-typography-list",checked:W,backgroundChecked:"black",onChange:function(){var t=W?V:ya.a.Unordered;ka.d.sendEvent(ka.b.TextLists,{eventLabel:"".concat(t===ya.a.Unordered?"Unordered":"Ordered"," list set")});var e=la.a.forceSelection(la.a.toggleBlockType(m,t),m.getSelection());g(e)}})))),W&&mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.m,{pl:2},mo.a.createElement(go.m,{mr:2,display:"inline-block"},mo.a.createElement(Bl,{"aria-labelledby":"advanced-typography-unordered-list",color:V===ya.a.Unordered?"black":"darkGray",textStyle:"small",variant:"clean",onClick:function(){var t=la.a.forceSelection(la.a.toggleBlockType(m,ya.a.Unordered),m.getSelection());ka.d.sendEvent(ka.b.TextLists,{eventLabel:"Unordered list set"}),g(t)},_css:Object(_a.themeGet)("colors.black")},"Unordered")),mo.a.createElement(go.m,{display:"inline-block"},mo.a.createElement(Ll,{"aria-labelledby":"advanced-typography-ordered-list",color:V===ya.a.Ordered?"black":"darkGray",textStyle:"small",variant:"clean",onClick:function(){var t=la.a.forceSelection(la.a.toggleBlockType(m,ya.a.Ordered),m.getSelection());ka.d.sendEvent(ka.b.TextLists,{eventLabel:"Ordered list set"}),g(t)},_css2:Object(_a.themeGet)("colors.black")},"Ordered")))),Object(ya.e)(V)&&mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0,onMouseEnter:function(){return Rt(!0)},onMouseLeave:function(){return Rt(!1)}},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center",position:"relative",zIndex:1,cursor:"pointer",pl:2},mo.a.createElement(zl,{"aria-labelledby":"advanced-typography-go-to-list-styles",display:"block",onClick:function(){return o(ul.Styles)},variant:"clean",width:"100%"},mo.a.createElement(go.Cb,{textStyle:"small",color:"black"},zt?Ut&&Nt?"...":zt.label:"No style")),mo.a.createElement(go.m,null,mo.a.createElement(Fl,{onClick:function(){return o(ul.Styles)},variant:"clean"},mo.a.createElement(go.Gb,{color:At?"black":"gray"})))))),mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!H,small:!0},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Outline")),mo.a.createElement(go.m,null,mo.a.createElement(go.zb,{"aria-labelledby":"advanced-typography-outline",checked:H,backgroundChecked:"black",onChange:function(){if(nt){var t=!H;ka.d.sendEvent(ka.b.AdvancedTypographyPanel,{eventLabel:"Outline ".concat(t?"on":"off")}),g(la.a.applyInlineStyle({key:na.a.Stroke,value:H?void 0:"".concat(tt).concat(la.a.INLINE_STYLE_DELIMITER).concat(Object(oa.h)(nt)),editorState:m}))}}})))),H&&mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!1,small:!0},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Width")),mo.a.createElement(go.m,null,mo.a.createElement(go.Y,{"aria-labelledby":"advanced-typography-outline-width",value:tt,min:1,max:999,positive:!0,textAlign:"right",onChange:function(t){var e=nt||aa.c;if(e){var i=Object(oa.h)(e),n=t;et(n),g(la.a.applyInlineStyle({key:na.a.Stroke,value:"".concat(n).concat(la.a.INLINE_STYLE_DELIMITER).concat(i),editorState:m}))}}})))),mo.a.createElement(Ha.a,{"aria-labelledby":"advanced-typography-outline-color",container:i,showBorderTop:!1,small:!0,title:"Color",projectId:d,userId:h,color:nt,setColor:ot,onColorChange:Ht,onChangeComplete:Ht})),mo.a.createElement(Ha.a,{"aria-labelledby":"advanced-typography-box-color",container:i,showBorderTop:!1,showBorderBottom:!1,small:!0,title:"Box Color",projectId:d,userId:h,color:Z,setColor:J,onChangeComplete:function(t){s({bgColor:Object(oa.h)(t)}),u()}}))))})))},Nl=mo.a.forwardRef(Ul);function Hl(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Vl(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Hl(Object(i),!0).forEach((function(e){Wl(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Hl(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Wl(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Gl(t){return function(t){if(Array.isArray(t))return Zl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Xl(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ql(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Kl(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){ql(a,n,o,r,s,"next",t)}function s(t){ql(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Yl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Xl(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xl(t,e){if(t){if("string"==typeof t)return Zl(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Zl(t,e):void 0}}function Zl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Jl=function(t,e){var i=t.style,n=t.onHeightChanged,o=t.headerSlot,a=Object(po.useContext)(Ka).navigate,r=Object(po.useContext)(Cl),s=r.setSelectedListStyle,l=r.setSelectedTextStyleSection,c=r.selectedTextStyleSection,d=Object(po.useContext)(ho.a).model,h=Object(po.useMemo)((function(){return d.project.get("_id")}),[d]),u=Object(po.useMemo)((function(){return d.user.get("_id")}),[d]),p=Yl(d.useSharedState({partial:!1}),2),m=p[0],g=p[1],f=Yl(Object(po.useState)(c||ba.c.project),2),v=f[0],b=f[1],y=Yl(Object(ia.f)(),2),_=y[0],w=y[1],k=Object(po.useMemo)((function(){return v===ba.c.global?_.global:_.project}),[v,_]),S=Object(po.useMemo)((function(){return Object(ya.d)({editorState:m})}),[m]);Object(po.useEffect)((function(){n()}),[]);var x=function(){var t=Kl(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Gl(k),(n=i.findIndex((function(t){return t.name===e.name})))>-1&&i.splice(n,0,Vl(Vl({},e),{},{name:"style-".concat(vs()()),label:"".concat(e.label," (Copy)")})),t.next=5,w(Vl(Vl({},_),{},Wl({},v,i)));case 5:if(v!==ba.c.global){t.next=10;break}return t.next=8,Object(ur.R)({userId:u,styles:i});case 8:t.next=12;break;case 10:return t.next=12,Object(ur.N)({projectId:h,styles:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var t=Kl(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Gl(k),(n=i.findIndex((function(t){return t.name===e.name})))>-1&&i.splice(n,1),t.next=5,w(Vl(Vl({},_),{},Wl({},v,i)));case 5:if(v!==ba.c.global){t.next=10;break}return t.next=8,Object(ur.R)({userId:u,styles:i});case 8:t.next=12;break;case 10:return t.next=12,Object(ur.N)({projectId:h,styles:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=Yl(Object(po.useState)(Ft.a.textWidget.listStylesPanelDefaultHeight),2),j=O[0],P=O[1];Object(po.useEffect)((function(){var t=d.project.edit_params.get("controls");t&&t.ListStyles&&P(t.ListStyles)}),[]);var E=function(){var t=Kl(regeneratorRuntime.mark((function t(e,i){var n,o,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],o=[],i===ba.c.global?(n=Gl(k),(a=n.findIndex((function(t){return t.name===e.name})))>-1&&n.splice(a,1),o=[].concat(Gl(_.global),[e])):(o=Gl(k),(r=o.findIndex((function(t){return t.name===e.name})))>-1&&o.splice(r,1),n=[].concat(Gl(_.project),[e])),t.next=5,w({global:o,project:n});case 5:return t.next=7,Object(ur.N)({projectId:h,styles:n});case 7:return t.next=9,Object(ur.R)({userId:u,styles:o});case 9:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}();return mo.a.createElement(As,{style:i,ref:e,height:j,currentStyle:S,onResizeComplete:function(t){P(t);var e=d.project.edit_params.get("controls");d.project.edit_params.set("controls",Vl(Vl({},e),{},{ListStyles:t})),d.project.edit_params.save()},headerSlot:o,onAddClick:function(){s&&s(void 0),l&&l(v),a(ul.StyleEdit)},selectStyle:function(t){var e=Object(ya.j)({style:t,currentStyle:S,editorState:m});g(la.a.forceSelection(e,m.getSelection()))},moveStyle:E,deleteStyle:C,duplicateStyle:x,enterEditMode:function(t){s&&s(t),l&&l(v),a(ul.StyleEdit)},currentTextStyles:k,setTextStylesSection:b,textStylesSection:v})},Ql=mo.a.forwardRef(Jl);function tc(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ec(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){tc(a,n,o,r,s,"next",t)}function s(t){tc(a,n,o,r,s,"throw",t)}r(void 0)}))}}function ic(t){return function(t){if(Array.isArray(t))return lc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||sc(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nc(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function oc(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?nc(Object(i),!0).forEach((function(e){ac(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):nc(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ac(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||sc(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sc(t,e){if(t){if("string"==typeof t)return lc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?lc(t,e):void 0}}function lc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var cc=function(t,e){var i=t.style,n=t.onHeightChanged,o=t.headerSlot,a=Object(po.useContext)(Ka).goBack,r=Object(po.useContext)(ho.a).model,s=Object(po.useMemo)((function(){return r.project.get("_id")}),[r]),l=Object(po.useMemo)((function(){return r.user.get("_id")}),[r]),c=rc(Object(ia.f)(),2),d=c[0],h=c[1],u=Object(po.useMemo)((function(){return{label:"New style",name:"list-style-".concat(vs()()),cssProperties:{fontFamily:Na.b.fontFamily,fontWeight:String(Na.b.fontWeight),fontSize:Na.b.fontSize,lineHeight:Na.b.lineHeight,width:20}}}),[]),p=Object(po.useContext)(Cl),m=p.selectedFont,g=p.selectedListStyle,f=p.selectedTextStyleSection,v=p.setChangedListStyle,b=p.changedListStyle,y=p.setSelectedFont,_=Object(po.useMemo)((function(){return g||oc({},u)}),[g]),w=Object(po.useMemo)((function(){return f||ba.c.project}),[f]),k=rc(Object(po.useReducer)(tl(),_),2),S=k[0],x=k[1],C=w===ba.c.global?d.global:d.project;Object(po.useEffect)((function(){x({type:Vs.Reset,payload:oc({},_)})}),[g]);Object(po.useEffect)((function(){!function(){var t=C.findIndex((function(t){return t.name===S.name}));if(t>-1){var e=ic(C);e[t]=oc({},S),h(oc(oc({},d),{},ac({},w,e)))}}(),v&&v(S)}),[S]);var O=function(){var t=ec(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=ic(C),i=e.findIndex((function(t){return t.name===S.name})),v&&v(void 0),i<0&&(e.push(S),h(oc(oc({},d),{},ac({},w,e)))),w!==ba.c.global){t.next=9;break}return t.next=7,Object(ur.R)({userId:l,styles:e});case 7:t.next=11;break;case 9:return t.next=11,Object(ur.N)({projectId:s,styles:e});case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(po.useEffect)((function(){b&&x({type:Vs.Reset,payload:b}),m&&(x({type:Vs.SetCss,payload:{fontFamily:m.css_name}}),y&&y(void 0))}),[]);var j=function(){var t=ec(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:a();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(mo.a.createElement(il,{style:i,ref:e,onHeightChanged:n,headerSlot:o,onCancel:a,onDone:j,textStyle:S,setTextStyle:x,projectId:s,userId:l,initialTextStyle:_,canImediatelySave:!g}))},dc=mo.a.forwardRef(cc);function hc(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function uc(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?hc(Object(i),!0).forEach((function(e){pc(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):hc(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function pc(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function mc(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function gc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return fc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return fc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var vc,bc=Object(uo.e)(go.n).withConfig({displayName:"TextAdvancedTypography___StyledButton"})(["&:hover svg{color:",";opacity:1;}"],(function(t){return t._css})),yc=function(){var t=Object(po.useContext)(ho.a).model,e=Object(po.useRef)(),i=mo.a.createElement(gl,{leftSlot:mo.a.createElement(bc,{"aria-labelledby":"text-typography-back",variant:"clean",onClick:function(){return e.current&&e.current.goBack()},_css:Object(_a.themeGet)("colors.black")},mo.a.createElement(go.h,{color:"darkGray"}))}),n=Za(e.current),o=n.canControlBeClosed,a=n.onStackUpdated;t.injectedRefs.canControlBeClosed=o;var r=gc(Object(ia.f)(),2)[1],s=gc(Object(po.useState)(""),2)[1],l=gc(Object(po.useReducer)(Ol,{setSelectedFont:function(t){d({selectedFont:t})},setSelectedListStyle:function(t){d({selectedListStyle:t})},setSelectedTextStyleSection:function(t){d({selectedTextStyleSection:t})},setChangedListStyle:function(t){d({changedListStyle:t})}}),2),c=l[0],d=l[1],h=function(){var t=function(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){mc(a,n,o,r,s,"next",t)}function s(t){mc(a,n,o,r,s,"throw",t)}r(void 0)}))}}(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(fl.b)();case 2:e=t.sent,i=e.listStyles,d({changedStyle:void 0,selectedTextStyle:void 0}),r(uc({},i));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(po.useEffect)((function(){t.visible&&t.selected||!c.changedStyle||h()}),[t.selected,t.visible,c.changedStyle]);var u=Object(po.useMemo)((function(){return Na.b.fontFamily}),[]);return(mo.a.createElement(Eo,{control:function(i){var n=i.ref;return(mo.a.createElement(ko,{ref:n,label:"Advanced Typography",onClick:function(i){if(i.preventDefault(),!t.disabled){if(e.current&&e.current.currentScreen!==ul.Typography){if(t.selected)return void e.current.goBack();d(uc(uc({},c),{},{selectedFont:void 0,selectedTextStyle:void 0})),e.current.goHome()}t.select()}}},mo.a.createElement(go.lb,{color:"white"})))},panel:function(n){var o=n.ref,r=n.style,l=n.update;return t.selected?mo.a.createElement(Cl.Provider,{value:c},mo.a.createElement(Xa,{ref:e,initialScreen:ul.Typography,onStackUpdated:a,onNavigate:function(t){var e,i,n;i=(e=t).prev,n=e.next,s(i),i===ul.StyleEdit&&n!==ul.FontsList&&c.changedStyle&&h(),l()},childRef:o},mo.a.createElement(Nl,{key:ul.Typography,ref:o,style:r,onHeightChanged:l}),mo.a.createElement(Zr,{key:ul.FontsList,style:r,headerSlot:i,currentFontFamily:u}),mo.a.createElement(gs,{key:ul.FontUploader,style:r}),mo.a.createElement(Ql,{key:ul.Styles,style:r,onHeightChanged:l,headerSlot:i}),mo.a.createElement(dc,{key:ul.StyleEdit,style:r,onHeightChanged:l}))):null}}))},_c=ho.b.extend({name:"text_advanced_typography",component:yc}),wc=ho.b.extend({name:"text_typography_new",component:Pl});function kc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Sc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Sc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.Dropbox="Your Dropbox link is incorrect. Please select your file in Dropbox and click on the Share button to get a correct link.",t.Invalid="Your link is incorrect. Please enter the valid link.",t.Vimeo="Upload from Vimeo is not supported.",t.Youtube="Upload from Youtube is not supported."}(vc||(vc={}));var xc=Object(uo.e)(go.m).withConfig({displayName:"ShotsSettings___StyledBox"})(["cursor:default;min-height:119px;"]),Cc=Object(uo.e)(go.A).withConfig({displayName:"ShotsSettings___StyledFileInput"})(["cursor:",";"],(function(t){return t._css})),Oc=Object(uo.e)(go.B).withConfig({displayName:"ShotsSettings___StyledFlex"})(["cursor:default;"]),jc=Object(uo.e)(go.Cb).withConfig({displayName:"ShotsSettings___StyledText"})(["width:100%;&:hover{color:white;}"]),Pc=Object(uo.e)(go.H).withConfig({displayName:"ShotsSettings___StyledInlineInput"})(["&{user-select:text;}box-sizing:border-box;&::placeholder{color:",";font-size:12px;}border-radius:8px;"],(function(t){return t._css2})),Ec=Object(uo.e)(go.m).withConfig({displayName:"ShotsSettings___StyledBox2"})(["transform:translateY(-50%);"]),Ic=Object(uo.e)(go.ib).withConfig({displayName:"ShotsSettings___StyledRoundButton"})(["display:block;transform:rotate(-90deg);"]),Tc=Object(uo.e)(go.Gb).withConfig({displayName:"ShotsSettings___StyledTriangleIcon"})(["display:inline;"]),Mc=Object(uo.e)(go.n).withConfig({displayName:"ShotsSettings___StyledButton"})(["&:hover{color:",";}"],(function(t){return t._css3})),$c=Object(uo.e)(go.m).withConfig({displayName:"ShotsSettings___StyledBox3"})(["text-align:",";"],(function(t){return t._css4})),Ac=Object(uo.e)(go.m).withConfig({displayName:"ShotsSettings___StyledBox4"})(["label{cursor:default;}"]),Rc=Object(uo.e)(go.B).withConfig({displayName:"ShotsSettings___StyledFlex2"})(["border:1px solid rgba(64,64,64,0.08);&:hover{color:",";}"],(function(t){return t._css5})),Dc=function(t){var e=Object(po.useContext)(vo.BackboneContext).model,i=e.basePath,n=e.imageHeight,o=e.imageWidth,a=e.totalSize,r=e.numberOfImages,s=e._id,l=Object(po.useContext)(vo.BackboneContext),c=(l.model,l.modelSet,l.modelSave,Object(po.useContext)(ho.a).model),d=kc(Object(po.useState)(!1),2),h=d[0],u=d[1],p=kc(Object(po.useState)(!1),2),m=p[0],g=p[1],f=kc(Object(po.useState)(!0),2),v=f[0],b=f[1],y=kc(Object(po.useState)(!1),2),_=y[0],w=y[1],k=kc(Object(po.useState)(!1),2),S=k[0],x=k[1],C=kc(Object(po.useState)(""),2),O=C[0],j=C[1],P=kc(Object(po.useState)(""),2),E=P[0],I=P[1],T=kc(Object(po.useState)(!1),2),M=T[0],$=T[1],A=i&&n&&o&&a&&r,R=Object(po.useRef)(null),D=kc(t.useSharedState(),2),B=D[0],L=B.isUploading,z=B.uploadError,F=B.url,U=B.canDirectLinkBeUsed,N=D[1],H=c&&c.page&&c.page.workspace&&c.page.workspace.controls&&c.page.workspace.controls.findControl("playback_settings");Object(po.useEffect)((function(){i&&n&&o&&r&&a&&"boolean"==typeof L&&!L&&!z&&H&&c&&c.selected&&H.master.select(H)}),[L]),Object(po.useEffect)((function(){z&&z.length&&setTimeout((function(){N({uploadError:"",url:""}),b(!0),u(!1),O&&j("")}),4e3)}),[z]);var V=function(t){E===vc.Dropbox||t===vc.Dropbox&&E!==vc.Dropbox?(I(""),setTimeout((function(){I(t)}),0)):I(t)},W=function(t,e){var i=null!==t.match(/\.(webm|mpg|mp2|mpeg|mpe|mpv|ogg|ogv|mp4|m4p|m4v|avi|wmv|mov|qt|flv|swf|avchd|ts|3g|3g2)$/i);g(!i&&t.length>0),V(i?"":vc.Invalid),N({url:"".concat(i?e||t:"")})};Object(po.useEffect)((function(){var t=O.match(/(youtu\.be|youtube\.com)/),e=O.match(/(vimeo\.com)/),i=O.match(/(dropbox\.com)/);if(!O.length)return g(!1),void I("");if(null!==t||null!==e)return g(!0),void V(null!==t?vc.Youtube:vc.Vimeo);if(i){if(O.match(/preview/))return V(vc.Dropbox),void g(!0);var n=new URL(O),o=O.indexOf("?"),a=O.substring(0,-1!==o?o:O.length);n.searchParams.set("dl","1"),W(a,n.href)}else W(O)}),[O]);var G=function(t){t.size<=Ft.a.UPLOAD_SHOTS_SIZE_LIMIT?N({videoFile:t,isUploading:!0}):alert(Ft.a.MSG_UPLOAD_SHOTS_SIZE_ERROR),M&&$(!1)},q=Boolean(S||L||z||!i||!n||!o||!r||!a),K=!(L||z&&z.length);return mo.a.createElement(Eo,{control:function(t){var e=t.ref;return(mo.a.createElement(ko,{ref:e,label:"Shots settings",onClick:function(t){t.preventDefault(),c.disabled||(!c.selected&&S&&x(!1),c.select(),F&&(N({url:""}),b(!0),u(!1)))}},mo.a.createElement(go.lb,null)))},panel:function(t){var e=t.ref,i=t.style;return(mo.a.createElement(Ho,{ref:e,style:i},mo.a.createElement(zo.Consumer,null,(function(t){var e=t.tooltipContainer;return(mo.a.createElement(mo.a.Fragment,null,q?mo.a.createElement(go.Eb,{text:E,disabled:!E.length,position:"left",bg:"tomato",delay:2,width:"310px",height:"auto",whiteSpace:"pre-line",indent:4,container:e},mo.a.createElement(xc,{p:"8px 8px ".concat(U&&!h&&!M||z?0:L?"21px":"40px"),onDragLeaveCapture:function(t){var e=t&&t.relatedTarget;e&&e.classList&&(e.classList.contains("workspace")||e.classList.contains("origin"))&&$(!1)},onDragOver:function(t){$(!0)},userSelect:"none",width:"100%",height:"100%"},mo.a.createElement(Cc,{onClick:function(t){L&&h&&t.preventDefault()},id:"rm-shots-panel-main-file-upload-".concat(s),readFileData:!1,onChange:function(t){G(t)},dropFile:!L,accept:"video/*,.mkv",_css:L?"default":"pointer"},mo.a.createElement(Oc,{justifyContent:"space-between",flexDirection:z&&z.length?"column":"row",p:"0 8px 7px"},(!M||L)&&mo.a.createElement(go.Cb,{fontSize:"regular",color:"black",lineHeight:"1.5"},L?A?"Replacing...":"Uploading...":A?"Replace shots":"Shots"),z&&z.length&&mo.a.createElement(go.m,{pt:"47px",pb:"12px"},mo.a.createElement(go.Cb,{textStyle:"small",color:"tomato",lineHeight:"1.5"},z)),!A&&!L&&!z&&!M&&mo.a.createElement(go.ub,{href:"https://help.readymag.com/hc/en-us/articles/360045455132",target:"_blank"},mo.a.createElement(go.ib,{color:"transparent",mr:0,size:24,hoverColor:"darkGray"},mo.a.createElement(jc,{color:"gray",lineHeight:"1.5",textStyle:"small"},"?")))),mo.a.createElement(mo.a.Fragment,null,K&&U&&!M&&mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(Pc,{ref:R,height:"40px",p:"0 ".concat(F?"33px":"28px"," 0 8px"),placeholder:"Paste link to the file",value:O,onChange:function(t){var e=t.target.value;j(e)},onKeyDown:function(t){13===t.keyCode&&F&&N({isUploading:!0})},textStyle:"small",ellipsis:!0,border:"none !important",spellCheck:!1,bg:v&&!h?"transparent":"white",onFocus:function(){return u(!0)},onBlur:function(){O.length||u(!1)},_css2:v?go.Ub.blue:"transparent"}),K&&mo.a.createElement(Ec,{position:"absolute",top:"50%",right:"15px"},F&&!m&&!!O.length&&mo.a.createElement(go.m,null,mo.a.createElement(Ic,{size:24,onClick:function(t){t.stopPropagation(),u(!0),N({isUploading:!0})},mr:"1px",color:"gray",hoverColor:"blue"},mo.a.createElement(Tc,{color:"white"}))),m&&mo.a.createElement(go.m,null,mo.a.createElement(Mc,{onClick:function(t){t.stopPropagation(),t.preventDefault(),j(""),R&&R.current&&R.current.focus()},p:"10px 5px",_css3:go.Ub.tomato},mo.a.createElement(go.w,{color:"gray"}))))),L&&mo.a.createElement(go.B,{flexDirection:"column",pl:"8px",pt:"44px",cursor:"default"},mo.a.createElement(go.Cb,{textStyle:"small",color:"blue"},"It might take some time")),K&&!h&&mo.a.createElement($c,{position:"relative",top:M?"32px":U?0:"42px",height:"max-content",pl:M?0:"8px",pb:M?"44px":"20px",onMouseEnter:function(){w(!0)},onMouseLeave:function(){w(!1)},_css4:M?"center":"left"},mo.a.createElement(go.Cb,{textStyle:"small",cursor:"pointer",color:_||U?"gray":"blue"},M?"Drop file here":_||U?"or drop media here":"Upload video")))))):mo.a.createElement(Ac,{userSelect:"none"},mo.a.createElement(go.A,{id:"rm-shots-panel-replace-file-upload-".concat(s),readFileData:!1,onChange:function(t){G(t)},dropFile:!0,onClick:function(t){t.preventDefault()},accept:"video/*,.mkv"},mo.a.createElement(go.B,{p:"8px 15px 40px",flexDirection:"column"},mo.a.createElement(go.m,{pb:"5px"},mo.a.createElement(go.Cb,{fontSize:"regular",color:"black"},function(t){if(null!==t)return t.toString().split("").reverse().map((function(t,e){return 0!==e&&e%3==0?"".concat(t,"."):t})).reverse().join("")}(r)," shots loaded")),mo.a.createElement(go.B,{flexDirection:"column"},mo.a.createElement(go.Cb,{textStyle:"small",color:"darkGray"},o,"×",n," px"),mo.a.createElement(go.Cb,{textStyle:"small",color:"darkGray"},function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===t)return"0 Bytes";var i=1024,n=e<0?0:e,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(t)/Math.log(i));return parseFloat((t/Math.pow(i,a)).toFixed(n))+" "+o[a]}(a)," total size")))),mo.a.createElement(go.B,{px:"15px",pb:"16px"},mo.a.createElement(go.A,{id:"rm-shots-button-replace-file-upload-".concat(s),readFileData:!1,dropFile:!0,onChange:function(t){G(t)},disabled:U,accept:"video/*,.mkv"},mo.a.createElement(Rc,{width:"136px",justifyContent:"center",alignItems:"center",height:"40px",bg:"transparent",borderRadius:"8px",cursor:"pointer",color:"darkGray",onClick:function(t){U&&(t.preventDefault,j(""),x(!0))},_css5:go.Ub.black},mo.a.createElement(go.Cb,{textStyle:"small"},"Replace shots")))))))}))))}})},Bc=ho.b.extend({name:"shots_settings",component:Dc}),Lc=i("fEUr");function zc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Fc(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Fc(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Uc=Object(uo.e)(go.B).withConfig({displayName:"StartPopup___StyledFlex"})(["box-shadow:0 0 0 1px rgba(0,0,0,0.0672);"]),Nc=Object(uo.e)(go.B).withConfig({displayName:"StartPopup___StyledFlex2"})(["cursor:pointer;line-height:24px;transition:all 0.1s ease-out;font-size:14px;&:hover:before{background:",";}&:before{content:'';position:absolute;top:8px;left:-28px;border-radius:100%;background:",";height:6px;width:6px;}"],(function(t){return t._css}),(function(t){return t._css2})),Hc=Object(uo.e)(go.m).withConfig({displayName:"StartPopup___StyledBox"})(["&:after{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient( to right,rgba(61,61,61,0.18) 0%,rgba(61,61,61,0.18) 50%,transparent 50%,transparent 100% );background-size:2px 1px;background-position:0 100%;background-repeat:repeat-x;}"]),Vc=Object(uo.e)(go.B).withConfig({displayName:"StartPopup___StyledFlex3"})(["&:hover{color:tomato;}"]),Wc=Object(uo.e)(go.Y).withConfig({displayName:"StartPopup___StyledNumericInput"})(["transition:all 0.1s ease-out;"]),Gc=Object(uo.e)(go.Cb).withConfig({displayName:"StartPopup___StyledText"})(["transition:all 0.1s ease-out;"]),qc=Object(uo.e)(go.B).withConfig({displayName:"StartPopup___StyledFlex4"})(["box-shadow:inset 0 0 0 1px #e5e5e5;"]),Kc=Object(uo.e)(go.m).withConfig({displayName:"StartPopup___StyledBox2"})(["background:linear-gradient(to right,#2c9672 0%,#2c9672 50%,transparent 50%,transparent 100%);background-size:2px 1px;background-position:0 100%;background-repeat:repeat-x;"]),Yc=Object(uo.e)(go.m).withConfig({displayName:"StartPopup___StyledBox3"})(["clip:rect(0,111px,6px,-99px);"]),Xc=Object(uo.e)(go.m).withConfig({displayName:"StartPopup___StyledBox4"})(["transform:rotate(45deg);"]),Zc=function(t){var e=t.onEditScrollSettings,i=t.curOffset,n=t.curStartPoint,o=zc(Object(po.useState)(0),2),a=o[0],r=o[1],s=zc(Object(po.useState)(""),2),l=s[0],c=s[1],d=zc(Object(po.useState)(!1),2),h=d[0],u=d[1],p=Object(po.useRef)(null);Object(po.useEffect)((function(){n&&c(n),i&&r(i)}),[]);var m=63*{top:0,center:.5,bottom:1}[l],g=-63*a/window.innerHeight,f=Math.max(Math.min(m+g,63),0);return mo.a.createElement(Uc,{position:"absolute",flexDirection:"column",alignItems:"center",bg:"white",zIndex:102,userSelect:"none",borderRadius:"3px",height:"222px",width:"120px",left:"24px",top:"31px",onClick:function(t){t.stopPropagation()}},mo.a.createElement(go.B,{flexDirection:"column",pt:"8px"},["top","center","bottom"].map((function(t,i){var n=l===t;return(mo.a.createElement(Nc,{color:n?"#2c9672":"black",position:"relative",justifyContent:"center",key:i,onClick:function(){c(t),e({offset:a,selectedPoint:t===Lc.c.bottom?Lc.c.bottom:t===Lc.c.center?Lc.c.center:Lc.c.top})},_css:n?"#2c9672":"rgba(182, 182, 188, 0.48)",_css2:n?"#2c9672":"transparent"},_.default.capitalize(t)))}))),mo.a.createElement(go.B,{width:"100%",flexDirection:"column",pt:"8px",ref:p,textAlign:"center"},mo.a.createElement(Hc,{position:"relative",m:"0 8px",pt:"11px"},mo.a.createElement(go.Cb,{fontSize:"14px",color:a>0||a<0?"tomato":"black"},"Offset")),mo.a.createElement(Vc,{justifyContent:"center"},mo.a.createElement(Wc,{step:1,value:a,autoWidth:!0,focusOnClick:!0,onChange:function(t){r(t),e({offset:t,selectedPoint:l===Lc.c.bottom?Lc.c.bottom:l===Lc.c.center?Lc.c.center:Lc.c.top})},placeholder:"0",min:-9999,max:9999,labelRef:p,height:"24px",color:0!==a||h?"tomato":"rgba(68, 68, 76, 0.32)",fontSize:"22px",onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)}}),mo.a.createElement(Gc,{onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)},fontSize:"22px",color:0!==a||h?"tomato":"rgba(68, 68, 76, 0.32)"},"px"))),mo.a.createElement(qc,{width:"104px",height:"64px",position:"relative",m:"7px auto 0"},mo.a.createElement(Kc,{position:"absolute",left:"0",right:"0",height:"1px",top:m}),mo.a.createElement(go.m,{position:"absolute",left:"50%",width:"1px",bg:"tomato",top:Math.min(m,f),bottom:63-Math.max(m,f)}),mo.a.createElement(go.m,{position:"absolute",left:"0",right:"0",height:"1px",bg:"#2c9672",top:f})),mo.a.createElement(Yc,{position:"absolute",left:"50%",width:"12px",height:"6px",top:"-6px",ml:"-6px"},mo.a.createElement(Xc,{position:"absolute",width:"8px",height:"8px",left:"2px",top:"2px",bg:"white"})))};function Jc(t){return function(t){if(Array.isArray(t))return ed(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||td(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||td(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function td(t,e){if(t){if("string"==typeof t)return ed(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ed(t,e):void 0}}function ed(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var id=Object(uo.e)(go.cb).withConfig({displayName:"PlaybackSettings___StyledPlaybackIcon"})(["padding-left:2px;"]),nd=Object(uo.e)(go.m).withConfig({displayName:"PlaybackSettings___StyledBox"})({userSelect:"none"}),od=Object(uo.e)(go.m).withConfig({displayName:"PlaybackSettings___StyledBox2"})(["&:hover{*{color:",";}}"],(function(t){return t._css})),ad=Object(uo.e)(go.m).withConfig({displayName:"PlaybackSettings___StyledBox3"})(["&:hover{*{color:",";}}"],(function(t){return t._css2})),rd=Object(uo.e)(go.m).withConfig({displayName:"PlaybackSettings___StyledBox4"})(["border-bottom-color:transparent;transition:background-color 0.1s;&:hover{background-color:#fff;border-bottom-left-radius:",";border-bottom-right-radius:",";}"],(function(t){return t._css3}),(function(t){return t._css4})),sd=Object(uo.e)(go.Gb).withConfig({displayName:"PlaybackSettings___StyledTriangleIcon"})(["position:relative;top:2px;left:1px;"]),ld=Object(uo.e)(go.Cb).withConfig({displayName:"PlaybackSettings___StyledText"})(["overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&:hover{cursor:default;color:",";}"],(function(t){return t._css5})),cd=Object(uo.e)(go.Cb).withConfig({displayName:"PlaybackSettings___StyledText2"})(["cursor:",";&:hover{opacity:1;}"],(function(t){return t._css6})),dd=Object(uo.e)(go.Cb).withConfig({displayName:"PlaybackSettings___StyledText3"})(["writing-mode:vertical-rl;text-orientation:mixed;"]),hd=function(t){var e=Qc(Object(po.useState)(!1),2),i=e[0],n=e[1],o=Qc(Object(po.useState)(!1),2),a=o[0],r=o[1],s=Qc(Object(po.useState)("none"),2),l=s[0],c=s[1],d=Qc(Object(po.useState)(0),2),h=d[0],u=d[1],p=Qc(Object(po.useState)(!1),2),m=p[0],g=p[1],f=Object(po.useRef)(null),v=Object(po.useRef)(null),b=Object(po.useContext)(ho.a).model,y=Object(po.useContext)(vo.BackboneContext),w=y.model,k=y.modelSet,S=y.modelSave,x=Object(po.useContext)(vo.BackboneContext).model,C=x.playbackType,O=x.hoverDirection,P=x.triggers,E=x.scrollSpeed,I=x.scrollStartPoint,T=x._id,M=x.startPointOffset,$=x.scrollDelay,A=x.useEasing,R=Qc(t.useSharedState(),1)[0].viewport,D=R===ze.a.Default,B=Object(wa.a)((function(t){k(t),S()}),1e3).callback;Object(po.useEffect)((function(){b&&b.selected&&B(w)}),[C,O,P,E,I,M,$]);var L=C,z=O,F=P,U=E,N=I,H=M,V=$;Object(po.useEffect)((function(){var t=Math.min(84*$/window.innerHeight,84);u(t)}),[$]);var W=function(t){k({scrollStartPoint:t.selectedPoint}),k({startPointOffset:t.offset})};b.injectedRefs.canControlBeClosed=function(){return m?(g(!1),!0):"pending"===l};var G=Object(po.useRef)(null),q=function(t){k({triggers:[].concat(Jc(F||[]),[t])}),setTimeout((function(){c("none")}),0)};Object(po.useEffect)((function(){return"pending"===l&&j.a.enterPickTriggerMode(b.page.workspace,K,F,q),function(){j.a.leavePickTriggerMode(b.page.workspace)}}),[l]),Object(po.useEffect)((function(){D||O===Lc.a.horizontally||k({hoverDirection:Lc.a.horizontally})}),[R]);var K=Object(po.useMemo)((function(){return b.page.workspace.findBlock(w._id)}),[w._id]);return(mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(Eo,{control:function(t){var e=t.ref;return(mo.a.createElement(ko,{ref:e,label:"Playback settings",onClick:function(t){t.preventDefault(),b.disabled||b.select()}},mo.a.createElement(id,null)))},panel:function(t){var e=t.ref,o=t.style;return(mo.a.createElement(Ho,{ref:e,border:"none",style:o},mo.a.createElement(nd,null,mo.a.createElement(go.m,{position:"relative",zIndex:105},mo.a.createElement(Ss,{container:G?G.current:void 0,isCleanVariant:!1,p:"10px 22px",width:"calc(100% + 6px + 6px)",listItems:[{title:mo.a.createElement(od,{_css:Object(_a.themeGet)("colors.tomato")},mo.a.createElement(go.Cb,{color:L===Lc.b.hover?"tomato":"black"},D?"Hover":"Touchmove")),onClick:function(){k({playbackType:Lc.b.hover}),ka.d.sendEvent(ka.b.ShotsWidgetActions,{eventLabel:"Hover on"})}},{title:mo.a.createElement(ad,{_css2:Object(_a.themeGet)("colors.tomato")},mo.a.createElement(go.Cb,{color:L===Lc.b.scroll?"tomato":"black"},"Scroll")),onClick:function(){k({playbackType:Lc.b.scroll}),ka.d.sendEvent(ka.b.ShotsWidgetActions,{eventLabel:"Scroll on"})}}]},(function(t){var e=t.toggleDropdown;return(mo.a.createElement(rd,{position:"relative",cursor:"pointer",bg:"lightGray",width:"100%",borderRadius:"8px 8px 0 0",p:"10px 18px 10px 16px",zIndex:102,border:"1px solid",borderColor:"lightGray",_css3:C===Lc.b.hover?"8px":"0",_css4:C===Lc.b.hover?"8px":"0"},mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between",onClick:e},mo.a.createElement(go.Cb,{color:"tomato",fontSize:"regular"},D||C!==Lc.b.hover?_.default.capitalize(C):"Touchmove"),mo.a.createElement(sd,{color:"gray"}))))}))),L===Lc.b.scroll?mo.a.createElement(go.m,{position:"relative"},m&&!w.fixed_position&&mo.a.createElement(Zc,{curOffset:H,curStartPoint:N,onEditScrollSettings:W}),mo.a.createElement(go.m,{onClick:function(){m&&g(!1)}},w.fixed_position?mo.a.createElement(go.B,{flexDirection:"column",ref:v,position:"relative",textAlign:"center",height:"84px",bg:"#5f5f69"},mo.a.createElement(go.B,{position:"absolute",height:h,width:"100%",bg:"tomato",bottom:"0",left:"0"}),mo.a.createElement(go.m,{position:"relative",top:"10px",zIndex:100},mo.a.createElement(go.Cb,{textStyle:"small",color:"white"},"Delay")),mo.a.createElement(go.B,{zIndex:100,pl:"36px",pt:"11px",justifyContent:"center",alignItems:"center"},mo.a.createElement(go.Y,{step:1,value:V||0,autoWidth:!0,focusOnClick:!0,hideCursor:!0,onChange:function(t){k({scrollDelay:t})},labelRef:v,placeholder:"0",min:0,max:9999,height:"40px",color:"white",fontSize:"34px"}),mo.a.createElement(go.B,{position:"relative",top:"1px",left:"-1px"},mo.a.createElement(go.Cb,{fontSize:"34px",lineHeight:"1",color:"white",opacity:"0.3"},"px")))):mo.a.createElement(go.B,{cursor:"pointer",pt:"12px",position:"relative",zIndex:101,flexDirection:"column",textAlign:"center",height:"68px",bg:"#2C9773",onClick:function(){return g(!m)}},mo.a.createElement(go.Cb,{textStyle:"small",color:"white"},"Start Point"),mo.a.createElement(go.Cb,{fontSize:"subheading",lineHeight:"1.05",color:"white"},_.default.capitalize(N))),mo.a.createElement(go.B,{flexDirection:"column",pt:"12px",textAlign:"center",height:"84px",ref:f,bg:"#4E4E56"},mo.a.createElement(go.Cb,{textStyle:"small",color:"white"},"Speed"),mo.a.createElement(go.B,{pl:"27px",pt:"1px",justifyContent:"center",alignItems:"center"},mo.a.createElement(go.Y,{step:.01,value:U||1,autoWidth:!0,focusOnClick:!0,hideCursor:!0,labelRef:f,mouseSpeed:5,onChange:function(t){k({scrollSpeed:t})},placeholder:"1",min:.1,max:999,height:"40px",color:"white",fontSize:"34px"}),mo.a.createElement(go.B,{position:"relative",top:"1px",left:"-3px"},mo.a.createElement(go.Cb,{fontSize:"34px",lineHeight:"1",color:"white",opacity:"0.3"},"×")))))):mo.a.createElement(go.B,{flexDirection:"column"},mo.a.createElement(go.B,{flexDirection:"column",p:"0 0 12px"},F&&F.length>0&&F.map((function(t,e){var i=function(t){var e=b.page.workspace.findBlock(t);return T===t?"Self":e?e.model.get("name")||e.getStandardName():void 0}(t);return i&&mo.a.createElement(go.B,{p:"6px 30px 0 16px",key:e,mt:e>0?"4px":0,position:"relative"},mo.a.createElement(ld,{textStyle:"small",color:"black",onMouseOver:function(){return j.a.highlightActiveTriggerBlock(b.page.workspace,K,t,!0)},onMouseOut:function(){return j.a.highlightActiveTriggerBlock(b.page.workspace,K,t,!1)},_css5:go.Ub.blue},i),mo.a.createElement(go.n,{position:"absolute",top:"7px",right:"18px",onMouseOver:function(){return j.a.highlightActiveTriggerBlock(b.page.workspace,K,t,!0,!0)},onMouseOut:function(){return j.a.highlightActiveTriggerBlock(b.page.workspace,K,t,!1,!0)},onClick:function(){return function(t){j.a.highlightActiveTriggerBlock(b.page.workspace,K,t,!1,!0),k({triggers:F&&F.filter((function(e){return e!==t}))})}(t)},display:"flex",height:16},mo.a.createElement(go.w,{color:"gray"})))})),F&&F.length<3&&mo.a.createElement(go.B,{p:"6px 30px 0 16px",mt:"4px",position:"relative"},mo.a.createElement(cd,{onClick:function(){"none"===l&&c("pending")},textStyle:"small",opacity:"none"===l?"0.2":"1",color:"pending"===l?"blue":"black",_css6:"none"===l?"pointer":"default"},"none"===l?"Add":"Choose"," Trigger"),"pending"===l&&mo.a.createElement(go.n,{position:"absolute",top:"7px",right:"18px",onClick:function(){return c("none")},display:"flex",height:16},mo.a.createElement(go.w,{color:"gray"})))),mo.a.createElement(go.B,{justifyContent:"center",alignItems:"center",height:"68px",cursor:"pointer",bg:"horizontally"===z?"#2C9773":"#4E4E56",onClick:function(){k({hoverDirection:Lc.a.horizontally}),ka.d.sendEvent(ka.b.ShotsWidgetActions,{eventLabel:"Horizontal on"})},onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)}},mo.a.createElement(go.Cb,{fontSize:"subheading",color:"white",opacity:"horizontally"===z||a?1:.4},"Horizontal")),D&&mo.a.createElement(go.B,{justifyContent:"center",alignItems:"center",height:"168px",cursor:"pointer",bg:"vertically"===z?"#2C9773":"#4E4E56",onClick:function(){k({hoverDirection:Lc.a.vertically}),ka.d.sendEvent(ka.b.ShotsWidgetActions,{eventLabel:"Vertical on"})},onMouseEnter:function(){return n(!0)},onMouseLeave:function(){return n(!1)}},mo.a.createElement(dd,{fontSize:"subheading",color:"white",opacity:"vertically"===z||i?1:.4},"Vertical"))),mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!1,small:!0},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center",px:3},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Easing")),mo.a.createElement(go.m,null,mo.a.createElement(go.zb,{backgroundChecked:"tomato",checked:A,onChange:function(t){return k({useEasing:t})}}))))),mo.a.createElement(go.m,{ref:G})))}})))},ud=ho.b.extend({name:"playback_settings",component:hd});function pd(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function md(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?pd(Object(i),!0).forEach((function(e){gd(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):pd(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function gd(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var fd=function(){var t=Object(po.useContext)(vo.BackboneContext),e=t.model,i=t.modelSet,n=t.modelSave,o=Object(po.useContext)(ho.a).model,a=Object(po.useMemo)((function(){return e.columns||{count:1,gap:0}}),[e.columns]),r=Object(wa.a)(n,400).callback,s=Object(wa.a)((function(t){ka.d.sendEvent(ka.b.ColumnsPanel,{eventLabel:"Columns ".concat(t?"on":"off")})}),800,{trailing:!0}).callback,l=function(t,e){if(i({columns:md(md({},a),{},gd({},t,e))}),"count"===t){var n=e>1;n!==a.count>1&&s(n)}r()};return mo.a.createElement(Eo,{control:function(t){var e=t.ref;return(mo.a.createElement(ko,{ref:e,label:"Columns",onClick:function(t){t.preventDefault(),o.disabled||o.select()}},mo.a.createElement(go.u,{color:"white"})))},panel:function(t){var e=t.ref,i=t.style;return o.selected?mo.a.createElement(Ho,{ref:e,style:i,px:16,py:12},mo.a.createElement(go.m,{mb:24},mo.a.createElement(go.Cb,{textStyle:"regular"},"Columns")),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between",mb:18},mo.a.createElement(go.m,null,mo.a.createElement(go.m,{width:100},mo.a.createElement(go.t,{value:a.count,columns:12,onChange:function(t){return l("count",t)}}))),mo.a.createElement(go.m,null,mo.a.createElement(go.Y,{"aria-labelledby":"text-columns-count",value:a.count,onChange:function(t){return l("count",t)},min:1,max:12,positive:!0,textAlign:"right"}))),mo.a.createElement(go.B,{alignItems:"center",justifyContent:"space-between"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Gap")),mo.a.createElement(go.m,null,mo.a.createElement(go.Y,{"aria-labelledby":"text-columns-gap",value:a.gap,onChange:function(t){return l("gap",t)},min:0,max:100,positive:!0,textAlign:"right"})))):null}})},vd=ho.b.extend({name:"text_columns_new",component:fd});function bd(){return(bd=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function yd(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var _d=Object(uo.e)(go.Cb).withConfig({displayName:"Glyphs___StyledText"})(["font-family:",",sans-serif;font-weight:",";font-style:",";"],(function(t){return t._css}),(function(t){return t._css2}),(function(t){return t._css3})),wd=mo.a.memo((function(t){var e=t.item,i=t.onSelect,n=t.fontFamily,o=t.fontWeight,a=t.fontStyle,r=String.fromCharCode(e);return mo.a.createElement(go.m,{textAlign:"center"},mo.a.createElement(go.n,{variant:"clean",onClick:function(){return i(r)}},mo.a.createElement(_d,{"data-char":e,textStyle:"small",_css:n,_css2:o,_css3:a},r)))})),kd=mo.a.memo((function(t){var e=t.items,i=yd(t,["items"]);return(mo.a.createElement(go.G,{gridTemplateColumns:"repeat(6, 1fr)",gridRowGap:4},e.map((function(t,e){return mo.a.createElement(wd,bd({item:t,key:e},i))}))))})),Sd=function(t){return mo.a.createElement(go.jb,null,(function(e){var i=e.ref;return(mo.a.createElement(go.m,{ref:i,px:2,py:2},mo.a.createElement(kd,t)))}))},xd=mo.a.memo(Sd),Cd=i("KiUg");function Od(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return jd(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return jd(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jd(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Pd=Object(uo.e)(go.n).withConfig({displayName:"TextInsert___StyledButton"})(["&:hover{color:",";}"],(function(t){return t._css})),Ed=Object(uo.e)(go.n).withConfig({displayName:"TextInsert___StyledButton2"})(["&:hover{color:",";}"],(function(t){return t._css2})),Id=function(t,e){var i=t.style,n=Od(Object(po.useContext)(ho.a).model.useSharedState({partial:!1}),2),o=n[0],a=n[1],r=Od(Object(po.useState)([]),2),s=r[0],l=r[1],c=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(o,na.a.FontFamily)[0]||Na.b.fontFamily}),[o]),d=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(o,na.a.FontWeight)[0]||Na.b.fontWeight}),[o]),h=Object(po.useMemo)((function(){return la.a.getCurrentInlineStyles(o,na.a.FontStyle)[0]||Na.b.fontStyle}),[o]),u=Od(Object(ia.d)(),1)[0];Object(po.useEffect)((function(){if(c&&d&&h){var t=u[Object(ia.c)({fontFamily:c,fontWeight:d,fontStyle:h})];if(t){var e=t.characters;l(e&&e.length?e:[])}else l([])}}),[c,d,h,u]);var p=function(t){a(la.a.insertText({editorState:o,text:t}))};return(mo.a.createElement(Ho,{ref:e,style:i,pt:"6px"},mo.a.createElement(go.m,{mb:12,px:16},mo.a.createElement(go.Cb,{textStyle:"regular"},"Insert")),mo.a.createElement(go.a,{dynamicHeight:!0},mo.a.createElement(go.r,{renderButton:function(t){var e=t.isActive;return(mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{small:!0,showBorderTop:!1,showBorderBottom:!e},mo.a.createElement(Pd,{variant:"clean",textStyle:"small",color:e?"black":"darkGray",_css:Object(_a.themeGet)("colors.black")},"Glyph"))))},open:!0},(function(t){return mo.a.createElement(go.m,{ref:t,bg:"white",borderRadius:"0 0 8px 8px",height:320},mo.a.createElement(xd,{items:s,onSelect:function(t){ka.d.sendEvent(ka.b.InsertPanel,{eventLabel:"Glyph pasted"}),p(t)},fontFamily:c,fontWeight:d,fontStyle:h}))})),mo.a.createElement(go.r,{renderButton:function(t){var e=t.isActive;return(mo.a.createElement(go.m,{px:3},mo.a.createElement(Vo.a,{small:!0,showBorderTop:!1,showBorderBottom:!1},mo.a.createElement(Ed,{variant:"clean",textStyle:"small",color:e?"black":"darkGray",_css2:Object(_a.themeGet)("colors.black")},"Space"))))}},(function(t){return mo.a.createElement(go.m,{ref:t,bg:"white",py:2,px:3,borderRadius:"0 0 8px 8px"},Cd.d.map((function(t,e){var i=e===Cd.d.length-1;return(mo.a.createElement(go.m,{key:e,pb:i?void 0:"10px",mb:i?void 0:2,borderBottom:"1px solid",borderColor:i?"transparent":"lightGray"},mo.a.createElement(go.n,{variant:"clean",onClick:function(){ka.d.sendEvent(ka.b.InsertPanel,{eventLabel:"Space pasted"}),p(t.char)}},mo.a.createElement(go.Cb,{textStyle:"small"},t.name))))})))})))))},Td=mo.a.forwardRef(Id),Md=Object(uo.e)(go.Ab).withConfig({displayName:"TextInsert___StyledSymbolIcon"})(["position:relative;left:-1px;"]),$d=function(){var t=Object(po.useContext)(ho.a).model;return(mo.a.createElement(Eo,{control:function(e){var i=e.ref;return(mo.a.createElement(ko,{ref:i,label:"Insert",onClick:function(e){e.preventDefault(),t.disabled||t.select()}},mo.a.createElement(Md,{color:"white"})))},panel:function(e){var i=e.ref,n=e.style;return t.selected?mo.a.createElement(Td,{ref:i,style:n}):null}}))},Ad=ho.b.extend({name:"text_insert",component:$d});var Rd,Dd=i("t2H3");function Bd(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Ld(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Bd(Object(i),!0).forEach((function(e){Wd(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Bd(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function zd(t){return function(t){if(Array.isArray(t))return Vd(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Hd(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fd(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function Ud(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){Fd(a,n,o,r,s,"next",t)}function s(t){Fd(a,n,o,r,s,"throw",t)}r(void 0)}))}}function Nd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||Hd(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hd(t,e){if(t){if("string"==typeof t)return Vd(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Vd(t,e):void 0}}function Vd(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Wd(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Gd,qd=(Wd(Rd={},sa.b.URL,"Website URL"),Wd(Rd,sa.b.ScrollToTop,"Scroll to top"),Wd(Rd,sa.b.GoBack,"Go back"),Wd(Rd,sa.b.Anchor,"Anchor"),Wd(Rd,sa.b.Email,"Email"),Wd(Rd,sa.b.Page,"Go to page"),Wd(Rd,sa.b.Phone,"Phone number"),Rd);!function(t){t[t.Project=0]="Project",t[t.Global=1]="Global"}(Gd||(Gd={}));var Kd=Object(uo.e)(go.m).withConfig({displayName:"TextLink___StyledBox"})(["transform:translateY(-50%);"]),Yd=Object(uo.e)(go.n).withConfig({displayName:"TextLink___StyledButton"})(["display:block;"]),Xd=Object(uo.e)(go.H).withConfig({displayName:"TextLink___StyledInlineInput"})(["box-sizing:border-box;background-color:white;border-radius:8px;text-overflow:ellipsis;"]),Zd=Object(uo.e)(go.m).withConfig({displayName:"TextLink___StyledBox2"})(["transform:translateY(-50%);"]),Jd=Object(uo.e)(go.ib).withConfig({displayName:"TextLink___StyledRoundButton"})(["display:block;transform:rotate(-90deg);"]),Qd=Object(uo.e)(go.Gb).withConfig({displayName:"TextLink___StyledTriangleIcon"})(["display:inline;"]),th=Object(uo.e)(go.n).withConfig({displayName:"TextLink___StyledButton2"})(["vertical-align:middle;"]),eh=Object(uo.e)(go.m).withConfig({displayName:"TextLink___StyledBox3"})(["",""],(function(t){return t._css})),ih=Object(uo.e)(go.B).withConfig({displayName:"TextLink___StyledFlex"})(["white-space:nowrap;"]),nh=Object(uo.e)(go.Cb).withConfig({displayName:"TextLink___StyledText"})(["pointer-events:none;"]),oh=Object(uo.e)(go.n).withConfig({displayName:"TextLink___StyledButton3"})(["vertical-align:middle;"]),ah=function(t,e){var i,n=t.style,o=t.onHeightChanged,a=Object(po.useContext)(Ka).navigate,r=Object(po.useContext)(Th),s=r.setSelectedStyle,l=r.currentTab,c=r.setCurrentTab,d=Object(po.useContext)(ho.a),h=d.model,u=d.modelSet,p=Object(po.useMemo)((function(){return h.project.get("_id")}),[h]),m=Object(po.useMemo)((function(){return h.user.get("_id")}),[h]),g=window.RM.constructorRouter,f=g.mag,v=g.getCurrentPageNum,b=g.getCurrentPageId,y=g.zoom,w=g.workspace,k=Object(po.useMemo)((function(){return v()}),[]),S=Object(po.useMemo)((function(){return b()}),[]),x=Nd(h.useSharedState({partial:!1}),2),C=x[0],O=x[1],j=Nd(Object(po.useState)(""),2),P=j[0],E=j[1],I=Nd(Object(po.useState)(0),2),T=I[0],M=I[1],$=Nd(Object(po.useState)(!1),2),A=$[0],R=$[1],D=Nd(Object(po.useState)(!1),2),B=D[0],L=D[1],z=Nd(Object(po.useState)(!1),2),F=z[0],U=z[1],N=Nd(Object(po.useState)(0),2),H=N[0],V=N[1],W=Nd(Object(po.useState)(null),2),G=W[0],q=W[1],K=Object(po.useMemo)((function(){return w.position.top}),[]),Y=Object(po.useMemo)((function(){return w.getViewportPosition().pageHeight}),[]),X=(Wd(i={},sa.b.URL,(function(t){return!_.default.isValidEmail(t)&&(/^http(s?)\:\/\//i.test(t)||/^[\da-z\.-]+\.[a-z-]{2,}.*/i.test(t))})),Wd(i,sa.b.ScrollToTop,(function(t){return/^(back|scroll)\sto\stop$/i.test(t)})),Wd(i,sa.b.GoBack,(function(t){return/^(__rm_goback|go\sback)$/i.test(t)})),Wd(i,sa.b.Anchor,(function(t){return/^(__rm_anchor|\d+px)$/i.test(t)})),Wd(i,sa.b.Email,(function(t){return _.default.isValidEmail(t)})),Wd(i,sa.b.Page,(function(t){return!!f.getPageId(t)})),Wd(i,sa.b.Phone,(function(t){return/\+(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{1,14}$/i.test(t)})),i),Z=function(t){return t?Object.keys(X).reduce((function(e,i){if(null===e){var n=i;return X[n](t)?n:null}return e}),null):null};Object(po.useEffect)((function(){var t=Object(sa.d)(C);t?(E(t.url),q(t.type),L("_blank"===t.target),dt(t.linkStyle||sa.c.name),"number"==typeof t.anchorPosition&&V(t.anchorPosition),t.pageNum&&t.type===sa.b.Page&&M(t.pageNum),R(t.url?!(!t.url||!t.type):et.includes(t.type))):t||(E(""),dt(null),q(null),R(!1),M(0),L(!1))}),[C]);var J,Q=(J=sa.b,Object.keys(J).filter((function(t){return"number"!=typeof t||!Number.isInteger(t)})).map((function(t){return J[t]}))).map((function(t){return{label:qd[t],value:t}})),tt=Object(po.useMemo)((function(){return null!==G?qd[G]:"URL, page number..."}),[G]),et=[sa.b.GoBack,sa.b.ScrollToTop,sa.b.Email],it=Object(po.useMemo)((function(){return null!==G&&(P.length?Z(P)===G:et.includes(G))}),[P,G]),nt=Boolean(A&&G);Object(po.useEffect)((function(){if(A&&it&&G){var t=G===sa.b.Anchor?k:G===sa.b.Page?T:void 0,e=G===sa.b.Page?"":void 0;if(G===sa.b.Page&&P&&X[sa.b.Page](P)){var i=f.getPageId(P);if(i){e=f.getPageDataUri(i);var n=f.getPageNum(i);if(e&&e!==P)return void E(e);n&&T!==n&&(M(n),t=n)}}O(Object(sa.i)({editorState:C,url:P,anchorPosition:H,pageNum:t,pageUri:e||void 0,type:G,target:B?"_blank":"_self",linkStyle:ct||sa.c.name,pageId:G===sa.b.Anchor?S:void 0}))}}),[it,A,P,G,H,B]);var ot=document.querySelector("#main"),at=Nd(Object(po.useState)(null),2),rt=at[0],st=at[1],lt=Nd(Object(po.useState)(null),2),ct=lt[0],dt=lt[1],ht=Nd(Object(ia.e)(),2),ut=ht[0],pt=ht[1],mt=Object(po.useMemo)((function(){return l===Gd.Project?ut.project:ut.global}),[ut,l]),gt=function(){var t=Ud(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=zd(mt),(n=i.findIndex((function(t){return t.name===e.name})))>-1&&i.splice(n,0,Ld(Ld({},e),{},{name:"link-style-".concat(vs()()),label:"".concat(e.label," (Copy)")})),t.next=5,pt(Ld(Ld({},ut),{},Wd({},l===Gd.Global?"global":"project",i)));case 5:if(l!==Gd.Global){t.next=10;break}return t.next=8,Object(ur.Q)({userId:m,styles:i});case 8:t.next=12;break;case 10:return t.next=12,Object(ur.M)({projectId:p,styles:i});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ft=function(){var t=Ud(regeneratorRuntime.mark((function t(e,i){var n,o,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],o=[],i===Gd.Global?(n=zd(ut.project),(a=n.findIndex((function(t){return t.name===e.name})))>-1&&n.splice(a,1),o=[].concat(zd(ut.global),[e])):(o=zd(ut.global),(r=o.findIndex((function(t){return t.name===e.name})))>-1&&o.splice(r,1),n=[].concat(zd(ut.project),[e])),t.next=5,pt({global:o,project:n});case 5:return t.next=7,Object(ur.M)({projectId:p,styles:n});case 7:return t.next=9,Object(ur.Q)({userId:m,styles:o});case 9:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}(),vt=function(){var t=Ud(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return O(Object(sa.h)({editorState:C,oldStyle:e.name,newStyle:sa.c.name})),i=zd(mt),(n=i.findIndex((function(t){return t.name===e.name})))>-1&&i.splice(n,1),t.next=6,pt(Ld(Ld({},ut),{},Wd({},l===Gd.Global?"global":"project",i)));case 6:if(l!==Gd.Global){t.next=11;break}return t.next=9,Object(ur.Q)({userId:m,styles:i});case 9:t.next=13;break;case 11:return t.next=13,Object(ur.M)({projectId:p,styles:i});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),bt=function(){R(!1),E(""),q(null),O(Object(sa.g)(C))};Object(po.useEffect)((function(){return function(){u({preventClose:!1})}}),[]);var yt=Nd(Object(po.useState)(Ft.a.textWidget.textLinkPanelDefaultHeight),2),_t=yt[0],wt=yt[1];Object(po.useEffect)((function(){var t=h.project.edit_params.get("controls");t&&t.LinkStyleList&&wt(t.LinkStyleList)}),[]);var kt=Object(po.useRef)(null);Object(po.useEffect)((function(){kt&&kt.current&&kt.current.focus()}),[]);var St=Object(po.useRef)(null),xt=Nd(Object(po.useState)(!0),2),Ct=xt[0],Ot=xt[1];Object(po.useEffect)((function(){St.current&&Ct&&St.current.scrollIntoView(),Ot(!0)}),[St.current]);var jt=Object(po.useMemo)((function(){return!C.getSelection().isCollapsed()}),[C]),Pt=Nd(Object(po.useState)(!1),2),Et=Pt[0],It=Pt[1];return Object(po.useEffect)((function(){jt&&It(!0)}),[jt]),mo.a.createElement(mo.a.Fragment,null,G===sa.b.Anchor&&h.selected&&mo.a.createElement(go.f,{container:ot,isVisible:G===sa.b.Anchor,isActive:F,value:K+H*y.getZoom(),considerScroll:!0,workspaceHeight:Y,onChange:function(t){var e=t-K,i=Math.round(e/y.getZoom());V(i),E("".concat(i,"px")),U(!1),R(!0),u({preventClose:!1})}}),mo.a.createElement(Ho,{ref:e,style:n,resizable:A,onResizeComplete:function(t){wt(t);var e=h.project.edit_params.get("controls");h.project.edit_params.set("controls",Ld(Ld({},e),{},{LinkStyleList:t})),h.project.edit_params.save()},height:A?_t:90},mo.a.createElement(zo.Consumer,null,(function(t){var e=t.dropdownContainer;return(mo.a.createElement(mo.a.Fragment,null,mo.a.createElement(go.B,{height:"100%",width:"100%",flexDirection:"column"},mo.a.createElement(go.m,{mb:12,px:16,pt:"6px"},mo.a.createElement(go.Cb,{textStyle:"regular"},"Link")),mo.a.createElement(go.m,{mb:A&&G&&!et.includes(G)&&G!==sa.b.Anchor?"0":12,px:2,position:"relative"},mo.a.createElement(ea,{container:e,items:Q,value:null!==G?G:void 0,onSelect:function(t){var e=t.value;et.includes(e)&&R(!0),q(e);var i=e===sa.b.Anchor;setTimeout((function(){U(i),u({preventClose:i})}),0)}},(function(t){var e=t.toggleDropdown,i=t.ref;return(mo.a.createElement("form",{onSubmit:function(t){t.preventDefault(),A||!it||nt||R(!0)}},mo.a.createElement(go.m,{ref:i,position:"relative"},G===sa.b.Anchor&&mo.a.createElement(Kd,{ml:12,position:"absolute",top:"50%",left:0},mo.a.createElement(Yd,{onClick:function(){setTimeout((function(){U(!0),u({preventClose:!0})}),0)}},mo.a.createElement(go.lb,{color:"gray"}))),!jt&&Et&&mo.a.createElement(Dd.a,{ml:"-4px",visibility:"visible",text:"You have not selected the text that should be a link",position:"absolute",top:7,right:155,zIndex:1e5}),mo.a.createElement(Xd,{"aria-labelledby":"text-link-input",disabled:!jt,textStyle:"small",ref:kt,p:"0 36px 0 ".concat(G===sa.b.Anchor?"36px":"8px"),border:"none !important",height:40,value:P,placeholder:tt,onChange:function(t){var e=t.target.value;E(e);var i=Z(e);q(i),i===sa.b.Anchor&&V(parseInt(e))},onBlur:function(){P||!A||G?!P&&A&&G&&!et.includes(G)&&R(!1):(bt(),o&&o())}}),mo.a.createElement(Zd,{position:"absolute",top:"50%",right:0},it?nt?mo.a.createElement(go.m,{mr:14},mo.a.createElement(go.n,{type:"button",onClick:bt,variant:"clean","aria-labelledby":"text-link-set-delete"},mo.a.createElement(go.w,{color:"gray"}))):mo.a.createElement(go.m,{mr:1},mo.a.createElement(Jd,{"aria-labelledby":"text-link-set-button",size:24,disabled:!jt,onClick:function(){return R(!0)},color:"gray",hoverColor:"blue"},mo.a.createElement(Qd,{color:"white"}))):mo.a.createElement(go.m,{mr:14},mo.a.createElement(th,{disabled:!jt,type:"button",onClick:e,variant:"clean","aria-labelledby":"text-link-set-dropdown"},mo.a.createElement(go.Gb,{color:"gray"})))))))}))),A?mo.a.createElement(mo.a.Fragment,null,G&&!et.includes(G)&&G!==sa.b.Anchor?mo.a.createElement(go.m,{px:16,mb:2},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Open in tab")),mo.a.createElement(go.m,null,mo.a.createElement(go.zb,{checked:B,backgroundChecked:"black",onChange:function(){return L(!B)}}))))):null,mo.a.createElement(go.B,{flexDirection:"column",flex:"1 1"},mo.a.createElement(go.m,{px:16},mo.a.createElement(go.Bb,{items:[{title:"Project"},{title:"Global"}],activeIndex:l,onChange:c,borderColor:"rgba(184, 184, 184, 0.24)",textStyle:{textStyle:"small"}})),mo.a.createElement(go.m,{flex:"1 1",position:"relative"},mo.a.createElement(go.m,{position:"absolute",top:"0",left:"0",right:"0",bottom:"0"},mo.a.createElement(go.jb,null,(function(t){var i=t.ref;return(mo.a.createElement(go.m,{ref:i},(mt||[]).map((function(t,i){var n=ct?ct===t.name:t.name===sa.c.name;return(mo.a.createElement(Ss,{container:e,key:i,listItems:[{title:"Edit",onClick:function(){!function(t){s(t),a(_h.EditStyle)}(t)}},{title:"Duplicate",onClick:function(){gt(t)}},{title:"Move to ".concat(l===Gd.Global?"Project":"Global"),onClick:function(){ft(t,l===Gd.Global?Gd.Project:Gd.Global)}},{title:"Delete",onClick:function(){vt(t)}}]},(function(e){var o=e.toggleDropdown;return(mo.a.createElement(eh,{position:"relative",onMouseEnter:function(){return st(i)},onMouseLeave:function(){return st(null)},cursor:"pointer",ref:n?St:void 0,_css:"user-select: none"},mo.a.createElement(go.m,{bg:n?"blue":"gray",opacity:rt===i||n?.2:0,position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0}),mo.a.createElement(go.B,{px:16,py:"8px",justifyContent:"space-between",alignItems:"center",position:"relative"},mo.a.createElement(ih,{width:"100%",maxWidth:108,overflow:"hidden",onClick:function(){Ot(!1),function(t){G&&O(Object(sa.i)({editorState:C,url:P,anchorPosition:H,pageNum:G===sa.b.Anchor?k:G===sa.b.Page?T:void 0,type:G,target:B?"_blank":"_self",linkStyle:t.name}))}(t)}},mo.a.createElement(nh,{textStyle:"small",className:t.name},t.label)),rt===i?mo.a.createElement(go.n,{height:16,onClick:o,variant:"clean"},mo.a.createElement(go.Hb,{color:"black"})):void 0)))})))}))))})))),mo.a.createElement(go.m,{px:16},mo.a.createElement(Vo.a,{showBorderBottom:!1,small:!0},mo.a.createElement(go.m,{width:"100%",textAlign:"center"},mo.a.createElement(oh,{"aria-labelledby":"text-link-style-plus",onClick:function(){s(void 0),a(_h.EditStyle)},variant:"clean",height:18},mo.a.createElement(go.eb,{color:"black"}))))))):null)))}))))},rh=mo.a.forwardRef(ah),sh=i("8RDp");function lh(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function ch(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){lh(a,n,o,r,s,"next",t)}function s(t){lh(a,n,o,r,s,"throw",t)}r(void 0)}))}}function dh(t){return function(t){if(Array.isArray(t))return vh(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||fh(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hh(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function uh(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ph(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?uh(Object(i),!0).forEach((function(e){mh(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):uh(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function mh(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function gh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||fh(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fh(t,e){if(t){if("string"==typeof t)return vh(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?vh(t,e):void 0}}function vh(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var bh,yh=function(t){var e=t.type,i=t.size,n=gh(Object(po.useState)(!1),2),o=n[0],a=n[1];return mo.a.createElement(go.B,{width:"100%",height:16,alignItems:"center",justifyContent:"center",cursor:"pointer",onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)}},mo.a.createElement(sh.a,{color:o?"0080FF64":"28282864",type:e,size:i}))};!function(t){t.SetInfo="SetInfo",t.SetStyle="SetStyle",t.Reset="Reset"}(bh||(bh={}));var _h,wh=function(t,e){switch(e.type){case bh.Reset:return ph({},e.payload);case bh.SetInfo:return ph(ph({},t),e.payload);case bh.SetStyle:var i=e.payload,n=i.section,o=hh(i,["section"]);return ph(ph({},t),{},{style:ph(ph({},t.style),{},mh({},n,ph(ph({},t.style[n]||{}),o)))});default:return t}},kh=Object(uo.e)(go.Cb).withConfig({displayName:"TextLinkStyle___StyledText"})(["display:block;"]),Sh=Object(uo.e)(go.Cb).withConfig({displayName:"TextLinkStyle___StyledText2"})(["white-space:nowrap;"]),xh=function(t,e){var i=t.style,n=t.headerSlot,a=Object(po.useContext)(Ka).goBack,r=Object(po.useContext)(ho.a).model,s=Object(po.useMemo)((function(){return r.project.get("_id")}),[r]),l=Object(po.useMemo)((function(){return r.user.get("_id")}),[r]),c=Object(po.useContext)(vo.BackboneContext).model,d=Object(po.useContext)(Th),h=d.selectedStyle,u=d.currentTab,p=gh(r.useSharedState({partial:!1}),2),m=p[0],g=p[1],f=gh(Object(ia.e)(),2),v=f[0],b=f[1],y=u===Gd.Global?v.global:v.project,_=u===Gd.Global?"global":"project",w=function(t){E({type:bh.SetStyle,payload:{section:$,type:t}})},k=[{title:"None",onClick:function(){return w(ba.a.None)}},{title:mo.a.createElement(yh,{size:2,type:ba.a.Solid}),onClick:function(){return w(ba.a.Solid)}},{title:mo.a.createElement(yh,{size:2,type:ba.a.Dotted}),onClick:function(){return w(ba.a.Dotted)}},{title:mo.a.createElement(yh,{size:2,type:ba.a.Dashed}),onClick:function(){return w(ba.a.Dashed)}}],S=Object(po.useMemo)((function(){var t=Object(sa.d)(m),e=t&&t.type||null,i=c.is_global,n=r.workspace&&r.workspace.block&&r.workspace.block.model&&r.workspace.block.model.get("is_global");return Boolean(i||n)&&e===sa.b.Page}),[c,r.workspace,m]),x=gh(Object(po.useState)(h?h.name:"link-style-".concat(vs()())),1)[0],C=Object(po.useMemo)((function(){var t={padding:0,size:1,type:ba.a.Solid,color:Object(oa.h)(aa.c),textColor:Object(oa.h)(aa.c)};return{name:x,label:"New Style",style:{link:t,hover:t,current:t}}}),[]),O=Object(po.useMemo)((function(){if(h)return h;var t=ph(ph({},v),{},mh({},_,[].concat(dh(v[_]),[ph({},C)])));return b(t),t[_].find((function(t){return t.name===x}))||{}}),[h,C]),j=gh(Object(po.useReducer)(wh,O),2),P=j[0],E=j[1],I=gh(Object(po.useState)(0),2),T=I[0],M=I[1],$=0===T?"link":1===T?"hover":"current",A=Object(po.useMemo)((function(){var t=[{title:"Link"},{title:"Hover"}];return S?[].concat(t,[{title:"Current"}]):t}),[S]),R=function(){var t=y.findIndex((function(t){return t.name===P.name}));if(t>-1){var e=dh(y);return e[t]=ph({},P),b(ph(ph({},v),{},mh({},_,e))),e}},D=gh(Object(po.useState)(!h),2),B=D[0],L=D[1];Object(po.useEffect)((function(){R();var t=!o.a.isEqual(O,P);t!==B&&L(t)}),[P,$]),Object(po.useEffect)((function(){var t,e;null===(t=r.block)||void 0===t||null===(e=t.propsModel)||void 0===e||e.set({currentLinkStyle:$})}),[$]);var z=Object(po.useCallback)(ch(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=R())){t.next=9;break}if(u!==Gd.Global){t.next=7;break}return t.next=5,Object(ur.Q)({userId:l,styles:e});case 5:t.next=9;break;case 7:return t.next=9,Object(ur.M)({projectId:s,styles:e});case 9:case"end":return t.stop()}}),t)}))),[y,P]),F=Object(po.useCallback)((function(){var t=dh(y),e=t.findIndex((function(t){return t.name===x}));e>-1&&(h?t[e]=h:t.splice(e,1),b(ph(ph({},v),{},mh({},_,t))))}),[h,B,v,x]),U=gh(Object(po.useState)(void 0),2),N=U[0],H=U[1],V=Object(po.useMemo)((function(){return Object(sa.d)(m)}),[]);Object(po.useEffect)((function(){!h&&V&&(H(null==V?void 0:V.linkStyle),g(Object(sa.i)(ph(ph({editorState:m},V),{},{linkStyle:x}))))}),[]);var W=Object(po.useMemo)((function(){var t=P.style[$]||{};return{textColor:t.textColor||Object(oa.h)(aa.c),color:t.color||Object(oa.h)(aa.c),type:t.type||ba.a.None,padding:t.padding||0,size:t.size||1}}),[P,$]),G=W.textColor,q=W.color,K=W.type,Y=W.padding,X=W.size,Z=K===ba.a.None;return mo.a.createElement(Ho,{ref:e,style:i,scrollable:!0},mo.a.createElement(zo.Consumer,null,(function(t){var e=t.dropdownContainer;return(mo.a.createElement(mo.a.Fragment,null,n||null,mo.a.createElement(go.m,{px:16},mo.a.createElement(go.m,{mb:"7px"},mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.H,{"aria-labelledby":"text-link-style-name",textStyle:"regular",value:P.label,onChange:function(t){E({type:bh.SetInfo,payload:{label:t.target.value}})},p:0,border:"none !important",placeholder:"Style Name"}))),mo.a.createElement(go.m,{position:"relative",zIndex:0},mo.a.createElement(go.Bb,{items:A,activeIndex:T,onChange:M,textStyle:{textStyle:"small"}})),mo.a.createElement(Ha.a,{"aria-labelledby":"link-text-color",container:e,showBorderTop:!1,small:!0,title:"Text color",projectId:s,userId:l,color:Object(oa.e)(G),setColor:function(t){t&&E({type:bh.SetStyle,payload:{section:$,textColor:Object(oa.h)(t)}})}}),mo.a.createElement(Ss,{listItems:k,container:e},(function(t){var e=t.toggleDropdown;return(mo.a.createElement(Vo.a,{showBorderTop:!1,small:!0},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Underline")),mo.a.createElement(go.m,null,mo.a.createElement(go.n,{onClick:e,variant:"clean",width:46},Z?mo.a.createElement(kh,{textStyle:"small"},"None"):mo.a.createElement(yh,{size:2,type:K}))))))})),mo.a.createElement(Ha.a,{"aria-labelledby":"link-underline-color",container:e,disabled:Z,showBorderTop:!1,small:!0,title:"Underline color",projectId:s,userId:l,color:Object(oa.e)(q),setColor:function(t){t&&E({type:bh.SetStyle,payload:{section:$,color:Object(oa.h)(t)}})}}),mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!0,small:!0,disabled:Z},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(Sh,{textStyle:"small"},"Underline width")),mo.a.createElement(go.m,null,mo.a.createElement(go.Y,{"aria-labelledby":"text-link-style-underline-width",min:1,max:99,value:X,positive:!0,textAlign:"right",onChange:function(t){E({type:bh.SetStyle,payload:{section:$,size:t}})}})))),mo.a.createElement(Vo.a,{showBorderTop:!1,showBorderBottom:!0,small:!0,disabled:Z},mo.a.createElement(go.B,{justifyContent:"space-between",alignItems:"center"},mo.a.createElement(go.m,null,mo.a.createElement(go.Cb,{textStyle:"small"},"Padding")),mo.a.createElement(go.m,null,mo.a.createElement(go.Y,{"aria-labelledby":"text-link-style-padding",min:-99,max:99,value:Y,textAlign:"right",onChange:function(t){E({type:bh.SetStyle,payload:{section:$,padding:t}})}})))),mo.a.createElement(es,{cancelAction:ch(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F();case 2:!h&&V&&g(Object(sa.i)(ph(ph({editorState:m},V),{},{linkStyle:N}))),a();case 4:case"end":return t.stop()}}),t)}))),doneDisabled:!B,doneAction:ch(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z();case 2:a();case 3:case"end":return t.stop()}}),t)})))}))))})))},Ch=mo.a.forwardRef(xh);function Oh(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function jh(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Oh(Object(i),!0).forEach((function(e){Ph(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Oh(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Ph(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Eh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ih(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ih(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ih(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}!function(t){t.EditInfo="EditInfo",t.EditStyle="EditStyle"}(_h||(_h={}));var Th=mo.a.createContext({}),Mh=function(){var t=Object(po.useContext)(ho.a).model,e=Eh(t.useSharedState({partial:!1}),1)[0],i=Object(sa.d)(e),n=Eh(Object(po.useState)({currentTab:Gd.Project}),2),o=n[0],a=n[1],r=Object(po.useCallback)((function(t){return a(jh(jh({},o),{},{selectedStyle:t}))}),[o]),s=Object(po.useCallback)((function(t){return a(jh(jh({},o),{},{currentTab:t}))}),[o]),l=Object(po.useRef)(),c=Za(l.current),d=c.canControlBeClosed,h=c.onStackUpdated;return t.injectedRefs.canControlBeClosed=d,mo.a.createElement(Eo,{centerPanel:!!i,control:function(e){var n=e.ref;return(mo.a.createElement(ko,{isActive:!!i,ref:n,label:"Link",onClick:function(e){if(e.preventDefault(),!t.disabled){if(l.current&&l.current.currentScreen!==_h.EditInfo){if(t.selected)return void l.current.goBack();a(jh(jh({},o),{},{selectedStyle:void 0})),l.current.goHome()}t.select()}}},mo.a.createElement(go.N,{color:"white"})))},panel:function(e){var i=e.ref,n=e.style,a=e.update;return t.selected?mo.a.createElement(Th.Provider,{value:jh(jh({},o),{},{setSelectedStyle:r,setCurrentTab:s})},mo.a.createElement(Xa,{ref:l,initialScreen:_h.EditInfo,onStackUpdated:function(e){var i,n;null===(i=t.block)||void 0===i||null===(n=i.propsModel)||void 0===n||n.set({currentLinkStyle:""}),h(e)},onNavigate:function(){a()},childRef:i},mo.a.createElement(rh,{key:_h.EditInfo,style:n,onHeightChanged:a}),mo.a.createElement(Ch,{key:_h.EditStyle,style:n}))):null}})},$h=ho.b.extend({name:"text_link_new",component:Mh});function Ah(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Rh(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Rh(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rh(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Dh=function(){var t=Object(po.useContext)(vo.BackboneContext),e=t.model,i=t.modelSet,n=t.modelSave,o=Object(po.useContext)(ho.a).model,a=Object(po.useMemo)((function(){return o.project.get("_id")}),[o]),r=Object(po.useMemo)((function(){return o.user.get("_id")}),[o]),s=Ah(Object(po.useState)(aa.c),2),l=s[0],c=s[1],d=Object(po.useMemo)((function(){return Object(oa.g)(l)}),[l]);Object(po.useEffect)((function(){var t=Object(oa.b)(e.bg_color||"000000",e.bg_opacity);c(t)}),[e.bg_color,e.bg_opacity]);var h=function(t){i({bg_color:Object(oa.g)(t),bg_opacity:t.a})},u=Object(wa.a)(n,400).callback;return mo.a.createElement(Eo,{control:function(t){var e=t.ref;return(mo.a.createElement(ko,{ref:e,label:"Color",onClick:function(t){t.preventDefault(),o.disabled||o.select()}},mo.a.createElement(aa.a,{hex:"#"+d})))},panel:function(t){var e=t.ref,i=t.style;return o.selected?mo.a.createElement(Ho,{ref:e,style:i,width:"auto",bg:"transparent",border:"none"},mo.a.createElement(aa.b,{projectId:a,userId:r,color:l,setColor:h,onChangeComplete:function(t){h(t),u()}})):null}})},Bh=ho.b.extend({restrictions:function(){return Object(n.a)("constructor.newColorpicker")},name:"shape_color_new",component:Dh,saveOnDeselect:!0,saveOnDestroy:!0,save:function(){"icon"!==this.model.get("tp")?this.model.save({}):this.block.saveNewColor()}});function Lh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return zh(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zh(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zh(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Fh=function(){var t=Object(po.useContext)(vo.BackboneContext),e=t.model,i=t.modelSet,n=t.modelSave,o=Object(po.useContext)(ho.a).model,a=Object(po.useMemo)((function(){return o.project.get("_id")}),[o]),r=Object(po.useMemo)((function(){return o.user.get("_id")}),[o]),s=Lh(Object(po.useState)(aa.c),2),l=s[0],c=s[1],d=Object(po.useMemo)((function(){return Object(oa.g)(l)}),[l]);Object(po.useEffect)((function(){var t=Object(oa.b)(e.pic_color||"000000",e.pic_opacity);c(t)}),[e.pic_color,e.pic_opacity]);var h=function(t){i({pic_color:Object(oa.g)(t),pic_opacity:t.a})},u=Object(wa.a)(n,400).callback;return mo.a.createElement(Eo,{control:function(t){var e=t.ref;return(mo.a.createElement(ko,{ref:e,label:"Color",onClick:function(t){t.preventDefault(),o.disabled||o.select()}},mo.a.createElement(aa.a,{hex:"#"+d})))},panel:function(t){var e=t.ref,i=t.style;return o.selected?mo.a.createElement(Ho,{ref:e,style:i,width:"auto",bg:"transparent",border:"none"},mo.a.createElement(aa.b,{projectId:a,userId:r,color:l,setColor:h,onChangeComplete:function(t){h(t),u()}})):null}})},Uh=ho.b.extend({restrictions:function(){return Object(n.a)("constructor.newColorpicker")},name:"picture_color_new",component:Fh,saveOnDeselect:!0,saveOnDestroy:!0,bindLogic:function(){this.model.on("change:pic_color",this.onColorChange),this.model.on("change:pic_opacity",this.onColorChange)},unBindLogic:function(){this.model.off("change:pic_color",this.onColorChange),this.model.off("change:pic_opacity",this.onColorChange)},onColorChange:function(t){if(this.block.$svg){var e=t.get("pic_color"),i=t.get("pic_opacity");this.block.setVectorColor(e,i)}},save:function(){this.block.saveSvg(o.a.bind(this.model.save,this.model))}}),Nh=e.default={common_layer:l,common_align:h,common_animation:Object(n.a)("constructor.resetWhenOutOfView")?B:K,common_pack:J,common_unpack:et,common_rotation:Le,common_position:He,text_styles:Ke,text_typography:Ze,text_bius:ti,text_align:ni,text_autosize:ri,anchor_picker:ci,text_link:ui,text_color:gi,text_columns:bi,text_edit:wi,picture_crop:Ci,picture_fwpos:Ei,picture_link:Ii,picture_color:$i,picture_settings:Ai,slideshow_manager:Bi,shape_color:Fi,shape_settings:Ui,shape_1x1:Vi,shape_icon:qi,gmaps_edit:Xi,gmaps_settings:Zi,common_lock:tn,button_edit:on,button_settings:an,button_icon:cn,hotspot_add:pn,hotspot_pin_settings:vn,hotspot_tip_settings:_n,form_content:Tn,form_captcha:An,form_endpoints:Ln,form_styles:Un,video_settings:Nn,audio_settings:Hn,twitter_settings:Vn,facebook_settings:Wn,iframe_edit:Gn,cart_connections:qn,cart_settings:Kn,cart_add_product_widget:Qn,product_selector:to,add_to_cart_settings:eo,slideshow_settings:io,slideshow_transitions:no,picture_preview:so,picture_alt:lo,rmheader_settings:co,text_color_new:fa,text_align_new:Fa,text_advanced_typography:_c,text_typography_new:wc,shots_settings:Bc,playback_settings:ud,text_columns_new:vd,text_insert:Ad,text_link_new:$h,shape_color_new:Bh,picture_color_new:Uh}},hdsW:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW");i("eN9J"),i("l2W4");var s=window.SC,l=window.soundcloud;delete window.SC,delete window.soundcloud;var c=i("f3SV"),d=i("pFlR"),h=i("csmR"),u=i.n(h),p=i("QNiq"),m=i("Vxjr"),g=a.a.View.extend({initialize:function(t){var e=t.params,i=t.$container,n=t.readyCallback,o=t.viewport,a=t.viewportWidth,s=t.viewerOptions;r.a.bindAll(this),this.params=e,this.$container=i,this.readyCallback=n||function(){},!Object(r.a)(["standard","visual"]).contains(e.current_type)&&!Modernizr.opera||Modernizr.msie?this.player=new v({params:e,$container:i,readyCallback:n,parent:this,viewport:o,viewportWidth:a,viewerOptions:s}):this.player=new f({params:e,$container:i,readyCallback:n,parent:this}),this.render()},render:function(){this.player&&this.player.render()},show:function(){this.player&&this.player.show()},play:function(){this.player&&this.player.play()},pause:function(){this.player&&this.player.pause()},applyPlayerStyle:function(t){this.player&&this.player.applyPlayerStyle&&this.player.applyPlayerStyle(t)},destroy:function(){this.player&&(this.player.isDestroyed=!0,this.player&&this.player.destroy(),this.player=null)}}),f=a.a.View.extend({initialize:function(t){var e=t.params,i=t.$container,n=t.readyCallback,o=t.parent;r.a.bindAll(this),this.inner_template=u.a["template-common-audio-player-standard"],this.parent=o,this.params=e,this.$container=i,this.readyCallback=n||function(){}},render:function(){var t=[];t.push("auto_play=false"),t.push("buying="+this.params.socials),t.push("liking="+this.params.socials),t.push("download="+this.params.socials),t.push("sharing="+this.params.socials),t.push("show_artwork="+this.params.artwork),t.push("show_comments="+this.params.comments),t.push("show_playcount="+this.params.playcount),t.push("color="+this.params.color),t.push("auto_advance=true"),t.push("show_user=true"),"visual"==this.params.current_type&&t.push("visual=true"),this.params.parsed_url=this.params.parsed_url.replace(/^http:/,"https:");var e=this.params.parsed_url+"&"+t.join("&");this.setElement(Object(n.a)(this.inner_template({src:e}))),this.$container.append(this.$el),this.player=s.Widget(this.$el[0]),this.player.bind("ready",r.a.bind((function(){setTimeout(r.a.bind((function(){this.readyCallback(this.parent)}),this),500)}),this)),setTimeout(r.a.bind((function(){this.readyCallback(this.parent)}),this),2e3)},show:function(){this.$el&&this.$el.css("opacity",1)},play:function(){this.player&&this.player.play()},pause:function(){this.player&&this.player.pause()},destroy:function(){this.player.unbind("ready"),this.$el&&this.$el.remove(),this.player=null}}),v=a.a.View.extend({apiKey:c.a.SOUNDCLOUD_API,defaultCover:Object(m.findImagePath)("./common/audio-player/cover.png"),initialize:function(t){var e=t.params,i=t.$container,n=t.readyCallback,o=t.parent,a=t.viewport,s=t.viewportWidth,l=t.viewerOptions;r.a.bindAll(this),this.inner_template=u.a["template-common-audio-player-minimal"],this.parent=o,this.params=e,this.$container=i,this.readyCallback=n||function(){},this.viewportWidth=s,this.viewport=a,this.viewerOptions=l,this.isHTHML5=this.html5AudioAvailable()},render:function(){this.setElement(Object(n.a)(this.inner_template({src:this.params.url}))),this.$container.append(this.$el),this.applyPlayerStyle(this.params),this.isHTHML5?this.audioEngine=new b(this.$container,this):this.audioEngine=new y(this.$container,this),this.loadTracksData([{url:this.params.url}])},applyPlayerStyle:function(t){this.$el&&(this.$el.toggleClass("no-artwork",!t.artwork),this.$el.toggleClass("no-info",!t.info),this.$el.toggleClass("no-transitions",d.a.isOn(this.viewport,this.viewportWidth,this.viewerOptions)),this.$(".sc-info").css("color",t.artwork?"#fff":"#"+t.color),this.$(".sc-left").css("color","#"+t.color),this.$(".sc-button svg path").css("fill","#"+t.color))},tracksIsLoaded:function(t){if(this.tracks=null,this.audioEngine){var e=t.playerObj.tracks;if(!e.length)return this.$el.remove(),this.ready=!0,void this.readyCallback(this.parent);this.tracks=e,this.currentTrackNum=0,this.$el.removeClass("loading"),this.audioEngine.on("scPlayer:onAudioReady",this.onAudioReady).on("scPlayer:onMediaPlay",this.onMediaPlay).on("scPlayer:onMediaPause",this.onMediaPause).on("scPlayer:onMediaEnd",this.onMediaEnd).on("scPlayer:onMediaBuffering",this.onMediaBuffering),this.$elements={},this.$elements.scrubber=this.$(".sc-scrubber"),this.$elements.play_button=Object(n.a)(this.$(".sc-button")),this.$elements.play_wrapper=this.$(".sc-button-wrapper"),this.$elements.buffer=this.$(".sc-buffer"),this.$elements.played=this.$(".sc-played"),this.$elements.time=this.$(".sc-left");var i=this.updateTrackInfo(this.currentTrackNum);if(this.$elements.play_button.on("click",this.onPlayClick),p.a.isDesktop&&(this.$elements.scrubber.on("mousemove",this.onScrubberMouseMove),this.$elements.scrubber.on("click",this.onScrubberClick)),this.$(".sc-artwork-list").on("click",this.onPlayClick),p.a.isDesktop&&this.$elements.play_button.RMDrag({move:this.moveHandleDrag,end:this.endHandleDrag,silent:!1,preventDefault:!0}),RM.screenshot)var o=Object(n.a)("<img/>").load(r.a.bind((function(){setTimeout(r.a.bind((function(){this.ready=!0,!this.isDestroyed&&this.readyCallback(this.parent),o.remove()}),this),100)}),this)).attr("src",i);else this.ready=!0,this.readyCallback(this.parent)}},moveHandleDrag:function(t){this.playing&&this.pause(),this.isDragging=!0,this.$el.addClass("dragging"),this.scrub(t.pageX)},endHandleDrag:function(t){t.moved&&this.play(),this.$el.removeClass("dragging"),setTimeout(r.a.bind((function(){this.isDragging=!1}),this),0)},onScrubberMouseMove:function(t){var e=Object(n.a)(t.currentTarget),i=e.find(".sc-hover-indicator"),o=d.a.getNormalizedBox(e.get(0),this.viewport,this.viewportWidth,this.viewerOptions),a=t.pageX-o.left;i.css("left",a/d.a.getRatio(this.viewportWidth)+"px")},onScrubberClick:function(t){return this.playing||this.play(),this.scrub(t.pageX),!1},onPlayClick:function(t){if(!this.isDragging)return this.playing?this.pause():this.play(),t.stopPropagation(),!1},onAudioReady:function(){this.audioEngine&&this.audioEngine.play(),this.audioEngine&&this.audioEngine.setVolume(100)},onMediaPlay:function(){this.$el.addClass("playing"),this.playing=!0,clearInterval(this.positionPoll),this.positionPoll=setInterval(this.updatePlayState,500)},onMediaPause:function(){this.$el.removeClass("playing"),this.playing=!1,clearInterval(this.positionPoll),this.positionPoll=null},onMediaEnd:function(){this.$elements.played.css("width","0%"),this.$elements.play_button.css("left","0%"),this.$el.removeClass("playing"),this.playing=!1,this.audioEngine&&this.audioEngine.stop();var t=(this.currentTrackNum+1)%this.tracks.length;this.play(t),0==t&&(this.pause(),this.updateTrackInfo(0))},onMediaBuffering:function(t){this.$elements.buffer.css("width",t+"%")},play:function(t){if(this.tracks&&(null==t&&(t=this.currentTrackNum),this.audioEngine&&(!this.playing||t!=this.currentTrackNum))){var e=this.tracks[t];this.$el.addClass("playing"),this.playing=!0,t==this.currentTrackNum&&this.audioEngine.firstLoad?this.audioEngine&&this.audioEngine.play():(this.updateTrackInfo(t),this.currentTrackNum=t,this.audioEngine&&this.audioEngine.load(e,this.apiKey))}},pause:function(){this.audioEngine&&this.playing&&(this.$el.removeClass("playing"),this.playing=!1,this.audioEngine&&this.audioEngine.pause())},scrub:function(t){if(this.audioEngine){var e=d.a.getNormalizedBox(this.$elements.play_wrapper.get(0),this.viewport,this.viewportWidth,this.viewerOptions),i=d.a.getNormalizedBox(this.$elements.play_button.get(0),this.viewport,this.viewportWidth,this.viewerOptions),n=(t-e.left-i.width/2)/e.width;n=Math.min(Math.max(Math.min(n,.999),0),this.$elements.buffer.width()/this.$elements.scrubber.width()),this.$elements.play_button.css("left",Math.floor(this.$elements.play_wrapper.width()*n)+"px"),this.audioEngine&&this.audioEngine.seek(n)}},updatePlayState:function(){if(this.audioEngine){var t=this.audioEngine.getDuration(),e=this.audioEngine.getPosition(),i=e/t;this.$elements.played.css("width",100*i+"%"),this.$elements.play_button.css("left",Math.floor(this.$elements.play_wrapper.width()*i)+"px"),t&&this.$elements.time.html(this.timecode(t-e))}},updateTrackInfo:function(t){if(this.tracks){var e,i=this.tracks[t];this.$(".sc-info h3").html('<a target="_blank" href="'+i.permalink_url+'">'+i.title+"</a>"),this.$(".sc-info h4").html('by <a target="_blank" href="'+i.user.permalink_url+'">'+i.user.username+"</a>"),e=i.artwork_url?i.artwork_url.replace("-large","-t300x300"):i.user&&i.user.avatar_url?i.user.avatar_url.replace("-large","-t300x300"):this.defaultCover,this.$(".sc-artwork-list .sc-loaded-artwork").css("background-image",'url("'+e+'")'),this.$elements.time.html(this.timecode(i.duration));var n=(t+1)%this.tracks.length,o=(t-1+this.tracks.length)%this.tracks.length,a=this.tracks[n],r=this.tracks[o];return!a.preload&&a.artwork_url&&(a.preload=new Image,a.preload.src=a.artwork_url.replace("-large","-t300x300")),!r.preload&&r.artwork_url&&(r.preload=new Image,r.preload.src=r.artwork_url.replace("-large","-t300x300")),e}},loadTracksData:function(t){var e=0,i={tracks:[]},o=this;!function a(r){if(!o.isDestroyed){var s=o.scApiUrl(r.url);fetch(s).then((function(t){return t.json()})).then((function(l){o.isDestroyed||(e+=1,l.tracks?i.tracks=i.tracks.concat(l.tracks):l.duration?(l.permalink_url=r.url,i.tracks.push(l)):l.creator?t.push({url:l.uri+"/tracks"}):l.username?/favorites/.test(r.url)?t.push({url:l.uri+"/favorites"}):t.push({url:l.uri+"/tracks"}):n.a.isArray(l)&&(i.tracks=i.tracks.concat(l)),t[e]?a(t[e]):o.tracksIsLoaded({playerObj:i,url:s}))})).catch((function(){!o.isDestroyed&&o.readyCallback(o.parent)}))}}(t[e])},scApiUrl:function(t){var e="https:"===document.location.protocol,i=(e||/^https/i.test(t)?"https":"http")+"://api.soundcloud.com/resolve?url=",n="format=json&client_id="+this.apiKey;return e&&(t=t.replace(/^http:/,"https:")),/api\./.test(t)?t+"?"+n:i+t+"&"+n},html5AudioAvailable:function(){var t=!1;try{var e=new Audio;t=e.canPlayType&&/maybe|probably/.test(e.canPlayType("audio/mpeg"))}catch(t){}return t},timecode:function(t){var e={h:Math.floor(t/36e5),m:Math.floor(t/6e4%60),s:Math.floor(t/1e3%60)},i=[];return e.h>0&&i.push(e.h),i.push(e.m<10&&e.h>0?"0"+e.m:e.m),i.push(e.s<10?"0"+e.s:e.s),i.join(":")},show:function(){this.$el&&this.$el.css("opacity",1)},destroy:function(){this.pause(),this.audioEngine&&this.audioEngine.off(),this.audioEngine&&this.audioEngine.destroy(),this.audioEngine=null,this.$el&&this.$el.remove()}}),b=a.a.View.extend({initialize:function(t,e){r.a.bindAll(this),this.inner_template=u.a["template-common-audio-player-engine-html5"],this.parent=e,this.$container=t,this.firstLoad=!1;var i=this;this.callbacks={onReady:function(){i.player&&i.trigger("scPlayer:onAudioReady")},onPlay:function(){i.player&&i.trigger("scPlayer:onMediaPlay")},onPause:function(){i.player&&i.trigger("scPlayer:onMediaPause")},onEnd:function(){i.player&&i.trigger("scPlayer:onMediaEnd")},onBuffer:function(t){i.player&&i.trigger("scPlayer:onMediaBuffering",t)}},this.render()},render:function(){this.setElement(Object(n.a)(this.inner_template({}))),this.$container.append(this.$el),this.player=this.$el.find("audio")[0],this.player.addEventListener("play",this.callbacks.onPlay,!1),this.player.addEventListener("pause",this.callbacks.onPause,!1),this.player.addEventListener("timeupdate",this.onTimeUpdate,!1),this.player.addEventListener("progress",this.onProgress,!1)},onTimeUpdate:function(t){if(this.player){var e=(this.player.buffered.length&&this.player.buffered.end(0))/this.player.duration*100;this.callbacks.onBuffer(e),this.player.currentTime===this.player.duration&&this.callbacks.onEnd()}},onProgress:function(t){if(this.player){var e=(this.player.buffered.length&&this.player.buffered.end(0))/this.player.duration*100;this.callbacks.onBuffer(e)}},load:function(t,e){this.player&&(this.firstLoad=!0,this.player.pause(),this.player.src=t.stream_url+(/\?/.test(t.stream_url)?"&":"?")+"client_id="+e,this.player.load(),this.player.play())},play:function(){this.player&&this.player.play()},pause:function(){this.player&&this.player.pause()},stop:function(){this.player&&this.player.currentTime&&(this.player.currentTime=0,this.player.pause())},seek:function(t){if(this.player&&this.player.src)try{this.player.currentTime=this.player.duration*t}catch(t){}},getDuration:function(){return this.player?1e3*this.player.duration:0},getPosition:function(){return this.player?1e3*this.player.currentTime:0},setVolume:function(t){this.player&&(this.player.volume=t/100)},destroy:function(){this.$el.remove(),this.player=null}}),y=a.a.View.extend({initialize:function(t,e){r.a.bindAll(this),this.inner_template_flash=u.a["template-common-audio-player-engine-flash"],this.inner_template_flash_ie=u.a["template-common-audio-player-engine-flash-ie"],this.parent=e,this.$container=t,this.firstLoad=!1;var i=this;this.callbacks={onReady:function(){i.player&&i.trigger("scPlayer:onAudioReady")},onPlay:function(){i.player&&i.trigger("scPlayer:onMediaPlay")},onPause:function(){i.player&&i.trigger("scPlayer:onMediaPause")},onEnd:function(){i.player&&i.trigger("scPlayer:onMediaEnd")},onBuffer:function(t){i.player&&i.trigger("scPlayer:onMediaBuffering",t)}}},render:function(t){var e="soundcloud_"+this.parent.parent.params._id,i=("https:"===document.location.protocol?"https":"http")+"://player.soundcloud.com/player.swf?url="+t+"&amp;enable_api=true&amp;player_type=engine&amp;object_id="+e;Modernizr.msie?this.setElement(Object(n.a)(this.inner_template_flash_ie({id:e,swf:i}))):this.setElement(Object(n.a)(this.inner_template_flash({id:e,swf:i}))),this.$container.append(this.$el),this.$el.find("object").on("soundcloud:onPlayerReady",r.a.bind((function(t,i){this.player=l.getPlayer(e),this.callbacks.onReady()}),this)).on("soundcloud:onMediaBuffering",r.a.bind((function(t,e){this.callbacks.onBuffer(e.percent)}),this)).on("soundcloud:onMediaEnd",this.callbacks.onEnd).on("soundcloud:onMediaPlay",this.callbacks.onPlay).on("soundcloud:onMediaPause",this.callbacks.onPause)},load:function(t){this.firstLoad?this.player&&this.player.api_load(t.uri):(this.firstLoad=!0,this.render(t.uri))},play:function(){this.player&&this.firstLoad&&this.player.api_play()},pause:function(){this.player&&this.firstLoad&&this.player.api_pause()},stop:function(){this.player&&this.firstLoad&&this.player.api_stop()},seek:function(t){this.player&&this.firstLoad&&this.player.api_seekTo(this.player.api_getTrackDuration()*t)},getDuration:function(){return this.player&&this.firstLoad&&this.player.api_getTrackDuration&&1e3*this.player.api_getTrackDuration()},getPosition:function(){return this.player&&this.firstLoad&&this.player.api_getTrackPosition&&1e3*this.player.api_getTrackPosition()},setVolume:function(t){this.player&&this.player.api_setVolume&&this.player.api_setVolume(t)},destroy:function(){this.player=null,this.$el&&this.$el.remove()}});e.a=g},i0ke:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("v83y"),o=i("uU7u"),a=i("KiUg"),r=i("zZDe"),s=new n.CompositeDecorator([o.e,a.c,a.a,r.a])},ibKe:function(module,exports){module.exports={"template-constructor-control-button_edit":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="icon noarrow" data-alt="Edit Text" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel"></div>\n\n';return __p}}},"j/3K":function(t,e,i){},j0jp:function(module,exports){module.exports={"template-constructor-control-common_animation":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Animation" data-alt-pos="left" data-alt-offset="9" data-name="animation-control-icon"></div>\n\n\t<div class="panel" data-name="animation-panel">\n\t\t<div class="panel-caption">Animation</div>\n\n\t\t<div class="mixed-types">\n\t\t\t<div class="message-text">Nope, you can’t mix fixed, full width, full height, sticky and normal widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-fixeds">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple fixed widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-stickeds">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple sticky widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-fullwidths">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple full width widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="multiple-fullheights">\n\t\t\t<div class="message-text">Nope, you can’t animate multiple full height widgets at a time.</div>\n\t\t</div>\n\n\t\t<div class="non-animatable">\n\t\t\t<div class="message-text">Nope, you can’t animate Facebook or Twitter widgets.</div>\n\t\t</div>\n\n\t\t<div class="multiple-animations">\n\t\t\t<div class="message-text">There’re different animations in this selection. Merge them?</div>\n\t\t\t<div class="unite-button">Yes</div>\n\t\t</div>\n\n\t\t<div class="requires-trigger">\n\t\t\t<div class="message-text">A video widget can be&nbsp;animated on&nbsp;click only with&nbsp;another widget as&nbsp;a&nbsp;trigger.</div>\n\t\t</div>\n\n\t\t<div class="cannot-use-with-picture-preview">\n\t\t\t<div class="message-text">Oops, you can’t currently add this animation since Lightbox is enabled</div>\n\t\t</div>\n\n\t\t<div class="top-block js-top-block">\n\t\t\t'+(null==(__t=renderInitialTypePopup())?"":__t)+'\n\t\t</div>\n\n\t\t<div class="step-selector js-step-selector">\n\t\t\t<div class="prev-step js-prev-step"></div>\n\t\t\t<div class="step-caption js-step-caption"></div>\n\t\t\t<div class="next-step js-next-step"></div>\n\n\t\t\t<div class="step-popup js-step-popup">\n\t\t\t\t<div class="step-popup-content js-step-popup-content"></div>\n\t\t\t\t<div class="corner-wrapper">\n\t\t\t\t\t<div class="corner"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="resizable-scroll-wrapper">\n\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t<div class="resizable-content">\n\n\t\t\t\t\t<div class="effects-presets-wrapper">\n\t\t\t\t\t\t<div class="effects-caption">Choose Effect</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_move">Move</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_opacity">Opacity</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_rotate">Rotate</div>\n\t\t\t\t\t\t<div class="effects-item" data-value="use_scale">Scale</div>\n\n\t\t\t\t\t\t<div class="presets-caption">Presets</div>\n\t\t\t\t\t\t<div class="presets-item" data-value="fade-and-scale">Fade&Scale<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="fade-in">Fade In<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="scale-big">Scale Big<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="move-and-fade">Move&Fade<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="pulse">Pulse<div class="preview"></div></div>\n\t\t\t\t\t\t<div class="presets-item" data-value="rotate">Rotate<div class="preview"></div></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="resizable-scroll"></div>\n\t\t</div>\n\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\n\n\t\t<div class="bottom-block">\n\t\t\t<div class="add-effect">\n\t\t\t\t<span>Add Effect</span>\n\t\t\t\t<div class="effect-popup">\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_move">Move</div>\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_opacity">Opacity</div>\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_rotate">Rotate</div>\n\t\t\t\t\t<div class="effect-popup-item" data-value="use_scale">Scale</div>\n\t\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="loop-types js-loop-types">\n\t\t\t\t<div class="loop-type loop-type-swing js-loop-swing" data-value="swing" data-alt="Reverse">\n\t\t\t\t\t<svg class="loop-type-swing-icon" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M23 4H7V1.124A1 1 0 005.309.401L1.257 4.277a1 1 0 000 1.446L5.31 9.599A1 1 0 007 8.876V6h16v2.876a1 1 0 001.691.723l4.052-3.876a1 1 0 000-1.446L24.69.401A1 1 0 0023 1.124V4z" fill="currentColor" fill-rule="nonzero"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t\tLoop\n\t\t\t\t<div class="loop-type loop-type-repeat js-loop-repeat" data-value="repeat" data-alt="Cycle">\n\t\t\t\t\t<svg class="loop-type-repeat-icon" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M12 6v2.876a1 1 0 001.691.723l4.052-3.876a1 1 0 000-1.446L13.69.401A1 1 0 0012 1.124V4H5a5 5 0 00-.217 9.995L5 14h18a5 5 0 00.217-9.995L23 4h-3a1 1 0 00-.117 1.993L20 6h3a3 3 0 01.176 5.995L23 12H5a3 3 0 01-.176-5.995L5 6h7z" fill="currentColor" fill-rule="nonzero"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</div>\n            <div class="display-types js-display-types">\n                <div class="display-type-reset js-display-type-reset" data-value="reset">\n                    <svg class="display-type-reset-icon" xmlns="http://www.w3.org/2000/svg">\n                        <path\n                            d="M4.484 2.821L2.482.82a1 1 0 00-1.705.63l-.45 5.862A1 1 0 001.4 8.385l5.862-.45a1 1 0 00.63-1.705L5.899 4.237l.027-.026a7 7 0 019.71 10.082 1 1 0 001.414 1.414A9 9 0 004.484 2.821z"\n                            fill="currentColor" fill-rule="nonzero"/>\n                    </svg>\n                </div>\n                Display\n                <div class="display-type-once js-display-type-once" data-value="once">\n                    <svg class="display-type-once-icon" xmlns="http://www.w3.org/2000/svg">\n                        <path\n                            d="M13.364 14.293a1 1 0 01-1.414 1.414 7 7 0 00-9.9 0 1 1 0 11-1.414-1.414 9 9 0 0112.728 0zM7 0a5 5 0 110 10A5 5 0 017 0zm0 2a3 3 0 100 6 3 3 0 000-6z"\n                            fill="currentColor" fill-rule="nonzero"/>\n                    </svg>\n                </div>\n            </div>\n\n            <div class="start-condition js-start-when-in-view">Start when in view</div>\n\n\t\t\t<div class="preview">Preview</div>\n\t\t</div>\n\n\t\t<div class="animation-add js-add-animation">\n\t\t\tAdd\n\t\t\t'+(null==(__t=renderAddTypePopup())?"":__t)+"\n\t\t</div>\n\n\t</div>\n";return __p},"template-constructor-control-common_animation-trigger":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="trigger js-trigger-button" data-id="'+(null==(__t=id)?"":__t)+'">\n\t\t',"onOtherPage"===status?__p+='\n\t\t\t<div class="trigger-other-page">\n\t\t\t\t<div class="trigger-name js-trigger-name">\n\t\t\t\t\tTrigger on p. '+(null==(__t=pageNumber)?"":__t)+'\n\t\t\t\t</div>\n\t\t\t\t<svg class="trigger-remove-button js-remove-trigger" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M6 4.467l4.15-4.15a1.084 1.084 0 011.533 1.533L7.533 6l4.15 4.15a1.084 1.084 0 11-1.533 1.533L6 7.533l-4.15 4.15A1.084 1.084 0 01.317 10.15L4.467 6 .317 1.85A1.084 1.084 0 111.85.317L6 4.467z" fill-rule="evenodd"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t':"pending"===status?__p+='\n\t\t\t<div class="trigger-pending">\n\t\t\t\tChoose Trigger\n\t\t\t\t<svg class="trigger-remove-button js-cancel-trigger" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M6 4.467l4.15-4.15a1.084 1.084 0 011.533 1.533L7.533 6l4.15 4.15a1.084 1.084 0 11-1.533 1.533L6 7.533l-4.15 4.15A1.084 1.084 0 01.317 10.15L4.467 6 .317 1.85A1.084 1.084 0 111.85.317L6 4.467z" fill-rule="evenodd"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t':"active"===status?__p+='\n\t\t\t<div class="trigger-active js-trigger-active">\n\t\t\t\t<div class="trigger-name js-trigger-name">\n\t\t\t\t\t'+(null==(__t=isSelf?"Self":triggerBlockName||"Trigger")?"":__t)+'\n\t\t\t\t</div>\n\t\t\t\t<svg class="trigger-remove-button js-remove-trigger" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t<path d="M6 4.467l4.15-4.15a1.084 1.084 0 011.533 1.533L7.533 6l4.15 4.15a1.084 1.084 0 11-1.533 1.533L6 7.533l-4.15 4.15A1.084 1.084 0 01.317 10.15L4.467 6 .317 1.85A1.084 1.084 0 111.85.317L6 4.467z" fill-rule="evenodd"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t':__p+='\n\t\t\t<div class="trigger-none">\n\t\t\t\t<div class="trigger-none-caption">Add Trigger</div>\n\t\t\t\t<div class="trigger-arrow"></div>\n\t\t\t</div>\n\t\t',__p+="\n\t</div>\n";return __p},"template-constructor-control-common_animation-step":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="step">\n\n\t\t<div class="param-wrapper start-block">\n\t\t\t<div class="caption">Start Point</div>\n\t\t\t<div class="start-value">'+(null==(__t=start_point)?"":__t)+'</div>\n\t\t\t<div class="start-popup">\n\t\t\t\t<div class="start-popup-item" data-value="top">Top<div class="point"></div></div>\n\t\t\t\t<div class="start-popup-item" data-value="center">Center<div class="point"></div></div>\n\t\t\t\t<div class="start-popup-item" data-value="bottom">Bottom<div class="point"></div></div>\n\t\t\t\t<div class="start-popup-caption">Offset</div>\n\n\t\t\t\t<div class="input-wrapper">\n\t\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="start_offset" data-min="-9999" data-max="9999" data-mouseSpeed="1" type="text"/>\n\t\t\t\t\t<div class="units">px</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="start-preview">\n\t\t\t\t\t<div class="start-point"></div>\n\t\t\t\t\t<div class="start-dist"></div>\n\t\t\t\t\t<div class="start-offset"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper delay-block">\n\t\t\t<div class="bg"></div>\n\t\t\t<div class="caption">Delay</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">s</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="delay" data-min="0" data-max="99" data-useFloat="true" data-shiftStep="1" data-step="0.1" data-mouseSpeed="5" data-labelSelector="<.param-wrapper" type="text"/>\n\t\t\t\t<div class="units">s</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper duration-block">\n\t\t\t<div class="bg"></div>\n\t\t\t<div class="caption">Durat.</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">s</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="duration" data-min="0" data-max="99" data-useFloat="true" data-shiftStep="1" data-step="0.1" data-mouseSpeed="5" data-labelSelector="<.param-wrapper" type="text"/>\n\t\t\t\t<div class="units">s</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper delay_px-block">\n\t\t\t<div class="bg"></div>\n\t\t\t<div class="caption">Delay</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">px</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="delay_px" data-min="0" data-max="9999" data-mouseSpeed="1" data-labelSelector="<.param-wrapper" type="text"/>\n\t\t\t\t<div class="units">px</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper speed-block">\n\t\t\t<div class="caption">Speed</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<div class="units for-centering">×</div>\n\t\t\t\t<input class="numeric-input" spellcheck="false" data-param="speed"  data-min="0.01" data-floatDigits="2" data-max="999" data-useFloat="true" data-shiftStep="0.1" data-step="0.01" data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="units">×</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper move-block">\n\t\t\t<div class="remove-effect" data-value="use_move"></div>\n\t\t\t<div class="caption">Move</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="dx" data-min="-99999" data-max="99999" data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator move-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="dy" data-min="-99999" data-max="99999" data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper opacity-block">\n\t\t\t<div class="remove-effect" data-value="use_opacity"></div>\n\t\t\t<div class="caption">Opacity</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="from_opacity" data-min="0" data-max="100"  data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator from-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="opacity" data-min="0" data-max="100"  data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t\t',isSwitcherVisible&&(__p+='\n\t\t\t\t<div class="param-wrapper hide-in-editor-switcher-wrapper">\n\t\t\t\t\t<div class="caption">Hide in Editor</div>\n\t\t\t\t\t<div class="switcher hide-in-editor-switcher js-hide-in-editor-switcher"></div>\n\t\t\t\t</div>\n\t\t\t'),__p+='\n\t\t</div>\n\n\t\t<div class="param-wrapper rotate-block">\n\t\t\t<div class="remove-effect" data-value="use_rotate"></div>\n\t\t\t<div class="caption">Rotate</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="from_rotate" data-min="-9999" data-max="9999"  data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator from-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="rotate" data-min="-9999" data-max="9999"  data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper scale-block">\n\t\t\t<div class="remove-effect" data-value="use_scale"></div>\n\t\t\t<div class="caption">Scale</div>\n\t\t\t<div class="input-wrapper">\n\t\t\t\t<input class="numeric-input left-align" spellcheck="false" data-param="from_scale" data-min="0" data-max="9999" data-mouseSpeed="5" type="text"/>\n\t\t\t\t<div class="separator from-icon"></div>\n\t\t\t\t<input class="numeric-input right-align" spellcheck="false" data-param="scale" data-min="0" data-max="9999" data-mouseSpeed="5" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="param-wrapper acceleration-block">\n\t\t\t<div class="caption">Acceleration</div>\n\t\t\t<div class="acceleration-value">'+(null==(__t=acceleration)?"":__t)+'</div>\n\t\t\t<div class="acceleration-popup">\n\t\t\t\t<div class="acceleration-popup-preview"><div class="ball"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="none">None<div class="point"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="ease-in">Ease In<div class="point"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="ease-out">Ease Out<div class="point"></div></div>\n\t\t\t\t<div class="acceleration-popup-item" data-value="ease-both">Ease Both<div class="point"></div></div>\n\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-common_animation-step-popup-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="step-popup-item js-step-popup-item '+(null==(__t=isSelected?"selected":"")?"":__t)+" "+(null==(__t=isInLoop?"looped":"")?"":__t)+'" data-ind="'+(null==(__t=index)?"":__t)+'">'+(null==(__t=text)?"":__t)+"</div>\n";return __p},"template-constructor-control-common_animation-type-popup":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="type-popup '+(null==(__t=isInitial?"initial":"")?"":__t)+" "+(null==(__t=uuid?"":"new")?"":__t)+" "+(null==(__t=cssClass)?"":__t)+'">\n\t\t',isInitial&&(__p+='\n\t\t\t<div class="type-popup-header">Animate</div>\n\t\t'),__p+='\n\t\t<div class="type-popup-content">\n\t\t\t',uuid&&(__p+='\n\t\t\t\t<div class="type-popup-item js-type-popup-item none" data-value="none" data-uuid="'+(null==(__t=uuid)?"":__t)+'">\n\t\t\t\t\t<div class="type-popup-text">none</div>\n\t\t\t\t</div>\n\t\t\t'),__p+="\n\t\t\t",_.each(availableTypes,(function(t){__p+="\n\t\t\t\t",(uuid||t!==currentType)&&(__p+='\n\t\t\t\t\t<div class="type-popup-item js-type-popup-item '+(null==(__t=t===currentType?"current":"")?"":__t)+'" data-value="'+(null==(__t=t)?"":__t)+'" data-uuid="'+(null==(__t=uuid)?"":__t)+'">\n\t\t\t\t\t\t',!isInitial&&uuid||(__p+='\n\t\t\t\t\t\t\t<div class="type-popup-prefix">'+(null==(__t=isInitial?"on":uuid?"":"Add")?"":__t)+"</div>\n\t\t\t\t\t\t"),__p+='\n\t\t\t\t\t\t<div class="type-popup-text">'+(null==(__t=t)?"":__t)+"</div>\n\t\t\t\t\t</div>\n\t\t\t\t"),__p+="\n\t\t\t"})),__p+="\n\t\t</div>\n\t</div>\n";return __p},"template-constructor-control-common_animation-type":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="animation-type js-animation-type '+(null==(__t=animation.UUID===currentUuid?"current":"")?"":__t)+" "+(null==(__t="none"===animation.type?"none":"")?"":__t)+" "+(null==(__t=allowTriggers(animation)||"none"===animation.type?"has-extra":"")?"":__t)+" "+(null==(__t=0===index?"first":index===total-1?"last":"")?"":__t)+'" data-type="'+(null==(__t=animation.type)?"":__t)+'">\n\t\t<div class="animation-type-header">\n\t\t\t<div class="animation-type-caption '+(null==(__t=animation.UUID===currentUuid?"js-change-type":"js-change-animation")?"":__t)+'" data-uuid="'+(null==(__t=animation.UUID)?"":__t)+'">\n\t\t\t\t<div class="animation-type-text">\n\t\t\t\t\t'+(null==(__t=animation.type)?"":__t)+"\n\t\t\t\t</div>\n\t\t\t\t",animation.UUID===currentUuid&&(__p+='\n\t\t\t\t\t<svg class="animation-type-dropdown-arrow" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t<path d="M3.206 5.46L.257 1.609A1 1 0 011.051 0H6.95a1 1 0 01.794 1.608L4.794 5.46a1 1 0 01-1.588 0z" fill-rule="evenodd"/>\n\t\t\t\t\t</svg>\n\t\t\t\t'),__p+="\n\t\t\t</div>\n\n\t\t\t","none"===animation.type&&animation.UUID===currentUuid&&(__p+='\n\t\t\t\t<div class="animation-none-controls">\n\t\t\t\t\t<div class="animation-remove js-remove-animation" data-uuid="'+(null==(__t=animation.UUID)?"":__t)+'">Delete</div>\n\t\t\t\t</div>\n\t\t\t'),__p+="\n\t\t\t",animation.UUID===currentUuid&&(__p+="\n\t\t\t\t"+(null==(__t=renderTypePopup({type:animation.type,isInitial:!1,uuid:animation.UUID,cssClass:"js-change-type-popup"}))?"":__t)+"\n\t\t\t"),__p+="\n\t\t</div>\n\t\t",animation.UUID===currentUuid&&allowTriggers(animation)&&(__p+='\n\t\t\t<div class="trigger-buttons-container js-trigger-buttons-container"></div>\n\t\t'),__p+="\n\t</div>\n";return __p}}},"j6/F":function(module,exports){module.exports={"template-constructor-control-common_align":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon" data-alt="Align" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t\t<div class="bottom" title="Align Bottom Edges"></div>\n\t\t<div class="middle" title="Align Vertical Centers"></div>\n\t\t<div class="top" title="Align Top Edges"></div>\n\t\t<div class="left" title="Align Left Edges"></div>\n\t\t<div class="center" title="Align Horizontal Centers"></div>\n\t\t<div class="right" title="Align Right Edges"></div>\n\t</div>\n';return __p}}},jIIB:function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("za5s"),l=i("wEEd");function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return h(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function u(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var p=Object(n.e)(l.a.div).withConfig({displayName:"Notice___StyledAnimatedDiv"})(["display:flex;"]),m=Object(n.e)(r.B).withConfig({displayName:"Notice___StyledFlex"})(["position:relative;left:56px;white-space:nowrap;backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);"]),g=Object(n.e)(r.ub).withConfig({displayName:"Notice___StyledStyledLink"})(["&:hover{color:",";}"],(function(t){return t._css})),f=Object(n.e)(r.n).withConfig({displayName:"Notice___StyledButton"})(["box-sizing:content-box;&:hover{background:rgba(40,40,40,0.4);}"]),v=Object(n.e)(r.B).withConfig({displayName:"Notice___StyledFlex2"})(["backdrop-filter:blur(3px);-webkit-backdrop-filter:blur(3px);"]),b=Object(n.e)(r.m).withConfig({displayName:"Notice___StyledBox"})(["white-space:nowrap;display:flex;"]),y=Object(n.e)(r.n).withConfig({displayName:"Notice___StyledButton2"})(["align-self:center;"]),_=Object(n.e)(r.n).withConfig({displayName:"Notice___StyledButton3"})(["box-sizing:content-box;&:hover{background:#ec520b;}"]);e.a=function(t){var e=t.message,i=t.closeBtn,n=void 0!==i&&i,h=t.helpBtn,w=void 0===h||h,k=t.isTip,S=void 0===k||k,x=t.moreLink,C=void 0===x?"":x,O=t.visible,j=t.onClose,P=t.onSettingsClick,E=u(t,["message","closeBtn","helpBtn","isTip","moreLink","visible","onClose","onSettingsClick"]),I=d(Object(o.useState)(!1),2),T=I[0],M=I[1],$=Object(l.d)(e,null,{from:{transform:"translate3d(0,100%,0)"},enter:{transform:"translate3d(0,0%,0)"},leave:{opacity:0,position:"absolute"}});return a.a.createElement(a.a.Fragment,null,S?a.a.createElement(a.a.Fragment,null,$.map((function(t){var i=t.item,o=t.key,l=t.props;return i&&a.a.createElement(p,{key:o,style:l},a.a.createElement(m,c({lineHeight:"1.5",bg:"orange",p:"0 72px 0 20px",alignItems:"center",opacity:.9,zIndex:-1},E,{borderRadius:"m"}),a.a.createElement(r.Cb,{color:"black",textStyle:"small"},e)," ",C&&a.a.createElement(g,{as:"a",color:"white",href:C,target:"_blank",textStyle:"small",_css:Object(s.themeGet)("colors.black")},"More...")),n&&a.a.createElement(f,{onClick:j,width:56,height:56,borderRadius:"m",bg:"black"},a.a.createElement(r.Cb,{textStyle:"small",color:"white",textAlign:"center"},"OK")),w&&a.a.createElement(v,{onClick:P,width:56,height:56,borderRadius:"m",bg:"lightGray",alignItems:"center",opacity:.9,justifyContent:"center",cursor:"pointer",onMouseEnter:function(){return M(!0)},onMouseLeave:function(){return M(!1)}},a.a.createElement(r.lb,{color:T?"black":"darkGray"})))}))):a.a.createElement(a.a.Fragment,null,O&&a.a.createElement(b,c({lineHeight:"1.5",bg:"lightGray",color:"tomato",p:"16px 24px",borderRadius:"m"},E),e,w&&a.a.createElement(y,{display:"flex",onClick:P,width:16,height:16,ml:"20px"},"‎",a.a.createElement(r.lb,{color:"gray"})),n&&a.a.createElement(_,{variant:"unstyled",background:"gray",onClick:j,width:12,height:12,p:"6px",ml:"12px",borderRadius:"l",color:"white"},a.a.createElement(r.w,{color:"white"})))))}},jamO:function(t,e,i){"use strict";i.d(e,"a",(function(){return _})),i.d(e,"b",(function(){return w}));var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("jeLO"),l=i("Fi5S"),c=i("mT3t"),d=i("tf3M"),h=i("v92f"),u=i("OTSC"),p=i("DqjY"),m=i("onY4"),g=i("sviH"),f=i("I0kf");function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var b=s.a.extend({sync:function(){return{error:n.a.noop,success:n.a.noop}},idAttribute:"_id",skipMagChanging:!0,fakeSave:!0,isNew:function(){return!1},getPageId:function(){return this.page.id},parse:function(t){return t.page&&(this.page=t.page,delete t.page),t}}),y=s.a.extend({idAttribute:"_id",urlRoot:"/api/page/",undoKeys:["wids","order"],mergeUndoSteps:!1,name:"Page",initialize:function(t,e){r.a.bindAll(this),e=e||{},this.loaded=!0,this._saveQueue=[],this._saveInProgress=!1,this.trigger("loaded"),this.on("change:wids",this.onChange),this.widgets=this.widgets||new d.WidgetsCollection([],{page:this}),this.widgets.on("change",this.setEdited,this),this.on("change:wids",this.setEdited,this),this.viewportStub=new b({viewport:"default",page:this,_id:this.id+"_viewport"},{parse:!0}),this.viewportStub.on("change:viewport",(function(t,e,i){i&&(i.undo||i.redo)&&(this.get("viewport_"+e)&&this.get("viewport_"+e).enabled||this.save("viewport_"+e,{enabled:!0},{patch:!0}),this.workspace.setViewport(e,i))}),this),this.on("change:viewport",(function(t,e,i){i&&(i.undo||i.redo)||this.viewportStub.save({viewport:this.get("viewport")})}),this),l.a.trigger("ready:model",this.viewportStub),l.a.trigger("ready:model",this)},sync:function(t,e,i){var n=(i=i||{}).success;return i.success=function(t){e.previousAttributes();e.changed.wids&&(t.wids=r.a.union(e.get("wids"),t.wids)),n&&n.apply(this,arguments)},c.a.prototype.sync.apply(this,arguments)},save:function(t,e,i){var n,o,a=this;if(!Object(f.a)("constructor.zIndex"))return s.a.prototype.save.apply(this,arguments);if(null==t||"object"===v(t)?(n=t,i=e):(n={})[t]=e,this._saveInProgress){this.set(n,i);var r={attrs:n,options:i,fakeXhr:{abort:function(){var t=a._saveQueue.indexOf(r);-1!==t&&a._saveQueue.splice(t,1)}}};return this._saveQueue.push(r),r.fakeXhr}this._saveInProgress=!0,o=s.a.prototype.save.call(this,n,i);var l=function(){if(a._saveInProgress=!1,a._saveQueue.length){var t=a._saveQueue.shift(),e=a.save(t.attrs,t.options);t.fakeXhr.abort=function(){return e.abort()}}};return o?o.always((function(){l()})):l(),o},parse:function(t,e){e&&(e.undo||e.redo)&&(t.num=this.get("num"));var i=r.a.clone(t),n=i.widgets||i.wids||[];return e=e||{},n=this.sanitizeWidgets(n),r.a.isEmpty(n)||(this.widgets=this.widgets||new d.WidgetsCollection([],{page:this}),this.widgets.reset(n,{page:this,parse:e.parse}),i.wids=r.a.pluck(n,"_id"),this.checkEmpty()),delete i.widgets,s.a.prototype.parse.call(this,i,e)},setEdited:function(t,e){this.isEmptyPage=!1},checkEmpty:function(){return!(this.widgets.length>1)&&(!!this.widgets.length&&("background"==this.widgets.at(0).get("type")&&("ffffff"==this.widgets.at(0).get("color")&&void 0===this.widgets.at(0).get("selectedType")&&(this.isEmptyPage=!0,!0))))},toJSON:function(){var t=s.a.prototype.toJSON.apply(this,arguments);return delete t.viewport,t},addWidget:function(t,e){var i;if(e=e||{},t instanceof d.default)i=t,this.widgets.add(i);else{if(!t||!t.type)return void console.error("Adding widget with no type");if(!g.a[t.type])return void console.error("Adding unknown widget");t.pid=this.id;var n=this.getCurrentViewport();if("default"!=n&&(t.hidden=!0),r.a.each(h.b.viewport_list,(function(e){t[e]&&-1==e.indexOf(n)&&"default"!=n&&(t[e].hidden=!0)})),"gmaps"===t.type){var o=this.workspace&&this.workspace.mag&&this.workspace.mag.get("opts");o&&o.gmaps_key&&(t.api_key=o.gmaps_key)}i=this.widgets.add(t)}if(i.id)e.nosave?this.getAddCallback(e)(i):i.fetch({success:this.getAddCallback(e),error:e.error});else{i.created=!e.copy&&!e.clone;"default"!=this.getCurrentViewport()&&(i.initViewport(e),i["viewport_"+this.getCurrentViewport()].hidden=!1),i.save({},{success:this.getAddCallback(e),error:e.error,clone:e.clone})}},onAdd:function(t,e){if(!t.get("type"))return!1;var i;Object(f.a)("constructor.zIndex")&&RM.constructorRouter.indexController.updateIndex(this,[t],!1);var n,o=this;return(i=r.a.clone(this.get("wids"))).push(t.id),i=Object(r.a)(i).chain().uniq().compact().value(),e&&(e.group||e.nosave)?this.set({wids:i},{copy:e.copy,silent:!!e.silent,isMultiple:e.isMultiple}):n=new Promise((function(t,e){o.save({wids:i},{success:t,error:e})})),!e.silent&&t.is_global&&t.triggerGlobalAppear(),this.sendAnalyticsEvent("Create Widget",{_widget_type:t.get("type"),label:t.get("type")}),n},getAddCallback:function(t){t=t||{};var e=this;return function(i){var n=e.onAdd(i,t);n instanceof Promise?(n.then((function(){if(Object(f.a)("constructor.zIndex"))return RM.constructorRouter.indexController.saveAffectedPages()})),n.finally((function(){t.success&&t.success(i,t)}))):t.success&&t.success(i,t)}},onChange:function(t,e,i){var n=t.changedAttributes().wids,o=t.previous("wids")||[];if(n){var a=r.a.difference(n,o),s=r.a.difference(o,n);r.a.each(a,(function(e){var n=t.widgets.get(e);i.is_new_global=n.isGlobal(),i.isMultiple=a.length>1||i.isMultiple,n&&this.trigger("widget:create",n,i),r.a.defer(function(){n&&n.isGlobal()&&n.get("pid")==this.id&&n.triggerGlobalAppear()}.bind(this))}),this),r.a.each(s,(function(e){var n=t.widgets.get(e);n&&this.trigger("widget:remove",n,i),r.a.defer(function(){n&&n.isGlobal()&&n.get("pid")==this.id&&n.triggerGlobalDisappear()}.bind(this))}),this)}},duplicate:function(t,e){var i=this,o=[];RM.constructorRouter.mag.globalWidgets.each((function(t){o.push(t.get("_id"))})),n.a.ajax({url:this.urlRoot+"duplicate/",type:"POST",dataType:"json",data:{_id:this.get("_id"),num:e&&e.num?e.num:parseInt(this.get("num"),10)+1,mid:this.get("mid"),globalWidgets:o},success:function(e){var o=e.page;e.widgets&&r.a.each(e.widgets,(function(t){var e=RM.constructorRouter.mag.globalWidgets.find({_id:t._id}),i=e.collection.page.getCurrentViewport();e.storeViewport(i),e.restoreViewport("default"),r.a.each(h.b.viewports,(function(i){"default"!==i.name?r.a.isEmpty(t["viewport_"+i.name])||r.a.isEmpty(e["viewport_"+i.name])||r.a.extend(e["viewport_"+i.name],t["viewport_"+i.name]):e.set(JSON.parse(JSON.stringify(t)))})),e.storeViewport("default"),e.restoreViewport(i),r.a.each(h.b.viewports,(function(i){if("default"===i.name)return e.restoreViewport("default"),e.set(JSON.parse(JSON.stringify(t))),void e.storeViewport("default");r.a.isEmpty(t["viewport_"+i.name])||(e.restoreViewport(i.name),e.set(JSON.parse(JSON.stringify(t["viewport_"+i.name]))),e.storeViewport(i.name))})),e.restoreViewport(i),e.save({},{silent:!0,skipHistory:!0})})),n.a.get("/api/pageFullById/"+o._id,function(e){var o=new y(e,{parse:!0});o.set("screenshot",i.get("screenshot")),this.sendAnalyticsEvent("Create Page",{_page_type:"duplicate",label:"Duplicate"}),n.a.ajax({method:"get",url:"/api/packs/"+RM.constructorRouter.mag.get("_id"),success:function(e){RM.constructorRouter.mag.set("packs",e),t&&t(o)},error:function(){t&&t(o)}})}.bind(this)).fail((function(e,i){alert(i.responseText),t(new Error("Сould not get page data"))}))},error:function(e){try{var i=JSON.parse(e.responseText);t(new Error("Server error: ".concat(i&&i.err?i.err:"unknown")))}catch(i){t(new Error("Server error: could not parse it")),alert(e.responseText)}},context:this})},sendAnalyticsEvent:function(t,e){var i=RM.constructorRouter||RM.collectorRouter||RM.viewerRouter||RM.homepageRouter;i&&i.analytics&&i.analytics.sendEvent(t,e)},getEffectiveHeight:function(){var t=this.getCurrentViewportSetting("min_height");return Math.round(this.widgets.reduce((function(t,e){return"background"==e.get("type")?t:Math.max((e.get("y")||0)+(e.get("h")||0),t)}),t))},getWidgetsQuantity:function(){return this.get("wids").length},removeWidgets:function(t,e){if(e=e||{},!r.a.isEmpty(t))if("default"==(e.viewport||this.getCurrentViewport())||e.forceRemove){this.trigger("widgets:remove",t,e);var i=r.a.difference(this.get("wids"),t);e.nosave?this.set({wids:i},{silent:!!e.silent}):this.save({wids:i})}else this.trigger("toggleWidgets",{wids:t,hidden:!0})},validate:function(t){if(r.a.isArray(t.tags)&&(t.tags=r.a.uniq(t.tags)),t.uri){if(/(^\-)|(\-$)/.test(t.uri))return{hyphen:!0};if(/^[0-9]+$/.test(t.uri))return{onlyNumbers:!0};if(t.uri.length>128)return{uriLength:!0};var e=this;if(this.collection&&this.collection.any((function(i){if(i!=e)return(i.get("uri")||"").toLowerCase()===t.uri.toLowerCase()&&i.get("parentPage")===t.parentPage})))return{used:!0}}},groupSaveWids:function(t,e){var i=r.a.pluck(t,"id"),n=r.a.clone(this.get("wids"));e=e||{},this.set("wids",i,{silent:!0}),this.save({wids:n},e)},sanitizeWidgets:function(t){return t.filter((function(t){return!!g.a[t.type]}))},getPageId:function(){return this.id},renewScreenshot:function(){return delete this.specialScreenshot,this},getScreenshot:function(t){return this.specialScreenshot?this.specialScreenshot:(t=u.default.screenshotSize(t||256),this.get("screenshot")?u.default.addFilenameComponent(this.get("screenshot"),t):["/api/screenshot/renew",RM.constructorRouter.mag.get("num_id"),this.get("_id"),"?redirect=true&size="+t].join("/"))},requestNewScreenshot:function(t){n.a.get(["/api/screenshot/renew",RM.constructorRouter.mag.get("num_id"),this.get("_id")].join("/"),r.a.bind((function(e){var i=e.screenshot;i&&(this.save("screenshot",i,{patch:!0}),t())}),this))},requestActualScreenshot:function(t){n.a.get(this.urlRoot+this.id+"/screenshot",r.a.bind((function(e){var i=e.screenshot;i&&(this.save("screenshot",i,{patch:!0}),t())}),this))},getCurrentViewportSetting:function(t,e){return e=e||this.getCurrentViewport(),(r.a.findWhere(h.b.viewports,{name:e})||{})[t]},getViewportParam:function(t,e){var i=this.get("viewport_"+t)||{};return void 0!==i[e]?i[e]:this.get(e)},setViewportParam:function(t,e,i,n){var o=r.a.clone(this.get("viewport_"+t)||{}),a={};o[e]=i,"default"===t?a[e]=i:a["viewport_"+t]=o,this.set(a,n||{})},getCurrentViewportParam:function(t){return this.getViewportParam(this.getCurrentViewport(),t)},setCurrentViewportParam:function(t,e,i){this.setViewportParam(this.getCurrentViewport(),t,e,i)},getViewport:function(){return this.getCurrentViewport()},getCurrentViewport:function(){return this.get("viewport")||"default"},getPreviousViewport:function(){return this.previous("viewport")||"default"},getUsedFonts:function(t){t=t||{};var e=[];return r.a.each(this.widgets.models,(function(t){e.push(t)})),p.a.getUsedFontsFromWidgetsModels(r.a.extend(t,{models:e}))},getOwnGlobalWidgets:function(){return this.widgets.filter(function(t){return t.isGlobal()&&t.get("pid")===this.id}.bind(this))},hasChildren:function(){var t=this;return RM.constructorRouter.mag.pages.some((function(e){return e.get("parentPage")===t.attributes._id}))},isChild:function(){return Boolean(this.attributes.parentPage)}},{getViewportSetting:function(t,e){return(r.a.findWhere(h.b.viewports,{name:e})||{})[t]}}),_=a.a.Collection.extend({model:y,comparator:function(t){return t.get("num")},fetchFullPage:function(t,e){e=e||{},this.fetchingPageXHR||(this.fetchingPageXHR=n.a.get("/api/pageFullById/"+t,r.a.bind((function(i){var n=this.get(t);n||(n=new y(i,{parse:!0}),RM.constructorRouter.mag.onAdd(n,e)),delete n.needUpdate,m.a.clearHistory(n.get("_id")),n.widgets.set(i.wids,{parse:!0,resetPage:!0});var o=r.a.pluck(i.wids,"_id");console.log("RESET"),n.set(r.a.extend({},i,{wids:o}),{resetPage:!0}),e.success&&e.success(),delete this.fetchingPageXHR}),this)).fail(r.a.bind((function(){delete this.fetchingPageXHR,alert("failed to load page, please, refresh the page"),e.success&&e.success()}),this)))}}),w=a.a.Collection.extend({model:y,name:"TrashPages",initialize:function(){this.on("remove",(function(){this.triggerSocketUpdate(this,this.pluck("_id"))}),this)},triggerSocketUpdate:c.a.prototype.triggerSocketUpdate});e.c=y},jcqt:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("q1tI");function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t){var e=t,i=[];function a(t){var n=e;e=t,i.forEach((function(e){var i=e.update,o=e.options;(!o||!o.shouldUpdate||!o.shouldUpdate(n,t))&&i()}))}return[function(t){var r,s=(r=o(Object(n.useState)({}),2)[1],Object(n.useCallback)((function(){r({})}),[]));return Object(n.useEffect)((function(){var e={options:t,update:s};return i.push(e),function(){!function(t,e){var i=t.indexOf(e);if(-1===i)return;t.splice(i,1)}(i,e)}})),[e,a]},a,function(){return e}]}},jeLO:function(t,e,i){"use strict";var n=i("q1z7"),o=i.n(n),a=i("rFsW"),r=i("mT3t"),s=i("Fi5S"),l=r.a.prototype,c=r.a.extend({save:function(t,e,i){var n,o=this;if(a.a.isObject(t)||null==t?(n=t,i=e):(n={})[t]=e,i&&i.skipMagChanging&&this.urlRoot&&(i.url=this.url()+(this.url().indexOf("?")>-1?"&":"?")+"skip_changed=true"),!(i=i?a.a.clone(i):{}).skipPersist)var r=l.save.apply(this,arguments);if(r)return r.error((function(t,e){"abort"!=e&&(t.status&&t.status<500||(o.wasNotSaved=!0,RM.constructorRouter.raiseConnectionError()))})),r.success((function(){o.wasNotSaved&&o.trigger("re-saved"),o.wasNotSaved=!1})),this.skipResponse&&(r.skipResponse=!0),s.a.trigger("save:model",{model:this,setAttrs:n,options:i}),!this.skipMagChanging&&!i.skipMagChanging&&RM.constructorRouter.mag&&RM.constructorRouter.mag.set("changed",!0),r},sync:function(t,e,i){if("patch"==t.toLowerCase()&&e.collection&&e.collection.page){var n=e.collection.page.getCurrentViewport();if(!("default"==n||i&&i.forceDefaultViewport||this.isNested)){var o=e.toJSON(),r={};r["viewport_"+n]=a.a.pick(o["viewport_"+n],a.a.keys(i.attrs)),a.a.isEmpty(r["viewport_"+n])&&delete r["viewport_"+n];var s=a.a.difference(a.a.keys(i.attrs),a.a.keys(r["viewport_"+n]));a.a.extend(r,a.a.pick(e.attributes,s)),i.attrs=r}}return l.sync.apply(this,arguments)},parse:function(t,e){return e&&e.xhr&&e.xhr.skipResponse?(l.parse.apply(this,arguments),this.isNew()?t:void 0):l.parse.apply(this,arguments)},set:function(t,e,i){var n,r;if(a.a.isObject(t)||null==t?(n=t,r=e):((n={})[t]=e,r=i),(r=r||{}).viewport&&!r.forceDefaultViewport&&!r.xhr&&this.getViewport&&this.getViewport()!=r.viewport)return this["viewport_"+r.viewport]=a.a.extend(this["viewport_"+r.viewport]||{},n),this;var l=this.cloneJSON(),c=o.a.Model.prototype.set.apply(this,arguments);return s.a.trigger("set:model",{model:this,prevAttrs:l,setAttrs:n,options:r}),c},cloneJSON:function(){var t=this.toJSON();return a.a.each(t,(function(e,i){t[i]=a.a.cloneWithObjects(e)})),t}});e.a=c},jnxn:function(t,e,i){"use strict";var n=i("6st4");i.n(n).a},"kr2/":function(t,e,i){"use strict";var n=i("bI1h");i.n(n).a},kwFJ:function(module,exports){module.exports={"template-constructor-control-slideshow_manager":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon preloader noarrow" data-alt="Images" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t\t<div class="resizable-scroll-wrapper">\n\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t<div class="resizable-content">\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="resizable-scroll"></div>\n\t\t</div>\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\n\t\t<div class="add-block">\n\t\t\t<div class="add" title="Add Images"></div>\n\t\t</div>\n\n\t\t<div class="error-panel">\n\t\t\t<div class="error-panel-text"></div>\n\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t</div>\n\n\t\t<div class="drop-text">Drop here</div>\n\t</div>\n';return __p},"template-constructor-control-slideshow_manager-image":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="slideshow-image-wrapper '+(null==(__t=pic.error?"error":"")?"":__t)+'" data-num="'+(null==(__t=pic.num)?"":__t)+'" ',pic.errorText&&(__p+='data-error="'+(null==(__t=pic.errorText)?"":__t)+'" '),__p+=' >\n\t\t<div class="slideshow-image">\n\t\t\t<div class="num">'+(null==(__t=pic.num)?"":_.escape(__t))+'</div>\n\t\t\t<div class="image"',thumbUrl&&(__p+=" style=\"background-image: url('"+(null==(__t=thumbUrl)?"":__t)+"')\" "),__p+=' data-id="'+(null==(__t=pic.id)?"":_.escape(__t))+'">\n\t\t\t\t<div class="rmpreloader">\n\t\t\t\t\t<div class="shadow"></div>\n\t\t\t\t\t<div class="arc"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="remove" title="Delete"></div>\n\t\t\t<div class="update" title="Replace"></div>\n\t\t</div>\n\t</div>\n';return __p}}},kwMJ:function(module,exports){module.exports={"template-constructor-helpers-template-center":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="template-center">\n\t\t<div class="template-center-wrapper">\n\n\t\t\t<div class="left-panel">\n\t\t\t\t<div class="search-icon"></div>\n\t\t\t\t<div class="back-icon"></div>\n\t\t\t</div>\n\n\t\t\t<div class="center-panel">\n\n\t\t\t\t<div class="search-wrapper">\n\t\t\t\t\t<div class="border"></div>\n\t\t\t\t\t<input class="search-string" type="text" placeholder="Search..."/>\n\t\t\t\t\t<div class="clear invisible"></div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="scroll-wrapper main">\n\t\t\t\t\t<div class="results-wrapper">\n\t\t\t\t\t\t<div class="results">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="scroll-wrapper info">\n\t\t\t\t\t<div class="results-wrapper">\n\t\t\t\t\t\t<div class="results">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t\t<div class="right-panel">\n\t\t\t\t<div class="template-filter">\n\t\t\t\t\t<div class="categories">\n\t\t\t\t\t\t<div class="caption">Categories</div>\n\t\t\t\t\t\t<div class="category-switcher">\n\t\t\t\t\t\t\t<div class="category-item button active">All</div>\n\t\t\t\t\t\t\t<div class="category-item button" data-category="sandbox">Sandbox</div>\n\t\t\t\t\t\t\t<div class="category-item button" data-category="microsites">Microsites</div>\n\t\t\t\t\t\t\t<div class="category-item button" data-category="presentations">Presentations</div>\n\t\t\t\t\t\t\t<div class="category-item button" data-category="photo_stories">Photo Stories</div>\n\t\t\t\t\t\t\t<div class="category-item button" data-category="longreads">Longreads</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="sort">\n\t\t\t\t\t\t<div class="caption">Sort</div>\n\t\t\t\t\t\t<div class="sort-switcher">\n\t\t\t\t\t\t\t<div class="sort-item button" data-criteria="popular">Popular</div>\n\t\t\t\t\t\t\t<div class="sort-item button active" data-criteria="newest">Newest</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="rm-logo"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="template-info">\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\n\t\t\t<div class="overlay">\n\t\t\t\t<div class="preloader rmpreloader"><div class="arc"></div></div>\n\t\t\t</div>\n\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-helpers-template-center-templateset":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="templateset" data-id="'+(null==(__t=data._id)?"":__t)+'">\n\t\t<div class="image-wrapper">\n\t\t\t<img src="'+(null==(__t=data.screenshot)?"":_.escape(__t))+'" alt="">\n\t\t</div>\n\t\t<div class="title">'+(null==(__t=data.title||"Templateset")?"":_.escape(__t))+'</div>\n\t\t<div class="num-pages">'+(null==(__t=data.pages+" page"+(1==data.pages?"":"s"))?"":__t)+"</div>\n\t</div>\n";return __p},"template-constructor-helpers-template-center-template":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n<div class="template" data-id="'+(null==(__t=data.page_id)?"":__t)+'" data-thumb="'+(null==(__t=data.thumb)?"":__t)+'">\n\t<div class="title">'+(null==(__t=data.idx)?"":_.escape(__t))+". "+(null==(__t=data.title||"Page "+data.num)?"":_.escape(__t))+'</div>\n\t<div class="template-image-wrapper">\n\t\t<img src="">\n\t</div>\n\t<div class="add-page"><div class="plus"></div><div class="checkmark"></div></div>\n</div>\n';return __p},"template-constructor-helpers-template-center-templateinfo":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n<div class="title">'+(null==(__t=data.title||"Templateset")?"":_.escape(__t))+'</div>\n<div class="author">\n\t<span class="label">Designed by</span>\n\t',data.author_url?__p+='\n\t\t<a href="'+(null==(__t=data.author_url)?"":_.escape(__t))+'" target="_blank" class="name">'+(null==(__t=data.author_name)?"":_.escape(__t))+"</a>\n\t":__p+='\n\t\t<span class="name">'+(null==(__t=data.author_name||"Unknown")?"":_.escape(__t))+"</span>\n\t",__p+='\n</div>\n<div class="desc-scroll-wrapper">\n\t<div class="desc-wrapper">\n\t\t<div class="desc">'+(null==(__t=data.description||"No description")?"":_.escape(__t))+'</div>\n\t</div>\n\t<div class="scroll"></div>\n</div>\n<div class="viewports">\n\t<div class="caption">Viewports</div>\n\t<div class="devices">\n\t\t<div class="device default" title="Desktop"></div>\n\t\t',_.each(data.viewports,(function(t){__p+='\n\t\t\t<div class="device '+(null==(__t=t)?"":__t)+'" title="'+(null==(__t=data.VIEWPORTS[t])?"":__t)+'"></div>\n\t\t'})),__p+='\n\t</div>\n</div>\n<div class="categories">\n\t<div class="caption">Categories</div>\n\t<div class="list">'+(null==(__t=data.categories_string)?"":_.escape(__t))+'</div>\n</div>\n<a href="'+(null==(__t=Constants.readymag_host)?"":__t)+"/"+(null==(__t=data.mag_num_id)?"":__t)+'" class="preview button" target="blank">Preview</a>\n<div class="add-pages button" data-id="'+(null==(__t=data._id)?"":__t)+'">\n\t<div class="message">Add '+(null==(__t=data.templates.length)?"":__t)+" page"+(null==(__t=1==data.templates.length?"":"s")?"":__t)+'</div>\n\t<div class="plus"></div>\n\t<div class="checkmark"></div>\n</div>\n';return __p},"template-constructor-helpers-template-center-animation":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n<style id="template-center-page-animation">\n\t.animation-page-flyout-x {\n\t    -webkit-animation: flyout-x .8s linear forwards;\n\t    animation: flyout-x 1s linear forwards;\n\t}\n\n\t.animation-page-flyout-y {\n\t    -webkit-animation: flyout-y .8s linear forwards;\n\t    animation: flyout-y 1s linear forwards;\n\t}\n\n\t@-webkit-keyframes flyout-x {\n\t    0% {\n\t    \t-webkit-animation-timing-function: ease-out;\n\t    }\n\t    30% {\n\t        -webkit-transform: translateX(-40px);\n\t        -webkit-animation-timing-function: ease-in;\n\t        // -webkit-animation-timing-function: linear;\n\t        opacity: 1;\n\t    }\n\t    80% {\n\t    \t-webkit-transform: translateX(150px);\n\t    \t// -webkit-animation-timing-function: ease-in-out;\n\t    \t-webkit-animation-timing-function: linear;\n\t    \topacity: 0.5;\n\t    }\n\t    100% {\n\t        -webkit-transform: translateX(304px);\n\t        // -webkit-animation-timing-function: ease-in;\n\t        -webkit-animation-timing-function: linear;\n\t        opacity: 0;\n\t    }\n\t}\n\n\t@-webkit-keyframes flyout-y {\n\t    0% {\n\t    \t// -webkit-animation-timing-function: linear;\n\t    \t-webkit-animation-timing-function: ease-in;\n\t    }\n\t    30% {\n\t        -webkit-transform: translateY('+(null==(__t=top1)?"":__t)+"px) scale(0.8);\n\t        -webkit-animation-timing-function: linear;\n\t        // -webkit-animation-timing-function: ease-in-out;\n\t        -webkit-animation-timing-function: ease-out;\n\t    }\n\t    80% {\n\t    \t-webkit-transform:translateY("+(null==(__t=top2)?"":__t)+"px) scale(0.5);\n\t    \t-webkit-animation-timing-function: ease-in-out;\n\t    }\n\t    100% {\n\t        -webkit-transform:translateY("+(null==(__t=top3)?"":__t)+"px)  scale(0.37);\n\t        -webkit-animation-timing-function: ease-in;\n\t    }\n\t}\n\n\t@keyframes flyout-x {\n\t    0% {\n\t    \tanimation-timing-function: ease-out;\n\t    }\n\t    30% {\n\t        transform: translateX(-40px);\n\t        animation-timing-function: ease-in;\n\t        // -moz-animation-timing-function: linear;\n\t        opacity: 1;\n\t    }\n\t    80% {\n\t    \ttransform: translateX(150px);\n\t    \t// -moz-animation-timing-function: ease-in-out;\n\t    \tanimation-timing-function: linear;\n\t    \topacity: 0.5;\n\t    }\n\t    100% {\n\t        transform: translateX(304px);\n\t        // -moz-animation-timing-function: ease-in;\n\t        animation-timing-function: linear;\n\t        opacity: 0;\n\t    }\n\t}\n\n\t@keyframes flyout-y {\n\t    0% {\n\t    \t// -moz-animation-timing-function: linear;\n\t    \tanimation-timing-function: ease-in;\n\t    }\n\t    30% {\n\t        transform: translateY("+(null==(__t=top1)?"":__t)+"px) scale(0.8);\n\t        animation-timing-function: linear;\n\t        // -moz-animation-timing-function: ease-in-out;\n\t        animation-timing-function: ease-out;\n\t    }\n\t    80% {\n\t    \ttransform:translateY("+(null==(__t=top2)?"":__t)+"px) scale(0.5);\n\t    \tanimation-timing-function: ease-in-out;\n\t    }\n\t    100% {\n\t        transform:translateY("+(null==(__t=top3)?"":__t)+"px)  scale(0.37);\n\t        animation-timing-function: ease-in;\n\t    }\n\t}\n\n\n</style>\n";return __p}}},l2W4:function(t,e){var i;i=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent),window.soundcloud={version:"0.1",debug:!1,_listeners:[],_redispatch:function(t,e,i){var n,o=this._listeners[t]||[],a="soundcloud:"+t;try{n=this.getPlayer(e)}catch(n){return void(this.debug&&window.console&&console.error("unable to dispatch widget event "+t+" for the widget id "+e,i,n))}window.jQuery?jQuery(n).trigger(a,[i]):window.Prototype&&$(n).fire(a,i);for(var r=0,s=o.length;r<s;r+=1)o[r].apply(n,[n,i]);this.debug&&window.console&&console.log(a,t,e,i)},addEventListener:function(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)},removeEventListener:function(t,e){for(var i=this._listeners[t]||[],n=0,o=i.length;n<o;n+=1)i[n]===e&&i.splice(n,1)},getPlayer:function(t){var e;try{if(!t)throw"The SoundCloud Widget DOM object needs an id atribute, please refer to SoundCloud Widget API documentation.";if(e=i?window[t]:document[t]){if(e.api_getFlashId)return e;throw"The SoundCloud Widget External Interface is not accessible. Check that allowscriptaccess is set to 'always' in embed code"}throw"The SoundCloud Widget with an id "+t+" couldn't be found"}catch(t){throw console&&console.error&&console.error(t),t}},onPlayerReady:function(t,e){this._redispatch("onPlayerReady",t,e)},onMediaStart:function(t,e){this._redispatch("onMediaStart",t,e)},onMediaEnd:function(t,e){this._redispatch("onMediaEnd",t,e)},onMediaPlay:function(t,e){this._redispatch("onMediaPlay",t,e)},onMediaPause:function(t,e){this._redispatch("onMediaPause",t,e)},onMediaBuffering:function(t,e){this._redispatch("onMediaBuffering",t,e)},onMediaSeek:function(t,e){this._redispatch("onMediaSeek",t,e)},onMediaDoneBuffering:function(t,e){this._redispatch("onMediaDoneBuffering",t,e)},onPlayerError:function(t,e){this._redispatch("onPlayerError",t,e)}}},lRGI:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("zw1n"),l=i.n(s),c=i("M9xF"),d=i.n(c),h=i("3XvJ"),u=i.n(h),p=i("OTSC"),m={STYLE_PREFIXES:{viewer:[".rmwidget.widget-button .common-button"],viewerCurrentLink:[".maglink.current .widget-button .common-button"],constructor:[".block.button .common-button"]},generateIndividualStyleCSS:function(t){var e=this.STYLE_PREFIXES[t.env],i=t.model,o=i.tp,a=this,s=function(n){n=n||"default";var s={default:"",hover:"hovered",current:"current"},l={default:"",hover:"hover-",current:"current-"},c=r.a.isUndefined(s[n])?s.default:s[n],d=r.a.isUndefined(l[n])?l.default:l[n],h=r.a.map(e,(function(t){return t+'[data-id="'+i._id+'"]'+(c?"."+c:"")})).join(",\n")+" {\n";return h+=a.generateStylesStr({model:i,attrPrefix:d,indentation:!0,lineBreaks:!0,env:t.env,state:n}),h+="}\n\n","viewer"===t.env&&("current"===n&&a.isNeedCurrentStyle(i)&&(h+=a.STYLE_PREFIXES.viewerCurrentLink+'[data-id="'+i._id+'"] {\n',h+=a.generateStylesStr({model:i,attrPrefix:d,indentation:!0,lineBreaks:!0}),h+="}\n\n"),"icon"!==o&&"text_and_icon"!==o||(h+=r.a.map(e,(function(t){return t+'[data-id="'+i._id+'"]'+(c?"."+c:"")+" .icon"})).join(",\n")+" {\n",h+='\t background-image: url("'+(Modernizr.retina?i[d+"icon_raster2xUrl"]:i[d+"icon_rasterUrl"])+'");\n',h+="}\n\n","current"===n&&(h+=a.STYLE_PREFIXES.viewerCurrentLink+'[data-id="'+i._id+'"] .icon {\n',h+='\t background-image: url("'+(Modernizr.retina?i[d+"icon_raster2xUrl"]:i[d+"icon_rasterUrl"])+'");\n',h+="}\n\n"))),h},l=s("default");r.a.find(r.a.keys(i),(function(t){return/^current/.test(t)}))&&(l+=s("current")),l+=s("hover");var c="individual_button_style_"+i._id+"_"+t.env;Object(n.a)("#"+c).remove();var d=document.createElement("style");d.type="text/css",d.id=c,d.className="button_styles",d.appendChild(document.createTextNode(l)),document.getElementsByTagName("head")[0].appendChild(d)},generateStylesStr:function(t){var e="",i=t.model,n=t.indentation?"\t":"",o=";"+(t.lineBreaks?"\n":""),a=t.attrPrefix||"";return e+=n+"background-color: "+p.default.getRGBA(r("background-color"),r("background-color-opacity")/100)+o,e+=n+"border-radius: "+s(r("border-radius"))+o,e+=n+"border-width: "+s(r("border-width"))+o,e+=n+"border-color: "+p.default.getRGBA(r("border-color"),r("border-color-opacity")/100)+o,e+=n+"font-family: "+r("font-family")+o,e+=n+"font-weight: "+r("font-weight")+o,e+=n+"font-style: "+r("font-style")+o,e+=n+"color: "+p.default.getRGBA(r("color"),r("color-opacity")/100)+o,e+=n+"font-size: "+s(r("font-size"))+o,e+=n+"letter-spacing: "+s(r("letter-spacing"))+o,i["hover-tansition-duration"]&&(e+=n+"transition: ".concat(i["hover-tansition-duration"],"s")+o),t.env&&t.state&&"viewer"===t.env&&"hover"===t.state&&i["hover-cursor"]&&(e+=n+"cursor: ".concat(i["hover-cursor"])+o),e;function r(t){var e=i[a+t];return("inherit"===e&&a||void 0===e)&&(e=i[t]),"border-color"===t&&"hover-"===a?0==i["hover-border-width"]&&(e=i["border-color"]):"border-color"===t&&"current-"!==a&&0==i["border-width"]&&(e=i["hover-border-color"]),"border-color-opacity"===t&&"hover-"===a?0==i["hover-border-width"]&&(e=i["border-color-opacity"]):"border-color-opacity"===t&&0==i["border-width"]&&(e=i["hover-border-color-opacity"]),e}function s(t){return t+(/px/i.test(t)?"":"px")}},destroyIndividualStyleCSS:function(t){var e="individual_button_style_"+t.model._id+"_"+t.env;Object(n.a)("#"+e).remove()},isNeedCurrentStyle:function(t){var e=t.clickLink;return!(!e||!t.is_global)&&(!(/^http(s?)\:\/\//i.test(e)||/^mailto\:/i.test(e)||/^tel\:/i.test(e))&&!!t.mag.getPageUri(e))}};function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){v(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var b=f(f(f({},l.a),d.a),u.a),y=a.a.View.extend({MIN_ICON_MARGIN:8,initialize:function(t){t&&(r.a.bindAll(this),this.block=t.block,this.model=t.block&&t.block.model,this.model=t.model,this.$container=t.$container,this.environment=t.environment,this.mag=t.mag,r.a.extend(this.model,{env:this.environment}),this.generateIndividualStyleCSS({env:this.environment,model:this.model}),this.template=b["template-common-button-widget"],"constructor"===this.environment?this.text_template=b["template-constructor-block-button"]:this.text_template=b["template-viewer-widget-button"],this.render())},render:function(){this.model.tp;var t=m.generateStylesStr({model:this.model});this.setElement(Object(n.a)(this.template({data:this.model}))),Object(n.a)(this.text_template({data:this.model})).appendTo(this.$el),this.$text=this.$(".text"),this.$icon=this.$(".icon"),this.$button=this.$text.closest(".common-button"),this.$button.attr("style",t),this.applyButtonType(this.model.tp),"circle"===this.model.form&&this.applyCircleRadius(this.model.w),this.applyTextContainerSize(this.model),this.applyIconContainerSize(this.model),this.applyIconPosition(this.model),"viewer"===this.environment&&this.$container.css("border-radius",this.$button.css("border-radius")),this.$el.appendTo(this.$container),this.renderFinishTimeout=setTimeout(function(){var t=["background-color","background-color-opacity","border-width","border-color","border-color-opacity","font-family","font-style","font-weight","color","color-opacity","font-size","letter-spacing"];"circle"!==this.model.form&&t.push("border-radius"),t.forEach(function(t){this.$button.css(t,"")}.bind(this)),this.applyTransition()}.bind(this),500)},renderButtonText:function(t){this.$el.find(".text").text(t)},renderButtonTextWithSizes:function(t,e){e&&this.applyTextContainerSize(e),this.$el.find(".text").text(t).css({display:t?"block":"none"})},applyTransition:function(){"viewer"!==this.environment||Modernizr.touch||this.model.transition&&this.$button.addClass("transition")},applyButtonType:function(t){"text"===t?(this.$text.css("display","inline-block"),this.$icon.css("display","none")):"icon"===t?(this.$icon.css("display","inline-block"),this.$text.css("display","none")):"text_and_icon"===t&&this.$icon.add(this.$text).css("display","inline-block")},applyCircleRadius:function(t){this.$button.css("border-radius","100%")},applyTextContainerSize:function(t){var e=t["letter-spacing"],i=0,n=0;e>0?i=e:e<0&&(n=e),this.$text.css({width:t.text_w+"px","padding-left":i+"px","text-indent":n+"px",height:"viewer"===this.environment?"".concat(t.h,"px"):"".concat(t.text_h,"px"),"line-height":"viewer"===this.environment?"".concat(t.h,"px"):"".concat(t.text_h,"px")})},applyIconContainerSize:function(t){t.tp;var e=t.icon_w,i=t.icon_h;t.icon_pos;this.$icon.css({width:e+"px",height:i+"px","margin-right":"0px","margin-left":"0px"})},calcIconMarginFromText:function(t){return Math.ceil(t/4)},calcIconTopBottomMargin:function(t){return Math.ceil(t/3)},calcTextTopBottomMargin:function(t){return Math.ceil(t/6)},applyIconPosition:function(t){var e=t.icon_pos;"left"===e?this.$button.css({"flex-direction":"row","-webkit-flex-direction":"row"}):"right"===e&&this.$button.css({"flex-direction":"row-reverse","-webkit-flex-direction":"row-reverse"})},generateIndividualStyleCSS:function(t){m.generateIndividualStyleCSS({env:t.env,model:t.model})},destroy:function(){clearTimeout(this.renderFinishTimeout),m.destroyIndividualStyleCSS({env:this.environment,model:this.model}),this.$el&&this.$el.remove()}});e.a=y},m41J:function(t,e,i){"use strict";var n=i("rFsW"),o=(i("I0kf"),i("pFlR")),a={sideAngles:{top:0,right:.5*Math.PI,bottom:Math.PI,left:1.5*Math.PI},calcOrientedTriangleSquare:function(t,e,i){return(e.x-t.x)*(i.y-t.y)-(e.y-t.y)*(i.x-t.x)},intersectsOnAxisProjection:function(t,e,i,n){var o;return t>e&&(o=t,t=e,e=o),i>n&&(o=i,i=n,n=o),t<i&&(t=i),e>n&&(e=n),t<=e},isLinesIntersects:function(t,e,i,n){return a.intersectsOnAxisProjection(t.x,e.x,i.x,n.x)&&a.intersectsOnAxisProjection(t.y,e.y,i.y,n.y)&&a.calcOrientedTriangleSquare(t,e,i)*a.calcOrientedTriangleSquare(t,e,n)<=0&&a.calcOrientedTriangleSquare(i,n,t)*a.calcOrientedTriangleSquare(i,n,e)<=0},isConvexPolygonContainsPoint:function(t,e){for(var i=0;i<t.length;i++){var n=(i+1)%t.length;if(a.calcOrientedTriangleSquare(t[i],t[n],e)<0)return!1}return!0},isConvexPolygonsIntersects:function(t,e){var i,n,o,r;for(i=0;i<t.length;i++)if(a.isConvexPolygonContainsPoint(e,t[i]))return!0;for(i=0;i<e.length;i++)if(a.isConvexPolygonContainsPoint(t,e[i]))return!0;for(i=0;i<t.length;i++)for(n=(i+1)%t.length,o=0;o<e.length;o++)if(r=(o+1)%e.length,a.isLinesIntersects(t[i],t[n],e[o],e[r]))return!0;return!1},doBoundingBoxesIntersect:function(t,e){return t&&e&&!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)},calcBoundingBox:function(t,e,i){var o=a.calcRotatedBox(t),r=n.a.pluck(o,"x"),s=n.a.pluck(o,"y"),l=Math.min.apply(null,r),c=Math.max.apply(null,r),d=Math.min.apply(null,s),h=l,u=d,p=c-l,m=Math.max.apply(null,s)-d;return e&&(["n","c","s"].indexOf(e)>-1&&(h=t.left),["w","c","e"].indexOf(e)>-1&&(u=t.top)),i?{width:p,height:m,left:h,top:u}:{bb_width:p,bb_height:m,bb_left:h,bb_top:u}},boxToRect:function(t){return{width:t.width,height:t.height,top:t.top,bottom:t.top+t.height,left:t.left,right:t.left+t.width}},getBoundingBoxOfElements:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t.map((function(t){return t.parentElement?1!==e?o.a.getBox(t,e):t.getBoundingClientRect():{bottom:0,height:0,left:0,right:0,top:0,width:0}}));return a.getBoundingBoxOfBoxes(i)},getBoundingBoxOfBoxes:function(t){var e=[],i=[];n.a.each(t,(function(t){var o=void 0!==t.right?n.a.extend({},t):a.boxToRect(t);e.push(o.left),e.push(o.right),i.push(o.top),i.push(o.bottom)}));var o={top:Math.min.apply(null,i),right:Math.max.apply(null,e),bottom:Math.max.apply(null,i),left:Math.min.apply(null,e)};return o.width=o.right-o.left,o.height=o.bottom-o.top,o},getBoundingBoxOfBlocks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.map((function(t){var e=t.getBoxData({includeBoundingBox:!0,checkFixedPosition:!0});return{width:e.bb_w,height:e.bb_h,top:e.bb_y,left:e.bb_x}}));return a.getBoundingBoxOfBoxes(e)},calcRotatedBox:function(t){var e=[],i=[0,1,1,0],o=[0,0,1,1],a=t.left+t.width/2,r=t.top+t.height/2,s=t.sinAngle,l=t.cosAngle;return n.a.each(i,(function(n,c){var d=t.left+t.width*i[c],h=t.top+t.height*o[c],u=d-a,p=r-h;d=a+l*u+s*p,h=r+s*u-l*p;e.push({x:d,y:h})})),e},getDistance:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},getBestPoints:function(t,e){for(var i,n,o,r=["right","left","bottom","top"],s={distance:1/0,fromPoint:{},toPoint:{}},l=0;l<r.length;l++)for(var c=0;c<r.length;c++)n=a.getSideCenter(t,r[l]),o=a.getSideCenter(e,r[c]),s=(i=a.getDistance(n,o))<s.distance?{distance:i,fromSide:r[l],fromPoint:n,toSide:r[c],toPoint:o}:s;return s},getSideCenter:function(t,e){var i;switch(e){case"left":i={x:t.left,y:t.top+t.height/2};break;case"top":i={x:t.left+t.width/2,y:t.top};break;case"bottom":i={x:t.left+t.width/2,y:t.top+t.height};break;case"right":default:i={x:t.left+t.width,y:t.top+t.height/2}}return i={x:(i.x-t.centerX)*t.cos-(i.y-t.centerY)*t.sin+t.centerX,y:(i.y-t.centerY)*t.cos+(i.x-t.centerX)*t.sin+t.centerY}},getPerpendicularEnd:function(t,e,i,n){var o=i.angle+a.sideAngles[t];return{x:n*Math.sin(o)+e.x,y:-n*Math.cos(o)+e.y}},getBox:function(t){var e=(t.$el&&t.$el[0]||t.length&&t[0]||t).getBoundingClientRect(),i=t.model?(t.model.attributes.angle||0)*Math.PI/180:0;return e=n.a.extend(e,{angle:i,sin:Math.sin(i),cos:Math.cos(i)}),e=n.a.extend(e,{centerX:e.left+e.width/2,centerY:e.top+e.height/2})},getResizedBoxNested:function(t,e,i,n){var o=i.width/e.width,a=i.height/e.height;return o="height"===n?a:o,a="width"===n?o:a,{left:(t.left-e.left)*o+i.left,top:(t.top-e.top)*a+i.top,width:t.width*o,height:t.height*a}},getResizedBoxByBB:function(t,e,i){var n=i.left+i.width/2,o=i.top+i.height/2,a=i.width/e.width,r=i.height/e.height,s=t.width*a,l=t.height*r;return{left:n-s/2,top:o-l/2,width:s,height:l}},getBoxLimits:function(t,e){var i=t.width/t.height>1,n=i?e.minheight/t.height:e.minwidth/t.width,o=i?e.maxwidth/t.width:e.maxheight/t.height;return{minwidth:e.minwidth?Math.round(t.width*n):1,minheight:e.minheight?Math.round(t.height*n):1,maxwidth:e.maxwidth?Math.round(t.width*o):1/0,maxheight:e.maxheight?Math.round(t.height*o):1/0}}};e.a=a},mIwl:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n=["The follies of others are obvious, but our own hide from us; we love to parse others’ missteps but we cover up our own, as the cheat conceals the false die. It is in the nature of men to lay blame: we see others’ mistakes while our own passions swell, carrying us ever farther from improvement. — Buddhist wisdom","No one can long stand on tiptoe. He who thrusts himself forward is not a source of light. No glory comes to the self-satisfied, no honor to the boastful. The proud will not rise high. In the court of good sense, such people are like table discards, repellent to all. The sensible person does not rely on self. — Lao-Tzu","Simplicity in life, language and habits strengthens a nation, but a life of luxury, fancy language and effeminate habit leads to weakness and death. — John Ruskin","Truth is not a matter of talking but comes only through labor and observation. And when you have one truth in hand, two others, like the first leaves of a dicotyledonous plant, will probably appear. — John Ruskin","All things have a beginning and an end. So it is with mankind: there is a beginning and end to all  human affairs. He who understands what is a beginning and what is an end is closer to the truth. — Confucius","Most people are dismayed if deprived of their pleasures. The right course belongs to him who relishes even the passing away of the reason for his joy and is not bitter. — Pascal","When we are clear about things, we have knowledge; with knowledge, we seek the path of truth; when the search is rewarded, the heart becomes good; with the heart made good, the moral view of things that leads to virtue is attained. — Confucius","Wisdom has three faces: when seen from afar, it is grand and severe; on closer approach, it is tender and welcoming; when we are close enough to hear it, the words of  wisdom are severe and demanding. — Chinese wisdom","The sun constantly floods the world with its light, but its light is not exhausted; so your mind should send its light in all directions and not be exhausted. It should flow everywhere, without diminishment, and when it encounters an obstacle, it should react, not with annoyance or anger but should serenely clarify all that yearns to accept it, without any lessening or weariness, bringing light to all that is turned to it, leaving in shadow only that which turns its face away. — Marcus Aurelius","As torches and fireworks pale to invisibility in the sun, so the mind, even the mind of genius, and beauty pale and are eclipsed by the heart’s goodness. — Schopenhauer","Music and sweet treats bring the wanderer to a stop, but wisdom has neither flavor nor smell. When looked for, it is invisible; when listened for, it is inaudible, yet its goodness is inexhaustible. The most powerful thing in the world cannot be seen, heard or touched. — Lao-Tzu","The best ideas are usually those that come without effort, out of the blue. The great intellectual creations come easily. Only a great person can create something great, and such a one works without strain. — John Ruskin","He who talks much rarely puts his words into action. But the wise person fears that his words may not be translated into action. The wise do not utter empty words, lest their actions be inconsistent with their words. — Chinese wisdom","Fear ignorance, but fear false knowledge even more. Turn your eyes from the deceptive world and do not trust your feelings, for they lie; rather look inward to the impersonal, eternal self. Truly, ignorance is like a sealed and airless chamber; in it, the soul sits like a caged bird, neither singing nor spreading its wings. But ignorance is better than any school of thought that is not guided by the wisdom of the soul. — Buddhist wisdom","Some seek their good or happiness in power; others in science, and others in the pleasures of the flesh. But those who come truly close to the good understand that it cannot consist in what can only be mastered by a few. They understand that the true good of humankind is that which can be achieved by all people, without division and without envy; its nature  is such that none can lose it if they do not so choose. — Pascal","The wise person asks only of himself; the unwise man demands everything from others. — Chinese wisdom","To know much and not to put one’s self forward as knowing is the height of morality. To know little and put one’s self forward as knowledgeable is an illness. Only by understanding the disease can one expunge it. — Lao-Tzu","Speak only of that which is as clear to you as the morning, or be silent. — Talmud","Conquer ferocity with love, evil with good, miserliness with generosity, the liar with truth. — Buddhist wisdom","People seek satisfaction, throwing themselves from one thing to another because they feel the emptiness of their lives but do not yet realize the emptiness of the new delight that attracts them. — Pascal","The skilled warrior does not rage. The skilled fighter is not angry. He who is skilled in the use of people is not provocative. This is the virtue of non-resistance. This is being in agreement with Heaven. — Lao-Tzu","The first and principal characteristic of a good and wise person is his consciousness that he knows very little, that many people know more and he seeks always to learn, to study, and not to teach. Those who wish to teach or direct neither teach nor lead well. — John Ruskin","The virtuous person seeks to follow the direct path to the end. What is to be feared is to go halfway and then to weaken. — Chinese wisdom"],o=function(){return n[Math.floor(Math.random()*n.length)]}},mT3t:function(t,e,i){"use strict";var n=i("q1z7"),o=i.n(n),a=i("rFsW"),r=o.a.Model.extend({parse:function(t,e){return!e||!e.xhr||this.isNew()||e&&e.noSocketUpdate||(a.a.isEmpty(t)&&(t=this.toJSON(a.a.pick(e,"viewport","fixViewports"))),this.triggerSocketUpdate(t,e)),o.a.Model.prototype.parse.apply(this,arguments)},triggerSocketUpdate:function(t,e){var i=t;if(e&&e.patch&&(i=a.a.extend({},e.attrs,this.pick("_id","pid"))),i=this.getChangedAttributes?this.getChangedAttributes():i,a.a.isEmpty(i)&&(i=this.toJSON()),!i.pid&&this.getPageId&&"Page"==!this.name&&(i.pid=this.getPageId()),this.getViewport&&"default"!=this.getViewport()){var n=i.pid||this.getPageId&&this.getPageId();return this.triggerViewportUpdate(n)}RM.constructorRouter.trigger("update_from_server",this.name,i)},triggerViewportUpdate:function(t){RM.constructorRouter.trigger("update_from_server","Viewport",t)}});e.a=r},"mX/r":function(t,e,i){"use strict";var n=i("E913");i.n(n).a},muOB:function(t,e,i){"use strict";var n=i("IzrY");i.n(n).a},n1zk:function(t,e,i){},nnuN:function(t,e,i){"use strict";i.r(e),i.d(e,"WEIGHTS",(function(){return r})),i.d(e,"PROVIDERS",(function(){return s}));var n=i("rFsW"),o=i("DqjY"),a=i("xi34"),r={n1:"Thin",n2:"ExtraLight",n3:"Light",n4:"Regular",n5:"Medium",n6:"SemiBold",n7:"Bold",n8:"ExtraBold",n9:"Black",i1:"Thin Italic",i2:"ExtraLight Italic",i3:"Light Italic",i4:"Italic",i5:"Medium Italic",i6:"SemiBold Italic",i7:"Bold Italic",i8:"ExtraBold Italic",i9:"Black Italic",v:"Variable"},s={system:{title:"System Fonts",url:""},google:{title:"Google Fonts",url:"http://www.google.com/fonts"},typekit:{title:"Typekit",url:"http://www.typekit.com/"},webtype:{title:"<Webtype>",url:"http://www.webtype.com/"},typetoday:{title:"Type.today",url:"https://type.today/"},custom:{title:"Custom web font",url:""}},l=function(t){this.edit_params=t,this.proxyMethods(["set","get","fetch","on","off","save"]),this.updateTypetodayVariations()};l.prototype={id:"_fonts",MAX_VISIBLE_TYPEKIT_FONTS:5,FVD_NAMES:r,PROVIDERS:s,proxyMethods:function(t){var e=this,i=this.edit_params;n.a.each(t,(function(t){e[t]=function(){return i[t].apply(i,arguments)}}))},updateTypetodayVariations:function(){var t=!1,e=n.a.map(this.get("fonts"),(function(e){if("typetoday"===e.provider){var i=n.a.find(o.a.fontsShortList.typetoday,{name:e.css_name}),a=Boolean(i&&n.a.difference(i.variations,e.variations).length);return t=t||a,a?n.a.extend({},e,{variations:n.a.union(e.variations,i&&i.variations)}):e}return e}));t&&this.save({fonts:e},{silent:!0})},appendFontsCssToDocument:function(t,e){return o.a.appendFontsCssToDocument(n.a.extend({fonts:this.get("fonts")},t),e)},findFontByCSSName:function(t){return n.a.find(this.get("fonts"),(function(e){return e.css_name.toLowerCase()===t.toLowerCase()}))||{css_name:t,name:t}},getProviderData:function(t){var e=this.PROVIDERS[t]||{};return n.a.defaults(e,{title:"",url:""}),e},getStyleName:function(t,e,i){var n,a=("italic"===e.toLowerCase()?"i":"n")+t/100;return i&&(n=o.a.getCustomVariationNameByFVD(i,a)),n||this.FVD_NAMES[a]},getVisualRenderedFontStyles:function(t,e,i){var o={"font-weight":e};o["font-style"]=i;var a=this.findFontByCSSName(t),r=9999;return a&&(o["font-family"]=t,n.a.each(a.variations,(function(t){var i=100*(t.substr(1,1)-0),n=Math.abs(i-e);n<r&&(o["font-weight"]=i,r=n)})),Math.abs(700-e)<r&&(o["font-weight"]=700)),o},findCommonFontsStylesAvailable:function(t){var e=[];return n.a.each(t,n.a.bind((function(t){var i=this.findFontByCSSName(t);if(i){var o=[];n.a.each(i.variations,(function(t){var e=100*(t.substr(1,1)-0),i="n"===t.substr(0,1)?"normal":"italic";o.push(e+"-"+i)})),e.push(o)}}),this)),e.length>0&&(e=n.a.intersection.apply(this,e)),e},typekitFontsCount:function(t){var e=n.a.where(t,{provider:"typekit"}).length,i=n.a.where(t,{provider:"typekit",hidden:!0}).length;return{visible:e-i,hidden:i}},changeFontHidden:function(t,e,i,o){var r=n.a.cloneWithObjects(this.get("fonts")),s=n.a.find(r,(function(e){return e.css_name.toLowerCase()===t.toLowerCase()}))||{};return s.hidden=e,s._id&&s.is_personal&&a.a.ajax({url:"/api/customfonts",method:"PATCH",dataType:"json",contentTypeType:"application/json",data:{_id:s._id,hidden:s.hidden,mag_user:i,mag_num_id:o}}),this.typekitFontsCount(r).visible>this.MAX_VISIBLE_TYPEKIT_FONTS?{error:"typekit-full-house"}:(this.save("fonts",r),{})},getUsedFontsCache:function(){var t={};return n.a.each(this.get("fonts"),(function(e){t[e.css_name]={temporary:e.temporary,hidden:e.hidden}})),t},addFonts:function(t,e){var i,o,a=n.a.cloneWithObjects(this.get("fonts"));return n.a.each(t,n.a.bind((function(o){n.a.contains(["template","paste"],e)&&delete o.used_variations,i=n.a.find(a,(function(t){return t.css_name.toLowerCase()===o.css_name.toLowerCase()})),n.a.contains(["font-explorer","manual"],e)&&(i?i.hidden=!1:a.push(o)),"font-upload"===e&&(i?n.a.extend(i,t[0]):a.push(o)),n.a.contains(["template","paste"],e)&&(i||(o.hidden=!0,a.push(o)))}),this)),"font-explorer"===e&&this.typekitFontsCount(a).visible>this.MAX_VISIBLE_TYPEKIT_FONTS?{error:"typekit-full-house"}:((o=RM.constructorRouter)&&(o=o.workspace)&&(o=o.controls)&&(o=o.findControl("text_typography"))&&o.plusAnimation(),this.save({fonts:a},{silent:n.a.contains(["template","paste","manual"],e)}),this.appendFontsCssToDocument({version:"edit"},(function(){window.RM.constructorRouter.trigger("font-added")})),{})},removeFonts:function(t){var e=n.a.cloneWithObjects(this.get("fonts"));n.a.each(e,(function(e){n.a.each(t,(function(t){e.css_name.toLowerCase()===t.toLowerCase()&&(e.hidden=!0)}))})),this.save("fonts",e)},clearTempFonts:function(){if(n.a.findWhere(this.get("fonts"),{temporary:!0})){var t=n.a.cloneWithObjects(this.get("fonts"));t=n.a.filter(t,(function(t){var e=!(t.temporary&&t.hidden);return delete t.temporary,e})),this.save("fonts",t)}}},e.default=l},o3C3:function(module,exports){module.exports={"template-constructor-helpers-font-selector":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="rmfontselector">\n\n\t\t<div class="tabs-switcher">\n\t\t\t<div class="caption-system">System</div>\n\t\t\t<div class="caption-custom">Custom</div>\n\t\t</div>\n\n\t\t<div class="categories">\n\n\t\t\t<div class="scroll-wrapper system">\n\t\t\t\t<div class="category-wrapper">\n\t\t\t\t\t<div class="category">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="scroll"></div>\n\t\t\t</div>\n\n\t\t\t<div class="scroll-wrapper custom">\n\t\t\t\t<div class="category-wrapper">\n\t\t\t\t\t<div class="category">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="scroll"></div>\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t\t<div class="add-font">\n\t\t\t<div class="add-font-button" data-type="upload">Upload</div>\n\t\t\t<div class="add-font-button" data-type="library">Library</div>\n\t\t</div>\n\n\t\t<div class="upload-font invisible"></div>\n\t</div>\n\n';return __p},"template-constructor-helpers-font-selector-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="category-element icon-'+(null==(__t=font.provider)?"":__t)+" ",font.hidden&&(__p+="hidden"),__p+="  "+(null==(__t=font.is_personal&&!canUploadFonts?"disabled":"")?"":__t)+" "+(null==(__t=font.is_personal?"personal":"")?"":__t)+'" data-css_name="'+(null==(__t=font.css_name)?"":__t)+'" data-provider="'+(null==(__t=font.provider)?"":__t)+'">\n\t\t',"system"==font.provider||"custom"==font.provider&&!font.is_personal||(__p+="\n\n\t\t\x3c!-- Не даем удалять/восстанавливать коллабораторам --\x3e\n\t\t",("custom"!=font.provider||canEditCustomFonts)&&(__p+='\n\t\t<div class="action"></div>\n\t\t'),__p+="\n\n\t\t\t","custom"==font.provider&&font.is_personal&&canEditCustomFonts?__p+='\n\t\t\t\t<div class="edit-custom-font"></div>\n\t\t\t':__p+='\n\t\t\t\t<a class="tp-icon" target="_blank" title="'+(null==(__t=provider_data.title)?"":_.escape(__t))+'" '+(null==(__t=provider_data.url?'href="'+provider_data.url+'"':"")?"":__t)+"></a>\n\t\t\t",__p+="\n\t\t"),__p+='\n\t\t<div style="font-family:'+(null==(__t=font.css_name)?"":__t)+'" class="caption">'+(null==(__t=font.name)?"":__t)+"</div>\n\t</div>\n\n";return __p},"template-constructor-helpers-font-selector-upload":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="uf-section font-name">\n\t\t<input type="text" name="font-name-input" class="font-name-input" placeholder="Enter font name" value="'+(null==(__t=name)?"":_.escape(__t))+'"/>\n\t</div>\n\n\t<div class="uf-section weight-list invisible">\n\t\t<div class="uf-panel weights">\n\t\t\t<div class="scroll-wrapper">\n\t\t\t\t<div class="results-wrapper">\n\t\t\t\t\t<div class="results">\n\t\t\t\t\t\t<div class="list">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="button add-weight">Add weight</div>\n\t\t\t\t\t\t<a class="uf-link add-tracking-code" href="http://help.readymag.com/hc/en-us/articles/360018417451-Text" target="_blank"><span>Add tracking code</span></a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="gutter"></div>\n\t\t\t\t<div class="scroll"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="uf-panel selector invisible">\n\t\t\t<div class="available-list">\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n1">Thin</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i1">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n2">ExtraLight</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i2">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n3">Light</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i3">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n4">Regular</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i4">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n5">Medium</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i5">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n6">SemiBold</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i6">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n7">Bold</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i7">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n8">ExtraBold</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i8">Italic</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="available-weight">\n\t\t\t\t\t<div class="bullet"></div>\n\t\t\t\t\t<div class="weight-item name" data-var="n9">Black</div>\n\t\t\t\t\t<div class="weight-item italic" data-var="i9">Italic</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="uf-panel uploader invisible">\n\t\t\t<div class="button select">Regular</div>\n\t\t\t<div class="button upload">\n\t\t\t\t<span>Upload .woff</span>\n\t\t\t\t<input class="font-file-upload" id="font-file-upload" type="file" accept=".woff" data-url="/api/upload/font"/>\n\t\t\t</div>\n\t\t\t<div class="disclaimer">By uploading webfonts you<br/>agree that you own or have<br/>the necessary license.</div>\n\t\t</div>\n\t</div>\n\n\t<div class="uf-section actions">\n\t\t<div class="done disabled"><span class="caption">Done</span></div>\n\t</div>\n\t<div class="dragover-overlay"></div>\n';return __p},"template-constructor-helpers-font-selector-upload-weights":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="\n\t",_.each(weights,(function(t){__p+='\n\t\t<div class="weight" data-type="'+(null==(__t=t.type)?"":__t)+'">\n\t\t\t<div class="name">'+(null==(__t=names[t.type])?"":__t)+'</div>\n\t\t\t<div class="reupload-weight">\n\t\t\t\t<input class="font-file-re-upload" id="font-file-re-upload" type="file" accept=".woff" data-url="/api/upload/font"/>\n\t\t\t</div>\n\t\t\t<div class="delete-weight"></div>\n\t\t</div>\n\t'})),__p+="\n";return __p}}},oR3H:function(t,e,i){"use strict";var n=i("LEh1");i.n(n).a},oRHT:function(module,exports){module.exports={"template-constructor-control-text_edit":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Edit" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t</div>\n';return __p}}},oaeQ:function(t,e,i){"use strict";var n=i("Q6xy");i.n(n).a},"oh/L":function(module,exports){module.exports={"template-constructor-pages-panel-settings-domain":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="header-message section">'+(null==(__t="mag"==type?"Сustom domain name":"Custom domain for profile page")?"":__t)+'</div>\n\n\t<div class="initial-preloader rmpreloader section invisible">\n\t\t<div class="shadow"></div>\n\t\t<div class="arc"></div>\n\t</div>\n\n\t<div class="register-switcher section"><span class="registered item active">Use registered</span><span class="dot">•</span><span class="item new">Register new</span></div>\n\n\t<div class="unmap-message section"><span class="unmap-button">Unmap</span> this domain name</div>\n\n\t<div class="test-block section">\n\t\t<input class="domain-input" type="text" spellcheck="false" value="" placeholder="yourdomain.com" />\n\t\t<div class="test-button common-button disabled">Test<div class="rmpreloader"><div class="arc"></div></div></div>\n\t</div>\n\n\t<div class="invalid-domain-message section"><span class="red">Domain name may contain only alphanumeric characters. No directories are allowed.</span><br/><br/><span class="bold">Examples:</span><br/><span class="grey">mydomain.com<br/>www.mydomain.com<br/>readymag.mydomain.com</span></div>\n\n\t<div class="notfound-domain-message section">Domain’s info is not available. Please check if the name is correct. Note, that sometimes it may take few hours for subdomain to be created.</div>\n\n\t<div class="other-user-domain-message section">This domain is already used by <a class="user-button" href="TEMP" target="_blank">TEMP</a>.</div>\n\n\t\x3c!--__magterm--\x3e\n\t<div class="same-user-domain-message section">\n\t\t<span class="red">This domain is already mapped to <span class="entity-type"></span><a class="mag-button" href="TEMP" target="_blank">TEMP</a>. Do you want to switch it to '+(null==(__t="mag"==type?"the current project":"your profile")?"":__t)+'?</span>\n\t\t<div class="switch-button common-button">Yes<div class="rmpreloader"><div class="arc"></div></div></div>\n\t\t<div class="switch-cancel-button">Cancel</div>\n\t</div>\n\n\t<div class="dns-domain-message section">\n\t\t<span class="record-error red">This domain’s <span class="domain-record-type">TEMP</span><span class="domain-set-phrase"> is currently set to </span><span class="domain-set-phrase-unknown invisible"> is not currently set</span><span class="domain-current-value">TEMP</span>. Please change your <span class="domain-record-type">TEMP</span> to <span class="domain-needed-value">TEMP</span> at your registrar settings.</span><span class="ipv6-message red"><br><br>Domain cannot be mapped because of the <a href = "https://help.readymag.com/hc/en-us/articles/360021875752-SSL" target="_blank">enabled iPv6</a>.</span><br/><br/><span class="record-delay grey">After changing the <span class="domain-record-type">TEMP</span> it may take up to 72 hours to update. Please return to these settings after 72 hours and hit “Map Now”.</span>\n\t\t<div class="map-fake-button common-button disabled">Map Now</div>\n\t</div>\n\n\t\x3c!--__magterm--\x3e\n\t<div class="ok-domain-message section">\n\t\t\x3c!--<span class="green">Your domain is pointing to Readymag and can be mapped to this project.</span>--\x3e\n\t\t<span class="green">Your domain is pointing to Readymag and can be mapped to '+(null==(__t="mag"==type?"this project":"your profile")?"":__t)+'.</span>\n\t\t<div class="map-button common-button">Map Now <div class="rmpreloader"><div class="arc"></div></div></div>\n\t\t<div class="map-cancel-button">Cancel</div>\n\t</div>\n\n\t<div class="domain-readonly-block section">\n\t\t<input class="domain-readonly-input" readonly type="text" spellcheck="false" value="" placeholder="yourdomain.com" />\n\t</div>\n\n\n\t<div class="domain-setting favicon section">\n\t\t<div class="caption">\n\t\t\t<span>Favicon</span>\n\t\t</div>\n\t\t<div class="upload-button">\n\t\t\t<span>Clear</span>\n\t\t\t<input class="favicon-uploader" type="file" name="upload" data-url="/api/upload"/>\n\t\t\t<div class="favicon-preloader">\n\t\t\t\t<div class="rmpreloader">\n\t\t\t\t\t<div class="arc"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t</div>\n\t\t<div class="description">Recommended size 256px</div>\n\n\t</div>\n\n\t<div class="domain-setting ssl-setting section">\n\n\t\t<div class="caption">\n\t\t\t<span>SSL</span>\n\t\t</div>\n\n\t\t<div class="description">Secured with an SSL certificate</div>\n\t\t<div class="switcher"></div>\n\n\t</div>\n\n\t<div class="domain-register-block section">\n\t\t<input class="domain-input" type="text" spellcheck="false" value="" placeholder="iwantmyname.com" />\n\t\t<a class="go-button common-button disabled" href="https://iwantmyname.com" target="_blank">Go</a>\n\t\t<div class="register-message">\n\t\tIf you don’t have a domain name, you can<br/>\n\t\teasly purchase one via our official partner<br/>\n\t\tiwantmyname.com using the search field above<br/>\n\t\tand have it automatically set up to work<br/>\n\t\twith Readymag.</div>\n\t</div>\n\n\t<div class="domain-set-bad-message section">Seems like your DNS settings have been changed. This domain’s <span class="domain-record-type">TEMP</span><span class="domain-set-phrase"> is currently set to </span><span class="domain-set-phrase-unknown invisible"> is not currently set</span><span class="domain-current-value">TEMP</span>. Please change the <span class="domain-record-type">TEMP</span> to: <span class="domain-needed-value">TEMP</span></div>\n\n\t<div class="domain-set-notfound-message section">Domain’s info is not available. Please check if the name is correct. Note, that sometimes it may take few hours for subdomain to be created.</div>\n\n\n\t',is_contributor?__p+='\n\t<div class="expired-subscription-message section">Please upgrade owner’s account to map a custom domain.\n\t<div><a class="pricing-link" href="mailto:'+(null==(__t=owner_email)?"":__t)+'">Contact owner</a></div>\n\t</div>\n\t':__p+='\n\t<div class="expired-subscription-message section">Please <a class="link" href="/settings#change-plan">upgrade</a> your account<br/>to map a custom domain.\n\t<div><a class="pricing-link" href="/pricing" target="_blank">See the pricing</a></div>\n\t</div>\n\t',__p+='\n\n\t\x3c!--__magterm--\x3e\n\t<div class="unpublished-message section">In order to use custom domain mapping, you need to publish this project first.</div>\n\n\t<div class="confirm-message section">\n\t\t<span class="black">Are you sure you want<br/>to unmap '+(null==(__t="mag"==type?"this project":"your profile")?"":__t)+' from<br/><span class="domain-name">TEMP</span>?</span>\n\t\t<div class="confirm-unmap-button common-button">Yes<div class="rmpreloader"><div class="arc"></div></div></div>\n\t</div>\n\n\n\t<div class="error-message error-block section">\n\t\t<span class="black">Something went wrong.<br/>Please try again later.</span>\n\t\t<div class="try-again-button common-button">Ok</div>\n\t</div>\n\n\t<div class="dns-not-updated-yet error-block section">\n\t\t<span class="black">Seems like some DNS servers have not been updated yet.<br/>Please try again later.</span>\n\t\t<div class="try-again-button common-button">Ok</div>\n\t</div>\n\n\t<div class="wait-our-dns-server error-block section">\n\t\t<span class="black">Your domain settings are correct, but it seems like our DNS servers have not been updated yet.<br/>Please try again later.</span>\n\t\t<div class="try-again-button common-button">Ok</div>\n\t</div>\n\n\t\x3c!--__magterm--\x3e\n\t<div class="bottom">\n\n\t\t',"mag"==type&&(__p+='\n\t\t\t<div class="bottom-ga-gtm-active section">\n\t\t\t\t<div class="input-wrapper ga-block">\n\t\t\t\t\t<div class="caption">Google Analytics</div>\n\t\t\t\t\t<a class="info" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360020844511-Google-Analytics"></a>\n\t\t\t\t\t<input autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" type="text" name="ga_id" id="ga_id" placeholder="UA-XXXXXXX-Y">\n\t\t\t\t</div>\n\t\t\t\t<div class="input-wrapper gtm-block">\n\t\t\t\t\t<div class="caption">Google Tag Manager</div>\n\t\t\t\t\t<a class="info" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360025544812-Google-Tag-Manager"></a>\n\t\t\t\t\t<input autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" type="text" name="gtm_id" id="gtm_id" placeholder="GTM-XXXXXX">\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="bottom-ga-gtm-inactive section">\n\t\t\t\t<div class="input-wrapper ga-block">\n\t\t\t\t\t<div class="caption">Google Analytics</div>\n\t\t\t\t\t<a class="info" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360020844511-Google-Analytics"></a>\n\t\t\t\t\t<input disabled readonly type="text" name="ga_id" id="ga_id" placeholder="UA-XXXXXXX-Y">\n\t\t\t\t</div>\n\t\t\t\t<div class="input-wrapper gtm-block">\n\t\t\t\t\t<div class="caption">Google Tag Manager</div>\n\t\t\t\t\t<a class="info" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360025544812-Google-Tag-Manager"></a>\n\t\t\t\t\t<input disabled readonly type="text" name="gtm_id" id="gtm_id" placeholder="GTM-XXXXXX">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'),__p+='\n\n\n\t\t<div class="bottom-72-message section">If you don’t see '+(null==(__t="mag"==type?"your project":"your profile")?"":__t)+' or Readymag page when you visit <a class="your-site-button" href="" target="_blank">your website</a>, the DNS record might need more time to update. This can take up to 72 hours.</div>\n\n\t\t<a class="bottom-help-button section" target="_blank" href="http://help.readymag.com/hc/en-us/articles/360020588592-Domain">Need help?</a>\n\n\t\t<div class="bottom-cancel-button section">Cancel</div>\n\n\t\t<a class="bottom-support-button section" href="mailto:'+(null==(__t=Constants.SUPPORT_MAIL)?"":__t)+'">Support</a>\n\n\t\t<div class="bottom-unmap-message section">Your domain name <span class="domain-name">TEMP</span> is currently using for '+(null==(__t="mag"==type?"this project":"your profile")?"":__t)+'. <div class="unmap-button">Unmap it?</div></div>\n\t</div>\n';return __p}}},onY4:function(t,e,i){"use strict";var n=i("q1z7"),o=i.n(n),a=i("rFsW"),r=i("OTSC"),s=i("v92f"),l=i("I0kf"),c=a.a.extend({},o.a.Events,{initialize:function(t){return this.undoStacks={},this.redoStacks={},this.pendingTransactions={},this.syncManager=t,this},add:function(t,e){if(e=e||{},a.a.defaults(e,{redo:!1,undo:!1}),!e.page){var i=a.a.groupBy(t,(function(t){return t.model.getPageId()}));if(a.a.keys(i)>1)return void a.a.each(i,(function(t,i){this.add(t,e)}))}if(!e.replace){var n=e.page||t[0].model.getPageId();if(!n)return console.error("cannot save history without pageId",t);this.redoStacks[n]=this.redoStacks[n]||[],this.undoStacks[n]=this.undoStacks[n]||[];var o={widgetsOrder:RM.constructorRouter.indexController.snapshot(n),actions:t};e.undo?this.redoStacks[n].push(o):(this.undoStacks[n].push(o),e.redo||(this.redoStacks[n]=[])),this.triggerChange(n)}},transactionStart:function(t,e){e=e||{},t=a.a.isArray(t)?t:[t];var i=r.default.generateUUID();return this.pendingTransactions[i]={entry:t&&t.length?this.syncManager.getHistoryDict(this.syncManager.getChangeset(t)):[],options:e},i},addToTransaction:function(t,e){e=a.a.isArray(e)?e:[e];var i=this.pendingTransactions[t]||{};if(e&&e.length){var n=this.syncManager.getHistoryDict(this.syncManager.getChangeset(e));this.pendingTransactions[t].entry=[].concat(i.entry||[],n)}},transactionEnd:function(t){var e=this.pendingTransactions[t];e&&(this.syncManager.addHistoryStep(e.entry,e.options),delete this.pendingTransactions[t])},undo:function(t){if(!t)return console.error("cannot undo without pageId parameter");if(a.a.isEmpty(this.undoStacks[t]))return this.triggerChange(t);var e=this.undoStacks[t].pop(),i=e.actions,n={undo:!0,page:t,applySnapshot:function(){Object(l.a)("constructor.zIndex")&&RM.constructorRouter.indexController.applySnapshot(e.widgetsOrder,t)}};this.fillUndoKeys(i),this.syncManager.saveGroup(a.a.pluck(i,"attrs"),n),this.triggerUndo(t)},redo:function(t){if(!t)return console.error("cannot redo without pageId parameter");if(a.a.isEmpty(this.redoStacks[t]))return this.triggerChange(t);var e=this.redoStacks[t].pop(),i=e.actions,n={redo:!0,page:t,applySnapshot:function(){Object(l.a)("constructor.zIndex")&&RM.constructorRouter.indexController.applySnapshot(e.widgetsOrder,t)}};this.fillUndoKeys(i),this.syncManager.saveGroup(a.a.pluck(i,"attrs"),n),this.triggerRedo(t)},fillUndoKeys:function(t){a.a.each(t,(function(t){var e=t.model.toJSON();if(a.a.each(t.model.nonUndoKeys,(function(i){if(t.attrs[i]=e[i],"Widget"==t.model.name){var n=s.b.widgetViewportFields(t.model.get("type"));a.a.each(s.b.viewport_list,(function(o){e[o]&&-1!=n.indexOf(i)&&(t.attrs[o]=t.attrs[o]||{},t.attrs[o][i]=e[o][i])}))}})),!a.a.isEmpty(t.model.undoKeys)){e=t.model.toJSON();e=a.a.extend(e,t.attrs),t.attrs=e}}))},clearHistory:function(t){this.redoStacks[t]=[],this.undoStacks[t]=[],this.triggerChange(t)},triggerChange:function(t){this.trigger("change",this.getLength(t))},triggerUndo:function(t){this.trigger("undo",t)},triggerRedo:function(t){this.trigger("redo",t)},getLength:function(t){return{undo:(this.undoStacks[t]||[]).length,redo:(this.redoStacks[t]||[]).length,page:t}},setCustomHandlers:function(t){if(!this.saved){var e=RM.constructorRouter.workspace.page.id;return this.saved={undo:this.undo,redo:this.redo,getLength:this.getLength},this.undo=t.undo,this.redo=t.redo,this.getLength=t.getLength,this.triggerChange(e),{triggerChange:a.a.bind(this.triggerChange,this),triggerUndo:a.a.bind(this.triggerUndo,this),triggerRedo:a.a.bind(this.triggerRedo,this)}}},removeCustomHandlers:function(){if(this.saved){a.a.extend(this,this.saved),this.saved=void 0;var t=RM.constructorRouter.workspace.page.id;this.triggerChange(t)}},setEmptyHandlers:function(){this.setCustomHandlers({undo:function(){},redo:function(){},getLength:function(t){return{undo:0,redo:0,page:t}}})}});RM.HistoryModel=c,e.a=c},pFlR:function(t,e,i){"use strict";var n=i("QNiq"),o=i("v92f"),a=i("I0kf"),r={downscaleEnabled:Object(a.a)("constructor.customViewportWidth"),getNormalizedBox:function(t,e,i,n){return r.isOn(e,i,n)&&r.isCSSZoom()?r.getBox(t,r.getRatio(i)):t&&t.getBoundingClientRect()},getBox:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=t?t.getBoundingClientRect():{};return{top:i.top*e,left:i.left*e,width:i.width*e,height:i.height*e,bottom:i.bottom*e,right:i.right*e}},getRatio:function(t){return window.innerWidth/t},getLimitedRatio:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=window.innerWidth/t,a=e/t,r=n?i/t:1;return Math.max(Math.min(o,a),r)},isScaleLayout:function(t){return t&&t.scalableviewer},isOn:function(t,e,i){return r.isDesktopDefault(t)&&r.isScaleLayout(i)&&(r.getRatio(e)>1||r.downscaleEnabled)},isOnForRatio:function(t,e,i){return r.isDesktopDefault(t)&&r.isScaleLayout(i)&&(e>1||r.downscaleEnabled)},isCSSZoom:function(){return!Modernizr.firefox},isCSSTransform:function(){return Modernizr.firefox},isDesktopDefault:function(t){return n.a.isDesktop&&t===o.a.Default},getMinDesktopRatio:function(t){var e=o.b.dictionary[o.a.Default].min_scale_width;return r.downscaleEnabled&&t&&e?e/t:1},equals1:function(t){return Math.abs(t-1)<1e-6},normalize:function(t,e,i,n,a){if(r.equals1(t))return 1;if(r.isDesktopDefault(i)){var s=!e||"zoom"===e&&r.isCSSZoom()||"transform"===e&&r.isCSSTransform();if(r.isScaleLayout(a)&&s){var l=o.b.dictionary[o.a.Default].min_scale_width,c=l&&n?l/n:1;return Math.max(r.downscaleEnabled&&n?c:1,t)}return 1}return t}};e.a=r},phNm:function(t,e,i){"use strict";var n=i("q1z7"),o=i.n(n),a=i("rFsW"),r=i("xi34"),s=i("aCH8"),l=i.n(s),c=i("Xjjk"),d=i.n(c),h=i("Fi5S"),u=i("f3SV");i("I0kf");function p(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function m(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?p(Object(i),!0).forEach((function(e){g(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):p(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return e=t,(i=[{key:"checkProductActive",value:function(t){return t.active&&(this.productHasActiveSku(t)||this.productHasActivePrice(t))}},{key:"productHasActiveSku",value:function(t){return Array.isArray(null==t?void 0:t.articles)&&t.articles.some((function(t){return t.active}))}},{key:"productHasActivePrice",value:function(t){return t&&t.prices&&t.prices.length&&t.prices.some((function(t){return t.active}))}},{key:"mapProductsSelectList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,i=t.filter((function(t){return t.active&&(t.articles&&t.articles.length||t.prices&&t.prices.length)||e&&e===t.id})).map((function(t){return{value:t.id,caption:t.name}}));return i.unshift({value:"default",caption:"None"}),i}},{key:"getProductForAddToCart",value:function(t,e){if(!t)return null;var i=this.getActivePrice(t);if(i)return i.productObject=m(m({},t),{},{articles:null,prices:null}),i;var n=this.getSkuBySelectsValues(t,e);return n?(n.productObject=m(m({},t),{},{articles:null,prices:null}),n):null}},{key:"getActivePrice",value:function(t){return Array.isArray(t.prices)?t.prices.find((function(t){return t.active&&"per_unit"===t.billing_scheme})):null}},{key:"getSkuBySelectsValues",value:function(t,e){return t&&Array.isArray(t.articles)&&0!==t.articles.length?1===t.articles.length?t.articles[0]:t.articles.find((function(t){return JSON.stringify(t.attributes)===JSON.stringify(e)})):null}}])&&f(e.prototype,i),n&&f(e,n),t}();function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){_(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function _(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function w(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return e=t,(i=[{key:"checkProductActive",value:function(t){return Boolean(null==t?void 0:t.active)}},{key:"productHasActiveSku",value:function(t){var e=this;return(null==t?void 0:t.options)&&t.options.some((function(t){return e.isOptionValid(t)}))}},{key:"isOptionValid",value:function(t){return["SELECT","SIZE","RADIO"].includes(null==t?void 0:t.type)}},{key:"mapProductsSelectList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,i=t.map((function(t){return{value:t.id,caption:t.name}}));return i.unshift({value:"default",caption:"None"}),e&&!i.find((function(t){return t.value===e}))&&i.push({value:e,caption:"inactive product"}),i}},{key:"getProductForAddToCart",value:function(t,e){var i=y({},t);if(i&&e&&(i.selectedOptions=y({},e),Array.isArray(i.combinations))){var n=i.combinations.find((function(t){return t.options.every((function(t){return e[t.name]===t.value}))}));n&&(i.selectedCombination=y({},n))}return i}},{key:"getProductQuantity",value:function(t){var e=(null==t?void 0:t.selectedCombination)||t;return null==e?void 0:e.quantity}},{key:"isProductAvailable",value:function(t){if(null==t?void 0:t.inStock){var e=this.getProductQuantity(t);if(void 0===e||e)return!0}return!1}},{key:"countCartItemsById",value:function(t,e){var i=0;return Object.keys(e.prices).forEach((function(n){var o,a=e.prices[n];!a||a.id!==t&&(null===(o=a.selectedCombination)||void 0===o?void 0:o.id)!==t||(i+=a.cart_count||0)})),i}},{key:"isOutOfStock",value:function(t,e){if(!t)return!0;var i=this.getProductQuantity(t);if(void 0===i)return!1;var n=this.countCartItemsById(t.selectedCombination?t.selectedCombination.id:t.id,e);return!!(i&&n+1>i)}},{key:"updateCartProductItems",value:function(t,e){var i=y({},e);return i.prices={},Object.keys(e.prices).forEach((function(n){var o=e.prices[n],a=t.find((function(t){return t.id===o.id}));if(a){if(i.prices[n]=y(y({},o),a),o.selectedCombination&&a.combinations){var r=a.combinations.find((function(t){var e;return t.id===(null===(e=o.selectedCombination)||void 0===e?void 0:e.id)}));r&&(i.prices[n].selectedCombination=r)}}else o&&(i.prices[n]=y({},o))})),i}}])&&w(e.prototype,i),n&&w(e,n),t}(),S=i("LDvm");function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function O(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function j(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function P(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){j(a,n,o,r,s,"next",t)}function s(t){j(a,n,o,r,s,"throw",t)}r(void 0)}))}}function E(t){return function(t){if(Array.isArray(t))return I(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return I(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return I(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function T(t,e){return!e||"object"!==x(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t){var e="function"==typeof Map?new Map:void 0;return(M=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return $(t,arguments,D(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),R(n,t)})(t)}function $(t,e,i){return($=A()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return i&&R(o,i.prototype),o}).apply(null,arguments)}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}i.d(e,"c",(function(){return U})),i.d(e,"a",(function(){return N}));var B,L,z=function(){return{skus:{},prices:{},uniqSkusCount:0,uniqPricesCount:0,shippableProducts:0,changed:(new Date).toISOString(),order:null,provider:null}},F={out_of_stock:"Out of stock"},U={outOfStock:"outOfStock",nothingToInvoice:"nothingToInvoice"},N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(o,t);var e,i,n=(e=o,i=A(),function(){var t,n=D(e);if(i){var o=D(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return T(this,t)});function o(t,e){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(i=n.call(this,t)).type=e,i}return o}(M(Error)),H=function(t,e,i,n){RM.screenshot&&(this.page=n),this.isMagLoaded=!1,this.haveEcommerceCartWidget=!1,this.isCartSidebarHidden=!0,this.productsLoading=!1,this.productsLoaded=!1,this.productsLoadingError=!1,this.cancelingOrder=!1,this.products=null,this.storageKey="_rmcartdata",this.connectedProvider,this.environment=i,this.mag=e,this.router=t,this.events=a.a.extend({},o.a.Events),this.cartData=z(),this.cartItemsLimit=25;var r=window.navigator.language;return this.userLocale=r?r.substring(0,2):"en",this.isConstructor()?this.mag.has("_id")?this.onMagFullLoaded():h.a.once("mag:loadfull:complete",this.onMagFullLoaded,this):(this.mag.model.has("_id")&&this.onMagFullLoaded(),this.restoreBackupCartData()),this};a.a.extend(H.prototype,{ecommerceProviders:["stripe","ecwid"],CONNECTION_TIMEOUT:5e3,stripeJsSrc:"https://js.stripe.com/v3/",isConstructor:function(){return this.environment===u.a.environment.constructor},isViewer:function(){return this.environment===u.a.environment.viewer},isPreview:function(){return this.environment===u.a.environment.preview},getStorageKey:function(){return"".concat(this.storageKey,"_").concat(this.mag.num_id)},onMagFullLoaded:function(){this.isMagLoaded||(this.isMagLoaded=!0,this.haveEcommerceCartWidget=this.hasEcommerceWidget(),this.connectedProvider=this.getConnectedProvider(),this.cartData.provider=this.connectedProvider,this.connectEcommerceAdapter(),this.events.trigger("ecommerce:update:provider",this.connectedProvider),this.connectedProvider&&!this.productsLoading&&("stripe"===this.connectedProvider&&this.addStripeLibrary(),this.getProducts(this.connectedProvider)))},hasEcommerceWidget:function(){var t=this.isConstructor()?this.mag.globalWidgets:RM.screenshot?this.page.widgetsData:[].concat(E(this.mag.staticGlobalWidgetsData),E(this.mag.aboveGlobalWidgetsData));return H.hasEcommerceWidget(this.environment,t)},getEcommerceData:function(){var t=null;return this.isConstructor()?this.mag.has("ecommerce_data")&&(t=this.mag.get("ecommerce_data")):this.mag.model.has("ecommerce_data")&&(t=this.mag.model.get("ecommerce_data")),t},connectEcommerceAdapter:function(){if(this.connectedProvider)switch(this.connectedProvider){case"stripe":this.adapter=new v;break;case"ecwid":this.adapter=new k}else this.adapter=null},updateEcommerceDataFromServer:function(){var t=this;Object(S.j)(this.mag.get("num_id")).then((function(e){(null==e?void 0:e.ecommerce_data)&&(t.mag.set({ecommerce_data:e.ecommerce_data},{silent:!0}),t.connectedProvider=t.getConnectedProvider(),t.cartData.provider=t.connectedProvider,t.connectEcommerceAdapter(),t.events.trigger("ecommerce:update:provider",t.connectedProvider))}))},getStripeConnectedUserId:function(){if(!this.isMagLoaded)return null;var t=this.getEcommerceData();return t&&t.stripe&&t.stripe.stripe_data&&t.stripe.stripe_data.stripe_user_id?t.stripe.stripe_data.stripe_user_id:null},getProducts:(L=P(regeneratorRuntime.mark((function t(e){var i,n,o,a,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.productsLoading=!0,i=this.isConstructor()?this.mag.get("num_id"):this.mag.model.get("num_id"),n=this.isViewer()?"published_projects":"projects",o=RM.screenshot&&"preview"===RM.screenshotMode?"?type=preview":this.isViewer()?"?type=published":"",a="stripe"===e?"/api/".concat(n,"/").concat(i,"/ecommerce/stripe/products/"):"/api/ecommerce/".concat(i,"/").concat(e,"/products").concat(o),t.abrupt("return",r.a.ajax({type:"GET",url:a,context:this}).done((function(t){return t&&t.data&&(s.products=t.data),s.productsLoaded=!0,s.events.trigger("ecommerce:loadproducts:complete"),s.products})).fail((function(t){throw t.status,s.productsLoadingError=!0,s.events.trigger("ecommerce:loadproducts:complete"),new N("Loading products error")})).always((function(){s.productsLoading=!1})));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return L.apply(this,arguments)}),updateCartProductItems:(B=P(regeneratorRuntime.mark((function t(){var e,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=null===(e=this.adapter)||void 0===e?void 0:e.updateCartProductItems(this.products,this.cartData))){t.next=9;break}return this.cartData=i,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),t.abrupt("return",this.cartData);case 9:throw new N("Update cart data error");case 10:case"end":return t.stop()}}),t,this)}))),function(){return B.apply(this,arguments)}),addStripeLibrary:function(){if(!(this.isConstructor()||window.Stripe&&window.Stripe.version)){var t=document.createElement("script"),e=document.getElementsByTagName("body")[0];t.setAttribute("async","async"),t.setAttribute("src",this.stripeJsSrc),e.appendChild(t)}},getConnectedProvider:function(){var t,e=this;return this.ecommerceProviders.forEach((function(i){e.isMagConnectedTo(i)&&(t=i)})),t},isMagConnectedTo:function(t){if(!this.isMagLoaded)return!1;if(!this.ecommerceProviders.includes(t))return!1;var e=this.getEcommerceData();return!!e&&Boolean(e[t]&&e[t].status&&"connected"===e[t].status)},canBeConnectedTo:function(t){if(!this.isConstructor())return!1;var e=this.getConnectedProvider();return!e||t===e},connectToStripe:function(){return new Promise(function(t,e){window.open("/api/connect/ecommerce/stripe/connect?num_id="+this.mag.get("num_id"),"_blank"),this.initSocket().then(function(e){this.mag.set({ecommerce_data:e},{silent:!0}),t()}.bind(this)).catch((function(t){e(t)}))}.bind(this))},disconnectFrom:function(t){return new Promise(function(e,i){r.a.ajax({type:"GET",url:"/api/connect/ecommerce/".concat(t,"/disconnect?num_id=").concat(this.mag.get("num_id")),success:function(i){if(i&&i.status){this.products=null;var n=this.getEcommerceData();n[t]||(n[t]={}),n[t]=i,this.mag.set({ecommerce_data:n},{silent:!0})}e(i)},error:function(t){i(t)},context:this})}.bind(this))},getTextValue:function(t){var e,i=this.getEcommerceData(),n=null==i||null===(e=i.texts)||void 0===e?void 0:e[t];return n?d()(n):F[t]},saveTextValue:function(t,e){var i=this.getEcommerceData();i.texts||(i.texts={});var n=e||F[t];i.texts[t]=n,this.mag.save({ecommerce_data:i},{patch:!0})},initSocket:function(){return new Promise(function(t,e){var i=window.location.origin===u.a.readymag_auth_host&&u.a.stripe_live?"sockets.readymag.com/stripe-auth":"/stripe-auth",n=io(i,{timeout:this.CONNECTION_TIMEOUT});n.on("connect",function(){n.emit("wainting for mag stripe auth update",{num_id:this.mag.get("num_id"),user:this.router.me.pick("name","email","_id"),hash:this.mag.get("socket_hash")}),n.on("state-update",(function(i){n.disconnect(),i.error?e(i.error):t(i.ecommerce_data)}))}.bind(this))}.bind(this))},checkCartDisabledControls:function(){if(this.haveEcommerceCartWidget){var t=this.getEcommerceCartBlock(),e=this.getEcommerceData();t&&t.checkDisabledControls(e.stripe&&e.stripe.status&&"connected"===e.stripe.status)}},getEcommerceCartBlock:function(){return this.haveEcommerceCartWidget&&this.isConstructor()?this.router.workspace.findBlockByFunction((function(t){return t.attributes.type===u.a.ecommerceCartBlockName})):null},getCartWidgetData:function(){if(!this.isConstructor()){var t=this.mag.staticGlobalWidgetsData.find((function(t){return t.type===u.a.ecommerceCartBlockName}));return t||this.mag.aboveGlobalWidgetsData.find((function(t){return t.type===u.a.ecommerceCartBlockName}))}return null},getProductsLikeOptionsList:function(t){return this.products&&this.adapter?this.adapter.mapProductsSelectList(this.products,t):[]},checkProductActive:function(t){if(t){var e=this.getProductById(t);if(e)return!!this.adapter&&this.adapter.checkProductActive(e)}},productHasActiveSku:function(t){return!(!t||!this.adapter)&&this.adapter.productHasActiveSku(t)},isOptionValid:function(t){return this.adapter&&this.adapter.isOptionValid(t)},isSkuAvailable:function(t){return!!t.active&&("infinite"===t.inventory.type||("finite"===t.inventory.type&&t.inventory.quantity>0||"bucket"===t.inventory.type&&("in_stock"===t.inventory.value||"limited"===t.inventory.value)))},getProductById:function(t){return this.products&&Array.isArray(this.products)?this.products.find((function(e){return e.id===t})):null},getProductsStatus:function(){return this.productsLoading?"loading":this.productsLoaded?"loaded":"failed"},getSkusByProductId:function(t){var e=this.getProductById(t);return e?e.articles:null},getFirstAvailableSku:function(t){return t?t.find(function(t){return this.isSkuAvailable(t)}.bind(this)):null},getFirstAvailableSkuForProductId:function(t){return this.getFirstAvailableSku(this.getSkusByProductId(t))},changeCartSidebarVisibility:function(){return this.isCartSidebarHidden=!this.isCartSidebarHidden,h.a.trigger("ecommerce:cartsidebar:visibility:changed",this.isCartSidebarHidden),this.isCartSidebarHidden},checkItemQuantity:function(t){if("string"!=typeof t){var e=t;return!!("infinite"===e.inventory.type||"finite"===e.inventory.type&&e.inventory.quantity||"bucket"===e.inventory.type&&"out_of_stock"!==e.inventory.value)}if(this.cartData.skus[t]){var i=this.cartData.skus[t];return"infinite"===i.inventory.type||"finite"===i.inventory.type&&i.cart_count<i.inventory.quantity||"bucket"===i.inventory.type&&"out_of_stock"!==i.inventory.value}return!1},checkItemQuantityOnUpdate:function(t){if(this.cartData.skus[t]){var e=this.cartData.skus[t];return"infinite"===e.inventory.type||"finite"===e.inventory.type&&e.cart_count<=e.inventory.quantity||"bucket"===e.inventory.type&&"out_of_stock"!==e.inventory.value}return!1},getCartData:function(){return this.cartData},markCartChange:function(){this.cartData.changed=(new Date).toISOString()},isProductAvailable:function(t){var e;return null===(e=this.adapter)||void 0===e?void 0:e.isProductAvailable(t)},isOutOfStock:function(t){var e;return null===(e=this.adapter)||void 0===e?void 0:e.isOutOfStock(t,this.cartData)},getProductForAddToCart:function(t,e){var i;return null===(i=this.adapter)||void 0===i?void 0:i.getProductForAddToCart(t,e)},addProductToCart:function(t){switch(t.object){case"price":return this.addPriceToCart(t);case"product":return this.addEcwidToCart(t);case"sku":return this.addSkuToCart(t);default:return new N("provider not found")}},addSkuToCart:function(t){if(!t||!t.id)return new N("Sku data isn't valid or doesn’t have an id");if(this.cartData.skus[t.id]){if(!this.checkItemQuantity(t.id))return new N("You can’t add this product with attribute "+t.id+". It's out of stock",U.outOfStock);this.cartData.skus[t.id]=Object.assign({},t,{cart_count:this.cartData.skus[t.id].cart_count+1})}else{if(this.cartData.uniqSkusCount+1>this.cartItemsLimit)return new N("You can’t add more than "+this.cartItemsLimit+" items to the cart");if(!this.checkItemQuantity(t))return new N("You can’t add this product with attribute "+t.id+". It's out of stock",U.outOfStock);this.cartData.skus[t.id]=Object.assign({},t,{cart_count:1}),this.cartData.uniqSkusCount+=1,t.productObject.shippable&&(this.cartData.shippableProducts+=1)}return this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),this.cartData},addPriceToCart:function(t){if(!t||!t.id||!t.active)return new N("Price data isn't valid or doesn’t have an id");if(this.cartData.prices[t.id])this.cartData.prices[t.id]=Object.assign({},t,{cart_count:this.cartData.prices[t.id].cart_count+1});else{if(this.cartData.uniqPricesCount+1>this.cartItemsLimit)return new N("You can’t add more than "+this.cartItemsLimit+" items to the cart");this.cartData.prices[t.id]=Object.assign({},t,{cart_count:1}),this.cartData.uniqPricesCount+=1}return this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),this.cartData},addEcwidToCart:function(t){if(!t||!t.id)return new N("Product data isn't valid or doesn’t have an id");var e=this.getCartItenKey(t);return this.isProductAvailable(t)?this.isOutOfStock(t)?new N("You can’t add more product ".concat(t.id," items to the cart"),U.outOfStock):(this.cartData.prices[e]?this.cartData.prices[e].cart_count+=1:(this.cartData.prices[e]=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?C(Object(i),!0).forEach((function(e){O(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):C(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({cart_count:1},t),this.cartData.uniqPricesCount+=1),this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData),this.cartData):new N("You can’t add this product ".concat(t.id,". It's out of stock"),U.outOfStock)},getCartItenKey:function(t){return"product"===t.object&&t.selectedOptions&&Object.keys(t.selectedOptions).length>0?l()("".concat(t.id,"-").concat(JSON.stringify(t.selectedOptions))):t.id},increaseCartItem:function(t){this.cartData.prices[t]&&(this.cartData.prices[t].cart_count+=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},increaseSkuCartItem:function(t){if(this.cartData.skus[t]){if(!this.checkItemQuantity(t))return new N("You can’t add more this product with attribute "+t+". It's out of stock",U.outOfStock);this.cartData.skus[t].cart_count+=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData)}},decreaseCartItem:function(t){this.cartData.prices[t]&&this.cartData.prices[t].cart_count>1&&(this.cartData.prices[t].cart_count-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},decreaseSkuCartItem:function(t){this.cartData.skus[t]&&this.cartData.skus[t].cart_count>1&&(this.cartData.skus[t].cart_count-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},removeFromCart:function(t){this.cartData.prices[t]&&(delete this.cartData.prices[t],this.cartData.uniqPricesCount-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},removeSkuFromCart:function(t){this.cartData.skus[t]&&(this.cartData.skus[t].productObject.shippable&&(this.cartData.shippableProducts-=1),delete this.cartData.skus[t],this.cartData.uniqSkusCount-=1,this.markCartChange(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData))},clearCart:function(){this.cartData=z(),this.backupCartData(),this.events.trigger("ecommerce:cartdata:changed",this.cartData)},updateCartSkus:function(t){var e=this,i=[];if(t.forEach((function(t){e.cartData.skus[t.id]&&(e.cartData.skus[t.id]=Object.assign({},e.cartData.skus[t.id],t),e.checkItemQuantityOnUpdate(t.id)||i.push(e.cartData.skus[t.id].productObject.name))})),this.backupCartData(),i.length)return i},updateCartData:function(){return new Promise(function(t,e){this.cartData&&this.cartData.skus||e(new N("Empty cart"));var i=[];for(var n in this.cartData.skus)this.cartData.skus.hasOwnProperty(n)&&i.push(n);var o=i.length?a.a.uniq(i).join(","):null;r.a.ajax({type:"GET",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/skus/"+(o?"?skus_ids="+o:""),contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(i&&i.data){var n=this.updateCartSkus(i.data);if(n){var o=n.length>1;e(new N("This item".concat(o?"s":""," cannot be used to create an order: ").concat(n.join(", ")," ").concat(o?"are":"is"," out of stock"),U.outOfStock))}t(this.cartData)}}.bind(this),error:function(){e(new N("Error occurred while updating the skus:",i))}})}.bind(this))},hasShippableProducts:function(){return!!this.cartData.shippableProducts||!!this.cartData.uniqPricesCount},setShippingForm:function(t){this.cartData.shippingForm=a.a.cloneWithObjects(t),this.markCartChange(),this.backupCartData()},getShippingForm:function(){return a.a.cloneWithObjects(this.cartData.shippingForm)},getShippingOptions:function(){return this.cartData.order&&this.cartData.order.shipping_methods?this.cartData.order.shipping_methods.map((function(t){return{id:t.id,label:t.description,amount:t.amount}})):null},setOrder:function(t){this.cartData.order=t,this.backupCartData()},getOrder:function(){return this.cartData.order},deleteOrder:function(){this.cartData.order=null,this.backupCartData()},cancelOrder:function(){return this.changeOrder({status:"canceled"})},changeShippingMethod:function(t){return this.changeOrder({selected_shipping_method:t})},changeOrder:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(e,i){this.cartData.order||i(new N("No order")),this.cancelingOrder&&i(),this.cancelingOrder=!0,r.a.ajax({type:"PATCH",url:"/api/projects/"+this.mag.num_id+"/ecommerce/stripe/orders/"+this.cartData.order.id+"/",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){this.cancelingOrder=!1,e(t)}.bind(this),error:function(t){this.cancelingOrder=!1,i(new N(t.responseText))}})}.bind(this))},setCustomer:function(t){this.cartData.customer=t,this.backupCartData()},createOrUpdateCustomer:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/customers/"),data:JSON.stringify({customer_data:e}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){i(t)},error:function(t){n(new N(t.responseText))}})}))},getCustomer:function(){return this.cartData.customer},setInvoiceItems:function(t){this.cartData.invoiceItems=t,this.backupCartData()},unsetInvoiceItems:function(){delete this.cartData.invoiceItems,this.backupCartData()},createInvoiceItems:function(t,e,i){return new Promise((function(n,o){r.a.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoice_items/"),data:JSON.stringify({customer_id:e,prices:i}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){n(t)},error:function(t){o(new N(t.responseText))}})}))},setInvoice:function(t){this.cartData.invoice=t,this.backupCartData()},unsetInvoice:function(){delete this.cartData.invoice,this.backupCartData()},createInvoice:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/"),data:JSON.stringify({invoiceData:e}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){i(t)},error:function(t){t.responseJSON&&"invoice_no_customer_line_items"===t.responseJSON.code?n(new N(t.responseJSON.message,U.nothingToInvoice)):n(new N(t.responseText))}})}))},getInvoice:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"GET",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new N("Not valid response, getInvoice"))},error:function(t){n(new N(t.responseText))}})}))},deleteDraftInvoice:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"DELETE",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new N("Not valid response"))},error:function(t){n(new N(t.responseText))}})}))},voidDraftInvoice:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/void/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new N("Not valid response"))},error:function(t){n(new N(t.responseText))}})}))},finalizeInvoice:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"POST",url:"/api/projects/".concat(t,"/ecommerce/stripe/invoices/").concat(e,"/finalize/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new N("Not valid response"))},error:function(t){n(new N(t.responseText))}})}))},getPaymentIntent:function(t,e){return new Promise((function(i,n){r.a.ajax({type:"GET",url:"/api/projects/".concat(t,"/ecommerce/stripe/payment_intents/").concat(e,"/"),contentType:"application/json; charset=utf-8",success:function(t){t&&t.data?i(t.data):n(new N("Not valid response"))},error:function(t){n(new N(t.responseText))}})}))},updatePaymentIntent:function(t,e,i){return new Promise((function(n,o){r.a.ajax({type:"PATCH",url:"/api/projects/".concat(t,"/ecommerce/stripe/payment_intents/").concat(e,"/"),contentType:"application/json; charset=utf-8",data:JSON.stringify({paymentIntentData:i}),dataType:"json",success:function(t){t&&t.data?n(t.data):o(new N("Not valid response"))},error:function(t){o(new N(t.responseText))}})}))},validateCartData:function(t){return!(!t||"object"!==x(t)||isNaN(Date.parse(t.changed))||isNaN(Date.parse(t.backuped))||"number"!=typeof t.uniqSkusCount||"number"!=typeof t.uniqPricesCount||"object"!==x(t.skus)||"object"!==x(t.prices)||"object"!==x(t.order)&&null!==t.order)},getInvalidAddToCartWidgets:function(){var t=this.mag.getAllWidgets().filter((function(t){return"addtocart"===t.type&&!t.hidden}));if(!t||!t.length)return[];var e=this.products?this.products.map((function(t){return t.id})):[];return t.filter((function(t){return!t.selected_product_id||!e.includes(t.selected_product_id)}))},restoreBackupCartData:function(){if(Modernizr.localstorage){var t=localStorage.getItem(this.getStorageKey());if(t){var e=JSON.parse(t);if(!e.provider||e.provider!==this.connectedProvider)return void this.clearBackup();var i=((Date.now()-Date.parse(e.backuped))/1e3/60/60).toFixed(2);this.validateCartData(e)&&i<=24?this.cartData=e:this.clearBackup()}}},backupCartData:function(){Modernizr.localstorage&&(this.cartData.backuped=(new Date).toISOString(),localStorage.setItem(this.getStorageKey(),JSON.stringify(this.cartData)))},clearBackup:function(){Modernizr.localstorage&&localStorage.removeItem(this.getStorageKey())}}),H.hasEcommerceWidget=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t===u.a.environment.constructor?Boolean(e.find((function(t){return t.get("type")===u.a.ecommerceCartBlockName}))):Boolean(e.find((function(t){return t.type===u.a.ecommerceCartBlockName})))};e.b=H},q5gH:function(t,e,i){"use strict";var n,o=i("xi34"),a=i("q1z7"),r=i.n(a),s=i("rFsW"),l=i("m41J"),c=i("OTSC"),d=i("Fi5S"),h=i("q7tt"),u=i("I0kf"),p=i("/Sry"),m=r.a.View.extend({minwidth:1,minheight:1,maxwidth:9999,maxheight:9999,FLIP_H:{ne:"nw",n:"n",nw:"ne",w:"e",sw:"se",s:"s",se:"sw",e:"w"},FLIP_V:{sw:"nw",s:"n",se:"ne",e:"e",ne:"se",n:"s",nw:"sw",w:"w"},DOTS:["nw","n","ne","e","se","s","sw","w"],DOTS_POS_X:[0,.5,1,1,1,.5,0,0],DOTS_POS_Y:[0,0,0,.5,1,1,1,.5],FIXED_DOTS:{nw:"se",n:"sw",ne:"sw",e:"nw",se:"nw",s:"nw",sw:"ne",w:"ne"},initialize:function(t){s.a.bindAll(this),n=i("dptL").WidgetPack,this.block=t.block,this.setElement(this.block.$el),this.$dots=this.$(".dot"),this.$triangles=this.$(".triangle"),this.$dots.drag("start",this.onDotDragStart).drag(this.onDotDrag).drag("end",this.onDotDragEnd),this.$triangles.on("mouseenter",this.onTriangleMouseEnter).drag("start",this.onTriangleDragStart).drag(this.onTriangleDrag).on("mouseleave",this.onTriangleMouseLeave).drag("end",this.onTriangleDragEnd),this.recalcDotsSizes({pageX:0,pageY:0}),this.mouseProceeding=!0,this.listenTo(this.block,"textWidgetMouseSelectionStart",this.disableMouseProceeding),this.listenTo(this.block,"textWidgetMouseSelectionEnd",this.enableMouseProceeding),this.listenTo(this.block,"textWidgetMarginDragStart",this.disableMouseProceeding),this.listenTo(this.block,"textWidgetMarginDragEnd",this.enableMouseProceeding),this.onSizeInputChangeStart.__debounced=s.a.debounce(this.onSizeInputChangeStart,200,!0),this.onSizeInputChangeEnd.__debounced=s.a.debounce(this.onSizeInputChangeEnd,200)},disableMouseProceeding:function(){this.$dots.animate({width:0,height:0,margin:0},"fast"),this.mouseProceeding=!1},enableMouseProceeding:function(){this.mouseProceeding=!0},show:function(t){this.$el.addClass("frame"),t&&this.$el.addClass("frameWB"),this.bindMouseMove(),this.mouseProceeding=!0,this.frameVisible=!0,this.recalcPointsDirections(),this.showSizes(),this.isRedBorderNeeded()&&this.checkHeightOfTextWidget()},hide:function(){this.$el.removeClass("frame"),this.$el.removeClass("frameWB"),this.unbindMouseMove(),this.frameVisible=!1,this.hideSizes()},isFrameVisible:function(){return this.frameVisible},bindMouseMove:function(){Object(o.a)(window).on("mousemove",this.recalcDotsSizes)},unbindMouseMove:function(){Object(o.a)(window).off("mousemove",this.recalcDotsSizes)},showSizes:function(){this.areSizesShown||!this.canChangeDimension("width")&&!this.canChangeDimension("height")||this.block.has_parent_block||(this.$el.children(".frameborder").after('<div id="sizes_input">'),this.sizes=new RM.vue.Sizes({el:"#sizes_input",propsData:{block:this.block,frame:this,zoom:RM.constructorRouter.zoom.getZoom()}}),this.sizes.$on("beforeChange",this.onSizeInputChangeStart.__debounced),this.sizes.$on("afterChange",this.onSizeInputChangeEnd.__debounced),this.sizes.$on("change",this.onSizeInputChange),this.areSizesShown=!0,d.a.trigger("sizes:shown"))},hideSizes:function(){this.sizes&&this.areSizesShown&&(this.sizes.$destroy(),this.sizes.$el.remove(),this.areSizesShown=!1,d.a.trigger("sizes:hidden"))},onSizeInputChangeStart:function(){this.onResizeStart()},onSizeInputChangeEnd:function(){this.block.saveBox(),this.onResizeEnd()},onSizeInputChange:function(t,e){this.block.recalcFixedLine(),this.block.recalcStickedLine(),this.doResize(t,!1,e)},setResizeBottomPlus:function(t){this.$el.toggleClass("resize-bottom-plus",t),1!==this.block.model.get("column_count")||this.block.$el.hasClass("text-autosize")||this.checkHeightOfTextWidget()},setEditorState:function(){this.block.workspace.disableDragging=!0,this.$el.addClass("editor-state"),this.resetRotation()},removeEditorState:function(){this.$el.removeClass("editor-state"),this.block.workspace.disableDragging=!1,this.restoreRotation(),this.block.css()},setRotationState:function(){this.rotationState||(this.rotationState=!0,this.$el.addClass("rotation-state"),this.block.workspace.redrawBottomShiftLine({tp:"rotation"}))},removeRotationState:function(){this.rotationState&&(this.rotationState=!1,this.$el.removeClass("rotation-state"),this.block.workspace.redrawBottomShiftLine({tp:"rotation"}))},resetRotation:function(){var t=s.a.pick(this.block.latestPosSizeAngle,"angle","flip_h","flip_v");(t.angle||t.flip_h||t.flip_v)&&(this.block.$el.flashClass("transitions",500),this.block.forbidVisualRotation=!0,this.block.css(),this.recalcPointsDirections())},restoreRotation:function(){this.block.forbidVisualRotation&&(this.block.$el.flashClass("transitions",500),this.block.forbidVisualRotation=!1,this.block.css(),this.recalcPointsDirections())},recalcDotsSizes:function(t){if(this.mouseProceeding){var e=this.block.getBoxData({includeRotationData:!0,checkFixedPosition:!0}),i=t.pageX/RM.constructorRouter.zoom.getZoom(),n=t.pageY/RM.constructorRouter.zoom.getZoom(),o=99999,a=0,r=0,s=0,l=this.$el.parent().offset(),c=e.x+l.left,d=e.y+l.top,h=e.w,u=e.h,p=this.$el.hasClass("editor-state"),m=[-13,0,14,14,14,0,-13,-13],g=[-13,-13,-13,0,14,14,14,0],f=["left","left","right","right","right","left","left","left"],v=["top","top","top","top","bottom","bottom","bottom","top"],b=this.block.latestPosSizeAngle.sinAngle,y=this.block.latestPosSizeAngle.cosAngle,_=this,w={},k=0,S=0,x=0,C=0,O=-1,j=99999999,P=0,E=-1;if(this.block.model.get("fixed_position")){var I=this.$el.offset();c=I.left,d=I.top}var T=h<=this.block.SUPER_SMALL_TRESHOLD&&u<=this.block.SUPER_SMALL_TRESHOLD;if(T?(k=[-1,-1,1,1,1,0,-1,-1][a=this.lastResizePointIndex||4],S=[-1,-1,-1,-1,1,1,1,-1][a]):this.$dots.each((function(){var t=c+h*_.DOTS_POS_X[s]+(p?m[s]:0),r=d+u*_.DOTS_POS_Y[s]+(p?g[s]:0);if((e.angle||e.flip_v||e.flip_h)&&!_.block.forbidVisualRotation){var l=c+h/2,f=d+u/2,v=t-l,w=f-r,k=e.flip_h?-v:v,S=e.flip_v?-w:w;t=l+y*k+b*S,r=f+b*k-y*S}var I=Math.sqrt(Math.pow(t-i,2)+Math.pow(r-n,2))-13;I<o&&(o=I,a=s),(r>C&&Math.abs(r-C)>.5||Math.abs(r-C)<.5&&s%2==1)&&(C=r,O=s,x=t),(r<j&&Math.abs(r-j)>.5||Math.abs(r-j)<.5&&s%2==1)&&(j=r,E=s,P=t),s++})),O===a||E===a){j-=20,C+=20;var M=E===a?P:x,$=E===a?j:C,A=Math.sqrt(Math.pow(M-i,2)+Math.pow($-n,2))-13;A<o&&(o=A)}r=(r=T?13:(70-o)/70*12+1)<2?0:r>13?13:2*Math.floor(r/2)+1,this.denyRecalcDotSize||(this.$dots.attr("style",""),this.$triangles.attr("style","")),w.width=r,w.height=r,w["margin-"+f[a]]=T?-10:-Math.floor(r/2)+k,w["margin-"+v[a]]=T?-10:-Math.floor(r/2)+S;var R=["left","","right","right","right","","left","left"],D=["top","top","top","","bottom","bottom","bottom",""],B=Math.min(1,Math.max(70-o,0)/70),L=(Math.floor(19*B/2),Math.floor(17*B/2),{transform:"scale("+B+") rotateZ("+-this.block.latestPosSizeAngle.angle+"deg)"});this.block.frameColor&&(w["background-color"]=this.block.frameColor,L["border-top-color"]=this.block.frameColor,L["border-color"]=this.block.frameColor);var z=this.block.latestPosSizeAngle.angle>0?this.block.latestPosSizeAngle.angle:360+this.block.latestPosSizeAngle.angle;z>90&&z<180&&(z=180-z),z>270&&z<360&&(z=360-z);var F=Math.sin(z%180/180*Math.PI),U=Math.cos(z%180/180*Math.PI),N=this.$dots.eq(a),H=O===a?12:8;""===R[a]?L.left="calc(50% - 9px)":L[R[a]]=-9,""===D[a]?L.top="calc(50% - 8px)":L[D[a]]=-8,L["margin-"+f[a]]=-Math.floor((H+r)*F),L["margin-"+v[a]]=-Math.floor((H+r)*U),this.denyRecalcDotSize||(N.css(w),O!==a&&E!==a||this.block.model.get("fixed_position")||!this.block.workspace||"basic"===this.block.workspace.page.get("type")||!(O===a&&this.$el.hasClass("bundle-allow-bottom")||E===a&&this.$el.hasClass("bundle-allow-top"))||this.$triangles.eq(a).css(L).data("bundle-align",O===a?"bottom":"top"))}},recalcPointsDirections:function(){var t=this.block.getBoxData({includeRotationData:!0}),e=this.block.forbidVisualRotation?0:-t.angle,i=Math.floor((e+360+22.5)/45)%8;this.$dots.each(s.a.bind((function(e,n){var a=this.DOTS[e];t.flip_v&&!this.block.forbidVisualRotation&&(a=this.FLIP_V[a]),t.flip_h&&!this.block.forbidVisualRotation&&(a=this.FLIP_H[a]),a=this.DOTS[(s.a.indexOf(this.DOTS,a)-i+8)%8],Object(o.a)(n).attr("data-visual-direction",a)}),this))},onDotDragStart:function(){if(this.rotationState)return this.onRotateStart.apply(this,arguments);this.onResizeStart.apply(this,arguments)},onDotDrag:function(){if(this.rotationState)return this.onRotate.apply(this,arguments);this.onResize.apply(this,arguments),Object(u.a)("constructor.distance")&&this.block.workspace.distance.update([this.block])},onDotDragEnd:function(){if(this.rotationState)return this.onRotateEnd.apply(this,arguments);this.block.workspace.checkBundleDragAbility(),this.onResizeEnd.apply(this,arguments),Object(u.a)("constructor.distance")&&this.block.workspace.distance.hide()},onTriangleMouseEnter:function(t){var e=Object(o.a)(t.currentTarget);RM.constructorRouter.trigger("notice:triggerMetrics",p.a.BundleDragHovered),this.block.workspace._inTriangleBundleDrag||this.denyRecalcDotSize||this.block.workspace.checkBundleDragMode(t,e.data("bundle-align"))},onTriangleMouseLeave:function(t){this.block.workspace._inTriangleBundleDrag||this.denyRecalcDotSize||this.block.workspace.checkBundleDragMode(t,!0)},onTriangleDragStart:function(t){if(this.rotationState)return this.onRotateStart.apply(this,arguments);var e=Object(o.a)(t.currentTarget);this.denyRecalcDotSize=!0,e.addClass("moved"),this.block.workspace._inTriangleBundleDrag=!0,this.block.workspace.checkBundleDragMode(t,e.data("bundle-align")),this.block.workspace.$el.addClass("bundle-drag-cursor"),this.block.onDragStart.apply(this.block,arguments)},onTriangleDrag:function(){if(this.rotationState)return this.onRotate.apply(this,arguments);this.block.onDragMove.apply(this.block,arguments)},onTriangleDragEnd:function(t){if(this.rotationState)return this.onRotateEnd.apply(this,arguments);this.block.workspace._inTriangleBundleDrag=!1;var e=Object(o.a)(t.currentTarget);e.removeClass("moved"),this.denyRecalcDotSize=!1,this.block.workspace.checkBundleDragMode(t,!0),this.block.workspace.$el.removeClass("bundle-drag-cursor"),this.block.onDragEnd.apply(this.block,arguments),RM.analytics&&RM.analytics.sendEvent("Bundle drag","Triangle moved")},onResizeStart:function(t,e,i){i=i||{},this.block.storeFixedPosition(),Object(o.a)("html").addClass("blocks-is-resizing"),this.denyRecalcDotSize=!0,this.$el.find(".frameborder").css("outline","1px solid transparent"),Object(o.a)("html").removeClass("alt-key-pressed"),this._dragEvent=t,this.block.workspace.on("specialKeydown specialKeyup",this.onSpecialKey),!RM.constructorRouter.gg.snap||this.block.model.get("fixed_position")||i.isGroupResize||RM.constructorRouter.gg.handleMoveStart(this.block instanceof n?this.block.blocks:[this.block]),this.block.onResizeStart&&this.block.onResizeStart(t,e),t&&(this.currentResizePoint=["nw","n","ne","e","se","s","sw","w"][Object(o.a)(t.currentTarget).attr("data-ind")]),this.block.workspace.widgetResizingOrRotating=!0,t&&(this.lastResizePointIndex=parseInt(Object(o.a)(t.currentTarget).attr("data-ind"))||0),e&&(e.scrollTop=this.block.workspace.$container.scrollTop())},customResizeHandler:function(t,e){return t},applyExtraConstraints:function(t,e){var i=this.block.getFullWidthDims(),n=this.block.getFullHeightDims();return this.block.model.get("is_full_width")&&s.a.extend(t,{left:i.x,width:i.w}),this.block.model.get("is_full_height")&&s.a.extend(t,{top:n.y,height:n.h}),t},applyConstraints:function(t,e){return e=s.a.extend({direction:"se",fromCenter:!1,isSidePointProportional:!1,currentResizePoint:this.currentResizePoint,isProportional:this.block.proportional,initialBox:this.block.getModelBox(),constraints:this.constraints,minwidth:this.minwidth,minheight:this.minheight,maxwidth:this.maxwidth,maxheight:this.maxheight,ratio:this.block.ratio,aspect:this.block.model.get("aspect")},e),m.applyConstraintsAbstract.apply(this,[t,e,this.applyExtraConstraints.bind(this)])},onRotateStart:function(t,e){this.block.storeFixedPosition();var i=this.block.getBoxData({includeRotationData:!0}),n=this.$el.parent().offset(),a=RM.constructorRouter.zoom.getZoom();this.rotationData={center:{x:i.x+n.left+i.w/2,y:i.y+n.top+i.h/2},x:t.pageX/a,y:t.pageY/a,initialAngle:i.angle,prevAngle:i.angle},Object(o.a)("body").addClass("grabbing-cursor"),this.block.workspace.widgetResizingOrRotating=!0},onRotate:function(t,e){var i,n,o,a,r,s,l,c=this.rotationData,d=RM.constructorRouter.zoom.getZoom();i={x:t.pageX/d-c.center.x,y:t.pageY/d-c.center.y},n={x:c.x-c.center.x,y:c.y-c.center.y},l=i.x*n.y-i.y*n.x<0?-1:1,o=(o=(i.x*n.x+i.y*n.y)/(Math.sqrt(i.x*i.x+i.y*i.y)*Math.sqrt(n.x*n.x+n.y*n.y)))>1?1:o,a=l*Math.acos(o)/Math.PI*180,r=c.prevAngle-a,s=t.shiftKey?15*Math.floor(r/15)+c.initialAngle%15:r,r=(r=r>=360?r-360:r)<=-360?r+360:r,s=(s=s>=360?s-360:s)<=-360?s+360:s,s=Math.floor(s),this.block.css({angle:s}),this.block.trigger("rotate",{angle:s}),this.block.model.set({angle:s}),c.x=t.pageX/d,c.y=t.pageY/d,c.prevAngle=r},onRotateEnd:function(t,e){Object(o.a)("body").removeClass("grabbing-cursor"),this.block.workspace.widgetResizingOrRotating=!1,this.block.restoreFixedPosition(),this.block.workspace.checkBundleDragAbility()},checkHeightOfTextWidget:function(t){var e=this.block.getAllowableHeight(),i=t?t.height:this.block.getModelBox().height;t&&s.a.contains(["sw","se","s"],this.currentResizePoint)&&this.stickBtmBorderOfText(e,t),this.$el.find(".frameborder").toggleClass("red-border",i<e)},stickBtmBorderOfText:function(t,e){var i,n=m.ceilObject({width:e.width,top:e.top,left:e.left});Math.abs(e.height-t)<8&&(n.height=t,i=this.customResizeHandler(o.a.extend(i,n),this.currentResizePoint),this.block.css(i,this.currentResizePoint))},onResize:function(t,e){e.deltaX=e.deltaX/RM.constructorRouter.zoom.getZoom(),this.block._saveXHR&&(this.block._saveXHR.abort&&this.block._saveXHR.abort(),delete this.block._saveXHR);var i=this.block.workspace,a=this.block instanceof n?this.block.blocks:[this.block];!i||this.block instanceof n||h.a.prototype.collectBottomBloсks(i,a,t);var r=this.block.resizeFromCenter||t.altKey,d=t.shiftKey;if(this._dragEvent=t,!Object(o.a)("html").hasClass("blocks-is-moving")){var u=e.startY+e.scrollTop,p=t.pageY+this.block.workspace.$container.scrollTop();e.deltaY=(p-u)/RM.constructorRouter.zoom.getZoom(),c.default.autoWindowScroll(t,this.block.workspace.$container,s.a.bind((function(){this.onResize(t,e)}),this));var g=this.block.getModelBox(),f=s.a.clone(g),v=this.block.latestPosSizeAngle.sinAngle,b=this.block.latestPosSizeAngle.cosAngle,y=this.block.getBoxData({includeRotationData:!0}),_=e.deltaX,w=e.deltaY;if(y.angle&&!this.block.forbidVisualRotation){var k=b*e.deltaX+v*e.deltaY,S=-v*e.deltaX+b*e.deltaY;e.deltaY=S,e.deltaX=k}var x=this.DOTS[Object(o.a)(t.currentTarget).attr("data-ind")];y.flip_v&&!this.block.forbidVisualRotation&&(x=this.FLIP_V[x]),y.flip_h&&!this.block.forbidVisualRotation&&(x=this.FLIP_H[x]);var C=s.a.contains(["w","e","n","s"],x)&&Boolean(d||this.block.proportional);if(x=this.modifyOnShift(t,e,g,{direction:x,isSidePointProportional:C}),r){switch(x){case"nw":case"ne":case"n":g.top+=e.deltaY,g.height-=2*e.deltaY;break;case"sw":case"se":case"s":g.top-=e.deltaY,g.height+=2*e.deltaY}switch(x){case"nw":case"sw":case"w":g.left+=e.deltaX,g.width-=2*e.deltaX;break;case"se":case"ne":case"e":g.left-=e.deltaX,g.width+=2*e.deltaX}}else{switch(x){case"nw":case"ne":case"n":g.top+=e.deltaY,g.height-=e.deltaY;break;case"sw":case"se":case"s":g.height+=e.deltaY}switch(x){case"nw":case"sw":case"w":g.left+=e.deltaX,g.width-=e.deltaX;break;case"se":case"ne":case"e":g.width+=e.deltaX}if(C)switch(x){case"e":g.top-=e.deltaY/2,g.height+=e.deltaY;break;case"w":g.top+=e.deltaY/2,g.height-=e.deltaY;break;case"n":g.left+=e.deltaX/2,g.width-=e.deltaX;break;case"s":g.left-=e.deltaX/2,g.width+=e.deltaX}}RM.constructorRouter.gg.snap&&!t.ctrlKey&&((y.angle||y.flip_v||y.flip_h)&&!this.block.forbidVisualRotation||(g=RM.constructorRouter.gg.handleSnapResize(g,this.block.model,x)));var O=this.FIXED_DOTS[x],j=s.a.indexOf(this.DOTS,O);if(g=this.applyConstraints(g,{boxOrig:f,direction:x,fromCenter:r,isSidePointProportional:C,fixedDot:O,fixedDotInd:j,DOTS_POS_Y:this.DOTS_POS_Y[j],DOTS_POS_X:this.DOTS_POS_X[j],sinAngle:v,cosAngle:b}),y.angle&&!r&&!this.block.forbidVisualRotation){var P=m.getRotatedBoxDelta(f,g,y.angle,x);g.left+=P.left,g.top+=P.top}if(RM.constructorRouter.gg.snap&&!t.ctrlKey&&!e.disableSnap&&(y.angle||y.flip_v||y.flip_h)&&!this.block.forbidVisualRotation){var E=s.a.extend({sinAngle:this.block.latestPosSizeAngle.sinAngle,cosAngle:this.block.latestPosSizeAngle.cosAngle},g),I=l.a.calcBoundingBox(E);I.left=I.bb_left,I.top=I.bb_top,I.width=I.bb_width,I.height=I.bb_height;var T=Object(o.a)(t.currentTarget).attr("data-visual-direction"),M=s.a.indexOf(this.DOTS,T),$=I.left+I.width*this.DOTS_POS_X[M],A=I.top+I.height*this.DOTS_POS_Y[M],R=RM.constructorRouter.gg.handleSnapResize(I,this.block.model,T),D=R.left+R.width*this.DOTS_POS_X[M]-$,B=R.top+R.height*this.DOTS_POS_Y[M]-A;if(D||B)return e.deltaX=_+D,e.deltaY=w+B,e.disableSnap=!0,void this.onResize(t,e)}e.disableSnap=!1,this.block.recalcFixedLine(),this.block.recalcStickedLine();var L=this.doResize(g,!0,x,r);if(i&&!(this.block instanceof n)){var z=i.bottomBlocksToMove,F=l.a.calcBoundingBox(s.a.extend({sinAngle:this.block.latestPosSizeAngle.sinAngle,cosAngle:this.block.latestPosSizeAngle.cosAngle},f)),U=l.a.calcBoundingBox(s.a.extend({sinAngle:this.block.latestPosSizeAngle.sinAngle,cosAngle:this.block.latestPosSizeAngle.cosAngle},g)),N=U.bb_top-F.bb_top;z&&z.vPressed&&(N+=U.bb_height-F.bb_height),h.a.prototype.moveBottomBlocks(i,N,!1,{y:0})}return this.isRedBorderNeeded()&&this.checkHeightOfTextWidget(L),L}},doResize:function(t,e,i,n){var a=m.ceilObject({height:t.height,width:t.width,top:t.top,left:t.left});return t=this.customResizeHandler(o.a.extend(t,a),this.currentResizePoint,e),this.block.css(t,this.currentResizePoint),this.block.trigger("resize",t),t},isRedBorderNeeded:function(){if(Object(u.a)("constructor.textv3")&&"text"===this.block.model.get("type")){if(3===this.block.model.get("version")){var t=this.block.model.get("columns"),e=this.block.model.get("autosize");return Boolean(!(t&&1!==t.count||e))}return Boolean(this.block.$el.hasClass("block-text")&&1===this.block.model.get("column_count")&&!this.block.$el.hasClass("text-autosize"))}return!(!this.block.$el.hasClass("block-text")||1!==this.block.model.get("column_count")||this.block.$el.hasClass("text-autosize"))},modifyOnShift:function(t,e,i,n){var o=t.shiftKey,a=n.direction;if(o&&!this.block.proportional||n.isSidePointProportional){var r=this.block.model.get("aspect")||i.width/i.height,l=1/r;if(s.a.contains(["w","e"],a))return e.deltaY=e.deltaX*l,a;if(s.a.contains(["n","s"],a))return e.deltaX=e.deltaY*r,a;if(s.a.contains(["nw","se"],a))var c=l;s.a.contains(["sw","ne"],a)&&(c=-l);var d=e.deltaY+e.deltaX/c;return e.deltaX=d/(c+1/c),e.deltaY=e.deltaX*c,a}return a},onResizeEnd:function(t,e,i){if(i=i||{},c.default.autoWindowScrollClear(),e&&(e.deltaX=e.deltaX/RM.constructorRouter.zoom.getZoom(),Math.abs(e.deltaX)<=10?RM.constructorRouter.trigger("notice:triggerMetrics",p.a.WidgetSlightlyResized):RM.constructorRouter.trigger("notice:triggerMetrics",p.a.WidgetResized)),this.block.restoreFixedPosition(),this.block.recalcFixedLine(),this.block.recalcStickedLine(),this.block._justResized=!0,this.$el.find(".frameborder").css("outline",""),!this.block.dontSaveOnResize){var a=this.block instanceof n,r=this.block.workspace.bottomBlocksToMove,l=this.block.workspace.spacesController&&this.block.workspace.spacesController.getBlocksToSave()||[],d=s.a.extend({resizePoint:this.currentResizePoint},i),h=a?this.block.blocks:[this.block],u=s.a.map([].concat(h,r&&r.tosave||[],l),(function(t){return s.a.extend({_id:t.id},t.getSaveBoxData(d))}));r&&r.initPageHeight!=this.block.workspace.page.getCurrentViewportParam("height")&&r.tosave&&r.tosave.length&&this.block.workspace.page.save(),a?this.block.saveBox(s.a.extend({resizePoint:this.currentResizePoint},i),u):this.block.workspace.save_group(u),this.block.workspace.clearBottomBlocksToMove()}this.currentResizePoint=void 0,this.denyRecalcDotSize=!1,Object(o.a)("html").removeClass("blocks-is-resizing"),RM.constructorRouter.gg.snap&&RM.constructorRouter.gg.handleMoveEnd(),this.block.onResizeEnd&&this.block.onResizeEnd(t,e,i),this.block.workspace.off("specialKeydown specialKeyup",this.onSpecialKey),this.block.workspace.widgetResizingOrRotating=!1,this.block.workspace.checkBundleDragAbility()},onSpecialKey:function(t){t.keyCode==o.a.keycodes.shift&&this.block.proportional||("keydown"==t.type&&(this._dragEvent.altKey=t.altKey,this._dragEvent.shiftKey=t.shiftKey),"keyup"==t.type&&(t.keyCode==o.a.keycodes.shift&&(this._dragEvent.shiftKey=!1),t.keyCode==o.a.keycodes.alt&&(this._dragEvent.altKey=!1)),this.$dots.trigger(this._dragEvent))},canChangeDimension:function(t){if(this.block.canChangeDimension&&"function"==typeof this.block.canChangeDimension)return this.block.canChangeDimension(t);switch(t){case"width":return!this.block.isFullWidth()&&(s.a.isUndefined(this.minwidth)||this.minwidth!==this.maxwidth);case"height":return!this.block.isFullHeight()&&(s.a.isUndefined(this.minheight)||this.minheight!==this.maxheight);default:return!0}},destroy:function(){this.hide(),this.retargetScroll&&this.retargetScroll.restore&&this.retargetScroll.restore(),this.stopListening(this.block,"textWidgetMouseSelectionStart",this.disableMouseProceeding),this.stopListening(this.block,"textWidgetMouseSelectionEnd",this.enableMouseProceeding),this.stopListening(this.block,"textWidgetMarginDragStart",this.disableMouseProceeding),this.stopListening(this.block,"textWidgetMarginDragEnd",this.enableMouseProceeding),this.block.workspace.off(null,null,this)}},{applyConstraintsAbstract:function(t,e,i){var n=(e=e||{}).direction,o=e.fromCenter;e.isProportional&&(e=s.a.extend({},e,l.a.getBoxLimits(e.initialBox,{minwidth:e.minwidth,maxwidth:e.maxwidth,minheight:e.minheight,maxheight:e.maxheight})));var a=e.isSidePointProportional&&("n"===n||"s"===n),r=e.isSidePointProportional&&("e"===n||"w"===n);if(t.width<e.minwidth){if(s.a.contains(["nw","sw","w"],n)||a){var c=t.width-e.minwidth;t.left+=o||a?c/2:c}s.a.contains(["se","ne","e"],n)&&o&&(t.left+=(t.width-e.minwidth)/2),t.width=e.minwidth}if(t.height<e.minheight&&((s.a.contains(["nw","ne","n"],n)||r)&&(c=t.height-e.minheight,t.top+=o||r?c/2:c),s.a.contains(["sw","se","s"],n)&&o&&(t.top+=(t.height-e.minheight)/2),t.height=e.minheight),e.maxwidth&&t.width>e.maxwidth&&((s.a.contains(["nw","sw","w"],n)||a)&&(c=e.maxwidth-t.width,t.left-=o||a?c/2:c),s.a.contains(["ne","se","e"],n)&&o&&(t.left-=(e.maxwidth-t.width)/2),t.width=e.maxwidth),e.maxheight&&t.height>e.maxheight&&((s.a.contains(["nw","ne","n"],n)||r)&&(c=e.maxheight-t.height,t.top-=o||r?c/2:c),s.a.contains(["sw","se","s"],n)&&o&&(t.top-=(e.maxheight-t.height)/2),t.height=e.maxheight),e.isProportional&&(t=m.makeProportional(t,e)),i&&s.a.isFunction(i)&&(t=i(t,e.currentResizePoint)),e.constraints&&(t.left<e.constraints.left&&(t.width+=t.left-e.constraints.left,t.left=e.constraints.left),t.top<e.constraints.top&&(t.height+=t.top-e.constraints.top,t.top=e.constraints.top),t.left+t.width>e.constraints.left+e.constraints.width&&(t.width=e.constraints.left+e.constraints.width-t.left),t.top+t.height>e.constraints.top+e.constraints.height&&(t.height=e.constraints.top+e.constraints.height-t.top)),e.packBox){var d=Math.min(e.packBox.width,t.width),h=Math.min(e.packBox.height,t.height);t={width:d,height:h,top:Math.min(e.packBox.top+e.packBox.height-h,Math.max(t.top,e.packBox.top)),left:Math.min(e.packBox.left+e.packBox.width-d,Math.max(t.left,e.packBox.left))}}return this.block.workspace.spacesController&&!e.isSizes&&(t=this.block.workspace.spacesController.recalcBoxOnResize(t,e,this.block.model)),t},makeProportional:function(t,e){var i,n,o=e.initialBox||{},a=e.direction,r=e.fromCenter;switch(a){case"n":case"s":i="height",n="width";break;case"e":case"w":i="width",n="height";break;default:t.width/o.width>t.height/o.height?(i="width",n="height"):(i="height",n="width")}e.baseDimension&&(i=e.baseDimension,n="width"===e.baseDimension?"height":"width");var l=o[n]/o[i];e.ratio&&(l="width"==n?e.ratio:1/e.ratio),e.aspect&&(l="width"==n?e.aspect:1/e.aspect);var c=Math.round(t[i]*l);if(s.a.contains(["nw","sw","w"],a)&&"width"==n){var d=c-t[n];t.left-=r?d/2:d}return s.a.contains(["ne","se","e"],a)&&"width"==n&&r&&(t.left-=(c-t[n])/2),s.a.contains(["nw","ne","n"],a)&&"height"==n&&(d=c-t[n],t.top-=r?d/2:d),s.a.contains(["sw","se","s"],a)&&"height"==n&&r&&(t.top-=(c-t[n])/2),s.a.contains(["n","s"],a)&&r&&(d=c-t[n],t.left-=d/2),s.a.contains(["w","e"],a)&&r&&(d=c-t[n],t.top-=d/2),t[n]=c,t},getRotatedBoxDelta:function(t,e,i,n){var o=m.prototype.DOTS_POS_X,a=m.prototype.DOTS_POS_Y,r=m.prototype.FIXED_DOTS,l=m.prototype.DOTS,c=Math.sin((i||0)*Math.PI/180),d=Math.cos((i||0)*Math.PI/180),h=s.a.indexOf(l,r[n]),u=t.left+t.width*o[h],p=t.top+t.height*a[h],g=t.left+t.width/2,f=t.top+t.height/2,v=u-g,b=f-p,y=g+d*v+c*b,_=f+c*v-d*b,w=e.left+e.width*o[h],k=e.top+e.height*a[h],S=e.left+e.width/2,x=e.top+e.height/2,C=w-S,O=x-k;return{left:y-(S+d*C+c*O),top:_-(x+c*C-d*O)}},ceilObject:function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]=Math.ceil(t[e]));return t}});e.a=m},q7tt:function(t,e,i){"use strict";var n=i("xi34"),o=i("Kw5r"),a=i("q1z7"),r=i.n(a),s=i("rFsW"),l=i("v92f"),c=i("UeZx"),d=i.n(c),h=i("MAfP"),u=i.n(h),p=i("q5gH"),m=i("tRog"),g=i("/Sry"),f={components:{NumericInput:m.a},props:{block:Object,frame:Object,zoom:Number},data:function(){return{minwidth:this.frame.minwidth,maxwidth:this.frame.maxwidth,minheight:this.frame.minheight,maxheight:this.frame.maxheight}},computed:{w:function(){return parseInt(this.block.latestPosSizeAngle.width)},h:function(){return parseInt(this.block.latestPosSizeAngle.height)},x:function(){return parseInt(this.block.latestPosSizeAngle.left)},y:function(){return parseInt(this.block.latestPosSizeAngle.top)},angle:function(){return this.block.latestPosSizeAngle.angle},sin:function(){return this.block.latestPosSizeAngle.sinAngle},cos:function(){return this.block.latestPosSizeAngle.cosAngle},fixed_position:function(){return this.block.model.get("fixed_position")},is_visible:function(){return!this.block.forbidVisualRotation&&this.block.workspace.mag.edit_params.get("sizes")},is_width_disabled:function(){return!this.frame.canChangeDimension("width")},is_height_disabled:function(){return!this.frame.canChangeDimension("height")}},watch:{angle:"applyPosition",x:"applyPosition",y:"applyPosition",w:"applyPosition",h:"applyPosition",fixed_position:"applyPosition",is_visible:function(t){t&&(RM.constructorRouter.trigger("notice:triggerMetrics",g.a.SizesToolTurnOn),s.a.delay(function(){this.$refs.widthInput.updateSize(),this.$refs.heightInput.updateSize()}.bind(this)))}},mounted:function(){var t=this,e=function(e){return t.$children.find((function(t){return t.$el.classList.contains(e)}))};this.$w=e("width"),this.$h=e("height"),this.applyPosition()},methods:{resize:function(t,e){var i="width"===t,n=i?e:parseInt(this.$w.$el.value),o=i?parseInt(this.$h.$el.value):e,a=i?"e":"s";this.$emit("beforeChange");var r=this.frame.applyConstraints({left:this.angle?this.block.latestPosSizeAngle.left:this.block.model.attributes.x,top:this.angle?this.block.latestPosSizeAngle.top:this.block.model.attributes.y,width:n,height:o},{direction:a,isSidePointProportional:!1,isSizes:!0});if(this.angle){var s=p.a.getRotatedBoxDelta({left:this.block.latestPosSizeAngle.left,top:this.block.latestPosSizeAngle.top,width:this.block.latestPosSizeAngle.width,height:this.block.latestPosSizeAngle.height},r,this.angle,a);r.left+=s.left,r.top+=s.top}r.width=Math.round(r.width),r.height=Math.round(r.height),this.minwidth=i&&n<r.width?r.width:this.frame.minwidth,this.maxwidth=i&&n>r.width?r.width:this.frame.maxwidth,this.minheight=!i&&o<r.height?r.height:this.frame.minheight,this.maxheight=!i&&o>r.height?r.height:this.frame.maxheight,(i&&r.width!==this.w||!i&&r.height!==this.h)&&this.$emit("change",r,"se"),this.$emit("afterChange")},applyPosition:function(){var t,e,i=this.h+8,n=this.w+8,o=this.w/2,a=this.h/2,r=8*(this.zoom-1);i-=a;var s=(n-=o)*this.cos-i*this.sin,l=n*this.sin+i*this.cos;n=s+o,i=l+a,this.$el.style.left=Math.round(n*this.zoom)+"px",this.$el.style.top=Math.round(i*this.zoom)+"px";var c=this.$el.getBoundingClientRect(),d=this.angle>=0?this.angle:360+this.angle;t=0,e=0,d>0&&d<=90?t=d/90*-c.width:d>90&&d<=180?(t=-c.width,e=(d-90)/90*-c.height):d>180&&d<=270?(t=(270-d)/90*-c.width,e=-c.height):d>270&&d<=360&&(e=(360-d)/90*-c.height),this.$el.style.transform="translateX("+(t-r)+"px) translateY("+(e-r)+"px)",c=this.$el.getBoundingClientRect();var h=this.block.workspace.$container.width()-this.block.workspace.$container[0].clientWidth,u=window.innerWidth-h,p=window.innerHeight;c.left<8?t=t-c.left+8:c.left+c.width+8>u&&(t+=u-c.left-c.width-8),c.top<8?e=e-c.top+8:c.top+c.height+8>p&&(e+=p-c.top-c.height-8),this.$el.style.transform="translateX("+(t-r)+"px) translateY("+(e-r)+"px)"}}},v=(i("5EAR"),i("KHd+")),b=Object(v.a)(f,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.is_visible,expression:"is_visible"}],staticClass:"size-tool skip-rotate",on:{click:function(t){return t.stopPropagation()},dblclick:function(t){return t.stopPropagation()}}},[i("numeric-input",{ref:"widthInput",staticClass:"input width",attrs:{value:t.w,autosize:!0,disabled:t.is_width_disabled,"mouse-use":!t.is_width_disabled,"debounce-keyboard":500,min:t.minwidth,max:t.maxwidth},on:{change:function(e){return t.resize("width",e)}}}),t._v(" "),i("span",[t._v("×")]),t._v(" "),i("numeric-input",{ref:"heightInput",staticClass:"input height",attrs:{value:t.h,autosize:!0,disabled:t.is_height_disabled,"mouse-use":!t.is_height_disabled,"debounce-keyboard":500,min:t.minheight,max:t.maxheight},on:{change:function(e){return t.resize("height",e)}}})],1)}),[],!1,null,null,null).exports,y=i("OTSC"),_=i("m41J"),w=i("roQd"),k=i("jamO"),S=i("G3+Z"),x=i("Vxjr"),C=i("I0kf"),O=i("Fi5S"),j=i("fueH"),P=i("zjto"),E=i("jcqt");function I(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||R(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function M(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?T(Object(i),!0).forEach((function(e){$(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function $(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function A(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||R(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){if(t){if("string"==typeof t)return D(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?D(t,e):void 0}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var B=r.a.View.extend({SUPER_SMALL_TRESHOLD:10,MAX_Z_INDEX:2e3,TOOLTIP_OFFSET:16,outofbox:!1,excludedFromLib:!1,immortal:!1,template:null,events:{},viewport_fields:l.b.viewport_fields_common,controls:["common_animation","common_position","common_layer","common_lock"],settingsOnCreate:!0,initialize:function(t,e){this.initBlock(t,e)},initBlock:function(t,e){s.a.bindAll(this),this.model=t;var i=A(Object(E.a)(this.initialSharedState),3),o=i[0],a=i[1],r=i[2];this._useSharedState=o,this.nonReactSetSharedState=a,this.nonReactGetSharedState=r,this.isLoading=!1,this.selected=!1,this.forbidVisualRotation=!1,this.triggerAssets={},t.get("hidden")&&this.triggerReady(),this.workspace=e,this.workspace.on("deselect",this.deselect),this.model.on("change",this.onModelChange),this.model.on("change:pack_id",this.onPackChange),this.model.on("change:is_locked",this.updateLockDragState),this.model.on("change:hidden",this.onBlockVisibilityChange),this.model.on("change:fixed_position",this.onFixPosition),Object(C.a)("constructor.zIndex")&&(O.a.on("index:changed",this.onIndexChange),this.workspace.page.on("change:viewport",this.onIndexChange),this.on("select",this.onIndexChange),this.on("deselect",this.onIndexChange)),this.listenTo(this.model,"animation:trigger:add",this.onAnimationTriggerAdd),this.listenTo(this.model,"animation:trigger:remove",this.onAnimationTriggerRemove),this.listenTo(this.model,"animation:type:change",this.resetAnimationTriggers),this.latestPosSizeAngle=this.getModelBox();var l=this.getStickedSide();"left"==l||"right"==l?this.latestPosSizeAngle.sticked_margin=this.calcStickedMargin(this.latestPosSizeAngle.left,this.latestPosSizeAngle.width):"top"!=l&&"bottom"!=l||(this.latestPosSizeAngle.sticked_margin=this.calcStickedMargin(this.latestPosSizeAngle.top,this.latestPosSizeAngle.height)),this.$document=Object(n.a)(document),s.a.extend(this.latestPosSizeAngle,_.a.calcBoundingBox(this.latestPosSizeAngle)),this.has_parent_block=!!this.model.get("parent_wid")},initialSharedState:{},useSharedState:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.partial,n=void 0===i||i,o=this._useSharedState(),a=A(o,1),r=a[0],s=function(e){return t.nonReactSetSharedState(M(M({},r),e))},l=function(e){return t.nonReactSetSharedState(e)};return[r,n?s:l]},render:function(){this.create()},triggerReady:function(){this.model.triggerReady()},init_as_child_block:function(){this.$el.addClass("no-transitions").addClass("has-parent-block"),"picture"===this.model.get("type")&&this.model.on("change:picture",this.workspace.determine_column_widgets_height_fitting)},onModelChange:function(t,e){this.redraw(t,e),this.checkDisabledControls(t),Object(C.a)("constructor.textv3")?"text"!==t.get("type")&&this.checkNeedChangeVisibility():this.checkNeedChangeVisibility()},create:function(){this.setElement(Object(n.a)(this.template({block:this.model.attributes,templates:M({},u.a)}))),this.has_parent_block?this.$el.appendTo(this.workspace.$blocksWrapper):this.isStandalone?this.$el.appendTo(this.$standaloneContainer):this.$el.appendTo(this.workspace.$el.children().first()),this.toggleInPackClass(),this.$content=this.$(".content");var t=this.frameClass||p.a;this.frame=new t({block:this}),this.frameColor&&this.$(".frameborder").css({"border-color":this.frameColor}),this.bindEvents(),this.rendered=!0,this.checkRetargetScroll(),this.workspace.on("workspace-resize",this.onWorkspaceResize),this.model.get("is_full_width")&&this.$el.addClass("full-width"),this.model.get("is_full_height")&&this.$el.addClass("full-height"),this.has_parent_block&&this.init_as_child_block(),this.checkDisabledControls(this.model,!0),Object(C.a)("constructor.zIndex")&&this.onIndexChange(),this.model.getAnimations().find((function(t){return t&&t.steps&&t.steps[0]&&t.steps[0].hideInEditor}))&&this.$el.addClass("hidden-by-trigger")},toggleInPackClass:function(t){var e=Boolean(t||this.model.get("pack_id"));this.$el.toggleClass("in-pack",e)},onIndexChange:function(){if("background"!==this.model.get("type")&&this.rendered){var t=RM.constructorRouter.indexController.getZIndex(this.id,this.workspace.page.id,this.workspace.page.getCurrentViewport());if(this.model.get("fixed_position")&&this.selected&&(t+=1e3),this.currentZ!==t){this.currentZ=t;var e=this.model.get("fixed_position")?t:"",i=e?"":t,n=e?"fixed":"";this.$el.css({"z-index":e,position:n}),this.$content.css({"z-index":i})}}},css:function(t,e){var i,n=(t=t||{}).clone?this.$cloneEl:this.$el;if(t["z-index"]){var o=this.model.get("fixed_position")?t["z-index"]:"",a=o?"":t["z-index"],r=o?"fixed":"";n.css({"z-index":o,position:r}),this.$content.css({"z-index":a})}var l=s.a.extend(s.a.clone(this.latestPosSizeAngle),t);i=!(l.angle||l.flip_v||l.flip_h)||this.forbidVisualRotation||this.isFullWidth()||this.isFullHeight()?"":(l.angle?" rotateZ("+l.angle+"deg)":"")+(l.flip_v?"scaleY(-1)":"")+(l.flip_h?"scaleX(-1)":""),y.default.applyTransform(n.children("div:not(.skip-rotate)"),i),t.clone||(s.a.extend(this.latestPosSizeAngle,s.a.pick(t,"width","height","left","top","angle","flip_v","flip_h","z-index")),null!=t.angle&&(this.latestPosSizeAngle.sinAngle=Math.sin(t.angle*Math.PI/180),this.latestPosSizeAngle.cosAngle=Math.cos(t.angle*Math.PI/180)),null==t.angle&&null==t.flip_v&&null==t.flip_h||this.frame&&this.frame.recalcPointsDirections(),s.a.extend(this.latestPosSizeAngle,_.a.calcBoundingBox(this.latestPosSizeAngle)));var c={};if(c=this.latestPosSizeAngle.angle&&this.latestPosSizeAngle.angle%90==0&&Math.round(this.latestPosSizeAngle.height)%2!=Math.round(this.latestPosSizeAngle.width)%2?s.a.extend(s.a.pick(t,"width","height","left","top","margin-top","margin-left"),{height:Math.round(this.latestPosSizeAngle.height),width:Math.round(this.latestPosSizeAngle.width)+1}):s.a.pick(t,"width","height","left","top","margin-top","margin-left"),this.model.get("fixed_position")&&"pack"!==this.model.get("type")&&!s.a.isEmpty(c)){var d=s.a.pick(this.latestPosSizeAngle,"width","height");s.a.extend(c,d),"default"!=this.model.getViewport()&&(r=this.workspace.position,-1==["n","c","s"].indexOf(this.model.get("fixed_position"))&&(c.left+=r.left),-1==["e","c","w"].indexOf(this.model.get("fixed_position"))&&(c.top+=r.top)),s.a.extend(c,y.default.getFixedPositionCSS(this.model.get("fixed_position"),c,1))}var h=this.getStickedSide();"left"==h||"right"==h?this.latestPosSizeAngle.sticked_margin=this.calcStickedMargin(this.latestPosSizeAngle.left,this.latestPosSizeAngle.width):"top"!=h&&"bottom"!=h||(this.latestPosSizeAngle.sticked_margin=this.calcStickedMargin(this.latestPosSizeAngle.top,this.latestPosSizeAngle.height)),n.css(c),this.has_parent_block||this.isStandalone||(t.doNotRedrawPacksFrames||this.workspace.redrawPacksFrames({tp:"css"}),t.doNotRedrawBottomShiftLine||this.workspace.redrawBottomShiftLine({tp:"css"}));var u=this.latestPosSizeAngle,p=u.width>=0&&u.width<=this.SUPER_SMALL_TRESHOLD&&u.height>=0&&u.height<=this.SUPER_SMALL_TRESHOLD;this.$el.toggleClass("super-small",p)},onWorkspaceResize:function(){this.model.get("is_full_width")&&this.model.set(this.getFullWidthDims()),this.model.get("is_full_height")&&this.model.set(this.getFullHeightDims()),this.model.get("sticked")&&this.setStickedDims(),this.frame.sizes&&(this.frame.sizes.zoom=RM.constructorRouter.zoom.getZoom(),this.frame.sizes.applyPosition())},getCachedSizes:function(){var t=this;return this.cachedSizes||(this.cachedSizes={width:this.workspace.$container.width(),height:this.workspace.$container.height(),clientWidth:this.workspace.$container[0].clientWidth},setTimeout((function(){t.cachedSizes=null}),0)),this.cachedSizes},getFullWidthDims:function(t){var e,i=this.model.get("fixed_position"),n={},o=!1,a=this.getCachedSizes(),r=a.width-a.clientWidth,l=RM.constructorRouter.zoom.getZoom(),c=k.c.getViewportSetting("width",this.workspace.page.getCurrentViewport());return null==t&&(t=parseInt(this.model.get("full_width_margin"),10)||0),i?(e=["s","c","n"].indexOf(i)>-1,o=s.a.contains(i,"e")||s.a.contains(i,"w"),n.x=(e?0:t)-Math.ceil((o?0:r)/2),n.w=a.width/l-2*t-(o?0:r)):(n.x=-this.workspace.position.left+t,n.w=Math.max(a.width/l,c)-2*t-(o?0:r)),n},getFullHeightDims:function(t){var e,i=this.model.get("fixed_position"),n={},o=this.getCachedSizes().height,a=this.workspace.page.getCurrentViewportParam("height"),r=RM.constructorRouter.zoom.getZoom(),s=this.workspace.page.getCurrentViewportParam("height");return null==t&&(t=parseInt(this.model.get("full_height_margin"),10)||0),i?(e=["w","c","e"].indexOf(i)>-1,n.y=e?0:t,n.h=o/r-2*t):(n.y=-this.workspace.position.top+t,n.h=Math.max(Math.max(o,a)/r,s)-2*t),n},getStickedDims:function(t,e){var i=this.workspace.page.getCurrentViewport(),n=t||this.model.get("sticked"),o=null!=e?e:parseInt(this.model.get("sticked_margin"),10)||0,a=this.workspace.$container.width(),r=this.workspace.$container.height(),s=this.workspace.mag.getViewportWidth(i),c=l.b.dictionary[i].width,d=this.workspace.page.getCurrentViewportParam("height"),h=a-this.workspace.$container[0].clientWidth,u="default"!==this.model.getViewport(),p={},m=RM.constructorRouter.zoom.getZoom();return"left"==n?(p.x=-this.workspace.position.left-Math.abs(s-c)/2+o,p.y=this.model.get("y")):"right"==n?(p.x=Math.max(a/m,s)-h-o-this.model.get("w")-this.workspace.position.left-Math.abs(s-c)/2,p.y=this.model.get("y")):"top"==n?(p.x=this.model.get("x"),p.y=o+(d<r/m?0:-this.workspace.position.top)):"bottom"==n&&(p.x=this.model.get("x"),p.y=(d<r/m||u?d-this.workspace.position.top:d)-o-this.model.get("h")+this.workspace.position.top),p},setStickedDims:function(){var t=this.model.get("sticked");t&&"bottom"!==t&&"default"!==this.model.getViewport()&&this.model.unset("sticked"),this.model.get("sticked")&&this.model.set(this.getStickedDims())},calcStickedMargin:function(t,e){var i=this.model.get("sticked"),n=this.workspace.$container.width(),o=this.workspace.$container.height(),a=k.c.getViewportSetting("width",this.workspace.page.getCurrentViewport()),r=this.workspace.page.getCurrentViewportParam("height"),s=n-this.workspace.$container[0].clientWidth,l="default"!==this.model.getViewport(),c=0,d=RM.constructorRouter.zoom.getZoom();return"left"==i?c=t+this.workspace.position.left:"right"==i?c=Math.max(n/d,a)-s-e-t-this.workspace.position.left:"top"==i?c=t+(r<o/d?0:-this.workspace.position.top):"bottom"==i&&(c=(r<o/d||l?r-this.workspace.position.top:r)-e-t+this.workspace.position.top),c},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i="./constructor/widgetbar/icons/";return t.small&&this.icon_color?(e["background-color"]=this.icon_color,e):(e["background-image"]="url(".concat(Object(x.findImagePath)(i+this.model.get("type")+".svg"),")"),e)},bindEvents:function(){this.$el.on("click",this.onClick),this.$el.on("dblclick",this.onDblClick),this.has_parent_block||(Object(n.a)(this.$el).drag("start",this.onDragStart,{not:".no-drag, :input:not([readonly]), .size-tool"}).drag(this.onDragMove,{delay:100}).drag("end",this.onDragEnd),this.workspace.on("select",this.onWorkspaceBlocksSelect),this.updateLockDragState())},updateControls:function(t){var e,n;if(t=t||{},this.has_parent_block?(e=this.workspace&&this.workspace.page_workspace&&this.workspace.page_workspace.controls,n=this.workspace.page_workspace):(e=this.workspace&&this.workspace.controls,n=this.workspace),e&&e.selectedBlocks&&1==e.selectedBlocks.length&&e.selectedBlocks[0].id==this.id){var o=s.a.pluck(e.controls,"name"),a=i("hQZz").default,r=s.a.filter(this.controls,function(t){return!a[t].prototype.restrictions||!!a[t].prototype.restrictions.call(this,n)}.bind(this));(s.a.difference(r,o).length||s.a.difference(o,r).length)&&e.setControls(this.controls,this,t)}},scrollTo:function(){var t=this.$el.offset().top>document.body.clientHeight;if(this.$el.offset().top<0||t){var e=Object(n.a)("#main");e.stop().animate({scrollTop:e.scrollTop()+this.$el.offset().top-100},"200","swing",function(){s.a.delay(function(){this.frame.sizes&&this.frame.sizes.applyPosition()}.bind(this),400)}.bind(this))}},selectFromWidgetBar:function(t,e){if(t||(t={shiftKey:!1,ctrlKey:!1}),this.workspace.trigger("block:click",this,t),t.shiftKey||t.ctrlKey||t.metaKey||this.workspace.trigger("deselect",this),(t.ctrlKey||t.metaKey)&&this.selected&&!s.a.isEmpty(this.workspace.getSelectedBlocks()))return this.deselect(),void(s.a.isEmpty(this.workspace.getSelectedBlocks())?this.workspace.trigger("deselect",this):this.workspace.trigger("select",this.workspace.getSelectedBlocks(),[this],!0));if(this.select(!e),!s.a.isEmpty(this.workspace.getSelectedBlocks())){var i={selected:this.workspace.getSelectedBlocks(),deselected:[]};e&&(i=this.workspace.redefineSelectionWithPacks(this.workspace.getSelectedBlocks())),this.workspace.trigger("select",i.selected,i.deselected,!0)}},onDblClick:function(){this.isStandalone||!this.has_parent_block&&this.model.get("pack_id")&&this.selectFromWidgetBar()},blockBoxToCommonCoords:function(){var t=this.getBoxData({includeBoundingBox:!0}),e=this.workspace.getViewportPosition(),i=this.model.get("fixed_position"),n=t.bb_x,o=t.bb_y,a=t.bb_w,r=t.bb_h;switch(i){case"nw":case"n":case"ne":o+=e.top;break;case"e":case"c":case"w":o+=e.top+e.height/2-r/2;break;case"sw":case"s":case"se":o=e.top+e.height-o-r}switch(i){case"nw":case"w":case"sw":n-=(e.viewportWidth-e.width)/2;break;case"n":case"c":case"s":n+=e.width/2-a/2;break;case"ne":case"e":case"se":n=e.width+(e.viewportWidth-e.width)/2-n-a}return{x:n,y:o,w:a,h:r}},onClick:function(t,e){if(this.workspace.trigger("block:click",this,t),!this.isStandalone)if(this.has_parent_block){if(this._justResized)return void(this._justResized=!1);if(window.suppressClick&&window.suppressClick>+new Date)return;if(!e&&this.workspace.page_workspace.controls&&!this.workspace.page_workspace.controls.canControlsBeClosed())return;this.workspace.trigger("deselect",this),this.select(),this.workspace.trigger("select")}else{if(this.outofbox)return;if(window.suppressClick&&window.suppressClick>+new Date)return;if(this.model.get("hidden"))return;if(this._justResized)return void(this._justResized=!1);if(t||(t={shiftKey:!1}),this.frame&&this.frame.rotationState)return;if((t.metaKey||t.ctrlKey)&&!this.model.get("pack_id")){var i=this.workspace.getViewportPosition(),n=t.clientX-(i.viewportWidth-i.width)/2,o=t.clientY+i.top,a=s.a.chain(this.workspace.blocks).filter((function(t){if(t.outofbox)return!1;var e=t.blockBoxToCommonCoords();return e.x<n&&e.x+e.w>n&&e.y<o&&e.y+e.h>o})).sortBy((function(t){return Object(C.a)("constructor.zIndex")?-RM.constructorRouter.indexController.getZIndex(t.id,t.workspace.page.id,t.workspace.page.getCurrentViewport()):-t.model.get("z")})).value(),r=s.a.find(a,(function(t){return t.selected}));if(r){var l=(a.indexOf(r)+1)%a.length;if(a[l])return void a[l].onClick()}}if(this.selected&&!t.shiftKey&&1==this.workspace.getSelectedBlocks().length)return void(this.child_workspace&&(this.child_workspace.trigger("deselect"),this.workspace.controls.onSelect([this])));if(!e&&this.workspace.controls&&!this.workspace.controls.canControlsBeClosed())return;if(t.shiftKey&&this.selected&&!s.a.isEmpty(this.workspace.getSelectedBlocks()))return void this.cutFromSelection();if(t.shiftKey||this.workspace.trigger("deselect",this),this.select(!(!this.model.get("pack_id")||!t.metaKey&&!t.ctrlKey),{noFrame:this.workspace.getSelectedBlocks().length>0||this.model.get("pack_id")&&!(t.metaKey||t.ctrlKey)}),!s.a.isEmpty(this.workspace.getSelectedBlocks()))if(t.metaKey)this.workspace.trigger("select",this.workspace.getSelectedBlocks(),[],!0);else{var c=this.workspace.redefineSelectionWithPacks(this.workspace.getSelectedBlocks());this.workspace.trigger("select",c.selected,c.deselected)}}},cutFromSelection:function(){if(!this.isStandalone&&this.selected&&this.workspace)if(this.deselect(),0==this.workspace.getSelectedBlocks().length)this.workspace.controls.hide(),this.workspace.trigger("deselect");else if(this.workspace.redefineSelectionWithPacks){var t=this.workspace.redefineSelectionWithPacks(this.workspace.getSelectedBlocks(),this);s.a.isEmpty(t.selected)||this.workspace.trigger("select",t.selected,t.deselected),s.a.isEmpty(t.selected)&&this.workspace.trigger("deselect")}},checkNeedChangeVisibility:function(t){var e=this,i=this.getAnimatedBlocks(),n=this.getTriggerBlocks();n.length>0&&(this.checkTriggerBlocks(n,t),s.a.each(n,(function(i){e.checkBothTypesOfBlocks(i,t)}))),i.length>0&&(this.checkAnimatedBlocks(i,t),s.a.each(i,(function(i){e.checkBothTypesOfBlocks(i,t)}))),this.model.getAnimations().find((function(t){return t.steps&&t.steps[0]}))&&this.changeVisibility(this,t)},checkBothTypesOfBlocks:function(t,e){t.getTriggerBlocks().length>0&&this.checkTriggerBlocks(t.getTriggerBlocks(),e),t.getAnimatedBlocks().length>0&&this.checkAnimatedBlocks(t.getAnimatedBlocks(),e)},checkTriggerBlocks:function(t,e){var i=this;s.a.each(t,(function(t){t.model.getAnimations().find((function(t){return t.steps&&t.steps[0]}))&&i.changeVisibility(t,e)}))},checkAnimatedBlocks:function(t,e){var i=this;s.a.each(t,(function(t){i.changeVisibility(t,e)}))},changeVisibility:function(t,e){if("select"===e)t.$el.removeClass("hidden-by-trigger");else{var i=!!t.model.getAnimations().find((function(t){return t.steps&&t.steps[0]&&t.steps[0].hideInEditor}));t.$el.toggleClass("hidden-by-trigger",i)}},select:function(t,e){e=e||{},this.isSelectable()&&(this.has_parent_block||this.recalcFixedLine(!0),this.setupAnimationTriggers(t),this.listenTo(this.workspace,"paste-animation",this.resetAnimationTriggers),this.selected||(e.noFrame||this.frame&&this.frame.show(t),this.selected=!0,this.workspace.restoreFocusForCopyPaste.__debounced(),this.trigger("select"),this.workspace.checkBundleDragAbility&&this.workspace.checkBundleDragAbility(),this.checkNeedChangeVisibility("select")))},addToSelection:function(){this.selected=!0,this.frame&&this.frame.show()},deselect:function(t){t!=this&&this.selected&&(this.frame&&this.frame.hide(),this.hidePanel(),this.frame&&this.frame.removeRotationState(),this.selected=!1,this.toggleInPackClass(!1),this.removeFixedLine(),this.teardownAnimationTriggers(),this.stopListening(this.workspace,"paste-animation",this.resetAnimationTriggers),this.child_workspace&&this.child_workspace.trigger("deselect"),this.trigger("deselect"),this.checkNeedChangeVisibility())},isSelectable:function(){return!this.outofbox},isLocked:function(){return!!this.model.get("is_locked")},isFullWidth:function(){return!!this.model.get("is_full_width")},isFullHeight:function(){return!!this.model.get("is_full_height")},onDragStart:function(t,e){if(!this.workspace.disableDragging&&(this.workspace.freezeDeltaX=void 0,e.blocks=this.isStandalone?[this]:this.workspace.getSelectedBlocks(),!s.a.any(e.blocks,(function(t){return t.disableDragging})))){var i=this.model.get("pack_id")?this.workspace.getPackBlocks(this.model.get("pack_id")):[this];if(Object(n.a)("html").addClass("blocks-is-moving"),s.a.isEmpty(e.blocks))e.blocks=i;else if(!this.selected){var o=this.workspace.$container.scrollTop(),a=this.workspace.position;s.a.any(e.blocks,(function(t){return t.contains({x:e.startX-a.left,y:e.startY-a.top+o})}))||(e.blocks=i)}var r=!1;s.a.each(e.blocks,(function(t){t.initialBoxData=t.getBoxData({includeBoundingBox:!0}),t._maxShift=0,r=r||!!t.selected})),r||this.workspace.redrawBottomShiftLine({tp:"move-unselected-start",blocks:e.blocks}),RM.constructorRouter.gg.snap&&RM.constructorRouter.gg.handleMoveStart(e.blocks,t.altKey),e.scrollTop=this.workspace.$container.scrollTop(),this.isDragging=!0,this.workspace.bottomBlocksToMove&&!this.workspace.bottomBlocksToMove.active&&delete this.workspace.bottomBlocksToMove}},onDragMove:function(t,e){var i;if(!s.a.any(e.blocks,(function(t){return t.disableDragging}))&&!this.workspace.disableDragging){e.isClone||this.isStandalone||(e.isClone=t.altKey,e.isClone&&s.a.each(e.blocks,(function(t){t.clone()}))),i=s.a.filter(e.blocks,(function(t){return!t.isLocked()}));var n=e.startY+e.scrollTop,o=t.pageY+this.workspace.$container.scrollTop();e.deltaY=o-n;var a=RM.constructorRouter.zoom.getZoom();e.deltaX=e.deltaX/a,e.deltaY=e.deltaY/a,this.moveBlocks(this.workspace,i,e,t),Object(C.a)("constructor.distance")&&this.workspace.distance.update(i),this.isStandalone||(this.workspace.redrawPacksFrames({tp:"move"}),this.workspace.redrawBottomShiftLine({tp:"move"})),y.default.autoWindowScroll(t,this.workspace.$container,s.a.bind((function(){this.onDragMove(t,e)}),this))}},moveBottomBlocks:function(t,e,i,n){var o=t.bottomBlocksToMove;if(o){var a=e+n.y-(o.deltaYcorrection||0);i&&(a=Math.max(a,0)),o.active&&(s.a.each(o.list,(function(t,e){var i=o.initial[e],n=a+i.y;t.css({doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0,left:i.x,top:n}),t.trigger("move",{left:i.x,top:n,width:i.w,height:i.h})})),o.list&&o.list.length&&(t.page.setCurrentViewportParam("type","scroll"),t.page.setCurrentViewportParam("height",Math.ceil(Math.max(o.initPageHeight+a,o.minPageHeight))))),o.prevDeltaY=e}t.checkBundleDragAbility()},"collectBottomBloсks":function(t,e,i){var n=t.bottomBlocksToMove;n&&(n.kbActivate&&"keydown"==i.type||"drag"==i.type)&&(n.list||(s.a.extend(n,t.calcBottomBlocksToMove(e,n)),n.tosave=s.a.uniq((n.tosave||[]).concat(n.list)),n.deltaYcorrection=n.prevDeltaY||0))},resizeBlocks:function(t,e,i,n){s.a.each(e,(function(t){var e=t.model.get("h"),o=t.model.get("w");t.onResizeStart&&t.onResizeStart(n,i);var a=t.getModelBox();if(t.proportional){var r=o/e,s=i.deltaX?o+i.deltaX:(e+i.deltaY)*r,l=i.deltaY?e+i.deltaY:(o+i.deltaX)/r;a.height=l,a.width=s}else a.height=e+i.deltaY,a.width=o+i.deltaX;a.height=Math.round(a.height),a.width=Math.round(a.width),t.frame.doResize(a,!1,"se"),t.onResizeEnd&&t.onResizeEnd(n,i)}));var o=s.a.map(e,function(t){return s.a.extend({},t.getSaveBoxData(),{_id:t.id})}.bind(this));t.set_group(o,s.a.extend({isGroupResize:!0})),t.save_group(o,s.a.extend({isGroupResize:!0}))},moveBlocks:function(t,e,i,o){var a=999999,r=999999,l=-999999,c=-999999,d=o&&"keydown"==o.type,h=null,u=s.a.any(e,(function(t){return t.isFullWidth()})),p=s.a.any(e,(function(t){return!!t.constraintHorzMove})),m=s.a.any(e,(function(t){return t.isFullHeight()})),g=s.a.any(e,(function(t){return!!t.constraintVertMove}));t&&B.prototype.collectBottomBloсks(t,e,o);var f=t&&t.spacesController&&t.spacesController.checkAllBlocksNear(e),v=!1,b=0,y=t&&t.getViewportPosition();s.a.each(e,(function(n){var s=t&&void 0!==t.freezeDeltaX?t.freezeDeltaX:i.deltaX,_=i.deltaY-(n.resetDelta||0),w=n.initialBoxData||n.getBoxData({includeBoundingBox:!0});t&&t._inTriangleBundleDrag&&(s=0);var k=n.model.get("fixed_position");if(t&&t.spacesController&&!k){var S=t.spacesController.getRestriction(n.model,f?e:[]),x=_+w.bb_y,O=_+w.bb_y+w.bb_h,j=_;x<S.top?(_=Math.floor(S.top-w.bb_y),void 0===t.freezeDeltaX&&f&&t.spacesController.needFreeze(n)&&(t.freezeDeltaX=s)):O>S.bottom?(_=Math.floor(S.bottom-(w.bb_y+w.bb_h)),void 0===t.freezeDeltaX&&f&&t.spacesController.needFreeze(n)&&(t.freezeDeltaX=s)):t.freezeDeltaX=void 0,Math.abs(j-_)&&"drag"===o.type&&f&&(v=!0,b=j-_)}k&&(o&&"keydown"!==o.type&&(_=(o.pageY-i.startY)/RM.constructorRouter.zoom.getZoom()),k.indexOf("e")>-1&&(s=-s),k.indexOf("s")>-1&&(_=-_)),k={x:s+w.x,y:_+w.y,w:w.w,h:w.h};var P={x:s+w.bb_x,y:_+w.bb_y};if(o&&o.shiftKey){var E=Math.abs(s),I=Math.abs(_);if(n._shiftDirection||d||(E>=4&&(n._shiftDirection="horz"),I>=4&&(n._shiftDirection="vert"),(E>=4||I>=4)&&s/_<2&&s/_>.5&&(n._shiftDirection="diag1"),(E>=4||I>=4)&&s/_>-2&&s/_<-.5&&(n._shiftDirection="diag2"),n._maxShift=Math.max(E,I)),(u||p)&&(n._shiftDirection="vert"),(m||g)&&(n._shiftDirection="horz"),n._shiftDirection&&!d){var T=s;"horz"!=n._shiftDirection&&"vert"!=n._shiftDirection||(Math.abs(s)>n._maxShift&&(n._maxShift=Math.abs(s),n._shiftDirection="horz"),Math.abs(_)>n._maxShift&&(n._maxShift=Math.abs(_),n._shiftDirection="vert")),t.spacesController||("horz"==n._shiftDirection&&(k.y=w.y,P.y=w.bb_y),"vert"==n._shiftDirection&&(k.x=w.x,P.x=w.bb_x),"diag1"==n._shiftDirection&&(k.x=w.x+T,k.y=w.y+T,P.x=w.bb_x+T,P.y=w.bb_y+T),"diag2"==n._shiftDirection&&(k.x=w.x+T,k.y=w.y-T,P.x=w.bb_x+T,P.y=w.bb_y-T)),h=n._shiftDirection}}var M=n.model.get("fixed_position");if(M&&y&&Object(C.a)("constructor.snapFixed")){var $=P.x,A=P.y;switch(M){case"nw":case"n":case"ne":A+=y.top;break;case"e":case"c":case"w":A+=y.top+y.height/2-w.bb_h/2;break;case"sw":case"s":case"se":A=y.top+y.height-A-w.bb_h}switch(M){case"nw":case"w":case"sw":$-=(y.viewportWidth-y.width)/2;break;case"n":case"c":case"s":$+=y.width/2-w.bb_w/2;break;case"ne":case"e":case"se":$=y.width+(y.viewportWidth-y.width)/2-$-w.bb_w}a=Math.min(a,$),r=Math.min(r,A),l=Math.max(l,$+w.bb_w),c=Math.max(c,A+w.bb_h)}else a=Math.min(a,P.x),r=Math.min(r,P.y),l=Math.max(l,P.x+w.bb_w),c=Math.max(c,P.y+w.bb_h);(u||p)&&(k.x=w.x),(m||g)&&(k.y=w.y),n._position=k})),v&&!o.altKey?t&&t.spacesController.updateGhost(e,b,i.deltaX-t.freezeDeltaX,Object(n.a)("> .workspace",t.$el),o):t&&t.spacesController&&t.spacesController.removeGhost();var _={x:0,y:0};!RM.constructorRouter.gg.snap||s.a.all(e,(function(t){return t.model.get("fixed_position")}))&&!Object(C.a)("constructor.snapFixed")||(_=RM.constructorRouter.gg.handleSnapMove({x:a,y:r},l-a,c-r,i.isClone,"keydown"===o.type),"horz"==h&&(_.y=0),"vert"==h&&(_.x=0),(u||p)&&(_.x=0),(m||g)&&(_.y=0),"keydown"===o.type&&Object(C.a)("constructor.distance")&&(_.x=0,_.y=0,RM.constructorRouter.gg.hideLinesWithDelay()));var w={};if(i.isClone&&(w.clone=!0),s.a.each(e,(function(t){var e=t.model.get("fixed_position"),i=e in{ne:1,e:1,se:1}?-_.x:_.x,n=e in{se:1,s:1,sw:1}?-_.y:_.y;t.css(s.a.extend({doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0,left:Math.ceil(t._position.x+i),top:Math.ceil(t._position.y+n)},w)),t.recalcFixedLine(),t.recalcStickedLine(),t.trigger("move",{left:Math.ceil(t._position.x+i),top:Math.ceil(t._position.y+n),width:Math.ceil(t._position.w),height:Math.ceil(t._position.h)})})),t){var k=i.isCloneByKeys?i.deltaYOrig:i.deltaY;B.prototype.moveBottomBlocks(t,k,i.isClone,_)}},onDragEnd:function(t,e){if(y.default.autoWindowScrollClear(),Object(C.a)("constructor.distance")&&this.workspace.distance.hide(),!s.a.any(e.blocks,(function(t){return t.disableDragging}))&&!this.workspace.disableDragging){var i=!1;if(s.a.each(e.blocks,(function(t){t.initialBoxData=null,t.resetDelta=null,t._shiftDirection=null,i=i||!!t.selected})),i||this.workspace.redrawBottomShiftLine({tp:"move-unselected-end"}),e.isClone)this.workspace.cloneBlocks(s.a.filter(e.blocks,(function(t){return!t.isLocked()})));else if(this.isStandalone)s.a.first(e.blocks).saveBox();else{this.workspace.spacesController&&this.workspace.spacesController.moveBlocksToHighlighted(e.blocks),this.workspace.spacesController&&this.workspace.spacesController.removeGhost();var o=this.workspace.bottomBlocksToMove,a=this.workspace.spacesController&&this.workspace.spacesController.getBlocksToSave()||[],r=s.a.map([].concat(e.blocks,o&&o.tosave||[],a),function(t){return s.a.extend({_id:t.id},t.getBoxData({includeFreeze:e.deltaX-this.workspace.freezeDeltaX}))}.bind(this));o&&o.initPageHeight!=this.workspace.page.getCurrentViewportParam("height")&&o.tosave&&o.tosave.length&&this.workspace.page.save(),this.workspace.page.getCurrentViewportParam("height")>2e3&&e.deltaY>0&&e.deltaY>Math.abs(e.deltaX)&&(!o||!o.active)&&e.blocks.length>5&&RM.constructorRouter.helpPanel.showTip({name:"bottom-blocks-to-move",showOnce:!0}),this.workspace.save_group(r)}Object(n.a)("html").removeClass("blocks-is-moving"),RM.constructorRouter.gg.snap&&RM.constructorRouter.gg.handleMoveEnd(),e.isClone||this.triggerRedraw(),this.isDragging=!1,"hotspot"===this.model.get("type")&&Object(n.a)(t.target).one("click",(function(t){t.stopImmediatePropagation()})),this.workspace.clearBottomBlocksToMove(),this.workspace.checkBundleDragAbility()}},triggerRedraw:function(){this.isStandalone||this.workspace.trigger("redraw",{is_global:this.model.get("is_global")})},recalcFixedLine:function(t){var e=this.model.get("fixed_position")||this.restoreFixed,i=this.model.get("pack_id"),n=i&&this.workspace.packs&&this.workspace.packs[i],o=this.selected||t;e&&!n&&o?this.updateFixedLine(e):this.removeFixedLine()},updateFixedLine:function(t){this.$fixed_svg||(this.$fixed_svg=Object(n.a)('<svg class="fixed-line"><line /></svg>'),this.workspace.$el.append(this.$fixed_svg));var e,i,o,a,r,s,l=this.frame.$el.offset(),c=this.getBoxData(),d=this.$fixed_svg.find("line").get(0),h=RM.constructorRouter.zoom.getZoom(),u=this.isFullHeight(),p=this.workspace.$container.width()/h,m=this.workspace.$container.height()/h;r=s=0,"default"!=this.model.getViewport()&&(r=this.workspace.position.left,s=this.workspace.position.top),e=r,o=s,i=l.left,a=l.top,t.indexOf("s")>-1&&(o=m-s,a+=c.h),t.indexOf("e")>-1&&(e=p-r,i+=c.w),["n","c","s"].indexOf(t)>-1&&(e=p/2,i+=c.w/2),["w","c","e"].indexOf(t)>-1&&(o=m/2,a+=c.h/2),u&&(a=o),d.setAttributeNS(null,"x1",e),d.setAttributeNS(null,"x2",i),d.setAttributeNS(null,"y1",o),d.setAttributeNS(null,"y2",a)},removeFixedLine:function(){this.$fixed_svg&&this.$fixed_svg.remove(),delete this.$fixed_svg},recalcStickedLine:function(){var t=this.workspace.page.getCurrentViewport(),e=l.b.dictionary[t].width,i=this.workspace.mag.getViewportWidth(t),o=this.model.get("sticked"),a={left:"",right:"",top:"",bottom:"",width:"",height:""};if(o){var r="left"==o||"right"==o;this.$stickedLine||(this.$stickedLine=Object(n.a)("<div>").addClass("sticked-line skip-rotate").appendTo(this.$el)),this.$stickedLine.removeClass("line-horizontal line-vertical"),this.$stickedLine.addClass(r?"line-horizontal":"line-vertical"),r?(a.width=this.calcStickedMargin(this.latestPosSizeAngle.left,this.latestPosSizeAngle.width)+Math.abs(i-e)/2,a[o]=-a.width):(a.height=this.calcStickedMargin(this.latestPosSizeAngle.top,this.latestPosSizeAngle.height),a[o]=-a.height),this.$stickedLine.css(a)}else this.$stickedLine&&(this.$stickedLine.remove(),delete this.$stickedLine)},clone:function(){this.isLocked()||(this.$cloneEl=Object(n.a)(n.a.clone(this.$el.get(0))),this.$cloneEl.data("id",this.$cloneEl.data("id")+"-clone"),this.$cloneEl.insertAfter(this.$el)),this.deselect()},blink:function(){var t=this.$el;t.addClass("frame-blink"),y.default.waitForTransitionEnd(t,2500,"opacity",(function(){t.removeClass("frame-blink")}))},getStandardName:function(){var t=this.model.get("type");if("text"===t)return this.model.get("version")===P.h?j.a.getTextFromTextWidget(this.model):Object(n.a)(this.model.get("text")).text();if("shape"===t){var e=this.model.get("tp");return y.default.capitalize({ellipse:"oval"}[e]||e)}return"button"===t&&"text"===this.model.get("tp")?this.model.get("text"):this.name?this.name:y.default.capitalize(t)},highlight:function(t,e){var i=this.animationMode?(this.workspace.animationSteps.currentStep||this.workspace.animationSteps.initialStep).$el:this.$el;e&&i&&i.toggleClass(e,Boolean(t))},getTriggerBlocks:function(){var t=this;return this.getAllTriggers().reduce((function(e,i){var n=t.workspace.findBlock(i);return n?[].concat(I(e),[n]):e}),[])},getAnimationTriggers:function(t){var e=this.model.getAnimations().find((function(e){return e.UUID===t}));return w.a.normalizeAnimationTriggers(e&&e.trigger)},getAllAnimationTriggers:function(){return this.model.getAnimations().reduce((function(t,e){return e.trigger?[].concat(I(t),I(w.a.normalizeAnimationTriggers(e&&e.trigger))):t}),[])},getAllTriggers:function(){return s.a.unique([].concat(I(this.getAllAnimationTriggers()),I(this.model.get("triggers")||[])))},setAnimationTriggers:function(t,e){var i=this.model.getAnimations().map((function(i){return i.UUID===t?M(M({},i),{},{trigger:e&&!s.a.isArray(e)?[e]:e||[]}):i}));this.model.set("animation",i)},removeAllAnimationTriggers:function(){var t=this;this.model.getAnimations().forEach((function(e){t.getAnimationTriggers(e.UUID).forEach((function(i){return t.removeAnimationTrigger(e.UUID,i)}))}))},removeAnimationTrigger:function(t,e){var i=this.getAnimationTriggers(t);-1!==i.indexOf(e)&&(this.setAnimationTriggers(t,s.a.without(i,e)),this.model.trigger("animation:trigger:remove",e))},isPackAlreadySetUp:function(t){return Boolean(t&&this.workspace.getPackBlocks&&s.a.find(this.workspace.getPackBlocks(t),(function(t){return t.ownTooltip})))},getAnimatedBlocks:function(){var t=s.a.reduce(this.workspace.blocks,function(t,e){if(e.getAllTriggers().includes(this.id)){var i=this.model.get("pack_id")||e.id;t[i]=t[i]||e}return t}.bind(this),{});return s.a.values(t)},getTooltipTarget:function(t){var e=this.model.get("pack_id"),i=e&&this.workspace.$("#pack_"+e);return this.animationMode?this.workspace.animationSteps.initialStep.$el:i&&i.length&&!t?i.find(".content"):this.$el},setupAnimationTriggers:function(t){var e=this.getAnimatedBlocks(),i=this.getTriggerBlocks();s.a.each(e,this.setupAnimationTrigger.bind(this,!0)),s.a.each(i,this.setupAnimationTrigger.bind(this,!1)),!(e.length&&(e.length>1||e[0].id!==this.id))&&!i.length||this.isPackAlreadySetUp(this.model.get("pack_id"))||this.ownTooltip||(this.ownTooltip=this.getTooltipTarget(t).RMAltText({text:e.length&&i.length?"Animated / Trigger":e.length?"Trigger":"Animated",offset:this.TOOLTIP_OFFSET,manual:!0,cssClass:"animation-trigger-tooltip animation-trigger-own-tooltip skip-rotate",container:this.getTooltipTarget(t),keepInBounds:!0,targetZoom:RM.constructorRouter.zoom.getZoom()}),this.ownTooltip.show(),this.bindAnimationTriggerHandlers())},teardownAnimationTriggers:function(){var t=s.a.keys(this.triggerAssets);s.a.each(t,this.teardownAnimationTrigger.bind(this)),this.ownTooltip&&this.ownTooltip.destroy(),delete this.ownTooltip,this.unbindAnimationTriggerHandlers()},setupAnimationTrigger:function(t,e){if(e){var i=this.model.get("pack_id"),n=e.id,o=e.model.get("pack_id"),a=o&&this.workspace.$("#pack_"+o);this.triggerAssets[n]=this.triggerAssets[n]||{},this.triggerAssets[n].tooltip||n===this.id||i&&o===i||e.ownTooltip||(this.triggerAssets[n].tooltip=(a||e.$content).RMAltText({text:a||t?"Animated":"Trigger",offset:this.TOOLTIP_OFFSET,manual:!0,cssClass:"animation-trigger-tooltip skip-rotate",container:a||e.$el,keepInBounds:!0,targetZoom:RM.constructorRouter.zoom.getZoom()}),this.triggerAssets[n].tooltip.show(),a?a.addClass(w.a.ACTIVE_TRIGGER_CLASS):e.highlight(!0,w.a.ACTIVE_TRIGGER_CLASS),this.triggerAssets[n].updateLinkedTooltipBound=this.updateLinkedTooltip.bind(this,n),this.listenTo(e,"move resize",this.triggerAssets[n].updateLinkedTooltipBound),this.listenTo(e&&e.model,"change:x change:y change:w change:h",this.triggerAssets[n].updateLinkedTooltipBound))}},teardownAnimationTrigger:function(t){var e=this.workspace.findBlock(t);e&&e.highlight(!1,w.a.ACTIVE_TRIGGER_CLASS),this.workspace.$("."+w.a.ACTIVE_TRIGGER_CLASS).removeClass(w.a.ACTIVE_TRIGGER_CLASS),this.triggerAssets[t]&&(this.triggerAssets[t].tooltip&&this.triggerAssets[t].tooltip.destroy(),this.stopListening(e,"move resize",this.triggerAssets[t].updateLinkedTooltipBound),this.stopListening(e&&e.model,"change:x change:y change:w change:h",this.triggerAssets[t].updateLinkedTooltipBound),delete this.triggerAssets[t])},bindAnimationTriggerHandlers:function(){this.animationTriggerHandlersBound||(this.listenTo(this,"move resize",this.updateOwnTooltip),this.listenTo(this,"animationMode",this.resetAnimationTriggers),this.listenTo(this,"animation:stepsPopup:open",this.onStepsPopupOpen),this.listenTo(this,"animation:stepsPopup:closed",this.onStepsPopupClosed),this.listenTo(this.model,"change:angle change:x change:y change:w change:h change:sticked change:fixed_position change:is_full_width change:is_full_height",this.updateOwnTooltip),O.a.on("zoom",this.updateTooltips),Object(n.a)("#main").on("scroll",this.updateTooltips),this.animationTriggerHandlersBound=!0)},unbindAnimationTriggerHandlers:function(){this.stopListening(this,"move resize",this.updateOwnTooltip),this.stopListening(this,"animationMode",this.resetAnimationTriggers),this.stopListening(this,"animation:stepsPopup:open",this.onStepsPopupOpen),this.stopListening(this,"animation:stepsPopup:closed",this.onStepsPopupClosed),this.stopListening(this.model,"change:angle change:x change:y change:w change:h change:sticked change:fixed_position change:is_full_width change:is_full_height",this.updateOwnTooltip),this.stopListening(this.workspace,"workspace-resize",this.updateTooltips),Object(n.a)("#main").off("scroll",this.updateTooltips),delete this.animationTriggerHandlersBound},updateTooltips:function(){window.requestAnimationFrame(function(){s.a.each(this.getAllTriggers(),this.recalcLinkedTooltip),this.recalcOwnTooltip()}.bind(this))},updateLinkedTooltip:function(t){window.requestAnimationFrame(this.recalcLinkedTooltip.bind(this,t))},updateOwnTooltip:function(){window.requestAnimationFrame(this.recalcOwnTooltip.bind(this))},recalcLinkedTooltip:function(t){this.triggerAssets[t]&&this.triggerAssets[t].tooltip&&(this.triggerAssets[t].tooltip.setTargetZoom(RM.constructorRouter.zoom.getZoom()),this.triggerAssets[t].tooltip.update())},recalcOwnTooltip:function(){this.ownTooltip&&(this.ownTooltip.setTargetZoom(RM.constructorRouter.zoom.getZoom()),this.ownTooltip.update())},onStepsPopupOpen:function(t){var e,i=this.ownTooltip&&this.ownTooltip.getElement(),n=i&&i[0]&&i[0].getBoundingClientRect();if(t){var o=t.find(".js-steps-popup");e=o&&o.length&&o[0].getBoundingClientRect()}n&&e&&_.a.doBoundingBoxesIntersect(n,e)&&this.ownTooltip.hide()},onStepsPopupClosed:function(){this.ownTooltip&&!this.ownTooltip.getElement()&&this.ownTooltip.show()},getSaveBoxData:function(t){var e=this.getBoxData();return this.model.get("is_full_width")&&(e=s.a.omit(e,"x")),this.model.get("is_full_height")&&(e=s.a.omit(e,"y")),e},getSaveBoxOptions:function(t){return t||{}},saveBox:function(t){this._saveXHR&&this._saveXHR.abort(),this._saveXHR=this.model.save(this.getSaveBoxData(t),this.getSaveBoxOptions(t))},getBoxData:function(t){t=t||{};var e=this.latestPosSizeAngle,i=this.model.get("is_full_width"),n=this.model.get("is_full_height"),o={w:e.width,h:e.height,x:e.left,y:e.top};if(t.includeFreeze&&(o.x+=t.includeFreeze),t.includeRotationData&&(o.angle=e.angle,o.flip_v=e.flip_v,o.flip_h=e.flip_h),t.includeBoundingBox&&(o.bb_w=e.bb_width,o.bb_h=e.bb_height,o.bb_x=e.bb_left,o.bb_y=e.bb_top),this.model.get("fixed_position")&&t.checkFixedPosition){var a=s.a.clone(o),r=this.$el.offset(),l=this.workspace.position;o.y=r.top-l.top,o.x=r.left-l.left,t.includeBoundingBox&&(o.bb_x=o.x+(o.bb_x-a.x),o.bb_y=o.y+(o.bb_y-a.y))}if(i){var c=this.getFullWidthDims();o.x=c.x,o.w=c.w}if(n){var d=this.getFullHeightDims();o.y=d.y,o.h=d.h}return this.model.get("sticked")&&(o.sticked_margin=e.sticked_margin),o},getModelBox:function(){var t=this.model.get("angle")||0,e=t?t*Math.PI/180:0;return{left:this.model.get("x"),top:this.model.get("y"),width:this.model.get("w"),height:this.model.get("h"),angle:t,flip_v:!!this.model.get("flip_v"),flip_h:!!this.model.get("flip_h"),sinAngle:Math.sin(-e),cosAngle:Math.cos(-e)}},getPack:function(){var t=this.model.get("pack_id");return t&&this.workspace.packs[t]},onPackChange:function(t,e,i){this.toggleInPackClass(),s.a.isEmpty(this.workspace.getSelectedBlocks())||this.workspace.trigger("select",this.workspace.getSelectedBlocks()),this.workspace.redrawPacksFrames({tp:"pack-change"}),this.isLocked()&&(i.undo||i.redo)&&t.save({is_locked:!1},{patch:!0,skipHistory:!0}),this.recalcFixedLine(),this.selected&&this.resetAnimationTriggers()},checkNeedRedraw:function(t,e){e=e||{};var i=t.changedAttributes();return(!e.pid||!this.workspace||this.workspace.page.id===e.pid)&&(!!this.workspace.rendered&&(1!=s.a.keys(i).length||!i.animation))},redraw:function(t,e){e=e||{},this.checkNeedRedraw(t,e)&&this.redrawPosition(t,s.a.extend(e,{forceRedraw:!1}))},updateLockDragState:function(){this.$el.toggleClass("no-drag",this.isLocked())},redrawPosition:function(t,e){e=e||{},t=t||this.model;var i={},n=e.forceRedraw?{}:this.getBoxData({includeRotationData:!0}),o=this.model.changedAttributes(),a=s.a.has(o,"is_full_width"),r=s.a.has(o,"is_full_height");a&&this.$el.toggleClass("full-width",!!this.model.get("is_full_width")),r&&this.$el.toggleClass("full-height",!!this.model.get("is_full_height"));var l=t.get("fixed_position"),c=!!t.get("is_full_width"),d=!!t.get("is_full_height");if((t.get("x")!=n.x||l)&&(i.left=t.get("x")),c){var h=this.getFullWidthDims();i.left=h.x}if((t.get("y")!=n.y||l)&&(i.top=t.get("y")),d){var u=this.getFullHeightDims();i.top=u.y}if((t.get("w")!=n.w||l||c)&&(i.width=t.get("w")),e.socketUpdate&&c&&(i.width=h.w),e.socketUpdate&&d&&(i.height=u.h),(t.get("h")!=n.h||l||d)&&(i.height=t.get("h")),Object(C.a)("constructor.zIndex")||t.get("z")!=this.$content.css("z-index")&&(i["z-index"]=t.get("z")),(t.get("angle")||0)!=n.angle&&(i.angle=t.get("angle")||0),!!t.get("flip_v")!=n.flip_v&&(i.flip_v=!!t.get("flip_v")),!!t.get("flip_h")!=n.flip_h&&(i.flip_h=!!t.get("flip_h")),s.a.isEmpty(i)||(e.doNotRedrawPacksFrames&&(i.doNotRedrawPacksFrames=!0),e.doNotRedrawBottomShiftLine&&(i.doNotRedrawBottomShiftLine=!0),this.css(i)),(l||e.undo||e.redo)&&this.recalcFixedLine(),(t.get("sticked")||s.a.has(o,"sticked"))&&(this.recalcStickedLine(),(o.x||o.y)&&!s.a.has(o,"sticked")&&this.workspace.page.getPreviousViewport()===this.workspace.page.getCurrentViewport())){var p=this.getBoxData().sticked_margin;p&&!isNaN(p)&&this.model.get("sticked_margin")!=p&&this.model.set({sticked_margin:p},{first:!0})}e.skipTriggerRedraw||e.forceRedraw||this.triggerRedraw()},showPanel:function(){this.workspace.controls.selectFirst()},hidePanel:function(){this.panel&&this.panel.hide()},inArea:function(t){if(!this.model.get("hidden")){var e=this.model.get("fixed_position"),i=this.getBoxData({includeBoundingBox:!0,includeRotationData:!0,checkFixedPosition:!0});if(e){var n=RM.constructorRouter.zoom.getZoom();i.bb_y+=this.workspace.$container.scrollTop()/n,i.bb_x+=this.workspace.$container.scrollLeft()/n}var o=Math.max(t.x,i.bb_x)<Math.min(t.x+t.w,i.bb_x+i.bb_w)&&Math.max(t.y,i.bb_y)<Math.min(t.y+t.h,i.bb_y+i.bb_h);if(o&&i.angle){var a;if(e){var r=RM.constructorRouter.zoom.getZoom();a={top:i.y+this.workspace.$container.scrollTop()/r,left:i.x+this.workspace.$container.scrollLeft()/r,width:i.w,height:i.h,sinAngle:this.latestPosSizeAngle.sinAngle,cosAngle:this.latestPosSizeAngle.cosAngle}}var s=_.a.calcRotatedBox(a||this.latestPosSizeAngle);o=_.a.isConvexPolygonsIntersects(s,[{x:t.x,y:t.y},{x:t.x+t.w,y:t.y},{x:t.x+t.w,y:t.y+t.h},{x:t.x,y:t.y+t.h}])}return o}},contains:function(t){if(!this.model.get("hidden")){var e=this.getBoxData({includeBoundingBox:!0,includeRotationData:!0}),i=e.bb_x<t.x&&e.bb_x+e.bb_w>t.x&&e.bb_y<t.y&&e.bb_y+e.bb_h>t.y;if(i&&e.angle){var n=_.a.calcRotatedBox(this.latestPosSizeAngle);i=_.a.isConvexPolygonContainsPoint(n,t)}return i}},showIconLoader:function(){this.isLoading=!0},hideIconLoader:function(){this.isLoading=!1},onBlockVisibilityChange:function(t){var e=!!t.get("hidden");this.$el.toggleClass("invisible",e),e&&(this.triggerRedraw(),this.cutFromSelection())},storeFixedPosition:function(){if(this.model.get("fixed_position")){this.restoreFixed=this.model.get("fixed_position");var t=RM.constructorRouter.zoom.getZoom(),e=this.getBoxData({checkFixedPosition:!0});e.y=e.y+this.workspace.$container.scrollTop()/t,e.x=e.x+this.workspace.$container.scrollLeft()/t,this.model.set(s.a.extend(e,{fixed_position:""}),{skipHistory:!0})}},restoreFixedPosition:function(){if(this.restoreFixed){var t=this.getBoxData(),e=this.$el.offset(),i="default"!=this.model.getViewport()?this.workspace.position.left:0,o="default"!=this.model.getViewport()?this.workspace.position.top:0,a=RM.constructorRouter.zoom.getZoom(),r={x:(this.restoreFixed.indexOf("e")>-1?Object(n.a)(window).width()/a-e.left-t.w:e.left)-i,y:(this.restoreFixed.indexOf("s")>-1?Object(n.a)(window).height()/a-e.top-t.h:e.top)-o,w:t.w,h:t.h,fixed_position:this.restoreFixed};["n","c","s"].indexOf(this.restoreFixed)>-1&&(r.x-=Object(n.a)("#main").width()/2/a-t.w/2-i),["e","c","w"].indexOf(this.restoreFixed)>-1&&(r.y-=Object(n.a)("#main").height()/2/a-t.h/2-o),this.model.set(r,{skipHistory:!0}),delete this.restoreFixed}},resetFullWidth:function(){this.model.get("is_full_width")&&this.model.set({is_full_width:!1,x:this.model.get("full_width_initial_x")||this.model.get("x"),w:this.model.get("full_width_initial_w")||this.model.get("w")})},resetFullHeight:function(){this.model.get("is_full_height")&&this.model.set({is_full_height:!1,y:this.model.get("full_height_initial_y")||this.model.get("y"),h:this.model.get("full_height_initial_h")||this.model.get("h")})},onFixPosition:function(t,e,i){Object(C.a)("constructor.zIndex")?this.css({"z-index":RM.constructorRouter.indexController.getZIndex(this.model.id,this.workspace.page.id,this.workspace.page.getCurrentViewport()),width:this.model.get("w"),height:this.model.get("h"),top:this.model.get("y"),left:this.model.get("x"),"margin-left":0,"margin-top":0}):this.css({"z-index":this.model.get("z"),width:this.model.get("w"),height:this.model.get("h"),top:this.model.get("y"),left:this.model.get("x"),"margin-left":0,"margin-top":0}),i&&(i.redo||i.undo)&&!s.a.isEmpty(this.workspace.getSelectedBlocks())&&this.workspace.trigger("select",this.workspace.getSelectedBlocks()),this.checkRetargetScroll(),this.recalcFixedLine()},onAnimationTriggerAdd:function(){this.resetAnimationTriggers()},onAnimationTriggerRemove:function(t){this.resetAnimationTriggers()},resetAnimationTriggers:function(){var t=this;this.teardownAnimationTriggers(),window.requestAnimationFrame((function(){t.selected&&t.setupAnimationTriggers()}))},checkRetargetScroll:function(){this.retargetScroll&&this.retargetScroll.restore&&this.retargetScroll.restore(),this.model.get("fixed_position")&&(this.retargetScroll=Object(S.a)(this.$el.get(0),this.workspace.$container.get(0)))},onWorkspaceBlocksSelect:function(t,e,i){this.isStandalone||(t&&1==t.length&&t[0]==this?(this.frame&&!this.frame.isFrameVisible()&&this.frame.show(i),this.toggleInPackClass(!1)):(this.frame&&this.frame.removeRotationState(),this.toggleInPackClass(!0)))},isRealChangeByMe:function(t){return!((t=t||{}).socketUpdate||this.workspace!=RM.constructorRouter.workspace||!RM.constructorRouter.workspace.page||!RM.constructorRouter.isPageLockedByMe(RM.constructorRouter.workspace.page.get("_id")))},toggleAnimationMode:function(t){this.$el.toggleClass("animation-mode",!!t),this.animationMode=!!t,this.model.get("pack_id")&&(this.isPackFrameHidden=t,this.workspace.redrawPacksFrames({tp:"animation-mode"})),this.workspace.redrawBottomShiftLine({tp:"animation-mode"}),this.trigger("animationMode",t)},getStickedSide:function(){var t=this.model.get("sticked");if(t)return"default"!==this.model.getViewport()&&"bottom"!==t&&(this.model.set("sticked",void 0),t=void 0),t},checkDisabledControls:function(t,e){return[]},destroy:function(){this.frame&&this.frame.removeRotationState(),this.frame&&this.frame.destroy(),this.workspace.off("select",this.onWorkspaceBlocksSelect),this.destroyed=!0,this.cutFromSelection(),this.$el.empty().remove(),this.stopListening(this.model,"change"),this.model.isGlobal&&!this.model.isGlobal()&&this.triggerRedraw(),this.rendered=!1,this.workspace.off("deselect",this.deselect),this.model.off("change",this.onModelChange),this.model.off("change:pack_id",this.onPackChange),this.model.off("change:is_locked",this.updateLockDragState),this.model.off("change:fixed_position",this.onFixPosition),this.model.off("change:hidden",this.onBlockVisibilityChange),Object(C.a)("constructor.zIndex")&&(O.a.off("index:changed",this.onIndexChange),this.workspace.page.off("change:viewport",this.onIndexChange)),this.stopListening(this.model,"animation:trigger:add"),this.stopListening(this.model,"animation:trigger:remove"),this.stopListening(this.model,"animation:type:change"),this.workspace.off("workspace-resize",this.onWorkspaceResize),this.$el.off(),this.panel&&(this.panel.destroy(),delete this.panel),this.trigger("destroy")}},{getViewportDefaults:function(t,e,i){i=i||{};var n,o=k.c.getViewportSetting("width","default"),a=k.c.getViewportSetting("width",e),r=Math.round((a-o)/2),s=t.get("is_full_width")&&"default"!==e,l=t.get("is_full_height")&&"default"!==e,c=t.get("fixed_position");return n={x:t.get("x"),y:t.get("y")},(i.clone||i.copy)&&(r=0),c?(n.x=n.x-RM.constructorRouter.workspace.position.left,n.y=n.y-RM.constructorRouter.workspace.position.top,["n","c","s"].indexOf(i.fixed||c)>-1&&delete n.x,["w","c","e"].indexOf(i.fixed||c)>-1&&delete n.y):n.x=n.x+r,s&&(n.is_full_width=!1,n.w=t.get("full_width_initial_w")||t.get("w"),c||(n.x=(t.get("full_width_initial_x")||t.get("x"))+r)),l&&(n.is_full_height=!1,n.h=t.get("full_height_initial_h")||t.get("h"),c||(n.y=t.get("full_height_initial_y")||t.get("y"))),t.get("triggers")&&(n.triggers=I(t.get("triggers"))),n}});B.prototype.template=d.a["template-constructor-block"],RM.vue=RM.vue||{},RM.vue.Sizes=o.default.extend(b);e.a=B},qOkM:function(module,exports){module.exports={"template-constructor-control-text_styles":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Styles" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\n\t\t<div class="common-wrapper">\n\n\t\t\t<div class="edit-scroll-wrapper">\n\t\t\t\t<div class="edit-content-wrapper">\n\t\t\t\t\t<div class="edit-content">\n\n\t\t\t\t\t\t<div class="edit-item">\n\t\t\t\t\t\t\t<input class="caption" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item font-family-click-area">\n\t\t\t\t\t\t\t<div class="font-family"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item font-style-click-area">\n\t\t\t\t\t\t\t<div class="font-style"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item color-click-area">\n\t\t\t\t\t\t\t<div class="color-value"></div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item ">\n\t\t\t\t\t\t\t<input class="font-size" data-param="font-size" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t\t<div class="font-size-icon" title="Font Size"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item">\n\t\t\t\t\t\t\t<input class="line-height" data-param="line-height" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t\t<div class="line-height-icon" title="Line Height"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item">\n\t\t\t\t\t\t\t<input class="letter-spacing" data-param="letter-spacing" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t\t<div class="letter-spacing-icon" title="Tracking"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item">\n\t\t\t\t\t\t\t<div class="text-align-left switcher" title="Left Align" data-param="text-align" data-val="left"></div>\n\t\t\t\t\t\t\t<div class="text-align-center switcher" title="Center" data-param="text-align" data-val="center"></div>\n\t\t\t\t\t\t\t<div class="text-align-right switcher" title="Right Align" data-param="text-align" data-val="right"></div>\n\t\t\t\t\t\t\t<div class="text-align-justify switcher" title="Justify" data-param="text-align" data-val="justify"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item">\n\t\t\t\t\t\t\t<div class="text-transform switcher" title="All Caps" data-param="text-transform" data-val="uppercase"></div>\n\t\t\t\t\t\t\t<div class="text-underline switcher" title="Underline" data-param="text-decoration" data-val="underline"></div>\n\t\t\t\t\t\t\t<div class="text-strike switcher" title="Strike" data-param="text-decoration" data-val="line-through"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item paddings">\n\t\t\t\t\t\t\t<div class="padding-icon"></div>\n\t\t\t\t\t\t\t<input class="padding-left" title="Left Margin" data-param="padding-left" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t\t<input class="padding-right" title="Right Margin" data-param="padding-right" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t\t<input class="padding-top" title="Top Margin" data-param="padding-top" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t\t<input class="padding-bottom" title="Bottom Margin" data-param="padding-bottom" spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="tag-changer">\n\t\t\t\t\t\t\t&lt;<span>p</span>&gt; tag\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="edit-scroll"></div>\n\t\t\t</div>\n\n\n\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t<div class="resizable-content">\n\t\t\t\t\t\t<div class="paragraph-style" data-id="paragraph-none">\n\t\t\t\t\t\t\t<div class="style-caption paragraph-none">None</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="styles-wrapper"></div>\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t</div>\n\n\t\t</div>\n\n\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\n\t\t<div class="add-block">\n\t\t\t<div class="add" title="Create Style from Selection"></div>\n\t\t\t<div class="save">Save</div>\n\t\t\t<div class="cancel" title="Cancel Changes"></div>\n\t\t</div>\n\n\n\t\t<div class="colorbox_container"></div>\n\n\t\t<div class="fontselector_container"></div>\n\n\t\t<div class="fontstyle_container">\n\t\t\t<div class="font-style-wrapper">\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="style-menu transition-enable">\n\t\t\t<div class="top-block">\n\t\t\t\t<div class="redefine-button">Redefine Style</div>\n\t\t\t\t<div class="text-block">from selection</div>\n\t\t\t\t<div class="revert-block"><div class="revert-button">Revert</div> to original</div>\n\t\t\t</div>\n\n\t\t\t<div class="separator top-separator"></div>\n\t\t\t<div class="edit-button">Edit Style</div>\n\t\t\t<div class="separator"></div>\n\t\t\t<div class="duplicate-button">Duplicate</div>\n\t\t\t<div class="separator separator-delete"></div>\n\t\t\t<div class="delete-button">Delete</div>\n\n\t        <div class="corner-wrapper">\n\t            <div class="corner"></div>\n\t        </div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-text_styles-style":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="\n\t";var currentTag="undefined"!=typeof tag?tag:"p";__p+='\n\t<div class="paragraph-style" data-id="'+(null==(__t=_name)?"":_.escape(__t))+'" data-tag="'+(null==(__t=currentTag)?"":_.escape(__t))+'">\n\t\t<div class="style-caption '+(null==(__t=_name)?"":_.escape(__t))+'">'+(null==(__t=_caption)?"":_.escape(__t))+'</div>\n\t\t<div class="tag-changer">'+(null==(__t=currentTag)?"":_.escape(__t))+'</div>\n\t\t<div class="menu-button"></div>\n\t</div>\n'}return __p}}},rDYU:function(module,exports){module.exports={"template-constructor-block-slideshow":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<input class="uploadInput" type="file" name="upload" multiple="multiple" data-url="/api/upload/lambda/" />\n\t<div class="slideshow-overlay jsSlideshowOverlay"></div>\n\n\t<div class="drop-text"></div>\n\n';return __p}}},rH4x:function(t,e,i){},rVpV:function(t,e,i){"use strict";var n=i("rFsW"),o=i("roQd"),a=i("OTSC"),r=i("v92f"),s={GLOBAL_UNIQUE_KEYS:["hidden","z"],GLOBAL_UNIQUE_KEY_PREFIX:"_",FADE_DURATION:200,getUniqueValue:function(t,e,i){var o=e[this.GLOBAL_UNIQUE_KEY_PREFIX+t]||[],a=n.a.findWhere(o,{pid:i});return void 0===(a=a||n.a.findWhere(o,{pid:"default"})||{}).value?e[t]:a.value},resetGlobalData:function(t,e){var i=this;return n.a.each(r.b.viewport_listall,(function(o){n.a.each(i.GLOBAL_UNIQUE_KEYS,(function(a){o==="viewport_"+e?t.set(i.GLOBAL_UNIQUE_KEY_PREFIX+a,[]):n.a.isEmpty(t[o])||(t[o][i.GLOBAL_UNIQUE_KEY_PREFIX+a]=[])}))})),{}},isGlobalKey:function(t){return-1!==this.GLOBAL_UNIQUE_KEYS.indexOf(t)},getGlobalPrefixedKey:function(t){return this.isGlobalKey(t)?this.GLOBAL_UNIQUE_KEY_PREFIX+t:null},fillUniqueAttributeSets:function(t,e,i){var o={};return e.is_global?(Object(n.a)(this.GLOBAL_UNIQUE_KEYS).each(function(a){if(n.a.has(t,a)&&void 0!==t[a]){var r=e[this.GLOBAL_UNIQUE_KEY_PREFIX+a]||[],s=n.a.findWhere(r,{pid:i}),l=n.a.findWhere(r,{pid:"default"});s?s.value=t[a]:r.push({pid:i,value:t[a]}),l||r.push({pid:"default",value:void 0===e[a]?null:e[a]}),o[this.GLOBAL_UNIQUE_KEY_PREFIX+a]=r}}.bind(this)),o):t},ensurePageDefRecord:function(t){Object(n.a)(this.GLOBAL_UNIQUE_KEYS).each(function(e){var i=t[this.GLOBAL_UNIQUE_KEY_PREFIX+e]||[];n.a.findWhere(i,{pid:"default"})||i.push({pid:"default",value:void 0===t[e]?null:t[e]}),t[this.GLOBAL_UNIQUE_KEY_PREFIX+e]=i}.bind(this))},fillUniqueValues:function(t,e,i){i=i||{},n.a.each(t,(function(o,a){if(n.a.contains(this.GLOBAL_UNIQUE_KEYS,a)&&(!i.props||n.a.contains(i.props,a))){var r=this.getUniqueValue(a,t,e);t[a]=void 0===r?o:r}}),this)},isHidden:function(t,e,i){return this.getUniqueValue("hidden",t,e)||!i&&o.a.hasExpired(t)},show:function(t,e){e=Boolean(e),t.$el.toggleClass("no-transition",e),t.$el.addClass("above-all-fade"),t.$el.hasClass("fade-in")&&!e||(t.cancelHide&&t.cancelHide(),t.show(),n.a.delay((function(){t.$el.addClass("fade-in")}),50))},hide:function(t,e){return e=Boolean(e),t.$el.addClass("above-all-fade"),new window.Promise((function(i){t.$el.hasClass("fade-in")||e?(t.$el.toggleClass("no-transition",e),t.$el.removeClass("fade-in"),e?(t.hide(),i()):t.cancelHide=a.default.waitForTransitionEnd(t.$el,s.FADE_DURATION,"opacity",(function(){t.hide(),i()}))):i()}))}};e.a=s},rgKy:function(module,exports){module.exports={"template-constructor-helpers-upload-input":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<input class="rm-upload-input"\n\t       type="file"\n\t       name="upload"\n\t       data-url="/api/upload/" />\n\n';return __p}}},roQd:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("pFlR"),l=i("OTSC"),c=i("QNiq");function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var m={LOOP_TYPES:{swing:"swing",repeat:"repeat"},EVENT_TYPES:["load","scroll","hover","click"],POINTER_EVENTS:["click","hover"],EXTERNAL_TRIGGER_BLOCK_EXCLUDE:["facebook","twitter","form","gmaps","slideshow","audio","video"],ANIMATION_BLOCK_EXCLUDE:["facebook","twitter"],POINTER_EVENTS_BLOCK_EXCLUDE:["form","gmaps","slideshow","audio","video"],DEFAULT_LOOP_TYPE:"swing",ACTIVE_TRIGGER_CLASS:"active-trigger",ACTIVE_TRIGGER_REMOVE_CLASS:"active-trigger-remove",ACTIVE_TRIGGER_HIGHLIGHT_CLASS:"active-trigger-highlight",ANIMATIONS_PLAYED_STORAGE_KEY:"animationsPlayed",DEG_TO_RAD:Math.PI/180,ANIMATION_PROPERTIES:function(){var t=!1,e="animation",i="AnimationIteration",n="AnimationEnd",o="animation-timing-function",a="@keyframes",r="transform",s="transform",l="Webkit Moz O ms Khtml".split(" "),c="webkit moz o MS кhtml".split(" "),d=document.createElement("div");if(null!=d.style.animationName)t=!0,i=i.toLowerCase(),n=n.toLowerCase();else for(var h=0;h<l.length;h++)if(null!=d.style[l[h]+"AnimationName"]){e=l[h]+"Animation",i=c[h]+i,n=c[h]+n,o="-"+l[h].toLowerCase()+"-"+o,a="@-"+l[h].toLowerCase()+"-keyframes",t=!0;break}if(null==d.style.transform)for(h=0;h<l.length;h++)if(null!=d.style[l[h]+"Transform"]){r=l[h]+"Transform",s="-"+l[h].toLowerCase()+"-transform";break}return d=null,{animationSupported:t,animationJS:e,animationIterationJS:i,animationEndJS:n,animationTimingFunctionCSS:o,keyframeCSS:a,transformJS:r,transformCSS:s}}(),createAnimationTimeline:function(t){return new b(t)},getNormalizedAnimation:function(t,e,i,n,o,a,l,c){var d={dx:0,dy:0,from_opacity:100,opacity:100,from_rotate:0,rotate:0,from_scale:100,scale:100},h={use_move:["dx","dy"],use_opacity:["from_opacity","opacity"],use_rotate:["from_rotate","rotate"],use_scale:["from_scale","scale"]},u=r.a.extend({},t),p=u.loop;u.loop=!1,u.steps=[];for(var m={dx:0,dy:0},g=0;g<t.steps.length;g++){var f=r.a.extend({},t.steps[g]);r.a.each(h,r.a.bind((function(t,e){f[e]?(d[t[0]]=f[t[0]],d[t[1]]=f[t[1]]):(f[t[0]]=d[t[0]],f[t[1]]=d[t[1]])}),this)),i&&(f.dx=0,f.rotate=0,f.from_rotate=0),n&&(f.dy=0,f.rotate=0,f.from_rotate=0),"scroll"!=u.type||e||0!=g||(f.delay_px=0),1!=o&&e&&(f.dx*=o,f.dy*=o),"scroll"==u.type?(f.calcedDuration=v(f,m),f.calcedDelay=f.delay_px?f.delay_px*s.a.normalize(o,void 0,a,l,c):0):(f.calcedDuration=f.duration||.001,f.calcedDelay=f.delay||0),f.acceleration=f.acceleration||"none","scroll"===u.type?f.loop=!1:p&&0===g&&(f.loop=p),u.steps.push(f),m=f}return u.trigger=t.trigger&&!r.a.isArray(t.trigger)?[t.trigger]:r.a.clone(t.trigger)||[],u;function v(t,e){var i,n=t.dx-e.dx,o=t.dy-e.dy;return i=0!=n||0!=o?Math.pow(n*n+o*o,.5)/t.speed:300/t.speed,Math.ceil(i)}},normalizeLoopValue:function(t){return!!t&&(this.LOOP_TYPES[t]||this.DEFAULT_LOOP_TYPE)},isExternalTriggerAllowed:function(t){return this.isPointerEvent(t)},normalizeAnimationTriggers:function(t){return t&&!r.a.isArray(t)?[t]:r.a.clone(t)||[]},normalizeAnimations:function(t){return t&&!r.a.isArray(t)?[t]:t||[]},isEmpty:function(t){return!(t&&t.type&&"none"!==t.type&&t.steps&&t.steps.length)},isMoveOnly:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.steps&&t.steps.length&&t.steps.every((function(t){return t.use_move&&!t.use_scale&&!t.use_rotate}))},isNonMove:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.steps&&t.steps.length&&t.steps.every((function(t){return!t.use_move}))},getUuidHash:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map((function(t){return t.UUID})).filter((function(t){return t})).sort().join(",")},isPointerEvent:function(t){return-1!==this.POINTER_EVENTS.indexOf(t)},canHaveAnimation:function(t){var e=t.attributes||t.model&&t.model.attributes||{};return e.type&&-1===this.ANIMATION_BLOCK_EXCLUDE.indexOf(e.type)},arePointerEventsAllowed:function(t){var e=t.attributes||t.model&&t.model.attributes||{};return e.type&&-1===this.POINTER_EVENTS_BLOCK_EXCLUDE.indexOf(e.type)},getBlocksContainingTriggers:function(t){var e=r.a.map(t,(function(t){return t.id||t._id}));return r.a.reduce(t,function(t,i){var n=this.normalizeAnimations(i.model?i.model.get("animation"):i.animation),o=[].concat(u(n.reduce((function(t,e){return e.trigger?[].concat(u(t),u(m.normalizeAnimationTriggers(e&&e.trigger))):t}),[])),u(i.triggers||i.model&&i.model.get("triggers")||[]));return o.length&&r.a.intersection(e,o).length&&t.push(i.id?i.id:i._id),t}.bind(this),[])},restoreTriggers:function(t,e,i){var n=[];return r.a.each(t,function(t){var o=this,a=e[t],s=r.a.find(i,{id:a});if(s&&s.getAllTriggers().length){n.push(s),s.model.getAnimations().forEach((function(t){var i=o.normalizeAnimationTriggers(t&&t.trigger);t.trigger=i.reduce((function(t,i){return e[i]?[].concat(u(t),[e[i]]):t}),[])}));var l=s.model.get("triggers");l&&s.model.set("triggers",l.reduce((function(t,i){return e[i]?[].concat(u(t),[e[i]]):t}),[]))}}.bind(this)),n},isScaleUp:function(t){return Boolean(r.a.find(t&&t.steps,(function(t,e){return t.use_scale&&(0===e&&t.from_scale>100||t.scale>100)})))},maxScaleAnimation:function(t){return t&&t.steps&&t.steps.length?t.steps.reduce((function(t,e){return Math.max(t,e.from_scale||0,e.scale||0)}),0):0},canBeAccelerated:function(t){return!c.a.isDesktop||!this.isScaleUp(t)},getPermanentAnimationId:function(t,e){return t.fixed_position||t.is_full_width||t.is_full_height||t.sticked?t._id:e},getAnimationsPlayed:function(){if(r.a.isUndefined(this._animationsPlayed))try{var t=Modernizr.localstorage?window.localStorage.getItem(this.ANIMATIONS_PLAYED_STORAGE_KEY):l.default.getCookie(this.ANIMATIONS_PLAYED_STORAGE_KEY),e=t&&JSON.parse(t);this._animationsPlayed=r.a.isArray(e)?e:[]}catch(t){this._animationsPlayed=[]}return this._animationsPlayed},persistHasPlayed:function(t){if(!this.hasPlayed(t))try{var e=JSON.stringify([].concat(this.getAnimationsPlayed(),t));Modernizr.localstorage?window.localStorage.setItem(this.ANIMATIONS_PLAYED_STORAGE_KEY,e):l.default.createCookie(this.ANIMATIONS_PLAYED_STORAGE_KEY,e),delete this._animationsPlayed}catch(t){}},hasPlayed:function(t){return t&&-1!==this.getAnimationsPlayed().indexOf(t)},hasExpired:function(t){var e=this,i=this.normalizeAnimations(t.animation);return Boolean(i.length)&&i.every((function(i){var n=e.getPermanentAnimationId(t,i.UUID);return i.playOnce&&e.hasPlayed(n)}))}},g=0,f=m.ANIMATION_PROPERTIES,v=function(){function t(e){var i=e.id,n=e.steps,o=e.initialStep;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),h(this,"name",void 0),h(this,"duration",void 0),h(this,"iterationCount",void 0),h(this,"fillMode","none"),h(this,"css",void 0),h(this,"hasRotation",!1),h(this,"force3d",void 0),h(this,"loop",void 0),this.name="animation_".concat(i);var a=n.find((function(t){return t.loop}));this.loop=!!a&&m.normalizeLoopValue(a.loop),this.iterationCount=this.loop?"infinite":1,this.hasRotation=n.find((function(t,e){return Boolean(t.use_rotate&&(0===e&&0!==t.from_rotate||0!==t.rotate))})),this.duration=n.reduce((function(t,e){return t+e.calcedDelay+e.calcedDuration}),0),this.css=t.getKeyframes(i,n,this.duration,this.hasRotation,this.force3d,o)}var e,i,n;return e=t,n=[{key:"getKeyframes",value:function(t,e,i,n,o,a){for(var r=0,s=[[0]],l=e.length,c=0;c<l;c++){var d=e[c].calcedDelay/i,h=e[c].calcedDuration/i;d>=1e-4?s[s.length-1].push(r+d):d=0,r+=d+h,c==l-1&&(r=1),s.push([r])}var u="".concat(f.keyframeCSS," animation_").concat(t," {\n"),p={none:"linear","ease-in":"ease-in","ease-out":"ease-out","ease-both":"ease-in-out"};for(u+=this.getKeyframe(s[0],{dx:a?a.dx:0,dy:a?a.dy:0,opacity:a?a.opacity:e[0].from_opacity,rotate:a?a.rotate:e[0].from_rotate,scale:a?a.scale:e[0].from_scale},p[e[0].acceleration],n,o),c=0;c<l;c++)u+=this.getKeyframe(s[c+1],e[c],e[c+1]?p[e[c+1].acceleration]:void 0,n,o);return u+="}\n"}},{key:"getKeyframe",value:function(t,e,i,n,o){var a="\t";return a+=r.a.map(t,(function(t){return 100*t+"%"})).join(", ")+" {",a+=f.transformCSS+": "+this.getTransformString({x:e.dx,y:e.dy,angle:e.rotate,scale:e.scale/100,hasRotation:n,isKeyframe:!0,force3d:o})+"; ",a+="opacity: "+(0===e.opacity?0:e.opacity/100)+"; ",i&&(a+=f.animationTimingFunctionCSS+": "+i),a+="}\n"}},{key:"getTransformString",value:function(t){var e,i=t.x,n=t.y,o=t.angle,a=t.scale,r=t.hasRotation,l=t.isKeyframe,c=t.force3d;if(a<.001&&(a=.001),r&&l)e=c?"translate3d(".concat(i,"px, ").concat(n,"px, 0) rotate(").concat(o,"deg) scale(").concat(a,")"):"translate(".concat(i,"px, ").concat(n,"px) rotate(").concat(o,"deg) scale(").concat(a,")");else{var d=a,h=0;if(o&&(o*=m.DEG_TO_RAD,d=Math.cos(o)*a,h=Math.sin(o)*a),d=Math.abs(d)<1e-6?0:d,h=Math.abs(h)<1e-6?0:h,Modernizr.edge){var u,p=null===(u=window.RM.viewerRouter)||void 0===u?void 0:u.mag;p&&(n*=s.a.getRatio(p.getViewportWidth(p.viewport)))}var g=d+","+h,f=-h+","+d,v=i+","+n;e=c?"matrix3d(".concat(g,",0,0,").concat(f,",0,0,0,0,1,0,").concat(v,",0,1)"):"matrix(".concat(g).concat(",").concat(f).concat(",").concat(v,")")}return e}}],(i=[{key:"getDirection",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?this.loop===m.LOOP_TYPES.repeat?"reverse":"alternate-reverse":this.loop===m.LOOP_TYPES.repeat?"normal":"alternate"}}])&&d(e.prototype,i),n&&d(e,n),t}(),b=a.a.View.extend({initialize:function(t){r.a.bindAll(this),r.a.extend(this,t),f.animationSupported&&(this.active=!1,this.reversed=!1,this.$el.toggleClass("force3d",!!this.force3d),"scroll"!==this.type?(this.generateKeyframeAnimation(),this.duration=this.sequences.reduce((function(t,e){return t+e.duration}),0)):(this.duration=this.steps.reduce((function(t,e){return t+e.calcedDelay+e.calcedDuration}),0),this.generateFrameByFrameAnimation()))},generateKeyframeAnimation:function(){var t=this;g+=1,this.id=g,this.sequences=this.steps.reduce((function(e,i,n){var o=t.steps.slice(n+1),a=o.findIndex((function(t){return t.loop}));return 0===n||i.loop?[].concat(u(e),[new v({id:"".concat(t.id,"_").concat(e.length+1),steps:[i].concat(u(o.slice(0,-1!==a?a:o.length))),force3d:t.force3d,initialStep:e.length?t.steps[n-1]:void 0})]):e}),[]),this.loop=this.sequences.map((function(t){return t.loop})).find((function(t){return t})),this.isFullLoop=1===this.sequences.length&&Boolean(this.sequences[0].loop),this.keyframesStyle=document.createElement("style"),this.keyframesStyle.innerHTML=this.sequences.reduce((function(t,e){return t+e.css}),""),this.$el.append(this.keyframesStyle),this.$el.on(f.animationIterationJS,(function(e){e.stopPropagation();var i=t.sequences.find((function(t){return t.name===e.originalEvent.animationName}));i&&t.onAnimationIteration(e,i)})),this.$el.on(f.animationEndJS,(function(e){e.stopPropagation();var i=t.sequences.find((function(t){return t.name===e.originalEvent.animationName})),n=t.reversed?u(t.sequences).reverse():t.sequences;i&&i.name===n[n.length-1].name&&t.onAnimationEnd(e,i)})),this.applyStepState(this.screenshotMode&&"load"===this.type?this.steps.length-1:"initial",!0)},generateFrameByFrameAnimation:function(){var t=0,e={dx:0,dy:0,opacity:this.steps[0].from_opacity,rotate:this.steps[0].from_rotate,scale:this.steps[0].from_scale};this.frames=[],this.frames.push({ind:0,isDelay:!1,params:e});for(var i=0;i<this.steps.length;i++){var n=this.steps[i];n.calcedDelay&&(this.frames.push({ind:t+1,isDelay:!0,params:e}),t+=n.calcedDelay),e={dx:n.dx,dy:n.dy,opacity:n.opacity,rotate:n.rotate,scale:n.scale,acceleration:n.acceleration},this.frames.push({ind:t+1,isDelay:!1,params:e}),t+=n.calcedDuration}this.seek(0)},applyStepState:function(t,e){var i;if(this.$el.removeClass("invisible"),"initial"===t)this.$el[0].style[f.transformJS]=v.getTransformString({x:0,y:0,angle:this.steps[0].from_rotate,scale:this.steps[0].from_scale/100,hasRotation:this.hasRotation,isKeyframe:e,force3d:this.force3d}),i=this.steps[0].from_opacity,this.$el[0].style.opacity=0===i?0:i/100;else{var n=this.steps[t];this.$el[0].style[f.transformJS]=v.getTransformString({x:n.dx,y:n.dy,angle:n.rotate,scale:n.scale/100,hasRotation:this.hasRotation,isKeyframe:e,force3d:this.force3d}),i=n.opacity,this.$el[0].style.opacity=0===i?0:i/100}var o="hover"===this.type&&this.animationTrigger.length>0&&!this.selfTriggered,a="hover"!==this.type&&("initial"!==t||this.animationTrigger.length>0);0===i&&(o||a)&&this.$el.addClass("invisible")},play:function(){if(!this.screenshotMode&&f.animationSupported){var t=f.animationJS;this.stop(),this.$el.removeClass("invisible"),this.$el.outerHeight(),window.requestAnimationFrame(function(){var e=this;this.$el[0].style[t+"Name"]=this.sequences.map((function(t){return t.name})).join(", "),this.$el[0].style[t+"Duration"]=this.sequences.map((function(t){return t.duration+"s"})).join(", "),this.$el[0].style[t+"Delay"]=this.sequences.reduce((function(t,i,n){var o=e.sequences[n-1];return[].concat(u(t),[o?"".concat(o.duration,"s"):"0s"])}),[]).join(", "),this.$el[0].style[t+"IterationCount"]=this.sequences.map((function(t){return t.iterationCount})).join(", "),this.$el[0].style[t+"Direction"]=this.sequences.map((function(t){return t.getDirection()})).join(", "),this.$el[0].style[t+"FillMode"]=this.sequences.map((function(t){return t.fillMode})).join(", "),this.$el[0].style[t+"PlayState"]=""}.bind(this)),this.active=!0,this.reversed=!1}},reverse:function(){if(!this.screenshotMode&&f.animationSupported){var t=f.animationJS;this.stop(),this.$el.removeClass("invisible"),this.$el.outerHeight();var e=u(this.sequences).reverse().filter((function(t){return t.loop!==m.LOOP_TYPES.swing}));this.$el[0].style[t+"Name"]=e.map((function(t){return t.name})).join(", "),this.$el[0].style[t+"Duration"]=e.map((function(t){return t.duration+"s"})).join(", "),this.$el[0].style[t+"Delay"]=e.reduce((function(t,i,n){var o=e[n-1];return[].concat(u(t),[o?"".concat(o.duration,"s"):"0s"])}),[]).join(", "),this.$el[0].style[t+"IterationCount"]=e.map((function(){return 1})).join(", "),this.$el[0].style[t+"Direction"]=e.map((function(t){return t.getDirection(!0)})).join(", "),this.$el[0].style[t+"FillMode"]=e.map((function(t){return t.fillMode})).join(", "),this.$el[0].style[t+"PlayState"]="",this.active=!0,this.reversed=!0}},stop:function(){this.$el.removeClass("invisible"),this.$el[0].style[f.animationJS]="",this.active=!1,this.reversed=!1},onAnimationEnd:function(){this.reversed=!this.reversed,this.active=!1,this.$el[0].style[f.animationJS]="",this.applyStepState(this.reversed?this.steps.length-1:"initial",!0),this.trigger("full-cycle-end")},onAnimationIteration:function(t,e){this.loop===m.LOOP_TYPES.swing?Math.round(t.originalEvent.elapsedTime/e.duration)%2?this.reversed=!0:(this.reversed=!1,this.trigger("full-cycle-end")):this.trigger("full-cycle-end")},resume:function(){this.screenshotMode||f.animationSupported&&(c.a.isDesktop?this.$el[0].style[f.animationJS+"PlayState"]="running":this.play(),this.active=!0)},pause:function(){f.animationSupported&&(c.a.isDesktop?this.$el[0].style[f.animationJS+"PlayState"]="paused":this.stop(),this.active=!1)},seek:function(t){if(f.animationSupported){t=Math.max(Math.min(t,this.duration),0);var e,i,n,o,a=this.frames.length;for(e=0;e<a&&!(this.frames[e].ind>t);e++);e--,this.frames[e].isDelay?i=r(this.frames[e].params,this.frames[e].params,0,1):(n=e?this.frames[e].ind-1:0,o=e==a-1?this.duration:this.frames[e+1].ind-1,i=r(this.frames[e?e-1:0].params,this.frames[e].params,t-n,o-n+1)),this.$el[0].style[f.transformJS]=v.getTransformString({x:i.dx,y:i.dy,angle:i.rotate,scale:i.scale/100,hasRotation:this.hasRotation,isKeyframe:!1,force3d:this.force3d}),this.$el[0].style.opacity=0==i.opacity?0:i.opacity/100,this.$el.toggleClass("invisible",0==i.opacity)}function r(t,e,i,n){if(0==i)return t;if(i==n-1)return e;var o=i/(n-1);return{dx:t.dx==e.dx?t.dx:s(t.dx,e.dx,o,e.acceleration),dy:t.dy==e.dy?t.dy:s(t.dy,e.dy,o,e.acceleration),opacity:t.opacity==e.opacity?t.opacity:s(t.opacity,e.opacity,o,e.acceleration),rotate:t.rotate==e.rotate?t.rotate:s(t.rotate,e.rotate,o,e.acceleration),scale:t.scale==e.scale?t.scale:s(t.scale,e.scale,o,e.acceleration)}}function s(t,e,i,n){return t+(e-t)*(n&&"none"!=n?"ease-in"==n?i*i:"ease-out"==n?i*(2-i):i<.5?i*i*2:2*i*(2-i)-1:i)}},destroy:function(){this.$el.off(f.animationIterationJS,this.onAnimationIteration),this.$el.off(f.animationEndJS,this.onAnimationEnd),this.$el[0].style[f.animationJS]="",this.$el[0].style[f.transformJS]="",this.$el[0].style.opacity="",this.$el.removeClass("force3d"),this.keyframesStyle&&Object(n.a)(this.keyframesStyle).remove(),this.reversed=!1,this.active=!1}});e.a=m},rsO6:function(t,e,i){},rwzP:function(t,e,i){},s0L4:function(module,exports){module.exports={"template-constructor-control-hotspot-tip-settings":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="icon noarrow" data-alt="Tip Settings" data-alt-pos="left" data-alt-offset="9"></div>\n\n\n\t<div class="panel">\n\n\t\t<div class="common-wrapper">\n\n\t\t\t<div class="edit-wrapper default-state">\n\n\t\t\t\t<div class="params-wrapper clearfix">\n\n\t\t\t\t\t<div class="edit-item" data-field="tip_pos">\n\t\t\t\t\t\t<div class="caption">Position</div>\n\t\t\t\t\t\t<div class="positions">\n\t\t\t\t\t\t\t<div class="top position" data-position="top">\n\t\t\t\t\t\t\t\t<div class="fill"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="right position" data-position="right">\n\t\t\t\t\t\t\t\t<div class="fill"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="bottom position" data-position="bottom">\n\t\t\t\t\t\t\t\t<div class="fill"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="left position" data-position="left">\n\t\t\t\t\t\t\t\t<div class="fill"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t<div class="edit-item separator color-click-area" data-field="tip_background-color" data-field-dop="tip_background-color-opacity">\n\t\t\t\t\t\t<div class="caption">Color</div>\n\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t<div class="edit-item separator" data-field="tip_border-radius">\n\t\t\t\t\t\t<div class="caption">Radius</div>\n\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t</div>\n\n\n\t\t\t\t\t<div class="edit-item separator clearfix" data-field="tip_box-shadow">\n\t\t\t\t\t\t<div class="caption">Shadow</div>\n\t\t\t\t\t\t<div class="switcher"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t\t<div class="colorbox_container"></div>\n\n\t</div>\n\n';return __p}}},s1Hx:function(module,exports){module.exports={"template-constructor-control-text_color":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Color" data-alt-pos="left" data-alt-offset="9"><div class="opacity-grid"></div><div class="color-circle"></div></div>\n\n\t<div class="panel">\n\t</div>\n\n';return __p}}},secl:function(module,exports){module.exports={"template-viewer-page":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="page hidden">\n\t\t<div class="page-fixed-bg-container polyfill-sticky"></div>\n\t\t<div class="fixed-position-container-top polyfill-sticky"></div>\n\t\t<div class="fixed-position-container polyfill-sticky"></div>\n\t\t<div class="content-scroll-wrapper '+(null==(__t=isStickyVerticalViewer?"":"has-vertical-scroll")?"":__t)+'">\n\t\t\t<div class="content-bounds">\n\t\t\t\t<div class="page-content-container" tabindex="-1"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p}}},skB9:function(t,e,i){},sn3M:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var n=function(t){var e,i,n,o=t.className,a=t.selector,r=t.label,s=t.styles,l=String(o||a);return e={},i=l,n={label:r,style:"".concat(a||"."+o," { ").concat(s," }")},i in e?Object.defineProperty(e,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[i]=n,e}},sviH:function(t,e,i){"use strict";var n=i("xG9w"),o=i("q1z7"),a=i.n(o),r=i("q1tI"),s=i.n(r),l=i("xi34"),c=i("q7tt"),d=i("I0kf"),h=i("8AXF"),u=i("zjto"),p=i("8Tds"),m=i("v92f"),g=i("fueH"),f=i("DwEc"),v=i("OTSC"),b=i("q5gH"),y=i("v83y"),_=i("i0ke"),w=i("Fi5S"),k=i("Wwwp"),S=i("A9VP"),x=i("w5C2"),C=i("IrH7"),O=i("w+s/"),j=i("ICos"),P=i("WySc"),E=i("38uW");function I(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return T(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return T(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function M(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function $(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?M(Object(i),!0).forEach((function(e){A(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):M(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function A(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var R=c.a.extend({name:"Text",thumb:"text",icon_color:"#fff",sort_index:1,controls:["text_edit","text_align_new","common_animation","common_rotation","common_position","common_layer","common_lock"],edit_controls:["text_typography_new","text_align_new","text_advanced_typography","text_insert","text_link_new","text_color_new","text_columns_new"],viewport_fields:m.b.viewport_fields.text,restrictions:function(){return Object(d.a)("constructor.textv3")},initialize:function(t,e){var i=this,n=t;this.migrateOldData(n),this.setEditorZoom(window.RM.constructorRouter.zoom.getZoom());try{this.initialSharedState=this.createStateFromModel(n)}catch(t){throw console.error(t),new Error("Cannot create Text widget model")}if(this.isJustCreated=n.created,this.has_parent_block=!!n.get("parent_wid"),this.isJustCreated){if(this.has_parent_block){var o=g.a.creatNewWidgetContent({text:"Text"});n.set("blocks",o.blocks),this.initialSharedState=this.createStateFromModel(n)}var r=g.a.forceSelection(this.initialSharedState,g.a.getAllTextSelection(this.initialSharedState)),s=[{key:S.a.FontSize,value:x.b.fontSize},{key:S.a.FontFamily,value:x.b.fontFamily},{key:S.a.FontWeight,value:x.b.fontWeight},{key:S.a.FontStyle,value:x.b.fontStyle},{key:S.a.Color,value:Object(j.h)(P.c)}];this.initialSharedState=s.reduce((function(t,e){return g.a.toggleInlineStyle(t,g.a.getStyleValueString(e.key,e.value))}),g.a.forceSelection(r,g.a.getAllTextSelection(r))),this.initialSharedState=Object(E.d)({editorState:this.initialSharedState,lineHeight:x.b.lineHeight}),this.initialSharedState=Object(C.e)({editorState:this.initialSharedState,align:C.a.AlignLeft}),this.has_parent_block&&(this.initialSharedState=Object(O.d)({editorState:this.initialSharedState,paddings:{top:16,left:16,right:16,bottom:16}}),this.initialSharedState=Object(C.e)({editorState:this.initialSharedState,align:C.a.AlignCenter}))}this.initBlock(n,e),this.page=e.page,this.propsModel=new a.a.Model({useTextWidgetStore:this.useSharedState,viewport:this.page.getCurrentViewport(),isEditMode:!1,fontStyles:[],isResizing:!1,selected:!1,workspace:e,setCurrentLinkStyle:function(t){i.propsModel.set("currentLinkStyle",t)},leaveEditMode:function(){i.leaveEditMode()},canControlsBeClosed:function(){return i.canControlsBeClosed()},onIframeLoaded:function(){i.onIframeLoaded()}}),this.page.on("change:viewport",this.onViewportChange),this.page.on("change-height-start",this.onResizeStart),this.page.on("change-height-end",this.onResizeEnd),this.model.on("change",this.modelChangeCallback),this.model.on("change:entityMap",this.syncViewportEntityMap),this.model.on("change:blocksMeta",this.syncViewportBlocksMeta),this.model.on("change:blocks",this.syncViewportBlocksStyles),this.model.on("change:autosize",this.onAutosizeChanged),this.model.on("change:columns",this.onAutosizeChanged),this.workspace.on("autoLayout",this.onRestoreLayout),window.RM.constructorRouter.on("font-added",this.onFontsChanged),w.a.on("zoom",this.setEditorZoom),this.onFontsChanged()},render:function(){var t=this;this.create(),this.$el.addClass("text-v3"),this.onAutosizeChanged({disableHeightCheck:!0});Object(h.renderReact)({component:function(){return s.a.createElement(h.CreateContextProvider,{context:f.a,model:t.propsModel},s.a.createElement(u.a,null))},domElement:this.$content[0],model:this.model}),this.reactContainer=this.$content.find("div").first().get(0),this.rendered=!0,this.triggerReady(),this.isJustCreated&&(this.isJustCreated=!1,this.model.created=!1,setTimeout((function(){t.enterEditMode()}),100))},migrateOldData:function(t){if(t.get("version")!==u.h){var e=Object(k.c)(t.toJSON());if(!e)throw console.error(e),new Error("Text widget migration error");t.save(e,{silent:!0,toHistory:!1,skipHistory:!0}),this.fixViewportsAfterMigration(t)}},startRedirectIframeEvents:function(){var t,e,i,n=null===(t=this.iframe)||void 0===t||null===(e=t.contentWindow)||void 0===e||null===(i=e.document)||void 0===i?void 0:i.querySelector("body");n&&(n.addEventListener("mousemove",this.onRedirectIframeEvents),n.addEventListener("mouseup",this.onRedirectIframeEvents),n.addEventListener("click",this.onRedirectIframeEvents))},onRedirectIframeEvents:function(t){var e=this.isAutosizeEnabled()?500:0,i=new MouseEvent(t.type,{clientX:this.$el.offset().left*this.zoom+t.clientX-e,clientY:this.$el.offset().top*this.zoom+t.clientY-e,button:t.button,buttons:t.buttons,movementX:t.movementX,movementY:t.movementY,relatedTarget:t.relatedTarget,bubbles:!0,cancelable:!0});Object.defineProperty(i,"target",{value:t.target,enumerable:!0}),Object.defineProperty(i,"screenX",{value:t.screenX,enumerable:!0}),Object.defineProperty(i,"screenY",{value:t.screenY,enumerable:!0}),this.disableMouseEventsRedirection||(window.dispatchEvent(i),document.dispatchEvent(i))},stopRedirectIframeEvents:function(){var t,e,i,n=null===(t=this.iframe)||void 0===t||null===(e=t.contentWindow)||void 0===e||null===(i=e.document)||void 0===i?void 0:i.querySelector("body");n&&(n.removeEventListener("mousemove",this.onRedirectIframeEvents),n.removeEventListener("mouseup",this.onRedirectIframeEvents),n.removeEventListener("click",this.onRedirectIframeEvents))},setEditorZoom:function(t){this.zoom=t},destroy:function(){return this.leaveEditMode(),this.page.off("change:viewport",this.onViewportChange),this.page.off("change-height-start",this.onResizeStart),this.page.off("change-height-end",this.onResizeEnd),this.model.off("change",this.modelChangeCallback),this.model.off("change:entityMap",this.syncViewportEntityMap),this.model.off("change:styles",this.syncViewportBlocksMeta),this.model.off("change:blocks",this.syncViewportBlocksStyles),this.model.off("change:autosize",this.onAutosizeChanged),this.model.off("change:columns",this.onAutosizeChanged),this.workspace.off("autoLayout",this.onRestoreLayout),window.RM.constructorRouter.off("font-added",this.onFontsChanged),w.a.off("zoom",this.setEditorZoom),this.stopRedirectIframeEvents(),c.a.prototype.destroy.apply(this,arguments)},select:function(){c.a.prototype.select.apply(this,arguments),this.propsModel.set({selected:this.selected})},deselect:function(){c.a.prototype.deselect.apply(this,arguments),this.propsModel.set({selected:this.selected}),this.propsModel.get("isEditMode")&&this.leaveEditMode()},onDblClick:function(){this.selected&&(this.model.get("pack_id")&&1!==this.workspace.getSelectedBlocks().length?c.a.prototype.onDblClick.apply(this,arguments):this.enterEditMode())},enterEditMode:function(){this.frame&&(this.frame.setEditorState(),this.frame.removeRotationState(),this.frame.resetRotation()),this.workspace&&this.workspace.controls&&this.workspace.controls.setControls(this.edit_controls,this);var t=l.a.event.special.drag;t.toggle.call(Object(l.a)("#main")[0],!1),t.toggle.call(this.$el[0],!1),window.RM.common.disableShortcuts["text-v3"]=!0,this.workspace.trigger("w-text-entered-edit-mode"),this.propsModel.set({isEditMode:!0}),this.iframe&&this.startRedirectIframeEvents()},onIframeLoaded:function(){this.iframe=this.reactContainer.querySelector("iframe"),this.startRedirectIframeEvents()},leaveEditMode:function(){this.workspace.trigger("w-text-before-leave-edit-mode"),this.frame&&(this.frame.removeEditorState(),this.frame.restoreRotation()),this.workspace&&this.workspace.controls&&this.workspace.controls.setControls(this.controls,this);var t=l.a.event.special.drag;t.toggle.call(Object(l.a)("#main")[0],!0),t.toggle.call(this.$el[0],!0),delete window.RM.common.disableShortcuts["text-v3"],this.propsModel.set({isEditMode:!1}),v.default.getFocusBack(),this.workspace.trigger("w-text-leaved-edit-mode"),this.stopRedirectIframeEvents()},onWorkspaceBlocksSelect:function(t){if(c.a.prototype.onWorkspaceBlocksSelect.apply(this,arguments),this.rendered){var e=t&&1===t.length&&t[0]===this;this.propsModel.get("isEditMode")&&!e&&this.leaveEditMode()}},onViewportChange:function(){var t=this.page.getCurrentViewport();this.propsModel.set({viewport:t})},isAutosizeEnabled:function(){var t=this.model.get("autosize"),e=this.model.get("columns");return!(e&&e.count>1)&&t},getRealContentHeight:function(){var t,e,i,n=this.propsModel.get("isEditMode")?null===(t=this.iframe)||void 0===t||null===(e=t.contentWindow)||void 0===e||null===(i=e.document)||void 0===i?void 0:i.querySelector('[data-contents="true"]'):this.$el.find(".text-viewer")[0];return n?n.offsetHeight:void 0},fitContentToBox:function(){var t=this.getRealContentHeight();"number"==typeof t&&(this.model.set({h:t}),this.saveBox())},redraw:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.checkNeedRedraw(t,e))return e.viewportChange&&this.refreshState(t),c.a.prototype.redraw.apply(this,arguments)},onFontsChanged:function(){var t=Array.from(document.querySelectorAll("link.fonts, style.fonts")),e=t.map((function(t){var e,i=t.tagName.toLowerCase();return"style"===i?{tag:i,style:t.innerHTML}:{tag:i,href:(e=t.getAttribute("href"),Modernizr.safari?"".concat(e,"&edit_mode=true"):e),type:t.getAttribute("type")}}));this.propsModel.set("fontStyles",e)},onResizeStart:function(){this.disableMouseEventsRedirection=!0,this.propsModel.set("isResizing",!0)},css:function(t){if(this.propsModel.get("isResizing")&&"number"==typeof t.width&&"number"==typeof t.height){var e=this.getRealContentHeight();this.isAutosizeEnabled()&&this.model.get("h")!==e&&this.model.set("h",e)}return c.a.prototype.css.apply(this,arguments)},onResizeEnd:function(){this.disableMouseEventsRedirection=!1,this.propsModel.set("isResizing",!1)},canChangeDimension:function(t){if("height"===t){var e=this.isAutosizeEnabled();if(e)return!1}return b.a.prototype.canChangeDimension.bind(this.frame,arguments)},onResizable:function(t){t&&!this.propsModel.get("isResizing")?this.propsModel.set("isResizing",!0):!t&&this.propsModel.get("isResizing")&&this.propsModel.set("isResizing",!1)},modelChangeCallback:function(t,e){(e.undo||e.redo||e.reset)&&this.refreshState(t),this.checkHotspotFit()},getAllowableHeight:function(){var t,e,i,n=null===(t=this.iframe)||void 0===t||null===(e=t.contentWindow)||void 0===e||null===(i=e.document)||void 0===i?void 0:i.querySelector("body"),o=null==n?void 0:n.querySelector('[data-contents="true"]');if(o)return o.clientHeight},onAutosizeChanged:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.disableHeightCheck,i=this.isAutosizeEnabled();this.$el.toggleClass("text-autosize",i),i?(this.$el.find(".frameborder .dot.lt, .frameborder .dot.lb").attr("data-ind",7).attr("data-visual-direction","w"),this.$el.find(".frameborder .dot.rt, .frameborder .dot.rb").attr("data-ind",3).attr("data-visual-direction","e")):(this.$el.find(".frameborder .dot.lt").attr("data-ind",0).attr("data-visual-direction","nw"),this.$el.find(".frameborder .dot.rt").attr("data-ind",2).attr("data-visual-direction","ne"),this.$el.find(".frameborder .dot.lb").attr("data-ind",6).attr("data-visual-direction","sw"),this.$el.find(".frameborder .dot.rb").attr("data-ind",4).attr("data-visual-direction","se")),e||!i||this.propsModel.get("isEditMode")||this.model.set({h:this.getRealContentHeight()},{silent:!0,toHistory:!1,skipHistory:!0})},onRestoreLayout:function(){this.refreshState()},refreshState:function(t){var e=this.createStateFromModel(t||this.model);e&&this.nonReactSetSharedState(e)},createStateFromModel:function(t){if(t&&t.get("blocks")){var e=g.a.importTextContent(t.attributes);if(e)return y.EditorState.createWithContent(e,_.a)}},checkHotspotFit:function(){this.has_parent_block&&(this.workspace.fit_text_to_content(),this.workspace.adjust_height_to_visible_content())},canControlsBeClosed:function(){return this.workspace.controls.canControlsBeClosed()},fixViewportsAfterMigration:function(t){var e=this;m.b.viewport_listall.forEach((function(i){t[i]=n.default.pick(t.get(i),e.viewport_fields)}))},syncViewportEntityMap:function(){var t,e=this,i="viewport_".concat(this.page.getCurrentViewport()),n=this.model,o=this.model.get("entityMap")||{},a="viewport_".concat(m.a.Default);i===a||(null===(t=this.model[a])||void 0===t?void 0:t.entityMap)||(this.model[a].entityMap=o),m.b.viewport_listall.forEach((function(t){if(i!==t){var a=n[t].entityMap;if(a){var r=Object.values(a).map((function(t){var e;return null===(e=t.data)||void 0===e?void 0:e.id})),s=Object.values(o).map((function(t){var e;return null===(e=t.data)||void 0===e?void 0:e.id}));if(s.length>r.length){var l=Object.keys(o).reduce((function(t,e){var i=o[e],n=Object.keys(a).find((function(t){var e,n;return(null===(e=a[t].data)||void 0===e?void 0:e.id)===(null===(n=i.data)||void 0===n?void 0:n.id)}));return $($({},t),{},A({},e,n?a[n]:o[e]))}),{});e.model[t].entityMap=l}else if(s.length<r.length){var c=Object.keys(o).reduce((function(t,e){var i=o[e],n=Object.keys(a).find((function(t){var e,n;return(null===(e=a[t].data)||void 0===e?void 0:e.id)===(null===(n=i.data)||void 0===n?void 0:n.id)}));return n?$($({},t),{},A({},e,a[n])):t}),{});e.model[t].entityMap=c}}}}))},syncViewportBlocksMeta:function(){var t,e=this,i="viewport_".concat(this.page.getCurrentViewport()),o=this.model,a=o.get("blocksMeta")||[],r="viewport_".concat(m.a.Default);i===r||(null===(t=this.model[r])||void 0===t?void 0:t.blocksMeta)||(this.model[r].blocksMeta=a),m.b.viewport_listall.forEach((function(t){if(i!==t){var r=o[t].blocksMeta;if(r){var s=r.map((function(t){return t.key})),l=a.map((function(t){return t.key}));if(l.length>s.length){var c=n.default.difference(l,s),d=a.filter((function(t){return c.includes(t.key)}));e.model[t].blocksMeta=[].concat(I(e.model[t].blocksMeta),I(d))}else if(l.length<s.length){var h=n.default.difference(s,l),u=r.filter((function(t){return!h.includes(t.key)}));e.model[t].blocksMeta=u}}}}))},syncViewportBlocksStyles:function(){var t="viewport_".concat(this.page.getCurrentViewport()),e=this.model,i=e.get("blocks")||[],n=e.previous("blocks")||[],o=i.filter((function(t){var e=n.find((function(e){return e.key===t.key}));return e&&t.text.length!==e.text.length}));o.length&&m.b.viewport_listall.forEach((function(i){if(t!==i){var a=e[i].styles,r=e[i].blocksMeta,s=e[i].entityMap,l=g.a.importTextContent({styles:a,blocksMeta:r,entityMap:s,blocks:n}),c=o.reduce((function(t,e){var i=n.find((function(t){return t.key===e.key}));if(i){var o=g.a.getStringDifference(i.text,e.text);if(o){if(o.added){var a=o.offset,r=t.getSelection().merge({anchorKey:e.key,anchorOffset:a,focusOffset:a,focusKey:e.key});return g.a.insertText({editorState:g.a.forceSelection(t,r),text:o.text,selection:r})}if(!o.added){var s=t.getSelection().merge({anchorKey:e.key,anchorOffset:o.offset,focusOffset:o.offset+o.length,focusKey:e.key});return g.a.removeText({editorState:t,selection:s})}}}return t}),y.EditorState.createWithContent(l)),d=g.a.exportTextContent(c.getCurrentContent()).styles;e[i].styles=d}}))}},{getViewportDefaults:function(t,e,i){return $($({},c.a.getViewportDefaults(t,e,i)),{},{styles:t.get("styles"),blocksMeta:t.get("blocksMeta"),bgColor:t.get("bgColor"),columns:t.get("columns"),entityMap:t.get("entityMap")})},defaults:{version:u.h,verticalAlign:p.d.top,textDirection:p.b.LTR,autosize:!0,blocks:function(){var t=g.a.creatNewWidgetContent().blocks;return t},styles:[],entityMap:{},flags:{baseline:!0}}}),D=i("rFsW"),B=i("DqjY"),L=i("onY4"),z=i("D12m"),F=i("5DNN"),U=i.n(F),N=i("7jD/"),H=i.n(N),V=i("RX7I"),W=i("pFlR"),G=["The follies of others are obvious, but our own hide from us; we love to parse others’ missteps but we cover up our own, as the cheat conceals the false die. It is in the nature of men to lay blame: we see others’ mistakes while our own passions swell, carrying us ever farther from improvement. — Buddhist wisdom","No one can long stand on tiptoe. He who thrusts himself forward is not a source of light. No glory comes to the self-satisfied, no honor to the boastful. The proud will not rise high. In the court of good sense, such people are like table discards, repellent to all. The sensible person does not rely on self. — Lao-Tzu","Simplicity in life, language and habits strengthens a nation, but a life of luxury, fancy language and effeminate habit leads to weakness and death. — John Ruskin","Truth is not a matter of talking but comes only through labor and observation. And when you have one truth in hand, two others, like the first leaves of a dicotyledonous plant, will probably appear. — John Ruskin","All things have a beginning and an end. So it is with mankind: there is a beginning and end to all  human affairs. He who understands what is a beginning and what is an end is closer to the truth. — Confucius","Most people are dismayed if deprived of their pleasures. The right course belongs to him who relishes even the passing away of the reason for his joy and is not bitter. — Pascal","When we are clear about things, we have knowledge; with knowledge, we seek the path of truth; when the search is rewarded, the heart becomes good; with the heart made good, the moral view of things that leads to virtue is attained. — Confucius","Wisdom has three faces: when seen from afar, it is grand and severe; on closer approach, it is tender and welcoming; when we are close enough to hear it, the words of  wisdom are severe and demanding. — Chinese wisdom","The sun constantly floods the world with its light, but its light is not exhausted; so your mind should send its light in all directions and not be exhausted. It should flow everywhere, without diminishment, and when it encounters an obstacle, it should react, not with annoyance or anger but should serenely clarify all that yearns to accept it, without any lessening or weariness, bringing light to all that is turned to it, leaving in shadow only that which turns its face away. — Marcus Aurelius","As torches and fireworks pale to invisibility in the sun, so the mind, even the mind of genius, and beauty pale and are eclipsed by the heart’s goodness. — Schopenhauer","Music and sweet treats bring the wanderer to a stop, but wisdom has neither flavor nor smell. When looked for, it is invisible; when listened for, it is inaudible, yet its goodness is inexhaustible. The most powerful thing in the world cannot be seen, heard or touched. — Lao-Tzu","The best ideas are usually those that come without effort, out of the blue. The great intellectual creations come easily. Only a great person can create something great, and such a one works without strain. — John Ruskin","He who talks much rarely puts his words into action. But the wise person fears that his words may not be translated into action. The wise do not utter empty words, lest their actions be inconsistent with their words. — Chinese wisdom","Fear ignorance, but fear false knowledge even more. Turn your eyes from the deceptive world and do not trust your feelings, for they lie; rather look inward to the impersonal, eternal self. Truly, ignorance is like a sealed and airless chamber; in it, the soul sits like a caged bird, neither singing nor spreading its wings. But ignorance is better than any school of thought that is not guided by the wisdom of the soul. — Buddhist wisdom","Some seek their good or happiness in power; others in science, and others in the pleasures of the flesh. But those who come truly close to the good understand that it cannot consist in what can only be mastered by a few. They understand that the true good of humankind is that which can be achieved by all people, without division and without envy; its nature  is such that none can lose it if they do not so choose. — Pascal","The wise person asks only of himself; the unwise man demands everything from others. — Chinese wisdom","To know much and not to put one’s self forward as knowing is the height of morality. To know little and put one’s self forward as knowledgeable is an illness. Only by understanding the disease can one expunge it. — Lao-Tzu","Speak only of that which is as clear to you as the morning, or be silent. — Talmud","Conquer ferocity with love, evil with good, miserliness with generosity, the liar with truth. — Buddhist wisdom","People seek satisfaction, throwing themselves from one thing to another because they feel the emptiness of their lives but do not yet realize the emptiness of the new delight that attracts them. — Pascal","The skilled warrior does not rage. The skilled fighter is not angry. He who is skilled in the use of people is not provocative. This is the virtue of non-resistance. This is being in agreement with Heaven. — Lao-Tzu","The first and principal characteristic of a good and wise person is his consciousness that he knows very little, that many people know more and he seeks always to learn, to study, and not to teach. Those who wish to teach or direct neither teach nor lead well. — John Ruskin","The virtuous person seeks to follow the direct path to the end. What is to be feared is to go halfway and then to weaken. — Chinese wisdom"],q='<p style="line-height: 22px; padding: 16px 16px; text-align: center; font-family: Georgia; font-size: 16px;" data-size-leading-linked="false" data-size-leading-ratio="1.25"><span></span></p>',K=c.a.extend({name:"Text",thumb:"text",sort_index:1,icon_color:"#FFFFFF",controls:["text_edit","text_autosize","common_animation","common_rotation","common_position","common_layer","common_lock"],edit_controls:["text_styles","text_typography","text_bius","text_align","text_link","text_color","text_columns"],viewport_fields:m.b.viewport_fields.text,text_viewport_attributes:[],validElements:{"#span":["style","id","class","data-id","data-url","data-start","data-end","data-plays"],"#p":["style","class","data-size-leading-linked","data-size-leading-ratio"],br:[],a:["data-pid","data-uuid","style","class","href","target","data-anchor-link-pos"]},params:{multipleName:"multiple values",tabIndent:28,fontSizeLineHeightRatio:1.25,minFontSize:8,maxFontSize:999,minLineHeight:8,maxLineHeight:999,minLetterSpacing:-99,maxLetterSpacing:999},zoom:1,EDITOR_STYLES:':root { --editor-zoom: 1; }body {width: 100%;height: 100%;overflow: hidden;margin:0;padding:0;-webkit-margin-before: 0em;-webkit-margin-after: 0em;-webkit-margin-start: 0px;-webkit-margin-end: 0px;word-wrap: break-word;white-space: pre-wrap;background: transparent;-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;-webkit-column-fill: auto !important;-moz-column-fill: auto !important;column-fill: auto !important;-webkit-nbsp-mode: normal;transform: scale(var(--editor-zoom));transform-origin: left top;}body.v1 {font-family: "Source Sans Pro";font-weight: 400;font-style: normal;font-size: 16px;line-height: 20px;}body.v2 {font-family: "Roboto";font-weight: 400;font-style: normal;font-size: 18px;line-height: 26px;}span.nbsp {position: relative;z-index: -1;}span.nbsp:before {content: "⋀";position: absolute;color: #1cdeb4;font-size: .4em;font-weight: bold;left: 0;top: .7em;}h1, h2 {margin: 0;}p {color: #000000;margin: 0;padding: 0;-webkit-margin-before: 0em;-webkit-margin-after: 0em;-webkit-margin-start: 0px;-webkit-margin-end: 0px;}.margin-st, .margin-ed {margin: 0;padding: 0;-webkit-margin-before: 0em;-webkit-margin-after: 0em;-webkit-margin-start: 0px;-webkit-margin-end: 0px;height: 1px;}.margin-st {margin-bottom: -1px;}.margin-ed {margin-top: -1px;}a {color: inherit;text-decoration: underline;}a * {text-decoration: underline;}a, span {line-height: 1px !important;font-size: inherit !important;}span.soundcite {position: relative;padding: 0 0.2em 0 1.3em;display: inline;line-height: 120% !important;background: rgba(0, 0, 0, 0.1);}span.soundcite:before {content: "";position: absolute;top: 0.21em;left: 0.3em;border-width: 0.4em;border-style : solid;border-right-color: transparent;border-bottom-color: transparent;border-top-color: transparent;border-left-width : 0.6em;}',initialize:function(t,e){t.get("version"),this.initBlock(t,e),this.frameClass=tt,this.pid=e.page.id,this.page=e.page,this.setEditorZoom(RM.constructorRouter.zoom.getZoom()),this.inner_template=U.a["template-constructor-block-text"],this.setInitialParams(),this.changeStyleParagraph.__debounced=D.a.debounce(this.changeStyleParagraph,40),this.changeClassParagraph.__debounced=D.a.debounce(this.changeClassParagraph,40),this.changeStyleSpan.__debounced=D.a.debounce(this.changeStyleSpan,40),this.changeColumns.__debounced=D.a.debounce(this.changeColumns,40),this.changeLink.__debounced=D.a.debounce(this.changeLink,40),this.onChangeInEditor_throttle500=D.a.throttle(this.onChangeInEditor.bind(this),500),this.onChangeInEditor_throttle1500=D.a.throttle(this.onChangeInEditor.bind(this),1500),this.onChangeInEditor_throttle=function(){this.onChangeInEditor_throttle500(),this.onChangeInEditor_throttle1500()}.bind(this),this.recalcStyleDebounced=D.a.debounce(this.recalcStyle,50),this.model.on("change",this.onModelChange),RM.constructorRouter.on("font-added",this.onFontAdd),!this.model.isNested&&this.page.on("change:viewport",this.onViewportChange),this.has_parent_block&&(this.needSideMarginsSynhronized=!0,this.needClearMarginsOnEnter=!0,this.needPreserveLastPadding=!0,this.needIgnoreSlylesMargins=!0),w.a.on("zoom",this.setEditorZoom)},onFontAdd:function(){this.isEditorActive()&&B.a.appendFontsCssToIFrame(this.iframe_document)},setEditorZoom:function(t){this.zoom=t,this.$iframe_document&&this.$iframe_document[0].documentElement.style.setProperty("--editor-zoom",t)},switchTextToViewport:function(t,e){},switchTextToDefault:function(t){t=t||"";var e=this.model.isNested?"default":this.page.getCurrentViewport();if("default"==e)return t;var i=Object(l.a)("<div>").html(t),n=this.text_viewport_attributes,o=this;i.find("*").each((function(){var t=Object(l.a)(this);D.a.each(n,(function(i){var n=o.getViewportAttributeName(i,e),a=o.getViewportAttributeName(i,"default"),r=t.attr(a),s=t.attr(i);t.removeAttr(i),t.removeAttr(a),r&&t.attr(i,r),t.attr(n,s||"empty")}))}));var a=i.html();return i.empty().remove(),a},generateValidElementsList:function(){var t=D.a.pluck(m.b.viewports,"name"),e=this;return D.a.each(this.validElements,(function(i,n){var o=[];D.a.each(i,(function(i){D.a.indexOf(e.text_viewport_attributes,i)>=0&&Array.prototype.push.apply(o,D.a.map(t,(function(t){return e.getViewportAttributeName(i,t)})))})),Array.prototype.push.apply(i,o)})),D.a.map(this.validElements,(function(t,e){return e+(t.length?"["+t.join("|")+"]":"")})).join(",")},getViewportAttributeName:function(t,e){},setInitialParams:function(){this.editor=null,this.editorState=0,this.isEditMode=!1,this.cur_selection_styles={},this.cur_selection_styles_all=[],this.oldChangeParam={}},validate:function(){var t={};D.a.each(["bg_color","bg_opacity","column_count","column_gap"],D.a.bind((function(e){null==this.model.get(e)&&(t[e]=K.defaults[e])}),this)),D.a.isEmpty(t)||this.model.set(t,{silent:!0})},render:function(){if(!this.rendered){this.create(),this.setInitialParams(),this.validate();var t=D.a.pick(this.model.attributes,["_id","w","h","text"]);t.text=this.switchTextToViewport(t.text,this.page.getCurrentViewport()),this.model.created&&this.has_parent_block&&(t.text='<p style="line-height: 22px; padding: 16px 16px; text-align: center; font-family: Georgia; font-size: 16px;" data-size-leading-linked="false" data-size-leading-ratio="1.25"><span>Text</span></p>',this.model.save({text:t.text},{silent:!0})),this.selectOnEnter=this.model.created,Object(l.a)(this.inner_template(t)).appendTo(this.$content);var e=U.a["template-constructor-block-text-bg"];this.$bg=Object(l.a)(e({})).prependTo(this.$el),Object(d.a)("constructor.zIndex")?this.model.get("fixed_position")||this.$bg.css({"z-index":RM.constructorRouter.indexController.getZIndex(this.model.id,this.workspace.page.id,this.workspace.page.getCurrentViewport())}):this.$bg.css({"z-index":this.model.get("z")}),this.$el.addClass("block-text"),this.$el.toggleClass("text-autosize",!!this.model.get("autosize")),this.$preview=this.$(".text-preview"),this.$preview_mask=this.$(".text-mask"),this.$preview.addClass("v"+(this.model.get("version")||1)),this.model.created&&2==this.model.get("version")&&RM.constructorRouter.fonts.addFonts([{provider:"google",css_name:"Roboto",name:"Roboto",variations:["n1","i1","n3","i3","n4","i4","n5","i5","n7","i7","n9","i9"]}],"manual"),this.applyCssColumnCount(this.$preview,this.model.get("column_count")),this.applyCssColumnGap(this.$preview,this.model.get("column_gap")),this.applyCssBgColor(this.model.get("bg_color"),this.model.get("bg_opacity")),this.model.created&&(this.model.created=!1,this.enterEditMode(),this.frame&&this.frame.show()),this.triggerReady()}},onIndexChange:function(){Object(d.a)("constructor.zIndex")&&this.$bg&&!this.model.get("fixed_position")&&this.$bg.css({"z-index":RM.constructorRouter.indexController.getZIndex(this.model.id,this.workspace.page.id,this.workspace.page.getCurrentViewport())}),c.a.prototype.onIndexChange.apply(this,arguments)},destroy:function(){this.model.off("change",this.onModelChange),this.off("resize",this.onChangeInEditor_throttle),RM.constructorRouter.off("font-added",this.onFontAdd),this.page.off("change:viewport",this.onViewportChange),this.leaveEditMode(!0),this.deleted=!0,c.a.prototype.destroy.apply(this,arguments)},createEditor:function(){this.editorState=1},css:function(t){void 0!==(t=t||{})["z-index"]&&this.$bg.css({"z-index":this.model.get("fixed_position")?"":t["z-index"]}),c.a.prototype.css.apply(this,arguments),t=D.a.pick(t,"width","height"),D.a.isEmpty(t)||(this.$editor&&this.$editor.css(t),this.$iframe_body&&this.$iframe_body.css(t),this.somethingChangedInEditor("dimensions"))},doesContentFit:function(){var t=!0;if(this.$iframe_document&&this.$iframe_document){var e=this.$iframe_document.width()/this.zoom,i=this.$iframe_document.height()/this.zoom,n=this.$iframe_body.width(),o=this.$iframe_body.height();e-n==1&&1==this.model.get("column_count")&&e--,t=!(e>n||i>o)}return t},"сheckContentFitToBox":function(){if(this.$iframe_document&&this.$iframe_body){var t=this.doesContentFit();this.frame&&this.frame.setResizeBottomPlus(!t),this.has_parent_block&&this.workspace.fit_text_to_content()}},getAllowableHeight:function(){var t=this.isEditMode?this.$iframe_body.find("p"):this.$preview.find("p"),e=t.length,i=0,n=0,o=0;return t.each(D.a.bind((function(t,a){i+=parseInt(Object(l.a)(a).outerHeight(),10),t===e-1&&(n=parseInt(Object(l.a)(a).css("line-height"),10)/2,Object(l.a)(a).find(".link-1").length&&(o=parseInt(Object(l.a)(a).find(".link-1").css("padding-bottom"),10)))}),this)),i+n+o},getContentBoxHeight:function(){var t=0;if(this.isEditMode)for(var e,i=Math.pow(2,16),n=function(t){this.$editor&&this.$editor.css({height:t}),this.$iframe_body&&this.$iframe_body.css({height:t})}.bind(this);t!==i;)n(e=t+Math.floor((i-t)/2)),this.doesContentFit()?i=e:t=e+1;else{var o=this.$preview[0].style.cssText;this.$preview.css({height:"auto","-moz-column-fill":"balance","column-fill":"balance"}),t=this.$preview.height(),this.$preview[0].style.cssText=o}return t},fitContentToBox:function(t){this.model.set({h:this.getAllowableHeight()}),t&&"keydown"===t.type&&RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","fit frame to text"),this.saveBox()},select:function(){c.a.prototype.select.apply(this,arguments),RM.constructorRouter.bindGlobalKeyPress([{key:"x",handler:this.fitContentToBox,optionKeys:Modernizr.mac?["meta","shift"]:["ctrl","shift"]}])},deselect:function(t){c.a.prototype.deselect.apply(this,arguments),RM.constructorRouter.unbindGlobalKeyPress("x",this.fitContentToBox),t!=this&&this.isEditMode&&(this.leaveEditMode(),this.workspace.trigger("redraw"))},onWorkspaceBlocksSelect:function(t){if(c.a.prototype.onWorkspaceBlocksSelect.apply(this,arguments),this.rendered){var e=t&&1==t.length&&t[0]==this;this.isEditMode&&!e&&(this.leaveEditMode(),this.workspace.trigger("redraw"))}},onChangeInEditor:function(){this.model.get("autosize")&&(this.fitContentToBox(),this.trigger("resizeOnFit",this.model))},editorIsReady:function(t){if(t&&!this.deleted){this.editor=t,this.editor.onChange.add(this.onChangeInEditor_throttle),this.editor.onNodeChange.add(this.onChangeInEditor_throttle),this.editor.onKeyPress.add(this.onChangeInEditor_throttle),this.$editor=this.$("textarea").add(this.$("table")).add(this.$("iframe")),this.$iframe_body=this.$("iframe").contents().find("body"),this.iframe_document=this.$("iframe").contents()[0],this.$iframe_document=Object(l.a)(this.iframe_document),this.iframe=this.$("iframe")[0],this.$iframe_body.addClass("v"+(this.model.get("version")||1));var e=this.iframe_document.createElement("style");e.type="text/css",e.appendChild(this.iframe_document.createTextNode(this.EDITOR_STYLES)),this.iframe_document.getElementsByTagName("head")[0].appendChild(e),this.setEditorZoom(RM.constructorRouter.zoom.getZoom()),this.on("changeStyleParagraph",this.onChangeStyleParagraph),this.on("changeClassParagraph",this.onChangeClassParagraph),this.on("changeStyleSpan",this.onChangeStyleSpan),this.on("changeColumns",this.onChangeColumns),this.on("changeLink",this.onChangeLink),this.applyCssColumnCount(this.$iframe_body,this.model.get("column_count")),this.applyCssColumnGap(this.$iframe_body,this.model.get("column_gap")),this.applyCssBgColor(this.model.get("bg_color"),this.model.get("bg_opacity")),this.css({width:this.model.get("w"),height:this.model.get("h")}),this.marginController=new Y(this),this.columnsController=new Q(this),this.undoController=new J(this),this.$iframe_body.on("mousemove mouseup",D.a.bind((function(t){t.pageX=this.$el.offset().left*this.zoom+t.clientX,t.pageY=this.$el.offset().top*this.zoom+t.clientY,this.disableMouseEventsRedirection||Object(l.a)(document).trigger(t)}),this)),this.$iframe_document.on("paste",D.a.bind((function(){D.a.defer(D.a.bind((function(){var t,e=this.editor.selection,i=e.getBookmark();t=this.$iframe_body[0].innerHTML,this.$iframe_body[0].innerHTML=t,e.moveToBookmark(i)}),this))}),this)),this.$iframe_document.on("mouseup",D.a.bind((function(t){this.mouseSelectionStart&&(this.somethingChangedInEditor("mouseup"),this.trigger("textWidgetMouseSelectionEnd"),this.mouseSelectionStart=!1)}),this)),this.$iframe_document.on("mousedown",D.a.bind((function(t){this.somethingChangedInEditor("mousedown"),this.trigger("textWidgetMouseSelectionStart"),this.mouseSelectionStart=!0}),this)),this.$iframe_document.on("keydown",D.a.bind((function(t){this.somethingChangedInEditor("keydown"),RM.constructorRouter.zoom.onZoomKey(RM.constructorRouter,t)}),this)),this.editor.onKeyDown.addToTop(D.a.bind((function(t,e){if(this.isCollapsedBeforeKeyProceed=this.editor&&this.editor.selection&&this.editor.selection.isCollapsed(),13==e.keyCode&&3==e.location&&(e.preventDefault(),e.stopPropagation(),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","quit edit mode"),this.isEditMode&&(this.leaveEditMode(),this.workspace.trigger("redraw"),this.workspace&&this.workspace.controls&&this.workspace.controls.setControls(this.controls,this))),8==e.keyCode){var i=3==(o=H.a.getSelection(this.iframe)).anchorNode.nodeType?o.anchorNode.parentNode:o.anchorNode,n=Object(l.a)(i).closest("span.soundcite");o.isCollapsed&&n.length&&(0==n.text().length||1==n.text().length&&8203==n.text().charCodeAt(0))&&n.remove()}if(this.needPreserveLastPadding&&(delete this.$paragraphsBeforeRemove,(8==e.keyCode||46==e.keyCode||this.editor&&this.editor.selection&&!this.editor.selection.isCollapsed())&&(this.$paragraphsBeforeRemove=this.$iframe_body.find("p"))),13==e.keyCode&&0==e.location){var o;i=3==(o=H.a.getSelection(this.iframe)).anchorNode.nodeType?o.anchorNode.parentNode:o.anchorNode;o.isCollapsed&&Object(l.a)(i).closest("span.soundcite").length&&(e.preventDefault(),e.stopPropagation())}}),this)),this.editor.onKeyDown.add(D.a.bind((function(t,e){if(this.needPreserveLastPadding){var i=D.a.bind((function(){if(this.$paragraphsBeforeRemove&&this.$paragraphsBeforeRemove.length){var t=this.$iframe_body.find("p"),e=this.$paragraphsBeforeRemove.first()[0],i=this.$paragraphsBeforeRemove.last()[0];t.length&&(1!=t.length||t.eq(0).text()||t[0]==e||t[0]==i)||(this.editor.setContent(q),t=this.$iframe_body.find("p"));var n=t.first()[0],o=t.last()[0];o!=i&&(n.style.paddingTop=e.style.paddingTop,n.style.paddingLeft=e.style.paddingLeft,n.style.paddingRight=e.style.paddingRight,o.style.paddingLeft=i.style.paddingLeft,o.style.paddingRight=i.style.paddingRight,o.style.paddingBottom=i.style.paddingBottom,n.setAttribute("data-mce-style",n.getAttribute("style")),o.setAttribute("data-mce-style",o.getAttribute("style")))}}),this);i(),8==e.keyCode||46==e.keyCode||13==e.keyCode||this.isCollapsedBeforeKeyProceed||D.a.defer(i)}if(this.needClearMarginsOnEnter&&13==e.keyCode&&3!==e.location&&!e.shiftKey){var n,o=H.a.getSelection(this.iframe);if(this.isCollapsedBeforeKeyProceed){try{n=o.getRangeAt(0)}catch(t){}if(n){var a=this.getClosestParagraph(n.startContainer);if(a){a.style.paddingTop=0,a.setAttribute("data-mce-style",a.getAttribute("style"));var r=Object(l.a)(a).prev("p");r.length&&(r[0].style.paddingBottom=0,r[0].setAttribute("data-mce-style",r[0].getAttribute("style")))}}}}}),this)),this.editor.dom.bind(this.editor.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],D.a.bind((function(t){return"dragend"==t.type&&this.mouseSelectionStart&&(this.somethingChangedInEditor("mouseup"),this.trigger("textWidgetMouseSelectionEnd"),this.mouseSelectionStart=!1),t.preventDefault(),t.stopPropagation(),!1}),this)),this.$("iframe").bind("mousewheel",this.onMouseWheel),setTimeout(D.a.bind((function(){this.deleted||(this.editorState=2,this.leaveEditorBeforeItIsLoaded||(this.enterEditMode(),this.editor.show()),this.somethingChangedInEditor("editorIsReady"))}),this),100),setTimeout(D.a.bind((function(){this.selectOnEnter&&(this.editor.selection.select(this.editor.getBody(),!0),delete this.selectOnEnter)}),this),200),this.bindShortcuts()}},onResizeStart:function(t,e){this.disableMouseEventsRedirection=!0,this.$preview_mask.addClass("visible-while-resizing")},onResizeEnd:function(t,e){this.disableMouseEventsRedirection=!1,this.$preview_mask.removeClass("visible-while-resizing")},onMouseWheel:function(t,e){var i=-Math.ceil(.5*e);if(i)if(i>0&&i<1&&(i=1),i<0&&i>-1&&(i=-1),this.model.get("column_count")>1){var n=this.$iframe_document.scrollLeft();this.$iframe_document.scrollLeft(i+n),t.preventDefault()}else{var o=this.$iframe_document.scrollTop();this.$iframe_document.scrollTop(i+o),o!=this.$iframe_document.scrollTop()&&t.preventDefault()}},onDblClick:function(){this.selected&&(this.model.get("pack_id")&&1!==this.workspace.getSelectedBlocks().length?c.a.prototype.onDblClick.apply(this,arguments):this.enterEditMode())},getClosestParagraph:function(t){var e;if(!t)return e;for(;;){var i=t.tagName;if("P"==i||"p"==i){e=t;break}if(!(t=t.parentNode)||!t.tagName)break}return e},selectNodesBoundingSelection:function(t,e){var i,n,o,a,r;this.editor.selection.select(t),n=(i=this.editor.selection.getRng(!0)).startContainer,o=i.startOffset,this.editor.selection.select(e),a=(i=this.editor.selection.getRng(!0)).endContainer,r=i.endOffset,(i=this.iframe_document.createRange()).setStart(n,o),i.setEnd(a,r),this.editor.selection.setRng(i)},bindShortcuts:function(){var t=this;function e(){if(t.workspace&&t.workspace.controls){var e=t.workspace.controls.findControl("text_typography");e&&e.onClick.apply(e)}return!1}function i(){if(t.workspace&&t.workspace.controls){var e=t.workspace.controls.findControl("text_link");e&&(e.onClick.apply(e),e.focusInputField.apply(e))}return RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","create a link"),!1}function n(e){var i;return t.cur_selection_styles&&null!=t.cur_selection_styles[e]&&(i=t.cur_selection_styles[e])==t.params.multipleName&&(i=t.cur_selection_styles_all&&t.cur_selection_styles_all.length>0&&null!=t.cur_selection_styles_all[0][e]?t.cur_selection_styles_all[0][e]:void 0),i}function o(){var e=n("font-weight");return e&&t.trigger("changeStyleSpan",{"font-weight":700==e?"400":"700"}),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","make bold"),!1}function a(){var e=n("font-style");return e&&t.trigger("changeStyleSpan",{"font-style":"italic"==e?"normal":"italic"}),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","make italic"),!1}function r(){var e=n("text-decoration");return e&&t.trigger("changeStyleSpan",{"text-decoration":"underline"==e?"none":"underline"}),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","make underlined"),!1}function s(){var e=n("font-size");return e&&(++e>t.params.maxFontSize&&(e=t.params.maxFontSize),t.trigger("changeStyleParagraph",{"font-size":e+"px"})),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","increase font size"),!1}function c(){var e=n("font-size");return e&&(--e<t.params.minFontSize&&(e=t.params.minFontSize),t.trigger("changeStyleParagraph",{"font-size":e+"px"})),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","decrease font size"),!1}function d(){if(t.editor&&t.editor.selection&&t.isEditorActive()){RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","select current paragraph");var e,i=H.a.getSelection(t.iframe);try{e=i.getRangeAt(0)}catch(t){return}var n=t.getClosestParagraph(e.startContainer),o=t.getClosestParagraph(e.endContainer);return t.selectNodesBoundingSelection(n,o),!1}}function h(){return t.trigger("changeStyleParagraph",{"text-align":"left"}),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","align left"),!1}function u(){return t.trigger("changeStyleParagraph",{"text-align":"right"}),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","align right"),!1}function p(){return t.trigger("changeStyleParagraph",{"text-align":"center"}),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","align center"),!1}function m(e){if(t.editor&&t.editor.selection&&t.editor.selection.isCollapsed()){var i=t.editor.selection.getRng(),n=t.editor.selection.getNode(),o=i.startOffset;if(n&&!(o>0)){for(;n&&Object(l.a)(n)[0].tagName&&"p"!=Object(l.a)(n)[0].tagName.toLowerCase();){if(Object(l.a)(n).index()>0)return;n=n.parentNode}if(n&&Object(l.a)(n)[0].tagName&&"p"==Object(l.a)(n)[0].tagName.toLowerCase()){var a=0;if(t.iframe_document.defaultView&&t.iframe_document.defaultView.getComputedStyle){var r=t.iframe_document.defaultView.getComputedStyle(n,null);r&&(a=parseInt(r.getPropertyValue("text-indent"),10)),isNaN(a)&&(a=0)}if(!(e<0&&0==a))return(a+=t.params.tabIndent*e)<0&&(a=0),t.trigger("changeStyleParagraph",{"text-indent":a+"px"}),!1}}}}this.$iframe_body.bind("keydown","tab",(function(){return m(1),!1})).bind("keydown","backspace",(function(t){return m(-1)})).bind("keydown","alt+up",(function(){var e=n("line-height");e&&(--e<t.params.minLineHeight&&(e=t.params.minLineHeight),t.trigger("changeStyleParagraph",{"line-height":e+"px"}));RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","decrease line height");return!1})).bind("keydown","alt+down",(function(){var e=n("line-height");e&&(++e>t.params.maxLineHeight&&(e=t.params.maxLineHeight),t.trigger("changeStyleParagraph",{"line-height":e+"px"}));RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","increase line height");return!1})).bind("keydown","alt+left",(function(){if(!t.editor||!t.editor.selection||t.editor.selection.isCollapsed())return;var e=n("letter-spacing");null!=e&&((e=v.default.decimals(e-.2,2))<t.params.minLetterSpacing&&(e=t.params.minLetterSpacing),t.trigger("changeStyleSpan",{"letter-spacing":e+"px"}));return!1})).bind("keydown","alt+right",(function(){if(!t.editor||!t.editor.selection||t.editor.selection.isCollapsed())return;var e=n("letter-spacing");null!=e&&((e=v.default.decimals(e+.2,2))>t.params.maxLetterSpacing&&(e=t.params.maxLetterSpacing),t.trigger("changeStyleSpan",{"letter-spacing":e+"px"}));return!1})),this.$iframe_body.bind("keydown","alt+ctrl+t",e).bind("keydown","ctrl+shift+x",this.fitContentToBox.bind(this)).bind("keydown","ctrl+k",i).bind("keydown","ctrl+b",o).bind("keydown","ctrl+i",a).bind("keydown","ctrl+u",r).bind("keydown","ctrl+shift+¾",s).bind("keydown","ctrl+shift+¼",c).bind("keydown","ctrl+shift+a",d).bind("keydown","ctrl+shift+l",h).bind("keydown","ctrl+shift+r",u).bind("keydown","ctrl+shift+c",p),this.$iframe_body.bind("keydown","alt+meta+t",e).bind("keydown","meta+shift+x",this.fitContentToBox.bind(this)).bind("keydown","meta+k",i).bind("keydown","meta+b",o).bind("keydown","meta+i",a).bind("keydown","meta+u",r).bind("keydown","meta+shift+¾",s).bind("keydown","meta+shift+¼",c).bind("keydown","meta+shift+a",d).bind("keydown","meta+shift+l",h).bind("keydown","meta+shift+r",u).bind("keydown","meta+shift+c",p),this.bindSymbolShortcuts()},bindSymbolShortcuts:function(){var t=Modernizr.mac;D.a.each({"&ensp;":"alt+shift+space","&nbsp;":"alt+ctrl+space","&thinsp;":"alt+ctrl+shift+space"},function(e,i){-1!==e.indexOf("ctrl")&&t?this.$iframe_body.bind("keydown",e.replace("ctrl","meta"),this.insertCharacter.bind(this,i)):this.$iframe_body.bind("keydown",e,this.insertCharacter.bind(this,i))}.bind(this))},enterEditMode:function(t){t&&t.shiftKey||1!=this.editorState&&(0!=this.editorState?(this.$editor&&this.$editor.css("display","block"),this.frame&&this.frame.setEditorState(),this.$preview&&this.$preview.css("display","none"),this.$preview_mask&&this.$preview_mask.css("display","none"),this.initiatorControl="user",this.isEditMode=!0,this.marginController&&this.marginController.show(),this.columnsController&&this.columnsController.show(),this.frame.removeRotationState(),this.frame.resetRotation(),this.undoController.historyTriggers=L.a.setCustomHandlers({undo:this.undoController.undo,redo:this.undoController.redo,getLength:this.undoController.getLength}),this.prevModelAttributes=D.a.clone(this.model.attributes),clearInterval(this.intermediateSaveInterval),this.intermediateSaveInterval=setInterval(this.intermediateSave,2e4),RM.constructorRouter.textStyles.generateCSS("paragraph","editor",this.iframe_document),RM.constructorRouter.textStyles.generateCSS("link","editor",this.iframe_document),B.a.appendFontsCssToIFrame(this.iframe_document),setTimeout(D.a.bind((function(){this.isEditorActive()&&(this.editor.focus(),this.editor.setContent(this.switchTextToViewport(this.model.get("text"),this.model.isNested?"default":this.page.getCurrentViewport())),this.somethingChangedInEditor("enterEditMode"))}),this),0),this.workspace&&this.workspace.controls&&this.workspace.controls.setControls(this.edit_controls,this),this.workspace.trigger("w-text-entered-edit-mode")):this.createEditor())},isEditorActive:function(){return!this.deleted&&(!!this.isEditMode&&(!!this.editor&&2==this.editorState))},applyCssColumnCount:function(t,e){var i=1==e?"auto":e;t&&t.css({"-webkit-column-count":i+"","-moz-column-count":i+"","column-count":i+""})},applyCssColumnGap:function(t,e){t&&t.css({"-webkit-column-gap":e,"-moz-column-gap":e,"column-gap":e})},applyCssBgColor:function(t,e){var i="",n=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)];i=e>.99?"rgb("+n[0]+","+n[1]+","+n[2]+")":"rgba("+n[0]+","+n[1]+","+n[2]+", "+e+")",this.$bg.css("background",i)},leaveEditMode:function(t){0!=this.editorState&&(1!=this.editorState?this.isEditorActive()&&(this.changeSpanToNbsp(),this.workspace.trigger("w-text-before-leave-edit-mode"),this.isEditMode=!1,clearInterval(this.intermediateSaveInterval),v.default.getFocusBack(),this.$editor&&this.$editor.css("display","none"),this.frame&&this.frame.removeEditorState(),this.$preview&&this.$preview.css("display","block"),this.$preview_mask&&this.$preview_mask.css("display","block"),this.marginController&&this.marginController.hide(),this.columnsController&&this.columnsController.hide(),this.frame.restoreRotation(),L.a.removeCustomHandlers(),this.undoController.historyTriggers={},t||this.saveWidgetData(),this.workspace.trigger("w-text-leaved-edit-mode")):this.leaveEditorBeforeItIsLoaded=!0)},getSaveBoxOptions:function(t){return D.a.extend({patch:!0},t)},saveWidgetData:function(){var t=this.switchTextToDefault(this.editor.getContent()),e=Object(l.a)("<div>").html(t);for(e.find("div").remove();;){var i=e.html();if(e.find("span:econtains( ), a:econtains( )").filter((function(){return" "!=Object(l.a)(this).closest("p").text()})).remove(),e.find("span:econtains(''), a:econtains('')").filter((function(){return""!=Object(l.a)(this).closest("p").text()})).remove(),i==e.html())break}!(t=e.html())&&this.has_parent_block&&(t=q),t==this.prevModelAttributes.text&&D.a.isEqual(D.a.omit(this.model.attributes,"text","x","y","w","h","z","angle","flip_h","flip_v"),D.a.omit(this.prevModelAttributes,"text","x","y","w","h","z","angle","flip_h","flip_v"))||this.model.save({text:t}),this.prevModelAttributes=D.a.clone(this.model.attributes),e.empty().remove()},intermediateSave:function(){this.isEditorActive()?this.saveWidgetData():clearTimeout(this.intermediateSaveInterval)},onViewportChange:function(){if(this.rendered){var t=this.switchTextToViewport(this.model.get("text"),this.page.getCurrentViewport());this.setPreviewHtml(t),this.editor&&this.editor.setContent(t)}},onModelChange:function(t){var e;if(c.a.prototype.onModelChange.apply(this,arguments),this.rendered){if(this.validate(),D.a.has(t.changedAttributes(),"text")){var i=this.switchTextToViewport(t.get("text"),this.model.isNested?"default":this.page.getCurrentViewport());this.setPreviewHtml(i),this.isEditorActive()||this.editor&&this.editor.setContent(i)}"autosize"in t.changed&&(e=this.$el.find(".frameborder"),this.$el.toggleClass("text-autosize",!!this.model.get("autosize")),e.hasClass("red-border")&&this.model.get("autosize")&&e.removeClass("red-border"),D.a.defer(function(){this.fitContentToBox(),this.trigger("resizeOnFit",this.model)}.bind(this))),this.applyCssColumnCount(this.$preview,t.get("column_count")),this.applyCssColumnCount(this.$iframe_body,t.get("column_count")),this.applyCssColumnGap(this.$preview,t.get("column_gap")),this.applyCssColumnGap(this.$iframe_body,t.get("column_gap")),this.applyCssBgColor(this.model.get("bg_color"),this.model.get("bg_opacity"))}},setPreviewHtml:function(t){this.$preview&&this.$preview.html(t),this.$preview.find("span.soundcite").each((function(t,e){V.a&&V.a.setElementsColor(e)}))},calcColumnsPositions:function(){var t,e,i,n=this.$el[0].offsetWidth,o=this.$iframe_document.width()/this.zoom,a=this.model.get("column_gap"),r=(n+a)/this.model.get("column_count")-a,s=Math.round((o+a)/(r+a)),l=(o+a)/s-a,c=[],d=0;for(t=0;t<s;t++)e=Math.round(d),i=Math.round(d+l),c.push({st:e,ed:i,w:i-e}),d+=l+a;return c},sanitizeContent:function(){if("1"!=this.$iframe_body.attr("data-pasting-in-action")){this.$iframe_body.find('span[data-mce-type="bookmark"]').remove();var t=this.editor.selection.getBookmark();this.$iframe_body.find('span[data-mce-type="bookmark"]').removeAttr("data-mce-type").addClass("bookmark");var e=this.editor.getContent();this.editor.setContent(e),this.$iframe_body.find("span.bookmark").attr("data-mce-type","bookmark").removeClass("bookmark").text(""),this.editor.selection.moveToBookmark(t)}},removeRedundandNBSPs:function(){var t,e=this.$iframe_body[0].innerHTML,i=n(e);function n(t){return t=(t=(t=(t=(t=(t=(t=t.replace(/\>&nbsp;\</gim,">{{{NBSP_PLACEHOLDER}}}<")).replace(/([^\>])&nbsp;([^\<])/gim,"$1{{{NBSP_PLACEHOLDER}}}$2")).replace(/([^\>\<$|\s])&nbsp;/gim,"$1{{{NBSP_PLACEHOLDER}}}")).replace(/\<\/p\>/gim,"</p>\n")).replace(/([^\s\>])((?:<[^\>]*?>)*)&nbsp;((?:<[^\>]*?>)*)([^\s\<])/gi,"$1$2 $3$4")).replace(/\{\{\{NBSP_PLACEHOLDER\}\}\}/gim,"&nbsp;")).replace(/\<\/p\>\n+/gim,"</p>")}i!=e&&(t=this.editor.selection.getBookmark(),this.$iframe_body.find('span[data-mce-type="bookmark"]').html(""),i=n(e=this.$iframe_body[0].innerHTML),this.$iframe_body[0].innerHTML=i,this.editor.selection.moveToBookmark(t))},somethingChangedInEditor:function(t,e){if("dimensions"==t||"margins"==t||"enterEditMode"==t)return this.recalcStyle(t,e),void("enterEditMode"==t&&-1!==this.$iframe_body[0].innerHTML.indexOf("&nbsp;")&&this.changeNbspToSpan());"paste"==t&&setTimeout(this.sanitizeContent,0),this.recalcStyleDebounced(t,e)},recalcStyle:function(t,e){if(this.isEditorActive()&&"1"!=this.$iframe_body.attr("data-pasting-in-action")&&(this.$iframe_body.find(":not(p,span,a,br)").length>0&&this.sanitizeContent(),this.сheckContentFitToBox(),"dimensions"==t?setTimeout(D.a.bind((function(){this.marginController&&this.marginController.recalc(),this.columnsController&&this.columnsController.recalc()}),this),0):(this.marginController&&this.marginController.recalc(),this.columnsController&&this.columnsController.recalc()),"dimensions"!=t)){this.removeRedundandNBSPs(),"keydown"==t&&this.changeNbspToSpan();var i=this.editor.getContent();if("BODY"==(d=this.editor.selection.getRng(!0)).startContainer.tagName||"BODY"==d.endContainer.tagName)var n=!0;var o=H.a.getSelection(this.iframe);if(n){d=o.getRangeAt(0);var a=this.editor.dom.createRng();a.setStart(d.startContainer,d.startOffset),a.setEnd(d.endContainer,d.endOffset),this.editor.selection.setRng(a)}"undo"!=t&&"redo"!=t&&this.undoController.add(i,"margins"==t?"formatApplied":t,o,e),"user"==this.initiatorControl&&(this.oldChangeParam={});var r=[];if("[object HTMLDocument]"!=(b=3==o.anchorNode.nodeType?o.anchorNode.parentNode:o.anchorNode).toString()){var s,c;if(o.isCollapsed)r.push(b),s=b,c=b;else if(o.rangeCount){var d,h=(d=o.getRangeAt(0)).getNodes([3]);s=d.startContainer,c=d.endContainer;for(var u,p=0;u=h[p];p++)""!=u.nodeValue&&r.push(u.parentNode);r=l.a.unique(r)}s=3==s.nodeType?s.parentNode:s,c=3==c.nodeType?c.parentNode:c;var m,g,f=[];for(p=0;p<r.length;p++)for(var v,b=r[p];"P"!=(v=b.tagName)&&"p"!=v;){if("A"==v||"a"==v){f.push(b),r[p]==s&&(m=b),r[p]==c&&(g=b);break}if(!(b=b.parentNode)||!b.tagName)break}var y=this.workspace&&this.workspace.controls&&this.workspace.controls.findControl("text_color");m&&g&&Object(l.a)(m).attr("data-uuid")==Object(l.a)(g).attr("data-uuid")?y&&y.setDisabled():y&&y.setEnabled(),this.calcSelectionStyle(r,f),this.collapsedSelection=o.isCollapsed,o.isCollapsed&&this.cur_selection_styles&&this.$iframe_body.css("color","#"+this.cur_selection_styles.color)}}},getComputedStyle:function(t,e){var i=[];if(t&&this.iframe_document.defaultView&&this.iframe_document.defaultView.getComputedStyle){var n=this.iframe_document.defaultView.getComputedStyle(t,null);if(!n)return[];D.a.each(e,(function(e){var o=n.getPropertyValue(e).toLowerCase();t.tagName&&"A"==t.tagName&&"text-decoration"==e&&(o="none"),i.push({prop:e,val:o})}))}return i},calcSelectionStyle:function(t,e){if(this.cur_selection_styles_all=[],D.a.each(t,D.a.bind((function(t){var e=this.getComputedStyle(t,["text-align","color","text-transform","vertical-align","font-weight","font-style","text-decoration","letter-spacing","font-family"]),i=this.getClosestParagraph(t);if(i){var n=this.getComputedStyle(i,["font-size","line-height","padding-top","padding-left","padding-right","padding-bottom"]);(e=D.a.union(e,n)).push({prop:"paragraph-class",val:i.className});var o=i.getAttribute("data-size-leading-linked");e.push({prop:"size-leading-linked",val:!o||"true"==o}),e.push({prop:"size-leading-ratio",val:(i.getAttribute("data-size-leading-ratio")||this.params.fontSizeLineHeightRatio)-0})}e.length>0&&(!function(t){D.a.each(t,(function(e){if("font-weight"==e.prop&&("normal"==e.val&&(e.val="400"),"bold"==e.val&&(e.val="700")),"color"==e.prop){var i,n,o=e.val.match(/\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*/);o||(o=e.val.match(/\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d+|\d*\.\d+)\s*\)\s*/)),o&&(a=o[1]-0,r=o[2]-0,s=o[3]-0,l=a.toString(16),c=r.toString(16),d=s.toString(16),i=(1==l.length?"0"+l:l)+(1==c.length?"0"+c:c)+(1==d.length?"0"+d:d),n=Math.round(100*(o[4]||1))),e.val=i,t.push({prop:"opacity",val:n})}var a,r,s,l,c,d;if("font-size"==e.prop&&(e.val=parseInt(e.val,10)),"line-height"==e.prop&&(e.val=parseInt(e.val,10)),"text-align"==e.prop&&"start"!=e.val&&"left"!=e.val&&"right"!=e.val&&"justify"!=e.val&&"center"!=e.val&&(e.val="start"),"text-decoration"==e.prop){var h=e.val.split(" ");e.val=h.length?h[0]:e.val}if("padding-left"!=e.prop&&"padding-right"!=e.prop&&"padding-top"!=e.prop&&"padding-bottom"!=e.prop||(e.val=parseInt(e.val,10)),"letter-spacing"==e.prop&&("normal"==e.val&&(e.val="0"),e.val=parseFloat(e.val)),"font-family"==e.prop){e.val=e.val.replace(/\'|\"/gim,"");var u=RM.constructorRouter.fonts.findFontByCSSName(e.val);u&&u.css_name&&(e.val=u.css_name)}}))}(e),this.cur_selection_styles_all.push(e))}),this)),0!=this.cur_selection_styles_all.length){var i=this.cur_selection_styles;this.cur_selection_styles={};var n=[],o=!0;D.a.each(this.cur_selection_styles_all,D.a.bind((function(t){var e={};D.a.each(t,D.a.bind((function(t){e[t.prop]=t.val,this.cur_selection_styles[t.prop]!=t.val&&(this.cur_selection_styles[t.prop]=this.params.multipleName),o&&(this.cur_selection_styles[t.prop]=t.val)}),this)),n.push(e),o=!1}),this)),this.cur_selection_styles_all=n;for(var a in this.cur_selection_styles)if(this.cur_selection_styles[a]!=i[a]){!1;break}this.cur_selection_styles.link_nodes=e,this.trigger("selection_styles_changed",this.cur_selection_styles),this.trigger("selection_styles_all_changed",this.cur_selection_styles_all),this.initiatorControl="user"}},onChangeStyleParagraph:function(t){this.checkForParamUpdateNeeded(this.changeStyleParagraph,t)},onChangeClassParagraph:function(t){this.checkForParamUpdateNeeded(this.changeClassParagraph,t)},onChangeStyleSpan:function(t){this.checkForParamUpdateNeeded(this.changeStyleSpan,t)},onChangeColumns:function(t){this.checkForParamUpdateNeeded(this.changeColumns,t)},onChangeLink:function(t){this.checkForParamUpdateNeeded(this.changeLink,t)},checkForParamUpdateNeeded:function(t,e){if(!D.a.isEqual(this.oldChangeParam,e)){var i=D.a.keys(this.oldChangeParam),n=D.a.keys(e);0==D.a.difference(i,n).length?t.__debounced(e):t(e)}this.oldChangeParam=e,e&&e.url&&(/^back\sto\stop$/i.test(e.url)||(e.url=encodeURI(e.url))),this.somethingChangedInEditor("formatApplied",e)},changeStyleParagraph:function(t){if(t&&this.isEditorActive()){var e=D.a.pick(t,"size-leading-linked","size-leading-ratio"),i=D.a.omit(t,"size-leading-linked","size-leading-ratio"),n={selector:"p"};D.a.isEmpty(e)||(n.attributes=D.a.object(D.a.map(D.a.keys(e),(function(t){return"data-"+t})),D.a.map(D.a.values(e),(function(t){return t+""})))),!Modernizr.webkit||Modernizr.safari||Modernizr.safari5?i["white-space"]=Object.values(i).indexOf("justify")>-1?"normal":"pre-wrap":i["white-space"]="inherit",D.a.isEmpty(i)||(n.styles=i),this.editor.formatter.register("temp",n),this.editor.formatter.apply("temp")}},changeClassParagraph:function(t){t&&(this.isEditorActive()&&(this.editor.formatter.register("temp",{selector:"p",classes:"temp-class"}),this.editor.formatter.apply("temp"),Object(l.a)(".temp-class",this.iframe_document).each(D.a.bind((function(e,i){var n=Object(l.a)(i);if(this.needIgnoreSlylesMargins){var o,a={};o=i.style.paddingLeft,a.paddingLeft=parseInt(o,10)?o:0,o=i.style.paddingTop,a.paddingTop=parseInt(o,10)?o:0,o=i.style.paddingBottom,a.paddingBottom=parseInt(o,10)?o:0,o=i.style.paddingRight,a.paddingRight=parseInt(o,10)?o:0}t.class&&(i.className=t.class),t.remove&&(i.className="none"),n.removeAttr("style").removeAttr("data-mce-style"),t.override&&n.find("*").removeAttr("style").removeAttr("data-mce-style");for(var r=i.firstChild;r&&(3!=r.nodeType||""==r.nodeValue);r=r.nextSibling);if(!r&&!t.override){var s={};!function t(e,i){if(e.childNodes.length>0)for(var n=0;n<e.childNodes.length;n++)t(e.childNodes[n],i);3==e.nodeType&&""!=e.nodeValue&&i(e)}(i,D.a.bind((function(t){var e=this.getComputedStyle(t.parentNode,["font-weight","font-style","font-family","letter-spacing","color","text-transform","vertical-align","text-decoration"]);D.a.each(e,(function(t,e){s[t.prop]||(s[t.prop]={}),s[t.prop][t.val]=!0}))}),this));var c=[];D.a.each(s,(function(t,e){1==D.a.keys(t).length&&c.push(e)})),n.find("*").each(D.a.bind((function(t,e){if(e.tagName&&"br"!=e.tagName.toLowerCase()){D.a.each(c,(function(t,i){e.style.removeProperty(t)}));var i=l.a.trim(e.style.cssText);i?Object(l.a)(e).attr("data-mce-style",i):Object(l.a)(e).removeAttr("style").removeAttr("data-mce-style")}}),this))}this.needIgnoreSlylesMargins&&(i.style.paddingLeft=a.paddingLeft,i.style.paddingTop=a.paddingTop,i.style.paddingBottom=a.paddingBottom,i.style.paddingRight=a.paddingRight,i.setAttribute("data-mce-style",i.getAttribute("style")))}),this))))},changeStyleSpan:function(t){t&&this.isEditorActive()&&(this.editor.formatter.register("temp",{inline:"span",styles:t}),this.editor.formatter.apply("temp"))},changeColumns:function(t){t&&this.isEditorActive()&&(null!=t.column_count&&(this.model.set({column_count:t.column_count}),this.applyCssColumnCount(this.$iframe_body,t.column_count)),null!=t.column_gap&&(this.model.set({column_gap:t.column_gap}),this.applyCssColumnGap(this.$iframe_body,t.column_gap)),null!=t.bg_color&&null!=t.bg_opacity&&(this.model.set({bg_color:t.bg_color,bg_opacity:t.bg_opacity}),this.applyCssBgColor(t.bg_color,t.bg_opacity)))},changeLink:function(t){if(t&&this.isEditorActive()){var e,i,n=this.cur_selection_styles&&this.cur_selection_styles.link_nodes||[],o=this.collapsedSelection;if("remove"==t.action&&(o&&n.length&&(e=Object(l.a)(n[0]).attr("data-uuid"),i=this.$iframe_body.find("a[data-uuid='"+e+"']"),this.selectNodesBoundingSelection(i[0],i[i.length-1])),this.editor.execCommand("mceInsertLink",!1,"")),"create"==t.action){o&&n.length?(e=Object(l.a)(n[0]).attr("data-uuid"),i=this.$iframe_body.find("a[data-uuid='"+e+"']")):(e=v.default.generateUUID(),this.editor.execCommand("mceInsertLink",!1,"temp-url"),i=this.$iframe_body.find('a[href="temp-url"]'));var a={};t.clickPage&&(a["data-page-uri"]=t.clickPage),i.attr(D.a.extend({href:t.url,"data-mce-href":t.url,"data-uuid":e,"data-pid":RM.constructorRouter.mag.getPageId(t.url)||null,class:t.class,"data-mce-class":t.class,target:t.target,"data-anchor-link-pos":t.anchor_pos||null},a)),i.length>0&&this.selectNodesBoundingSelection(i[0],i[i.length-1])}"change-class"==t.action&&n.length&&Object(l.a)(n).attr({class:t.class,"data-mce-class":t.class}),"change-target"==t.action&&n.length&&Object(l.a)(n).attr({target:t.target})}},changeNbspToSpan:function(){var t,e=this.editor.selection.getBookmark();t=(t=this.$iframe_body[0].innerHTML.replace(/<span class="nbsp">(&nbsp;)?(.*?)<\/span>/g,"$1$2")).replace(/&nbsp;/g,'<span class="nbsp">&nbsp;</span>'),this.$iframe_body[0].innerHTML=t,this.editor.selection.moveToBookmark(e)},changeSpanToNbsp:function(){var t;t=this.$iframe_body[0].innerHTML.replace(/<span class="nbsp">(&nbsp;)?(.*?)<\/span>/g,"$1$2"),this.$iframe_body[0].innerHTML=t},insertCharacter:function(t,e){this.editor.execCommand("mceInsertContent",!1,t),"&nbsp;"===t&&(this.changeNbspToSpan(),RM&&RM.constructorRouter&&RM.constructorRouter.analytics&&RM.constructorRouter.analytics.sendEvent("Key Press","insert non-breaking space")),e.preventDefault()}},{defaults:{text:function(){return"<p>"+G[Math.floor(Math.random()*G.length)]+"</p>"},column_count:1,column_gap:16,bg_color:"ffffff",bg_opacity:0,version:2}}).extend(z.a.prototype),Y=a.a.View.extend({params:{maxTopMargin:999,maxBottomMargin:999,maxLeftMargin:999,maxRightMargin:999,handleThreshold:4,minHandleSize:43},initialize:function(t){D.a.bindAll(this),this.block=t,this.block.$iframe_document.on("scroll",this.onScroll),this.marginBlocks=new X(this,this.block.$(".margins-wrapper-inner")[0]),this.marginHandle=new Z(this,this.block.$el[0]),this.onScroll()},onScroll:function(){this.scrollTop=this.block.$iframe_document.scrollTop(),this.scrollLeft=this.block.$iframe_document.scrollLeft(),this.marginBlocks.onScroll(this.scrollTop,this.scrollLeft),this.marginHandle.onScroll(this.scrollTop,this.scrollLeft)},recalc:function(){if(this.block.isEditorActive()){this.dw=this.block.$iframe_document.width()/this.block.zoom,this.dh=this.block.$iframe_document.height()/this.block.zoom;var t,e=H.a.getSelection(this.block.iframe);try{t=e.getRangeAt(0)}catch(t){return}var i=this.block.getClosestParagraph(t.startContainer),n=this.block.getClosestParagraph(t.endContainer);if(!i&&"BODY"!=t.startContainer.tagName||!n&&"BODY"!=t.endContainer.tagName)return this.marginBlocks.proceed([]),void this.marginHandle.proceed([],[]);if(!i||!n){var o=this.block.$iframe_body.find("p");if(0==o.length)return this.marginBlocks.proceed([]),void this.marginHandle.proceed([],[]);i||(i=o.get(0)),n||(n=o.get(-1))}for(var a=[{paragraph:i}];i&&i!==n;)"P"==(i=i.nextSibling).tagName&&a.push({paragraph:i});if(this.block.model.get("column_count")>1){var r=this.insertDiv("margin-st","before",a[0].paragraph);a[0].st=r;for(var s=0;s<a.length;s++){r=this.insertDiv("margin-ed","after",a[s].paragraph);a[s].ed=r,s+1<a.length&&(a[s+1].st=r)}var l=this.block.calcColumnsPositions()}var c=[],d=[];if(D.a.each(a,D.a.bind((function(t){var e=this.calcParagraphDimensions(t,l);D.a.each(e.marginBlocks,D.a.bind((function(t){c.push(t)}),this)),D.a.each(e.marginHandles,D.a.bind((function(t){d.push(t)}),this))}),this)),this.block.model.get("column_count")>1){var h=a[0].paragraph.parentNode;h.removeChild(a[0].st);for(s=0;s<a.length;s++)h.removeChild(a[s].ed)}this.marginBlocks.proceed(c),this.marginHandle.proceed(d,D.a.pluck(a,"paragraph"))}},insertDiv:function(t,e,i){var n=this.block.iframe_document.createElement("div");return n.className=t,"before"==e?i.parentNode.insertBefore(n,i):i.parentNode.insertBefore(n,i.nextSibling),n},getColumnIndex:function(t,e){for(var i,n=9999,o=0,a=0;a<t.length;a++)(i=Math.abs(e-t[a].st))<n&&(n=i,o=a);return o},calcParagraphDimensions:function(t,e){var i=t.paragraph,n=this.block.iframe_document.defaultView.getComputedStyle(i,null),o=parseInt(n.getPropertyValue("padding-top"),10),a=parseInt(n.getPropertyValue("padding-right"),10),r=parseInt(n.getPropertyValue("padding-bottom"),10),s=parseInt(n.getPropertyValue("padding-left"),10),l=o,c=r;if(1==this.block.model.get("column_count"))var d=W.a.getBox(i,1/this.block.zoom),h=(g=d.width,f=d.left+this.scrollLeft),u=(v=d.top+this.scrollTop)+d.height;else{var p=W.a.getBox(t.st,1/this.block.zoom),m=W.a.getBox(t.ed,1/this.block.zoom),g=p.width,f=(m.width,p.left+this.scrollLeft),v=(h=m.left+this.scrollLeft,p.top+this.scrollTop+("margin-ed"==t.st.className?1:0));u=m.top+this.scrollTop+1}var b=[];if(this.block.model.get("column_count")>1)for(var y=this.getColumnIndex(e,f),_=this.getColumnIndex(e,h),w=y;w<=_;w++){var k,S=e[w];k=y==_?u-v:w==y?this.dh-v:w==_?u:this.dh;var x={x:S.st,w:S.w,y:w==y?v:0,h:k};b.push(x)}else{x={x:f,y:v,w:g,h:u-v};b.push(x)}var C=b.length;for(w=0;w<C;w++){s+a>(I=b[w]).w&&(s>I.w?(s=I.w,a=0):a=I.w-s),I.mr=a,I.ml=s,I.mt=o,I.h<o&&(I.mt=I.h),o=Math.max(o-I.h,0)}for(w=C-1;w>=0;w--){(I=b[w]).mb=r,I.h<r&&(I.mb=I.h),r=Math.max(r-I.h,0)}var O,j=[],P=[],E=!1;for(w=0;w<C;w++){var I,T={ox:(I=b[w]).x,oy:I.y,ow:I.w,oh:I.h,mt:I.mt,mb:I.mb,ml:I.ml,mr:I.mr},M=I.w-I.ml-I.mr,$=I.x+I.ml;0==M?(M=2,$--):1==M&&(M=2),$+M>I.x+I.w&&($=I.x+I.w-M),$<I.x&&($=I.x),T.ix=$,T.iy=I.y+I.mt,T.iw=M,T.ih=I.h-I.mt-I.mb,j.push(T),!E&&T.oh-T.mt-T.mb>0&&(O={tp:"top",column:w,p:i,val:l,max:this.params.maxTopMargin,x:T.ix,y:T.iy,size:T.iw},P.push(O),E=!0),w==C-1&&(O={tp:"bottom",column:w,p:i,val:c,max:this.params.maxBottomMargin,x:T.ox,y:T.oy+T.oh-1,size:T.ow},P.push(O)),T.oh-T.mt-T.mb>0&&(O={tp:"left",column:w,p:i,val:I.ml,max:Math.min(T.ow-T.mr,this.params.maxLeftMargin),x:T.ix,y:T.iy,size:T.ih},P.push(O),O={tp:"right",column:w,p:i,val:I.mr,max:Math.min(T.ow-T.ml,this.params.maxRightMargin),x:T.ix+T.iw-1,y:T.iy,size:T.ih},P.push(O))}return{marginBlocks:j,marginHandles:P}},show:function(){this.marginBlocks.show(),this.marginHandle.show(),this.onScroll()},hide:function(){this.marginBlocks.hide(),this.marginHandle.hide()}}),X=a.a.Model.extend({initialize:function(t,e){D.a.bindAll(this),this.controller=t,this.container=e,this.marginBlocks=[]},onScroll:function(t,e){Object(l.a)(this.container).css({top:-t,left:-e})},proceed:function(t){for(var e=this.prevUsedBlocks?this.prevUsedBlocks:this.marginBlocks.length,i=0;i<e;i++)this.clear(this.marginBlocks[i]);for(i=0;i<t.length;i++){var n=t[i];this.marginBlocks[i]||(this.marginBlocks[i]=this.createNewMarginBlock()),this.render(this.marginBlocks[i],n)}this.prevUsedBlocks=t.length},createNewMarginBlock:function(){var t={};function e(t,e){var i=document.createElement("div");return i.className=t,e.appendChild(i),i}return t.t=e("margin-top-block",this.container),t.b=e("margin-bottom-block",this.container),t.l=e("margin-left-block",this.container),t.r=e("margin-right-block",this.container),t.outer=e("margin-outer-frame",this.container),e("frameborder",t.outer),t.inner=e("margin-inner-frame",this.container),e("frameborder",t.inner),t},render:function(t,e){function i(t,e,i,n,o){var a=t.style;a.left=e+"px",a.top=i+"px",a.width=n<0?0:n+"px",a.height=o<0?0:o+"px",a.display="block"}i(t.outer,e.ox,e.oy,e.ow,e.oh),0==e.mb&&0==e.mt&&0==e.mr&&0==e.ml||i(t.inner,e.ix,e.iy,e.iw,e.ih),0!=e.mt&&i(t.t,e.ox,e.oy,e.ow,e.mt),0!=e.mb&&i(t.b,e.ox,e.oy+e.oh-e.mb,e.ow,e.mb),0!=e.ml&&i(t.l,e.ox,e.oy+e.mt,e.ml,e.oh-e.mt-e.mb),0!=e.mr&&i(t.r,e.ox+e.ow-e.mr,e.oy+e.mt,e.mr,e.oh-e.mt-e.mb)},clear:function(t){t.inner.style.display="none",t.outer.style.display="none",t.t.style.display="none",t.b.style.display="none",t.l.style.display="none",t.r.style.display="none"},show:function(){this.container.parentNode.style.display="block"},hide:function(){this.container.parentNode.style.display="none"}}),Z=a.a.View.extend({initialize:function(t,e){D.a.bindAll(this),this.controller=t,this.container=e,this.template=U.a["template-constructor-block-text-margins"],this.setElement(Object(l.a)(this.template({})).appendTo(this.container)),this.initialData=void 0,this.data=void 0,this.mx=0,this.my=0,this.mxOnFocusEnter=0,this.myOnFocusEnter=0,this.scrollLeft=0,this.scrollTop=0,this.marginHandles=[],this.state="idle",this.paragraphs=[],this.mouseProceeding=!0,this.$el.RMDrag({start:this.startHandleDrag,move:this.moveHandleDrag,end:this.endHandleDrag,silent:!0,preventDefault:!0}),this.controller.block.on("textWidgetMouseSelectionStart",this.onMouseSelectionStart),this.controller.block.on("textWidgetMouseSelectionEnd",this.onMouseSelectionEnd),this.$marginInput=this.$el.find(".margin-input"),this.$marginInput.RMNumericInput({needMinMaxCurChanger:!0,min:0,max:999,onChange:this.onInputChange,mouseUse:!1}),this.inputChangeValue=this.$marginInput.data("changeValue"),this.inputChangeMinMax=this.$marginInput.data("changeMinMax"),this.$marginInput.on("focus",this.onInputFocus).on("blur",this.onInputBlur)},onMouseSelectionStart:function(){this.hideHandle(),this.mouseProceeding=!1},onMouseSelectionEnd:function(){this.mouseProceeding=!0,this.onMouseMove()},startHandleDrag:function(t){this.$marginInput.blur(),this.state="dragging",this.oldDelta=0,this.showHandle("show"),this.onMouseMove(),this.controller.block.trigger("textWidgetMarginDragStart")},moveHandleDrag:function(t){if(this.data){var e="top"==this.data.tp||"bottom"==this.data.tp?Math.round(t.deltaY/this.controller.block.zoom):Math.round(t.deltaX/this.controller.block.zoom),i="right"==this.data.tp?-1:1,n=this.data.val+(e-this.oldDelta)*i;n<0?(this.applyStyle(this.data.tp,0),this.oldDelta=e-n*i):n>this.data.max?(this.applyStyle(this.data.tp,this.data.max),this.oldDelta=e+(this.data.max-n)*i):(this.applyStyle(this.data.tp,n),this.oldDelta=e)}},endHandleDrag:function(t){this.controller.block.trigger("textWidgetMarginDragEnd"),t.moved?(this.hideHandle(),this.state="idle",this.onMouseMove()):(this.mxOnFocusEnter=this.mx,this.myOnFocusEnter=this.my,this.$marginInput.focus(),this.$marginInput.select())},onInputFocus:function(){this.state="focus"},onInputBlur:function(){this.state="idle",this.controller.block.isEditMode&&this.controller.block.editor.focus()},onInputChange:function(t,e){this.data&&this.applyStyle(this.data.tp,e)},applyStyle:function(t,e){for(var i=this.controller.block.needSideMarginsSynhronized,n=!i||"left"!=t&&"right"!=t?this.paragraphs:this.controller.block.$iframe_body.find("p"),o=0;o<n.length;o++){var a=n[o];"top"==t&&(a.style.paddingTop=e+"px"),"bottom"==t&&(a.style.paddingBottom=e+"px"),"left"==t&&(a.style.paddingLeft=e+"px",i&&(a.style.paddingRight=e+"px")),"right"==t&&(a.style.paddingRight=e+"px",i&&(a.style.paddingLeft=e+"px")),a.setAttribute("data-mce-style",a.getAttribute("style"))}var r={};r["padding-"+t]=e+"px",this.controller.block.somethingChangedInEditor("margins",r)},onMouseMove:function(t){if(this.shown&&(t&&(this.mx=t.pageX/this.controller.block.zoom,this.my=t.pageY/this.controller.block.zoom),this.mouseProceeding)){if(this.getEditorDimensions(),"idle"==this.state){var e=this.controller.params.handleThreshold;if(this.mx<this.editorLeft-e||this.mx>=this.editorLeft+this.editorWidth+e||this.my<this.editorTop-e||this.my>=this.editorTop+this.editorHeight+e)this.hideHandle();else{for(var i=!1,n=0;n<this.marginHandles.length;n++){var o,a,r=this.marginHandles[n],s=this.editorLeft-this.scrollLeft+r.x,l=this.editorTop-this.scrollTop+r.y;if("top"==r.tp&&(a=e,o=r.size,l-=e-1),"bottom"==r.tp&&(a=e,o=r.size),"left"==r.tp&&(o=e,a=r.size,s-=e-1),"right"==r.tp&&(o=e,a=r.size),!(this.mx<s||this.mx>=s+o||this.my<l||this.my>=l+a)){this.curHoverMarginHandle!=r&&(this.data=D.a.clone(r),this.initialData=D.a.clone(r),this.showHandle("only-line"),this.curHoverMarginHandle=r),i=!0;break}}i||this.hideHandle()}}"dragging"==this.state&&this.updateHandleLabelPos()}},getEditorDimensions:function(){var t=this.controller.block.$el[0].getBoundingClientRect();this.editorWidth=t.width,this.editorHeight=t.height,this.editorLeft=t.left,this.editorTop=t.top},showHandle:function(t){var e=this.data;if(e){var i,n,o=e.x-this.scrollLeft,a=e.y-this.scrollTop;if(e.limited_x=e.x,e.limited_y=e.y,e.limited_size=e.size,"top"==e.tp||"bottom"==e.tp){var r=!1;(a<0||a>=this.editorHeight)&&(r=!0),(o>=this.editorWidth||o+e.size<=0)&&(r=!0),this.$el.toggleClass("out-of-box",r),o<0?(e.limited_x=e.x-o,e.limited_size=e.size+o,o=0):o+e.size>this.editorWidth&&(e.limited_size=this.editorWidth-o)}if("left"==e.tp||"right"==e.tp){r=!1;(o<0||o>=this.editorWidth)&&(r=!0),(a>=this.editorHeight||a+e.size<=0)&&(r=!0),this.$el.toggleClass("out-of-box",r),a<0&&a+e.size>this.editorHeight?(e.limited_y=e.y-a,e.limited_size=this.editorHeight,a=0):a<0?(e.limited_y=e.y-a,e.limited_size=e.size+a,a=0):a+e.size>this.editorHeight&&(e.limited_size=this.editorHeight-a)}var s=this.controller.params.handleThreshold;"top"==e.tp&&(n=s,i=e.limited_size,a-=s-1),"bottom"==e.tp&&(n=s,i=e.limited_size),"left"==e.tp&&(i=s,n=e.limited_size,o-=s-1),"right"==e.tp&&(i=s,n=e.limited_size),this.$el.toggleClass("small",e.limited_size<this.controller.params.minHandleSize),this.$el.css({left:o,top:a,width:i,height:n}),"show"!=t&&"update"!=t||(this.inputChangeValue&&this.inputChangeValue(e.val,!0),this.inputChangeMinMax&&this.inputChangeMinMax(0,e.max)),"show"!=t&&"only-line"!=t||this.$el.removeClass("margin-top").removeClass("margin-bottom").removeClass("margin-left").removeClass("margin-right").addClass("margin-"+e.tp),"show"==t&&this.$el.removeClass("inactive"),"only-line"==t&&this.$el.addClass("only-line")}},hideHandle:function(){this.$el.addClass("inactive"),this.$el.removeClass("only-line"),this.$el.removeClass("out-of-box"),this.data=void 0,this.initialData=void 0,this.state="idle",this.curHoverMarginHandle=void 0,this.mouseProceeding=!0},updateHandleLabelPos:function(t){if(this.data){var e=this.$el.find(".margin-handle-label-wrapper"),i=t?this.mxOnFocusEnter:this.mx,n=t?this.myOnFocusEnter:this.my;if("top"==this.data.tp||"bottom"==this.data.tp){var o=i-(this.editorLeft-this.scrollLeft+this.data.limited_x),a=e.width();o-=Math.round(a/2),o=Math.min(Math.max(o,0),this.data.limited_size-a),e.css({left:Math.round(o),top:"auto"})}else{var r=n-(this.editorTop-this.scrollTop+this.data.limited_y),s=e.height();r-=Math.round(s/2),r=Math.min(Math.max(r,0),this.data.limited_size-s),e.css({top:Math.round(r),left:"auto"})}}},proceed:function(t,e){this.marginHandles=t,this.paragraphs=e,this.initialData&&(this.data=this.getClosestDataToInitial(),this.data?(this.getEditorDimensions(),this.showHandle("update"),"focus"==this.state&&this.updateHandleLabelPos(!0)):this.hideHandle()),this.onMouseMove()},getClosestDataToInitial:function(){for(var t=[],e=0;e<this.marginHandles.length;e++){var i=this.marginHandles[e];i.p==this.initialData.p&&i.tp==this.initialData.tp&&t.push(i)}if(t.length){var n=99999,o=-1;for(e=0;e<t.length;e++){var a=Math.abs(t[e].column-this.initialData.column);a<n&&(n=a,o=e)}return D.a.clone(t[o])}},onScroll:function(t,e){this.scrollTop=t,this.scrollLeft=e,this.showHandle("update")},show:function(){this.shown=!0,Object(l.a)(document).on("mousemove",this.onMouseMove),this.onMouseMove(),this.$el.removeClass("hidden")},hide:function(){this.shown=!1,Object(l.a)(document).off("mousemove",this.onMouseMove),this.$el.addClass("hidden"),this.hideHandle()}}),J=a.a.Model.extend({initialize:function(t){D.a.bindAll(this),this.block=t,this.undoIndex=-1,this.undoStack=[],this.add.__debounced=D.a.debounce(this.add,50),this.historyTriggers={},this.block.$iframe_body.bind("keydown","ctrl+z",this.undo).bind("keydown","ctrl+shift+z",this.redo),this.block.$iframe_body.bind("keydown","meta+z",this.undo).bind("keydown","meta+shift+z",this.redo)},add:function(t,e,i,n){if(this.block.isEditorActive()){var o,a=this,r=a.block.page.getCurrentViewport(),s=function(t){return t.split("<").length-1}(t=t||"<p></p>"),l=this.undoStack[this.undoIndex];if(-1==this.undoIndex||l.content!=t||r!=l.viewport){if("enterEditMode"==e&&(this.undoIndex>=0&&l.start&&(this.undoIndex--,this.undoStack.length=this.undoIndex+1,l=this.undoStack[this.undoIndex]),-1!=this.undoIndex&&r==l.viewport||y({mergable:!1,start:!0}),this.historyTriggers&&this.historyTriggers.triggerChange&&this.historyTriggers.triggerChange(this.block.pid)),"paste"==e&&y({mergable:!1}),"formatApplied"==e)if(this.undoIndex>=0&&l.formatParams&&r==l.viewport){var c=D.a.keys(l.formatParams),d=D.a.keys(n);if(0==D.a.difference(c,d).length&&(o=d,0!=D.a.intersection(o,["font-size","line-height","letter-spacing","color","padding-top","padding-bottom","padding-left","padding-right"]).length)){var h=f(),u=l.initialSelection;h.startOffset==u.startOffset&&h.endOffset==u.endOffset&&D.a.isEqual(h.startNodePosition,u.startNodePosition)&&D.a.isEqual(h.endNodePosition,u.endNodePosition)?(l.content=t,l.formatParams=n,l.selection=f(),l.initialSelection=D.a.clone(l.selection),this.undoStack.length=this.undoIndex+1):y({mergable:!1,formatParams:n})}else y({mergable:!1,formatParams:n})}else y({mergable:!1,formatParams:n});if("keydown"==e&&this.undoIndex>=0)if(l.tagsCount!=s)y({mergable:!1});else{var p=b(l.content),m=b(t),g=p.length<=m.length;if(l.mergable)if(Math.abs(p.length-m.length)>2)y({mergable:!0,increasing:g});else if(g!=l.increasing||r!=l.viewport)y({mergable:!0,increasing:g});else{h=f(),u=l.initialSelection;Math.abs(h.startOffset-u.startOffset)>2||!D.a.isEqual(h.startNodePosition,u.startNodePosition)?y({mergable:!0,increasing:g}):(l.content=t,l.selection=f(),l.initialSelection=D.a.clone(l.selection),this.undoStack.length=this.undoIndex+1)}else y({mergable:!0,increasing:g})}}else this.undoIndex>=0&&(l.selection=f())}function f(){var t=i.getRangeAt(0)||{};if(t.startContainer&&"BODY"!=t.startContainer.tagName){var e={};return e.startOffset=t.startOffset,e.endOffset=t.endOffset,t.startContainer==t.endContainer?(e.sameNode=!0,e.startNodePosition=v(t.startContainer),e.endNodePosition=e.startNodePosition):(e.sameNode=!1,e.startNodePosition=v(t.startContainer),e.endNodePosition=v(t.endContainer)),e}}function v(t){for(var e=[];;){if("BODY"==t.tagName)break;if(e.push(i(t)),!(t=t.parentNode)||!t.tagName)break}return e;function i(t){for(var e=0;null!=(t=t.previousSibling);)t.textContent&&++e;return e}}function b(t){return t.replace(/&\S+?;/gim,"$")}function y(e){e=e||{},a.undoIndex++,a.undoStack[a.undoIndex]={content:t,mergable:e.mergable,tagsCount:s,increasing:e.increasing,formatParams:e.formatParams,viewport:r,start:e.start,selection:f()},a.undoStack[a.undoIndex].initialSelection=D.a.clone(a.undoStack[a.undoIndex].selection),a.undoStack.length=a.undoIndex+1,l=a.undoStack[a.undoIndex],a.historyTriggers&&a.historyTriggers.triggerChange&&a.historyTriggers.triggerChange(a.block.pid)}},undo:function(t){if(t&&t.stopPropagation&&(t.stopPropagation(),t.preventDefault()),this.block.isEditorActive()&&this.undoIndex>0){if(this.undoStack[this.undoIndex-1].viewport!=this.block.page.getCurrentViewport())return;this.undoIndex--,this.restoreState(this.undoIndex),this.block.somethingChangedInEditor("undo"),this.historyTriggers.triggerChange&&this.historyTriggers.triggerChange(this.block.pid),this.historyTriggers.triggerUndo&&this.historyTriggers.triggerUndo(this.block.pid)}},redo:function(t){if(t&&t.stopPropagation&&(t.stopPropagation(),t.preventDefault()),this.block.isEditorActive()&&this.undoIndex<this.undoStack.length-1){if(this.undoStack[this.undoIndex+1].viewport!=this.block.page.getCurrentViewport())return;this.undoIndex++,this.restoreState(this.undoIndex),this.block.somethingChangedInEditor("redo"),this.historyTriggers.triggerChange&&this.historyTriggers.triggerChange(this.block.pid),this.historyTriggers.triggerRedo&&this.historyTriggers.triggerRedo(this.block.pid)}},getLength:function(t){for(var e=0,i=this.block.page.getCurrentViewport();this.undoIndex-e>=0&&this.undoStack[this.undoIndex-e].viewport==i;)e++;return{undo:e-1,redo:this.undoStack.length-1-this.undoIndex,page:t}},restoreState:function(t){this.block.editor.setContent(this.undoStack[t].content||"");var e=this.undoStack[t].selection,i=this;if(e){var n,o=r(e.startNodePosition);if(n=e.sameNode?o:r(e.endNodePosition),o&&n)try{var a=this.block.iframe_document.createRange();a.setStart(o,e.startOffset),a.setEnd(n,e.endOffset),this.block.editor.selection.setRng(a)}catch(t){}}function r(t){for(var e=i.block.$iframe_body[0],n=t.length-1;n>=0;n--){if(!(e&&e.childNodes&&e.childNodes.length&&e.childNodes.length>=t[n]+1)){e=void 0;break}e=e.childNodes[t[n]]}return e}}}),Q=a.a.View.extend({initialize:function(t){D.a.bindAll(this),this.block=t,this.container=this.block.$(".columns-wrapper-inner")[0],this.columnBlocks=[],this.block.$iframe_document.on("scroll",this.onScroll),this.onScroll()},onScroll:function(){this.scrollTop=this.block.$iframe_document.scrollTop(),this.scrollLeft=this.block.$iframe_document.scrollLeft(),Object(l.a)(this.container).css({top:-this.scrollTop,left:-this.scrollLeft})},recalc:function(){if(this.block.isEditorActive())if(this.block.model.get("column_count")>1){this.block.$(".columns-wrapper").removeClass("single-column");for(var t=this.block.calcColumnsPositions(),e=t.length-1,i=this.prevUsedBlocks?this.prevUsedBlocks:this.columnBlocks.length,n=0;n<i;n++)this.columnBlocks[n].style.display="none";for(n=0;n<e;n++)this.columnBlocks[n]||(this.columnBlocks[n]=this.createNewColumnBlock()),this.render(this.columnBlocks[n],t[n].ed,t[n+1].st-t[n].ed);this.prevUsedBlocks=e}else this.block.$(".columns-wrapper").addClass("single-column")},createNewColumnBlock:function(){var t=document.createElement("div");t.className="gap",this.container.appendChild(t);var e=document.createElement("div");return e.className="frameborder",t.appendChild(e),t},render:function(t,e,i){var n=t.style;n.left=e+"px",n.width=i+"px",n.display="block"},show:function(){this.block.$(".columns-wrapper").removeClass("hidden"),this.onScroll()},hide:function(){this.block.$(".columns-wrapper").addClass("hidden")}}),tt=b.a.extend({customResizeHandler:function(t){return this.block.model.get("autosize")&&(this.block.$el.css("width",t.width),t.height=this.block.getContentBoxHeight()),t}}),et=K,it=Object(d.a)("constructor.textv3")?R:et,nt=i("gdoY"),ot=i("PhV8"),at=i("Vxjr"),rt=c.a.extend({name:"Video",sort_index:4,thumb:"video",icon_color:"#1877F2",MIN_WIDTH:85,MIN_HEIGHT:85,video_controls:["video_settings"],settingsOnCreate:!0,initialize:function(t,e){this.controls=D.a.union(this.video_controls,this.controls),this.initBlock(t,e),void 0===this.model.get("info")&&this.model.set("info",!0,{silent:!0}),t.on("change:video_id",this.draw),this.getEmbed=nt.a.video.prototype.getEmbed,this.getCustomVideoPoster=nt.a.video.prototype.getCustomVideoPoster,this.getCustomThumbnail=nt.a.video.prototype.getCustomThumbnail,D.a.bindAll(this),this.saveDebounced=D.a.debounce(D.a.bind((function(){this.panel?this.panel.save():t.save()}),this),2e3)},render:function(){this.create(),this.frame.minwidth=this.MIN_WIDTH,this.frame.minheight=this.MIN_HEIGHT,this.$el.addClass("video"),this.draw(),this.triggerReady()},draw:function(){var t=Object(l.a)("<div>").css({width:"100%",height:"100%",position:"absolute"});this.$content.empty().append(t).append(this.getEmbed(D.a.extend(D.a.clone(this.model.attributes),{real:!1}))),this.$iframe=this.$("iframe"),this.$poster=this.$(".poster"),this.$f=null,this.model.get("video_id")&&(this.$el.removeClass("empty"),"Vimeo"===this.model.get("provider_name")&&(this.$f=Object(ot.a)(this.$iframe.get(0)),this.$f.addEvent("ready",this.setColor)))},redraw:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.checkNeedRedraw(t,e)&&(c.a.prototype.redraw.apply(this,arguments),(t.hasChanged("info")||t.hasChanged("theme"))&&this.draw(),t.hasChanged("color")&&this.setColor(),(t.hasChanged("picture")||t.hasChanged("custom_thumbnail"))&&this.onCustomThumbnailChange(t),this.workspace.trigger("redraw"))},onCustomThumbnailChange:function(t){!0===t.changed.custom_thumbnail&&t.attributes.picture&&t.attributes.picture.url||t.changed.picture?this.draw():(this.$iframe&&this.$iframe.css("visibility","visible"),this.$poster&&(this.$poster.off(),this.$poster.remove()))},setColor:function(t){this.model.get("provider_name")&&"vimeo"!==this.model.get("provider_name").toLowerCase()||(this.$f||(this.$f=Object(ot.a)(this.$iframe.get(0))),this.$f.api("setColor",this.model.get("color")),this.model.hasChanged("color")&&this.saveDebounced())},css:function(t){c.a.prototype.css.apply(this,arguments),t.width&&(this.$iframe&&this.$iframe.attr("width",t.width),this.$poster&&this.$poster.css({width:t.width})),t.height&&(this.$iframe&&this.$iframe.attr("height",t.height),this.$poster&&this.$poster.css({height:t.height}))},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i="./constructor/widgetbar/icons/",n=this.model.get("thumbnail_url");t.small&&this.icon_color&&(e["background-color"]=this.icon_color),t.small||(e["border-radius"]="8px");var o=Object(at.findImagePath)("".concat(i,"video.svg"));return n&&(o=n,e["background-size"]="auto 150%"),e["background-image"]="url(".concat(o,")"),e}},{defaults:{thumbnail_url:""}}),st=i("hdsW"),lt=i("HlXo"),ct=i.n(lt),dt=c.a.extend({name:"Music",sort_index:6,thumb:"audio",icon_color:"#EC520B",initialize:function(t,e){var i=this;this.initBlock(t,e),this.inner_template=ct.a["template-constructor-block-audio"],this.frameClass=ht,this.controls=["audio_settings","common_animation","common_position","common_layer","common_lock"],this.drawDebounced=D.a.debounce(this.draw,500),this.listenTo(this.workspace.mag,"change:opts",(function(){return i.draw()})),this.listenTo(this.workspace.mag,"change:desktopWidth",(function(){return i.drawDebounced()}))},render:function(){this.create(),this.applySizeConstraints(),Object(l.a)(this.inner_template(this.model.attributes)).appendTo(this.$content),this.currentPlayer=null,this.lastPlayer=null,this.$el.addClass("audio"),this.draw(),this.$el.addClass("empty"),this.triggerReady()},applySizeConstraints:function(){var t,e,i;"visual"==this.model.get("current_type")&&(t=200,e=200),"standard"==this.model.get("current_type")&&(t=200,e=166,166==this.model.get("embed_height")&&(i=166)),"minimal"==this.model.get("current_type")&&(t=200,e=224,this.model.get("artwork")||(e=83,i=83),this.model.get("artwork")||this.model.get("info")||(e=26,i=26)),this.$el.toggleClass("no-height-resize",e==i),D.a.extend(this.frame,{minwidth:t,maxwidth:void 0,minheight:e,maxheight:i}),this.model.get("w")<this.frame.minwidth&&this.model.set("w",this.frame.minwidth,{silent:!0}),this.model.get("w")>this.frame.maxwidth&&this.model.set("w",this.frame.maxwidth,{silent:!0}),this.model.get("h")<this.frame.minheight&&this.model.set("h",this.frame.minheight,{silent:!0}),this.model.get("h")>this.frame.maxheight&&this.model.set("h",this.frame.maxheight,{silent:!0}),!this.model.get("resized")&&"standard"==this.model.get("current_type")&&this.model.get("embed_height")>166&&this.model.set("h",Math.min(this.model.get("embed_height"),450),{silent:!0}),this.frame.doResize({left:this.model.get("x"),top:this.model.get("y"),width:this.model.get("w"),height:this.model.get("h")})},draw:function(t){this.model.get("parsed_url")?this.lastPlayer=new st.a({params:D.a.clone(this.model.attributes),$container:this.$content.find(".player-wrapper"),readyCallback:this.playerReady.bind(this),viewport:this.workspace.page.getCurrentViewport(),viewportWidth:this.workspace.mag.getViewportWidth(this.workspace.page.getCurrentViewport()),viewerOptions:this.workspace.mag.get("opts")}):(this.lastPlayer&&this.lastPlayer.destroy(),this.currentPlayer&&this.lastPlayer!=this.currentPlayer&&this.currentPlayer.destroy(),this.currentPlayer=null,this.lastPlayer=null,this.$el.addClass("empty")),t&&t.triggerRedraw&&this.workspace.trigger("redraw")},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i="./constructor/widgetbar/icons/",n=this.model.get("thumbnail_url");t.small&&this.icon_color&&(e["background-color"]=this.icon_color),t.small||(e["border-radius"]="8px");var o=Object(at.findImagePath)("".concat(i,"audio.svg"));return n&&(o=n,e["background-size"]="cover"),e["background-image"]="url(".concat(o,")"),e},applyMinimalPlayerStyle:function(t){this.currentPlayer&&this.currentPlayer.applyPlayerStyle&&this.currentPlayer.applyPlayerStyle(t),this.workspace.trigger("redraw")},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t,e)){c.a.prototype.redraw.apply(this,arguments);var i=this.model.changedAttributes(),n=D.a.isObject(i)&&0==D.a.without(D.a.keys(i),"w","h","x","y","z").length;if(n||this.applySizeConstraints(),D.a.isObject(i))if(null==i.url)if(i.current_type)this.drawDebounced();else{var o=["comments","artwork","socials","playcount","color"],a=["artwork","info","color"];Object(D.a)(["standard","visual"]).contains(this.model.get("current_type"))&&D.a.intersection(D.a.keys(i),o).length&&this.drawDebounced(),"minimal"==this.model.get("current_type")&&D.a.intersection(D.a.keys(i),a).length&&this.applyMinimalPlayerStyle(D.a.clone(this.model.attributes))}else this.draw({triggerRedraw:!0});else this.drawDebounced()}},playerReady:function(t){this.$el.removeClass("empty"),this.lastPlayer==t?(this.currentPlayer&&t!=this.currentPlayer&&this.currentPlayer.destroy(),this.model.get("parsed_url")&&(this.currentPlayer=t,this.currentPlayer.show())):t.destroy()},getBoxData:function(){return D.a.extend(c.a.prototype.getBoxData.apply(this,arguments),{resized:!0})}},{defaults:{current_type:"visual",autoplay:!1,comments:!1,artwork:!0,socials:!0,playcount:!0,info:!0,color:"ff5100",thumbnail_url:"",w:400,x:"center",h:400}}),ht=b.a.extend({customResizeHandler:function(t,e,i){if("minimal"==this.block.model.get("current_type")&&this.block.model.get("artwork"))if(e){if("n"!=e&&"s"!=e||(t.width=t.height-24),"w"!=e&&"e"!=e||(t.height=t.width+24),"se"==e&&(t.width>t.height-24?t.height=t.width+24:t.width=t.height-24),"nw"==e||"ne"==e||"sw"==e||"se"==e){var n=t.width+t.left,o=t.height+t.top;t.width>t.height-24?t.height=t.width+24:t.width=t.height-24,"nw"==e&&(t.left=n-t.width,t.top=o-t.height),"ne"==e&&(t.top=o-t.height),"sw"==e&&(t.left=n-t.width)}}else t.height=t.width+24;if(!i){var a=D.a.pick(this.block.model.attributes,"x","y","w","h");a.x==t.left&&a.y==t.top&&a.w==t.width&&a.h==t.height||(this.block._saveXHR&&this.block._saveXHR.abort(),this.block._saveXHR=this.block.model.save({x:t.left,y:t.top,w:t.width,h:t.height}))}return t}}),ut=dt,pt=a.a.View.extend({excludedFromLib:!0,initialize:function(t){this.parent=t.block,this.getEmbed=nt.a.video.prototype.getEmbed,this.getCustomVideoPoster=nt.a.video.prototype.getCustomVideoPoster,this.getCustomThumbnail=nt.a.video.prototype.getCustomThumbnail},render:function(){if(this.setElement(this.parent.$el.find(".video")),this.parent.model.get("video")){var t=D.a.extend({real:!1,id:this.parent.id},this.parent.model.get("video"));this.$el.css({opacity:this.parent.model.get("videoopacity")}),this.$el.find(".container").html(this.getEmbed(t)),this.rendered=!0}},show:function(){this.rendered||this.render(),this.$el.stop().animate({opacity:this.parent.model.get("videoopacity")})},hide:function(){this.$el.stop().animate({opacity:0},{queue:!1})},toggle:function(){this.rendered||this.render(),this.$el.stop().toggleFade()}}),mt=i("f3SV"),gt=i("X7yJ"),ft=i("roQd"),vt=c.a.extend({RESCALE_URL:"/api/imagescale",FINAL_URL:"/api/imagefinal",PREVIEW_URL:"/api/imagepreview",LAMBDA_FROM_URL:"/api/upload/lambda/fromurl",SVG_URL:"/api/imagesvg",allowedLambdaExt:function(){var t=this.model.get("picture");return t?gt.a.allowedLambdaExt(t.type):void 0},useLambdaUrl:function(){return gt.a.useLambdaUrl(this.model.get("picture"))},getLambdaUrl:function(){var t=ft.a.normalizeAnimations(this.model.get("animation")).reduce((function(t,e){return Math.max(t,ft.a.maxScaleAnimation(e))}),0);return gt.a.getLambdaUrl(this.model.get("picture"),{width:this.model.get("w"),height:this.model.get("h"),cropX:this.model.get("cropX"),cropY:this.model.get("cropY"),cropW:this.model.get("cropW"),cropH:this.model.get("cropH"),originalW:this.model.get("originalW"),originalH:this.model.get("originalH"),scale:RM.constructorRouter.zoom.getZoom(),animationScale:t&&t/100,isStretched:this.model.get("is_full_width")||this.model.get("is_full_height")})},getOriginalLambdaUrl:function(){return gt.a.getOriginalLambdaUrl(this.model.get("picture"))},getLqipUrl:function(){return gt.a.getLqipUrl(this.model.get("picture"),{cropX:this.model.get("cropX"),cropY:this.model.get("cropY"),cropW:this.model.get("cropW"),cropH:this.model.get("cropH"),originalW:this.model.get("originalW"),originalH:this.model.get("originalH")})},getThumbnailUrl:function(){return gt.a.getThumbnailUrl(this.model.get("picture"))},removePicture:function(){this.model.unset("picture"),this.model.save({},{silent:!0,toHistory:!0}),this._fromUrlXHR&&this._fromUrlXHR.abort(),this._getFinalRequest&&this._getFinalRequest.abort()},getPictureUrl:function(){var t=this.model.get("picture");return t?this.useLambdaUrl()?this.getLambdaUrl():Modernizr.retina&&t.final2xUrl||t.finalUrl||t.unscaledOptimizedUrl||t.url:""},getVectorUrl:function(){var t=this.model.get("picture");return t?t.editedVectorUrl||t.url:""},getOpacity:function(){var t=this.model.get("opacity");return D.a.isNumber(t)?t:1},getFinalImage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.useLambdaUrl()){var i=this.model.get("picture"),n=this.model.isNested?"default":e.viewport||this.model.collection.page.getCurrentViewport(),o=this.model.get("w");if(o!==this.model.get("w"))return;this.isFullWidth()&&this.model.set("w",this.getFullWidthDims().w,{silent:!0}),this.isFullHeight()&&this.model.set("h",this.getFullHeightDims().h,{silent:!0}),this.model.save("picture",i,D.a.extend(e||{},{viewport:n})),t&&t(null)}else{var a=this.model.get("picture");if(!a||!a.url||this.isVector(a.url,a.type))return t&&t(null);var r=this.model.isNested?"default":e.viewport||this.model.collection.page.getCurrentViewport(),s=this.model.get("w");this._getFinalRequest&&this._getFinalRequest.abort(),this.showTempPreloader&&this.showTempPreloader(),this._getFinalRequest=l.a.ajax({type:"POST",data:this.model.attributes,url:this.FINAL_URL,success:function(i){this.hideTempPreloader()&&this.hideTempPreloader(),s===this.model.get("w")&&(this.isFullWidth()&&this.model.set("w",this.getFullWidthDims().w,{silent:!0}),this.isFullHeight()&&this.model.set("h",this.getFullHeightDims().h,{silent:!0}),this.model.save("picture",D.a.extend({},a,i),D.a.extend(e||{},{viewport:r})),t&&t(null,i))},error:function(e){t&&t(e.responseText)},context:this})}},requestFinalImage:function(t,e){l.a.ajax({type:"POST",data:t,url:this.FINAL_URL,success:function(t){e&&e(t)}})},loadPreviewUrl:function(t,e){var i=this.model.get("picture");i&&l.a.ajax({type:"GET",data:{width:t.w,height:t.h,url:i.rasterUrl||i.url,mid:this.workspace.mag.get("num_id")},url:this.PREVIEW_URL,success:D.a.bind((function(t){i.previewUrl=t&&t.previewUrl,this.model.save({picture:i},{silent:!0,toHistory:!0}),e&&e.success(t)}),this)})},loadFromUrl:function(t,e){var i=e||{};return this._fromUrlXHR&&this._fromUrlXHR.abort(),this._fromUrlXHR=l.a.ajax({type:"POST",data:{url:t,id:this.model.id,name:this.name,uploadType:"picture",mid:this.workspace.mag.get("num_id")},url:this.LAMBDA_FROM_URL,context:this,success:function(t){this.changePicture(t,i),i.success&&"function"==typeof i.success&&i.success()},error:function(t,e){if(i.error&&"function"==typeof i.error&&i.error(),!e||"abort"!==e)return t&&413===t.status?alert(mt.a.MSG_UPLOAD_IMAGE_SIZE_ERROR):void alert("There's something wrong with this picture. Please, try the different one.")}}),this._fromUrlXHR},isVector:function(t,e){var i=this.model.get("picture"),n=t||i&&i.url,o=e||this.tempPicture&&this.tempPicture.type||i&&i.type;return o?"svg"===o:n&&0===D.a.last(n.split(".")).indexOf("svg")},isAnimated:function(t){var e=this.model.get("picture");return"gif"===(t||e&&e.type||this.tempPicture&&this.tempPicture.type)},loadVector:function(t){if(t=t||{},this.svgAjax&&this.svgAjax.abort(),this.$svg&&this.$svg.remove(),delete this.$svg,delete this.$svgColoredElems,delete this.originalSvg,delete this.originalSize,this.isVector()){var e=this.getVectorUrl();if(e)Object(l.a)("body > #svg-container").get(0)||Object(l.a)('<div id="svg-container"></div>').appendTo("body"),this.svgAjax=l.a.get(e+"?c",D.a.bind((function(i){this.$svg=Object(l.a)(i).find("svg"),this.originalSize={width:this.$svg.attr("width"),height:this.$svg.attr("height")},this.$svg.removeAttr("width").removeAttr("height");var n=Object(l.a)(i).find("svg").get(0).cloneNode(!0),o=new Image;Object(l.a)(o).on("load error",D.a.bind((function(){Object(l.a)(o).appendTo("#svg-container").css({width:"100%",height:"100%"});var t=Object(l.a)(n);t.get(0).setAttribute("viewBox","0 0 "+Object(l.a)(o).width()+" "+Object(l.a)(o).height()),t.appendTo("#svg-container");var e=t.get(0).getBBox();this.$svg.get(0).setAttribute("viewBox",e.x+" "+e.y+" "+e.width+" "+e.height),this.$svg.get(0).setAttribute("preserveAspectRatio","xMidYMid meet"),Object(l.a)(o).remove(),t.remove()}),this)),o.src=this.getVectorUrl(),this.originalSvg=i,this.getVectorUrl()===e&&(t.success&&t.success(this.$svg),this.model.get("picture").editedVectorUrl||this.pickVectorColor(t))}),this)).always(D.a.bind((function(){delete this.svgAjax}),this)).fail(t.error||l.a.noop)}},pickVectorColor:function(t){if(this.$svg){var e=[],i=[],n=[],o=function(t,o){var a=e.indexOf(t);t&&/^#\w+$/.test(t)&&(-1==a?(e.push(t),i.push(1)):i[a]++),n.push(o)},a=Object(l.a)("<div></div>");this.$svg.find("*").each((function(){a.attr("style",Object(l.a)(this).attr("style"));var t=a.css("fill");return t?o(t,Object(l.a)(this)):Object(l.a)(this).attr("fill")?o(Object(l.a)(this).attr("fill"),Object(l.a)(this)):void 0}));var r=i.indexOf(D.a.max(i)),s=e[r];s&&/^#?\w\w\w$/.test(s)&&(s=[s[0],s[1],s[1],s[2],s[2],s[3],s[3]].join("")),s||(s="#ffffff"),s=s&&s.toLowerCase(),this.model.get("pic_color")||(s&&this.model.set({pic_color:s.substr(1),pic_opacity:1},{patch:!0,skipTriggerRedraw:!0}),this.changeControls&&this.changeControls()),s&&(this.$svgColoredElems=n)}},setVectorColor:function(t,e){if(this.$svgColoredElems){var i=Object(l.a)("<div></div>");D.a.each(this.$svgColoredElems,(function(t){i.attr("style",t.attr("style")),i.css({fill:"","fill-opacity":""}),t.get(0).setAttributeNS(null,"style",i.attr("style")),t.get(0).setAttributeNS(null,"fill",""),t.get(0).setAttributeNS(null,"fill-opacity","")})),delete this.$svgColoredElems}this.$svg.get(0).setAttributeNS(null,"fill","#"+t),this.$svg.get(0).setAttributeNS(null,"fill-opacity",e)},saveSvg:function(t){if(this.originalSvg&&this.originalSize){var e=this.originalSvg.importNode(this.$svg[0],!0);return Object(l.a)(e).attr("width",this.originalSize.width).attr("height",this.originalSize.height).css("display",""),l.a.ajax({url:this.SVG_URL,type:"POST",data:{svg:(new XMLSerializer).serializeToString(e),mid:this.workspace.mag.get("num_id")},success:function(e){this.model.get("picture").editedVectorUrl=e&&e.editedVectorUrl,delete this.model.get("picture").finalUrl,delete this.model.get("picture").final2xUrl,t&&t()},context:this})}}}),bt=i("0zSa"),yt=i("tf3M"),_t=i("WoDZ"),wt=vt.extend({name:"Background",thumb:"bg",outofbox:!0,excludedFromLib:!0,immortal:!0,controls:[],defaultSlideshow:{delay:4,crossfade:.5,pictures:[]},viewport_fields:m.b.viewport_fields.background,initialize:function(t,e){this.initBlock(t,e),void 0===this.model.get("mute")&&this.model.set("mute",!0,{silent:!0}),void 0===this.model.get("loop")&&this.model.set("loop",!0,{silent:!0}),this.createEl(),this.hide(),this.workspace.on("show",this.show),this.workspace.on("hide",this.hide),this.workspace.$el.parent().on("scroll",this.onScroll),this.on("loadimage",this.onLoadImage),this.on("unloadimage",this.onUnloadImage)},createEl:function(){this.setElement(Object(l.a)('<div class="background"><div class="picture smooth3d"></div>       <div class="slideshow-container"></div><div class="slideshow-preload"></div><div class="video">       <div class="overlay"></div>       <div class="container"></div>       </div></div></div>').appendTo(Object(l.a)("#main-background"))),this.$picture=this.$(".picture"),this.$video=this.$(".video"),this.$color=this.$el,this.$slideshow=this.$(".slideshow-container"),this.$slideshowPreload=this.$(".slideshow-preload"),this.video=new pt({block:this}),this.slideshowWidget=new bt.a({data:this.model.get("slideshow"),container:this.$slideshow,preloadContainer:this.$slideshowPreload})},validate:function(){var t=D.a.difference(m.b.viewport_fields.background,m.b.viewport_fields_common);this.model.fillMissingFieldsFromDefaultViewport(t)},render:function(){this.updateBGColor(),"picture"===this.model.get("selectedType")&&this.loadPic({success:this.showPic}),"video"===this.model.get("selectedType")&&(this.video.render(),this.onResize()),"slideshow"===this.model.get("selectedType")&&this.slideshowWidget.render(!0),this.rendered=!0,this.triggerReady()},updateBGColor:function(){var t=this.model.get("color")||"FFFFFF";this.$color.css({"background-color":"#"+t})},onViewportUpdate:function(t){"default"===t.viewport?(this.$el.removeClass("is-viewport"),this.$picture.css({width:"",height:"",top:"",left:"","margin-left":"","margin-top":""}),this.$slideshow.css({width:"",height:"",top:"",left:"","margin-left":"","margin-top":""})):(this.$el.addClass("is-viewport"),this.$picture.css({width:t.width,height:t.min_height,top:"50%",left:"50%","margin-left":-t.width/2,"margin-top":-t.min_height/2}),this.$slideshow.css({width:t.width,height:t.min_height,top:"50%",left:"50%","margin-left":-t.width/2,"margin-top":-t.min_height/2})),this.lastViewportParams=t},getPictureUrl:function(){var t=this.model.get("picture");return t?gt.a.useLambdaUrl(t)?gt.a.getLambdaUrl(t):t.finalUrl||t.unscaledOptimizedUrl||t.url:""},getThumbnailUrl:function(t){return t?gt.a.useLambdaUrl(t)?gt.a.getThumbnailUrl(t):t.thumbUrl:""},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.model.get("video"),i=this.model.get("selectedType"),n={background:"#".concat(this.model.get("color"))};if(t.small)return n;if("picture"===i){var o=this.model.get("picture"),a=this.getThumbnailUrl(o);if(a)return{"background-image":"url(".concat(a,")")}}else if("video"===i){if(e&&e.thumbnail_url)return{"background-image":"url(".concat(e.thumbnail_url,")")}}else if("slideshow"===i){var r=this.model.get("slideshow");if(r&&r.pictures&&Array.isArray(r.pictures)&&r.pictures.length){var s=this.getThumbnailUrl(D.a.sortBy(r.pictures,"num")[0]);return{"background-image":"url(".concat(s,")")}}}return n},changePicture:function(t,e){var i=this.workspace.page.getCurrentViewport();e=D.a.defaults(e||{},{save:!0});var n={picture:t.picture};"default"===i&&D.a.each(yt.default.viewports,function(t){D.a.isEmpty(this.model[t])||this.model.set({picture:n.picture},{viewport:t.replace(/^viewport_/,""),silent:!0})}.bind(this)),e.save?this.model.save(n,e):this.model.set(n,e)},onResize:function(){if("video"===this.model.get("selectedType")){var t=this.model.get("video"),e=this.$el.find(".container");!D.a.isEmpty(t)&&t.provider_name&&_t.a.setVideoPosition({$container:e,$media:e.find("iframe"),provider:t.provider_name,aspect_poster:t.aspect_poster,aspect_real:"vimeo"==t.provider_name.toLowerCase()?t.aspect_real:t.aspect_poster,controls_remove:!0})}},show:function(){var t=this.$el.parent();this.$el.detach().appendTo(t).stop().animate({opacity:1}),this.onResize(),Object(l.a)(window).on("resize",this.onResize)},hide:function(){this.$el.stop().animate({opacity:0}),"slideshow"===this.model.get("selectedType")&&this.slideshowWidget&&this.slideshowWidget.isAnimationRunning&&this.slideshowWidget.stopAnimationLoop(),Object(l.a)(window).off("resize",this.onResize)},saveSlideshowPicture:function(t,e){var i,n,o=this.workspace.page.getCurrentViewport(),a=this.model.get("slideshow"),r=a&&a.pictures&&Array.isArray(a.pictures)&&a.pictures.length,s=Object.assign({},t.picture,t.size),l=1;r?(n=D.a.cloneWithObjects(a),l=this.getMaxNum(a.pictures)+1,i=Object.assign(s,{num:l,uuid:v.default.generateUUID()}),n.pictures.push(i),n.pictures=D.a.sortBy(n.pictures,"num")):(n=D.a.cloneWithObjects(this.defaultSlideshow),i=Object.assign(s,{num:l,uuid:v.default.generateUUID()}),n.pictures=[i]);var c={slideshow:n};"default"==o&&D.a.each(yt.default.viewports,function(t){D.a.isEmpty(this.model[t])||this.model.set({slideshow:c.slideshow},{viewport:t.replace(/^viewport_/,""),silent:!0})}.bind(this)),e.save?this.model.save(c,e):this.model.set(c,e),this.addPictureToSlideshow(i)},updateSlideshowPicture:function(t,e){var i=this.model.get("slideshow"),n=i.pictures.findIndex((function(t){return t.uuid===e.id})),o=Object.assign({},i.pictures[n],t.picture,t.size),a=D.a.cloneWithObjects(i);a.pictures[n]=o;var r={slideshow:a};this.model.save(r,e),this.slideshowWidget.updatePicture(o)},selectSlideshowPicture:function(t){this.slideshowWidget.selectSlide(t)},deleteSlideshowPicture:function(t){this.slideshowWidget.removePicture(t)},updateSlideshowPicturePosition:function(t){this.slideshowWidget.updatePicturePosition(t)},getMaxNum:function(t){return D.a.isEmpty(t)?0:D.a.max(D.a.pluck(t,"num"))},addPictureToSlideshow:function(t){this.slideshowWidget.addPicture(t)},updateSideshowDelay:function(t){this.slideshowWidget.setDelay(t)},updateSideshowCrossfade:function(t){this.slideshowWidget.setCrossfade(t)},runSlideshow:function(){this.slideshowWidget&&this.slideshowWidget.runAnimation()},stopSlideshow:function(){this.slideshowWidget&&this.slideshowWidget.stopAnimationLoop()},loadPic:function(t){t=t||{},this.cancelPictureLoading(),t.url||(t.url=this.getPictureUrl()),this.picUrl=t.url;var e=D.a.isFunction(t.success)?t.success:l.a.noop,i=D.a.isFunction(t.error)?t.error:l.a.noop;if(!this.picUrl)return e();var n=this._loadingPic=Object(l.a)("<img>").addClass("preload_image").appendTo("body").attr("src",this.picUrl).on("load",e).on("error",i).on("load",D.a.bind((function(){this.trigger("loadimage","main"),D.a.defer(function(){n==this._loadingPic&&this.cancelPictureLoading(),n=null}.bind(this))}),this)).on("error",D.a.bind((function(){D.a.defer(function(){n==this._loadingPic&&this.cancelPictureLoading(),n=null}.bind(this))}),this))},cancelPictureLoading:function(){this._loadingPic&&this._loadingPic.off("load").off("error").removeAttr("src").remove(),this._loadingPic=void 0},previewPic:function(t,e){if(t&&"svg"===D.a.last(t.split(".")))return e&&e.error&&e.error();e=e||{},this.loadPic({url:t,error:e.error,success:D.a.bind((function(){this.renewPic(),D.a.isFunction(e.success)&&e.success()}),this)})},onLoadImage:function(t){"preview"==t&&(this.previewLoaded=!0),"main"==t&&(this.mainLoaded=!0),this.panel?this.previewLoaded&&this.mainLoaded&&this.trigger("imagesReady"):this.mainLoaded&&this.trigger("imagesReady")},onUnloadImage:function(t){"preview"==t&&(this.previewLoaded=!1),"main"==t&&(this.mainLoaded=!1)},showPic:function(){this.$picture.stop().animate({opacity:this.model.get("opacity")}),this.$picture.css({"background-image":this.picUrl?"url("+this.picUrl+")":""})},redraw:function(t,e){e=e||{},this.checkNeedRedraw(t,e)&&(D.a.isEmpty(t.changed)||(this.validate(),t.hasChanged("color")&&this.updateBGColor(),e.viewportChange&&!e.first&&"slideshow"===t.get("selectedType")&&this.slideshowWidget.rerender(t.get("slideshow")),t.hasChanged("picture")&&this.getPictureUrl()!=this.picUrl&&"picture"==t.get("selectedType")&&(this.getPictureUrl()?(this.trigger("unloadimage","main"),this.on("imagesReady",this.renewPic),this.loadPic()):this.loadPic({success:this.showPic})),t.hasChanged("opacity")&&this.$picture.css("opacity",this.model.get("opacity")),"video"===t.get("selectedType")&&(t.hasChanged("videoopacity")&&this.$video.css("opacity",this.model.get("videoopacity")),t.hasChanged("video")&&this.onResize()),t.hasChanged("selectedType")&&("picture"===this.model.get("selectedType")?this.loadPic({success:D.a.bind((function(){this.video.hide(),this.$slideshow.animate({opacity:0}),this.slideshowWidget.stopAnimationLoop(),this.showPic()}),this)}):"video"===this.model.get("selectedType")&&e.viewportChange&&!e.first?(this.$picture.stop().animate({opacity:0}),this.$slideshow.animate({opacity:0}),this.slideshowWidget.stopAnimationLoop(),this.video.show(),this.onResize()):"slideshow"===this.model.get("selectedType")?(this.$picture.stop().animate({opacity:0}),this.video.hide(),this.$slideshow.animate({opacity:1}),this.slideshowWidget.runAnimation()):(this.video.hide(),this.$picture.stop().animate({opacity:0}),this.slideshowWidget.stopAnimationLoop(),this.$slideshow.animate({opacity:0}),this.model.get("selectedType")||this.model.set("selectedType","color",{first:!0}))),this.workspace.trigger("redraw")))},renewPic:function(){if(this.off("imagesReady",this.renewPic),this.skipRenew)this.skipRenew=!1;else{var t=this.$el;this.createEl(),this.onViewportUpdate(this.lastViewportParams),this.updateBGColor(),this.$el.css({opacity:0}),this.$el.find(".picture").css({"background-image":this.picUrl?'url("'+this.picUrl+'")':"",opacity:this.model.get("opacity")});var e=this.workspace!=RM.constructorRouter.workspace?0:1;this.$el.animate({opacity:e},(function(){t.remove()}))}},removePicture:function(){this.model.set("picture",null),this.model.save({},{silent:!0,toHistory:!0}),this.$picture.stop().css("background-image","")},preload:function(){this.preloaded||(this.preloaded=!0,this.loadPic({success:D.a.bind((function(){"picture"===this.model.get("selectedType")&&D.a.delay(this.showPic,1e3)}),this)}))},onScroll:function(){if(!Modernizr.mac||!Modernizr.webkit)return!0;var t=this.$picture;t.removeClass("smooth3d"),clearTimeout(this._remove3dTimeout),this._remove3dTimeout=setTimeout((function(){t.addClass("smooth3d")}),1e3)},setTempPicture:function(t){t&&t.content&&this.loadPic({url:t.content,success:this.renewPic})}},{getViewportDefaults:function(t,e,i){var n=c.a.getViewportDefaults(t,e,i);return"video"===t.get("selectedType")&&(n=D.a.extend(n,{selectedType:"color"})),n},defaults:{slideshow:null}}),kt=i("rgKy"),St=i.n(kt),xt=i("a/+O"),Ct=i.n(xt),Ot=i("TBxE");function jt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Pt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?jt(Object(i),!0).forEach((function(e){Et(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):jt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Et(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var It=Pt(Pt({},Ct.a),St.a),Tt=vt.extend({name:"Picture",sort_index:2,thumb:"picture",icon_color:"#009274",proportional:!0,dontSaveOnResize:!0,tempPicture:null,$preloader:null,initial_controls:["picture_settings","picture_fwpos","picture_crop","common_animation","picture_link","picture_preview","common_rotation","common_position","common_layer","picture_alt","common_lock"],animated_controls:["picture_settings","picture_fwpos","picture_link","picture_preview","common_animation","common_rotation","common_position","common_layer","picture_alt","common_lock"],vector_controls:["picture_settings",Object(d.a)("constructor.newColorpicker")?"picture_color_new":"picture_color","picture_link","picture_preview","common_animation","common_rotation","common_position","common_layer","picture_alt","common_lock"],commonControls:["picture_preview"],commonControlsPositions:[4],viewport_fields:m.b.viewport_fields.picture,initialize:function(t,e){this.initBlock(t,e),this._imgsPreload=[],this._actualPreload=[],this.frameClass=Mt,this._css=function(t){return parseInt(this.css(t),10)},this.setControls(),this.picloaded={},this.setScaledImage.__debounced=D.a.debounce(this.setScaledImage,500),this.setFinal.__debounced=D.a.debounce(this.setFinal,1e3),this.model.skipResponse=!0,this.listenTo(e,"workspace-resize",this.onWorkspaceResizePicture)},initVector:function(){this.setControls(),this.updateControls(),this.loadVector({setColor:!0})},updatePicture:function(t){var e,i=this.isFullWidth()||this.isFullHeight();if((t=t||{}).load||(t.load="finalUrl"),Modernizr.retina&&"finalUrl"===t.load&&(t.load="final2xUrl"),i&&(t.load="unscaledUrl"),!this.cropmode&&RM.constructorRouter.zoom.getZoom()>1&&(t.load="unscaledUrl"),(this.isVector()||this.isAnimated())&&(t.load="editedVectorUrl",this.model.get("picture")[t.load]||(t.load="url")),this.useLambdaUrl()&&(t.load="lambdaUrl"),this.cropmode||this.fakingMode||this.fwposmode||this.changeControls({viewportChange:t.viewportChange}),this.useLambdaUrl()?e=this.cropmode||this.in_constrained_crop_mode?this.getOriginalLambdaUrl():this.getLambdaUrl():(e=this.model.get("picture")&&this.model.get("picture")[t.load],i&&!e&&(e=this.model.get("picture")&&this.model.get("picture").url)),!e&&!this.model.get("picture"))return this.$picture&&this.$picture.remove(),this.model.get("hiddenBeforeUpload")?(this.$el.addClass("hidden"),this.model.unset("hiddenBeforeUpload",{skipHistory:!0,silent:!0})):this.$el.addClass("empty"),void this.has_parent_block;if(t.renewRatio)D.a.defer(function(){this.fixSize(t)}.bind(this));else if(!this.model.get("picture")||e||(e=this.model.get("picture").unscaledUrl||this.model.get("picture").url)){var n=this,o=this.$content;this.$el.removeClass("empty"),this.$el.removeClass("hidden"),t.skipAnimation&&o.children().remove(),this._preload(t.load,(function(i){if(i&&(n.isVector||!n.cropmode&&!n.in_constrained_crop_mode||"url"===t.load)&&!(n.fakingMode||n.useLambdaUrl()&&e!==n._actualPreload.lambdaUrl)){var a=function(){n.$picture=i,t.complete&&t.complete.call(),i.css({opacity:1}),o.children().not(":last").remove(),n.updateSettings()};if(o.children().stop(!1,!0).css({opacity:1}),t.prepare&&t.prepare(i),n.$picture&&!t.skipAnimation&&i.css("opacity",0),n.isVector()){var r=document.importNode(i.get(0),!0),s=Object(l.a)('<div class="svg-scale-wrapper"></div>');s.append(r),o.append(s),n.$svg=Object(l.a)(r),i=n.$svg}else i.appendTo(o);this.cropmode||o.css("border-radius",""),n.unsetTempPicture(),n.updateSettings(i),n.$picture&&!t.skipAnimation?i.animate({opacity:1},200,a):a(),n.hideIconLoader(),t.toggledHidden||n.cropmode||D.a.defer(D.a.bind((function(){RM.constructorRouter.workspace.hideLoader()}),n))}}))}},render:function(){this.create(),this.$el.addClass("picture"),this.proportional=!!this.getPictureUrl(),this.useLambdaUrl()&&((this.model.get("border_radius")||this.model.get("border_radius_max")||this.model.get("border_radius_independent"))&&this.$content.css("border-radius",this.getBorderRadius()),Object(l.a)("<div/>").addClass("lqip").css({"background-image":"url(".concat(this.getLqipUrl(),")"),opacity:void 0===this.model.get("opacity")?1:this.model.get("opacity")}).appendTo(this.$content));var t=this.model.changed&&!1===this.model.changed.hidden;!this.has_parent_block&&this.updatePicture({isNew:this.model.created,isFirst:!0,toggledHidden:t,renewRatio:!this.model.get("ratio")}),this.$el.off("dblclick"),this.$el.on("dblclick",this.onDblClick),this.triggerReady(),t||(this.frame.recalcPointsDirections(),this.updateSettings(),this.has_parent_block&&(this.init_file_uploading(),this.enter_constrained_crop_mode()))},init_file_uploading:function(){var t,e;this.has_parent_block?this.$upload_input=this.workspace.$picture_upload_input:(t=It["template-constructor-helpers-upload-input"],this.$upload_input=Object(l.a)(t())),e=It["template-constructor-helpers-upload-button"],this.$upload_button=Object(l.a)(e()),this.uploader=new Ot.a(this,{fileInput:this.$upload_input}),this.bindUploader(this.uploader),this.$upload_button.on("click",function(){this.$upload_input.trigger("click","stop")}.bind(this)),this.model.on("change:picture",this.toggle_loaded),this.$upload_input.add(this.$upload_button).appendTo(this.$el)},bindUploader:function(t){t.on("start",this.on_start_upload),t.on("done",this.on_done_upload),t.on("fail",this.on_fail_upload)},on_start_upload:function(t,e){this.showIconLoader(),this.originalLoaded=!1,this.workspace.trigger("loading_original_picture")},on_done_upload:function(t,e){e&&e.result?this.changePicture(e.result,{toHistory:this.model.get("picture")}):console.error("error file upload!")},on_fail_upload:function(){this.hideIconLoader()},toggle_loaded:function(){this.model.get("picture")&&(this.isNew=!1),this.model.get("picture")&&(this.$upload_button.removeClass("uploading"),this.in_constrained_crop_mode=!1,this.enter_constrained_crop_mode())},getIconData:function(){return this.isVector()?this:null},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i="./constructor/widgetbar/icons/";this.icon_color&&(e["background-color"]=this.icon_color);var n="";return this.model.get("picture")?(this.isVector()||(n=this.useLambdaUrl()?this.getThumbnailUrl():this.model.get("picture").thumbUrl,e["background-size"]="cover"),t.small||(e["border-radius"]="8px")):n=Object(at.findImagePath)(i+"picture.svg"),e["background-image"]="url(".concat(n,")"),e},controlsIconClasses:function(){return{"panel-picture-alt":this.model.get("alt")?"highlighted":null}},enterCropMode:function(){if(!this.cropmode&&this.model.get("picture"))if(this.$content.css({"border-radius":this.getBorderRadius()}),this.in_constrained_crop_mode){if(!this.originalLoaded)return;this._beforeCropAttrs=D.a.clone(this.model.attributes),this.cropmode=!0,this.disableDragging=!0,this.$el.addClass("crop"),L.a.setEmptyHandlers(),Object(l.a)("#main").css("overflow-y","hidden"),this._modeTransition=!1;var t=this.workspace.get_box_data();this.initialCrop={left:t.left_abs+parseInt(this.$el.css("left"))-Math.round(this.model.get("cropX")*this.model.get("scale")),top:t.top_abs+parseInt(this.$el.css("top"))-Math.round(this.model.get("cropY")*this.model.get("scale"))};var e=D.a.clone(this.$picture);e.css({width:Math.round(this.model.get("originalW")*this.model.get("scale")),height:Math.round(this.model.get("originalH")*this.model.get("scale")),top:-Math.round(this.model.get("cropY")*this.model.get("scale")),left:-Math.round(this.model.get("cropX")*this.model.get("scale"))}),this.frame.constraints={top:this.initialCrop.top,left:this.initialCrop.left,width:Math.round(this.model.get("originalW")*this.model.get("scale")),height:Math.round(this.model.get("originalH")*this.model.get("scale"))},this.showBackPic(e),this.bindPictureDrag(),this.trigger("modechanged transitionmode",this.cropmode,this._modeTransition)}else this.storeFixedPosition(),this._beforeCropAttrs=D.a.clone(this.model.attributes),this._getFinalRequest&&this._getFinalRequest.abort(),this.transitionMode(!0),this.frame.removeRotationState(),this.frame.resetRotation(),this.updatePicture({load:"url",prepare:D.a.bind((function(t){this.initialCrop={top:parseInt(this.$el.css("top"))-Math.round(this.model.get("cropY")*this.model.get("scale")),left:parseInt(this.$el.css("left"))-Math.round(this.model.get("cropX")*this.model.get("scale"))},t.css({width:Math.round(this.model.get("originalW")*this.model.get("scale")),height:Math.round(this.model.get("originalH")*this.model.get("scale")),top:-Math.round(this.model.get("cropY")*this.model.get("scale")),left:-Math.round(this.model.get("cropX")*this.model.get("scale"))}),this.showBackPic(t)}),this),complete:D.a.bind((function(){this.frame.enableMouseProceeding(),this.proportional=!1,this.isLocked()&&this.$el.removeClass("no-drag"),this.bindPictureDrag(),this.frame.setConstraints(this.$backpic),this.originalLoaded=!0,this._modeTransition=!1,this.trigger("modechanged transitionmode",this.cropmode,this._modeTransition)}),this)})},enter_constrained_crop_mode:function(){!this.in_constrained_crop_mode&&this.model.get("picture")&&(this.in_constrained_crop_mode=!0,this.proportional=!1,this.originalLoaded=!1,this.workspace.trigger("loading_original_picture"),this.$upload_button.addClass("uploading"),this.updatePicture({load:"url",skipAnimation:!0,prepare:function(t){var e=this.workspace.get_box_data();this.initialCrop={left:e.left_abs+parseInt(this.$el.css("left"))-Math.round(this.model.get("cropX")*this.model.get("scale")),top:e.top_abs+parseInt(this.$el.css("top"))-Math.round(this.model.get("cropY")*this.model.get("scale"))},t.css({width:Math.round(this.model.get("originalW")*this.model.get("scale")),height:Math.round(this.model.get("originalH")*this.model.get("scale")),top:-Math.round(this.model.get("cropY")*this.model.get("scale")),left:-Math.round(this.model.get("cropX")*this.model.get("scale"))}),this.frame.constraints={top:this.initialCrop.top,left:this.initialCrop.left,width:Math.round(this.model.get("originalW")*this.model.get("scale")),height:Math.round(this.model.get("originalH")*this.model.get("scale"))}}.bind(this),complete:function(){this.originalLoaded=!0,this.workspace.trigger("loading_original_picture"),this.$upload_button.removeClass("uploading")}.bind(this)}))},leaveCropMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.noSave,i=t.viewportChange;if(this.hideBackPic(),this.cropmode&&this.model.get("picture"))if(this.$content.css({"border-radius":""}),this.in_constrained_crop_mode)this.leave_crop_mode_to_constrained_crop_mode(e);else{this.isLocked()&&this.$el.addClass("no-drag"),this.unbindPictureDrag(),this.disableDragging=!1,this.proportional=!0,this.frame.constraints=null,this.transitionMode(!1),this.frame.restoreRotation();var n={top:this.$picture.position().top,left:this.$picture.position().left,width:this.$picture.width(),height:this.$picture.height()};if(this.$picture.css({width:"100%",height:"100%",left:0,top:0,"background-size":n.width+"px "+n.height+"px","background-position":n.left+"px "+n.top+"px"}),this.restoreFixedPosition(!0),e)this.onLeavingCropMode();else{var o=this;if(this.ratio=this.model.get("cropW")/this.model.get("cropH"),D.a.isEqual(this._beforeCropAttrs,this.model.attributes))return void this.updatePicture({complete:D.a.bind((function(){this.onLeavingCropMode()}),this)});this.getFinalImage((function(){i&&o.useLambdaUrl()?o.onLeavingCropMode():o.updatePicture({complete:o.onLeavingCropMode})}))}}},leave_crop_mode_to_constrained_crop_mode:function(t){this.unbindPictureDrag(),this._modeTransition=!1,this.disableDragging=!0,this.cropmode=!1,this.trigger("modechanged transitionmode",this.cropmode,this._modeTransition),L.a.removeCustomHandlers(),Object(l.a)("#main").css("overflow-y","auto"),this.$el.removeClass("crop"),this.hideBackPic(),t||(this.ratio=this.model.get("cropW")/this.model.get("cropH"),this.isAnimated()||this.useLambdaUrl()?this.model.save({},{silent:!0,skipHistory:!0}):this.getFinalImage((function(t){t&&console.log("w-picture getFinalImage error: ",t)}),{silent:!0,skipHistory:!0}))},onLeavingCropMode:function(){this.$picture.css({width:"100%",height:"100%",left:0,top:0}),this._modeTransition=!1,this._waitingForRescale&&(this._waitingForRescale=!1,this.setScaledImage())},onLeavingCropResize:function(t){if(!this.cropmode){var e=t.width/this.model.get("cropW");this.$picture.css({left:-this.model.get("cropX")*e,top:-this.model.get("cropY")*e,width:this.model.get("originalW")*e,height:this.model.get("originalH")*e})}},toggleCropMode:function(){this.isVector()||this.trigger("crop_click")},toggleFWPosMode:function(){this.isVector()||this.trigger("fwpos_click")},onDblClick:function(){var t=this.model.get("is_full_width")||this.model.get("is_full_height");t?this.toggleFWPosMode():this.toggleCropMode(),c.a.prototype.onDblClick.apply(this,arguments)},enterFWPosMode:function(){!this.fwposmode&&this.model.get("picture")&&(this.disableDragging=!0,this.fwposmode=!0,this.$el.addClass("fwpos"),this.$el.on("dragend",this.dragFWPosPictureStop),this.$el.on("dragstart",this.dragFWPosPictureStart),this.$el.on("drag",this.dragFWPosPicture))},leaveFWPosMode:function(){this.fwposmode&&this.model.get("picture")&&(this.disableDragging=!1,this.fwposmode=!1,this.$el.removeClass("fwpos"),this.$el.off("dragend",this.dragFWPosPictureStop),this.$el.off("dragstart",this.dragFWPosPictureStart),this.$el.off("drag",this.dragFWPosPicture))},dragFWPosPictureStart:function(t,e){var i=this.model.get("is_full_height"),n=this.model.get("is_full_width");this.frame.disableMouseProceeding(),this.$el.addClass("grabbing"),n&&(e.prev_offsetY=e.offsetY),i&&(e.prev_offsetX=e.offsetX)},dragFWPosPicture:function(t,e){var i=this.model.get("is_full_height"),n=this.model.get("is_full_width"),o=this.model.get("fwpos"),a=this.model.get("fhpos");n&&void 0===e.prev_offsetY&&this.dragFWPosPictureStart(t,e),i&&void 0===e.prev_offsetX&&this.dragFWPosPictureStart(t,e),n&&(o=null==o?50:o,o-=(e.offsetY-e.prev_offsetY)/5,o=Math.min(Math.max(o,0),100),this.model.set({fwpos:o}),e.prev_offsetY=e.offsetY,e.last_fwpos=o),i&&(a=null==a?50:a,a-=(e.offsetX-e.prev_offsetX)/5,a=Math.min(Math.max(a,0),100),this.model.set({fhpos:a}),e.prev_offsetX=e.offsetX,e.last_fhpos=a)},dragFWPosPictureStop:function(t,e){var i=this.model.get("is_full_height"),n=this.model.get("is_full_width");this.frame.enableMouseProceeding(),n&&null!=e.last_fwpos&&this.model.save({fwpos:e.last_fwpos}),i&&null!=e.last_fhpos&&this.model.save({fhpos:e.last_fhpos}),this.$el.removeClass("grabbing")},transitionMode:function(t){this._modeTransition=!0,this.disableDragging=t,this.cropmode=t,this.trigger("modechanged transitionmode",this.cropmode,this._modeTransition),t?(this._scaledimageXHR&&this._scaledimageXHR.abort(),this.frame.disableMouseProceeding(),this.$el.addClass("crop"),this.model.off("change",this.onModelChange),L.a.setEmptyHandlers(),Object(l.a)("#main").css("overflow-y","hidden")):(this.$el.removeClass("crop"),this.model.on("change",this.onModelChange),L.a.removeCustomHandlers(),Object(l.a)("#main").css("overflow-y","auto"))},onCropResize:function(t){if((this.cropmode||this.in_constrained_crop_mode)&&!this._modeTransition){var e,i=this.initialCrop;if(this.in_constrained_crop_mode){var n=this.workspace.get_box_data();e={left:n.left_abs+t.left-i.left,top:n.top_abs+t.top-i.top}}else e={left:t.left-i.left,top:t.top-i.top};this.$picture.css({left:-e.left,top:-e.top});var o=this.model.get("scale"),a=function(t){return t/o},r=Math.max(0,Math.round(a(e.left))),s=Math.max(0,Math.round(a(e.top))),l=this.fixCropDimensions(r,Math.round(a(t.width)),this.model.get("originalW")),c=this.fixCropDimensions(s,Math.round(a(t.height)),this.model.get("originalH"));this.model.set({cropX:r,cropY:s,cropW:l,cropH:c,ratio:(t.width/t.height).toFixed(5)})}},showBackPic:function(t){this.hideBackPic(),t=t||this.$picture,this.$backpic=t.clone().css({position:"absolute",opacity:.5,"z-index":(this.$content.css("z-index")||this.model.get("z"))-1}).css(this.initialCrop).addClass("backpic").hide().appendTo(this.workspace.$origin).fadeIn(200),this.$backpic.on("dblclick",this.toggleCropMode)},hideBackPic:function(){this.workspace.$(".backpic").animate({opacity:0},200,(function(){Object(l.a)(this).remove()}))},bindPictureDrag:function(){this.$el.add(this.$backpic).on("dragend",this.dragCropPictureStop),this.$el.add(this.$backpic).on("dragstart",this.dragCropPictureStart),this.$el.add(this.$backpic).on("drag",this.dragCropPicture)},unbindPictureDrag:function(){this.$el.add(this.$backpic).off("dragend",this.dragCropPictureStop),this.$el.add(this.$backpic).off("dragstart",this.dragCropPictureStart),this.$el.add(this.$backpic).off("drag",this.dragCropPicture)},dragCropPictureStart:function(t,e){var i=D.a.bind(this._css,this.$el),n=D.a.bind(this._css,this.$backpic);if(e.offset={back:{top:n("top"),left:n("left"),width:n("width"),height:n("height")},el:{top:i("top"),left:i("left"),width:i("width"),height:i("height")}},this.has_parent_block){var o=this.workspace.get_box_data();e.offset.el.top+=o.top_abs,e.offset.el.left+=o.left_abs}this.frame.disableMouseProceeding(),this.$el.add(this.$backpic).addClass("grabbing")},dragCropPicture:function(t,e){e.offset||this.dragCropPictureStart(t,e);var i={top:e.offset.back.top+e.deltaY,left:e.offset.back.left+e.deltaX};i.top>e.offset.el.top&&(i.top=e.offset.el.top),i.left>e.offset.el.left&&(i.left=e.offset.el.left),i.left+e.offset.back.width<e.offset.el.left+e.offset.el.width&&(i.left=e.offset.el.left+e.offset.el.width-e.offset.back.width),i.top+e.offset.back.height<e.offset.el.top+e.offset.el.height&&(i.top=e.offset.el.top+e.offset.el.height-e.offset.back.height),this.$backpic.css({top:i.top,left:i.left}),this.$picture.css({top:i.top-e.offset.el.top,left:i.left-e.offset.el.left})},dragCropPictureStop:function(t,e){this.initialCrop={top:parseInt(this.$backpic.css("top")),left:parseInt(this.$backpic.css("left"))},this.frame.enableMouseProceeding(),this.frame.setConstraints(this.$backpic);var i=D.a.bind(this._css,this.$picture),n=parseFloat(this.model.get("scale"),10),o=Math.max(0,Math.round(-i("left")/n)),a=Math.max(0,Math.round(-i("top")/n)),r=this.fixCropDimensions(o,this.model.get("cropW"),this.model.get("originalW")),s=this.fixCropDimensions(a,this.model.get("cropH"),this.model.get("originalH"));this.model.set({cropX:o,cropY:a,cropW:r,cropH:s}),this.$el.add(this.$backpic).removeClass("grabbing")},fixCropDimensions:function(t,e,i){var n=t+e-i;return n>0?e-n:e},setActualScale:function(t){this.storeFixedPosition();var e=(t=t||{}).retina?2:1;this._preload("url",D.a.bind((function(t){var i={picture:this.model.get("picture")},n={x:parseInt(this.$el.css("left"))+this.model.get("w")/2-this.model.get("originalW")/2/e,y:parseInt(this.$el.css("top"))+this.model.get("h")/2-this.model.get("originalH")/2/e,w:this.model.get("originalW")/e,h:this.model.get("originalH")/e},o=0,a=0;i.picture.finalUrl=this.model.get("picture").url,i.picture.final2xUrl=i.picture.finalUrl,i.picture.unscaledUrl=i.picture.finalUrl;var r={};r.w=this.model.get("originalW"),r.h=this.model.get("originalH");var s=this.$picture.parent();this.updateSettings(t),t.css({opacity:0}).appendTo(s).animate({opacity:1},200,D.a.bind((function(){this.$picture=t,s.children().not(":last").remove(),this.updateSettings()}),this)),this.$el.animate({top:n.y,left:n.x,width:n.w,height:n.h},D.a.bind((function(){this.model.set(D.a.extend({cropX:o,cropY:a,cropW:n.w*e,cropH:n.h*e,scale:1/e,ratio:n.w/n.h},n,i)),this.restoreFixedPosition(),this.model.save()}),this))}),this))},rescale:function(t,e){e=e||{};var i=D.a.bind(this._css,this.$el),n=e.smooth?"animate":"css",o=this.model.get("originalW")*t,a=this.model.get("originalH")*t;o<i("width")&&(t=(o=i("width"))/this.model.get("originalW"),a=this.model.get("originalH")*t),a<i("height")&&(t=(a=i("height"))/this.model.get("originalH"),o=this.model.get("originalW")*t);var r,s,l=i("width")/2,c=i("height")/2,d=this.model.get("scale"),h=(this.model.get("cropX")*d+l)*t/d-l,u=(this.model.get("cropY")*d+c)*t/d-c;if(h+2*l>o&&(h=o-2*l),h<0&&(h=0),u+2*c>a&&(u=a-2*c),u<0&&(u=0),this.in_constrained_crop_mode){var p=this.workspace.get_box_data();r=p.left_abs+i("left")-h,s=p.top_abs+i("top")-u}else r=i("left")-h,s=i("top")-u;this.$backpic[n]({left:r,top:s,width:o,height:a}),this.initialCrop={left:r,top:s},this.$picture[n]({left:-h,top:-u,width:o,height:a});var m=Math.max(0,Math.round(h/t)),g=Math.max(0,Math.round(u/t)),f=this.fixCropDimensions(m,Math.round(this.model.get("w")/t),this.model.get("originalW")),v=this.fixCropDimensions(g,Math.round(this.model.get("h")/t),this.model.get("originalH"));this.model.set({scale:t,cropX:m,cropY:g,cropW:f,cropH:v},e),this.frame.setConstraints(this.$backpic)},fill:function(){if(this.cropmode&&!this._modeTransition){var t=parseInt(this.$el.css("left")),e=parseInt(this.$el.css("top")),i=parseInt(this.$el.height()),n=parseInt(this.$el.width()),o={},a=null,r={},s=this.model.get("originalW")/this.model.get("originalH");this.model.get("ratio")>s?(a=n/this.model.get("originalW"),o={cropX:0,cropY:Math.round((this.model.get("originalH")-i/a)/2),cropW:this.model.get("originalW"),cropH:Math.round(i/a)},r={width:n,height:Math.round(n/s),top:-Math.round(o.cropY*a),left:0}):(a=i/this.model.get("originalH"),o={cropX:Math.round((this.model.get("originalW")-n/a)/2),cropY:0,cropW:Math.round(n/a),cropH:this.model.get("originalH")},r={width:Math.round(i*s),height:i,top:0,left:-Math.round(o.cropX*a)}),this.model.set(D.a.extend({x:t,y:e,w:n,h:i,scale:a},o)),this.redrawPosition(this.model,{forceRedraw:!1}),this.$picture.animate(r),this.$backpic.animate({width:r.width,height:r.height,top:e+r.top,left:t+r.left},D.a.bind((function(){var t=D.a.bind(this._css,this.$backpic);this.initialCrop={top:t("top"),left:t("left")},this.frame.setConstraints(this.$backpic)}),this))}},fit:function(){if(this.cropmode&&!this._modeTransition){var t=parseInt(this.$el.css("left")),e=parseInt(this.$el.css("top")),i=parseInt(this.$el.height()),n=parseInt(this.$el.width()),o={cropX:0,cropY:0,cropW:this.model.get("originalW"),cropH:this.model.get("originalH")},a={left:t,top:e,width:n,height:i},r=null,s={},l=this.model.get("originalW")/this.model.get("originalH");this.model.get("ratio")<l?(r=n/this.model.get("originalW"),s={width:n,height:Math.round(n/l),top:Math.round((i-n/l)/2),left:0},a.top=e+s.top,a.height=s.height):(r=i/this.model.get("originalH"),s={width:Math.round(i*l),height:i,top:0,left:Math.round((n-i*l)/2)},a.left=t+s.left,a.width=s.width),this.$picture.animate(s),this.$backpic.animate({width:s.width,height:s.height,top:e+s.top,left:t+s.left},D.a.bind((function(){var t=D.a.bind(this._css,this.$backpic);this.initialCrop={top:t("top"),left:t("left")},this.$el.css(a),this.$picture.css({top:0,left:0}),this.model.set(D.a.extend({x:a.left,y:a.top,w:a.width,h:a.height,ratio:l,scale:r},o)),this.frame.setConstraints(this.$backpic)}),this))}},setControls:function(){this.isVector()?this.controls=this.vector_controls:this.isAnimated()?this.controls=this.animated_controls:this.controls=this.initial_controls},changePicWithoutRescale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={originalW:t.size.width,originalH:t.size.height};if(t.picture&&(i.picture=t.picture),this.model.set(i,{silent:!0}),this.trigger("picture_added"),e.first=!0,this.fixSize(e),D.a.each(m.b.viewport_list,(function(t){D.a.isEmpty(this.model.get(t))&&D.a.isEmpty(this.model[t])||this.model.set(i,{viewport:t.split("viewport_")[1],silent:!0})}),this),this.has_parent_block){this.model.save();var n={};n.tip_w=this.workspace.block.model.get("tip_w"),n.tip_h=this.workspace.block.model.get("tip_h"),this.workspace.block.model.save(n,{patch:!0,skipHistory:!0}),this.workspace.blocks.forEach((function(t){t.saveBox({patch:!0,skipHistory:!0})}))}},setTempPicture:function(t){this.$el.removeClass("hidden");var e=this.$el.find(".content");if(t&&t.content&&e){this.$el.removeClass("empty"),this.proportional=!0,this.tempPicture={$el:Object(l.a)("<div>").css({"background-image":'url("'.concat(t.content,'")'),"background-position":"50% 50%"}).appendTo(e),type:t.ext},this.model.get("picture")&&(e.children().not(":last").remove(),this.$picture&&this.$picture.remove(),this.$picture=null,this.model.unset("picture",{skipHistory:!0,silent:!0}));var i={size:{width:t.width,height:t.height}};this.changePicWithoutRescale(i),this.showTempPreloader(),this.changeControls()}},unsetTempPicture:function(){this.tempPicture&&this.tempPicture.$el&&this.tempPicture.$el.remove(),this.tempPicture=null},removeTempPicture:function(){this.unsetTempPicture(),this.$picture&&this.$picture.remove(),this.$content.children().remove(),this.$el.addClass("empty"),this.$el.removeClass("hidden"),this.hideTempPreloader(),this.removePicture(),this.changeControls()},showTempPreloader:function(){this.$preloader||(this.$preloader=Object(l.a)("<div/>",{class:"rmpreloader",html:Object(l.a)("<div/>",{class:"arc"})}),this.$el.addClass("preloader"),this.$preloader.appendTo(this.$el))},hideTempPreloader:function(){this.$preloader&&!this.preloaderTimeout&&(this.$el.removeClass("preloader"),this.$preloader.css("opacity",0),this.preloaderTimeout=setTimeout(function(){this.$preloader.remove(),this.$preloader=null,this.preloaderTimeout=null}.bind(this),200))},changePicture:function(t,e){var i=this.model.attributes,n=this.model.getViewport(),o=this.isFullWidth(),a=this.isFullHeight();if(e=D.a.extend(e||{},{isNew:!0}),t.picture&&this.hideTempPreloader(),!i.picture&&!i.scale||!this.has_parent_block&&"gif"===t.picture.type)return this.changePicWithoutRescale(t,e);var r=this,s=function(e){var i,n,s;return e.ratio=e.ratio||e.w/e.h,o?(i=e.full_width_initial_w,n=e.full_width_initial_w/e.ratio):a?(n=e.full_height_initial_h,i=e.full_height_initial_h*e.ratio):(i=e.w,n=e.h),s={originalW:t.size.width,originalH:t.size.height,w:i,h:n,ratio:e.ratio,x:e.x,y:e.y},t.size.width/t.size.height>parseFloat(e.ratio)?(s.scale=s.h/s.originalH,s.cropY=0,s.cropH=s.originalH,s.cropX=Math.max(0,(s.originalW-s.w/s.scale)/2),s.cropW=s.w/s.scale):t.size.width/t.size.height<parseFloat(e.ratio)?(s.scale=s.w/s.originalW,s.cropX=0,s.cropY=Math.max(0,(s.originalH-s.h/s.scale)/2),s.cropW=s.originalW,s.cropH=s.h/s.scale):(s.scale=s.w/s.originalW,s.cropX=0,s.cropY=0,s.cropW=s.originalW,s.cropH=s.originalH),s.picture=D.a.clone(t.picture),r.isVector(t.picture.url,t.picture.type)||(s.picture.unscaledUrl=t.picture.coalesceUrl||t.picture.url),s},l=s(i);this.model.set(l,{silent:!0,toHistory:e.toHistory}),this.isVector(l.picture.url,l.picture.type)&&(this.model.set({pic_color:"",pic_opacity:1},{silent:!0}),this.fixSize()),this.isAnimated()?(this.model.save({},e),this.model.trigger("change:picture")):(e.viewport=n,this.getFinalImage(D.a.bind((function(){this.updatePicture.apply(this,arguments);var t=[],e=!1,i=this.model,o=function(o){(t[o]=!0,D.a.all(t)&&e)&&(i.save({},{skipHistory:!0,first:!0}),this.model.getViewport()!==n&&this.updatePicture())}.bind(this),a=D.a.without(D.a.union(yt.default.viewports,["viewport_default"]),"viewport_"+this.model.getViewport());D.a.each(a,(function(e,i){return t[i]=!1})),D.a.each(a,(function(i,n){if(t[n]=!1,D.a.isEmpty(this.model[i]))return o(n);var a=s(D.a.extend({},this.model.attributes,this.model[i]));if(this.useLambdaUrl()||this.isVector(l.picture.url,l.picture.type)){if("viewport_default"!==i&&"default"===this.model.getViewport()){var r=this.model.get("picture");r&&D.a.extend(a.picture,r)}this.model.set(a,{viewport:i.split("viewport_")[1],silent:!0}),e=!0,o(n)}else this.requestFinalImage(D.a.extend({},this.model.attributes,a),D.a.bind((function(t){D.a.extend(a.picture,t),this.model.set(a,{viewport:i.split("viewport_")[1],silent:!0}),e=!0,o(n)}),this))}),this)}),this),e))},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t,e)){this.proportional=!!this.getPictureUrl()||this.tempPicture;var i=t.hasChanged("is_full_width")&&t.get("is_full_width")&&!e.viewportChange,n=t.hasChanged("is_full_width")&&!t.get("is_full_width")&&!e.viewportChange,o=t.hasChanged("is_full_height")&&t.get("is_full_height")&&!e.viewportChange,a=t.hasChanged("is_full_height")&&!t.get("is_full_height")&&!e.viewportChange,r=function(){n&&this.model.set({h:this.model.get("w")/this.model.get("ratio")},{silent:!!i}),a&&this.model.set({w:this.model.get("h")*this.model.get("ratio")},{silent:!!o})}.bind(this);this.isDragging||this.isScaling||(this.redrawPosition(t,D.a.extend(e,{forceRedraw:!1})),(i||n||o||a)&&(r(),this.updatePicture(),this.changeControls()),(n||a)&&this.setScaledImage(null,{skipHistory:!0})),t.hasChanged("picture")||t.hasChanged("cropX")||t.hasChanged("cropY")||t.hasChanged("cropW")||t.hasChanged("cropH")?e.undo||e.redo?this.onHistoryPictureChange(t,e):e.viewportChange||e.socketUpdate?(this.hideBackPic(),this.updatePicture({skipAnimation:!0,viewportChange:!0})):(this.onPictureChange(t,e),this.isVector()&&this.initVector()):this.has_parent_block&&(e.undo||e.redo)?(this.in_constrained_crop_mode=!1,this.enter_constrained_crop_mode()):e.viewportChange&&this.useLambdaUrl()&&this.updatePicture({skipAnimation:!0,viewportChange:!0}),this.ratio=t.get("ratio")}},redrawPosition:function(t,e){t=t||this.model,vt.prototype.redrawPosition.apply(this,arguments),(t.hasChanged("border_size")||t.hasChanged("border_color")||t.hasChanged("border_radius")||t.hasChanged("border_radius_max")||t.hasChanged("border_radius_tl")||t.hasChanged("border_radius_tr")||t.hasChanged("border_radius_bl")||t.hasChanged("border_radius_br")||t.hasChanged("border_radius_independent")||t.hasChanged("opacity")||t.hasChanged("fwpos")||t.hasChanged("fhpos"))&&this.updateSettings()},setPreviewImage:function(t,e){var i=(e=e||{}).success||l.a.noop,n=e.error||l.a.noop,o=this;if(this.previewUrl=t,this._loadingPic&&this._loadingPic.off("load").off("error").removeAttr("src").remove(),this._loadingPic=void 0,!t)return this.$preview&&this.$preview.detach(),void i();this._loadingPic=Object(l.a)("<img>").addClass("preload_image").appendTo("body").attr("src",t).on("load",(function(){o.previewUrl===t&&(o.$preview||(o.$preview=Object(l.a)("<div>")),o.$preview.css({"background-image":'url("'+t+'")',"background-size":"cover","background-position":"50% 50%"}).appendTo(o.$el.find(".content"))),i(),Object(l.a)(this).remove()})).on("error",(function(){n(),Object(l.a)(this).remove()}))},getBorderRadius:function(){return this.model.get("border_radius_independent")?"".concat(this.model.get("border_radius_tl")||0,"px ").concat(this.model.get("border_radius_tr")||0,"px ").concat(this.model.get("border_radius_bl")||0,"px ").concat(this.model.get("border_radius_br")||0,"px"):"".concat(this.model.get("border_radius_max")?"9999":this.model.get("border_radius")||0,"px")},updateSettings:function(t){if(t=t||this.$picture){var e=this.model,i=e.get("fwpos"),n=e.get("fhpos");i=void 0===i?50:i,n=void 0===n?50:n,this.isVector()?(t.css({"box-shadow":"none","border-radius":"0"}),this.$content.css("opacity",1)):(t.css({"box-shadow":e.get("border_size")>0?"inset 0 0 0 "+e.get("border_size")+"px #"+(e.get("border_color")||"000000"):"none","border-radius":this.getBorderRadius(),"background-position":n+"% "+i+"%","-webkit-mask-image":e.get("border_size")>0?"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)":""}),this.$content.css("opacity",void 0===e.get("opacity")?1:e.get("opacity")))}},onPictureChange:function(t,e){var i=this.model.previous("picture"),n=this.model.get("picture"),o=e&&e.isNew;(n&&i&&n.url!=i.url||o)&&this.model.set({pic_color:"",pic_opacity:1},{silent:!0})},onHistoryPictureChange:function(t,e){var i={},n=this.model.previous("picture"),o=this.model.get("picture");if(!o)return this.updatePicture();!n&&o&&this.trigger("picture_added"),this._modeTransition&&!this.cropmode&&(i.complete=this.onLeavingCropMode),this.has_parent_block?(this.in_constrained_crop_mode=!1,this.enter_constrained_crop_mode()):this.updatePicture(i)},setFinal:function(){this.fakingMode=!1,this.getFinalImage(this.updatePicture,{silent:!0})},changeControls:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.viewportChange;this.setControls(),this.updateControls({noSelect:e||this._deselectOnViewportChange}),this._deselectOnViewportChange=!1},_preload:function(t,e){var i=this.model.get("picture");if(i){var n,o=this;if(this.useLambdaUrl()?n=o.cropmode||o.in_constrained_crop_mode?this.getOriginalLambdaUrl():this.getLambdaUrl():(n=i[t])||"unscaledUrl"!==t||(n=i.unscaledOptimizedUrl||i.url),!n)return e&&e.apply(this);if(this.isVector())return this.loadVector({success:e});this._actualPreload[t]=n,this._imgsPreload[t]=Object(l.a)(new Image).attr({src:n}).one("load",(function(){if(o._imgsPreload[t]=!1,e){var i=Object(l.a)("<div/>").css("background-image","url("+n+")");if(!o.rendered)return;e.apply(o,[i,n])}Object(l.a)(this).remove()}))}},onResizeStart:function(t,e){this.cropmode||this.isVector()||(this._scaledimageXHR&&this._scaledimageXHR.abort(),this._modeTransition||(this._getFinalRequest&&this._getFinalRequest.abort(),!this.useLambdaUrl()&&!this.tempPicture&&this.updatePicture({load:"unscaledUrl"})),this.isScaling=!0)},onResizeEnd:function(t,e,i){this.isScaling=!1;var n=D.a.extend({scale:1},this.getBoxData());if(this.model.set(n,i),!this.getPictureUrl()||this.isVector())return this.saveBox();this.cropmode||(this._modeTransition?this._waitingForRescale=!0:this.setScaledImage(null,D.a.omit(i,"skipPersist")))},restoreFixedPosition:function(t){!t&&this.cropmode||vt.prototype.restoreFixedPosition.apply(this,arguments)},getBoxData:function(){var t=vt.prototype.getBoxData.apply(this,arguments);return this.model.get("cropW")?t.scale=(t.w/this.model.get("cropW")).toFixed(15):void 0!==t.scale&&(t.scale=1..toFixed(15)),t},setScaledImage:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=D.a.clone(this.model.attributes),n=function(t){if("default"!==this.model.getViewport()&&D.a.isEmpty(this.model.viewport_default.picture)){var e=D.a.cloneWithObjects(D.a.extend({},this.model.attributes,{picture:t}));e.hidden=this.model.viewport_default.hidden,this.model.storeViewport("default",e)}}.bind(this);if(!this.tempPicture||this.model.get("picture")){if(e.viewport=this.model.getViewport(),this.isVector()||this.isAnimated()||this.useLambdaUrl())return n(i.picture),this.model.save("picture",i.picture,e),this.updatePicture({complete:t});var o=this.model.get("w");this.showTempPreloader(),this._scaledimageXHR=l.a.ajax({type:"POST",data:i,url:this.RESCALE_URL,success:D.a.bind((function(i){if(this.hideTempPreloader(),o===this.model.get("w")){var a=D.a.extend({},this.model.get("picture"),i);a.url&&(n(a),this.model.save("picture",a,e),this.updatePicture({complete:t}))}}),this)})}},fixSize:function(t){if(this.model.get("originalW")){var e=parseInt(this.model.get("originalW"),10),i=parseInt(this.model.get("originalH"),10),n=this.model.get("w"),o=this.model.get("h"),a=n/e,r=o/i,s=n,l=o,c={x:this.model.get("x"),y:this.model.get("y")};this.has_parent_block?l=i*a:this.isVector()&&this.isFullWidth()?s=this.getFullWidthDims().w:this.isVector()&&this.isFullHeight()?l=this.getFullHeightDims().h:Math.abs(1-a)<.05&&Math.abs(1-r)<.05||a>1.05&&r>1.05?(s=e,l=i,c.x+=n/2-e/2,c.y+=o/2-i/2):a>r?(s=e*r,c.x+=n/2-s/2):(l=i*a,c.y+=o/2-l/2),this.model.set({w:s,h:l,x:c.x,y:c.y,ratio:e/i,scale:s/e,cropX:0,cropY:0,cropW:e,cropH:i},{first:t&&t.first}),this.setScaledImage(D.a.bind((function(){this.isVector()&&this.fixVectorScale()}),this),t),this.model.created=!1}},fixVectorScale:function(){var t,e=this.$svg.get(0).getBBox(),i=this.getBoxData(),n=e.width/e.height,o=i.w/i.h;Math.abs(n-o)<.05||(t=this.isFullWidth()?{h:i.w/n,originalW:this.model.get("full_width_initial_w"),originalH:this.model.get("full_width_initial_w")/n}:n>1?{h:i.h/n,originalH:i.h/n,ratio:n}:{w:i.w*n,originalW:i.w*n,ratio:n},this.model.save(t,{skipHistory:!0}))},showIconLoader:function(){this.has_parent_block?this.$upload_button.addClass("uploading"):c.a.prototype.showIconLoader.apply(this,arguments),this.showTempPreloader()},hideIconLoader:function(){this.has_parent_block?this.$upload_button.removeClass("uploading"):c.a.prototype.hideIconLoader.apply(this,arguments),this.hideTempPreloader()},deselect:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.deselectOnViewportChange&&(this._deselectOnViewportChange=!0),c.a.prototype.deselect.apply(this,arguments),this.leaveCropMode({viewportChange:this._deselectOnViewportChange}),this.leaveFWPosMode()},onWorkspaceBlocksSelect:function(t){c.a.prototype.onWorkspaceBlocksSelect.apply(this,arguments);var e=t&&1==t.length&&t[0]==this;e||(this.leaveCropMode(),this.leaveFWPosMode())},onWorkspaceResizePicture:function(){var t=this;this.rendered&&RM.constructorRouter.zoom.getZoom()>1&&!this.tempPicture&&!this.originalLoaded&&this.updatePicture({load:"unscaledUrl",complete:function(){return t.originalLoaded=!0}})},isPictureEmpty:function(){return D.a.isEmpty(this.model.get("picture"))&&!this.tempPicture},destroy:function(){this.uploader&&this.uploader.destroy(),this.leaveCropMode(),this.leaveFWPosMode(),c.a.prototype.destroy.apply(this,arguments),this.hideIconLoader(),this.model.off("change:picture",this.toggle_loaded),this.$upload_button&&this.$upload_button.off("click"),this.off(),this.$el.off()}}),Mt=b.a.extend({maxwidth:9999,maxheight:9999,onResize:function(t,e){var i=b.a.prototype.onResize.apply(this,arguments);this.block.cropmode?this.block.onCropResize(i):this.block._modeTransition&&this.block.onLeavingCropResize(i)},setConstraints:function(t){this.constraints={top:parseInt(t.css("top")),left:parseInt(t.css("left")),width:parseInt(t.css("width")),height:parseInt(t.css("height"))}}}),$t=Tt,At=i("tcpm"),Rt=i("rDYU"),Dt=i.n(Rt);function Bt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Lt={rasterize:function(t){var e;if(t&&t.widgets&&t.mid&&t.svg&&t.viewport&&t.size&&t.size.height&&t.size.width){var i,n=document.importNode(t.svg[0],!0),o=(new XMLSerializer).serializeToString(n),a="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(o))),r=(Bt(e={},t.prefix?t.prefix+"_rasterUrl":"rasterUrl",a),Bt(e,t.prefix?t.prefix+"_raster2xUrl":"raster2xUrl",a),Bt(e,t.prefix?t.prefix+"_raster3xUrl":"raster3xUrl",a),e);t.activeArrow?("left_arrow_noun"===t.activeArrow&&t.widgets.forEach((function(t){i=t.get("theme_data"),t.unset("left_arrow_noun",{skipHistory:!0,silent:!0,patch:!0}),t.save({theme_data:D.a.extend(i,{left_icon_noun:D.a.extend(i.left_icon_noun,r)})},{skipHistory:!0,silent:!0,patch:!0})})),"right_arrow_noun"===t.activeArrow&&t.widgets.forEach((function(t){i=t.get("theme_data"),t.unset("right_arrow_noun",{skipHistory:!0,silent:!0,patch:!0}),t.save({theme_data:D.a.extend(i,{right_icon_noun:D.a.extend(i.right_icon_noun,r)})},{skipHistory:!0,silent:!0,patch:!0})}))):t.widgets.forEach((function(t){t.save(r,{skipHistory:!0,silent:!0})}));var s={wids:t.widgets.map((function(t){return t.get("_id")})),svg:o,size:t.size,viewport:t.viewport,mid:t.mid,prefix:t.prefix,arrow:t.activeArrow};return l.a.ajax({url:"/api/images/rasterize",type:"POST",data:s,success:t.onSuccess,error:t.onError})}}},zt=vt.extend({name:"Slideshow",sort_index:6,thumb:"slideshow",icon_color:"#0052A8",initial_controls:["slideshow_settings","slideshow_transitions","slideshow_manager","text_typography","text_bius","text_color","common_animation","common_position","common_layer","common_lock"],viewport_fields:m.b.viewport_fields.slideshow,MIN_IMAGES_WIDTH:100,MIN_IMAGES_HEIGHT:100,MIN_CAPTIONS_HEIGHT:14,ARROW_NOUN_ICON_WIDTH:18,ARROW_NOUN_ICON_HEIGHT:18,DEFAULT_ARROWS_CONTAINER:{LEFT:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40"><path d="M23.5 11.5 L15.5 19.5 L23.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path></svg>',RIGHT:'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40"><path d="M16.5 11.5 L24.5 19.5 L16.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path></svg>'},MAX_ICON_CACHE_SIZE:30,params:{multipleName:"multiple values",tabIndent:28,fontSizeLineHeightRatio:1.25,minFontSize:8,maxFontSize:999,minLineHeight:10,maxLineHeight:999,minLetterSpacing:-99,maxLetterSpacing:999},initialize:function(t,e){this.initBlock(t,e),this.inner_template=Dt.a["template-constructor-block-slideshow"],this.cur_selection_styles={},this.cur_selection_styles_all={},this.queue=[],this.frameClass=Ft,this._imgsPreload=[],this.picloaded={},this.model.on("change:theme_data",this.onThemeParamsChange),this.currentIconsData={},this.workspace.on("main-dragover",this.highlightDropZone),this.model.skipResponse=!0,this.fillTextStyles(),this.workspace.on("deselect",this.showOverlay),this.workspace.on("deselect",this.setToDefaultArrows),this.workspace.on("select",this.hideOverlay),this.saveDebounced=D.a.debounce((function(){this.model.save()}),2e3),this.renderCorrectIconsDebounced=D.a.debounce(this.renderCorrectIcons,10)},render:function(){this.create(),Object(l.a)(this.inner_template(this.model.attributes)).appendTo(this.$content),this.$el.addClass("slideshow can-drop"),this.model.get("theme_data")&&(this.setControls(),this.slideshowPlayer=new At.a(D.a.clone(this.model.attributes),this.$content,"constructor",this,this.workspace&&this.workspace.mag),this.onThemeParamsChange(),this.uploader=new Ot.a(this,{fileInput:this.$(".uploadInput"),unique:!0}),this.bindUploader(this.uploader),this.on("changeStyleSpan",this.textStyleChanged),this.on("changeStyleParagraph",this.textStyleChanged),"default"!==this.model.get("theme_data").arrows_type&&this.renderCorrectIcons(),this.listenTo(this,"arrow_type_changed",this.renderCorrectIconsDebounced),this.listenTo(this,"captions_changed",this.onCaptionsStatusChange),this.triggerReady())},renderCorrectIcons:function(){var t,e,i=this.model.get("theme_data"),n=i.arrows_type;"default"===n?(t=i.controls_color,e=i.controls_opacity,this.renderIcon({$svg:Object(l.a)(this.DEFAULT_ARROWS_CONTAINER.LEFT),activeArrow:"left_arrow_default"}),this.renderIcon({$svg:Object(l.a)(this.DEFAULT_ARROWS_CONTAINER.RIGHT),activeArrow:"right_arrow_default"}),this.slideshowPlayer.colorArrows(t,e)):"library"!==n&&"noun"!==n||this.getNounArrows()},hideOverlay:function(){this.$(".jsSlideshowOverlay").hide()},showOverlay:function(){this.$(".jsSlideshowOverlay").show()},setToDefaultArrows:function(){var t=this,e=this.model.get("theme_data"),i=e.arrows_type,n=e.left_icon_noun,o=e.right_icon_noun;D.a.defer((function(){"library"!==i&&"noun"!==i||!D.a.isEmpty(n)&&!D.a.isEmpty(o)||t.model.save({theme_data:D.a.extend(t.model.get("theme_data"),{arrows_type:"default"})})}))},bindUploader:function(t){t.on("add",this.onAddUpload),t.on("send",this.onSendUpload),t.on("done",this.onDoneUpload),t.on("fail",this.onFailUpload)},getNounArrows:function(){var t=this.model.get("theme_data").left_icon_noun,e=this.model.get("theme_data").right_icon_noun;D.a.isEmpty(t)&&D.a.isEmpty(e)||(D.a.isEmpty(t)||this.getIconSVG(t.noun_id||t.rm_id,t.noun_url,"left_arrow_noun",function(t,e){!t&&e.$svg}.bind(this)),D.a.isEmpty(e)||this.getIconSVG(e.noun_id||e.rm_id,e.noun_url,"right_arrow_noun",function(t,e){!t&&e.$svg}.bind(this)))},rasterizeIconsBeforeDestroy:function(){D.a.isEmpty(this.currentIconsData.left_arrow_noun)||this.rasterizeIconSVG({$svg:this.getСoloredIconSVG("left_arrow_noun"),activeArrow:"left_arrow_noun"}),D.a.isEmpty(this.currentIconsData.right_arrow_noun)||this.rasterizeIconSVG({$svg:this.getСoloredIconSVG("right_arrow_noun"),activeArrow:"right_arrow_noun"})},renderIcon:function(t){var e=t.$svg,i=t.activeArrow;["left_arrow_noun","left_arrow_default"].includes(i)&&(this.$el.find(".prev-picture-arrow-bottom").empty().html(e.clone()).toggleClass("noun","left_arrow_noun"===i),this.$el.find(".prev-picture-arrow-middle").empty().html(e.clone()).toggleClass("noun","left_arrow_noun"===i)),["right_arrow_noun","right_arrow_default"].includes(i)&&(this.$el.find(".next-picture-arrow-bottom").empty().html(e.clone()).toggleClass("noun","right_arrow_noun"===i),this.$el.find(".next-picture-arrow-middle").empty().html(e.clone()).toggleClass("noun","right_arrow_noun"===i))},prepareIconSVG:function(t){var e=t.clone().appendTo(Object(l.a)("body")),i=t.clone();e.get(0).setAttributeNS(null,"viewBox","0 0 "+e.width()+" "+e.height());var n=e.get(0).getBBox();return e.remove(),i.data("aspect_ratio",n.width/n.height),i.removeAttr("width"),i.removeAttr("height"),i.get(0).setAttributeNS(null,"viewBox",n.x+" "+n.y+" "+n.width+" "+n.height),i.get(0).setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),i.css({width:"100%",height:"100%"}),i},cacheSVGData:function(t){window.iconSVGCache.push(t),window.iconSVGCache.length>this.MAX_ICON_CACHE_SIZE&&window.iconSVGCache.shift()},getSVGCacheItem:function(t){return window.iconSVGCache&&D.a.findWhere(window.iconSVGCache,{id:t})},"getСoloredIconSVG":function(t){var e,i=this.model.get("theme_data").controls_color,n=this.model.get("theme_data").controls_opacity,o=this.currentIconsData[t].$svg.clone();return e=v.default.getRGBA(i,1),o.find("*:not(.fixed-color)").each((function(){var t=Object(l.a)(this);t.css({fill:"","fill-opacity":""}),t.get(0).removeAttribute("fill"),t.get(0).removeAttribute("fill-opacity")})),o.get(0).setAttribute("fill",e),o.get(0).setAttribute("fill-opacity",n),o},rasterizeIconSVG:function(t){this.rasterizeXhr&&this.rasterizeXhr.abort(),this.rasterizeXhr=Lt.rasterize({widgets:[this.model],svg:t.$svg,mid:this.workspace.mag.get("_id"),viewport:this.model.getViewport(),size:{width:this.ARROW_NOUN_ICON_WIDTH,height:this.ARROW_NOUN_ICON_HEIGHT},activeArrow:t.activeArrow})},getIconSVG:function(t,e,i,n){var o,a,r,s=i.includes("left"),c=s?"iconXhrLeft":"iconXhrRight",d=s?"iconLeftRequestInProgress":"iconRightRequestInProgress";if(this[c]&&this[c].abort(),o=this.getSVGCacheItem(t))return r={$svg:o.$svg,noun_url:o.noun_url,aspect_ratio:o.$svg.data("aspect_ratio")},this.currentIconsData[i]=r,this.renderIcon({$svg:this.getСoloredIconSVG(i),activeArrow:i}),n(null,r);var h=function(e){var o=Object(l.a)("<div></div>").append(Object(l.a)(e.svg)).find("svg");if(o.length)return o=this.prepareIconSVG(o),r={id:t,$svg:o,noun_url:e.new_url,aspect_ratio:o.data("aspect_ratio")},this.currentIconsData[i]=r,this.cacheSVGData(r),this.renderIcon({$svg:this.getСoloredIconSVG(i),activeArrow:i}),n(null,{$svg:o,noun_url:e.new_url})}.bind(this);a={method:"POST",url:"/api/authservice/noun/icon",data:{id:t,url:e},dataType:"json",success:function(t){this[d]=!1,h(t)},error:function(t){return this[d]=!1,n(t)},context:this},/^rm/.test(t)&&D.a.extend(a,{method:"GET",url:e,cache:!1,success:function(t){this[d]=!1,h({svg:Object(l.a)(t).find("svg"),new_url:e})},data:null,dataType:null}),this[d]=!0,this[c]=l.a.ajax(a)},fillTextStyles:function(){var t={"size-leading-linked":!0,"size-leading-ratio":this.params.fontSizeLineHeightRatio};this.cur_selection_styles=D.a.defaults(D.a.clone(this.model.get("text_style")),t),this.cur_selection_styles_all=[D.a.defaults(D.a.clone(this.model.get("text_style")),t)]},onCaptionsStatusChange:function(t){this.setControls(t),this.updateControls()},setControls:function(t){t=void 0===t?this.model.get("theme_data").captions:t,this.controls=t?this.initial_controls:D.a.without(this.initial_controls,"text_typography","text_bius","text_color")},onAddUpload:function(t,e){var i=null;if(this.replacingPic){for(var n in this.queue.indexOf(this.replacingPic)>-1&&this.cancelUpload(this.replacingPic),this.replacingPic)"num"!=n&&"id"!=n&&"text"!=n&&delete this.replacingPic[n];this.replacingPic.name=e.files&&e.files[0]&&e.files[0].name,this.replacingPic.uploadData=e,i=this.replacingPic,this.replacingPic=null,this.trigger("replaceUpload",i)}else{i={num:this.getMaxNum()+1,name:e.files&&e.files[0].name,uploadData:e},this.trigger("addUpload",i)}this.queue.push(i)},onSendUpload:function(t,e){this.trigger("nowUploading",this.queue[0])},onDoneUploadFinish:function(t){var e=this.queue.shift();if(t){var i=D.a.clone(this.model.get("pictures"))||[],n=!i.length,o=D.a.indexOf(i,e),a=D.a.extend({num:e.num},t.picture,t.size);o>-1?i[o]=D.a.extend(a,{id:i[o].id,text:i[o].text}):i.push(D.a.extend(a,{id:v.default.generateUUID(),text:""})),this.tempSave({pictures:i}),this.queue=this.queue||[],this.trigger("doneUpload",a),n&&this.updateControls()}else this.trigger("failUpload",e)},onDoneUpload:function(t,e){var i=this;if(!e.result)return this.onDoneUploadFinish(null);var n=e.result,o=D.a.clone(this.model.attributes);return gt.a.useLambdaUrl(n&&n.picture)?this.onDoneUploadFinish(n):o&&o._id&&n.picture.type&&["jpg","png"].includes(n.picture.type.toLowerCase())?void(this._optimizedImageXHR=l.a.ajax({type:"POST",data:{_id:o._id,picture:n.picture},url:"/api/imageoptimize",success:function(t){n.picture=D.a.extend(n.picture,t),i.onDoneUploadFinish(n)},error:function(){i.onDoneUploadFinish(n)}})):this.onDoneUploadFinish(n)},onFailUpload:function(t,e,i){var n=this.queue.shift(),o=D.a.clone(this.model.get("pictures"))||[],a=D.a.indexOf(o,n);n.error=!0,n.errorText=i,a>-1?o[a]=D.a.omit(D.a.extend(n,{id:o[a].id,text:o[a].text}),"uploadData"):o.push(D.a.omit(D.a.extend(n,{id:v.default.generateUUID(),text:""}),"uploadData")),this.model.set("pictures",o),this.queue=this.queue||[],this.updateControls(),this.trigger("failUpload",n,i),this.tempSave({pictures:o})},deletePic:function(t){var e=D.a.findWhere(this.queue,{num:t});e?this.cancelUpload(e):(e=D.a.findWhere(this.model.get("pictures"),{num:t}),this.model.set("pictures",D.a.without(this.model.get("pictures"),e))),D.a.each(this.getAllPics(),(function(t){t.num>e.num&&(t.num-=1)})),this.trigger("reorder"),this.model.save({},{silent:!D.a.isEmpty(this.queue)}),0==(this.model.get("pictures")||[]).length&&this.updateControls()},updatePic:function(t){this.replacingPic=Object(D.a)(this.getAllPics()).findWhere({num:t}),this.uploader.$uploader.trigger("click","stop")},cancelUpload:function(t){0===this.queue.indexOf(t)&&(t.uploadData.abort(),this.queue[1]&&this.trigger("nowUploading",this.queue[1])),this._optimizedImageXHR&&this._optimizedImageXHR.abort(),t.uploadData.files[0].skipped=!0,this.queue=D.a.without(this.queue,t)},removePictures:function(){this.uploader.abort(),this.model.unset("pictures"),this.model.save({},{silent:!0}),this.queue=[],this.trigger("clear")},swapPictures:function(t,e){for(var i=Object(D.a)(this.getAllPics()).sortBy((function(t){return t.num})),n=D.a.findWhere(i,{num:t}),o=t;o!=e+(t<e?1:-1);t<e?o++:o--)o!=t&&(i[o-1].num=t<e?i[o-1].num-1:i[o-1].num+1);n.num=e,this.trigger("reorder"),this.fixPicturesOrder(i),this.saveXHR&&this.saveXHR.abort(),this.saveXHR=this.model.save({},{silent:!D.a.isEmpty(this.queue)}),this.workspace.trigger("redraw"),this.slideshowPlayer.applyPictures(D.a.clone(this.model.attributes))},tempSave:function(t){this.tempSaveXHR&&(this.tempSaveXHR.abort(),delete this.tempSaveXHR),t&&t.pictures&&this.fixPicturesOrder(t.pictures),this.tempSaveXHR=this.model.save(t,{patch:!0,skipHistory:!D.a.isEmpty(this.queue)}).success(D.a.bind((function(){delete this.tempSaveXHR}),this))},fixPicturesOrder:function(t){for(var e=D.a.sortBy(t,"num"),i=0;i<e.length;i++)e[i].num=i+1},getMaxNum:function(){var t=this.getAllPics();return D.a.isEmpty(t)?0:D.a.max(D.a.pluck(t,"num"))},getAllPics:function(){return D.a.union(this.model.get("pictures")||[],this.queue)},updateDropZone:function(){var t=this.$el;this.manager&&(t=t.add(this.manager.$uploadDropZone)),this.settingsPanel&&this.settingsPanel.canUpload()&&(t=t.add(this.settingsPanel.$el)),this.uploader.setOptions({dropZone:t})},getThemeData:function(){var t={theme:this.model.get("current_theme"),thumbnails:this.model.get("theme_data").thumbnails,counters:this.model.get("theme_data").counters,images_h:this.model.get("images_h"),captions_h:this.model.get("captions_h"),left_arrow_noun:this.model.get("left_arrow_noun"),right_arrow_noun:this.model.get("right_arrow_noun"),current_mode:this.model.get("current_mode"),arrows_type:this.model.get("theme_data").arrows_type,captions:this.model.get("theme_data").captions,counters_type:this.model.get("theme_data").counters_type,counters_position:this.model.get("theme_data").counters_position,active_arrows:this.model.get("active_arrows")};return t.showThumbnails=t.thumbnails,t.showCounters=t.counters,t.showCaptions=t.captions||"theme_captions"===t.theme,t.showBottomDots=t.counters&&(("middle"===t.active_arrows||"outside"===t.counters_position)&&"dots"===t.counters_type||"theme_captions"===t.theme),t},getNewBlockHeight:function(){var t=this.getThemeData();return t.images_h+(t.thumbnails?this.slideshowPlayer.THUMBNAILS_HEIGHT:0)+(t.showCaptions?t.captions_h:0)+(t.showBottomDots?this.slideshowPlayer.COUNTERS_HEIGHT:0)},getNewInnerElementsHeight:function(t,e){var i=this.getThemeData(),n=i.images_h,o=i.captions_h;return"s"===e&&i.captions?o=t-i.images_h-(i.showBottomDots?this.slideshowPlayer.COUNTERS_HEIGHT:0):n=t-(i.thumbnails?this.slideshowPlayer.THUMBNAILS_HEIGHT:0)-(i.showCaptions?i.captions_h:0)-(i.showBottomDots?this.slideshowPlayer.COUNTERS_HEIGHT:0),{images_h:n,captions_h:o}},getSaveBoxData:function(t){t=t||{};var e=c.a.prototype.getSaveBoxData.apply(this,arguments),i=this.getNewInnerElementsHeight(e.h,t.resizePoint);return e.images_h=i.images_h,e.captions_h=i.captions_h,e},saveBox:function(t){c.a.prototype.saveBox.apply(this,arguments),this.setSizeConstraints()},textStyleChanged:function(t,e){var i=D.a.clone(this.model.get("text_style")),n=D.a.extend(i,t);e&&(n=D.a.extend(n,e)),this.model.set({text_style:n}),this.saveDebounced()},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t,e)){c.a.prototype.redraw.apply(this,arguments);var i=this.model.changedAttributes();if(D.a.isObject(i)){var n=["captions_h","images_h","w","h","theme_data","left_arrow_noun","right_arrow_noun","transition_type","play_method"];D.a.intersection(D.a.keys(i),n).length&&this.slideshowPlayer.applyVisualState(this.model.attributes),this.model.hasChanged("pictures")&&this.slideshowPlayer.applyPictures(this.model.attributes),this.model.hasChanged("text_style")&&(this.slideshowPlayer.applyTextStyles(this.model.attributes),this.fillTextStyles(),this.trigger("selection_styles_changed",this.cur_selection_styles),this.trigger("selection_styles_all_changed",this.cur_selection_styles_all),this.initiatorControl=null);var o=this.getNewBlockHeight();o!==this.model.get("h")&&this.model.set("h",o)}}},css:function(t,e){if(c.a.prototype.css.apply(this,arguments),null!=t.height||null!=t.width){var i=this.getNewInnerElementsHeight(t.height||this.model.get("h"),e);this.slideshowPlayer.applyVisualState(D.a.clone(this.model.attributes),{w:t.width,h:t.height,images_h:i.images_h,captions_h:i.captions_h})}},onThemeParamsChange:function(){var t=this.getThemeData();this.model.set("h",this.getNewBlockHeight()),this.setSizeConstraints(),this.frame&&this.frame.setResizeBottomPlus(t.showBottomDots||t.captions)},setSizeConstraints:function(){var t,e,i=this.getThemeData(),n=(i.showBottomDots?this.slideshowPlayer.COUNTERS_HEIGHT:0)+(i.thumbnails?this.slideshowPlayer.THUMBNAILS_HEIGHT:0)+(i.captions?this.MIN_CAPTIONS_HEIGHT:0);t=i.images_h+n,e=this.MIN_IMAGES_HEIGHT+n,D.a.extend(this.frame,{minwidth:this.MIN_IMAGES_WIDTH,maxwidth:9999,minheight:0,maxheight:9999,minheight_on_south_resize:t,minheight_on_other_resize:e})},highlightDropZone:function(){this.$el.addClass("show-dropzone"),clearTimeout(this.highlightTimeout),this.highlightTimeout=setTimeout(D.a.bind((function(){this.$el.removeClass("show-dropzone")}),this),500)},destroy:function(){this.workspace.off("main-dragover",this.highlightDropZone),this.off("changeStyleSpan",this.textStyleChanged),this.off("changeStyleParagraph",this.textStyleChanged),this.model.off(),this.slideshowPlayer&&this.slideshowPlayer.destroy(),this.slideshowPlayer=null,c.a.prototype.destroy.apply(this,arguments)}},{defaults:{captions_h:76,images_h:360,current_mode:"default",transition_type:"slider",play_method:"click",theme_data:{arrows:!0,arrows_type:"default",arrows_position:"sides",arrows_view_mode:"normal",counters_type:"numbers",counters_position:"inside",slider_transition:.5,crossfade:2,autoplay_delay:4,hover_delay:.8,scroll_delay:1,start_offset:200,hover_frame_rate:.8,captions:!1,fullscreen:!1,controls_bg:!0,show_on_hover:!1,thumbnails:!1,counters:!1,fill:!0,radius:0,controls_color:"ffffff",controls_opacity:1,background_color:"000000",background_opacity:1,left_icon_noun:{},right_icon_noun:{}},text_style:{color:"000000","font-family":"Arial","font-size":8,"font-style":"normal","font-weight":"400","letter-spacing":0,"line-height":10,opacity:100,"text-align":"center","text-decoration":"none","text-transform":"none","vertical-align":"baseline","size-leading-linked":!0,"size-leading-ratio":1.25}}}),Ft=b.a.extend({applyExtraConstraints:function(t,e){return this.block.setSizeConstraints(),"s"==e?t.height<this.minheight_on_south_resize&&(t.height=this.minheight_on_south_resize):t.height<this.minheight_on_other_resize&&(t.height=this.minheight_on_other_resize),t},setResizeBottomPlus:function(t){this.$el.toggleClass("resize-bottom-plus-slideshow",t)}}),Ut=zt,Nt=i("Vc8N"),Ht=i.n(Nt),Vt=i("3eHG"),Wt=c.a.extend({name:"Twitter",sort_index:12,thumb:"twitter",icon_color:"#1DA1F2",initialize:function(t,e){var i=this;this.mag=e.mag,this.initBlock(t,e),this.frameClass=Gt,this.model.validate=function(t){var e=i.model.get("current_type");t[e].url&&(t[e].url=i.fixUrl(t[e].url)),t.type_hashtag&&t.type_hashtag.hash&&(t.type_hashtag.hash=t.type_hashtag.hash.replace(/\s/g,"")),t.type_follow&&t.type_follow.username&&(t.type_follow.username=t.type_follow.username.replace(/\s/g,""))},this.model.on("change:current_type",this.onParamsChange),this.model.on("change:type_timeline",this.onParamsChange),this.model.on("change:type_embed",this.onParamsChange),this.model.on("change:type_tweet",this.onParamsChange),this.model.on("change:type_follow",this.onParamsChange),this.model.on("change:type_hashtag",this.onParamsChange),this.controls=["twitter_settings","common_position","common_layer","common_lock"]},render:function(){this.create(),this.$el.addClass("twitter"),this.redraw(this.model,{skipHistory:!0,skipTriggerRedraw:!0,doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0}),this.onParamsChange(),this.triggerReady()},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t,e)){var i=this.model.get("current_type"),n=this.model.changedAttributes(),o=D.a.isObject(n)&&0==D.a.without(D.a.keys(n),"x","y","z","pack_id").length,a=D.a.isObject(n)&&(D.a.has(n,"w")||D.a.has(n,"h"))&&!n.current_type,r=!(o||a&&("type_timeline"===i||"type_embed"===i));c.a.prototype.redraw.apply(this,arguments),"type_embed"===i&&this.adjustTweetHeight({skipHistory:e&&(e.undo||e.redo||e.skipHistory)}),r&&this.redrawTwitter(t.get("w"),t.get("h"),e)}},css:function(t){var e,i,n,o=this.$el.find("iframe");c.a.prototype.css.apply(this,arguments),"type_timeline"===this.model.get("current_type")&&1==o.length&&o.hasClass("twitter-timeline")&&(e=o.contents().find("body .timeline-header").outerHeight(),i=o.contents().find("body .timeline-footer").outerHeight(),n=o.height()-e-i,e&&i&&o.contents().find("body .stream").height(n))},onParamsChange:function(){var t=this.model.get("current_type");D.a.contains(["type_timeline","type_embed"],t)?this.validateCode(t):D.a.contains(["type_tweet","type_follow","type_hashtag"],t),this.$el.removeClass(["type_timeline","type_embed","type_tweet","type_follow","type_hashtag"].join(" ")),this.$el.addClass(t),this.setSizeConstraints()},setSizeConstraints:function(t){var e,i=this.model.get("current_type");D.a.contains(["type_tweet","type_follow","type_hashtag"],i)?(e=this.$el.find("iframe")).length>0?D.a.extend(this.frame,{minwidth:e.width()||120,maxwidth:e.width()||120,minheight:e.height()||20,maxheight:e.height()||20}):D.a.extend(this.frame,{minwidth:120,maxwidth:120,minheight:20,maxheight:20}):"type_timeline"===i?D.a.extend(this.frame,{minwidth:180,maxwidth:520,minheight:200,maxheight:9999}):"type_embed"===i&&(e=this.$el.find("twitterwidget.twitter-tweet"),D.a.extend(this.frame,{minwidth:220,maxwidth:500,minheight:e.length&&e.height()>1?e.height():163,maxheight:e.length&&e.height()>1?e.height():163})),t&&D.a.extend(this.frame,t)},doResize:function(t){t=t||{};var e=this.model.get("current_type");this.model.get("w")<this.frame.minwidth&&this.model.set("w",this.frame.minwidth,{silent:!0}),this.model.get("w")>this.frame.maxwidth&&this.model.set("w",this.frame.maxwidth,{silent:!0}),this.model.get("h")<this.frame.minheight&&this.model.set("h",this.frame.minheight,{silent:!0}),this.model.get("h")>this.frame.maxheight&&this.model.set("h",this.frame.maxheight,{silent:!0}),D.a.contains(["type_tweet","type_follow","type_hashtag"],e)&&(this.model.set("w",this.frame.minwidth,{silent:!0}),this.model.set("h",this.frame.minheight,{silent:!0})),D.a.isEmpty(D.a.pick(this.model.changed,"w","h"))||this.model.save({},{skipHistory:t.skipHistory,noSocketUpdate:t.socketUpdate}),this.frame.doResize({left:this.model.get("x"),top:this.model.get("y"),width:this.model.get("w"),height:this.model.get("h")})},redrawTwitter:function(t,e,i){var n,o,a=this.model.get("current_type"),r=D.a.clone(this.model.get(a)),s=Ht.a["template-constructor-block-twitter-"+a];"mag"===r.use_own_url?r.url=this.getMagUrl():"page"!==r.use_own_url&&r.url||(r.url=this.getPageUrl()),n=s(r),this.$content.html(n),this.$overlay=this.$content.find(".overlay"),"type_timeline"===a&&this.$content.find("a").attr({width:this.model.get("w"),height:this.model.get("h")}),o=this.frame.isFrameVisible(),this.frame.hide(),Vt.a.initTwitterAPI(function(){var t=function(e){var n=e.target;Object(l.a)(n).closest(".block").attr("data-id")===this.model.get("_id")&&(window.twttr.events.unbind("rendered",t),this.waitForIframe(this.$content,20,100,function(){var t=i&&(i.undo||i.redo);"type_timeline"===a&&this.$content.find("iframe").css({width:"100%",height:"100%","max-width":"100%"}),"type_embed"===a?this.adjustTweetHeight({skipHistory:t}):(this.setSizeConstraints(),this.doResize(D.a.extend({},i,{skipHistory:"type_embed"===a||t}))),o&&this.frame.show()}.bind(this)))}.bind(this);window.twttr.events.bind("rendered",t),window.twttr&&window.twttr.widgets&&D.a.isFunction(window.twttr.widgets.load)&&window.twttr.widgets.load(this.$el[0])}.bind(this))},validateCode:function(t){var e,i;e=this.model.get(t).code.match({type_timeline:/^\<a.*\>.*\<\/a\>/i,type_embed:/^\<blockquote.*\>.*\<\/blockquote\>/i}[t]),(i=D.a.clone(this.model.get(t))).code=e?e[0]:"",this.model.set(t,i)},waitForIframe:function(t,e,i,n){var o;o=setInterval((function(){var e=t.find("iframe, twitterwidget");e.length&&(parseInt(e[0].style.width)>0||parseInt(e[0].style.height))>0&&(clearInterval(o),D.a.delay(function(){n()}.bind(this),100))}),e)},adjustTweetHeight:function(t){var e=this.$content.find("twitterwidget.twitter-tweet, iframe.twitter-tweet"),i=this.model.get("current_type");e.height();"type_embed"===i&&(e.css({margin:0,"max-width":"100%","-webkit-transform":"none",width:"100%"}),e.contents().find("body *").css({"-webkit-transition-duration":"0s","transition-duration":"0s"}),this.setSizeConstraints(),this.doResize(t))},getMagUrl:function(){return this.mag&&mt.a.readymag_host+"/"+this.mag.get("num_id")+"/"},getPageUrl:function(){return mt.a.readymag_host+"/p"+this.workspace.page.get("num_id")+"/"},fixUrl:function(t){var e=t;return t&&(e=(/^http(s?):\/\//i.test(t)?"":"http://")+t),e}},{defaults:{current_type:"type_timeline",type_timeline:{code:'<a class="twitter-timeline" href="https://twitter.com/readymag" data-widget-id="324216476359852033">Tweets by @readymag</a>',widget_id:""},type_embed:{code:'<blockquote class="twitter-tweet"><p>Here we go: <a href="http://t.co/yY6jqsSg" title="https://readymag.com/">readymag.com</a></p>&mdash; Readymag (@readymag) <a href="https://twitter.com/readymag/status/225550067766005760">July 18, 2012</a></blockquote>'},type_tweet:{url:"",use_own_url:"mag",show_count:!0,large_button:!1},type_follow:{username:"Readymag",show_name:!0,large_button:!1},type_hashtag:{hash:"Readymag",large_button:!1}}}),Gt=b.a.extend({customResizeHandler:function(t,e){return this.block.setSizeConstraints(),t}}),qt=Wt,Kt=i("wxrA"),Yt=i.n(Kt),Xt=c.a.extend({name:"Facebook",sort_index:11,thumb:"facebook",icon_color:"#1877F2",initialize:function(t,e){var i,n,o=this;this.mag=e.mag,this.initBlock(t,e),"type_like_button"==this.model.get("current_type")&&this.model.get("type_like_button").send_button&&((i=D.a.clone(this.model.get("type_like_button"))).share_button=i.send_button,delete i.send_button,this.model.set("type_like_button",i,{silent:!0})),D.a.isEmpty(this.model.get("type_like_box"))||((n=D.a.clone(this.model.get("type_like_box"))).small_header=!n.show_header,delete n.show_header,this.model.unset("type_like_box",{silent:!0}),this.model.set({type_page:n},{silent:!0}),"type_like_box"==this.model.get("current_type")&&this.model.set({current_type:"type_page"},{silent:!0})),this.frameClass=Zt,this.model.validate=function(t){var e=o.model.get("current_type");t[e].url&&(t[e].url=o.fixUrl(t[e].url))},this.controls=["facebook_settings","common_position","common_layer","common_lock"]},render:function(){this.create(),this.$el.addClass("facebook"),this.redraw(this.model,{skipTriggerRedraw:!0,doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0}),this.triggerReady()},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t,e)){var i=this.model.get("current_type"),n=this.model.get(i),o=this.model.changedAttributes(),a=D.a.isObject(o)&&0==D.a.without(D.a.keys(o),"x","y","z","pack_id").length,r=!a,s=["type_like_button","type_page","type_comments"];c.a.prototype.redraw.apply(this,arguments),this.$el.removeClass(s.join(" ")),this.$el.addClass(i),"type_like_button"===i&&this.$el.removeClass("standard box_count button_count").addClass(n.layout),this.$el.toggleClass("no-v-resize","type_page"===i&&!n.show_stream&&!n.show_faces),Object(D.a)(["type_page","type_comments"]).contains(i)&&(this.setSizeConstraints(),e&&(e.undo||e.redo)||this.doResize()),r&&this.redrawFacebook(t.get("w"),t.get("h"),e)}},setSizeConstraints:function(t){var e,i,n,o,a=this.model.get("current_type"),r=this.model.get(a);if(e=this.$el.find("iframe"),"type_like_button"===a){if(1!==e.length)return;i="button_count"===r.layout||"box_count"===r.layout,D.a.extend(this.frame,{minwidth:i?e.width():285,maxwidth:i?e.width():900,minheight:e.height(),maxheight:e.height()})}else"type_page"===a?(n=63,n+=r.show_faces?122:0,n+=r.show_header&&(r.show_faces||r.show_stream)?30:0,n+=r.show_stream?300:0,o=!r.show_faces&!r.show_stream?63:9999,D.a.extend(this.frame,{minwidth:292,maxwidth:900,minheight:n,maxheight:o})):"type_comments"===a&&D.a.extend(this.frame,{minwidth:400,maxwidth:900,minheight:250,maxheight:9999});t&&D.a.extend(this.frame,t)},doResize:function(t){this.model.get("w")<this.frame.minwidth&&this.model.set("w",this.frame.minwidth,{silent:!0}),this.model.get("w")>this.frame.maxwidth&&this.model.set("w",this.frame.maxwidth,{silent:!0}),this.model.get("h")<this.frame.minheight&&this.model.set("h",this.frame.minheight,{silent:!0}),this.model.get("h")>this.frame.maxheight&&this.model.set("h",this.frame.maxheight,{silent:!0}),D.a.isEmpty(D.a.pick(this.model.changed,"w","h"))||this.model.save({},{skipHistory:!0,noSocketUpdate:t&&t.socketUpdate}),this.frame.doResize({left:this.model.get("x"),top:this.model.get("y"),width:this.model.get("w"),height:this.model.get("h")})},redrawFacebook:function(t,e,i){var n,o,a=this.model.get("current_type"),r=D.a.clone(this.model.get(a)),s=Yt.a["template-constructor-block-facebook-"+a];r.w=this.model.get("w"),r.h=this.model.get("h"),"mag"===r.use_own_url?r.url=this.getMagUrl():"page"!==r.use_own_url&&r.url||(r.url=this.getPageUrl()),r.url=this.fixUrl(r.url),n=s({data:r}),this.$content.html(n),this.$overlay=this.$content.find(".overlay"),this.$content.toggleClass("scrollable","type_comments"===a),Vt.a.initFacebookAPI(function(){window.FB.XFBML.parse(this.$el.get(0),function(){if("type_comments"===a&&this.$(".fb-comments").append(Object(l.a)('<div class="overlay"></div>')),"type_like_button"===a){o=this.$el.find("iframe");var t=0,e=setInterval(function(){t++,(o.height()>0||t>20)&&(clearInterval(e),this.setSizeConstraints(),this.doResize(i))}.bind(this),100)}}.bind(this))}.bind(this))},getMagUrl:function(){return this.mag&&mt.a.readymag_host+"/"+this.mag.get("num_id")+"/"},getPageUrl:function(){return mt.a.readymag_host+"/p"+this.workspace.page.get("num_id")+"/"},fixUrl:function(t){var e=t;return t&&(e=(/^http(s?):\/\//i.test(t)?"":"http://")+t),e}},{defaults:{current_type:"type_like_button",x:"center",w:61,h:20,type_like_button:{url:"",use_own_url:"mag",layout:"button_count",share_button:!1,show_faces:!1,theme:"light"},type_page:{url:"https://www.facebook.com/readymag",show_stream:!0,small_header:!1,show_faces:!1,theme:"light"},type_comments:{url:"",use_own_url:"mag",num_posts:5,theme:"light"}}}),Zt=b.a.extend({}),Jt=Xt,Qt=i("z79a"),te=c.a.extend(Qt.a.prototype).extend({name:"Shape",sort_index:3,thumb:"shape",icon_color:"#FFCB00",dontSaveOnResize:!0,viewport_fields:m.b.viewport_fields.shape,LINE_BLOCK_HEIGH:24,initial_controls:["shape_settings",Object(d.a)("constructor.newColorpicker")?"shape_color_new":"shape_color","shape_1x1","common_animation","picture_link","common_rotation","common_position","common_layer","common_lock"],initialize:function(t,e){this.mag=e.mag,this.initBlock(t,e),this.renderSVGContent.__debounced=D.a.debounce(this.renderSVGContent,0),this.iconData=null},render:function(){this.create(),this.$el.addClass("shape"),this.setControls(),this.$el.on("dblclick",this.onDoubleClick),this.redraw(this.model,{skipTriggerRedraw:!0,doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0}),this.model.on("change:tp",this.onTypeChange),this.model.on("change:is_full_width",this.onStrechBlockChange),this.model.on("change:is_full_height",this.onStrechBlockChange),this.onTypeChange(),this.triggerReady()},onDoubleClick:function(t){Object(l.a)(t.target).closest(".content").length&&this.showControl("shape_settings")},onStrechBlockChange:function(){this.setControls(),this.updateControls()},showControl:function(t){var e,i=this.workspace&&this.workspace.controls;i&&(e=i.findControl(t))&&!e.selected&&e.onClick()},setControls:function(){var t=this.model.get("tp");this.controls="line"==t||"icon"==t?D.a.without(this.initial_controls,"shape_1x1"):this.initial_controls},onTypeChange:function(t,e,i){var n=this.model.get("tp"),o=t&&0==D.a.without(D.a.keys(t.changedAttributes()),"tp").length;this.proportional="icon"==n,"icon"==n&&(this.isRealChangeByMe(i)&&D.a.delay(function(){this.showControl("shape_icon")}.bind(this),300),this.resetFullWidth(),this.resetFullHeight()),"line"==n&&o&&this.fixLineHeight(),this.setControls(),this.updateControls()},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t,e)){c.a.prototype.redraw.apply(this,arguments);var i,n,o,a,r=this.model.changedAttributes(),s=!1;if(D.a.isObject(r)&&(s=0==D.a.without(D.a.keys(r),"x","y","z","sticked_margin","sticked").length,a=0==D.a.without(D.a.keys(r),"rasterUrl","raster2xUrl").length,i=!!r.tp,n=!(!r.noun_id&&!r.rm_id)),!a&&(!s||this.model.isGlobal()))if("icon"==t.get("tp")){o=!!D.a.intersection(D.a.keys(r),["w","h","noun_id"]).length;var l={viewport:this.model.getViewport(),skipHistory:e.isGroupResize},d=o&&!(e.undo||e.redo),h=i||n,u=this.redrawIcon.bind(this,t,l,h,d);e.isGroupResize?D.a.delay(u):u()}else this.redrawShape(t.get("w"),t.get("h")),i&&"ellipse"==t.get("tp")&&this.makeSquare()}},redrawIcon:function(t,e,i,n){this.getIconSVG(t.get("noun_id")||t.get("rm_id"),t.get("noun_url"),function(t,e){!t&&e.$svg&&(this.destroyed||(this.updateIconSVGData(e,i),n&&this.rasterizeSVG()))}.bind(this))},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i="./constructor/widgetbar/icons/";if(t.small&&this.icon_color&&(e["background-color"]=this.icon_color),"icon"===this.model.get("tp"))e["background-color"]=this.icon_color,t&&t.small||(e["border-radius"]="8px");else{var n=Object(at.findImagePath)("".concat(i,"shape-").concat(this.model.get("tp"),".svg"));e["background-image"]="url(".concat(n,")")}return e},getIconData:function(){return"icon"===this.model.get("tp")?this.iconData:null},updateIconSVGData:function(t,e){this.iconData=t,this.redrawShape(this.model.get("w"),this.model.get("h")),(e=e||"icon"==this.model.get("tp")&&this.model.get("w")!=this.model.get("h"))&&this.fixIconSVGSize()},css:function(t){c.a.prototype.css.apply(this,arguments),null!=t.height&&null!=t.width&&this.redrawShape(t.width,t.height)},redrawShape:function(t,e){var i=this.generateShapeSVG("constructor",this.model,t,e);this.renderSVGContent(i),Modernizr.firefox&&this.renderSVGContent.__debounced(i)},renderSVGContent:function(t){this.$content.html(t)},fixIconSVGSize:function(t){this.model.get("w"),this.model.get("h");var e,i,n,o,a,r,s,l=this.getBoxData(),c=Math.min(l.w,l.h);(e=this.$content.find("svg")).length&&(n=e.get(0).getBBox(),i=Math.round(n.width)/Math.round(n.height),r=l.w,s=l.h,n.width<n.height?(l.w=c,l.h=Math.ceil(l.w/i)):(l.h=c,l.w=Math.ceil(l.h*i)),o=Math.floor((r-l.w)/2),a=Math.floor((s-l.h)/2),l.x=l.x+o,l.y=l.y+a,this.model.set(l,D.a.extend({skipHistory:!0},t)))},rasterizeSVG:function(){var t=this,e=this.$content.find("svg");e.length&&(this.rasterizeXhr&&this.rasterizeXhr.abort(),this.rasterizeXhr=Lt.rasterize({widgets:[this.model],svg:e,mid:this.workspace.mag.get("_id"),viewport:this.model.getViewport(),size:{width:this.model.get("w"),height:this.model.get("h")},onSuccess:function(e){e&&e.rasterUrl&&t.model.save(e,{skipHistory:!0,silent:!0})}}))},saveNewColor:function(){this.rasterizeSVG()},onResizeStart:function(t,e){this.rasterizeXhr&&this.rasterizeXhr.abort()},onResizeEnd:function(t,e,i){if("icon"!==this.model.get("tp"))return this.saveBox(i);this.fixIconSVGSize(i)},saveBox:function(t){c.a.prototype.saveBox.apply(this,arguments)},getDefaultIconSVG:function(){return this.prepareIconSVG(Object(l.a)('<svg xmlns="http://www.w3.org/2000/svg" width="246" height="245"><path fill="#282828" fill-rule="evenodd" d="M117.858 210.495L56.34 243.02c-5.37 2.84-12.026.788-14.865-4.583a11 11 0 01-1.12-6.99l11.837-69.404a11 11 0 00-2.76-9.31L3.823 103.326c-4.12-4.464-3.843-11.423.621-15.544a11 11 0 015.756-2.784l63.95-10.035a11 11 0 008.17-6.021l30.804-62.768c2.677-5.454 9.267-7.705 14.721-5.029a11 11 0 015.029 5.029l30.804 62.768a11 11 0 008.17 6.02l63.95 10.036c6.001.942 10.103 6.57 9.161 12.572a11 11 0 01-2.784 5.756l-45.609 49.406a11 11 0 00-2.76 9.31l11.836 69.404c1.022 5.988-3.005 11.67-8.994 12.692a11 11 0 01-6.99-1.119l-61.518-32.524a11 11 0 00-10.282 0z"/></svg>'))},getIconSVG:function(t,e,i,n){var o,a;if(arguments.length<4&&(n=i,i={}),this.iconXhr&&this.iconXhr.abort(),!t)return n(null,{$svg:this.getDefaultIconSVG(),noun_url:null});if(!i.noCache&&(o=this.getSVGCacheItem(t))){var r=this.processNounIcon(o);return n(null,r)}this.iconRequestInProgress=!0;var s=function(e){e.noCache||this.cacheSVGData({id:t,svg:e.svg,noun_url:e.new_url});var i=this.processNounIcon(e);return n(null,i)}.bind(this);a={method:"POST",url:"/api/authservice/noun/icon",data:{id:t,url:e},dataType:"json",success:function(t){s(t)},error:function(t){return"abort"==!t.statusText&&console.log("icon xhr : ",t),n(t)},complete:function(){},context:this},/^rm/.test(t)&&D.a.extend(a,{method:"GET",url:e,cache:!1,success:function(t){s({svg:Object(l.a)(t).find("svg"),new_url:e,noCache:!0})},data:null,dataType:null}),this.iconXhr=l.a.ajax(a)},processNounIcon:function(t){var e=Object(l.a)("<div></div>").append(Object(l.a)(t.svg)).find("svg");if(e.length)return{$svg:e=this.prepareIconSVG(e),noun_url:t.new_url}},prepareIconSVG:function(t){var e=t.clone().appendTo(Object(l.a)("body")),i=t.clone();e.get(0).setAttributeNS(null,"viewBox","0 0 "+e.width()+" "+e.height());var n=e.get(0).getBBox();return e.remove(),this.currenIconSVGAcpectRatio=n.width/n.height,i.removeAttr("width"),i.removeAttr("height"),i.get(0).setAttributeNS(null,"viewBox",n.x+" "+n.y+" "+n.width+" "+n.height),i.get(0).setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),i.css({width:"100%",height:"100%"}),i},cacheSVGData:function(t){var e=JSON.parse(window.localStorage.getItem("noun_icons"))||{};e[t.id]=D.a.omit(t,"id");try{window.localStorage.setItem("noun_icons",JSON.stringify(e))}catch(t){window.localStorage.removeItem("noun_icons")}},getSVGCacheItem:function(t){var e=(JSON.parse(window.localStorage.getItem("noun_icons"))||{})[t];if(e)return D.a.extend({id:t},e)},fixLineHeight:function(){var t=this.model.get("h"),e=this.model.get("y"),i=this.model.get("weight"),n=i>this.LINE_BLOCK_HEIGH?i:this.LINE_BLOCK_HEIGH,o=Math.floor((t-n)/2);this.model.set({h:n,y:e+o})},makeSquare:function(){var t=this.model.get("x"),e=this.model.get("w"),i=this.model.get("h"),n=Math.floor((e-i)/2);this.model.set({w:i,x:t+n})},destroy:function(){this.model.off("change:tp",this.onTypeChange),this.model.off("change:is_full_width",this.onStrechBlockChange),this.model.off("change:is_full_height",this.onStrechBlockChange),c.a.prototype.destroy.apply(this,arguments),this.stopListening(this),this.$el.off()}},{defaults:{tp:"rectangle",bg_color:"000000",bg_opacity:1,color:"ffffff",opacity:1,borders:0,radius:0,radius_rect_tl:0,radius_rect_tr:0,radius_rect_bl:0,radius_rect_br:0,radius_rect_independent:!1,sides:3,weight:1,stroke:"solid"}}),ee=i("60Nw"),ie=c.a.extend({name:"Code",sort_index:15,thumb:"iframe",icon_color:"#8B228C",iframe_controls:["iframe_edit"],initialize:function(t,e){this.mag=e.mag,this.frameClass=ne,this.controls=D.a.union(this.iframe_controls,this.controls),this.initBlock(t,e)},onCreate:function(){this.showPanel()},configurePlugin:function(t){var e=ee.a.findPlugin(this.model.toJSON());return e?new e({block:this}):null},render:function(){c.a.prototype.render.apply(this,arguments),this.$el.addClass("iframe"),this.$el.on("dblclick",this.onDoubleClick),this.redraw(this.model,{skipTriggerRedraw:!0,doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0}),this.triggerReady()},redraw:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.checkNeedRedraw(t,e)){var i,n,o=this.model.changedAttributes(),a=!0,r=!1;if(c.a.prototype.redraw.apply(this,arguments),D.a.isObject(o)&&(a=!(0===D.a.without(D.a.keys(o),"x","y","z","w","h").length),r=D.a.contains(D.a.keys(o),"code")),a){if(this.$content.empty(),this.$container=Object(l.a)('<div class="container"></div>'),this.$content.append(this.$container),this.$content.append(Object(l.a)('<div class="overlay"></div>')),this.$el.removeAttr("data-plugin"),n=t.get("code"),this.plugin=null,n){if(this.plugin=this.configurePlugin(n),!this.plugin)return;this.plugin.parse(n,function(e){(i=this.plugin.sanitize(e))&&i.length&&this.plugin.draw(i,this.$container,function(e,i){this.$el.attr("data-plugin",this.plugin.embed_type),(r||this.plugin.forceFrameSize)&&(e&&!this.isFullWidth()&&t.set("w",e),i&&!this.isFullHeight()&&t.set("h",i)),this.proportional=this.plugin.proportional,this.plugin.resizable&&this.$content.find(this.plugin.containerSelector).css({width:"100%",height:"100%","max-width":"","max-height":""})}.bind(this))}.bind(this))}this.$el.toggleClass("empty",!n)}}},showPanel:function(){this.openCodeEditor({model:this.model})},hidePanel:function(){this.closeCodeEditor()},openCodeEditor:function(t){RM.constructorRouter.openCodeEditor(t)},closeCodeEditor:function(t){RM.constructorRouter.closeCodeEditor()},onDoubleClick:function(t){RM.constructorRouter.isCodeEditorVisible||this.trigger("editCodeClick")},deselect:function(){RM.constructorRouter.closeCodeEditor(),c.a.prototype.deselect.apply(this,arguments)},destroy:function(){var t=!0;RM.constructorRouter.closeCodeEditor(t),c.a.prototype.destroy.apply(this,arguments)}},{defaults:{use_iframe:!0}}),ne=b.a.extend({customResizeHandler:function(t){return this.block.plugin&&D.a.isFunction(this.block.plugin.customResizeHandler)?this.block.plugin.customResizeHandler.apply(this,arguments):t}}),oe=ie,ae=i("w4Sg"),re=i.n(ae),se=c.a.extend({name:"Maps",sort_index:10,thumb:"gmaps",icon_color:"#8E5B12",initial_controls:["gmaps_settings","gmaps_edit","common_animation","common_position","common_layer","common_lock"],initialize:function(t,e){this.mag=e.mag,this.frameClass=le,this.initBlock(t,e),this.initOpts()},render:function(){c.a.prototype.render.apply(this,arguments),this.triggerReady(),this.$el.addClass("gmaps"),this.$content.html(re.a["template-constructor-block-gmaps"]()),this.$search=Object(l.a)(re.a["template-constructor-block-gmaps-search-control"]()),this.search=this.$search.get(0),this.$source=this.$search.find(".rm-search.source"),this.$destination=this.$search.find(".rm-search.destination"),this.$apiKeyBlock=this.$content.find(".rm-gmaps-key"),this.$apiKeyInput=this.$apiKeyBlock.find("input"),this.$apiKeyApply=this.$apiKeyBlock.find("button"),D.a.extend(this.frame,{minwidth:240,minheight:210}),this.setControls(),this.generateMap(this.bindLogic)},generateMap:function(t){var e=this.model.get("api_key");this.$apiKeyBlock[e?"addClass":"removeClass"]("hidden"),Vt.a.initGMapsAPI(e,function(){var e,i,n,o,a,r,s,l=this.model.get("current_type");D.a.defer(function(){this.map=new google.maps.Map(this.$(".map-container").get(0),{zoom:this.model.get("map_zoom"),center:new google.maps.LatLng(this.model.get("center_lat"),this.model.get("center_lng")),mapTypeId:this.model.get("map_type_id")||google.maps.MapTypeId.ROADMAP,streetViewControl:!1}),this.marker=new google.maps.Marker({map:this.map,draggable:!0}),this.sourceAutocomplete=new google.maps.places.Autocomplete(this.$source.get(0),{}),this.destinationAutocomplete=new google.maps.places.Autocomplete(this.$destination.get(0),{}),this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer,e=this.model.get("marker_lat"),i=this.model.get("marker_lng"),e&&i&&"directions"!=l&&this.dropMarker(new google.maps.LatLng(e,i)),n=this.model.get("direction_start_lat"),o=this.model.get("direction_start_lng"),a=this.model.get("direction_end_lat"),r=this.model.get("direction_end_lng"),s=this.model.get("direction_route_type"),n&&o&&a&&r&&s&&(this.source=new google.maps.LatLng(n,o),this.destination=new google.maps.LatLng(a,r)),this.onMapTypeChange(),this.onShowControlsChange(),this.redraw(this.model,{skipTriggerRedraw:!0,doNotRedrawPacksFrames:!0,doNotRedrawBottomShiftLine:!0}),t&&t()}.bind(this))}.bind(this))},redraw:function(t,e){e=e||{},this.checkNeedRedraw(t,e)&&c.a.prototype.redraw.apply(this,arguments)},onMapTypeChange:function(t){var e=this.model.get("current_type");this.$destination.toggleClass("hidden","directions"!==e),this.marker.setVisible("directions"!==e),"directions"!==e?this.clearRoute():this.drawRoute(!t),"custom"==e&&this.model.get("custom_json")?this.applyCustomStyle():this.clearCustomStyle()},onSourceChage:function(){var t=this.sourceAutocomplete.getPlace();if(t.geometry){if(this.source=t.geometry.location,"directions"==this.model.get("current_type"))return this.drawRoute();this.marker.setVisible(!1),t.geometry.viewport?this.map.fitBounds(t.geometry.viewport):(this.map.setCenter(t.geometry.location),this.map.setZoom(17)),this.model.set("formatted_address",t.formatted_address),this.dropMarker(t.geometry.location)}},onDestinationChange:function(){var t=this.destinationAutocomplete.getPlace();t.geometry&&(this.destination=t.geometry.location,this.drawRoute())},drawRoute:function(t){var e=this.model.get("direction_route_type");this.source&&this.destination&&e&&(this.directionsDisplay.setMap(null),this.directionsService.route({origin:this.source,destination:this.destination,travelMode:google.maps.TravelMode[e.toUpperCase()]},function(e,i){var n;if(i==google.maps.DirectionsStatus.OK)this.directionsDisplay.setDirections(e),this.directionsDisplay.setOptions({preserveViewport:t||!1}),this.directionsDisplay.setMap(this.map),this.model.set({direction_start_lat:this.source.lat(),direction_start_lng:this.source.lng(),direction_end_lat:this.destination.lat(),direction_end_lng:this.destination.lng()}),google.maps.event.trigger(this.map,"resize"),D.a.defer(function(){n=this.map.getCenter(),this.model.set({center_lat:n.lat(),center_lng:n.lng(),map_zoom:this.map.getZoom()})}.bind(this));else{if(!this.model.get("api_key"))return;this.showMessage("Sorry, there's no route for selected directions.")}}.bind(this)))},clearRoute:function(){this.directionsDisplay.setMap(null)},dropMarker:function(t){this.marker.setPosition(t),this.marker.setAnimation(google.maps.Animation.DROP),this.marker.setVisible(!0),this.markerDropped=!0},setControls:function(){this.controls=this.initial_controls},bindLogic:function(){this.listenTo(this.model,"change:current_type",this.onMapTypeChange),this.listenTo(this.model,"change:custom_json",this.applyCustomStyle),this.listenTo(this.model,"change:direction_route_type",this.onRouteTypeChange),this.listenTo(this.model,"change:show_controls",this.onShowControlsChange),this.listenTo(this.model,"change:api_key",this.onApiKeyChange),this.listenTo(this.model,"change",this.hideMessage),google.maps.event.addListener(this.sourceAutocomplete,"place_changed",this.onSourceChage),google.maps.event.addListener(this.destinationAutocomplete,"place_changed",this.onDestinationChange),google.maps.event.addListener(this.marker,"dragend",this.onMarkerDragEnd),google.maps.event.addListener(this.map,"maptypeid_changed",this.onMapTypeIdChange),this.$source.on("click",this.onInputClick),this.$destination.on("click",this.onInputClick),this.$el.on("dblclick",function(){this.inEditState||this.trigger("editMapClick")}.bind(this)),w.a.on("gmaps:update_key",this.updateKey),this.$apiKeyInput.on("click",this.onApiKeyInputClick),this.$apiKeyApply.on("click",this.onApiKeyApply)},unbindLogic:function(){this.stopListening(this.model),window.google&&window.google.maps&&(google.maps.event.clearListeners(this.sourceAutocomplete,"place_changed"),google.maps.event.clearListeners(this.destinationAutocomplete,"place_changed"),google.maps.event.clearListeners(this.marker,"dragend")),this.$source.off("click",this.onInputClick),this.$destination.off("click",this.onInputClick),this.$el.off("dblclick"),w.a.off("gmaps:update_key",this.updateKey),this.$apiKeyInput.off("click",this.onApiKeyInputClick),this.$apiKeyApply.off("click",this.onApiKeyApply)},enterEditState:function(){this.inEditState=!0,this.disableDragging=!0,this.$(".map-overlay").hide(),this.$el.addClass("edit-map"),this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(this.search),D.a.delay(function(){this.$source.focus()}.bind(this),300),this.onShowControlsChange()},exitEditState:function(){var t,e,i={};this.inEditState&&(this.disableDragging=!1,this.$(".map-overlay").show(),this.$el.removeClass("edit-map"),this.map.controls[google.maps.ControlPosition.TOP_LEFT].pop(),this.inEditState=!1,this.onShowControlsChange(),t=this.map.getCenter(),D.a.extend(i,{center_lat:t.lat(),center_lng:t.lng(),map_zoom:this.map.getZoom()}),this.markerDropped&&(e=this.marker.getPosition(),D.a.extend(i,{marker_lat:e.lat(),marker_lng:e.lng()})),this.model.set(i))},onMarkerDragEnd:function(){var t=this.marker.getPosition();this.model.set({marker_lat:t.lat(),marker_lng:t.lng(),formatted_address:""})},onMapTypeIdChange:function(){var t=this.map.getMapTypeId();this.model.set({map_type_id:t})},onInputClick:function(t){var e=Object(l.a)(t.currentTarget);D.a.defer((function(){e.select()}))},applyCustomStyle:function(){var t=this.model.get("custom_json");t?this.map.setOptions({styles:JSON.parse(t)}):this.map.setOptions({styles:null})},clearCustomStyle:function(){this.map.setOptions({styles:null})},onRouteTypeChange:function(){this.drawRoute()},onShowControlsChange:function(){var t=this.inEditState||this.model.get("show_controls");t!=this.isControlsVisible&&(this.map.setOptions({panControl:t,zoomControl:t,mapTypeControl:t,scaleControl:t}),this.isControlsVisible=t)},onApiKeyChange:function(t,e){this.model.save(),w.a.trigger("gmaps:update_key",this.model.get("api_key"),this.model.get("_id")),this.regenerateMap(),this.viewOpts.saveOpts({gmaps_key:e})},updateKey:function(t,e){this.model.get("_id")!==e&&this.model.get("api_key")!==t&&(this.model.set("api_key",t,{silent:!0}),this.model.save(),this.regenerateMap())},regenerateMap:function(){Vt.a.destroyGMapsAPI(),D.a.defer(function(){this.generateMap()}.bind(this))},onApiKeyInputClick:function(t){t.stopImmediatePropagation()},onApiKeyApply:function(t){t.stopImmediatePropagation();var e=this.$apiKeyInput.val();e&&39===e.length&&(this.model.set("api_key",e),this.$apiKeyInput.val(""),this.$apiKeyApply.addClass("hidden"))},initOpts:function(){var t=this,e=Backbone.Model.extend({url:"/api/mag/opts/"+this.mag.get("num_id")});this.viewOpts=new e(this.mag.get("opts")||{}),this.viewOpts.saveOpts=function(){this.save.apply(this,arguments),t.mag.set("opts",this.toJSON())}},showMessage:function(t){this.$(".message-overlay").text(t).removeClass("invisible")},hideMessage:function(){this.$(".message-overlay").addClass("invisible")},deselect:function(){c.a.prototype.deselect.apply(this,arguments),this.exitEditState()},destroy:function(){this.unbindLogic(),c.a.prototype.destroy.apply(this,arguments)}},{defaults:{current_type:"standard",center_lat:30,center_lng:-47,map_zoom:2,show_controls:!0,scrollwheel:!0}}),le=b.a.extend({onResize:function(t,e){b.a.prototype.onResize.apply(this,arguments),this.block.map&&window.google&&window.google.maps&&google.maps.event.trigger(this.block.map,"resize")}}),ce=se,de=i("lRGI"),he=i("Fts9"),ue=c.a.extend({name:"Button",sort_index:7,thumb:"button",icon_color:"#c80000",viewport_fields:m.b.viewport_fields.button,initial_controls:["button_settings","button_icon","button_edit","picture_link","common_animation","common_position","common_layer","common_lock"],MIN_FONT_SIZE:8,MAX_FONT_SIZE:999,MIN_LETTER_SPACING:-99,MAX_LETTER_SPACING:999,DEFAULT_BACKGROUND_COLOR:"c80000",RASTERIZE_MULTIPLIER:2,settingsOnCreate:!1,initialize:function(t,e){this.mag=e.mag,this.initBlock(t,e),this.isEditMode=!1,this.buttonState="default",this._oldAttrs=D.a.clone(this.model.attributes),this.onTextInput.__debounced=D.a.debounce(this.onTextInput,20),this.onIconChange.__debounced=D.a.debounce(this.onIconChange,20),this.onIconColorChange.__debounced=D.a.debounce(this.onIconColorChange,20),this.recalcIconContainerSize.__debounced=D.a.debounce(this.recalcIconContainerSize,20),this.onTextContainerSizeChange.__debounced=D.a.debounce(this.onTextContainerSizeChange,20),this.rasterizeSVG.__debounced_default=D.a.debounce(this.rasterizeSVG,100),this.rasterizeSVG.__debounced_hover=D.a.debounce(this.rasterizeSVG,100),this.rasterizeSVG.__debounced_current=D.a.debounce(this.rasterizeSVG,100),this.rasterizeSVG.__debounced_both=D.a.debounce(this.rasterizeSVG,100)},render:function(){var t,e=D.a.clone(this.model.attributes),i=e.tp;this.create(),this.$el.addClass("button"),t={model:e,$container:this.$content,environment:"constructor",mag:this.mag,block:this},this.buttonWidget=new de.a(t),this.$button=this.$(".common-button"),this.$textInput=this.$button.children(".text"),this.$buttonIcon=this.$button.children(".icon"),"icon"!==i&&"text_and_icon"!==i||this.getIconSVG(this.model.get("icon_noun_id")||this.model.get("icon_rm_id"),this.model.get("icon_noun_url"),function(t,e){!t&&e.$svg&&(this.renderIcon({$svg:this.getСoloredIconSVG()}),this.model.get("icon_rasterUrl")||this.rasterizeSVG({default:!0,hover:!0,current:!0}))}.bind(this)),this.recalcButtonSize(),this.disableTextInput(),this.handleSelectionColor(),this.bindDOMEvents(),this.bindModelEvents(),this.controls=this.initial_controls,this.frame.recalcPointsDirections(),this.model.created&&setTimeout(function(){this.enterEditMode({selectText:!0})}.bind(this),500),this.triggerReady()},redraw:function(t,e){return this.proportional&&t.get("w")!=t.get("h")&&this.recalcButtonSize(),c.a.prototype.redraw.apply(this,arguments)},bindDOMEvents:function(){this.$el.on("mousedown",this.onButtonMousedown),this.$button.on("dblclick",this.onButtonDoubleClick),this.$textInput.on("input",this.onTextInput)},unbindDOMEvents:function(){this.$el.off("mousedown",this.onButtonMousedown),this.$button.off("dblclick",this.onButtonDoubleClick),this.$textInput.off("input",this.onTextInput)},bindModelEvents:function(){this.model.on("change:tp",this.onTypeChange,this),this.model.on("change:form",(function(t,e,i){this.onFormChange(t,e,i)}),this),this.model.on("change:icon_enabled",this.determineButtonType,this),this.model.on("change:text",(function(t,e,i){(i.undo||i.redo||i.socketUpdate)&&this.$textInput.val(this.model.get("text"))}),this),this.model.on("change:text_w change:text_h",(function(){this.onTextContainerSizeChange()}),this);var t=this.getIndividualStyles();this.model.on(t,(function(){var t=D.a.clone(this.model.attributes);this.buttonWidget.generateIndividualStyleCSS({env:"constructor",model:t}),this.onTextInput()}),this),this.model.on("change:current-font-family change:current-font-weight change:current-font-style",(function(){this.waitOnExactWebFontLoaded()}),this),this.model.on("change:font-family change:font-weight change:font-style",(function(){this.waitOnExactWebFontLoaded()}),this),this.model.on("change:icon_enabled change:icon_noun_id change:icon_rm_id change:icon_noun_url",(function(t,e,i){this.onIconChange.__debounced(t,e,i)}),this),this.model.on("change:icon_h",(function(t,e,i){this.recalcIconContainerSize(t,e,i)}),this),this.model.on("change:icon_pos",(function(t,e,i){this.onIconPositionChange(),this.recalcButtonSize()}),this),this.model.on("change:icon_color change:icon_color_opacity",(function(t,e,i){this.onIconColorChange(t,e,i)}),this),this.model.on("change:hover-icon_color change:hover-icon_color_opacity",(function(t,e,i){this.onIconColorChange(t,e,i,"hover")}),this),this.model.on("change:current-icon_color change:current-icon_color_opacity",(function(t,e,i){this.onIconColorChange(t,e,i,"current")}),this)},getIndividualStyles:function(){var t=["background-color","background-color-opacity","border-radius","border-width","border-color","border-color-opacity","font-family","font-style","font-weight","color","color-opacity","font-size","letter-spacing","hover-background-color","hover-background-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","hover-color","hover-color-opacity","current-background-color","current-background-color-opacity","current-border-radius","current-border-width","current-border-color","current-border-color-opacity","current-color","current-color-opacity","current-font-family","current-font-style","current-font-weight","current-font-size","current-letter-spacing"];return t.forEach((function(t,e,i){i[e]="change:"+t})),t.join(" ")},onFormChange:function(t,e,i){var n=!1;if(!i.undo&&!i.redo){this.model.get("form");n=!0}this.recalcButtonSize({onFormChange:!0,adjust_height_to_content_for_rectangle:n})},onIconPositionChange:function(){this.buttonWidget.applyIconContainerSize(D.a.clone(this.model.attributes)),this.buttonWidget.applyIconPosition(D.a.clone(this.model.attributes))},onTextContainerSizeChange:function(){this.buttonWidget.applyTextContainerSize(D.a.clone(this.model.attributes))},onIconColorChange:function(t,e,i,n){if(n=n||"default","text"!==this.model.get("tp")&&(this.renderIcon({$svg:this.getСoloredIconSVG({buttonState:n})}),!(i.onIconChange||i.undo||i.redo))){var o=this.rasterizeSVG["__debounced_"+n];if(D.a.isFunction(o)){var a={};a[n]=!0,o(a)}}},"getСoloredIconSVG":function(t){t=t||{};var e,i,n,o,a=D.a.clone(this.model.attributes),r=this.currentIconData.$svg.clone();return"hover"===(e="default"===t.buttonState?"default":"hover"===t.buttonState||"hover"===this.buttonState?"hover":"current"===t.buttonState||"current"===this.buttonState?"current":"default")?(i=a["hover-icon_color"],n=a["hover-icon_color_opacity"]/100):"current"===e?(i=a["current-icon_color"]||a.icon_color,n=(D.a.isUndefined(a["current-icon_color_opacity"])?a.icon_color_opacity:a["current-icon_color_opacity"])/100):(i=a.icon_color,n=a.icon_color_opacity/100),o=v.default.getRGBA(i,1),r.find("*:not(.fixed-color)").each((function(){var t=Object(l.a)(this);t.css({fill:"","fill-opacity":""}),t.get(0).removeAttribute("fill"),t.get(0).removeAttribute("fill-opacity")})),r.get(0).setAttribute("fill",o),r.get(0).setAttribute("fill-opacity",n),r},onWorkspaceBlocksSelect:function(t){if(c.a.prototype.onWorkspaceBlocksSelect.apply(this,arguments),this.rendered){var e=t&&1==t.length&&t[0]==this;this.isEditMode&&!e&&(this.leaveEditMode({deselectControl:!0,saveWidgetData:!0}),this.workspace.trigger("redraw"))}},onButtonMousedown:function(t){this.isEditMode&&!Object(l.a)(t.target).is(".text")&&this.leaveEditMode({deselectControl:!0,saveWidgetData:!0})},onButtonDoubleClick:function(){this.model.get("pack_id")?c.a.prototype.onDblClick.apply(this,arguments):this.selected&&!this.isEditMode&&this.enterEditMode({selectText:!0})},enterEditMode:function(t){t=t||{},this.isEditMode=!0,this.determineButtonType({enter_edit_mode:!0}),this.enableTextInput(),t.selectText?this.$textInput.select():Object(l.a)(this.$textInput).focus().setCursorPos(0);var e,i=this.workspace&&this.workspace.controls;i&&(e=i.findControl("button_edit"))&&e.master.select(e)},leaveEditMode:function(t){if(t=t||{},this.model.set("text",this.$textInput.val()),this.isEditMode=!1,this.$textInput.blur(),this.disableTextInput(),this.determineButtonType(),t.saveWidgetData&&this.saveWidgetData(),t.deselectControl){var e,i=this.workspace&&this.workspace.controls;if(!i)return;if(!(e=i.findControl("button_edit")))return;e.master.deselect()}},disableTextInput:function(){this.$textInput.attr("readonly",!0)},enableTextInput:function(){this.$textInput.removeAttr("readonly")},onTextInput:function(){this.recalcTextInputSize(),this.recalcButtonSize()},recalcTextInputSize:function(){var t,e,i,n,o=this.$button.hasClass("current")?"current-":"",a=D.a.clone(this.model.attributes),r=a["".concat(o,"font-size")],s=a["".concat(o,"letter-spacing")],c=a["".concat(o,"font-family")],d=a["".concat(o,"font-style")],h=a["".concat(o,"font-weight")];this.$textInputSizeAdjuster&&this.$textInputSizeAdjuster.length||(this.$textInputSizeAdjuster=Object(l.a)("<div/>"),this.$textInputSizeAdjuster.css({position:"absolute",left:"-9999px","white-space":"pre",width:"auto"}).appendTo(this.$textInput.parent())),this.$textInputSizeAdjuster[0].className=this.$textInput[0].className,this.$textInputSizeAdjuster.addClass("fake"),this.$textInputSizeAdjuster.text(this.$textInput.val()),this.$textInputSizeAdjuster.css({"font-family":c,"font-style":d,"font-weight":h,"font-size":r+"px","letter-spacing":s+"px"}),t=this.$textInputSizeAdjuster.width(),e=this.$textInputSizeAdjuster.height(),this.$textInputSizeAdjuster.css("letter-spacing",0).text("M"),i=this.$textInputSizeAdjuster.width(),i=2*Math.ceil(i/2),n=this.$textInputSizeAdjuster.height(),0===this.$textInput.val().trim().length&&(t=i,e=n),t=2*Math.ceil(t/2),t+=i,e=2*Math.ceil(e/2),this.model.set({text_w:t,text_h:e,em_w:i})},recalcButtonSize:function(t){t=t||{};var e,i,n,o,a,r=D.a.clone(this.model.attributes),s=r.tp,l=r.form,c=r.w,d=r.h,h=r.x,u=r.y,p=r.text_w,m=r.text_h,g=r.em_w,f=r.icon_w,v=r.icon_h,b=r.icon_pos,y={};"text_and_icon"===s?(i=p+f,i+=2*g,i+=this.buttonWidget.calcIconMarginFromText(f),"left"!==b&&"right"!==b||(v>m?(n=v,n+=2*this.buttonWidget.calcIconTopBottomMargin(v)):(n=m,n+=2*this.buttonWidget.calcTextTopBottomMargin(r["font-size"])))):"text"===s?(i=p,i+=2*g,n=m,n+=this.buttonWidget.calcTextTopBottomMargin(r["font-size"])):"icon"===s&&(i=f+(e=this.buttonWidget.calcIconMarginFromText(f)),n=v+e),i>c&&(o=i),n>d&&(a=n);c=o||c,d=a||d;var _=Math.floor((c-d)/2);"circle"===l||"square"===l?(c>d?D.a.extend(y,{w:c,h:c,y:u-_,x:h-Math.floor((c-this.model.get("w"))/2)}):D.a.extend(y,{w:d,h:d,x:h+_,y:u-(d-this.model.get("h"))/2}),this.proportional=!0):"rectangle"===l&&(o&&D.a.extend(y,{w:o,x:h-Math.floor((o-this.model.get("w"))/2)}),a?D.a.extend(y,{h:a,y:u-(a-this.model.get("h"))/2}):t.adjust_height_to_content_for_rectangle&&D.a.extend(y,{h:n,y:u+Math.floor(((o||c)-n)/2)}),this.proportional=!1),t.onFormChange&&this.$el.addClass("resize-transition"),y.w&&"circle"===l?this.buttonWidget.applyCircleRadius():this.$button.css("border-radius",""),this.model.set(y),setTimeout(function(){window.requestAnimationFrame(function(){this.$el.removeClass("resize-transition")}.bind(this))}.bind(this),450),this.setSizeConstraints(i,n)},setSizeConstraints:function(t,e){D.a.extend(this.frame,{minwidth:t,maxwidth:9999,minheight:e,maxheight:9999})},determineButtonType:function(t){t=t||{};var e,i=this.model.get("icon_enabled"),n=!!t.enter_edit_mode||this.$textInput.val().trim().length;e=i&&n?"text_and_icon":i&&!n?"icon":"text",this.model.set("tp",e)},onTypeChange:function(){this.buttonWidget.applyIconContainerSize(D.a.clone(this.model.attributes)),this.buttonWidget.applyButtonType(this.model.get("tp")),this.recalcButtonSize()},waitOnExactWebFontLoaded:function(){var t=D.a.clone(this.model.attributes);D.a.indexOf(mt.a.systemFontsList,t["font-family"].toLowerCase())>-1||B.a.exactWaitForFontLoad(t["font-family"],t["font-weight"],t["font-style"],this.onTextInput)},saveWidgetData:function(){D.a.isEqual(this.model.toJSON(),this._oldAttrs)||(this.saveXHR&&this.saveXHR.abort(),this._oldAttrs=D.a.clone(this.model.toJSON()),this.saveXHR=this.model.save())},deselect:function(t){c.a.prototype.deselect.apply(this,arguments),t!=this&&this.isEditMode&&(this.leaveEditMode({saveWidgetData:!0}),this.workspace.trigger("redraw"))},getSaveBoxOptions:function(t){return D.a.extend({patch:!0},t)},destroy:function(){this.buttonWidget&&this.buttonWidget.destroy(),this.buttonWidget=null,this.unbindDOMEvents(),this.model.off(null,null,this),c.a.prototype.destroy.apply(this,arguments)},MAX_ICON_CACHE_SIZE:30,onIconChange:function(t,e,i){t=D.a.clone(this.model.attributes),this.getIconSVG(t.icon_noun_id||t.icon_rm_id,t.icon_noun_url,function(t,e){!t&&e.$svg&&(i.undo||i.redo||this.recalcIconContainerSize(null,null,{onIconChange:!0}),this.renderIcon({$svg:this.getСoloredIconSVG()}),i.undo||i.redo||this.rasterizeSVG({default:!0,hover:!0,current:!0}))}.bind(this))},areValuesLinked:function(t,e,i,n){var o=D.a.clone(this.model.attributes),a="default"===e?"":e+"-";return o[("default"===t?"":t+"-")+i]==o[a+(n||i)]},isTextAndIconColorLinked:function(t,e){return t=t||"default",(e=e||{}).compare_only_color?this.areValuesLinked(t,t,"color","icon_color"):this.areValuesLinked(t,t,"color","icon_color")&&this.areValuesLinked(t,t,"color-opacity","icon_color_opacity")},isTextAndIconSizeLinked:function(t){return t=t||"default",this.areValuesLinked(t,t,"font-size","icon_h")},recalcIconContainerSize:function(t,e,i){if("text"!==this.model.get("tp")){var n,o=this.model.get("icon_h");n=Math.floor(o*this.currentIconData.aspect_ratio),this.model.set({icon_w:n}),this.recalcButtonSize(),this.buttonWidget.applyIconContainerSize(D.a.clone(this.model.attributes)),i.onIconChange||i.undo||i.redo||this.rasterizeSVG.__debounced_both({default:!0,hover:!0,current:!0})}},rasterizeSVG:function(t){if((t=t||{}).default||t.hover||t.current){var e=function(e){e=e||"default";var i=this.getСoloredIconSVG({buttonState:e});if(i||i.length){var n={default:"icon",hover:"hover-icon",current:"current-icon"},o=D.a.isUndefined(n[e])?n.default:n[e],a={width:this.model.get("icon_w")*this.RASTERIZE_MULTIPLIER,height:this.model.get("icon_h")*this.RASTERIZE_MULTIPLIER},r=e+"_icon_SVG_rasterize_Xhr";this[r]&&this[r].abort();var s=t[e+"Callback"];this[r]=Lt.rasterize({widgets:[this.model],svg:i,mid:this.workspace.mag.get("_id"),viewport:this.model.getViewport(),size:a,prefix:o,onSuccess:function(t){s&&s(null,t)},onError:function(t){s&&s(t)}})}}.bind(this);t.default&&e("default"),t.hover&&e("hover"),t.current&&e("current")}},renderIcon:function(t){var e;e=(t=t||{}).$svg?t.$svg:this.getСoloredIconSVG(),this.$buttonIcon.empty().html(e.clone())},getDefaultIconSVG:function(){return this.prepareIconSVG(Object(l.a)('<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="283.5px" height="283.5px" viewBox="0 0 283.5 283.5" enable-background="new 0 0 283.5 283.5" xml:space="preserve"><g><g><path fill-rule="evenodd" clip-rule="evenodd" fill="#231F20" d="M258.3,114.1c-14.1,0-23.1,25-30.1,33.8 c-7,8.8-33.3,2.7-44.1,0.7c-10.7-2.1-38.7-3.9-38.7-3.9s47.4-18,47.4-65c0-47.7-54.9-75.3-73.5-78.1c-17-2.8-23.8,5.6-25.4,7.8 c-1.6,2.2-4.2,4.1-8,5.9c-3.9,1.8-1.5-0.1-15.4,9.8c-13.9,9.8-41.8-4-44.1-4.6c-2.3-0.5-6.8-1.8-8,4.6c-1.5,9.6,6.7,25.4,6.7,25.4 s-2.2,0.2-8,3.3c-5.8,3.1-2.8,7.7-1.3,9.1c1.4,1.4,27.9,16.3,32.1,18.9c10.6,5.3,20.3,31.6-7.3,51.4C-3.1,163,0.4,198.7,0.4,198.7 s-12,85.2,126.9,85.2c139,0,155.6-96.1,155.6-124.2C283,131.5,272.4,114.1,258.3,114.1z M89.5,50.2c-7.1,6.5-15.7,8-19.3,3.5 c-3.6-4.6-0.7-13.5,6.3-20c7.1-6.5,15.7-8,19.3-3.5C99.4,34.7,96.6,43.7,89.5,50.2z M76.1,38.9c-4.7,4.3-6.6,10.3-4.2,13.3 c2.4,3,8.1,2,12.9-2.3c4.7-4.3,6.6-10.3,4.2-13.3C86.6,33.6,80.9,34.6,76.1,38.9z"/></g></g></svg>'))},getIconSVG:function(t,e,i){var n,o,a;if(this.iconXhr&&this.iconXhr.abort(),!t){var r=this.getDefaultIconSVG();return a={$svg:r,noun_url:null,aspect_ratio:r.data("aspect_ratio")},this.currentIconData=a,i(null,a)}if(n=this.getSVGCacheItem(t))return a={$svg:n.$svg,noun_url:n.noun_url,aspect_ratio:n.$svg.data("aspect_ratio")},this.currentIconData=a,i(null,a);var s=function(e){var n=Object(l.a)("<div></div>").append(Object(l.a)(e.svg)).find("svg");if(n.length)return n=this.prepareIconSVG(n),a={id:t,$svg:n,noun_url:e.new_url,aspect_ratio:n.data("aspect_ratio")},this.currentIconData=a,this.cacheSVGData(a),i(null,{$svg:n,noun_url:e.new_url})}.bind(this);o={method:"POST",url:"/api/authservice/noun/icon",data:{id:t,url:e},dataType:"json",success:function(t){this.iconRequestInProgress=!1,s(t)},error:function(t){return this.iconRequestInProgress=!1,i(t)},context:this},/^rm/.test(t)&&D.a.extend(o,{method:"GET",url:e,cache:!1,success:function(t){this.iconRequestInProgress=!1,s({svg:Object(l.a)(t).find("svg"),new_url:e})},data:null,dataType:null}),this.iconRequestInProgress=!0,this.iconXhr=l.a.ajax(o)},prepareIconSVG:function(t){var e=t.clone().appendTo(Object(l.a)("body")),i=t.clone();e.get(0).setAttributeNS(null,"viewBox","0 0 "+e.width()+" "+e.height());var n=e.get(0).getBBox();return e.remove(),i.data("aspect_ratio",n.width/n.height),i.removeAttr("width"),i.removeAttr("height"),i.get(0).setAttributeNS(null,"viewBox",n.x+" "+n.y+" "+n.width+" "+n.height),i.get(0).setAttributeNS(null,"preserveAspectRatio","xMidYMid meet"),i.css({width:"100%",height:"100%"}),i},cacheSVGData:function(t){window.iconSVGCache.push(t),window.iconSVGCache.length>this.MAX_ICON_CACHE_SIZE&&window.iconSVGCache.shift()},getSVGCacheItem:function(t){return window.iconSVGCache&&D.a.findWhere(window.iconSVGCache,{id:t})},handleSelectionColor:function(t){t=t||he.a.prototype.hex2rgb(this.model.get("background-color")).concat(1);var e=he.a.prototype.hex2rgb(this.DEFAULT_BACKGROUND_COLOR).concat(1);this.$button.toggleClass("is-contrast-selection",he.a.prototype.areColorsClose(t,e))}},{defaults:{tp:"text",form:"rectangle",text:"Edit",w:134,h:50,x:"center",transition:!1,text_w:48,text_h:26,em_w:16,"background-color":"c80000","background-color-opacity":100,"border-radius":5,"border-width":0,"border-color":"000000","border-color-opacity":100,"font-family":"Arial","font-style":"normal","font-weight":400,color:"ffffff","color-opacity":100,"font-size":18,"letter-spacing":0,"hover-background-color":"c80000","hover-background-color-opacity":80,"hover-border-width":0,"hover-border-color":"000000","hover-border-color-opacity":100,"hover-color":"ffffff","hover-color-opacity":100,"current-background-color":"c80000","current-background-color-opacity":100,"current-border-radius":5,"current-border-width":0,"current-border-color":"000000","current-border-color-opacity":100,"current-font-family":"Arial","current-font-style":"normal","current-font-weight":400,"current-color":"ffffff","current-color-opacity":100,"current-font-size":18,"current-letter-spacing":0,icon_enabled:!1,icon_h:18,icon_w:18,icon_pos:"left",icon_noun_id:null,icon_rm_id:null,icon_noun_url:null,icon_color:"ffffff",icon_color_opacity:100,"hover-icon_color":"ffffff","hover-icon_color_opacity":100,"current-icon_color":"ffffff","current-icon_color_opacity":100,icon_rasterUrl:null,icon_raster2xUrl:null,"hover-icon_rasterUrl":null,"hover-icon_raster2xUrl":null,"current-icon_rasterUrl":null,"current-icon_raster2xUrl":null}}),pe=i("cBBe"),me=i("U72E"),ge=i.n(me),fe=a.a.View.extend({initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};D.a.bindAll(this),(t.positions||t.positions.length)&&(this.positions=t.positions,this.workspace_inside_block=t.workspace_inside_block,this.render(),this.bind_events())},render:function(){this.resize_handles_fragment=window.document.createDocumentFragment(),this.positions.forEach(D.a.bind((function(t){Object(l.a)("<div/>").addClass("resize-handle").addClass(t).attr("data-pos",t).appendTo(this.resize_handles_fragment)}),this)),this.workspace_inside_block.$el.append(this.resize_handles_fragment),this.$resize_handles=this.workspace_inside_block.$el.children(".resize-handle"),this.apply_resize_handles_visual_state()},apply_resize_handles_visual_state:function(){var t=this.workspace_inside_block.block.model.get("tip_pos"),e=this.workspace_inside_block.get_visible_blocks();if(e.length){var i=D.a.find(e,(function(t){return"picture"===t.model.get("type")}));if(this.$resize_handles.removeClass("hidden"),i&&!1===i.originalLoaded)this.$resize_handles.addClass("hidden");else if(1===e.length){var n=e[0].model.get("type");"text"===n&&(this.$resize_handles.filter('[data-pos="bottom"]').addClass("hidden"),this.$resize_handles.filter('[data-pos="top"]').addClass("hidden"))}"top"===t?this.$resize_handles.filter('[data-pos="bottom"]').addClass("hidden"):"right"===t?this.$resize_handles.filter('[data-pos="left"]').addClass("hidden"):"bottom"===t?this.$resize_handles.filter('[data-pos="top"]').addClass("hidden"):"left"===t&&this.$resize_handles.filter('[data-pos="right"]').addClass("hidden")}else this.$resize_handles.addClass("hidden")},bind_events:function(){Object(l.a)(this.$resize_handles).drag("start",this.on_resize_start).drag(this.on_resize).drag("end",this.on_resize_end),this.listenTo(this.workspace_inside_block.block.model,"change:tip_pos",this.apply_resize_handles_visual_state),this.listenTo(this.workspace_inside_block.block.model,"change:wids",this.apply_resize_handles_visual_state),this.listenTo(this.workspace_inside_block.block.model.widgets_collection,"change:hidden",this.apply_resize_handles_visual_state),this.listenTo(this.workspace_inside_block,"loading_original_picture",this.apply_resize_handles_visual_state)},on_resize_start:function(t,e){var i=Object(l.a)(t.currentTarget),n=i.data("pos"),o=this.workspace_inside_block.get_box_data(),a=this.workspace_inside_block.min_width,r=this.workspace_inside_block.min_height,s=null,c=this.workspace_inside_block.get_visible_blocks();e.scrollTop=this.workspace_inside_block.page_workspace.$container.scrollTop();var d=D.a.find(c,(function(t){return"picture"===t.model.get("type")})),h=D.a.find(c,(function(t){return"text"===t.model.get("type")}));if(!h||!h.isEditMode){if("top"===n||"bottom"===n)if(c.length>1)(h=D.a.find(c,(function(t){return"text"===t.model.get("type")})))&&(r=h.getBoxData().h+this.workspace_inside_block.min_height);if(d){d.model.off("change",d.redraw);var u=o,p=d.model.get("scale"),m={left:u.left_abs+parseInt(d.$el.css("left"))-Math.round(d.model.get("cropX")*p),top:u.top_abs+parseInt(d.$el.css("top"))-Math.round(d.model.get("cropY")*p)};d.initialCrop=m;var g=d.model.get("originalW"),f=d.model.get("originalH");d.frame.constraints={top:m.top,left:m.left,width:Math.round(g*p),height:Math.round(f*p)},s=d.frame.constraints}this.resize_params={$handle:i,handle_pos:n,box_on_drag_start:o,box_position:this.workspace_inside_block.block.model.get("tip_pos"),min_height:r,min_width:a,max_width:9999,max_height:9999,constraints:s,visible_blocks:c,max_block_height:this.workspace_inside_block.block.model.get("tip_h"),picture_block:d,picture_initial_crop_on_drag_start:d&&D.a.clone(d.initialCrop),text_block:h}}},on_resize:function(t,e){var i,n=this.resize_params.handle_pos,o=D.a.clone(this.resize_params.box_on_drag_start),a=e.startY+e.scrollTop,r=t.pageY+this.workspace_inside_block.page_workspace.$container.scrollTop();e.deltaY=r-a,this.resize_params.constraints&&(i=this.resize_params.constraints);var s=this.resize_params.visible_blocks,c=this.resize_params.picture_block,d=this.resize_params.text_block;if(!d||!d.isEditMode){var h=0,u=this.resize_params.box_position;if("top"===n||"bottom"===n?"top"===n?(o.top_abs+=e.deltaY,o.height-="left"===u||"right"===u?2*e.deltaY:e.deltaY):"bottom"===n&&("left"===u||"right"===u?(o.top_abs-=e.deltaY,o.height+=2*e.deltaY):o.height+=e.deltaY):"left"!==n&&"right"!==n||("left"===n?"top"===u||"bottom"===u?(o.left_abs+=e.deltaX,o.width-=2*e.deltaX):(o.left_abs+=e.deltaX,o.width-=e.deltaX):"right"===n&&("top"===u||"bottom"===u?(o.left_abs-=e.deltaX,o.width+=2*e.deltaX):o.width+=e.deltaX)),o.height<this.resize_params.min_height?("left"===u||"right"===u?o.top_abs-=(this.resize_params.min_height-o.height)/2:"top"===u&&(o.top_abs-=this.resize_params.min_height-o.height),o.height=this.resize_params.min_height):o.height>this.resize_params.max_height&&(o.height=this.resize_params.max_height),o.width<this.resize_params.min_width?("top"===u||"bottom"===u?o.left_abs-=(this.resize_params.min_width-o.width)/2:"left"===u&&(o.left_abs-=this.resize_params.min_width-o.width),o.width=this.resize_params.min_width):o.width>this.resize_params.max_width&&(o.width=this.resize_params.max_width),"left"===n||"right"===n){if(s.forEach((function(t){var e=t.getBoxData();t.frame.doResize({left:e.x,top:e.y,width:o.width,height:e.h},!1)})),d){if(c){var p=d.getBoxData();o.height-=p.h,"top"===u?o.top_abs+=p.h:"left"!==u&&"right"!==u||(o.top_abs+=p.h/2)}if(d.$el.find(".text-preview").children().each((function(){h+=Object(l.a)(this).outerHeight()})),p=d.getBoxData(),d.frame.doResize({left:p.x,top:p.y,width:p.w,height:h},!1),c){o.height+=h,"top"===u?o.top_abs-=h:"left"!==u&&"right"!==u||(o.top_abs-=h/2);var m=c.getBoxData(),g=o.top_abs+m.y-Math.round(c.model.get("cropY")*c.model.get("scale"));c.$backpic&&c.$backpic.css("top",g),c.initialCrop.top=g,c.frame.constraints.top=g}else o.height=h;this.resize_params.box_on_drag_start.height=o.height,this.resize_params.box_on_drag_start.top_abs=o.top_abs}}else if(("top"===n||"bottom"===n)&&c){var f=D.a.reject(s,(function(t){return"picture"===t.model.get("type")})),v=o.height;f.forEach((function(t){var e=t.getBoxData();v-=e.h}));var b=c.getBoxData();c.frame.doResize({left:b.x,top:b.y,width:b.w,height:v},!1)}if(this.workspace_inside_block.block.workspace.set_group([{_id:this.workspace_inside_block.block.model.get("_id"),tip_w:o.width,tip_h:o.height}],{viewport:"default",forceDefaultViewport:!0}),i){var y={width:o.width,height:o.height,left_abs:o.left_abs,top_abs:o.top_abs},_=this.resize_params.picture_initial_crop_on_drag_start;if(d&&(p=d.getBoxData(),y.height-=p.h),("left"===n||"right"===n)&&y.width>=i.width){var w=(m=c.getBoxData()).x,k=m.y,S=m.h,x=y.width,C=c.model.get("originalW"),O=c.model.get("originalH"),j=C/O,P={},E=null,I={};c.model.get("ratio")>j?(E=x/C,P={cropX:0,cropY:Math.round((O-S/E)/2),cropW:C,cropH:Math.round(S/E)},I={width:x,height:Math.round(x/j),top:-Math.round(P.cropY*E),left:0}):(E=S/O,P={cropX:0,cropY:0,cropW:Math.round(x/E),cropH:O},I={width:Math.max(Math.round(S*j),y.width),height:S,top:0,left:0}),c.model.set(D.a.extend({scale:E.toFixed(15),ratio:(x/S).toFixed(5)},P),{skipHistory:!0}),c.$picture&&c.$picture.css(I);var T={width:I.width,height:I.height,top:y.top_abs+k+I.top,left:y.left_abs+w+I.left};c.$backpic&&c.$backpic.css(T),c.initialCrop={top:y.top_abs+k+I.top,left:y.left_abs+w+I.left},c.frame.constraints=T}else if(("top"===n||"bottom"===n)&&y.height>=i.height)w=(m=c.getBoxData()).x,k=m.y,S=y.height,x=m.w,j=(C=c.model.get("originalW"))/(O=c.model.get("originalH")),P={},E=null,I={},c.model.get("ratio")>j?(E=x/C,P={cropX:0,cropY:0,cropW:C,cropH:Math.round(S/E)},I={width:x,height:Math.max(Math.round(x/j),y.height),top:0,left:0}):(E=S/O,P={cropX:Math.round((C-x/E)/2),cropY:0,cropW:Math.round(x/E),cropH:O},I={width:Math.round(S*j),height:S,top:0,left:-Math.round(P.cropX*E)}),c.model.set(D.a.extend({scale:E.toFixed(15),ratio:(x/S).toFixed(5)},P),{skipHistory:!0}),c.$picture.css(I),T={width:I.width,height:I.height,top:y.top_abs+k+I.top,left:y.left_abs+w+I.left},c.$backpic&&c.$backpic.css(T),c.initialCrop={top:y.top_abs+k+I.top,left:y.left_abs+w+I.left},c.frame.constraints=T;else if(y.left_abs+y.width>i.left+i.width){var M=i.left+i.width-y.left_abs-y.width;c.initialCrop.left=_.left-M,c.$backpic&&c.$backpic.css("left",c.initialCrop.left),m=c.getBoxData(),c.onCropResize({width:m.w,height:m.h,left:m.x,top:m.y})}else y.left_abs<i.left?(M=i.left-y.left_abs,c.initialCrop.left=_.left-M,c.$backpic&&c.$backpic.css("left",c.initialCrop.left),m=c.getBoxData(),c.onCropResize({width:m.w,height:m.h,left:m.x,top:m.y})):y.top_abs<i.top?(M=i.top-o.top_abs,c.initialCrop.top=_.top-M,c.$backpic&&c.$backpic.css("top",c.initialCrop.top),m=c.getBoxData(),c.onCropResize({width:m.w,height:m.h,left:m.x,top:m.y})):y.top_abs+y.height>i.top+i.height?(M=i.top+i.height-(y.top_abs+y.height),c.initialCrop.top=_.top-M,c.$backpic&&c.$backpic.css("top",c.initialCrop.top),m=c.getBoxData(),c.onCropResize({width:m.w,height:m.h,left:m.x,top:m.y})):(m=c.getBoxData(),c.onCropResize({width:m.w,height:m.h,left:m.x,top:m.y}))}}},on_resize_end:function(t){var e,i=[{_id:this.workspace_inside_block.block.model.get("_id"),tip_w:this.workspace_inside_block.block.model.get("tip_w"),tip_h:this.workspace_inside_block.block.model.get("tip_h")}];this.resize_params.visible_blocks.forEach(function(t){t._justResized=!0;var n=D.a.extend({_id:t.model.get("_id")},t.getBoxData());"picture"===t.model.get("type")&&(e=t,D.a.extend(n,{cropX:t.model.get("cropX"),cropY:t.model.get("cropY"),cropW:t.model.get("cropW"),cropH:t.model.get("cropH"),ratio:t.model.get("ratio"),scale:t.model.get("scale")}),!t.isAnimated()&&!t.useLambdaUrl()&&t.getFinalImage((function(t){t&&console.log("w-picture getFinalImage error: ",t)}),{silent:!0,patch:!0})),i.push(n),t.model.set(n,{skipHistory:!0,forceDefaultViewport:!0})}.bind(this)),this.workspace_inside_block.block.workspace.save_group(i,{isHotspot:!0,viewport:"default",forceDefaultViewport:!0}),e&&e.model.on("change",e.redraw)},show:function(){this.workspace_inside_block.$el.addClass("resize-handles-visible")},hide:function(){this.workspace_inside_block.$el.removeClass("resize-handles-visible")},destroy:function(){this.resize_handles_fragment&&Object(l.a)(this.resize_handles_fragment).remove(),this.stopListening()}}),ve=i("1ljF"),be=i.n(ve),ye=a.a.View.extend({events:{"click .widget":"on_widget_select"},initialize:function(t){D.a.bindAll(this),this.workspace=t.workspace_inside_block,this.model=this.workspace.block.model,this.$container=t.$container||this.workspace.$el,this.template=be.a["template-constructor-workspace-inside-block-widget-selector"],this.render(),this.bind_events()},render:function(){this.setElement(Object(l.a)(this.template())),this.$el.appendTo(this.$container),this.updateSelectorStateAndPos()},bind_events:function(){this.listenTo(this.model,"change:tip_pos",this.updateSelectorStateAndPos),this.listenTo(this.model,"change:wids",(function(){this.$el.data("processing",!1),this.updateSelectorStateAndPos()})),this.listenTo(this.model.widgets_collection,"change:hidden",(function(){this.$el.data("processing",!1),this.updateSelectorStateAndPos()}))},updateSelectorStateAndPos:function(t){var e=this.$(".widget"),i=this.workspace.get_visible_blocks(),n=!D.a.isEmpty(i);e.removeClass("enabled"),D.a.each(i,D.a.bind((function(t){e.filter("[data-block-type="+t.model.get("type")+"]").addClass("enabled")}),this)),this.workspace.$el.toggleClass("no-widgets",!n),this.$el.toggleClass("compact",!!n).toggleClass("right-pos",!(!n||"left"!==this.model.get("tip_pos"))),this.$el.css({left:n?"":this.model.get("tip_w")/2-this.$el.width()/2+"px"})},on_widget_select:function(t){if(this.workspace.trigger("deselect"),this.workspace.page_workspace.controls.hide(),!this.$el.data("processing")){this.$el.data("processing",!0);var e=Object(l.a)(t.currentTarget).data("block-type"),i=D.a.filter(this.workspace.blocks,(function(t){return t.model.get("type")===e}))[0];if(i)if(i.model.get("hidden")){var n=i.frame.doResize({left:i.model.get("x"),top:i.model.get("y"),width:this.workspace.get_box_data().width,height:i.model.get("h")},!1);if("picture"===i.model.get("type")){var o,a=n.width,r=i.getBoxData().h,s={},c={},d=i.model.get("originalW")/i.model.get("originalH");i.model.get("ratio")>d?(o=a/i.model.get("originalW"),s={cropX:0,cropY:Math.round((i.model.get("originalH")-r/o)/2),cropW:i.model.get("originalW"),cropH:Math.round(r/o)},c={width:a,height:Math.round(a/d),top:-Math.round(s.cropY*o),left:0}):(o=r/i.model.get("originalH"),s={cropX:Math.round((i.model.get("originalW")-a/o)/2),cropY:0,cropW:Math.round(a/o),cropH:i.model.get("originalH")},c={width:Math.round(r*d),height:r,top:0,left:-Math.round(s.cropX*o)}),i.model.set(D.a.extend({w:a,h:r,scale:o.toFixed(15),ratio:(a/r).toFixed(5)},s),{silent:!0}),i.$picture&&i.$picture.css(c)}else if("text"===i.model.get("type")){var h=0;i.$el.find(".text-preview").children().each((function(){h+=Object(l.a)(this).outerHeight()}));var u=i.getBoxData();i.frame.doResize({left:u.x,top:u.y,width:u.w,height:h},!1),i.model.set(i.getBoxData(),{silent:!0})}i.model.save({hidden:!1},{toHistory:!0}),"picture"===i.model.get("type")&&(i.in_constrained_crop_mode=!1,i.enter_constrained_crop_mode()),i.select(),this.workspace.trigger("select")}else i.model.save({hidden:!0},{toHistory:!0});else this.workspace.add_widget({type:e,w:this.model.get("tip_w"),h:"picture"===e?180:"text"===e?54:400}),"picture"===e&&this.workspace.$picture_upload_input.trigger("click")}},destroy:function(){this.remove()}});function _e(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function we(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(i),!0).forEach((function(e){ke(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ke(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var Se={text:Object(d.a)("constructor.textv3")?R:et,picture:$t},xe=we(we({},ge.a),St.a),Ce=a.a.View.extend({template:xe["template-constructor-workspace-inside-block"],initialize:function(t){D.a.bindAll(this),this.block=t.block,this.page_workspace=t.page_workspace,this.controls=this.page_workspace.controls,this.mag=this.page_workspace.mag,this.page=this.page_workspace.page,this.blocks=[],this.$container=t.$container,this.block.child_workspace=this,this.resize_handles_positions=t.resize_handles_positions,this.min_width=t.min_width||100,this.min_height=t.min_height||10,this.block.model.widgets_collection.forEach(function(t){this.block.model.get("wids").indexOf(t.get("_id"))>-1&&this.addBlock(t)}.bind(this)),this.trigger_select_on_selected_block.__debounced=D.a.debounce(this.trigger_select_on_selected_block,0),this.restoreFocusForCopyPaste.__debounced=D.a.debounce(this.restoreFocusForCopyPaste,0),this.saveDebounced=D.a.debounce(this.save,100),this.render(),this.bind_events()},render:function(){this.rendered=!0,this.setElement(Object(l.a)(this.template())),this.$blocksWrapper=this.$el.find(".blocks-wrapper"),this.$el.addClass("tip");var t=xe["template-constructor-helpers-upload-input"];this.$picture_upload_input=Object(l.a)(t()),this.$picture_upload_input.appendTo(this.$el),this.$el.appendTo(this.$container),this.block.apply_tip_container_size({width:this.block.model.get("tip_w"),height:this.block.model.get("tip_h")}),this.block.apply_tip_position(),this.block.apply_tip_bg_color(),this.block.apply_tip_box_shadow(),this.block.apply_tip_border_radius(),this.blocks.map(this.renderBlock),this.resize_handles_manager=new fe({workspace_inside_block:this,positions:this.resize_handles_positions}),this.widget_selector=new ye({workspace_inside_block:this,container:this.$el})},bind_events:function(){this.listenTo(this.block.model,"change:w change:h change:tip_pos",this.block.apply_tip_position),this.listenTo(this.block.model,"change:tip_w change:tip_h",this.on_tip_size_change),this.listenTo(this.block.model,"widget:create",this.createBlock),this.listenTo(this.block.model,"widget:remove",this.removeBlock),this.listenTo(this.block.model,"change:wids",(function(t,e,i){i.socketUpdate||i.resetPage||(this.adjust_height_to_visible_content(),this.adjust_column_widgets_positioning(),this.block.apply_tip_position(),i.undo||i.redo||this.block.model.save({wids:this.block.model.get("wids"),tip_h:this.block.model.get("tip_h")},{patch:!0,forceDefaultViewport:!0}),this.blocks.forEach((function(t){t.saveBox({patch:!0,skipHistory:!0})})))})),this.listenTo(this.block.model.widgets_collection,"change:hidden",(function(t,e,i){this.adjust_height_to_visible_content(),this.adjust_column_widgets_positioning(),this.block.apply_tip_position();var n=[{_id:this.block.model.get("_id"),tip_w:this.block.model.get("tip_w"),tip_h:this.block.model.get("tip_h")}];this.blocks.forEach(function(t){var e=D.a.extend({_id:t.model.get("_id"),hidden:t.model.get("hidden")},t.getBoxData());"picture"===t.model.get("type")&&(D.a.extend(e,{cropX:t.model.get("cropX"),cropY:t.model.get("cropY"),cropW:t.model.get("cropW"),cropH:t.model.get("cropH"),ratio:t.model.get("ratio"),scale:t.model.get("scale")}),!t.isAnimated()&&!t.useLambdaUrl()&&t.getFinalImage((function(t){t&&console.log("w-picture getFinalImage error: ",t)}),{silent:!0,patch:!0})),n.push(e)}.bind(this)),this.block.workspace.save_group(n,{isHotspot:!0,skipHistory:!0,silent:!0,viewport:"default",forceDefaultViewport:!0})})),this.listenTo(this.page,"change:viewport",this.onChangeViewport),this.on("select",this.onSelect),this.on("w-text-entered-edit-mode",this.on_text_entered_edit_mode),this.on("w-text-before-leave-edit-mode",this.on_text_leaved_edit_mode),this.$el.on("click",this.onClick)},restoreFocusForCopyPaste:function(){Object(l.a)(".copyhack").selectText()},adjust_height_to_visible_content:function(t){t=t||{};var e=this.get_visible_blocks(),i=0;e.forEach((function(t){i+=t.getBoxData().h}));var n={_id:this.block.model.get("_id"),tip_h:i};t.save?(this.block.model.set(n,{skipHistory:!0}),this.saveDebounced({},{skipHistory:!0})):this.block.model.set(n,{skipHistory:!0})},adjust_column_widgets_positioning:function(){var t=D.a.sortBy(this.get_visible_blocks(),(function(t){return"picture"===t.model.get("type")?0:1})),e=0;t.forEach((function(t){t.model.set({x:0,y:e},{skipHistory:!0}),e+=t.getBoxData().h}))},on_tip_size_change:function(t,e,i){this.block.apply_tip_container_size({width:t.get("tip_w"),height:t.get("tip_h")}),this.adjust_column_widgets_positioning(),this.block.apply_tip_position()},on_text_entered_edit_mode:function(){this.resize_handles_manager.hide()},on_text_leaved_edit_mode:function(){this.resize_handles_manager.show(),this.fit_text_to_content(!0)},fit_text_to_content:function(t){var e=this.get_visible_blocks(),i=D.a.find(e,(function(t){return"text"===t.model.get("type")}));if(i){var n=i.model.get("h"),o=0;Object(d.a)("constructor.textv3")?o=i.getRealContentHeight():i.$iframe_body.children().each((function(){o+=Object(l.a)(this).outerHeight()})),n!==(o=D.a.max([o,10]))&&(i.model.set("h",o,{skipHistory:!0}),this.adjust_height_to_visible_content({save:!0}))}},createBlock:function(t,e){var i=this.addBlock(t);this.renderBlock(i),e.undo||e.redo||e.group||(i.select(),e.copy||this.trigger_select_on_selected_block.__debounced())},trigger_select_on_selected_block:function(){var t=this.getSelectedBlocks();t&&t.length&&this.trigger("select",t)},addBlock:function(t){var e=t.get("type"),i=new(0,Se[e])(t,this);return i.immortal=!0,"text"===t.get("type")?(i.controls=[],i.edit_controls=D.a.without(i.edit_controls,"text_columns","text_columns_new")):"picture"===t.get("type")&&(i.initial_controls=["picture_crop","picture_link"],i.vector_controls=["picture_color","picture_link"],i.animated_controls=["picture_crop","picture_link"]),this.listenTo(i,"all",this.passChildBlockEvent),this.blocks.push(i),i},passChildBlockEvent:function(t,e){var i=Array.prototype.slice.call(arguments,1);this.trigger("childBlockEvent",t,i)},renderBlock:function(t){t.render(),t.redrawPosition(t.model,{forceRedraw:!0}),Object(d.a)("constructor.textv3")&&"text"===t.model.get("type")&&this.adjust_height_to_visible_content()},add_widget:function(t,e){var i=Se[(t=t||{}).type.toLowerCase()];D.a.defaults(t,D.a.mapObject(D.a.cloneWithObjects(i.defaults),(function(t,e){return D.a.isFunction(t)?t():t}))),this.block.model.addWidget(t,e)},removeBlock:function(t){var e=this.findBlock(t.get("_id"));this.blocks=D.a.without(this.blocks,e),this.stopListening(e),e.destroy()},onClick:function(t){t.stopPropagation(),!Object(l.a)(t.target).hasClass("workspace-inside-block")&&Object(l.a)(t.target).closest(".workspace-inside-block").length||this.page_workspace.controls&&!this.page_workspace.controls.canControlsBeClosed()||this.trigger("deselect")},onChangeViewport:function(t,e,i){},redrawPacksFrames:D.a.noop,redrawBottomShiftLine:D.a.noop,onSelect:function(){var t=this.getSelectedBlocks(),e=D.a.find(t,(function(t){return"text"===t.model.get("type")}));this.page_workspace.controls.onSelect(t),Object(d.a)("constructor.textv3")?e&&!e.propsModel.get("isEditMode")&&e.enterEditMode():e&&!e.isEditMode&&e.enterEditMode()},getSelectedBlocks:function(){return D.a.filter(this.blocks,(function(t){return t.selected}))},getSelectableBlocks:function(){return Object(D.a)(this.blocks).filter((function(t){return!t.model.get("hidden")&&!t.outofbox}))},get_visible_blocks:function(){return D.a.filter(this.blocks,(function(t){return!t.model.get("hidden")}))},get_visible_proportional_blocks:function(){return D.a.filter(this.get_visible_blocks(),(function(t){return t.proportional}))},get_visible_nonproportional_blocks:function(){return D.a.filter(this.get_visible_blocks(),(function(t){return!t.proportional}))},getExistingWidgets:function(){return Object(D.a)(this.blocks).chain().pluck("model").value()},findBlock:function(t){return D.a.find(this.blocks,(function(e){return e.model.id===t}))},get_box_data:function(){var t,e=this.block.getBoxData({checkFixedPosition:!0}),i=(t=this.block.hotspotWidget.apply_tip_position(this.block.model.attributes)).left,n=t.top,o=e.x+i,a=e.y+n;return this.block.model.get("fixed_position")&&(a+=this.block.workspace.$container.scrollTop()),{width:this.block.model.get("tip_w"),height:this.block.model.get("tip_h"),left_rel:i,top_rel:n,left_abs:o,top_abs:a}},onDeselect:function(){this.block&&this.block.selected&&this.block.deselect(),Object(d.a)("constructor.textv3")?this.block&&this.block.propsModel&&this.block.propsModel.get("isEditMode")&&this.block.leaveEditMode():this.block&&this.block.isEditMode&&this.block.leaveEditMode()},save:function(t,e){this.block.model.save(t,e)},destroy:function(){this.resize_handles_manager&&this.resize_handles_manager.destroy(),this.widget_selector&&this.widget_selector.destroy(),this.blocks.forEach((function(t){t.destroy()})),delete this.blocks,this.off("select w-text-entered-edit-mode w-text-before-leave-edit-mode"),this.remove()}}),Oe=c.a.extend(Qt.a.prototype).extend({name:"Hotspot",sort_index:8,thumb:"hotspot",icon_color:"#ff8888",dontSaveOnResize:!0,viewport_fields:m.b.viewport_fields.hotspot,initial_controls:["hotspot_add","hotspot_pin_settings","hotspot_tip_settings","common_animation","common_position","common_layer","common_lock"],settingsOnCreate:!1,initialize:function(t,e){this.mag=e.mag,this._id=t.get("_id"),this.hotspots_group_id=t.get("hotspots_group_id"),this.current_icon_data=null,this.initBlock(t,e),this.initHotspotsCollection(),this.child_workspace=null,this.on_icon_change.__debounced=D.a.debounce(this.on_icon_change,20),this.rasterizeOnUndo.__debounced=D.a.debounce(this.rasterizeOnUndo,20)},initHotspotsCollection:function(t){var e;t=t||{},this.hotspots_group_id?e="Hotspots_"+this.hotspots_group_id:(e="Hotspots_"+this._id,this.model.save({hotspots_group_id:this._id},{skipHistory:!0,silent:!0,patch:!0})),RM.collections[e]=RM.collections[e]||new Backbone.Collection,this.hotspots_group_collection=RM.collections[e],this.hotspots_group_collection.add(this.model)},getGroupBlocks:function(){return this.workspace.blocks.filter((function(t){return this.hotspots_group_collection.contains(t.model)}),this)},render:function(){var t=this.model.attributes;this.create(),this.$el.addClass("hotspot"),this.hotspotWidget=new pe.a({model:t,$container:this.$content,environment:"constructor",mag:this.mag,block:this}),this.on_icon_change(),this.tip_workspace=new Ce({$container:this.$(".common-hotspot"),block:this,page_workspace:this.workspace,resize_handles_positions:["top","right","left","bottom"],min_width:40,min_height:64}),this.hotspotWidget.apply_tip_position(t),this.bind_model_events(),this.controls=this.initial_controls,this.frame.recalcPointsDirections(),this.listenTo(this.tip_workspace,"childBlockEvent",this.onChildBlockEvent),this.listenTo(this.tip_workspace,"w-text-entered-edit-mode",D.a.bind((function(){this.tip_workspace.$el.addClass("text-edit-mode")}),this)),this.listenTo(this.tip_workspace,"w-text-leaved-edit-mode",D.a.bind((function(){this.tip_workspace.$el.removeClass("text-edit-mode")}),this)),this.triggerReady()},onChildBlockEvent:function(t,e){if("modechanged"==t){var i=e[0];this.disableDragging=i,this.$el.toggleClass("no-resize",i)}},getNestedWidgetsJSON:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.model.widgets_collection&&this.model.widgets_collection.toJSON()||[];return(e=D.a.filter(e,function(t){return this.model.get("wids").indexOf(t._id)>-1}.bind(this))).map((function(e){return D.a.omit(e||{},"id","__v","pid","parent_wid",t?"_id":void 0)}))},getIconStyle:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.current_icon_data&&this.current_icon_data.$svg?{"background-image":"","background-color":this.icon_color}:c.a.prototype.getIconStyle.apply(this,arguments)},getIconData:function(){if(!this.current_icon_data||!this.current_icon_data.$svg)return null;var t=this.current_icon_data.$svg.clone();return t.attr("fill","#ffffff").attr("fill-opacity","1"),{$svg:t,pinType:this.model.get("pin_type")}},get_icon_SVG:function(t,e,i){if(t){var n,o,a;if(this.icon_XHR&&this.icon_XHR.abort(),n=window.iconSVGCache&&D.a.findWhere(window.iconSVGCache,{id:t}))return a={noun_url:n.noun_url,$svg:n.$svg},this.current_icon_data=a,i(null,a);var r=function(e){var n=Object(l.a)("<div></div>").append(Object(l.a)(e.svg)).find("svg");if(n.length)return n=this.prepareIconSVG(n),a={noun_url:e.new_url,$svg:n},this.current_icon_data=a,window.iconSVGCache.push(D.a.extend(a,{id:t})),window.iconSVGCache.length>this.MAX_ICON_CACHE_SIZE&&window.iconSVGCache.shift(),i(null,{$svg:n,noun_url:e.new_url})}.bind(this);o={method:"POST",url:"/api/authservice/noun/icon",data:{id:t,url:e},dataType:"json",success:function(t){this.icon_svg_request_in_progress=!1,r(t)},error:function(t){return this.icon_svg_request_in_progress=!1,console.log("icon xhr : ",t),i(t)}},/^rm/.test(t)&&D.a.extend(o,{method:"GET",url:e,cache:!1,success:function(t){this.icon_svg_request_in_progress=!1,r({svg:Object(l.a)(t).find("svg"),new_url:e})},data:null,dataType:null}),this.icon_svg_request_in_progress=!0,this.icon_XHR=l.a.ajax(o)}},prepareIconSVG:function(t){var e=t.clone().appendTo(Object(l.a)("body")),i=t.clone();e.get(0).setAttributeNS(null,"viewBox","0 0 "+e.width()+" "+e.height());var n=e.get(0).getBBox();return e.remove(),i.removeAttr("width"),i.removeAttr("height"),i.get(0).setAttributeNS(null,"viewBox",n.x+" "+n.y+" "+n.width+" "+n.height),i.get(0).setAttributeNS(null,"preserveaspect_ratio","xMidYMid meet"),i.css({width:"100%",height:"100%"}),i},render_pin_shape:function(t){t=t||{};var e=this.generateShapeSVG("constructor",this.model,t.w||this.model.get("w"),t.h||this.model.get("h"),t.pin_type);this.$content.find(".pin").html(e)},adjust_box_to_icon:function(){var t,e,i,n,o,a,r,s=this.getBoxData(),l=Math.max(s.w,s.h);if((t=this.$(".pin").find("svg")).length)return e=(i=t.get(0).getBBox()).width/i.height,a=s.w,r=s.h,i.width>i.height?(s.w=l,s.h=Math.floor(s.w/e)):(s.h=l,s.w=Math.floor(s.h*e)),n=Math.floor((a-s.w)/2),o=Math.floor((r-s.h)/2),s.x=s.x+n,s.y=s.y+o,s},rasterize_icon_SVG:function(){var t=this,e=this.$(".pin").find("svg");e.length&&(this.rasterizeXhr&&this.rasterizeXhr.abort(),this.rasterizeXhr=Lt.rasterize({widgets:this.hotspots_group_collection.models,svg:e,mid:this.workspace.mag.get("_id"),viewport:this.model.getViewport(),size:{width:this.model.get("w"),height:this.model.get("h")},onSuccess:function(e){e&&e.rasterUrl&&t.model.save(e,{skipHistory:!0,silent:!0})}}))},getPeerIds:function(){return D.a.map(this.hotspots_group_collection.models,(function(t){return t.get("_id")}))},onResizeStart:function(t,e){this.rasterizeXhr&&this.rasterizeXhr.abort()},onResizeEnd:function(t,e,i){i=i||{};var n=[];this.hotspots_group_collection.models.forEach(function(t){var e=this.workspace.findBlock(t.get("_id"));e&&n.push(D.a.extend({_id:t.get("_id")},e.adjust_box_to_icon()))}.bind(this)),i.isGroupResize?this.workspace.set_group(n,i):this.workspace.save_group(n,i),"icon"===this.model.get("pin_type")&&this.rasterize_icon_SVG()},onIndexChange:function(){this.selected||c.a.prototype.onIndexChange.apply(this,arguments)},css:function(t,e){t=t||{},this.selected?t["z-index"]=this.MAX_Z_INDEX:Object(d.a)("constructor.zIndex")?t["z-index"]=RM.constructorRouter.indexController.getZIndex(this.id,this.workspace.page.id,this.workspace.page.getCurrentViewport()):t["z-index"]=this.model.get("z"),c.a.prototype.css.apply(this,[t,e]),null!=t.height&&null!=t.width&&this.render_pin_shape({w:t.width,h:t.height}),(e||t.isGroupResize)&&this.hotspots_group_collection.models.forEach(function(e){var i=e.get("_id"),n=t.groupedIds&&-1===t.groupedIds.indexOf(i);if(this.model.get("_id")!==i&&(!t.isGroupResize||n)){var o=this.workspace.findBlock(i);o&&o.css({width:t.width,height:t.height,doNotRedrawPacksFrames:t.doNotRedrawPacksFrames})}}.bind(this))},bind_model_events:function(){this.model.on("change:tip_background-color change:tip_background-color-opacity",this.apply_tip_bg_color,this),this.model.on("change:tip_border-radius",this.apply_tip_border_radius,this),this.model.on("change:tip_box-shadow",this.apply_tip_box_shadow,this),this.model.on("change:noun_id change:rm_id change:noun_url change:pin_type change:borders change:color change:opacity change:bg_color change:bg_opacity",this.on_icon_change.__debounced,this),this.model.on("change:noun_id change:rm_id change:noun_url change:pin_type change:bg_color change:bg_opacity change:w change:h",this.rasterizeOnUndo.__debounced,this)},rasterizeOnUndo:function(t,e,i){(i.undo||i.redo)&&"icon"==this.model.get("pin_type")&&this.hotspots_group_collection.at(0)==this.model&&this.rasterize_icon_SVG()},on_icon_change:function(){this.determine_is_block_proportional();var t=this.model.get("pin_type");"ellipse"!==t&&"rectangle"!==t||this.render_pin_shape(),"icon"===t&&this.get_icon_SVG(this.model.get("noun_id")||this.model.get("rm_id"),this.model.get("noun_url"),function(t,e){!t&&e.$svg&&this.render_pin_shape()}.bind(this))},apply_tip_bg_color:function(){this.hotspotWidget.apply_tip_bg_color(this.model.attributes)},apply_tip_border_radius:function(){this.hotspotWidget.apply_tip_border_radius(this.model.attributes)},apply_tip_box_shadow:function(){this.hotspotWidget.apply_tip_box_shadow(this.model.attributes)},determine_is_block_proportional:function(){var t=this.model.get("pin_type");this.proportional="ellipse"===t||"icon"===t},apply_tip_container_size:function(t){this.hotspotWidget.apply_tip_container_size(t)},apply_tip_position:function(){var t=this.model.attributes;this.hotspotWidget?this.hotspotWidget.apply_tip_position(t):console.log(this.model,this,"NO Hotspot widget")},onWorkspaceBlocksSelect:function(t){if(c.a.prototype.onWorkspaceBlocksSelect.apply(this,arguments),this.rendered){var e=t&&1==t.length&&t[0]==this;RM.constructorRouter.isPageLocked(this.model.get("pid"))||this.toggleTip(e)}},deselect:function(){c.a.prototype.deselect.apply(this,arguments),this.toggleTip(!1),this.child_workspace&&this.child_workspace.onDeselect()},toggleTip:function(t){this.$(".tip").css("visibility",t?"inherit":"hidden"),this.css(),this.tip_workspace&&this.tip_workspace.resize_handles_manager&&(t?this.tip_workspace.resize_handles_manager.show():this.tip_workspace.resize_handles_manager.hide())},destroy:function(){this.stopListening(this.tip_workspace),this.tip_workspace&&this.tip_workspace.destroy(),this.hotspotWidget&&this.hotspotWidget.destroy(),this.hotspotWidget=null,this.rasterizeXhr&&this.rasterizeXhr.abort(),this.icon_XHR&&this.icon_XHR.abort(),this.model.off(null,null,this),this.hotspots_group_collection&&this.hotspots_group_collection.remove(this.model),c.a.prototype.destroy.apply(this,arguments)}},{defaults:{pin_type:"ellipse",w:30,h:30,bg_color:"ff8888",bg_opacity:1,borders:0,color:"000000",opacity:1,tip_show_on:"click",x:"center",tip_w:240,tip_h:120,tip_pos:"top","tip_background-color":"ffffff","tip_background-color-opacity":100,"tip_border-radius":8,"tip_box-shadow":!0,wids:[]}}),je=i("gm8A"),Pe=i("31/U");function Ee(t){return function(t){if(Array.isArray(t))return Ie(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Ie(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ie(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ie(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Te=[{tp:"name",caption:"Name",optional:!1,sort:0},{tp:"email",caption:"Email",optional:!1,sort:1}],Me=c.a.extend({name:"Form",sort_index:9,thumb:"form",icon_color:"#7232B4",DEFAULT_HORIZONTAL_SIZE:40,DEFAULT_VERTICAL_SIZE:300,MIN_FONT_SIZE:8,MAX_FONT_SIZE:999,MIN_LETTER_SPACING:-99,MAX_LETTER_SPACING:999,form_controls:["form_content","form_styles","form_endpoints"],viewport_fields:m.b.viewport_fields.form,initialize:function(t,e){this.mag=e.mag,Object(d.a)("viewer.formsCaptcha")&&(this.form_controls=Ee(this.form_controls),this.form_controls.splice(2,0,"form_captcha")),this.controls=D.a.union(this.form_controls,this.controls),this.frameClass=$e,this.initBlock(t,e),this.saveThrottled=D.a.throttle(this.model.save.bind(this.model),700,{leading:!1})},render:function(){this.create(),this.$el.addClass("form"),this.formWidget=new je.a({data:this.model.attributes,environment:"constructor",$container:this.$content}),this.formWidget.render(),this.minimalDimensions=this.formWidget.getMinimalDimensions(),this.triggerReady()},getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={},i="./constructor/widgetbar/icons/";if(t.small&&this.icon_color)return e["background-color"]=this.icon_color,e;var n=Object(at.findImagePath)("".concat(i,"form.svg"));return e["background-image"]="url(".concat(n,")"),e["border-radius"]="0",e},onCreate:function(){this.openContentControl()},bindEvents:function(){c.a.prototype.bindEvents.apply(this,arguments),this.$el.on("dblclick",this.onDoubleClick),this.$el.on("click",".js-add-line",this.onAddLineClick),this.$el.on("click",".js-remove-line",this.onRemoveLineClick)},css:function(t,e){c.a.prototype.css.apply(this,arguments),null==t.height&&null==t.width||this.formWidget.recalcStyles({h:t.height,w:t.width})},validate:function(){var t=D.a.difference(m.b.viewport_fields.form,m.b.viewport_fields_common);this.model.fillMissingFieldsFromDefaultViewport(t)},redraw:function(t,e){if(e=e||{},this.checkNeedRedraw(t)){var i=e.undo||e.redo;this.validate();var n,o,a,r,s=this.model.get("layout"),d=this.model.get("style"),h=this.model.get("style-"+d+"-fields").gutter,u=this.model.changedAttributes(),p=this.model.previousAttributes(),m="vertical"==s?"h":"w";i||u.layout&&u.layout!==p.layout?this.formWidget.render({force:!0}):u.fields?(a=u.fields.length-p.fields.length,r=this.formWidget.getRowsCount(u.fields)-this.formWidget.getRowsCount(p.fields),n=Object(l.a)(this.formWidget.$(".input-wrapper").get(0)),o="vertical"==s?n.height():n.width(),D.a.defer(function(){var t=(o+h)*a;!a&&r&&(t=r*this.formWidget.getLineHeight().input),this.model.set(m,this.model.get(m)+t),this.formWidget.render()}.bind(this))):this.formWidget.recalcStyles(),this.minimalDimensions=this.formWidget.getMinimalDimensions(),c.a.prototype.redraw.apply(this,arguments)}},onDoubleClick:function(){this.openContentControl()},onAddLineClick:function(t){this.addOrRemoveLine(t,!0)},onRemoveLineClick:function(t){this.addOrRemoveLine(t,!1)},addOrRemoveLine:function(t,e){var i=Object(l.a)(t.target).closest(".js-input-wrapper").find(".js-input").data("sort"),n=this.model.get("fields"),o=D.a.find(n,{sort:i});if(o){var a=o.rows||1;e?a+=1:a=a>1?a-1:1,this.changeField({sort:i},{rows:a})}this.trigger("resize"),this.saveThrottled()},openContentControl:function(){var t=this.workspace&&this.workspace.controls,e=t&&t.findControl("form_content");e&&e.master.select(e)},setButtonHoverState:function(){this.formWidget.setButtonHoverState()},unsetButtonHoverState:function(){this.formWidget.unsetButtonHoverState()},toggleInputValue:function(t){t?this.formWidget.showInputPlaceholdersAsValues(!0):this.formWidget.render()},getMinimalDimensions:function(){return this.minimalDimensions},getDefaultDimensions:function(){var t=this.getMinimalDimensions(),e=this.model.attributes,i=e["style-"+e.style+"-fields"],n=e["style-"+e.style+"-button-default"],o=this.model.get("fields");return"vertical"==this.model.get("layout")?{width:this.DEFAULT_VERTICAL_SIZE,height:t.height}:{width:200*(o.length+1)+o.length*i.gutter+n.gutter,height:this.DEFAULT_HORIZONTAL_SIZE}},changeField:function(t,e){var i=D.a.clone(this.model.get("fields")),n=D.a.findIndex(i,t),o=i[n],a={};D.a.each(e,(function(t,e){a[e]=D.a.clone(o[e])})),null===(o=D.a.extend(D.a.clone(o),e)).items&&delete o.items,i[n]=o,this.model.set("fields",i),D.a.each(e,function(t,e){this.model.trigger("field:"+e+":change",o,a[e])}.bind(this)),this.model.trigger("field:change",o)},canBeUsed:function(){return RM.constructorRouter.me.get("permissions").can_use_forms||!Object(d.a)("constructor.canUseFormPermission")},deselect:function(){this.selected&&!this.canBeUsed()&&RM.constructorRouter.trigger("notice:hide"),c.a.prototype.deselect.apply(this,arguments)},select:function(){this.selected||this.canBeUsed()||RM.constructorRouter.trigger("notice:show",Pe.b.UpgradeAccountToUse),c.a.prototype.select.apply(this,arguments)}},{defaults:{layout:"vertical",style:"colored","button-caption":"Text",button_caption_after_submit:"",submit_mode:"textAfterSubmit",link_after_submit:null,fields:JSON.parse(JSON.stringify(Te)),h:48*(Te.length+1)+20*Te.length,w:286,x:"center","style-colored-fields":{gutter:20,color:"f7f7f7",opacity:100,"border-radius":0,"border-width":0,"border-color":"000000","border-opacity":100,"font-family":"Roboto","font-style":"normal","font-weight":400,"text-color":"000000","text-opacity":100,"font-size":18,"letter-spacing":0},"style-colored-button-default":{gutter:0,color:"4c4c4c",opacity:100,"border-radius":"inherit","border-width":0,"border-color":"000000","border-opacity":100,"font-family":"inherit","font-style":"inherit","font-weight":"inherit","text-color":"ffffff","text-opacity":100,"font-size":"inherit","letter-spacing":"inherit","text-align":"center"},"style-colored-button-hover":{color:"inherit",opacity:90,"border-width":"inherit","border-color":"inherit","border-opacity":"inherit","text-color":"inherit","text-opacity":"inherit","text-align":"inherit",transition:!1},"style-outlined-fields":{gutter:20,color:"ffffff",opacity:0,"border-radius":0,"border-width":1,"border-color":"e5e5e5","border-opacity":100,"font-family":"Roboto","font-style":"normal","font-weight":400,"text-color":"000000","text-opacity":100,"font-size":18,"letter-spacing":0},"style-outlined-button-default":{gutter:0,color:"e8e8e8",opacity:60,"border-radius":"inherit","border-width":0,"border-color":"000000","border-opacity":100,"font-family":"inherit","font-style":"inherit","font-weight":"inherit","text-color":"000000","text-opacity":60,"font-size":"inherit","letter-spacing":"inherit","text-align":"inherit"},"style-outlined-button-hover":{color:"inherit",opacity:90,"border-width":"inherit","border-color":"inherit","border-opacity":"inherit","text-color":"inherit","text-opacity":80,"text-align":"inherit",transition:!1},"style-underlined-fields":{gutter:20,"underline-width":1,"underline-color":"000000","underline-opacity":100,"font-family":"Roboto","font-style":"normal","font-weight":400,"text-color":"000000","text-opacity":100,"font-size":18,"letter-spacing":0},"style-underlined-button-default":{gutter:0,color:"000000",opacity:100,"border-radius":0,"border-width":0,"border-color":"000000","border-opacity":100,"font-family":"inherit","font-style":"inherit","font-weight":"inherit","text-color":"ffffff","text-opacity":100,"font-size":"inherit","letter-spacing":"inherit","text-align":"inherit"},"style-underlined-button-hover":{color:"inherit",opacity:80,"border-width":"inherit","border-color":"inherit","border-opacity":"inherit","text-color":"inherit","text-opacity":"inherit","text-align":"inherit",transition:!1}}}),$e=b.a.extend({applyExtraConstraints:function(t,e){var i=this.block.getMinimalDimensions();return t.height<i.height&&(t.height=i.height),t.width<i.width&&(t.width=i.width),t}}),Ae=Me,Re=ue.extend({name:"Cart",title:"E-comm",blockName:mt.a.ecommerceCartBlockName,sort_index:13,thumb:"cart-button",getBlockCreateParams:function(t){return t.eCommerceManager.haveEcommerceCartWidget?{name:"Add to cart",title:"E-commerce",block_name:mt.a.addToCartBlockName,thumb:"addtocart-button"}:{name:"Cart",title:"E-comm",blockName:mt.a.ecommerceCartBlockName,thumb:"cart-button"}},restrictions:function(){var t=RM.constructorRouter&&RM.constructorRouter.me&&RM.constructorRouter.me.get("permissions");return t&&t.can_use_e_commerce},icon_color:"#446E00",viewport_fields:m.b.widgetViewportFields(mt.a.ecommerceCartBlockName),frameColor:"#0080FF",settingsOnCreate:!0,onCreate:function(){this.workspace.controls.selectFirst(),this.setWidgetGlobal(),this.workspace.eCommerceManager.haveEcommerceCartWidget=!0},setWidgetGlobal:function(){this.model.set("is_global",!0),this.model.save({},{silent:!0,toHistory:!1,skipHistory:!0}),this.workspace.controls.findControl("common_position").updateModel(D.a.clone(this.model.attributes))},initial_controls:["cart_connections","cart_add_product_widget","cart_settings","button_icon","button_edit","common_animation","common_position","common_layer","common_lock"],DEFAULT_BACKGROUND_COLOR:"f4f4f4",animationTriggerLine:null,getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};return t.small&&this.icon_color?(e["background-color"]=this.icon_color,e):(e["background-image"]="url(".concat(Object(at.findImagePath)("./constructor/widgetbar/icons/".concat(this.thumb,".svg")),")"),e)},initialize:function(){ue.prototype.initialize.apply(this,arguments)},render:function(){var t,e=D.a.clone(this.model.attributes),i=e.tp;this.create(),this.$el.addClass("button"),t={model:e,$container:this.$content,environment:"constructor",mag:this.mag,block:this},this.buttonWidget=new de.a(t),this.$button=this.$(".common-button"),this.$textInput=this.$button.children(".text"),this.$buttonIcon=this.$button.children(".icon"),"icon"!==i&&"text_and_icon"!==i||this.getIconSVG(this.model.get("icon_noun_id")||this.model.get("icon_rm_id"),this.model.get("icon_noun_url"),function(t,e){!t&&e.$svg&&(this.renderIcon({$svg:this.getСoloredIconSVG()}),this.model.get("icon_rasterUrl")||this.rasterizeSVG({default:!0,hover:!0,current:!0}))}.bind(this)),this.recalcButtonSize(),this.disableTextInput(),this.handleSelectionColor(),this.bindDOMEvents(),this.bindModelEvents(),this.controls=this.initial_controls,this.frame.recalcPointsDirections(),this.triggerReady()},deselect:function(t){t!==this&&this.selected&&(this.validateWidgets(),ue.prototype.deselect.apply(this,arguments))},destroy:function(){this.stopListeningForUpdateTrigger(),ue.prototype.destroy.apply(this,arguments)},validateWidgets:function(){this.workspace.eCommerceManager.getInvalidAddToCartWidgets().length?RM.constructorRouter.trigger("notice:show",Pe.b.EcommHasInvalidAddToCartWidget,{canBeClosed:!0}):RM.constructorRouter.trigger("notice:hide",Pe.b.EcommHasInvalidAddToCartWidget)},getIndividualStyles:function(){var t=["background-color","background-color-opacity","border-radius","border-width","border-color","border-color-opacity","font-family","font-style","font-weight","color","color-opacity","font-size","letter-spacing","hover-background-color","hover-background-color-opacity","hover-border-width","hover-border-radius","hover-border-color","hover-border-color-opacity","hover-color","hover-color-opacity","hover-font-family","hover-font-size","hover-tansition-duration"];return t.forEach((function(t,e,i){i[e]="change:"+t})),t.join(" ")},onDragStart:function(t,e){if(t.altKey||e.isClone)return!1;ue.prototype.onDragStart.apply(this,arguments)},startListeningForUpdateTrigger:function(t){this.animationTriggerLine=t,this.listenTo(this,"move resize",this.updateAnimationTrigger.bind(this))},stopListeningForUpdateTrigger:function(){this.updateAnimationTrigger&&(this.stopListening(this,"move resize",this.updateAnimationTrigger),this.animationTriggerLine=null)},updateAnimationTrigger:function(){window.requestAnimationFrame(this.recalcAnimationTrigger.bind(this))},recalcAnimationTrigger:function(){this.animationTriggerLine&&this.animationTriggerLine.update()}},{yOffsetOnCreate:-80,defaults:{tp:"text",form:"rectangle",text:"Cart",w:168,h:50,hidden:!1,x:"center",text_w:48,text_h:26,em_w:16,"background-color":"f4f4f4","background-color-opacity":100,"border-radius":4,"border-width":0,"border-color":"000000","border-color-opacity":100,"font-family":"Arial","font-style":"normal","font-weight":400,color:"282828","color-opacity":100,"font-size":18,"letter-spacing":0,"hover-background-color":"f4f4f4","hover-background-color-opacity":80,"hover-border-width":0,"hover-border-color":"000000","hover-border-color-opacity":100,"hover-border-radius":4,"hover-color":"282828","hover-color-opacity":100,"hover-tansition-duration":0,"hover-cursor":"pointer",icon_enabled:!1,icon_h:18,icon_w:18,icon_pos:"left",icon_noun_id:null,icon_rm_id:null,icon_noun_url:null,icon_color:"ffffff",icon_color_opacity:100,"hover-icon_color":"ffffff","hover-icon_color_opacity":100,icon_rasterUrl:null,icon_raster2xUrl:null,"hover-icon_rasterUrl":null,"hover-icon_raster2xUrl":null,"bar-color":"ffffff","bar-color-opacity":100,"bar-background-color":"1a1a1a","bar-background-color-opacity":100,"bar-shadow":!1,"bar-font-family":"Arial","bar-font-style":"normal","bar-font-weight":400,"bar-letter-spacing":"inherit","bar-title":mt.a.defaultSidebarTexts.title,"bar-emptyСartTitle":mt.a.defaultSidebarTexts.emptyСartTitle,"bar-price":mt.a.defaultSidebarTexts.price,"bar-quantity":mt.a.defaultSidebarTexts.quantity,"bar-checkout":mt.a.defaultSidebarTexts.checkout}}),De=i("zzMN"),Be=i("m41J"),Le=function t(e){this.fromBlock=e.fromBlock,this.toBlock=e.toBlock,this.$el=e.$el,this.root=document.createElementNS(t.svgns,"svg"),this.root.setAttributeNS(null,"class",e.cssClass),this.curve=document.createElementNS(t.svgns,"path"),this.root.appendChild(this.curve),this.arrow=document.createElementNS(t.svgns,"polygon"),this.root.appendChild(this.arrow),this.$el.append(this.root),this.update()};Le.svgns="http://www.w3.org/2000/svg",Le.minHandleLength=65,Le.lineEndOffset=7,Le.prototype.update=function(){var t=Be.a.getBox(this.fromBlock),e=Be.a.getBox(this.toBlock),i=Be.a.getBestPoints(t,e),n=i.fromPoint,o=i.toPoint;o=Be.a.getPerpendicularEnd(i.toSide,o,e,Le.lineEndOffset);var a=Be.a.getDistance(n,o),r=Math.max(a/2,Le.minHandleLength),s=Be.a.getPerpendicularEnd(i.fromSide,n,t,r),l=Be.a.getPerpendicularEnd(i.toSide,o,e,r),c="M"+n.x+" "+n.y+" C "+s.x+" "+s.y+", "+l.x+" "+l.y+", "+o.x+" "+o.y;this.curve.setAttributeNS(null,"d",c),this.updateArrow(i.toSide,o,e)},Le.prototype.updateArrow=function(t,e,i){var n=e.x,o=e.y;"left"===t&&(n+=1),"bottom"===t&&(o-=1),"right"===t&&(n-=1),"top"===t&&(o+=1);var a=n+" "+o+" "+(n-5.5)+" "+(o-9)+" "+(n+5.5)+" "+(o-9),r="rotate("+Math.round(180*(i.angle+Be.a.sideAngles[t])/Math.PI)+", "+n+", "+o+")";this.arrow.setAttributeNS(null,"points",a),this.arrow.setAttributeNS(null,"transform",r)},Le.prototype.remove=function(){this.root&&this.root.parentNode.removeChild(this.root)};var ze=Le,Fe=i("jeLO"),Ue=b.a.extend({initialize:function(){b.a.prototype.initialize.apply(this,arguments),this.listenTo(this.block,"addToCartChangeSelectionState",this.changeSelectionState),this.$frameBorder=this.$el.children(".frameborder")},destroy:function(){this.stopListening(this.block,"addToCartChangeSelectionState",this.changeSelectionState),b.a.prototype.destroy.apply(this,arguments)},changeSelectionState:function(t){"button"===t?(this.$frameBorder.css({"border-color":v.default.getRGBA(this.block.frameColor.substring(1,7),.5)}),this.block.$buttonWrap.css({"box-shadow":"0px 0px 0px 1px "+this.block.frameColor+" inset"})):"selects"===t?(this.$frameBorder.css({"border-color":v.default.getRGBA(this.block.frameColor.substring(1,7),.5)}),this.block.$attributesBox.css({"box-shadow":"0px 0px 0px 1px "+this.block.frameColor+" inset"})):"both"===t&&(this.$frameBorder.css({"border-color":this.block.frameColor}),this.block.$attributesBox.css({"box-shadow":"none"}),this.block.$buttonWrap.css({"box-shadow":"none"}))}});function Ne(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function He(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(i),!0).forEach((function(e){Ve(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Ne(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Ve(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var We=["product_selector"],Ge=["both","button","selects"],qe=c.a.extend({name:"Add to cart",title:"E-commerce",blockName:mt.a.addToCartBlockName,sort_index:13,thumb:"addtocart-button",excludedFromLib:!0,restrictions:function(){var t=RM.constructorRouter&&RM.constructorRouter.me&&RM.constructorRouter.me.get("permissions");return t&&t.can_use_e_commerce},icon_color:"#446E00",viewport_fields:m.b.viewport_fields[mt.a.addToCartBlockName],MAX_ICON_CACHE_SIZE:30,RASTERIZE_MULTIPLIER:2,frameColor:"#0080FF",cartBlock:null,defaultProductId:"default",textPaddingSizePercentage:12,initial_controls:["product_selector","add_to_cart_settings","button_icon","button_edit","common_animation","common_position","common_layer","common_lock"],disabledControls:We,getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={};return t.small&&this.icon_color?(e["background-color"]=this.icon_color,e):(e["background-image"]="url(".concat(Object(at.findImagePath)("./constructor/widgetbar/icons/".concat(this.thumb,".svg")),")"),e)},controlsClasses:function(t){return{"panel-product-selector":this.getProductSelectorIconClass()}[t]},getProductSelectorIconClass:function(){return this.model&&"default"!==this.model.get("selected_product_id")?this.workspace.eCommerceManager.checkProductActive(this.model.get("selected_product_id"))?"active-product-selected":"inactive-product-selected":"product-not-selected"},checkDisabledControls:function(t,e){e?this.workspace.eCommerceManager&&this.workspace.eCommerceManager.getConnectedProvider()?this.disabledControls=[]:this.disabledControls=We:t instanceof Fe.a||(this.disabledControls=t?[]:We,this.trigger("disabledControls:changed",this.blockName))},initialize:function(t,e){this.mag=e.mag,this.frameClass=Ue,this.isEditMode=!1,this.rendered=!1,this.stylingState="default",this.selectionState="both",this.initBlock(t,e),this._oldAttrs=D.a.clone(this.model.attributes),this.onIconChange.__debounced=D.a.debounce(this.onIconChange,20),this.onTextInput.__debounced=D.a.debounce(this.onTextInput,20),this.rasterizeSVG.__debounced_both=D.a.debounce(this.rasterizeSVG,100),this.rasterizeSVG.__debounced_default=D.a.debounce(this.rasterizeSVG,100),this.rasterizeSVG.__debounced_hover=D.a.debounce(this.rasterizeSVG,100),this.setMinimalDimensions.__debounced=D.a.debounce(this.setMinimalDimensions,100),this.saveWidgetData.__debounced=D.a.debounce(this.saveWidgetData,100),this.validateWidgets.__debounced=D.a.debounce(this.validateWidgets,100)},render:function(t){var e=this;this.create(),this.$el.addClass("add-to-cart-block"),this.controls=this.initial_controls,this.addToCartWidget=new De.a({data:D.a.cloneWithObjects(this.model.attributes),environment:"constructor",$container:this.$content,block:this,eCommerceManager:this.workspace.eCommerceManager}),this.addToCartWidget.on("loaded",(function(){e.initIcon()})),this.addToCartWidget.render(t),this.$buttonWrap=this.$content.find(".button-wrap"),this.$button=this.addToCartWidget.$button,this.$buttonText=this.addToCartWidget.$buttonText,this.$buttonIcon=this.addToCartWidget.$buttonIcon,this.$attributesBox=this.addToCartWidget.$attrsContainer,this.$sizesCalculatingBlock=this.$el.find(".sizes-calculating-block"),this.bindLinkingLineEvents(),this.bindDOMEvents(),this.bindModelEvents(),this.rendered=!0,this.triggerReady()},destroy:function(){this.unbindDOMEvents(),this.unbindLinkingLineEvents(),this.model.off(null,null,this),c.a.prototype.destroy.apply(this,arguments)},bindDOMEvents:function(){this.$el.on("mousedown",this.onBlockMousedown),this.$button.on("dblclick",this.onButtonDoubleClick),this.$attributesBox.on("dblclick",this.onAttrsDoubleClick),this.$buttonText.on("input",this.onTextInput)},unbindDOMEvents:function(){this.$el.off("mousedown",this.onBlockMousedown),this.$button.off("dblclick",this.onButtonDoubleClick),this.$attributesBox.off("dblclick",this.onAttrsDoubleClick),this.$buttonText.off("input",this.onTextInput)},bindLinkingLineEvents:function(){this.listenTo(this,"move resize",this.updateAnimationTrigger.bind(this)),this.listenTo(this.model,"change:angle change:sticked change:fixed_position change:is_full_width change:is_full_height",this.updateAnimationTrigger),this.listenTo(this.workspace,"workspace-resize",this.updateAnimationTrigger.bind(this)),Object(l.a)("#main").on("scroll",this.updateAnimationTrigger)},unbindLinkingLineEvents:function(){this.stopListening(this,"move resize",this.updateAnimationTrigger),this.stopListening(this.model,"change:angle change:sticked change:fixed_position change:is_full_width change:is_full_height",this.updateAnimationTrigger),this.stopListening(this.workspace,"workspace-resize",this.updateAnimationTrigger),Object(l.a)("#main").off("scroll",this.updateAnimationTrigger)},bindModelEvents:function(){this.model.on("change:tp",this.onTypeChange,this),this.model.on("change:icon_enabled",this.determineButtonType,this),this.model.on("change:text",(function(t,e,i){(i.undo||i.redo||i.socketUpdate)&&this.$buttonText.val(this.model.get("text"))}),this),this.model.on("change:icon_enabled change:icon_noun_id change:icon_rm_id change:icon_noun_url",(function(t,e,i){this.onIconChange.__debounced(t,e,i)}),this),this.model.on("change:icon_h",(function(t,e,i){this.recalcIconContainerSize(t,e,i)}),this),this.model.on("change:icon_pos",(function(){this.onIconPositionChange()}),this),this.model.on("change:selected_product_id",this.onProductChange,this),this.model.on("change:layout",this.onLayoutChange,this),this.model.on("change:font-size change:font-family change:font-style change:font-weight change:letter-spacing",function(){this.recalcButtonTextSize()}.bind(this),this),this.model.on("change:attrs-font-size change:attrs-font-family change:attrs-font-style change:attrs-font-weight change:attrs-letter-spacing",function(){this.recalcSelectsTextSize()}.bind(this),this),this.model.on("change:text_w change:text_h",(function(){this.onButtonTextSizeChange()}),this),this.model.on("change:attrs-icon-h change:attrs-icon-w",(function(t){this.onAttrsIconSizeChange(t)}),this),this.model.on("change:icon_color change:icon_color_opacity",function(t){var e=t.get("tp");if("icon"===e||"text_and_icon"===e){var i={default:!0};(t.hasChanged("icon_color")&&t.hasChanged("hover-icon_color")||t.hasChanged("icon_color_opacity")&&t.hasChanged("hover-icon_color_opacity"))&&(i.hover=!0),this.rasterizeSVG.__debounced_default(i)}}.bind(this),this),this.model.on("change:hover-icon_color change:hover-icon_color_opacity",function(t){var e=t.get("tp");"icon"!==e&&"text_and_icon"!==e||t.hasChanged("icon_color")||t.hasChanged("icon_color_opacity")||this.rasterizeSVG.__debounced_hover({hover:!0})}.bind(this),this);var t=this.getIndividualStyles();this.model.on(t,function(){var t=D.a.clone(this.model.attributes);this.addToCartWidget.generateIndividualStyleCSS(t,this.stylingState,this.selectionState)}.bind(this),this)},changeStylingState:function(t){this.stylingState=t;var e=D.a.clone(this.model.attributes);this.addToCartWidget.generateIndividualStyleCSS(e,this.stylingState,this.selectionState)},haveProductAttributes:function(){return!!this.addToCartWidget&&this.addToCartWidget.showSkus},setDefaultSelectionState:function(){if("both"!==this.selectionState){this.selectionState="both",this.trigger("addToCartChangeSelectionState",this.selectionState);var t=D.a.clone(this.model.attributes);this.addToCartWidget.generateIndividualStyleCSS(t,this.stylingState,this.selectionState)}},setSelectionState:function(t){if(-1!==Ge.indexOf(t)){this.selectionState=t,this.trigger("addToCartChangeSelectionState",this.selectionState);var e=D.a.clone(this.model.attributes);this.addToCartWidget.generateIndividualStyleCSS(e,this.stylingState,this.selectionState)}},select:function(){this.selected||(this.checkDisabledControls(null,!0),this.cartBlock=this.workspace.eCommerceManager.getEcommerceCartBlock(),this.cartBlock&&(this.animationTriggerLine=new ze({$el:this.workspace.$el,fromBlock:this,toBlock:this.cartBlock,cssClass:"animation-trigger-line"}),this.cartBlock.startListeningForUpdateTrigger(this.animationTriggerLine)),c.a.prototype.select.apply(this,arguments))},deselect:function(t){t!==this&&this.selected&&(this.setDefaultSelectionState(),this.deleteAnimationTrigger(),this.isEditMode&&(this.leaveEditMode({saveWidgetData:!0}),this.workspace.trigger("redraw")),this.addToCartWidget.checkOutOfStock(),this.validateWidgets.__debounced(),c.a.prototype.deselect.apply(this,arguments))},validateWidgets:function(){this.workspace.eCommerceManager.getInvalidAddToCartWidgets().length?RM.constructorRouter.trigger("notice:show",Pe.b.EcommHasInvalidAddToCartWidget,{canBeClosed:!0}):RM.constructorRouter.trigger("notice:hide",Pe.b.EcommHasInvalidAddToCartWidget)},updateAnimationTrigger:function(){this.selected&&window.requestAnimationFrame(this.recalcAnimationTrigger.bind(this))},recalcAnimationTrigger:function(){this.animationTriggerLine&&this.animationTriggerLine.update()},deleteAnimationTrigger:function(){this.animationTriggerLine&&this.animationTriggerLine.remove(),delete this.animationTriggerLine,this.cartBlock&&(this.cartBlock.stopListeningForUpdateTrigger(),this.cartBlock=null)},onWorkspaceBlocksSelect:function(t){if(c.a.prototype.onWorkspaceBlocksSelect.apply(this,arguments),this.rendered){var e=t&&1===t.length&&t[0]===this;this.isEditMode&&!e&&(this.leaveEditMode({deselectControl:!0,saveWidgetData:!0}),this.workspace.trigger("redraw")),e||this.deleteAnimationTrigger()}},onButtonDoubleClick:function(){this.model.get("pack_id")?c.a.prototype.onDblClick.apply(this,arguments):this.selected&&(this.addToCartWidget.showSkus?"both"===this.selectionState?(this.setSelectionState("button"),this.workspace.controls.findControl("add_to_cart_settings").select()):"selects"===this.selectionState?this.setSelectionState("button"):!this.isEditMode&&this.enterEditMode():!this.isEditMode&&this.enterEditMode())},onAttrsDoubleClick:function(){this.selected&&this.addToCartWidget.showSkus&&("both"===this.selectionState?(this.setSelectionState("selects"),this.workspace.controls.findControl("add_to_cart_settings").select()):"button"===this.selectionState&&this.setSelectionState("both"))},onBlockMousedown:function(t){this.isEditMode&&!Object(l.a)(t.target).is(this.addToCartWidget.$buttonText)&&this.leaveEditMode({deselectControl:!0,saveWidgetData:!0}),this.addToCartWidget.showSkus&&("button"!==this.selectionState||Object(l.a)(t.target).is(this.addToCartWidget.$buttonText)||this.setDefaultSelectionState(),"selects"!==this.selectionState||Object(l.a)(t.target).is(this.$attributesBox)||this.setDefaultSelectionState())},enterEditMode:function(t){this.isEditMode=!0,this.addToCartWidget&&this.addToCartWidget.enterEditMode(t),this.determineButtonType({enter_edit_mode:!0})},leaveEditMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.addToCartWidget&&(this.addToCartWidget.leaveEditMode(t),this.model.set("text",this.addToCartWidget.getButtonText())),t.deselectControl&&this.deselectEditControl(),this.isEditMode=!1,this.determineButtonType(),this.recalcButtonTextSize(),t.saveWidgetData&&this.saveWidgetData()},selectEditControl:function(){var t=this.workspace&&this.workspace.controls;if(t){var e=t.findControl("button_edit");e&&e.master.select(e)}},deselectEditControl:function(){var t=this.workspace&&this.workspace.controls;if(t){var e=t.findControl("button_edit");e&&e.master.deselect()}},onTextInput:function(){this.recalcButtonTextSize()},css:function(t){c.a.prototype.css.apply(this,arguments),this.addToCartWidget.recalcDimensions(t)},onResizeEnd:function(){var t=this.getSaveBoxData(),e=this.$button.outerWidth(),i=this.$button.outerHeight();this.model.get("btn_w")===e&&this.model.get("btn_h")===i||(this.model.set({w:t.w,h:t.h,btn_w:e,btn_h:i}),this.addToCartWidget.setData(D.a.clone(this.model.attributes)),this.saveWidgetData())},setSizeConstraints:function(t,e){D.a.extend(this.frame,{minwidth:t,maxwidth:9999,minheight:e,maxheight:9999})},setMinimalDimensions:function(){this.addToCartWidget&&this.addToCartWidget.setMinimalDimensions()},changeSelectedProduct:function(t){this.model.save({selected_product_id:t})},onProductChange:function(t){this.addToCartWidget.onProductChange(D.a.clone(t.attributes)),this.updateAnimationTrigger(),this.addToCartWidget.showSkus?this.recalcSelectsTextSize(!0):(this.model.set({"attrs-text_w":0,"attrs-text_h":0}),this.addToCartWidget.setData(D.a.clone(this.model.attributes)),this.setMinimalDimensions())},onLayoutChange:function(t){this.addToCartWidget.onLayoutChange(D.a.clone(t.attributes)),this.updateAnimationTrigger()},determineButtonType:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.model.get("icon_enabled"),n=!!e.enter_edit_mode||this.addToCartWidget.getButtonText().length;t=i&&n?"text_and_icon":i&&!n?"icon":"text",this.model.set("tp",t)},onTypeChange:function(){},getRealTextSize:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=D.a.clone(this.model.attributes),a=o["".concat(n,"font-size")],r=o["".concat(n,"letter-spacing")],s=o["".concat(n,"font-family")],c=o["".concat(n,"font-style")],d=o["".concat(n,"font-weight")];return this.$textInputSizeAdjuster&&this.$textInputSizeAdjuster.length||(this.$textInputSizeAdjuster=Object(l.a)("<div/>"),this.$textInputSizeAdjuster.css({width:"auto","white-space":"pre"}).appendTo(this.$sizesCalculatingBlock)),this.$textInputSizeAdjuster.text(t),this.$textInputSizeAdjuster.css({"font-family":s,"font-style":c,"font-weight":d,"font-size":a+"px","letter-spacing":r+"px"}),e=this.$textInputSizeAdjuster.width(),i=this.$textInputSizeAdjuster.height(),this.$textInputSizeAdjuster.empty(),{width:e=2*Math.ceil(e/2),height:i=2*Math.ceil(i/2)}},recalcSelectsTextSize:function(t){if("selects"===this.selectionState||t){var e=this.addToCartWidget.getLongestAttribute(),i=2*this.addToCartWidget.getSelectsPadding(),n=this.getRealTextSize(e,"attrs-"),o=this.model.get("btn_w"),a=this.model.get("btn_h"),r=n.width+2*this.addToCartWidget.getHorizontalTextMargin(this.model.get("attrs-font-size")),s=n.height+2*this.addToCartWidget.getVerticalTextMargin(this.model.get("attrs-font-size")),l={"attrs-text_w":r,"attrs-text_h":s};r+i>o&&(l.btn_w=r+i),s>a&&(l.btn_h=s);var c=D.a.clone(this.model.attributes);if(this.addToCartWidget.setData(He(He({},c),l)),l.btn_w||l.btn_h){var d=this.addToCartWidget.recalcDimensionsOnProductChange();l.w=d.width,l.h=d.height,l.btn_w&&(l.x=c.x-Math.floor((d.width-c.w)/2)),l.btn_h&&(l.y=c.y-Math.floor((d.height-c.h)/2))}this.model.set(l),this.setMinimalDimensions.__debounced(),(l.btn_w||l.btn_h)&&this.updateAnimationTrigger()}},onAttrsIconSizeChange:function(t){var e=D.a.clone(t.attributes);this.addToCartWidget.applySelectsIconSize(e),this.setMinimalDimensions.__debounced();var i=e["attrs-icon-h"]+2*this.addToCartWidget.getVerticalIconMargin(e["attrs-icon-h"]);if(i>e.btn_h){var n={btn_h:i};this.addToCartWidget.setData(He(He({},e),n));var o=this.addToCartWidget.recalcDimensionsOnProductChange();n.w=o.width,n.h=o.height,n.y=e.y-Math.floor((o.height-e.h)/2),this.model.set(n),this.updateAnimationTrigger()}},recalcButtonTextSize:function(){var t,e=D.a.clone(this.model.attributes),i=this.addToCartWidget.getButtonText(),n=this.getRealTextSize(i),o=this.getRealTextSize("Out of stock"),a=n.width>o.width?n.width:o.width,r=n.height>o.height?n.height:o.height,s=this.addToCartWidget.getHorizontalTextMargin(e["font-size"]),l=a+2*s,c=r+2*this.addToCartWidget.getVerticalTextMargin(e["font-size"]),d=(Ve(t={},"text_w",l),Ve(t,"text_h",c),t);if("text"===e.tp||"text_and_icon"===e.tp){var h="text_and_icon"===e.tp&&e.icon_enabled?l+e.icon_w+s:l;if(h>e.btn_w&&(d.btn_w=h),c>e.btn_h&&(d.btn_h=c),this.addToCartWidget.setData(He(He({},e),d)),d.btn_w||d.btn_h){var u=this.addToCartWidget.recalcDimensionsOnProductChange();d.w=u.width,d.h=u.height,d.btn_w&&(d.x=e.x-Math.floor((u.width-e.w)/2)),d.btn_h&&(d.y=e.y-Math.floor((u.height-e.h)/2))}this.setMinimalDimensions.__debounced()}this.model.set(d),(d.btn_w||d.btn_h)&&this.updateAnimationTrigger()},onButtonTextSizeChange:function(){this.addToCartWidget.applyButtonTextSize(D.a.clone(this.model.attributes))},recalcButtonSizeOnIconChange:function(t){var e,i=2*this.addToCartWidget.getVerticalIconMargin(t.icon_h),n=2*this.addToCartWidget.getHorizontalIconMargin(t.icon_w),o=t.icon_h+i,a={};if("text_and_icon"===t.tp)e=t.text_w+t.icon_w+this.addToCartWidget.getHorizontalTextMargin(t["font-size"]);else{if("icon"!==t.tp)return;e=t.icon_w+n}if(e>t.btn_w&&(a.btn_w=e),o>t.btn_h&&(a.btn_h=o),a.btn_w||a.btn_h){this.addToCartWidget.setData(He(He({},t),a));var r=this.addToCartWidget.recalcDimensionsOnProductChange();a.w=r.width,a.h=r.height,a.btn_w&&(a.x=t.x-Math.floor((r.width-t.w)/2)),a.btn_h&&(a.y=t.y-Math.floor((r.height-t.h)/2)),this.model.set(a),this.updateAnimationTrigger()}},recalcButtonSize:function(){},initIcon:function(t){this.model.get("icon_enabled")&&this.getIconSVG(this.model.get("icon_noun_id")||this.model.get("icon_rm_id"),this.model.get("icon_noun_url"),function(e,i){!e&&i.$svg&&(this.renderIcon({$svg:this.getСoloredIconSVG()}),this.model.get("icon_rasterUrl")||this.rasterizeSVG({default:!0,hover:!0}),t&&"function"==typeof t&&t(null,null,{dontRasterize:!0}))}.bind(this))},renderIcon:function(){ue.prototype.renderIcon.apply(this,arguments)},recalcIconContainerSize:function(t,e,i){if("text"!==this.model.get("tp"))if(this.currentIconData){var n=this.model.get("icon_h"),o=Math.floor(n*this.currentIconData.aspect_ratio);this.model.set({icon_w:o});var a=D.a.clone(this.model.attributes);this.recalcButtonSizeOnIconChange(a),this.addToCartWidget.renderButtonIcon(a),this.addToCartWidget.setData(a),this.setMinimalDimensions.__debounced(),i&&i.dontRasterize||i&&(i.onIconChange||i.undo||i.redo)||this.rasterizeSVG.__debounced_both({default:!0,hover:!0})}else this.initIcon(this.recalcIconContainerSize.bind(this));else this.addToCartWidget.renderButtonIcon(D.a.clone(this.model.attributes))},rasterizeSVG:function(){ue.prototype.rasterizeSVG.apply(this,arguments)},onIconChange:function(t,e,i){if("boolean"==typeof e&&!1===e)return this.$buttonIcon.empty(),void this.recalcIconContainerSize(t,e,{onIconChange:!0});this.getIconSVG(t.get("icon_noun_id")||t.get("icon_rm_id"),t.get("icon_noun_url"),function(t,e){!t&&e.$svg&&(i.undo||i.redo||this.recalcIconContainerSize(null,null,{onIconChange:!0}),this.renderIcon({$svg:this.getСoloredIconSVG()}),i.undo||i.redo||this.rasterizeSVG({default:!0,hover:!0}))}.bind(this))},onIconPositionChange:function(){this.addToCartWidget.applyButtonIconPosition(D.a.clone(this.model.attributes))},onIconColorChange:function(){ue.prototype.onIconColorChange.apply(this,arguments)},"getСoloredIconSVG":function(){return ue.prototype.getСoloredIconSVG.apply(this,arguments)},getDefaultIconSVG:function(){return ue.prototype.getDefaultIconSVG.apply(this,arguments)},getIconSVG:function(){return ue.prototype.getIconSVG.apply(this,arguments)},prepareIconSVG:function(){return ue.prototype.prepareIconSVG.apply(this,arguments)},cacheSVGData:function(){ue.prototype.cacheSVGData.apply(this,arguments)},getSVGCacheItem:function(){return ue.prototype.getSVGCacheItem.apply(this,arguments)},updateBlockSizes:function(t){this.model.set({w:t.width,h:t.height})},saveWidgetData:function(){D.a.isEqual(this.model.toJSON(),this._oldAttrs)||(this.saveXHR&&this.saveXHR.abort(),this._oldAttrs=D.a.clone(this.model.toJSON()),this.saveXHR=this.model.save())},getIndividualStyles:function(){var t=["background-color","background-color-opacity","attrs-background-color","attrs-background-color-opacity","border-radius","attrs-border-radius","border-width","attrs-border-width","border-color","attrs-border-color","border-color-opacity","attrs-border-color-opacity","font-family","attrs-font-family","font-style","attrs-font-style","font-weight","attrs-font-weight","font-size","attrs-font-size","letter-spacing","attrs-letter-spacing","color","attrs-color","color-opacity","attrs-color-opacity","icon_color","icon_color_opacity","text-align","attrs-text-align","attrs-icon-size","hover-background-color","hover-background-color-opacity","attrs-hover-background-color","attrs-hover-background-color-opacity","hover-border-radius","attrs-hover-border-radius","hover-border-width","attrs-hover-border-width","hover-border-color","attrs-hover-border-color","hover-border-color-opacity","attrs-hover-border-color-opacity","hover-color","attrs-hover-color","hover-color-opacity","attrs-hover-color-opacity","hover-icon_color","hover-icon_color_opacity","hover-tansition-duration"];return t.forEach((function(t,e,i){i[e]="change:"+t})),t.join(" ")}},{defaults:{h:De.a.DEFAULT_ROW_HEIGHT,w:De.a.DEFAULT_ROW_WIDTH,x:"center",selected_product_id:"default",layout:"vertical",tp:"text",btn_w:168,btn_h:50,text_w:106,text_h:24,hidden:!1,select_btn_margin:10,attributes_margin:10,text:"Add to cart","background-color":"282828","background-color-opacity":100,"border-radius":30,"border-width":0,"border-color":"000000","border-color-opacity":100,"font-family":"Arial","font-style":"normal","font-weight":400,"font-size":18,"letter-spacing":0,"text-align":"center",color:"ffffff","color-opacity":100,"hover-background-color":"282828","hover-background-color-opacity":100,"hover-border-radius":30,"hover-border-width":0,"hover-border-color":"000000","hover-border-color-opacity":100,"hover-color":"ffffff","hover-color-opacity":100,"hover-tansition-duration":0,icon_color:"ffffff",icon_color_opacity:100,icon_enabled:!1,icon_h:18,icon_w:18,icon_rm_id:null,icon_noun_id:null,icon_noun_url:null,icon_pos:"left",icon_raster2xUrl:null,icon_rasterUrl:null,"hover-icon_color":"ffffff","hover-icon_color_opacity":100,"hover-icon_raster2xUrl":null,"hover-icon_rasterUrl":null,"attrs-background-color":"282828","attrs-background-color-opacity":100,"attrs-border-radius":30,"attrs-border-width":0,"attrs-border-color":"000000","attrs-border-color-opacity":100,"attrs-font-family":"Arial","attrs-font-style":"normal","attrs-font-weight":400,"attrs-font-size":18,"attrs-letter-spacing":0,"attrs-color":"ffffff","attrs-color-opacity":100,"attrs-hover-background-color":"282828","attrs-hover-background-color-opacity":100,"attrs-hover-border-radius":30,"attrs-hover-border-width":0,"attrs-hover-border-color":"000000","attrs-hover-border-color-opacity":100,"attrs-hover-color":"ffffff","attrs-hover-color-opacity":100,"attrs-icon-h":16,"attrs-icon-w":10,"attrs-text_w":0,"attrs-text_h":0}}),Ke=i("i8i4"),Ye=i.n(Ke),Xe=i("LazK"),Ze=i("3uGt"),Je=c.a.extend({name:"RM Header",thumb:"rm-header",icon_color:"#282828",initial_controls:["rmheader_settings","common_position","common_lock"],restrictions:function(){var t=window.RM.constructorRouter&&window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("permissions");return t&&t.can_use_rm_widgets},initialize:function(t,e){this.initBlock(t,e)},render:function(){var t=this;this.create(),this.$el.addClass("rm-header"),this.controls=this.initial_controls,Object(l.a)('<div id="rm-header-mobile-portal">').appendTo("body"),this.propsModel=new a.a.Model({isDesktop:"default"===this.model.getViewport()}),this.$header=this.$content.get(0);Object(h.renderReact)({component:function(){return s.a.createElement(h.CreateContextProvider,{context:Ze.b,model:t.propsModel},s.a.createElement(Xe.a,null))},domElement:this.$header,model:this.model}),this.bindModelEvents(),this.fixMobileViewport(),this.rendered=!0,this.triggerReady()},redraw:function(){return this.fixMobileViewport(),c.a.prototype.redraw.apply(this,arguments)},bindModelEvents:function(){this.model.on("change:activeLink",this.onActiveLinkChange,this)},unbindModelEvents:function(){this.model.off("change:activeLink",this.onActiveLinkChange,this)},onActiveLinkChange:function(){this.model.save()},destroy:function(){return this.unbindModelEvents(),Ye.a.unmountComponentAtNode(this.$header),c.a.prototype.destroy.apply(this,arguments)},fixMobileViewport:function(){var t="default"===this.model.getViewport();this.propsModel.set({isDesktop:t})}},{defaults:{activeLink:"none",full_width_initial_w:480,full_width_initial_x:0,full_width_margin:0,is_full_width:!0,fixed_position:"n",is_above:!0,is_global:!0,h:72,x:0,y:0,w:Object(l.a)(window).width()}}),Qe=i("1cLU"),ti=c.a.extend({name:"RM Footer",thumb:"rm-footer",icon_color:"#282828",initial_controls:["common_position","common_lock"],restrictions:function(){var t=RM.constructorRouter&&RM.constructorRouter.me&&RM.constructorRouter.me.get("permissions");return t&&t.can_use_rm_widgets},initialize:function(t,e){this.initBlock(t,e),this.propsModel=new Backbone.Model({isMobileViewport:!1})},render:function(){this.create(),this.$el.addClass("rm-footer"),this.controls=this.initial_controls,this.$footer=Object(l.a)("<div>").appendTo(this.$content).get(0),Object(h.renderReact)({component:Qe.a,domElement:this.$footer,model:this.propsModel}),this.fixMobileViewport(),this.rendered=!0,this.triggerReady()},redraw:function(){return this.fixMobileViewport(),c.a.prototype.redraw.apply(this,arguments)},fixMobileViewport:function(){var t="default"===this.model.getViewport();this.propsModel.set({isMobileViewport:!t})},destroy:function(){return Ye.a.unmountComponentAtNode(this.$footer),c.a.prototype.destroy.apply(this,arguments)}},{defaults:{full_width_initial_w:480,full_width_initial_x:0,full_width_margin:0,is_above:!1,is_full_width:!0,modelType:"widget",sticked:"bottom",sticked_margin:0,h:360,w:Object(l.a)(window).width(),y:656}}),ei=i("fEUr"),ii=i("3TY3");function ni(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function oi(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ni(Object(i),!0).forEach((function(e){ai(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ni(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function ai(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ri(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}var si,li,ci=c.a.extend({name:"Shots",thumb:"shots",icon_color:"#A4840D",sort_index:14,initial_controls:["shots_settings","playback_settings","common_animation","common_rotation","common_position","common_layer","common_lock"],viewport_fields:m.b.viewport_fields.shots,canBeUsed:function(){return window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("permissions").can_use_shots},canDirectLinkBeUsed:function(){return window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("permissions").can_use_shots_direct_link},initialize:function(t,e){var i=this;this.controls=t.get("basePath")?this.initial_controls:this.initial_controls.filter((function(t){return"playback_settings"!==t})),this.initBlock(t,e),this.page=e.page,this.listenTo(this.page,"change:viewport",this.onViewportChange),this.stateModel=new a.a.Model({viewport:this.page.getCurrentViewport(),canBeUsed:this.canBeUsed(),canDirectLinkBeUsed:this.canDirectLinkBeUsed()}),this.onViewportChange(),this.listenTo(this,"select",(function(){i.stateModel.set("isSelected",!0)})),this.listenTo(this,"deselect",(function(){i.stateModel.set("isSelected",!1)})),this.listenTo(this.model,"change:triggers",(function(){return i.resetAnimationTriggers()})),this.listenTo(this.model,"change:basePath",(function(t){t&&!i.controls.includes("playback_settings")&&(i.controls=i.initial_controls,i.updateControls())}))},render:(si=regeneratorRuntime.mark((function t(){var e,n,o,a,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.create(),this.$el.addClass("shots"),t.next=4,Promise.resolve().then(i.bind(null,"8AXF"));case 4:return e=t.sent,n=e.renderReact,t.next=8,Promise.resolve().then(i.bind(null,"3TY3"));case 8:o=t.sent,a=o.Shots,n({component:function(){return s.a.createElement(h.CreateContextProvider,{context:ii.ShotsStateContext,model:r.stateModel},s.a.createElement(a,{mode:"constructor",useSharedState:r.useSharedState}))},domElement:this.$content[0],model:this.model}),this.rendered=!0,this.triggerReady();case 14:case"end":return t.stop()}}),t,this)})),li=function(){var t=this,e=arguments;return new Promise((function(i,n){var o=si.apply(t,e);function a(t){ri(o,i,n,a,r,"next",t)}function r(t){ri(o,i,n,a,r,"throw",t)}a(void 0)}))},function(){return li.apply(this,arguments)}),getIconStyle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.small&&this.icon_color?{"background-color":this.icon_color}:{"background-repeat":"no-repeat","background-image":"url(".concat(Object(at.findImagePath)("./constructor/widgetbar/icons/".concat(this.thumb,".svg")),")"),"border-radius":"0"}},deselect:function(){this.selected&&!this.canBeUsed()&&window.RM.constructorRouter.trigger("notice:hide"),c.a.prototype.deselect.apply(this,arguments)},select:function(){this.selected||this.canBeUsed()||window.RM.constructorRouter.trigger("notice:show",Pe.b.UpgradeAccountToUse),c.a.prototype.select.apply(this,arguments)},destroy:function(){return this.stopListening(),this.stateModel.set({isDestroyed:!0}),c.a.prototype.destroy.apply(this,arguments)},onViewportChange:function(){var t=this.page.getCurrentViewport();this.stateModel.set({viewport:t}),this.nonReactSetSharedState({viewport:t})}},{getViewportDefaults:function(t,e,i){var n=t.get("hoverDirection");return oi(oi({},c.a.getViewportDefaults(t,e,i)),{},{hoverDirection:"default"!==e&&n===ei.a.vertically?ei.a.horizontally:n})},defaults:{basePath:"",numberOfImages:0,playbackType:ei.b.hover,scrollSpeed:1,scrollStartPoint:ei.c.bottom,scrollDelay:0,hoverDirection:ei.a.horizontally,triggers:[],startPointOffset:0}});e.a={text:it,video:rt,audio:ut,backgroundVideo:pt,background:wt,picture:$t,slideshow:Ut,twitter:qt,facebook:Jt,shape:te,iframe:oe,gmaps:ce,button:ue,hotspot:Oe,form:Ae,ecommercecart:Re,addtocart:qe,rmheader:Je,rmfooter:ti,shots:ci}},sxjd:function(t,e,i){"use strict";var n=i("q1tI"),o=i.n(n),a=i("Mpt7"),r=i("v83y"),s=i("wMS7"),l=i.n(s),c=i("8AXF"),d=i("8Tds"),h=i("fueH"),u=i("A9VP"),p=i("i0ke"),m=i("Pgkd"),g=i("3ES5"),f=i("uU7u"),v=i("zZDe"),b=i("DwEc"),y=i("HjzJ");function _(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return w(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var k=function t(e,i){if(i&&"function"==typeof i){for(var n=e.childNodes,o=0;o<n.length;o++)t(n[o],i);i(e)}},S=function(t){var e,i=function(t){var e=document.implementation.createHTMLDocument("");return e.documentElement.innerHTML=t,e};if("undefined"!=typeof DOMParser){var n=new DOMParser;try{null!==(e=n.parseFromString(t,"text/html"))&&null!==e.body||(e=i(t))}catch(n){e=i(t)}}else e=i(t);return e},x=function(t,e){var i=Array.from(t.childNodes).reduce((function(t,i){return i.nodeName.toLowerCase()===e&&t[t.length-1]&&t[t.length-1].some((function(t){return t.nodeName.toLowerCase()===e}))?(t[t.length-1].push(i),t):[].concat(_(t),[[i]])}),[]).reduce((function(t,i){if(i.some((function(t){return t.nodeName.toLowerCase()===e}))){var n=document.createElement(e),o="ul"===e?y.a.Unordered:y.a.Ordered;return n.setAttribute("class",o),"ol"===e&&(n.style.counterReset=y.i),i.forEach((function(t){if(t.firstChild){var e,i=t.firstChild.cloneNode(!0),a=null===(e=t.getAttribute("class"))||void 0===e?void 0:e.replace(o,""),r=t.getAttribute("style");a&&i.setAttribute("class",a),r&&i.setAttribute("style",r),n.appendChild(i)}})),[].concat(_(t),[n])}return[].concat(_(t),_(i))}),[]).reduce((function(t,e){return"".concat(t).concat(e.outerHTML)}),"");t.innerHTML=i},C=function(t){k(t,(function(t){if("span"===t.nodeName.toLowerCase()&&1===t.childNodes.length&&t.firstChild&&"span"===t.firstChild.nodeName.toLowerCase()){var e=t,i=e.firstChild,n=[e.getAttribute("style"),i.getAttribute("style")];e.setAttribute("style",n.join(";")),e.innerHTML=t.firstChild.innerHTML}}))},O=function(t){k(t,(function(t){if("a"===t.nodeName.toLowerCase()&&t.childNodes.length>1){var e=Array.from(t.childNodes).reduce((function(t,e){if("span"===e.nodeName.toLowerCase()&&e.style.fontSize){var i=parseInt(e.style.fontSize);return i>t?i:t}return t}),0);e>0&&(t.style.fontSize="".concat(e,"px"))}}))},j=function(t){t.querySelectorAll("li").forEach((function(t){if(t.childNodes.length){var e=document.createElement("span");e.innerHTML=t.innerHTML,t.innerHTML=e.outerHTML,e.remove()}}))},P=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{mergeSpans:!0},i=S(t);return e.mergeSpans&&C(i.body),x(i.body,"ol"),x(i.body,"ul"),j(i.body),O(i.body),i.body.innerHTML},E=i("Jzj8"),I=i("f3SV"),T=i("v92f");function M(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||A(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||A(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){if(t){if("string"==typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?R(t,e):void 0}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var D=function(t){var e,i=t.model,r=t.scale,s=t.currentPage,c=t.viewport,h=t.viewerOptions,p=t.editorState,_=Object(n.useMemo)((function(){return p.getCurrentContent()}),[p]),w=$(Object(E.k)(),1)[0],k=Object(n.useContext)(b.b).model,S=Object(m.b)({styleToHTML:function(t){var e=a.a.OrderedSet([t]),i=Object(u.b)(e);if(Object.keys(i).length)return o.a.createElement("span",{style:i})},blockToHTML:function(t){var e=t.data,i=e.textStyle,n=e.align,a=e.lineHeight,r=e.textIndent,s=e.paddings,l=void 0===s?{}:s,c=e.listStyle,d=Object(y.e)(t.type)?c:void 0,h=[t.type,i,n,d].filter((function(t){return t})).join(" "),u={textIndent:r,lineHeight:a?"".concat(a,"px"):void 0,paddingLeft:l.left,paddingRight:l.right,paddingTop:l.top,paddingBottom:l.bottom};if(Object(y.e)(t.type))return o.a.createElement(y.b,{type:t.type,className:h,style:u});var p=function(t){var e=[].concat(M(w.global),M(w.project)).find((function(e){return e.name===t}));return e?e.tag:I.a.AVAILABLE_TEXT_TAGS[0]}(i),m={className:h,style:u};return t.text||t.entityRanges&&t.entityRanges.length?o.a.createElement(p,m):o.a.createElement(p,m,o.a.createElement("br",null))},entityToHTML:function(t,e){var n=e;return t.type===f.f?o.a.createElement(f.a,{is_global:i.is_global,is_above:i.is_above,page:null==k?void 0:k.page,currentPageNum:null==s?void 0:s.num,data:t.data},n):t.type===v.b?o.a.createElement("br",null):n}})(_),x=!!window.RM.constructorRouter;return o.a.createElement(g.a,{bgColor:i.bgColor,textDirection:i.textDirection||d.b.LTR,autosize:i.autosize,columns:i.columns,verticalAlign:i.verticalAlign,scale:r,viewport:c||T.a.Default,viewerOptions:h,useBaseline:null===(e=i.flags)||void 0===e?void 0:e.baseline},o.a.createElement("div",{className:"text-viewer",dangerouslySetInnerHTML:{__html:l.a.sanitize(P(S,{mergeSpans:!x}),{ADD_ATTR:["target"]})}}))},B=o.a.memo(D,(function(t,e){var i,n,o,a,r,s;return!e.isConstructorPreview&&e.scale===t.scale&&(null===(i=e.model)||void 0===i||!i.is_above||!(!(null===(n=t.currentPage)||void 0===n?void 0:n.num)||(null===(o=e.pagesLinks)||void 0===o?void 0:o.length)&&(null===(a=e.currentPage)||void 0===a?void 0:a.num)&&(null===(r=t.currentPage)||void 0===r?void 0:r.num)&&(e.pagesLinks.includes(e.currentPage.num)||e.pagesLinks.includes(null===(s=t.currentPage)||void 0===s?void 0:s.num))))}));e.a=function(t){var e=t.editorState,i=t.isConstructorPreview,a=Object(n.useContext)(b.b).model,s=Object(n.useContext)(c.BackboneContext).model,l=e||Object(n.useMemo)((function(){return r.EditorState.createWithContent(h.a.importTextContent(s),p.a)}),[]),d=window.RM.constructorRouter&&!window.RM.constructorRouter.preview,u=Object(n.useMemo)((function(){if(d)return[];var t=h.a.getAllEntities(l,f.f);return Object.keys(t).length?Object.keys(t).filter((function(e){var i;return(null===(i=t[e].data)||void 0===i?void 0:i.type)===f.b.Page})).map((function(e){var i;return null===(i=t[e].data)||void 0===i?void 0:i.pageNum})):[]}),[l]);return o.a.createElement(B,{model:s,editorState:l,scale:null==a?void 0:a.scale,currentPage:null==a?void 0:a.currentPage,viewport:null==a?void 0:a.viewport,viewerOptions:null==a?void 0:a.viewerOptions,isConstructorPreview:i,pagesLinks:u})}},t2H3:function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("iC7s"),s=i("+IKJ");function l(){return(l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function c(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var d=Object(n.e)(r.m).withConfig({displayName:"ValidationTooltip___StyledBox"})(["visibility:",";"],(function(t){return t._css})),h=Object(o.forwardRef)((function(t,e){var i=t.text,n=c(t,["text"]),h=Object(o.useRef)(null);return a.a.createElement(d,l({ref:e,height:32,p:"0 8px 0 0"},n,{_css:n.visibility||"visible"}),a.a.createElement(r.Fb,{text:i,arrowRef:h,arrowPosition:{left:"100%"},bg:Object(s.e)(.04,r.Ub.tomato),translateX:-4,rotation:-90}))}));e.a=h},tRog:function(t,e,i){"use strict";var n=i("xi34"),o=i("rFsW"),a=i("Kw5r"),r=i("OTSC"),s={model:{event:"change"},props:{value:Number,autofocus:{type:Boolean,default:!1},autosize:{type:Boolean,default:!1},wait:{type:Number,default:null},min:{type:Number,default:Number.NEGATIVE_INFINITY},max:{type:Number,default:Number.POSITIVE_INFINITY},dir:{type:String,default:"v"},speed:{type:Number,default:3},step:{type:Number,default:1},labelSelector:{type:String,default:""},shiftStep:{type:Number,default:10},useFloat:{type:Boolean,default:!1},mouseOnly:{type:Boolean,default:!1},mouseUse:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},thousandDelimiter:{type:String,default:""},debounceKeyboard:{type:Number,default:void 0}},computed:{computedValue:{get:function(){var t,e=this;return t=this.$$el?this.$$el.data("formatValue")(this.value):this.value,this.autosize&&a.default.nextTick((function(){r.default.setInputSize(Object(n.a)(e.$el),150)})),t}}},watch:{mouseUse:function(t){var e=this;a.default.nextTick((function(){var t=e.$$el.data("destroy");o.a.isFunction(t)&&t(),Object(n.a)(e.$$el).RMNumericInput({onChange:e.onChange,labelSelector:e.labelSelector,useFloat:e.useFloat})}))},min:function(t){this.$$el.data("changeMinMax")(t)},max:function(t){this.$$el.data("changeMinMax")(void 0,t)}},mounted:function(){this.$$el=Object(n.a)(this.$el);var t=function(){Object(n.a)(this.$$el).RMNumericInput({onChange:this.onChange,labelSelector:this.labelSelector,useFloat:this.useFloat}),this.$$el.data("formatValue")(this.value),this.autosize&&r.default.setInputSize(Object(n.a)(this.$el),150,this.$$el.val())}.bind(this);this.wait?r.default.waitForTransitionEnd(this.$$el,this.wait,"opacity",function(){t()}.bind(this)):t()},methods:{onChange:function(t,e){this.disabled||this.$emit("change",e)},updateSize:function(){r.default.setInputSize(this.$$el,200)}}},l=(i("+Xeu"),i("KHd+")),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{staticClass:"param-input",attrs:{type:"text",spellcheck:"false","data-useFloat":t.useFloat,"data-step":t.step,"data-min":t.min,"data-max":t.max,"data-mouseDir":t.dir,"data-mouseSpeed":t.speed,"data-shiftStep":t.shiftStep,"data-autofocus":t.autofocus,"data-autoSize":t.autosize,wait:t.wait,"data-mouseOnly":t.mouseOnly,readonly:t.readonly||t.mouseOnly,disabled:t.disabled,"data-mouseUse":t.mouseUse+"","data-thousandDelimiter":t.thousandDelimiter,"data-debounceKeyboard":t.debounceKeyboard},domProps:{value:t.computedValue}})}),[],!1,null,null,null);e.a=c.exports},tVJf:function(module,exports){module.exports={"template-constructor-control-form_styles":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="icon noarrow" data-alt="Styles" data-alt-pos="left" data-alt-offset="9"></div>\n\n\n\t<div class="panel">\n\n\t\t<div class="common-wrapper">\n\n\t\t\t<div class="edit-wrapper" data-state="fields" data-button-state="default" data-style="" data-layout="">\n\n\t\t\t\t<div class="control-caption">Layout</div>\n\n\t\t\t\t<div class="layout-wrapper">\n\t\t\t\t\t<div class="layout-switcher layout-vertical"></div>\n\t\t\t\t\t<div class="layout-switcher layout-horizontal"></div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="style-wrapper">\n\t\t\t\t\t<div class="prev-style"></div>\n\t\t\t\t\t<div class="style-caption"></div>\n\t\t\t\t\t<div class="next-style"></div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="type-wrapper">\n\t\t\t\t\t<div class="type-switcher type-fields">Fields</div>\n\t\t\t\t\t<div class="type-switcher type-button">Button</div>\n\t\t\t\t</div>\n\n\n\t\t\t\t<div class="button-switcher-wrapper">\n\t\t\t\t\t<div class="button-switcher button-default">Default</div>\n\t\t\t\t\t<div class="button-switcher button-hover">Hover</div>\n\t\t\t\t</div>\n\n\n\n\t\t\t\t<div class="params-wrapper">\n\n\t\t\t\t\t\x3c!-- Fields --\x3e\n\t\t\t\t\t<div class="params-block params-fields">\n\n\t\t\t\t\t\t<div class="edit-item" data-field="gutter">\n\t\t\t\t\t\t\t<div class="caption">Spacing</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator color-click-area" data-field="color" data-field-dop="opacity">\n\t\t\t\t\t\t\t<div class="caption">Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="border-radius">\n\t\t\t\t\t\t\t<div class="caption">Radius</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item combined separator" data-field="border-width">\n\t\t\t\t\t\t\t<div class="caption">Border</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\n\t\t\t\t\t\t\t<div class="edit-item border-color color-click-area" data-field="border-color" data-field-dop="border-opacity">\n\t\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item combined separator" data-field="underline-width">\n\t\t\t\t\t\t\t<div class="caption">Underline</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\n\t\t\t\t\t\t\t<div class="edit-item underline-color color-click-area" data-field="underline-color" data-field-dop="underline-opacity">\n\t\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t \x3c!-- Font Family --\x3e\n\t\t\t\t\t\t<div class="edit-item separator font-family-click-area" title="Font Family">\n\t\t\t\t\t\t\t<div class="font-family"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\x3c!-- Font Style --\x3e\n\t\t\t\t\t\t<div class="edit-item separator font-style-click-area" title="Font Style">\n\t\t\t\t\t\t\t<div class="font-style"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator color-click-area" data-field="text-color" data-field-dop="text-opacity">\n\t\t\t\t\t\t\t<div class="caption">Text Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="font-size" title="Font Size">\n\t\t\t\t\t\t\t<div class="font-size-icon"></div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="letter-spacing" title="Tracking">\n\t\t\t\t\t\t\t<div class="letter-spacing-icon"></div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\n\n\n\n\n\n\n\t\t\t\t\t\x3c!-- Button default --\x3e\n\t\t\t\t\t<div class="params-block params-button-default">\n\n\t\t\t\t\t\t<div class="edit-item" data-field="gutter">\n\t\t\t\t\t\t\t<div class="caption"></div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator color-click-area" data-field="color" data-field-dop="opacity">\n\t\t\t\t\t\t\t<div class="caption">Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="border-radius">\n\t\t\t\t\t\t\t<div class="caption">Radius</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item combined separator" data-field="border-width">\n\t\t\t\t\t\t\t<div class="caption">Border</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\n\t\t\t\t\t\t\t<div class="edit-item border-color color-click-area" data-field="border-color" data-field-dop="border-opacity">\n\t\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t \x3c!-- Font Family --\x3e\n\t\t\t\t\t\t<div class="edit-item separator font-family-click-area" title="Font Family">\n\t\t\t\t\t\t\t<div class="font-family"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t\x3c!-- Font Style --\x3e\n\t\t\t\t\t\t<div class="edit-item separator font-style-click-area" title="Font Style">\n\t\t\t\t\t\t\t<div class="font-style"></div>\n\t\t\t\t\t\t\t<div class="popup-arrow"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator color-click-area" data-field="text-color" data-field-dop="text-opacity">\n\t\t\t\t\t\t\t<div class="caption">Text Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="font-size" title="Font Size">\n\t\t\t\t\t\t\t<div class="font-size-icon"></div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item separator" data-field="letter-spacing" title="Tracking">\n\t\t\t\t\t\t\t<div class="letter-spacing-icon"></div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator align" data-field="align" title="Align">\n\t\t\t\t\t\t\t<div class="caption"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\n\n\n\n\n\n\t\t\t\t\t\x3c!-- Button hover --\x3e\n\t\t\t\t\t<div class="params-block params-button-hover">\n\n\t\t\t\t\t\t<div class="edit-item color-click-area" data-field="color"  data-field-dop="opacity">\n\t\t\t\t\t\t\t<div class="caption">Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\n\t\t\t\t\t\t<div class="edit-item combined separator" data-field="border-width">\n\t\t\t\t\t\t\t<div class="caption">Border</div>\n\t\t\t\t\t\t\t<input spellcheck="false" type="text" value=""/>\n\n\t\t\t\t\t\t\t<div class="edit-item border-color color-click-area" data-field="border-color" data-field-dop="border-opacity">\n\t\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator color-click-area" data-field="text-color" data-field-dop="text-opacity">\n\t\t\t\t\t\t\t<div class="caption">Text Color</div>\n\t\t\t\t\t\t\t<div class="opacity-grid"></div>\n\t\t\t\t\t\t\t<div class="color-circle"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class="edit-item separator clearfix" data-field="transition">\n\t\t\t\t\t\t\t<div class="caption" title="For Color, Border Color & Width, Text Color">Transition</div>\n\t\t\t\t\t\t\t<div class="switcher transition-switcher"></div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\n\t\t</div>\n\n\n\t\t<div class="colorbox_container"></div>\n\n\t\t<div class="fontselector_container"></div>\n\n\t\t<div class="fontstyle_container">\n\t\t\t<div class="font-style-wrapper"></div>\n\t\t</div>\n\n\t</div>\n\n';return __p}}},tb9p:function(t,e,i){},tcT1:function(t,e,i){"use strict";i.r(e);var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("5ta/"),l=i("avvt"),c=i("OTSC"),d=i("f3SV"),h=i("JW7n"),u=i("fueH");function p(t,e,i,n,o,a,r){try{var s=t[a](r),l=s.value}catch(t){return void i(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function m(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function r(t){p(a,n,o,r,s,"next",t)}function s(t){p(a,n,o,r,s,"throw",t)}r(void 0)}))}}var g,f,v,b=a.a.Router.extend({routes:{":user/:mag/num/:pageNum/":"startByPageNum",":user(/)(:mag)(/)(*pageUri)(/)":"start"},mags:{},initialize:function(){var t=this;if(Modernizr.addTest("chrome",(function(){return r.a.isObject(window.navigator)&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),RM.common.isDomainViewer&&(RM.common.customDomainProfile?this.route(":mag(/)(*pageUri)(/)","start"):this.route("(*pageUri)(/)","start")),RM.common.isDownloadedSource&&(this.route("(*pageUri)(/)","start"),/msie [6-9]/i.test(navigator.userAgent)&&(location.href="sorry.html")),Object(n.a)("html").toggleClass("viewer-embed-mode",!!RM.common.embedMode),r.a.bindAll(this),this.environment=d.a.environment.viewer,this.started=!1,!RM.common.isDownloadedSource&&window.RM.data.usersLoader.me&&(this.me=window.RM.data.usersLoader.me),this.$mags_container=Object(n.a)("#mags"),this.magsData=window.ServerData&&window.ServerData.mags,this.userPermissions=window.ServerData&&window.ServerData.userPermissions,this.internalHistory=[],this.magsData){if(this.cachedMag=this.magsData.mag,!this.cachedMag||!this.cachedMag.user||!this.cachedMag.user._id)return;RM.common.isDownloadedSource||(this.cachedMag.user.isMe=this.me&&this.me.get("_id")==this.cachedMag.user._id),RM.common.isDomainViewer&&(this.magUri=this.cachedMag.uri,this.userUri=this.cachedMag.user&&this.cachedMag.user.uri)}RM.screenshot||i.e(13).then(i.bind(null,"hXNS")).then((function(e){var i=e.default;RM.analytics=RM.analytics||new i({router:t}),t.analytics=RM.analytics,RM.common.isDomainViewer||c.default.processCustomTrackingEventCookies()})),this.isPreview||Modernizr.sessionstorage&&window.sessionStorage.removeItem("constructorViewport")},startByPageNum:function(t,e,i){this.start(t,e,null,i)},getPageUrlFromCodeExportLink:function(t){var e;if(!t)return t;if(null===(e=window.RM.config)||void 0===e?void 0:e.root){var i=window.RM.config.root;return"/"===i[0]&&(i=i.substr(1)),t.replace(i,"")}return t},start:function(t,e,o,s){var c=this;if(RM.common.isDomainViewer&&(this.magsData.magNotFound||this.magsData.domainNotFound||this.magsData.magNotPublished||this.magsData.subscriptionExpired))i.e(2).then(i.bind(null,"AnuO")).then((function(t){new(0,t.default)({type:"domain-error",$container:Object(n.a)("#service-pages"),templateData:{state:c.magsData}}).render()}));else if(Modernizr.msie||Modernizr.msie11)Promise.resolve().then(i.bind(null,"YqYG")).then((function(t){new(0,t.default)({$parent:Object(n.a)("body > .popups"),router:c,opts:{type:"type-browsers-viewer"}}).render()}));else{if(!s)if(RM.common.isDomainViewer&&!RM.common.customDomainProfile)parseInt(t,10)!=t&&t&&/^p\d+\/?$/i.test(t)?(o=null,e=t,t=null):(o=t,t=this.userUri,e=this.magUri),RM.common.isDownloadedSource&&(o=this.getPageUrlFromCodeExportLink(o));else if(RM.common.isDownloadedSource)o=this.getPageUrlFromCodeExportLink(t),t=null,e=null;else if(parseInt(t,10)==t||/^p\d+\/?$/i.test(t)){var d=e;e=t,o=d,t=null}else if(RM.common.customDomainProfile){d=e;e=t,o=d,t=this.userUri}else if(!e)return this.notFound();this.latestFragment=a.a.history.getFragment(),o=o||1,s&&(o=s);var h=t+"_"+e;if(this.username=t,this.started!=h||this.loaded==h)if(this.started=h,this.loaded!=this.started){if(this.cachedMag&&!r.a.isEmpty(this.cachedMag))return this.cachedMag instanceof l.a||this.cachedMag.forbidden||this.cachedMag.is_suspended||(this.cachedMag=new l.a(this.cachedMag,this)),this.mag=this.cachedMag,void this.onLoadMag(o,!!s);this._loadingMagDataXHR&&this._loadingMagDataXHR.abort(),this._loadingMagDataXHR=this.fetchData(this.username,e,{success:r.a.bind((function(t){this.mag&&this.mag.num_id&&t&&t.num_id!=this.mag.num_id&&window.location.reload(),this.mag=new l.a(t,this),this.cachedMag=this.mag,this.onLoadMag(o,!!s)}),this),error:this.notFound})}else this.go(o,{animation:!1,isPageNum:!!s})}},onLoadMag:function(t,e){var i;if(this.loaded=this.started||!0,this.mag.forbidden)return this.requestMagPassword(this.latestFragment,r.a.clone(this.mag)),delete this.cachedMag,delete this.loaded,void delete this.started;this.mag.is_suspended?this.showSuspended():(!this.isPreview&&(u.a.hasNewTextWidgets(window.ServerData&&window.ServerData.mags&&window.ServerData.mags.mag)||u.a.hasNewTextWidgets(this.mag&&this.mag.model&&this.mag.model.attributes)||u.a.someTextWidgets(this.mag.aboveGlobalWidgetsData))&&Object(h.d)("viewer"),RM.common.isDownloadedSource||(n.a.post("/api/countview/"+this.mag.num_id),RM.analytics&&(RM.analytics._triggerProjectView=!0)),this.mag._requested_page&&!e?(i=this.mag._requested_page,delete this.mag._requested_page):i=t,Modernizr.addTest("screenshot-mode",(function(){return RM.screenshot})),this.mag.render(),this.go(i,{animation:!1,isPageNum:e}),RM.common.mode="mag")},getAnalyticsDimensions:function(){return{magId:this.mag&&this.mag.model&&this.mag.model.get("num_id")||this.mag&&this.mag.num_id,magCreatorId:this.mag&&this.mag.model&&this.mag.model.user.get("_id")||this.mag&&this.mag.user._id,pageType:"viewer",userId:this.me&&this.me.get("_id")}},fetchData:function(t,e,i){return(i=i||{}).url=t?"/api/readymag/"+t+"/"+e:"/api/readymag/"+e,n.a.ajax(i)},sendReadyEvent:function(t){t=t||{},t=r.a.defaults(t,{page:{}});var e=document.createElement("MyExtensionDataElement");e.setAttribute("width",t.page.width),e.setAttribute("height",t.page.height),e.setAttribute("_id",t.page._id),document.documentElement.appendChild(e);var i=document.createEvent("Events");if(t&&t.error?i.initEvent("MyErrorEvent",!0,!1):i.initEvent("MyExtensionEvent",!0,!1),e.dispatchEvent(i),window.loadNotifier){if(t.error)return window.loadNotifier({error:t.error});window.loadNotifier({width:t.page.width,height:t.page.height})}},setTitle:function(){if(this.mag&&this.mag.currentPage){var t=r.a.extend({},this.mag.model.toJSON());t.user=this.mag.user,document.title=s.getFinalSEO(this.mag.currentPage,t,{customDomain:!!RM.common.isDomainViewer}).title}},trackPage:function(){RM.screenshot||r.a.defer(r.a.bind((function(){this.analytics&&this.analytics.trackPage()}),this))},go:function(t,e){if(t=t||1,e.isPageNum)return this.mag.showPage(t,e);var i=this.mag.getPageByPath(t)||{};this.mag.showPage(i.num||t,e)},goBack:function(){var t=this.internalHistory[this.internalHistory.length-2];t&&(t&&this.go(t,{skipInternalHistory:!0}),this.internalHistory.pop())},setUrlString:function(t){if(!this.noUrlRewrite&&(t=t||{},!RM.screenshot)){var e,i=this.mag.currentPage;if(e=RM.common.isDomainViewer&&!RM.common.customDomainProfile||RM.common.isDownloadedSource?"":RM.common.customDomainProfile?this.getMagUri(this.mag):this.username?this.mag.user.uri+"/"+(this.mag.uri||this.mag.num_id)+"/":this.isPreview?this.mag.num_id+"/":this.getMagUri(this.mag),this.isPreview&&(e+="preview/"),i&&"1"!=i.num&&(e+=(i.pagePath||i.uri||i.num.toString())+"/"),t.skipInternalHistory?RM.analytics&&RM.analytics.sendEvent("Back Link",e):this.internalHistory.push(i.num.toString()),e!==a.a.history.getFragment()){var n=(parseInt(r.a.last(a.a.history.getFragment(),"/"))||1)==i.num||t.replace;RM.common.isDownloadedSource&&"/"!==r.a.last(e)&&(e+="/"),RM.common.homepageRewrite||this.navigate(e,{replace:n})}}},getPreviousFragment:function(){return this.internalHistory[this.internalHistory.length-2]},getMagUri:function(t){return RM.common.customDomainProfile?(t.uri||t.num_id)+"/":RM.common.isDomainViewer?"":r.a.isEmpty(t.user)?t.num_id+"/":t.user.uri+"/"+(t.uri||t.num_id)+"/"},getUserPermissions:function(){return this.userPermissions||[]},onError:function(){this.mag&&this.go(1,{animation:!1})},createLoginViewForIframe:function(t,e,o){var a=this;Promise.resolve().then(i.bind(null,"BVsp")).then((function(i){new(0,i.default)({useNavigate:!1,$node:Object(n.a)(t),router:a,joinCallback:e,errorMessages:o}).render()}))},createMagFromTemplate:(v=m(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(i.bind(null,"5Rpd"));case 2:new(0,t.sent.default)({router:this,me:this.me,tp:e,templateID:n});case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)}),destroy:function(){this.cachedMag&&this.cachedMag.destroy(),this.magPasswordView&&this.magPasswordView.remove(),this.magSuspendedView&&this.magSuspendedView.remove()},requestMagPassword:(f=m(regeneratorRuntime.mark((function t(e,o){var a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.magPasswordView){t.next=6;break}return t.next=3,i.e(10).then(i.bind(null,"3r0x"));case 3:a=t.sent,r=a.default,this.magPasswordView=new r({router:this,$parent:Object(n.a)("#mags")});case 6:this.magPasswordView.render({mag:o,mag_url:e});case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)}),showSuspended:(g=m(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e(2).then(i.bind(null,"AnuO"));case 2:e=t.sent,new(0,e.default)({type:"mag-suspended",$container:Object(n.a)("#service-pages")}).render();case 6:case"end":return t.stop()}}),t)}))),function(){return g.apply(this,arguments)}),notFound:function(){r.a.defer(m(regeneratorRuntime.mark((function t(){var e,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.e(2).then(i.bind(null,"AnuO"));case 2:e=t.sent,o=e.default,new o({type:"404",$container:Object(n.a)("#service-pages")}).render();case 6:case"end":return t.stop()}}),t)}))))}});e.default=b},tcpm:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("pFlR"),l=i("OTSC"),c=i("f3SV"),d=i("yWjQ"),h=i.n(d),u=i("QNiq"),p=i("X7yJ"),m=i("roQd");function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function v(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var y=a.a.View.extend({THUMBNAILS_HEIGHT:72,COUNTERS_HEIGHT:40,COUNTERS_ADDITIONAL_SPACE:30,COUNTER_WIDTH:14,THUMBNAIL_WIDTH:56,THUMBNAIL_PADDING:8,THUMBNAILS_PADDING:16,swipeStartDistance:5,scrollStartDistance:3,swipeDistance:35,IMG_ACCELERATION_DELAY:500,AUTOPLAY_DELAY:4,SLIDER_TRANSITION:.5,events:{"click .images .prev-picture-arrow-middle":"prevImage","click .images .next-picture-arrow-middle":"nextImage","click .images .prev-picture-arrow-bottom":"prevImage","click .images .next-picture-arrow-bottom":"nextImage","click .images .fullscreen":"toggleFullscreen","click .counters-dots .counter":"counterClick","click .thumbnails .thumb":"thumbnailClick","click .images":"onImageClick","blur .captions .caption":"onCaptionBlur","mousemove .images.mouseover":"onMouseMove","mouseover .images.mouseover.viewer":"onMouseMove","mouseout  .images.mouseover.viewer":"onMouseOut","mouseenter  .images.play-on-hover.viewer":"onMouseEnter","mousemove  .images.play-on-hover.viewer":"changeSlideonHover","mouseleave  .images.play-on-hover.viewer":"stopAutoplay"},initialize:function(t,e,i,o,a){r.a.bindAll(this),this.template=h.a["template-common-slideshow-player"],this.block=o,this.model=o&&o.model,this.params=t,this.$container=e,this.environment=i,this.preloadImagesList=[],this.indexArr=[],this.mag=a,"constructor"===this.environment&&this.checkNeedUpdateWidget(),this.params.w=Math.ceil(this.params.w),this.handleCounters="constructor"===i||t.theme_data.counters&&"dots"===t.theme_data.counters_type||"theme_captions"===t.current_theme,this.handleThumbnails="constructor"===i||t.theme_data.thumbnails,this.currentPic={$el:null,num:null},this.initialRender=!0,this.lastClick=0,this.slidesDirection="",this.render(),this.applyVisualState(t),this.applyPictures(t),this.applyTextStyles(t);var s=this.params.pictures||[];if(this.handleCounters&&this.$counters_container.css("width",s.length*this.COUNTER_WIDTH),this.$counters_container.children(":first-child").addClass("active"),this.handleThumbnails&&this.$thumbnails_container.css("width",s.length*(this.THUMBNAIL_WIDTH+this.THUMBNAIL_PADDING)-this.THUMBNAIL_PADDING),this.$thumbnails_container.children(":first-child").addClass("active"),this.recalcCounters(t),this.recalcThumbnails(t),this.moveToImage(this.currentImageID,!1,"change-pictures"),"viewer"===this.environment){var l=this.preloadImagesList.length;if(!l)return r.a.defer(r.a.bind((function(){this.trigger("ready")}),this));var c=r.a.sortBy(s,"num")[0],d=p.a.getLqipUrl(c);if(d&&this.mag&&this.mag.opts&&this.mag.opts.lqip){var m=Object(n.a)("<div>").addClass("lqip-wrapper").css({height:"".concat(this.params.images_h,"px"),"border-radius":t.theme_data.radius?"".concat(t.theme_data.radius,"px"):""});Object(n.a)("<div>").addClass("lqip").css({transform:"scale(".concat(t.theme_data.fill?1.1:.97,")"),"border-radius":t.theme_data.radius?"".concat(t.theme_data.radius,"px"):"","background-image":"url(".concat(d,")"),"background-size":this.setImageSize(t.theme_data.fill,c.width,c.height,t.w,t.images_h)}).appendTo(m),m.prependTo(this.$images),this.$images.addClass("lqip")}var g=r.a.bind((function(){--l||this.isDestroyed||(this.$images.hasClass("lqip")&&(this.$images.find(".lqip-wrapper").remove(),this.$images.removeClass("lqip")),this.loadRemainingImages(),this.trigger("ready"))}),this);r.a.each(this.preloadImagesList,(function(t){this.isDestroyed||(t.preload=new Image,Object(n.a)(t.preload).on("load",g).on("error",g),t.preload.src=t.url)}),this)}this.$container.append(this.$el),this.initialRender=!1,this.handleCounters&&u.a.isDesktop&&(this.counters_scroll=this.$counters_scroll_wrapper.RMScroll({$container:this.$counters.find(".items-wrapper"),$content:this.$counters_container,$handle:this.$counters.find(".scroll"),wheelScrollSpeed:.1,scrollStep:14,tp:"horizontal",needRecalc:!1}).data("scroll")),this.handleThumbnails&&(u.a.isDesktop?this.thumbnails_scroll=this.$thumbnails_scroll_wrapper.RMScroll({$container:this.$thumbnails.find(".items-wrapper"),$content:this.$thumbnails_container,$handle:this.$thumbnails.find(".scroll"),wheelScrollSpeed:.3,onScroll:this.preloadThumbImages,tp:"horizontal",needRecalc:!1}).data("scroll"):this.$thumbnails.find(".items-wrapper").bind("scroll",this.preloadThumbImages)),this.setSwipeAction()},render:function(){this.setElement(Object(n.a)(this.template({tp:this.environment}))),this.$el.attr("data-id",this.params._id),this.$images=this.$(".images"),this.$images_wrapper=this.$images.find(".images-wrapper"),this.$middle_arrows=this.$images.find(".arrow-middle"),this.$bottom_arrows=this.$images.find(".arrow-bottom"),this.$bottom_arrows_container=this.$images.find(".bottom-arrows"),this.$counters=this.$(".counters-dots"),this.$counters_container=this.$counters.find(".items"),this.$counters_scroll_wrapper=this.$counters.find(".scroll-wrapper"),this.$thumbnails=this.$(".thumbnails"),this.$thumbnails_container=this.$thumbnails.find(".items"),this.$thumbnails_scroll_wrapper=this.$thumbnails.find(".scroll-wrapper"),this.$captions=this.$(".captions")},checkNeedUpdateWidget:function(){(r.a.has(this.model.get("theme_data"),"arrows_position")||r.a.has(this.model.attributes,"active_arrows")||"theme_captions"===this.model.get("current_theme"))&&"bottom"!==this.model.get("active_arrows")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{arrows_position:"bottom"})},{silent:!0}),r.a.has(this.model.get("theme_data"),"arrows_position")||(r.a.has(this.model.attributes,"active_arrows")||"theme_captions"!==this.model.get("current_theme"))&&"middle"!==this.model.get("active_arrows")&&r.a.has(this.model.attributes,"active_arrows")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{arrows_position:"sides"})},{silent:!0}),(r.a.has(this.model.get("theme_data"),"counters_position")||r.a.has(this.model.attributes,"active_arrows")||"theme_captions"!==this.model.get("current_theme"))&&"middle"!==this.model.get("active_arrows")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{counters_position:"outside"})},{silent:!0}),r.a.has(this.model.get("theme_data"),"counters_position")||"bottom"!==this.model.get("active_arrows")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{counters_position:"inside"})},{silent:!0}),r.a.has(this.model.get("theme_data"),"arrows")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{arrows:!0})},{silent:!0}),r.a.has(this.model.get("theme_data"),"arrows_type")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{arrows_type:"default"})},{silent:!0}),"noun"===this.model.get("theme_data").arrows_type&&this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{arrows_type:"library"})},{silent:!0}),this.model.get("theme_data").autoplay&&!r.a.has(this.model.attributes,"play_method")&&this.model.set({play_method:"autoplay"},{silent:!0}),r.a.has(this.model.get("theme_data"),"counters_type")||"theme_captions"===this.model.get("current_theme")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{counters_type:"numbers"})},{silent:!0}),r.a.has(this.model.get("theme_data"),"counters_type")||"theme_captions"!==this.model.get("current_theme")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{counters_type:"dots"})},{silent:!0}),r.a.has(this.model.get("theme_data"),"captions")||"theme_captions"===this.model.get("current_theme")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{captions:!1})},{silent:!0}),r.a.has(this.model.get("theme_data"),"captions")||"theme_captions"!==this.model.get("current_theme")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{captions:!0})},{silent:!0}),r.a.has(this.model.get("theme_data"),"counters")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{counters:!1})},{silent:!0}),r.a.has(this.model.get("theme_data"),"left_icon_noun")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{left_icon_noun:{}})},{silent:!0}),r.a.has(this.model.get("theme_data"),"right_icon_noun")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{right_icon_noun:{}})},{silent:!0}),r.a.has(this.model.attributes,"current_mode")||this.model.set({current_mode:"default"},{silent:!0}),r.a.has(this.model.get("theme_data"),"arrows_view_mode")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{arrows_view_mode:"normal"})},{silent:!0}),r.a.has(this.model.get("theme_data"),"radius")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{radius:0})},{silent:!0}),r.a.has(this.model.attributes,"transition_type")||this.model.set({transition_type:"slider"},{silent:!0}),r.a.has(this.model.attributes,"play_method")&&this.model.get("play_method")||this.model.set({play_method:"click"},{silent:!0}),r.a.has(this.model.get("theme_data"),"crossfade")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{crossfade:2})},{silent:!0}),r.a.has(this.model.get("theme_data"),"scroll_delay")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{scroll_delay:1})},{silent:!0}),r.a.has(this.model.get("theme_data"),"start_offset")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{start_offset:200})},{silent:!0}),r.a.has(this.model.get("theme_data"),"slider_transition")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{slider_transition:.5})},{silent:!0}),r.a.has(this.model.get("theme_data"),"autoplay_delay")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{autoplay_delay:4})},{silent:!0}),r.a.has(this.model.get("theme_data"),"hover_delay")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{hover_delay:.8})},{silent:!0}),r.a.has(this.model.get("theme_data"),"controls_bg")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{controls_bg:!0})},{silent:!0}),r.a.has(this.model.get("theme_data"),"show_on_hover")||this.model.set({theme_data:r.a.extend(this.model.get("theme_data"),{show_on_hover:!1})},{silent:!0}),r.a.has(this.model.attributes,"current_theme")&&this.model.unset("current_theme",{silent:!0}),r.a.has(this.model.attributes,"active_arrows")&&this.model.unset("active_arrows",{silent:!0})},loadRemainingImages:function(t){var e,i;if(e=(t=t||this.$images_wrapper.children().filter((function(){return Object(n.a)(this).attr("data-src")})).toArray()).length<2?t.length:2,t&&t.length)for(i=0;i<=e;i++)this.preloadPictures(t,i,e)},preloadPictures:function(t,e,i){var o=new Image,a=this;t&&t[e]&&t[e].hasAttribute("data-src")&&(o.onload=function(){Object(n.a)(t[e]).css({"background-image":'url("'+Object(n.a)(t[e]).attr("data-src")+'")'}).removeAttr("data-src"),a.indexArr.push(e),a.indexArr.length-1===i&&(t.splice(0,i+1),a.indexArr=[],a.loadRemainingImages(t))},o.src=Object(n.a)(t[e]).attr("data-src"))},applyVisualState:function(t,e){if(t.theme_data){var i={w:e?e.w:t.w,h:e?e.h:t.h,images_h:e?e.images_h:t.images_h,captions_h:e?e.captions_h:t.captions_h,thumbnails_h:this.THUMBNAILS_HEIGHT,counters_h:this.COUNTERS_HEIGHT,left_icon_noun:t.theme_data.left_icon_noun,right_icon_noun:t.theme_data.right_icon_noun,theme:t.current_theme,play_method:t.play_method,current_mode:t.current_mode,thumbnails:t.theme_data.thumbnails,arrows_type:t.theme_data.arrows_type,arrows_position:t.theme_data.arrows_position,arrows_view_mode:t.theme_data.arrows_view_mode,active_arrows:t.active_arrows,captions:t.theme_data.captions,counters:t.theme_data.counters,counters_type:t.theme_data.counters_type,counters_position:t.theme_data.counters_position,controls_bg:t.theme_data.controls_bg,show_on_hover:t.theme_data.show_on_hover,pictures:t.pictures,radius:t.theme_data.radius,transition_type:t.transition_type};i.showThumbnails=i.thumbnails,i.showCounters=i.counters,i.showCaptions=i.captions,i.showFullscreen=t.theme_data.fullscreen,i.showArrows=t.theme_data.arrows,void 0!==i.showArrows?(i.showBtmArrows=i.showArrows&&(i.arrows_position?"bottom"===i.arrows_position:i.active_arrows?"bottom"===i.active_arrows:"theme_classic"===i.theme)&&"normal"===i.arrows_view_mode,i.showMdlArrows=i.showArrows&&(i.arrows_position?"sides"===i.arrows_position:i.active_arrows?"middle"===i.active_arrows:"theme_captions"===i.theme)&&"normal"===i.arrows_view_mode):(i.showBtmArrows="theme_classic"===i.theme,i.showMdlArrows="theme_captions"===i.theme);var o=["rm_left_3","rm_left_4","rm_left_5","rm_left_6","rm_left_7","rm_left_8","rm_left_9","rm_left_10","rm_left_11","rm_left_12","rm_left_13","rm_left_14","rm_right_3","rm_right_4","rm_right_5","rm_right_6","rm_right_7","rm_right_8","rm_right_9","rm_right_10","rm_right_11","rm_right_12","rm_right_13","rm_right_14"],a=["rm_left_15","rm_left_16","rm_left_17","rm_left_20","rm_right_15","rm_right_16","rm_right_17","rm_right_20"],s=i.left_icon_noun&&i.left_icon_noun.rm_id,l=i.right_icon_noun&&i.right_icon_noun.rm_id,c=this.$el.find(".prev-picture-arrow-middle"),d=this.$el.find(".next-picture-arrow-middle");c.toggleClass("first-pack",o.includes(s)).toggleClass("second-pack",a.includes(s)),s?c.attr("data-id",s):c[0].hasAttribute("data-id")&&c.removeAttr("data-id"),d.toggleClass("first-pack",o.includes(l)).toggleClass("second-pack",a.includes(l)),l?d.attr("data-id",l):d[0].hasAttribute("data-id")&&d.removeAttr("data-id"),this.$images.css("height",i.images_h),this.$thumbnails.css({display:i.showThumbnails?"block":"none",height:i.thumbnails_h}),this.$counters.css({display:i.showCounters&&(i.counters_type?"dots"===i.counters_type:"theme_captions"===i.theme)?"block":"none",height:i.counters_h}),this.$captions.css({display:i.showCaptions||"theme_captions"===i.theme?"block":"none",height:i.captions_h}),this.$images.find(".fullscreen").toggle(i.showFullscreen),!i.theme||"theme_captions"!==i.theme||i.active_arrows||i.counters_type&&"dots"!==i.counters_type||this.setDotsPosition("middle"),void 0!==i.arrows_type&&this.$images.toggleClass("noun",i.showArrows&&("library"===i.arrows_type||"noun"===i.arrows_type)),void 0!==i.arrows_view_mode&&this.$images.toggleClass("mouseover",i.showArrows&&"mouseover"===i.arrows_view_mode),void 0!==i.show_on_hover&&(this.$images.toggleClass("show-on-hover",i.show_on_hover),this.$counters.toggleClass("show-on-hover",i.show_on_hover)),void 0!==i.controls_bg&&this.$images.toggleClass("controls-without-bg",!i.controls_bg),void 0!==i.play_method&&this.$images.toggleClass("play-on-hover","hover"===i.play_method),this.$images.toggleClass("viewer","viewer"===this.environment),"mouseover"!==i.arrows_view_mode&&this.$images.css("cursor","default"),this.$bottom_arrows.toggle(i.showBtmArrows),this.$middle_arrows.toggle(i.showMdlArrows),this.$bottom_arrows_container.toggleClass("only-counters","sides"===i.arrows_position||"middle"===i.active_arrows||!1===i.showArrows||"mouseover"===i.arrows_view_mode),this.$images.find(".counters-numbers").toggle(i.showCounters&&(i.counters_type?"numbers"===i.counters_type:"theme_classic"===i.theme)),"dots"===i.counters_type&&this.setDotsPosition(i.counters_position?i.counters_position:i.active_arrows);var h=t.theme_data,u=this.getRGBA(h.controls_color,h.controls_opacity),p=this.getRGBA(h.background_color,h.background_opacity);if(this.colorArrows(h.controls_color,h.controls_opacity),this.$("svg #full-screen").css("fill",u),this.$(".counters-numbers").css("color",u),"dots"===i.counters_type&&"inside"===i.counters_position&&r.a.defer(function(){this.$counters.find(".counter").css({background:u,"border-color":u})}.bind(this)),this.$images.css("background",p),this.$thumbnails.css("background",p),this.setPicsTransitions(),this.setNewPicsWidths(i.w),this.$images_wrapper.toggleClass("crossfade","crossfade"===i.transition_type),this.$images_wrapper.css({"border-radius":i.radius}),this.$images_wrapper.children(".image").each(r.a.bind((function(t,e){var o=Object(n.a)(e);o.css({"background-size":this.setImageSize(h.fill,o.attr("data-width"),o.attr("data-height"),i.w,i.images_h),"border-radius":i.radius})}),this)),!this.initialRender){var m=t.pictures||[];this.handleCounters&&this.$counters_container.css("width",m.length*this.COUNTER_WIDTH),this.handleThumbnails&&this.$thumbnails_container.css("width",m.length*(this.THUMBNAIL_WIDTH+this.THUMBNAIL_PADDING)-this.THUMBNAIL_PADDING),this.recalcCounters(t,e),this.recalcThumbnails(t,e),this.moveToImage(this.currentImageID,!1,"change-visual-style")}}},onMouseMove:function(t){var e=this.$images,i=s.a.getBox(e.get(0)),o=Object(n.a)(t.currentTarget).offset(),a=this.getIconUrl().leftArrUrl,r=this.getIconUrl().rightArrUrl,l=this.isLeftSideOfWidget(t)?a:r,c=this.$el.find(".cursor"),d=this.getFirefoxCorrection(),h=this.getScale();"constructor"===this.environment?(Modernizr.safari&&(t.currentTarget.style.cursor=""),Object(n.a)(t.currentTarget).css({cursor:"url('".concat(l,"') 18 18, pointer")})):Object(n.a)(t.target).hasClass("image")||Object(n.a)(t.target).hasClass("images-wrapper")||Object(n.a)(t.target).hasClass("bottom-arrows")?(c.show().css({left:t.clientX/h-i.left/d-.5*c.width()/d,top:(Modernizr.safari?t.pageY/h-o.top:t.clientY/h-i.top/d)-.5*c.height()/d,cursor:"none","background-image":"url('".concat(l,"')")}),Object(n.a)(t.currentTarget).css({cursor:"none"})):c.css({"background-image":"none"})},onMouseOut:function(){this.$el.find(".cursor").hide()},getIconUrl:function(){var t,e,i,n=this.getModelData("theme_data").arrows_type;return"constructor"===this.environment||"viewer"===this.environment&&"default"===n?(t=this.sanitizeSVG(this.$bottom_arrows.find("svg").first()),e=this.sanitizeSVG(this.$bottom_arrows.find("svg").last())):(t=("bottom"===(i=this.params.theme_data.arrows_position)?this.$el.find(".prev-picture-arrow-bottom img"):this.$el.find(".prev-picture-arrow-middle img")).attr("src"),e=("bottom"===i?this.$el.find(".next-picture-arrow-bottom img"):this.$el.find(".next-picture-arrow-middle img")).attr("src")),{leftArrUrl:t,rightArrUrl:e}},sanitizeSVG:function(t){var e=("constructor"===this.environment?this.model.get("theme_data"):this.params.theme_data).arrows_type,i="data:image/svg+xml;charset=utf-8,";return"library"!==e&&"noun"!==e||t.attr({height:"36",width:"36"}),i+=t[0].outerHTML.replace(/#/g,"%23").replace(/(\r\n|\n|\r)/gm,"")},colorArrows:function(t,e){var i=this.getRGBA(t,e);this.$("svg path").css("stroke",i),this.$("svg").css("fill",i)},setDotsPosition:function(t){var e,i;"middle"!==t&&"outside"!==t||(this.$counters.remove(),this.$thumbnails.after(this.$counters),this.$counters.addClass("down-position"),this.$counters.find(".counter").css("background","#fff")),this.$thumbnails.next(".counters-dots").length&&this.$thumbnails.next(".counters-dots").length>0&&("bottom"===t||"inside"===t)&&(this.$counters.remove(),this.$images.find(".counters-numbers").after(this.$counters),this.$counters.removeClass("down-position"),"constructor"===this.environment&&(e=this.model.get("theme_data"),i=this.getRGBA(e.controls_color,e.controls_opacity),this.$counters.find(".counter").css("background",i)))},getRGBA:function(t,e){var i=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)];return e>.99?"rgb("+i[0]+","+i[1]+","+i[2]+")":"rgba("+i[0]+","+i[1]+","+i[2]+", "+e+")"},getThumbUrl:function(t){if(!p.a.useLambdaUrl(t))return t.thumbUrl;var e={width:c.a.THUMB_SIZE_SLIDESHOW,height:c.a.THUMB_SIZE_SLIDESHOW,originalW:t.width,originalH:t.height};return"constructor"!==this.environment&&(e.scale=this.mag.getScale(this.pageViewport)),p.a.getThumbnailUrl(t,e)},getOriginalUrl:function(t){return t.rasterUrl||t.url},getModelData:function(t){return"constructor"===this.environment?this.model.get(t):this.params[t]},getScaledUrl:function(t){var e=this.getModelData("theme_data");if(p.a.useLambdaUrl(t)||p.a.useLambdaUrlOldProjects(t,"slideshow")){var i=this.getModelData("images_h"),n=m.a.normalizeAnimations(this.getModelData("animation")).reduce((function(t,e){return Math.max(t,m.a.maxScaleAnimation(e))}),0),o={originalW:t.width,originalH:t.height};return e.fullscreen||(o.height=i,o.scale="constructor"===this.environment?RM.constructorRouter.zoom.getZoom():this.mag.getScale(this.pageViewport),o.animationScale=n&&n/100),p.a.getLambdaUrl(t,o)}return s.a.isOn(this.pageViewport,this.mag.getViewportWidth(this.pageViewport),"constructor"===this.environment?this.mag.get("opts"):this.mag.opts)||e.fullscreen?t.unscaledOptimizedUrl||t.rasterUrl||t.url:Modernizr.retina?t.scaled2xUrl||t.unscaledOptimizedUrl||t.rasterUrl||t.url:t.scaledUrl||t.unscaledOptimizedUrl||t.rasterUrl||t.url},applyPictures:function(t){if(t.theme_data){var e,i,o=t.pictures||[];this.$el.toggleClass("no-images",!o.length),this.$bottom_arrows_container.toggleClass("no-images",o.length<=1),this.$middle_arrows.toggleClass("no-images",o.length<=1),this.$images.find(".bottom-arrows .counters-text-total").text(o.length),this.$images_wrapper.empty(),this.handleCounters&&this.$counters_container.empty(),this.handleThumbnails&&this.$thumbnails_container.empty(),(o=r.a.sortBy(o,"num")).length>1&&o.length<4&&(i=v(o).map((function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){f(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},t);return e.fakedId=l.default.generateUUID(),e.faked=!0,e})),e=n.a.merge(o,i));for(var a=0;a<(e?e.length:o.length);a++){var s,c=o[a];if(s=Object(n.a)("<div>").addClass("image").attr("data-id",c.fakedId?c.fakedId:c.id).toggleClass("error",!!c.error).css({"background-size":this.setImageSize(t.theme_data.fill,c.width,c.height,t.w,t.images_h)}).appendTo(this.$images_wrapper),c.fakedId&&s.attr("data-original-id",c.id),"constructor"===this.environment&&s.css({"background-image":c.url?'url("'+this.getScaledUrl(c)+'")':"none"}),"viewer"===this.environment&&c.url&&(s.attr("data-src",this.getScaledUrl(c)),c.scaledUrl&&s.data("orig-src",this.getOriginalUrl(c))),c.url&&c.width&&c.height&&s.attr("data-width",c.width).attr("data-height",c.height),this.handleThumbnails&&!c.faked){s=Object(n.a)("<div>").addClass("thumb").attr("data-id",c.id).toggleClass("error",!!c.error).css({left:(this.THUMBNAIL_WIDTH+this.THUMBNAIL_PADDING)*a-this.THUMBNAIL_PADDING/2}).appendTo(this.$thumbnails_container);var d=this.getThumbUrl(c);"constructor"===this.environment&&s.css({"background-image":d?'url("'.concat(d,'")'):"none"}),"viewer"===this.environment&&d&&s.attr("data-src",d)}if(this.handleCounters&&!c.faked&&Object(n.a)("<div>").addClass("counter").attr("data-id",c.id).css({left:this.COUNTER_WIDTH*a}).appendTo(this.$counters_container),(this.params.theme_data.captions||"theme_captions"===this.params.current_theme)&&"viewer"===this.environment&&!c.faked){var h=Object(n.a)("<div>").addClass("caption-wrapper").attr("data-id",c.id);Object(n.a)("<div>").addClass("caption").html(l.default.plainTextToHtml(c.text,{detectLinks:!0})).appendTo(h),h.appendTo(this.$captions)}}this.$images_wrapper.children(":first-child").data("first-child",!0),this.$images_wrapper.children(":last-child").data("last-child",!0),this.updateCurrentImageID(t),this.initialRender||(this.handleCounters&&this.$counters_container.css("width",o.length*this.COUNTER_WIDTH),this.handleThumbnails&&this.$thumbnails_container.css("width",o.length*(this.THUMBNAIL_WIDTH+this.THUMBNAIL_PADDING)-this.THUMBNAIL_PADDING),this.recalcCounters(t),this.recalcThumbnails(t),this.moveToImage(this.currentImageID,!1,"change-pictures")),o.length||this.$images.find(".bottom-arrows .counters-text .counters-text-current").html(0),this.$images_wrapper.children(".image").each(r.a.bind((function(t,e){var i=Object(n.a)(e),o="viewer"===this.environment?this.params.theme_data.radius:this.model.get("theme_data").radius;i.css({"border-radius":o})}),this))}},applyTextStyles:function(t){var e=r.a.omit(t.text_style,"size-leading-linked","size-leading-ratio");/px/i.test(e["font-size"])||(e["font-size"]+="px"),/px/i.test(e["letter-spacing"])||(e["letter-spacing"]+="px"),/px/i.test(e["line-height"])||(e["line-height"]+="px"),/#/i.test(e.color)||(e.color="#"+e.color),e.opacity/=100,this.$captions.find(".caption").css(e)},setNewPicsWidths:function(t){var e,i=this.mag.getViewportWidth(this.pageViewport),o=this.$el.find("#slideshow-images-position-style-"+this.params._id),a=u.a.isDesktop?"":"translateZ(0)",r=s.a.isOn(this.pageViewport,i,"constructor"===this.environment?this.mag.get("opts"):this.mag.opts)?s.a.getRatio(i):1;e=this.isSlider()?'          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper {\n            left: 0px;\n            width: '+t+'px;\n          }\n          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image {\n            left: 0px;\n            width: '+t+'px;\n          }\n          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.prev-image {\n            -webkit-transform: translateX('+-t+"px)"+a+";\n            transform: translateX("+-t+"px)"+a+';\n          }\n          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.center-image {\n            -webkit-transform: translateX(0) '+a+";\n            transform: translateX(0) "+a+';\n          }\n          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.next-image {\n            -webkit-transform: translateX('+t+"px)"+a+";\n            transform: translateX("+t+"px)"+a+';\n          }\n                    .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper {\n            left: 0px;\n            width: '+t+'px;\n          }\n          .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image {\n            left: 0px;\n            width: '+t+'px;\n          }\n          .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.prev-image {\n            -webkit-transform: translateX('+Math.ceil(-t*r)+"px) "+a+";\n            transform: translateX("+Math.ceil(-t*r)+"px) "+a+';\n          }\n          .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.center-image {\n            -webkit-transform: translateX(0) '+a+";\n            transform: translateX(0) "+a+';\n          }\n          .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.next-image {\n            -webkit-transform: translateX('+Math.ceil(t*r)+"px) "+a+";\n            transform: translateX("+Math.ceil(t*r)+"px) "+a+";\n        }\n      ":'      .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper {\n        left: 0px;\n        width: '+t+'px;\n      }\n      .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image {\n        left: 0px;\n        opacity: 0;        width: '+t+'px;\n      }\n      .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image.center-image {\n        opacity: 1;        }\n      .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper {\n        left: 0px;\n        width: '+t+'px;\n      }\n      .edge .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper .image {\n        left: 0px;\n        width: '+t+"px;\n      }\n      ",o.length||(o=Object(n.a)('<style id="slideshow-images-position-style-'+this.params._id+'" type="text/css">')).appendTo(this.$el),o.text(e)},getPlayMethod:function(){return"viewer"===this.environment?this.params.play_method:this.model.get("play_method")},getCrossfadeTransitionTime:function(){return("viewer"===this.environment?this.params.theme_data:this.model.get("theme_data")).crossfade},isSlider:function(){var t;return t="viewer"===this.environment&&this.params.transition_type?"slider"===this.params.transition_type:"constructor"!==this.environment||!this.model.get("transition_type")||"slider"===this.model.get("transition_type"),t},getTransitionsTime:function(){return this.isSlider()?this.getSliderTransitionTime():this.getCrossfadeTransitionTime()},getTransitionsDelay:function(){var t,e;return"viewer"===this.environment?(t=this.params.play_method,e=this.params.theme_data):(t=this.model.get("play_method"),e=this.model.get("theme_data")),1e3*("hover"===t?e.hover_delay:"autoplay"===t||e.autoplay?e.autoplay_delay:0)||this.AUTOPLAY_DELAY},setPicsTransitions:function(t,e){var i,o=this.$el.find("#slideshow-images-transition-style-"+this.params._id),a="cubic-bezier(0.40, 0.24, 0.40, 1)",r=this.isSlider()||"scroll"!==this.getPlayMethod()?"ease-in-out":"ease-out",s="prev"===e?"next":"prev",l=this.isSlider()&&"scroll"===this.getPlayMethod()?0:this.getTransitionsTime();t=t||l,i=this.isSlider()?'          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper.enable-transitions .image {\n            -webkit-transition: transform '+t+"s "+a+";            transition: transform "+t+"s "+a+';          }\n          .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper.enable-transitions .image.center-image {\n            -webkit-transition: transform '+(t-.05)+"s "+a+";            transition: transform "+(t-.05)+"s "+a+';        }\n        .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper.enable-transitions .image.'+e+"-image {\n            -webkit-transition: transform 0s "+a+";        transition: transform 0s "+a+';        }\n        .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper.enable-transitions .image.'+s+"-image {\n            -webkit-transition: transform "+t+"s "+a+";        transition: transform "+t+"s "+a+";        }\n        ":'        .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper.enable-transitions .image {\n        -webkit-transition: opacity '+t+"s "+r+";        transition: opacity "+t+"s "+r+';        }\n        .common-slideshow[data-id="'+this.params._id+'"] .images .images-wrapper.enable-transitions .image.center-image {\n        -webkit-transition: opacity '+t+"s "+r+";        transition: opacity "+t+"s "+r+";        }\n        ",o.length||(o=Object(n.a)('<style id="slideshow-images-transition-style-'+this.params._id+'" type="text/css">')).appendTo(this.$el),o.text(i)},getSliderTransitionTime:function(){if(!RM.screenshot)return("viewer"===this.environment?this.params.theme_data.slider_transition:this.model.get("theme_data").slider_transition)||this.SLIDER_TRANSITION},setImageSize:function(t,e,i,n,o){return e&&i?t?(n/o>e/i?(a=n+2,r=Math.round(a*i/e)):(r=o+2,a=Math.round(r*e/i)),a+"px "+r+"px"):e<n&&i<o?e+"px "+i+"px":(n/o>e/i?(r=o+2,a=Math.round(r*e/i)):(a=n+2,r=Math.round(a*i/e)),a+"px "+r+"px"):t?"cover":"contain";var a,r},onCaptionBlur:function(){if("viewer"!==this.environment&&this.model){var t=this.$captions.find(".caption").val(),e=r.a.clone(this.model.get("pictures")),i=r.a.findWhere(e,{id:this.$captions.find(".caption").attr("data-id")});if(i&&i.text!==t){var n=e.indexOf(i);e[n]=r.a.extend({},i,{text:t}),this.model.save({pictures:e},{toHistory:!0}),this.block.workspace.trigger("redraw")}}},recalcCounters:function(t,e){if("dots"===t.theme_data.counters_type||"theme_captions"===t.current_theme){var i=t.pictures||[],n=e?e.w:t.w,o=this.COUNTER_WIDTH*i.length,a=Math.floor(n/this.COUNTER_WIDTH)*this.COUNTER_WIDTH,r=this.$bottom_arrows_container.hasClass("only-counters")&&i.length>2?this.COUNTERS_ADDITIONAL_SPACE:0,s=Math.min(o,a)+r,l=(t.theme_data.counters_position?"outside"===t.theme_data.counters_position:t.active_arrows?"middle"===t.active_arrows:"theme_captions"===t.current_theme)?Math.floor((n-s)/2):0;this.$counters_scroll_wrapper.css({left:l,width:s}),this.$counters_container.css({width:o})}},recalcThumbnails:function(t,e){if(t.theme_data.thumbnails){var i=t.pictures||[],n=e?e.w:t.w,o=i.length*(this.THUMBNAIL_WIDTH+this.THUMBNAIL_PADDING)-this.THUMBNAIL_PADDING,a=Math.min(o,n-this.THUMBNAILS_PADDING),r=Math.floor((n-a)/2);this.thumbsWidth=a,this.$thumbnails_scroll_wrapper.css({left:r,width:a}),this.$thumbnails_container.css({width:o})}},onImageClick:function(t){var e;this.isNormalArrowsMode()||this.block&&!this.block.selected||(t&&t.stopPropagation(),"hover"===this.getPlayMethod()&&(e="switch-to-image-autoplay"),this.isLeftSideOfWidget(t)?this.prevImage(t,e):this.nextImage(t,e))},isLeftSideOfWidget:function(t){var e=this.$images,i=this.getScale(),o=this.getFirefoxCorrection(),a=s.a.getBox(e.get(0));return t.clientX/i<(a.left+(this.isFullscreenMode?Object(n.a)(window).width():a.width)/2)/o},isNormalArrowsMode:function(){return"constructor"===this.environment&&this.model.get("theme_data")&&"normal"===this.model.get("theme_data").arrows_view_mode},getFirefoxCorrection:function(){return Modernizr.firefox&&"constructor"!==this.environment&&!this.isFullscreenMode?this.mag.getScale(this.pageViewport):1},getScale:function(){return this.isFullscreenMode?1:"constructor"===this.environment?RM.constructorRouter.zoom.getZoom():this.mag.getScale(this.pageViewport)},prevImage:function(t,e){this.imagePrevNext(t,"prev",e||"switch-to-image")},checkNeedUpdateTransition:function(t,e){var i,n=this.getTransitionsTime(),o=this.$images_wrapper.children(":first").css("transition-duration")?parseFloat(this.$images_wrapper.children(":first").css("transition-duration")):n;t&&t.timeStamp?((i=(t.timeStamp-this.lastClick)/1e3)<n?this.setPicsTransitions(i.toFixed(1),e):o<n&&this.setPicsTransitions(n,e),this.lastClick=t.timeStamp):this.setPicsTransitions(n,e),this.slidesDirection!==e&&(this.setPicsTransitions(n,e),this.slidesDirection=e)},nextImage:function(t,e){this.imagePrevNext(t,"next",e||"switch-to-image")},imagePrevNext:function(t,e,i){if(this.currentImageID){var o="next"==e?this.currentPic.$el.next():this.currentPic.$el.prev();o.length||(o=this.$images_wrapper.children(":"+("next"==e?"first":"last"))),this.checkNeedUpdateTransition(t,e),this.$images_wrapper.children(".changed-opacity").each(r.a.bind((function(t,e){var i=Object(n.a)(e);i.css({opacity:""}),i.removeClass("changed-opacity")}),this)),this.moveToImage(o.attr("data-id"),!0,i),t&&t.stopPropagation()}},changeSlideonHover:function(t){var e=this.isLeftSideOfWidget(t)?"prev":"next";this.slidesDirection!==e&&this.stopAutoplay(),this.startAutoplay(e),this.slidesDirection=e},onMouseEnter:function(t){this.onImageClick(t),this.changeSlideonHover(t)},thumbnailClick:function(t){this.moveToImage(Object(n.a)(t.currentTarget).attr("data-id"),!1,"switch-to-image"),t.stopPropagation()},counterClick:function(t){this.moveToImage(Object(n.a)(t.currentTarget).attr("data-id"),!1,"switch-to-image"),t.stopPropagation()},moveToImage:function(t,e,i){var o=this;if(t){var a=this.$images_wrapper.children(".image"),s=a.filter('[data-id="'+t+'"]'),l=s.attr("data-original-id"),c=a.index(s),d=r.a.clone(this.currentPic),h=c,u=this,p="viewer"===this.environment?this.params.pictures.length:this.model.get("pictures").length,m=this.getTransitionsDelay(),g=1e3*this.getTransitionsTime();t=l||t,s.length&&-1!==c&&(this.currentImageID=t,this.currentPic.$el=s,this.currentPic.num=c,"switch-to-image"===i&&"viewer"===this.environment&&(this.params.theme_data.autoplay&&void 0===this.params.play_method||"autoplay"===this.params.play_method||"hover"===this.params.play_method)&&(this.stopAutoplay(),setTimeout((function(){return o.startAutoplay()}),m)),this.$images_wrapper.toggleClass("enable-transitions",e),this.resetWaitForAnimationEnd(),e&&d.$el&&this.waitForAnimationEnd(d.$el,f),this.direction=!d.$el||!d.$el.length||d.num<h?"forward":"backward",s.data("first-child")&&d.$el&&d.$el.length&&d.$el.data("last-child")?this.direction="forward":s.data("last-child")&&d.$el&&d.$el.length&&d.$el.data("first-child")&&(this.direction="backward"),a.each((function(t){var e=Object(n.a)(this),i=a.length-1;1!==a.length?t+1===h||0===h&&t===i?u.setPicPosition(e,"prev",!0):t-1===h||h===i&&0===t?u.setPicPosition(e,"next",!0):t===h?u.setPicPosition(e,"center",t===h):u.setPicPosition(e,"",!1):u.setPicPosition(e,"center",t===h)})),p>1&&p<4&&(c=c>=p?c-p:c),u.$images.find(".counters-text-current").html(c+1),!e&&f())}function f(){if(e||u.initialRender||window.requestAnimationFrame((function(){u.$images_wrapper.addClass("enable-transitions")})),u.trigger("currentImageChanged",t,e,i),u.handleCounters&&!u.initialRender){var n=u.$counters_container.children('[data-id="'+t+'"]');u.$counters_container.children(".active").removeClass("active"),n.addClass("active");var o=n.get(0).offsetLeft,a=u.$counters.find(".items-wrapper").width(),s=void 0;o+2*u.COUNTER_WIDTH-u.$counters.find(".items-wrapper").scrollLeft()>a?s=o+2*u.COUNTER_WIDTH-a:o-u.COUNTER_WIDTH-u.$counters.find(".items-wrapper").scrollLeft()<0&&(s=o-u.COUNTER_WIDTH),null!=s&&(e?u.$counters.find(".items-wrapper").stop().animate({scrollLeft:s},g):u.$counters.find(".items-wrapper").scrollLeft(s))}if(u.handleThumbnails&&!u.initialRender){var l=u.$thumbnails_container.children('[data-id="'+t+'"]');u.$thumbnails_container.children(".active").removeClass("active"),l.addClass("active");o=l.position().left,a=u.$thumbnails.find(".items-wrapper").width(),s=void 0;o+2*(u.THUMBNAIL_WIDTH+u.THUMBNAIL_PADDING)-u.THUMBNAIL_PADDING/2-u.$thumbnails.find(".items-wrapper").scrollLeft()>a?s=o+2*(u.THUMBNAIL_WIDTH+u.THUMBNAIL_PADDING)-u.THUMBNAIL_PADDING/2-a:a>2*(u.THUMBNAIL_WIDTH+u.THUMBNAIL_PADDING)&&o-u.THUMBNAIL_WIDTH-u.THUMBNAIL_PADDING/2-u.$thumbnails.find(".items-wrapper").scrollLeft()<0&&(s=o-u.THUMBNAIL_WIDTH-u.THUMBNAIL_PADDING/2)}if(null!=s&&(e?u.$thumbnails.find(".items-wrapper").stop().animate({scrollLeft:s},g):u.$thumbnails.find(".items-wrapper").scrollLeft(s)),u.model&&"constructor"===u.environment){var c=u.model.get("pictures"),d=r.a.findWhere(c,{id:u.currentImageID});d?u.$captions.find(".caption").val(d.text).attr("data-id",u.currentImageID):u.$captions.find(".caption").val("").attr("data-id","")}else!u.params.theme_data.captions&&"theme_captions"!==u.params.current_theme||"viewer"!==u.environment||(e?u.$captions.find('.caption-wrapper[data-id="'+u.currentImageID+'"]').stop().fadeIn(200).siblings().stop().fadeOut(200):(u.$captions.find(".caption-wrapper").stop().css({display:"none"}),u.$captions.find('.caption-wrapper[data-id="'+u.currentImageID+'"]').stop().css({display:"block"})));u.preloadImages(),u.preloadThumbImages()}},waitForAnimationEnd:function(t,e){this.resetWaitHook=l.default.waitForTransitionEnd(t,this.getTransitionsTime(),"transform",e)},resetWaitForAnimationEnd:function(){this.resetWaitHook&&this.resetWaitHook()},setPicPosition:function(t,e,i){Object(n.a)(t).removeClass("center-image prev-image next-image neighbour hidden").addClass((e?e+"-image ":"hidden")+(i?"neighbour":"")),Object(n.a)(t).data("last-position",e),Object(n.a)(t).data("last-neighbour",i)},preloadImages:function(){if("viewer"===this.environment){var t=this.$images_wrapper.children('[data-id="'+this.currentImageID+'"]');if(t.length){var e=t.prev();e.length||(e=this.$images_wrapper.children(":last"));var i=t.next();i.length||(i=this.$images_wrapper.children(":first"));var n=this;o(t),RM.screenshot||(o(e),o(i))}}function o(t){if(n.isFullscreenMode){if(t.data("orig-src")){var e=new Image;e.onload=function(){t.css({"background-image":'url("'+e.src+'")'}).removeData("orig-src")},e.src=t.data("orig-src")}n.$images_wrapper.find(".image").css("border-radius",0)}t.attr("data-src")&&(n.preloadImagesList.push({url:t.attr("data-src")}),t.css({"background-image":'url("'+t.attr("data-src")+'")'}).removeAttr("data-src"))}},preloadThumbImages:function(){if("viewer"===this.environment&&this.params.theme_data.thumbnails){var t=this.initialRender?this.thumbsWidth:this.$thumbnails_scroll_wrapper.width(),e=this.initialRender?0:this.$thumbnails.find(".items-wrapper").scrollLeft();this.$thumbnails.find(".items-wrapper .thumb").each(r.a.bind((function(i,o){var a=Object(n.a)(o);if(a.attr("data-src")){var r=i*this.THUMBNAIL_WIDTH-this.THUMBNAIL_PADDING/2,s=this.THUMBNAIL_WIDTH+this.THUMBNAIL_PADDING;r-e>t+s||r+s-e<0-s||(this.preloadImagesList.push({url:a.attr("data-src")}),a.css({"background-image":'url("'+a.attr("data-src")+'")'}).removeAttr("data-src"))}}),this))}},updateCurrentImageID:function(t){if(t.pictures&&t.pictures.length)if(this.currentImageID){var e=r.a.findWhere(t.pictures,{id:this.currentImageID});this.currentImageID=e?e.id:this.getFirstPictureID(t)}else this.currentImageID=this.getFirstPictureID(t);else this.currentImageID=void 0},getFirstPictureID:function(t){return r.a.sortBy(t.pictures,"num")[0].id},toggleFullscreen:function(t){"constructor"!=this.environment&&(this.isFullscreenMode?this.leaveFullscreen():this.enterFullscreen(),t.stopPropagation())},enterFullscreen:function(){"constructor"!=this.environment&&(this.isFullscreenMode||(this.isFullscreenMode=!0,this.$parentBeforeFullscreen=this.$el.parent(),Object(n.a)(".constructor .widgetbar").addClass("hidden"),this.$el.addClass("fullscreen-mode"),this.$el.appendTo("body").css("z-index",999),Object(n.a)(window).on("resize",this.onFullscreenResize),Object(n.a)("body").on("keyup",this.onFullscreenKeyUp),r.a.defer((function(){RM.common.disableShortcuts.slideshow=!0})),this.onFullscreenResize(),l.default.getFocusBack(),this.preloadImages()))},onFullscreenKeyUp:function(t){t.keyCode==n.a.keycodes.left&&this.prevImage(),t.keyCode==n.a.keycodes.right&&this.nextImage(),t.keyCode==n.a.keycodes.esc&&this.leaveFullscreen()},onFullscreenResize:function(){var t=this.$el.width(),e=this.$el.height(),i=this.params.theme_data.counters&&(("middle"===this.params.active_arrows||"outside"===this.params.theme_data.counters_position)&&"dots"===this.params.theme_data.counters_type||"theme_captions"===this.params.current_theme),n=e-(this.params.theme_data.thumbnails?this.THUMBNAILS_HEIGHT:0)-(this.params.theme_data.captions||"theme_captions"===this.params.current_theme?this.params.captions_h:0)-(i?this.COUNTERS_HEIGHT:0);this.applyVisualState(this.params,{w:t,h:e,images_h:n,captions_h:this.params.captions_h})},leaveFullscreen:function(){"constructor"!=this.environment&&this.isFullscreenMode&&(this.isFullscreenMode=!1,this.$el.appendTo(this.$parentBeforeFullscreen).css("z-index","auto"),Object(n.a)(window).off("resize",this.onFullscreenResize),this.$el.removeClass("fullscreen-mode"),Object(n.a)(".constructor .widgetbar").removeClass("hidden"),Object(n.a)("body").off("keyup",this.onFullscreenKeyUp),r.a.defer((function(){delete RM.common.disableShortcuts.slideshow})),this.applyVisualState(this.params),this.setNewPicsWidths(this.params.w))},startAutoplay:function(t){var e;this.autoPlayInterval||(e=1e3*(t?this.params.theme_data.hover_delay:this.params.theme_data.autoplay_delay||this.AUTOPLAY_DELAY),this.autoPlayInterval=setInterval(r.a.bind((function(){this.imagePrevNext(null,t||"next","switch-to-image-autoplay")}),this),e))},stopAutoplay:function(){clearInterval(this.autoPlayInterval),this.autoPlayInterval=null},destroy:function(){this.isDestroyed=!0,this.stopAutoplay(),this.leaveFullscreen(),this.resetWaitForAnimationEnd(),this.$el&&this.$el.remove()},setSwipeAction:function(){u.a.isDesktop||(this.picsSwipe=this.$images_wrapper.RMSwipe({$scrollElements:this.mag.$mag_container,maxTransitionSpeed:1e3*this.getTransitionsTime(),rubberBandForce:1/1.47,getCurrentConstraints:function(t){var e={},i=this.isFullscreenMode?this.$images_wrapper.width():this.params.w;return e.$moveItems=this.currentPic.$el.add(this.currentPic.$el.prev()).add(this.currentPic.$el.next()),e.$referenceItem=e.$moveItems.filter(":not(.center-image)").first(),this.currentPic.$el.is(":last-child")?e.left={max:0,noTrigger:!0}:e.left={max:i},this.currentPic.$el.is(":first-child")?e.right={max:0,noTrigger:!0}:e.right={max:i},e}.bind(this),onSwipeStart:function(){var t,e,i=this,n=this.getTransitionsDelay();"viewer"===this.environment?(t=this.params.play_method,e=this.params.theme_data.autoplay&&void 0===t):(t=this.model.get("play_method"),e=this.model.get("theme_data").autoplay),("autoplay"===t||e)&&(this.stopAutoplay(),setTimeout((function(){return i.startAutoplay()}),n)),this.$images_wrapper.removeClass("enable-transitions")}.bind(this),customMoveCheck:function(t,e){return!(t.hasClass("prev-image")&&e<0)&&!(t.hasClass("next-image")&&e>0)}.bind(this),callback:function(t){var e;"right"===t&&(e=this.currentPic.$el.prev()),"left"===t&&(e=this.currentPic.$el.next()),e.length||(e=this.currentPic.$el),this.moveToImage(e.attr("data-id"),!1,"switch-to-image")}.bind(this)}).data("swipe"))}});e.a=y},tf3M:function(t,e,i){"use strict";i.r(e),i.d(e,"WidgetsCollection",(function(){return m}));var n=i("q1z7"),o=i.n(n),a=i("rFsW"),r=i("v92f"),s=i("rVpV"),l=i("Fi5S"),c=i("jeLO"),d=i("sviH"),h=i("roQd");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var p=c.a.extend({idAttribute:"_id",urlRoot:"/api/widget/",defaults:{x:Math.round(272),y:157,w:480,h:360},name:"Widget",widgets_with_inner_widgets:["hotspot"],nonUndoKeys:["animation"],viewport_required_fields:["x","y","w","h"],onlyRootFields:["_id","modelType"].concat(r.b.viewport_list),initialize:function(t,e){if(e=e||{},this.Block=d.a[t.type],this.Block){this.hasNested=a.a.contains(this.widgets_with_inner_widgets,t.type),this.isNested=!!t.parent_wid;var i=RM.constructorRouter&&!RM.constructorRouter.previewMode;this.hasNested&&i&&this.init_inner_widgets_models(t,e),this.on("change:is_global",this.onGlobalChange)}},init_inner_widgets_models:function(t,e){var i,n;n=(i=a.a.clone(t)).widgets||i.wids||[],n=this.sanitizeWidgets(n),this.widgets_collection=new m(n,{parent_widget:this,parse:e.parse,page:this.collection.page}),i.wids=a.a.pluck(n,"_id"),this.set(i,{silent:!0}),this.on("change:wids",this.onWidsChange)},parse:function(t,e){if(!this.collection||!this.collection.page)return t;this.Block||(this.Block=d.a[t.type]);var i=this.isNested?"default":this.collection.page.getCurrentViewport();return a.a.isEmpty(t)||(a.a.each(r.b.viewport_list,(function(e){this[e]=t[e],"default"!==e&&t[e]&&("button"===t.type||"text"===t.type&&3===t.version)&&a.a.each(r.b.viewport_fields[t.type]||r.b.viewport_fields_common,function(i){this[e][i]=a.a.has(t[e],i)?t[e][i]:t[i]}.bind(this)),this[e]=a.a.omit(this[e],this.onlyRootFields),delete t[e],delete this.attributes[e]}),this),this.storeViewport("default",t),a.a.extend(t,a.a.defaults(this["viewport_"+i],this.viewport_fields_defaults))),e&&e.xhr&&(e.xhr.skipResponse=!0),a.a.has(t,"w")&&!a.a.isNumber(t.w)&&(t.w=this.defaults.w),a.a.has(t,"h")&&!a.a.isNumber(t.h)&&(t.h=this.defaults.h),c.a.prototype.parse.apply(this,arguments)},set:function(t,e,i){var n;if("object"===u(t)?(n=t,i=e):(n={})[t]=e,!this.isGlobal()||!this.collection||!this.collection.page||i&&i.noSaveUnique)return c.a.prototype.set.apply(this,arguments);var o=s.a.fillUniqueAttributeSets(n,this.attributes,this.collection.page.id);return a.a.isEmpty(o)||a.a.extend(n,o),c.a.prototype.set.apply(this,[n,i])},get:function(t){var e=c.a.prototype.get.apply(this,arguments);if(!this.attributes.is_global||this.attributes.is_above&&"z"===t||!a.a.contains(s.a.GLOBAL_UNIQUE_KEYS,t)||!this.collection||!this.collection.page)return e;var i=s.a.getUniqueValue(t,this.attributes,this.collection.page.id);return void 0===i?e:i},validate:function(t){if(!t.type)return"missing widget type"},triggerReady:function(){l.a.trigger("ready:model",this)},toJSON:function(t){if(!this.collection||!this.collection.page)return this.attributes;var e=this.collection.page.getCurrentViewport(),i=a.a.clone(this.attributes);return"default"===e||this.isNew()||this.isNested||(i["viewport_"+e]=a.a.pick(i,this.viewport_fields),i["viewport_"+e]=a.a.omit(i["viewport_"+e],this.onlyRootFields),a.a.extend(i,this.viewport_fields_defaults,this.viewport_default)),a.a.each(r.b.viewport_list,(function(t){a.a.isEmpty(this[t])||i[t]||(i[t]=this[t])}),this),i},initViewport:function(t){var e=this.collection.page.getCurrentViewport(),i=this.attributes;this["viewport_"+e]=a.a.extend(a.a.pick(i,this.Block.prototype.viewport_fields),this.Block.getViewportDefaults(this,e,t))},getViewport:function(){return this.isNested?"default":this.collection&&this.collection.page&&this.collection.page.getCurrentViewport()},changeViewport:function(t){t=t||{};var e=this.collection.page.getPreviousViewport();this.storeViewport(e),this.restoreViewport()},storeViewport:function(t,e){t=t||this.collection.page.getCurrentViewport(),e=e||this.attributes,this["viewport_"+t]=a.a.pick(e,this.viewport_fields)},restoreViewport:function(t){if(t=t||this.collection.page.getCurrentViewport(),a.a.isEmpty(this["viewport_"+t]))"default"!==t&&this.restoreViewport("default"),this.storeViewport(t),this.set(this.Block.getViewportDefaults(this,t)),this.save({},{silent:!0,skipHistory:!0});else{var e=a.a.defaults({},this["viewport_"+t],this.viewport_fields_defaults);this.get("is_global")&&(this.get("is_above")&&delete e._z,s.a.fillUniqueValues(e,this.collection.page.id)),this.set(e,{first:!0,viewportChange:!0,noSaveUnique:!0})}"default"!==t&&this.validateViewport(t)},validateViewport:function(t){if(!a.a.all(this.viewport_required_fields,(function(t){var e=this.get(t);return null!=e&&!isNaN(e)&&""!==e}),this)){var e=this.viewport_default;this.set(a.a.pick(e,this.viewport_required_fields)),this.save({},{silent:!0,first:!0})}},fillMissingFieldsFromDefaultViewport:function(t){var e={};a.a.each(t,function(t){var i=this.viewport_default&&this.viewport_default[t];void 0===this.get(t)&&i&&(e[t]=a.a.cloneWithObjects(i))}.bind(this)),a.a.isEmpty(e)||this.set(e,{silent:!0})},splitChangesToViewport:function(t,e){if(!e||"default"===e)return t;var i=this.viewport_fields,n=a.a.pick(t,i);return a.a.each(i,(function(i){t["viewport_"+e]&&t["viewport_"+e][i]&&delete n[i]})),a.a.isEmpty(n)||(t["viewport_"+e]=a.a.extend({},t["viewport_"+e],n),t=a.a.omit(t,i)),t},getPageId:function(){return this.collection&&this.collection.getPageId()},addWidget:function(t,e){if(e=e||{},t&&t.type)if(d.a[t.type]){t.parent_wid=this.get("_id"),t.pid=this.get("pid");var i=this.widgets_collection.add(t,e);i.created=!e.copy&&!e.clone,i.id?i.fetch({success:this.getAddCallback(e),error:e.error}):i.save({},{success:this.getAddCallback(e),error:e.error})}else console.error("Adding unknown widget into another widget.");else console.error("Adding widget with no type into another widget.")},onAddWidget:function(t,e){if(!t.get("type"))return!1;var i;(i=a.a.clone(this.get("wids"))).push(t.id),i=Object(a.a)(i).chain().uniq().compact().value(),this.set({wids:i},e)},getAddCallback:function(t){t=t||{};var e=this;return function(i){e.onAddWidget(i,t),t.success&&t.success(i)}},onWidsChange:function(t,e,i){if((e=this.get("wids"))&&a.a.isObject(e[0])){var n=a.a.clone(e);n=this.sanitizeWidgets(n),this.widgets_collection.set(n,{parent_widget:this,page:this.collection.page}),e=a.a.pluck(e,"_id"),this.set("wids",e,{silent:!0})}var o=this.get("wids"),r=t.previous("wids")||[];if(o){var s=a.a.difference(o,r),l=a.a.difference(r,o);a.a.each(s,function(e){var n=t.widgets_collection.get(e);n&&this.trigger("widget:create",n,i)}.bind(this)),a.a.each(l,function(e){var n=t.widgets_collection.get(e);n&&this.trigger("widget:remove",n,i)}.bind(this))}},sanitizeWidgets:function(t){return a.a.filter(t,(function(t){return!!d.a[t.type]}))},isGlobal:function(){return!!this.get("is_global")},onGlobalChange:function(){this.get("is_global")?(Object(a.a)(r.b.viewport_listall).each(function(t){a.a.isEmpty(this[t])||("viewport_"+this.getViewport()===t&&s.a.ensurePageDefRecord(this.attributes),s.a.ensurePageDefRecord(this[t]))}.bind(this)),this.triggerGlobalAppear()):this.triggerGlobalDisappear()},triggerGlobalAppear:function(){l.a.trigger("global_appear:widget",this)},triggerGlobalDisappear:function(){l.a.trigger("global_disappear:widget",this)},getAnimations:function(){return h.a.normalizeAnimations(this.get("animation"))}},{viewports:r.b.viewport_list});Object.defineProperty(p.prototype,"viewport_fields",{get:function(){return this.Block.prototype.viewport_and_unique_fields||(this.Block.prototype.viewport_and_unique_fields=a.a.union(this.Block.prototype.viewport_fields,s.a.GLOBAL_UNIQUE_KEYS.map((function(t){return s.a.GLOBAL_UNIQUE_KEY_PREFIX+t})))),this.Block.prototype.viewport_and_unique_fields}}),Object.defineProperty(p.prototype,"viewport_fields_defaults",{get:function(){return this.Block.prototype.viewport_fields_defaults||(this.Block.prototype.viewport_fields_defaults={},a.a.each(this.viewport_fields,(function(t){this.Block.prototype.viewport_fields_defaults[t]=void 0}),this)),this.Block.prototype.viewport_fields_defaults}});var m=o.a.Collection.extend({model:p,initialize:function(t,e){e&&e.page&&(this.page=e.page),this.on("remove",(function(t){this.page&&this.page.trigger("widget:remove",t,{})}),this)},getPageId:function(){return this.page.id}});e.default=p},tkcp:function(t,e,i){"use strict";var n=i("NX5H");i.n(n).a},tyue:function(t,e,i){t.exports=i.p+"9cc31e7b4a5f7e87355c71b496221174.jpg"},tzyo:function(module,exports){module.exports={"template-constructor-control-form_endpoints":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n   <div class="icon noarrow" data-alt="Send Data" data-alt-pos="left" data-alt-offset="9"></div>\n\n   <div class="panel">\n   \t<div class="panel-caption">\n   \t\t<span>Send Data</span>\n   \t\t<div class="inline-help">\n   \t\t\t<div class="help-body-wrapper">\n   \t\t\t\t<div class="help-body">\n   \t\t\t\t\t<span class="help-text">Manage data storage.<br/><a href="http://help.readymag.com/hc/en-us/articles/360020793111-Form" target="_blank">Learn more</a></span>\n   \t\t\t\t\t<div class="help-popup-corner">\n   \t\t\t\t\t\t<div class="corner"></div>\n   \t\t\t\t\t</div>\n   \t\t\t\t</div>\n   \t\t\t\t<div class="hover-spacer"></div>\n   \t\t\t</div>\n   \t\t</div>\n   \t</div>\n\n   \t<div class="panel-section email collapsed">\n   \t\t<div class="switcher-wrapper">\n   \t\t\t<div class="switcher-caption">1st email</div>\n   \t\t\t<div class="switcher email provider" data-provider="email"></div>\n   \t\t</div>\n\n   \t\t<div class="collapsable">\n   \t\t\t<div class="current-email overflow-fade">NO-VAL</div>\n   \t\t</div>\n   \t</div>\n\n   \t<div class="separator email"></div>\n\n   \t<div class="panel-section second_email collapsed">\n\n   \t\t<div class="switcher-wrapper">\n   \t\t\t<div class="switcher-caption">2nd email</div>\n   \t\t\t<div class="switcher second_email provider" data-provider="second_email"></div>\n   \t\t</div>\n\n   \t\t<div class="collapsable">\n   \t\t\t<p class="confirmation hidden">\n   \t\t\t\tCheck<span class="confirmation email-for-confirmation">NO-VAL</span>for confirmation\n   \t\t\t</p>\n   \t\t\t<div class="input-wrapper second_email">\n   \t\t\t\t<input type="email" class="reach-input input-second-email" placeholder="Add email" data-provider="second_email" spellcheck="false">\n   \t\t\t\t<div class="action-icon hidden"></div>\n   \t\t\t</div>\n   \t\t\t<p class="confirmation resend hidden">Resend confirmation</p>\n   \t\t\t<p class="confirmation cancel hidden">Cancel request</p>\n   \t\t\t<div class="error-block hidden">\n   \t\t\t\t<p class="error red">\n   \t\t\t\t\tEmail address <br/>\n   \t\t\t\t\t<span class="error email-for-confirmation">NO-VAL</span>seems not active.\n   \t\t\t\t</p>\n   \t\t\t\t<p class="error try-another">Try another address</p>\n   \t\t\t</div>\n   \t\t\t<p class="new-email hidden overflow-fade">NO-VAL</p>\n   \t\t\t<div class="choice-email hidden">\n   \t\t\t\t<label class="custom-select">\n   \t\t\t\t\t<select class="overflow-fade">\n\n   \t\t\t\t\t</select>\n   \t\t\t\t</label>\n   \t\t\t</div>\n   \t\t\t<p class="change-email hidden">Change email</p>\n   \t\t\t<p class="back hidden">Back</p>\n   \t\t</div>\n   \t</div>\n\n   \t<div class="separator second_email"></div>\n\n   \t<div class="panel-section google collapsed">\n   \t\t<div class="switcher-wrapper disconnected">\n   \t\t\t<div class="switcher-caption">Google Sheets</div>\n   \t\t\t<div class="switcher google provider" data-provider="google"></div>\n   \t\t\t<div class="connect-button" data-provider="google"></div>\n   \t\t</div>\n\n   \t\t<div class="collapsable">\n   \t\t\t<div class="input-wrapper sheet-name">\n   \t\t\t\t<input type="text" class="reach-input input-sheet-name" placeholder="Create Sheet" data-provider="google">\n   \t\t\t\t<div class="action-icon hidden"></div>\n   \t\t\t</div>\n   \t\t</div>\n   \t</div>\n\n   \t<div class="separator google"></div>\n\n   \t<div class="panel-section mailchimp collapsed">\n   \t\t<div class="switcher-wrapper disconnected">\n   \t\t\t<div class="switcher-caption">MailChimp</div>\n   \t\t\t<div class="switcher mailchimp provider" data-provider="mailchimp"></div>\n   \t\t\t<div class="connect-button" data-provider="mailchimp"></div>\n   \t\t\t<div class="switcher-overlay">\n   \t\t\t\t<div class="help-body-wrapper">\n   \t\t\t\t\t<div class="help-body">\n   \t\t\t\t\t\t<span class="help-text">You should have an Email field<br>to send data to Mailchimp<br><a href="http://help.readymag.com/hc/en-us/articles/360020793111-Form" target="_blank">Learn more</a></span>\n   \t\t\t\t\t\t<div class="help-popup-corner">\n   \t\t\t\t\t\t\t<div class="corner"></div>\n   \t\t\t\t\t\t</div>\n   \t\t\t\t\t</div>\n   \t\t\t\t\t<div class="hover-spacer"></div>\n   \t\t\t\t</div>\n   \t\t\t</div>\n   \t\t</div>\n\n   \t\t<div class="collapsable">\n   \t\t\t<div class="input-wrapper list-name">\n   \t\t\t\t<input type="text" class="input-list-name" placeholder="Select List" disabled>\n   \t\t\t\t<select name="list-select" class="list-select"></select>\n   \t\t\t\t<div class="list-triangle"></div>\n   \t\t\t\t<div class="action-icon hidden"></div>\n   \t\t\t</div>\n   \t\t</div>\n   \t</div>\n\n   \t<div class="separator mailchimp"></div>\n\n   \t<div class="panel-section url collapsed">\n   \t\t<div class="switcher-wrapper">\n   \t\t\t<div class="switcher-caption">URL</div>\n   \t\t\t<div class="switcher url provider" data-provider="url"></div>\n   \t\t</div>\n\n   \t\t<div class="collapsable">\n   \t\t\t<div class="input-wrapper url">\n   \t\t\t\t<input type="text" class="reach-input input-custom-url" placeholder="Enter URL" data-provider="url">\n   \t\t\t\t<div class="action-icon hidden"></div>\n   \t\t\t</div>\n   \t\t</div>\n   </div>\n\n  <div class="separator file-data"></div>\n\n   \t<div class="panel-caption">\n   \t\t<span>File Storage</span>\n   \t\t<div class="inline-help">\n   \t\t\t<div class="help-body-wrapper">\n   \t\t\t\t<div class="help-body">\n   \t\t\t\t\t<span class="help-text">Manage file storage.<br/><a href="http://help.readymag.com/hc/en-us/articles/360020793111-Form" target="_blank">Learn more</a></span>\n   \t\t\t\t\t<div class="help-popup-corner">\n   \t\t\t\t\t\t<div class="corner"></div>\n   \t\t\t\t\t</div>\n   \t\t\t\t</div>\n   \t\t\t\t<div class="hover-spacer"></div>\n   \t\t\t</div>\n   \t\t</div>\n  </div>\n\n  <div class="separator email-storage"></div>\n\n    <div class="panel-section email-storage collapsed">\n        <div class="switcher-wrapper">\n            <div class="switcher-caption">Email</div>\n            <div class="switcher email-storage storage" data-provider="email-storage"></div>\n        </div>\n </div>\n\n  <div class="separator dropbox"></div>\n\n   \t<div class="panel-section dropbox collapsed">\n   \t\t<div class="switcher-wrapper disconnected">\n   \t\t\t<div class="switcher-caption">Dropbox</div>\n   \t\t\t<div class="switcher dropbox storage" data-provider="dropbox"></div>\n   \t\t\t<div class="connect-button" data-provider="dropbox"></div>\n   \t\t</div>\n   \t\t<div class="collapsable">\n   \t\t\t<div class="input-wrapper dropbox-folder-name">\n   \t\t\t\t<input type="text" class="reach-input input-dropbox-folder-name" placeholder="Folder" data-provider="dropbox">\n   \t\t\t\t<div class="action-icon hidden"></div>\n   \t\t\t</div>\n   \t\t</div>\n   </div>\n\n  \t<div class="separator googledrive"></div>\n\n   \t<div class="panel-section googledrive collapsed">\n   \t\t<div class="switcher-wrapper disconnected">\n   \t\t\t<div class="switcher-caption">Google Drive</div>\n   \t\t\t<div class="switcher googledrive storage" data-provider="googledrive"></div>\n   \t\t\t<div class="connect-button" data-provider="googledrive"></div>\n   \t\t</div>\n   \t\t<div class="collapsable">\n   \t\t\t<div class="input-wrapper googledrive-folder-name">\n   \t\t\t\t<input type="text" class="reach-input input-googledrive-folder-name" placeholder="Folder" data-provider="googledrive">\n   \t\t\t\t<div class="action-icon hidden"></div>\n   \t\t\t</div>\n   \t\t</div>\n   \t</div>\n\n   </div>\n';return __p},"template-constructor-control-form_endpoints-list-selector":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n  <option value="none" disabled selected hidden></option>\n  ',_.each(lists,(function(t){__p+='\n  \t<option value="'+(null==(__t=t.id)?"":__t)+'" '+(null==(__t=t.id==selected?"selected":"")?"":__t)+">"+(null==(__t=t.name)?"":__t)+"</option>\n  "})),__p+="\n";return __p}}},"u/SR":function(module,exports){module.exports={"template-constructor-control-shape_color":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Color" data-alt-pos="left" data-alt-offset="9"><div class="opacity-grid"></div><div class="color-circle"></div></div>\n\n\t<div class="panel">\n\t</div>\n\n';return __p}}},u1Rx:function(module,exports){module.exports={"template-constructor-helpers-colorbox":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="rmcolorbox '+(null==(__t=show_opacity?"":"without-opacity")?"":__t)+'" style="width:'+(null==(__t=width)?"":__t)+"px;height:"+(null==(__t=height)?"":__t)+'px;">\n\t\t<div class="rmcolorbox-color">\n\t\t\t<div class="rmcolorbox-map" style="left:'+(null==(__t=hue_width)?"":__t)+"px;width:"+(null==(__t=map_width)?"":__t)+"px;height:"+(null==(__t=map_height)?"":__t)+'px;">\n\t\t\t\t<canvas width="'+(null==(__t=map_width)?"":__t)+'" height="'+(null==(__t=map_height)?"":__t)+'"></canvas>\n\t\t\t\t<div class="rmcolorbox-map-handle"></div>\n\t\t\t</div>\n\t\t\t',"vertical"!=type&&(__p+='\n\t\t\t<div class="rmcolorbox-map-under-arrow" style="width:'+(null==(__t=hue_width)?"":__t)+"px;height:"+(null==(__t=map_height)?"":__t)+'px;">\n\t\t\t\t<canvas width="'+(null==(__t=hue_width)?"":__t)+'" height="'+(null==(__t=map_height)?"":__t)+'"></canvas>\n\t\t\t</div>\n\t\t\t'),__p+="\n\n\t\t\t","vertical"!=type&&(__p+='\n\t\t\t<div class="rmcolorbox-hue" style="height:'+(null==(__t=height)?"":__t)+"px;width:"+(null==(__t=hue_width||width)?"":__t)+'px;">\n\t\t\t\t<canvas class="rmcolorbox-hue-canvas1" width="'+(null==(__t=hue_width_opened-3)?"":__t)+'" height="'+(null==(__t=height)?"":__t)+'" style="height:'+(null==(__t=height)?"":__t)+"px;width:"+(null==(__t=hue_width-3)?"":__t)+'px;"></canvas>\n\t\t\t\t<canvas class="rmcolorbox-hue-canvas2" width="3" height="'+(null==(__t=height)?"":__t)+'"></canvas>\n\t\t\t</div>\n\t\t\t'),__p+='\n\n\t\t\t<div class="rmcolorbox-opacity">\n\t\t\t\t<div class="rmcolorbox-opacity-handle"><div class="rmcolorbox-opacity-val">&nbsp;</div></div>\n\t\t\t</div>\n\t\t</div>\n\n\n\t\t<div class="rmcolorbox-swatches hidden" style="width:'+(null==(__t=width)?"":__t)+"px;height:"+(null==(__t=height)?"":__t)+'px;">\n\t\t\t<div class="rmcolorbox-swatches-placeholdes-wrapper" style="width:'+(null==(__t=placeholdes_width)?"":__t)+"px;height:"+(null==(__t=placeholdes_height)?"":__t)+'px;">\n\t\t\t\t<div class="rmcolorbox-swatches-placeholdes" style="width:'+(null==(__t=placeholdes_width)?"":__t)+'px;"></div>\n\t\t\t\t<div class="rmcolorbox-swatches-colors" style="width:'+(null==(__t=placeholdes_width)?"":__t)+'px;"></div>\n\t\t\t\t<div class="rmcolorbox-swatches-scroll-handle"></div>\n\t\t\t</div>\n\t\t</div>\n\n\n\t\t<div class="rmcolorbox-rgb-block-wrapper">\n\t\t\t<div class="rmcolorbox-rgb-block input-style-1">\n\t\t\t\t',"vertical"!=type&&(__p+=" <span>#</span> "),__p+=' <input class="rmcolorbox-rgb-block-input color-input input-style-1"  spellcheck="false" maxlength="6" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\t\t',"vertical"!=type&&(__p+='\n\t\t<div class="rmcolorbox-r-g-b-block-wrapper">\n\t\t\t<div class="rmcolorbox-r-g-b-block input-style-2">\n\t\t\t\t<span>R</span><input class="rmcolorbox-r-block-input color-input input-style-2"  spellcheck="false" data-param="r" maxlength="3" type="text"/><span>G</span><input class="rmcolorbox-g-block-input color-input input-style-2"  spellcheck="false" data-param="g" maxlength="3" type="text"/><span>B</span><input class="rmcolorbox-b-block-input color-input input-style-2"  spellcheck="false" data-param="b" maxlength="3" type="text"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t'),__p+="\n\n\t\t","vertical"==type&&(__p+='\n\t\t<div class="rmcolorbox-hue" style="height:'+(null==(__t=hue_height)?"":__t)+'px; width: 100%;">\n\t\t\t<canvas class="rmcolorbox-hue-canvas1" width="'+(null==(__t=width)?"":__t)+'" height="'+(null==(__t=hue_height)?"":__t)+'" style="height:'+(null==(__t=hue_height)?"":__t)+'px;width:100%;"></canvas>\n\t\t\t<img src="https://d1id5eheivyv24.cloudfront.net/31d8083b/dist/img/constructor/helpers/colorbox/selector.svg" class="hue-line"/>\n\t\t</div>\n\t\t'),__p+='\n\n\t\t<div class="rmcolorbox-color-input-blocker hidden" style="height:'+(null==(__t=bottom_panel_height)?"":__t)+'px;"></div>\n\t\t<div class="rmcolorbox-swatches-button" title="Swatches"></div>\n\t\t<div class="rmcolorbox-add-to-swatches-button" title="Add Color to Swatches"></div>\n\t\t<div class="rmcolorbox-remove-from-swatches-button hidden" title="Remove from Swatches"></div>\n\t\t<div class="rmcolorbox-animation-box hidden" style="width:'+(null==(__t=width)?"":__t)+"px;height:"+(null==(__t=height)?"":__t)+'px;">\n\t\t\t<canvas width="'+(null==(__t=width)?"":__t)+'" height="'+(null==(__t=height)?"":__t)+'"></canvas>\n\t\t</div>\n\t </div>\n\n';return __p}}},uGDn:function(t,e,i){"use strict";var n=i("xeF9"),o={model:{event:"stateChange"},props:{value:{},isDisabled:{type:Boolean,default:!1},width:{type:Number,default:37},height:{type:Number,default:20},shadow:{default:"none"},colorOn:{default:"rgb(40, 40, 40)"},colorOff:{default:"rgb(184, 184, 184)"},textOn:{default:""},textOff:{default:""},textSizeOn:{default:12},textSizeOff:{default:12},textColorOn:{default:"#fff"},textColorOff:{default:"#fff"},handleColor:{default:"#fff"},handleShadow:{default:"none"},handleSpace:{default:1},callback:{type:Function,default:function(){}}},data:function(){return{internalState:!1,bodyColorStyle:null,panelPosStyle:null,panelBackOpacity:null}},computed:{handleSize:function(){return this.height-2*this.handleSpace},bodyStyle:function(){return{width:this.width+"px",height:this.height+"px","box-shadow":this.shadow,"border-radius":Math.floor(this.height/2)+"px",opacity:this.isDisabled?.5:1,cursor:this.isDisabled?"default":"pointer"}},fullWidth:function(){return 2*(this.width-this.handleSize-this.handleSpace)+this.handleSize},textWidth:function(){return Math.round(.75*this.width-8-8)},shiftWidth:function(){return this.width-this.fullWidth},panelStyle:function(){return{width:this.fullWidth+"px",height:this.height+"px"}},textStyle:function(){return{width:this.textWidth+"px","line-height":this.height+"px"}},textOffStyle:function(){return{"font-size":this.textSizeOn+"px",color:this.textColorOn}},textOnStyle:function(){return{"font-size":this.textSizeOff+"px",color:this.textColorOff}},handleStyle:function(){return{"margin-left":"-"+Math.floor(this.handleSize/2)+"px",width:this.handleSize+"px",height:this.handleSize+"px","border-radius":Math.floor(this.handleSize/2)+"px","box-shadow":this.handleShadow,background:this.handleColor,top:this.handleSpace+"px"}}},watch:{internalState:function(t){clearInterval(this.timer),this.timer=setInterval(function(){this.oneStepSwitcherPos(t)}.bind(this),20),this.$emit("stateChange",t)},value:function(t){this.internalState=t}},created:function(){this.internalState=this.value},mounted:function(){this.updateSwitcher()},methods:{setSwitcherPos:function(t){this.cur_state=t,this.bodyColorStyle={"background-color":this.colorTransform(this.colorOn,this.colorOff,t)},this.panelPosStyle={left:Math.round(this.shiftWidth*t)+"px"},this.panelBackOpacityStyle={opacity:(1-t).toFixed(2)}},updateSwitcher:function(){this.setSwitcherPos(this.internalState?0:void 0===this.internalState?.5:1)},colorTransform:function(t,e,i){var o=Object(n.parseCSSColor)(t),a=Object(n.parseCSSColor)(e);return"rgba(".concat(Math.max(Math.min(parseInt(i*(a[0]-o[0])+o[0],10),255),0),",").concat(Math.max(Math.min(parseInt(i*(a[1]-o[1])+o[1],10),255),0),",").concat(Math.max(Math.min(parseInt(i*(a[2]-o[2])+o[2],10),255),0),",").concat(Math.max(Math.min(parseFloat(i*(a[3]-o[3])+o[3],10),1),0),")")},oneStepSwitcherPos:function(t){if(void 0===t)return clearInterval(this.timer),this.setSwitcherPos(.5);var e=t?0:1,i=e<this.internalState?-1:1,n=Math.max(Math.min(this.cur_state+.1*i,1),0);(i>0&&n>=e||i<0&&n<=e)&&(n=e,clearInterval(this.timer)),this.setSwitcherPos(n)},clickHanlder:function(){if(this.isDisabled)return!1;this.internalState=!this.internalState,this.callback(this.internalState)},disableFromOutside:function(){this.isDisabled=!0}}},a=(i("LSan"),i("KHd+")),r=Object(a.a)(o,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rm-switcher",attrs:{"data-state":t.internalState?"on":"off"}},[i("div",{staticClass:"rmswitcher-body",style:[t.bodyStyle,t.bodyColorStyle]},[i("div",{ref:"panelBack",staticClass:"rmswitcher-panel-back"}),t._v(" "),i("div",{staticClass:"rmswitcher-panel",style:[t.panelStyle,t.panelPosStyle],on:{click:t.clickHanlder}},[i("div",{staticClass:"rmswitcher-panel-on",style:[t.textStyle,t.textOnStyle]},[t._v(t._s(t.textOff))]),t._v(" "),i("div",{staticClass:"rmswitcher-panel-off",style:[t.textStyle,t.textOffStyle]},[t._v(t._s(t.textOn))]),t._v(" "),i("div",{staticClass:"rmswitcher-panel-slider",style:t.handleStyle})])])])}),[],!1,null,null,null);e.a=r.exports},uU7u:function(t,e,i){"use strict";i.d(e,"f",(function(){return S})),i.d(e,"b",(function(){return k})),i.d(e,"c",(function(){return x})),i.d(e,"a",(function(){return C})),i.d(e,"e",(function(){return O})),i.d(e,"d",(function(){return P})),i.d(e,"i",(function(){return E})),i.d(e,"g",(function(){return I})),i.d(e,"h",(function(){return T}));var n=i("q1tI"),o=i.n(n),a=i("wMS7"),r=i.n(a),s=i("v83y"),l=i("DwEc"),c=i("8AXF"),d=i("8Tds"),h=i("fueH"),u=i("A9VP");function p(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}function m(){return(m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function g(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function f(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?g(Object(i),!0).forEach((function(e){v(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function b(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"==typeof t)return w(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var k,S="LINK";!function(t){t.URL="URL",t.Page="Page",t.Email="Email",t.Phone="Phone",t.Anchor="Anchor",t.ScrollToTop="ScrollToTop",t.GoBack="GoBack"}(k||(k={}));var x={name:"link-1",label:"Default Link Style",style:{link:{textColor:"0080FF64",color:"0080FF64",type:d.a.Solid,size:1,padding:0},hover:{textColor:"0080FF64",color:"0080FF64",type:d.a.None,size:1,padding:0},current:{textColor:"0080FF64",color:"0080FF64",type:d.a.None,size:1,padding:0}}},C=function(t){var e=Object(n.useContext)(c.BackboneContext).model,i=Object(n.useContext)(l.b).model,a=Object(n.useContext)(l.a).model,s=y(a?a.useTextWidgetStore({partial:!1}):Object(n.useState)(null),1)[0],d=(window.RM.viewerRouter||window.RM.constructorRouter&&window.RM.constructorRouter.preview||{}).mag,p=t.contentState&&t.entityKey?t.contentState.getEntity(t.entityKey).getData():t.data||{},g=p.url,v=p.target,_=void 0===v?"_self":v,w=p.type,S=p.linkStyle,C=p.anchorPosition,O=p.pageNum,j=p.pageUri,E=p.id,I=p.pageId,T=t.contentState&&t.blockKey&&"number"==typeof t.start&&"number"==typeof t.end?function(t){var e=t.contentState,i=t.start,n=t.end,o=t.blockKey,a=e.getBlockForKey(o).getCharacterList().slice(i,n),r={};if(a.size){var s=a.reduce((function(t,e){if(void 0===t)return 0;if(e){var i=e.getStyle().find((function(t){return Boolean(null==t?void 0:t.startsWith(u.a.FontSize))})),n=i&&h.a.getCurrentInlineStylesFromString(i,u.a.FontSize),o=(null==n?void 0:n.length)?parseInt(n[0]):0;return o>t?o:t}return t}),0);s>0&&(r.fontSize=s)}return r}({contentState:t.contentState,start:t.start,end:t.end,blockKey:t.blockKey}):{},M=function(t){var e=[S||x.name].concat(b("string"==typeof t?[t]:t));if(a&&a.currentLinkStyle&&"link"!==a.currentLinkStyle&&s){var i=P(s);i&&i.id===E&&e.push(a.currentLinkStyle)}return e.join(" ")},$=function(){var t;if(!d||!O&&!j)return"";var e=window.RM.common&&window.RM.common.isDownloadedSource&&!window.RM.common.homepageRewrite&&(null===(t=window.RM.config)||void 0===t?void 0:t.root)||"/";if(j){var i=d.getPage(j);if(i&&i._id)return"".concat(e).concat(d.getPageUri(i._id))}if(O){var n=d.getPage(O);if(n&&n._id)return"".concat(e).concat(d.getPageUri(n._id))}return"javascript:void(0)"},A=function(){if(window.RM.constructorRouter&&!window.RM.constructorRouter.previewMode)return[];var n=[],o=t.is_global||e&&e.is_global,a=t.is_above||e&&e.is_above,r=t.currentPageNum?t.currentPageNum===O:i&&i.currentPage&&i.currentPage.num===O,s=t.page?t.page.num===O:i&&i.page&&i.page.num===O;return(a?r:s)&&(n.push("back-to-top"),o&&n.push("current")),n};return o.a.createElement("a",m({},function(){switch(w){case k.URL:return{href:(t=g,/^http(s?):\/\//i.test(t)?t:"http://".concat(t)),target:_,rel:"noopener noreferrer",className:M("external-link")};case k.Email:return{href:"mailto:".concat(g),className:M("external-link")};case k.Phone:return{href:"tel:".concat(g),className:M("external-link")};case k.Anchor:return{href:"javascript:void(0)",className:M("anchor-link"),"data-anchor-link-pos":C,"data-page-uri":d&&O?O:"","data-page-id":d&&I?I:void 0};case k.ScrollToTop:return{href:"javascript:void(0)",className:M(["maglink","back-to-top"])};case k.GoBack:return{href:"javascript:void(0)",className:M("goback-link")};case k.Page:return{href:$(),target:_,className:M([].concat(b("_blank"===_?[]:["maglink"]),b(A())))};default:return{}}var t}(),{style:f({pointerEvents:d?void 0:"none"},T),dangerouslySetInnerHTML:"string"==typeof t.children?{__html:r.a.sanitize(t.children)}:void 0}),"string"!=typeof t.children?t.children:null)},O={strategy:function(t,e,i){t.findEntityRanges((function(t){var e=t.getEntity();return null!==e&&i.getEntity(e).getType()===S}),e)},component:C},j=function(t){if(!t.getSelection().isCollapsed()){var e=t.getCurrentContent(),i=t.getSelection().getStartKey(),n=t.getSelection().getStartOffset();return e.getBlockForKey(i).getEntityAt(n)}return null},P=function(t){var e=j(t);return e?t.getCurrentContent().getEntity(e).getData()||{}:null},E=function(t){var e=t.editorState,i=p(t,["editorState"]),n=P(e),o=(null==n?void 0:n.id)||h.a.generateRandomKey(),a=e.getCurrentContent().createEntity(S,"MUTABLE",f(f({},i),{},{id:o})),r=a.getLastCreatedEntityKey(),l=s.EditorState.set(e,{currentContent:a}),c=l.getSelection();if(n){var d=j(l),u=0,m=0,g=l.getCurrentContent().getBlockForKey(c.getAnchorKey());g&&g.findEntityRanges((function(t){return t.getEntity()===d}),(function(t,e){t<=c.getFocusOffset()&&t+e>=c.getFocusOffset()&&(u=t,m=e)})),m-u>0&&(c=new s.SelectionState({anchorKey:c.getAnchorKey(),anchorOffset:u,focusKey:c.getAnchorKey(),focusOffset:m,isBackward:c.getIsBackward(),hasFocus:c.getHasFocus()}))}return s.RichUtils.toggleLink(l,c,r)},I=function(t){var e=t.getSelection();return e.isCollapsed()?t:s.RichUtils.toggleLink(t,e,null)},T=function(t){var e=t.editorState,i=t.oldStyle,n=t.newStyle,o=h.a.getAllEntities(e,S);if(Object.keys(o).length){var a=Object.keys(o).reduce((function(t,e){var a,r=o[e];return r&&(null===(a=r.data)||void 0===a?void 0:a.linkStyle)===i?t.mergeEntityData(e,{linkStyle:n}):t}),e.getCurrentContent());return s.EditorState.forceSelection(s.EditorState.push(e,a,"apply-entity"),e.getSelection())}return e}},uYpM:function(t,e,i){},udqo:function(t,e,i){"use strict";var n=i("q1z7"),o=i.n(n),a=i("xi34"),r=i("rFsW"),s=i("OTSC"),l=i("pFlR"),c=i("LaNJ"),d=i.n(c),h=o.a.View.extend({viewportWidth:void 0,viewport:void 0,viewerOptions:void 0,initialize:function(t){r.a.bindAll(this),r.a.extend(this,t)},render:function(){if(this.picture){this.removing=!1,Object(a.a)("body").addClass("picture-preview-loading"),this.originalRect=this.getRect(this.$el[0]),this.orientation=this.getOrientation(),this.originalStyle=this.getOriginalStyle();var t=d.a["template-picture-preview-box"];return this.$preview=Object(a.a)(t({overlayColor:this.overlayColor,previewSrc:this.getPreviewSrc(),originalStyle:this.originalStyle})),this.$container.append(this.$preview),Object(a.a)(window).on("scroll",this.onScroll),Object(a.a)("body").on("keypress keyup keydown",this.onKeyPress),setTimeout(this.setVisible,100),this.$preview}},imagePreload:function(){var t=this;if(!this.removing&&this.picture){var e=this.picture.unscaledOptimizedUrl||this.picture.unscaledUrl||this.picture.final3xUrl||this.picture.final2xUrl||this.picture.finalUrl;this.getPreviewSrc()!==e?(this.img=new Image,this.img.onload=function(){Object(a.a)("body").removeClass("picture-preview-loading"),t.$preview&&setTimeout((function(){t.removing||t.$preview.find(".picture-preview-box .picture-preview-box-image").attr("src",t.img.src).removeAttr("srcset")}),100)},this.img.src=e):Object(a.a)("body").removeClass("picture-preview-loading")}},remove:function(t){var e=this;if(this.removing=!0,Object(a.a)("body").removeClass("picture-preview-loading"),Object(a.a)("body").off("keypress keyup keydown",this.onKeyPress),Object(a.a)(window).off("scroll",this.onScroll),this.img&&(this.img.src="",delete this.img),this.$preview){var i=this.$preview.find(".picture-preview-box");i.removeClass("visible loaded").removeClass(this.orientation),s.default.waitForTransitionEnd(i.find(".picture-preview-box-overlay"),300,"opacity",(function(){e.$preview&&e.$preview.remove(),delete e.$preview})),t&&t()}},changeColor:function(t){this.$preview&&this.$preview.find(".picture-preview-box-overlay").css("background-color",t)},onScroll:function(){this.remove()},setVisible:function(){var t=this;if(!this.removing){var e=this.$preview.find(".picture-preview-box img")[0],i=function i(){e.removeEventListener("load",i),t.$preview.find(".picture-preview-box").addClass("visible").addClass(t.orientation),s.default.waitForTransitionEnd(t.$preview.find(".picture-preview-box .picture-preview-box-overlay"),300,"opacity",t.imagePreload)};setTimeout((function(){e.complete?i():e.addEventListener("load",i)}),100)}},getPreviewSrc:function(){var t=this.$el.find("img")[0];return t&&(t.currentSrc||t.src)||this.picture&&(this.picture.unscaledOptimizedUrl||this.picture.final3xUrl||this.picture.final2xUrl||this.picture.finalUrl)},getOriginalStyle:function(){if(!this.originalRect)return{};var t=l.a.isOn(this.viewport,this.viewportWidth,this.viewerOptions)&&l.a.isCSSZoom()?l.a.getRatio(this.viewportWidth):1,e={top:Number(this.originalRect.top+.5*this.originalRect.height)*t+"px",left:Number(this.originalRect.left+.5*this.originalRect.width)*t+"px"};return"portrait"===this.orientation?e.height=this.originalRect.height*t+"px":"landscape"===this.orientation&&(e.width=this.originalRect.width*t+"px"),e},getOrientation:function(){var t=this.originalRect.height/this.originalRect.width,e=Object(a.a)(window).width();return Object(a.a)(window).height()/t<e?"portrait":"landscape"},bindClick:function(){var t=this;this.$preview&&this.$preview.on("click",(function(){t.remove()}))},onKeyPress:function(t){27===t.keyCode&&this.remove()},getRect:function(t){var e=r.a.extend({},t.getBoundingClientRect());if(Modernizr.safari){var i=l.a.isOn(this.viewport,this.viewportWidth,this.viewerOptions)&&l.a.isCSSZoom()?l.a.getRatio(this.viewportWidth):1;e.top=e.top+(Object(a.a)(window).scrollTop()-Object(a.a)(window).scrollTop()/i)}return e}});e.a=h},ulVh:function(t,e,i){"use strict";var n=i("v83y"),o=i("DYKh"),a=i.n(o),r=i("Zgb7"),s=i.n(r),l=i("Pgkd"),c=i("fueH"),d=i("M7m1"),h=i("HjzJ"),u=i("w5C2"),p=i("uU7u"),m=i("A9VP"),g=Object(l.a)({htmlToEntity:function(t,e,i){if("a"===t)return i(p.f,"MUTABLE",Object(d.c)(e))},htmlToStyle:function(t,e,i){return"b"===t?i.add(c.a.getStyleValueString(m.a.FontWeight,"700")):"i"===t?i.add(c.a.getStyleValueString(m.a.FontStyle,"italic")):i},htmlToBlock:function(t,e){if("p"===t)return{type:u.a.Unstyled,data:Object(d.b)(e,{ignore:{lineHeight:!0,textStyles:!0}})}}}),f="data-draftjs-conductor-fragment",v='[data-contents="true"] [contenteditable="false"]',b=function(t,e,i){var o,r,l,c=(i||window).getSelection();if(e.clipboardData&&c&&t&&0!==c.rangeCount&&!function(t){var e=t.anchorNode,i=t.focusNode;if(!e||!i)return!1;var n=e instanceof Element?e:e.parentElement,o=i instanceof Element?i:i.parentElement,a=n&&n.closest(v),r=o&&o.closest(v);return a&&r&&(a.contains(r)||r.contains(a))}(c)&&(null===(o=t.current)||void 0===o?void 0:o._latestEditorState)){var d=function(t,e){var i=s()(t,e).selectionState,n=a()(t.getCurrentContent(),i);return n.every((function(t){return Boolean(t&&0===t.getText().length)}))?null:n}(null===(r=t.current)||void 0===r?void 0:r._latestEditorState,null===(l=t.current)||void 0===l?void 0:l.editor);if(d){var h=n.ContentState.createFromBlockArray(d.toArray()),u=JSON.stringify(Object(n.convertToRaw)(h)),p=document.createElement("div");p.appendChild(c.getRangeAt(0).cloneContents()),p.setAttribute(f,u),p.setAttribute("style","white-space: pre-wrap;"),e.clipboardData.setData("text/plain",c.toString()),e.clipboardData.setData("text/html",p.outerHTML),e.preventDefault()}}},y=function(t,e){var i,n=null===(i=t.current)||void 0===i?void 0:i.editor,o=function(i){b(t,i,e)};return n&&n.addEventListener("copy",o),n&&n.addEventListener("cut",o),{unregister:function(){n&&n.removeEventListener("copy",o),n&&n.removeEventListener("cut",o)}}},_=function(t){var e=t.text,i=t.html,o=t.editorState,a=function(t){if(""===t||null==t)return null;var e=(new DOMParser).parseFromString(t,"text/html").querySelector("[".concat(f,"]"));if(e){var i=e.getAttribute(f);try{if(i){var o=JSON.parse(i);if(o)return Object(n.convertFromRaw)(o)}}catch(t){return null}}return null}(i),r=c.a.fixSelection(o),s=o.getCurrentContent();if(a){var l=a.getBlockMap(),d=l.first(),p=s.getBlockForKey(r.getStartKey());!p.getText()&&p.getType()===u.a.Unstyled&&Object(h.e)(d.getType())||p.getType()!==u.a.Unstyled&&p.getType()===d.getType()||(l=l.map((function(t){return null==t?void 0:t.set("data",p.getData()).set("type",p.getType())})));var m=n.Modifier.replaceWithFragment(s,r,l);return n.EditorState.push(o,m,"insert-fragment")}if(c.a.isWholeBlockSelected(o)){var v=i?g(i):void 0;if(v){var b=n.Modifier.replaceWithFragment(s,r,v.getBlockMap());return n.EditorState.push(o,b,"insert-fragment")}}return!!e&&c.a.insertText({editorState:o,text:e})},w=function(t,e){var i=t.current,n=null==i?void 0:i.editor;if(i&&n){var o=function(t){var o;t.stopPropagation(),t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,i._dragCount=0,i.exitCurrentMode();var a=k(t);if(a){if(null===(o=i.props)||void 0===o?void 0:o.handleDrop){var r,s=i._internalDrag?"internal":"external";null===(r=i.props)||void 0===r||r.handleDrop(a,{},s)}i._internalDrag=!1,function(){var t=n;if(t){var i=new MouseEvent("mouseup",{view:e,bubbles:!0,cancelable:!0});t.dispatchEvent(i)}}()}};return n.addEventListener("drop",o,!0),{unregister:function(){n.removeEventListener("drop",o,!0)}}}},k=function(t){var e=null,i=null,o=function(t){return t&&t.ownerDocument?t.ownerDocument:document}(t.currentTarget);if("function"==typeof o.caretRangeFromPoint){var a=o.caretRangeFromPoint(t.x,t.y);e=a.startContainer,i=a.startOffset}else{if(!t.rangeParent)return null;e=t.rangeParent,i=t.rangeOffset}var r=function(t){var e="data-offset-key",i=t.nodeType===Node.TEXT_NODE&&t.parentElement||t;if(!i)return null;var n=i.closest("[".concat(e,"]"));if(!n)return null;var o=n.getAttribute(e),a=null==o?void 0:o.split("-");return a&&a.length?a[0]:null}(e);return r?new n.SelectionState({anchorKey:r,anchorOffset:i,focusKey:r,focusOffset:i,isBackward:!1,hasFocus:!1}):null};i.d(e,"b",(function(){return g})),i.d(e,"c",(function(){return y})),i.d(e,"a",(function(){return _})),i.d(e,"d",(function(){return w}))},uxFs:function(t,e,i){"use strict";var n=i("vOnD"),o=i("q1tI"),a=i.n(o),r=i("xG9w"),s=i("saLn"),l=i("8AXF"),c=i("v83y"),d=i("iC7s"),h=i("L2iM"),u=i("A9VP"),p=i("3ES5"),m=i("fueH"),g=i("ulVh"),f=i("IiUL"),v=i("QuYs");function b(){return(b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function y(t,e){if(null==t)return{};var i,n,o=function(t,e){if(null==t)return{};var i,n,o={},a=Object.keys(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)i=a[n],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i])}return o}var _,w=function(t,e){t.isEditMode;var i=t.textDirection,n=t.autosize,r=t.columns,s=t.verticalAlign,l=t.bgColor,_=t.shouldShowSelectionBorder,w=t.useBaseline,k=y(t,["isEditMode","textDirection","autosize","columns","verticalAlign","bgColor","shouldShowSelectionBorder","useBaseline"]),S=Object(o.useRef)(null),x=Object(o.useContext)(f.FrameContext);return Object(o.useEffect)((function(){if(S&&null!==S.current){var t=x&&x.window||window,e=Object(g.c)(S,t),i=Object(g.d)(S,t);return function(){e.unregister(),null==i||i.unregister()}}}),[S]),Object(o.useEffect)((function(){e.current&&S.current&&!e.current.focusEditor&&(e.current.focusEditor=S.current.focus)}),[S,e]),a.a.createElement(p.a,{ref:e,textDirection:i,autosize:n,columns:r,verticalAlign:s,bgColor:l,shouldShowSelectionBorder:_,useBaseline:w},a.a.createElement(d.m,null,a.a.createElement(c.Editor,b({ref:S,spellCheck:!1,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",stripPastedStyles:!1,blockRenderMap:c.DefaultDraftBlockRenderMap.merge(Object(h.b)()),customStyleFn:u.b,handlePastedText:function(t,e,i){var n=Object(g.a)({text:t,html:e,editorState:i});return n?(k.onChange(n),"handled"):"not-handled"},handleReturn:function(t,e){if(t.shiftKey){var i=m.a.insertBreakLine(e);return k.onChange(i),v.d.sendEvent(v.b.KeyPress,{eventLabel:"Line-breaking"}),"handled"}var n=m.a.cloneStylesOnReturn(e);if(n){var o=n.status,a=n.editorState;return k.onChange(a),o}return"not-handled"},handleDrop:function(t){return t?(k.onChange(m.a.moveText({editorState:k.editorState,dropSelection:t})),"handled"):"not-handled"}},k))))},k=a.a.forwardRef(w),S=i("8Tds"),x=i("a68n"),C=i("IrH7"),O=i("ePHO"),j=i("DwEc"),P=i("vvfI"),E=i("38uW"),I=i("OTSC"),T=function(t){var e=t.editorState,i=t.method,n=m.a.getCurrentInlineStyles(e,u.a.LetterSpacing),o=n&&n.length?parseFloat(n[0]):0,a="decrease"===i?-1:1;return m.a.applyInlineStyle({key:u.a.LetterSpacing,value:I.default.decimals(o+.2*a,2),editorState:e})},M=i("w5C2"),$=function(t){var e=t.editorState,i=t.method,n=m.a.getCurrentInlineStyles(e,u.a.FontSize),o=n&&n.length?parseInt(n[0]):M.b.fontSize,a="decrease"===i?-1:1;return m.a.applyInlineStyle({key:u.a.FontSize,value:o+a,editorState:e})},A=i("KiUg");!function(t){t.InsertNbsp="InsertNbsp",t.InsertThinsp="InsertThinsp",t.InsertEnsp="InsertEnsp",t.IncreaseIndent="IncreaseIndent",t.DecreaseIndent="DecreaseIndent",t.DecreaseLineHeight="DecreaseLineHeight",t.IncreaseLineHeight="IncreaseLineHeight",t.DecreaseLetterSpacing="DecreaseLetterSpacing",t.IncreaseLetterSpacing="IncreaseLetterSpacing",t.ToggleTypographyPanel="ToggleTypographyPanel",t.ToggleLinkPanel="ToggleLinkPanel",t.IncreaseFontSize="IncreaseFontSize",t.DecreaseFontSize="DecreaseFontSize",t.AlignLeft="AlignLeft",t.AlignRight="AlignRight",t.AlignCenter="AlignCenter",t.SelectParagraph="SelectParagraph",t.ToggleBold="ToggleBold",t.ToggleUnderline="ToggleUnderline",t.ToggleItalic="ToggleItalic"}(_||(_={}));var R=function(t){var e=t.event,i=t.keyCode,n=t.ctrlOrCmd,o=void 0!==n&&n,a=t.shift,r=void 0!==a&&a,s=t.alt,l=void 0!==s&&s,d=c.KeyBindingUtil.usesMacOSHeuristics();return i===e.keyCode&&r===e.shiftKey&&l===e.altKey&&(d?o===e.metaKey:o===e.ctrlKey)},D=function(t){return R({event:t,keyCode:32,alt:!0})||R({event:t,keyCode:32,alt:!0,ctrlOrCmd:!0})?_.InsertNbsp:R({event:t,keyCode:32,alt:!0,ctrlOrCmd:!0,shift:!0})?_.InsertThinsp:R({event:t,keyCode:32,alt:!0,shift:!0})?_.InsertEnsp:R({event:t,keyCode:9})?_.IncreaseIndent:R({event:t,keyCode:9,shift:!0})?_.DecreaseIndent:R({event:t,keyCode:38,alt:!0})?_.DecreaseLineHeight:R({event:t,keyCode:40,alt:!0})?_.IncreaseLineHeight:R({event:t,keyCode:37,alt:!0})?_.DecreaseLetterSpacing:R({event:t,keyCode:39,alt:!0})?_.IncreaseLetterSpacing:R({event:t,keyCode:84,alt:!0,ctrlOrCmd:!0})?_.ToggleTypographyPanel:R({event:t,keyCode:75,ctrlOrCmd:!0})?_.ToggleLinkPanel:R({event:t,keyCode:190,ctrlOrCmd:!0,shift:!0})?_.IncreaseFontSize:R({event:t,keyCode:188,ctrlOrCmd:!0,shift:!0})?_.DecreaseFontSize:R({event:t,keyCode:76,ctrlOrCmd:!0,shift:!0})?_.AlignLeft:R({event:t,keyCode:82,ctrlOrCmd:!0,shift:!0})?_.AlignRight:R({event:t,keyCode:67,ctrlOrCmd:!0,shift:!0})?_.AlignCenter:R({event:t,keyCode:65,ctrlOrCmd:!0,shift:!0})?_.SelectParagraph:R({event:t,keyCode:66,ctrlOrCmd:!0})?_.ToggleBold:R({event:t,keyCode:73,ctrlOrCmd:!0})?_.ToggleItalic:R({event:t,keyCode:85,ctrlOrCmd:!0})?_.ToggleUnderline:Object(c.getDefaultKeyBinding)(t)},B=i("JW7n"),L=i("HjzJ"),z=i("Jzj8"),F=i("sxjd");function U(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function N(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?U(Object(i),!0).forEach((function(e){H(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):U(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function H(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function V(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||G(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],n=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done)&&(i.push(r.value),!e||i.length!==e);n=!0);}catch(t){o=!0,a=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}return i}(t,e)||G(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){if(t){if("string"==typeof t)return q(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?q(t,e):void 0}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}i.d(e,"a",(function(){return K}));var K=a.a.createContext({}),Y=function(t){var e,i=t.readOnly,n=Object(o.useContext)(l.BackboneContext),h=n.model,p=n.modelSet,g=n.modelSave,f=Object(o.useContext)(j.a).model,v=f.useTextWidgetStore,b=f.isEditMode,y=f.workspace,w=f.selected,I=W(v({partial:!1}),2),R=I[0],B=I[1],F=Object(o.useContext)(O.a).isPaddingsEnabled,U=Object(s.a)(g,400).callback,G=Object(s.a)((function(t){if(b&&t.getLastChangeType()){var e=m.a.exportTextContent(t.getCurrentContent()),i=Object.keys(e),n=r.pick.apply(void 0,[h].concat(V(i))),o=Object(r.isEqual)(e,n);p(e),o||U()}}),20).callback;Object(o.useEffect)((function(){b&&setTimeout((function(){var t;null===(t=Y.current)||void 0===t||t.focusEditor()}),0)}),[b]),Object(o.useEffect)((function(){G(R)}),[R]);var q=Object(o.useMemo)((function(){return R.getSelection().getHasFocus()}),[R]),K=Object(o.useMemo)((function(){return b}),[b,q]),Y=Object(o.useRef)(null),X=Object(d.Yb)(Y).height;Object(o.useEffect)((function(){X>0&&X!==h.h&&b&&(!(h.columns&&h.columns.count>1)&&h.autosize&&(p({h:X}),U()))}),[X,h.autosize,h.columns]),Object(o.useEffect)((function(){Modernizr.firefox||b||R.getSelection().isCollapsed()||B(m.a.clearSelection(R))}),[b]);var Z=W(Object(z.h)(),2),J=Z[0],Q=Z[1];return Object(o.useEffect)((function(){var t=m.a.getCurrentInlineStyles(R,u.a.FontFamily)[0]||M.b.fontFamily,e=m.a.getCurrentInlineStyles(R,u.a.FontWeight)[0]||M.b.fontWeight,i=m.a.getCurrentInlineStyles(R,u.a.FontStyle)[0]||M.b.fontStyle;if(t&&e&&i){var n=Object(z.a)({fontFamily:t,fontWeight:e,fontStyle:i});J[n]||m.a.getFontFeatures({fontFamily:t,fontWeight:e,fontStyle:i}).then((function(t){if(t){var e=t.features,i=t.variations,o=t.characters;Q(N(N({},J),{},H({},n,{features:e,variations:i,characters:o})))}}))}}),[R]),a.a.createElement(k,{ref:Y,isEditMode:b,bgColor:h.bgColor,textDirection:h.textDirection||S.b.LTR,autosize:h.autosize,columns:h.columns,verticalAlign:h.verticalAlign,useBaseline:null===(e=h.flags)||void 0===e?void 0:e.baseline,shouldShowSelectionBorder:K,editorState:R,blockStyleFn:function(t){var e=t.getType();return[e,Object(x.b)({block:t}),Object(C.d)({block:t}),Object(L.e)(e)?Object(L.d)({block:t}):void 0].filter((function(t){return t})).join(" ")},onChange:function(t){var e=t.getSelection(),i=t;i=(i=m.a.forceSelection(t,m.a.reverseSelection(e))).getSelection().isCollapsed()?i:m.a.forceSelection(i,m.a.fixSelection(i)),Modernizr.safari&&!e.isCollapsed()&&(i=c.EditorState.acceptSelection(i,i.getSelection())),B(i)},readOnly:!b||!w||i||F,keyBindingFn:D,handleKeyCommand:function(t){var e=function(t){var e=t.action,i=t.editorState,n=t.workspace;if(e===_.InsertNbsp)return{status:"handled",editorState:m.a.insertText({editorState:i,text:A.b})};if(e===_.InsertEnsp)return{status:"handled",editorState:m.a.insertText({editorState:i,text:String.fromCharCode(8194)})};if(e===_.InsertThinsp)return{status:"handled",editorState:m.a.insertText({editorState:i,text:String.fromCharCode(8201)})};if(e===_.IncreaseIndent){var o=Object(P.b)({editorState:i,method:"increase"});if(o)return{status:"handled",editorState:o}}if("backspace"===e||e===_.DecreaseIndent){var a=Object(P.b)({editorState:i,method:"decrease"});if(a)return{status:"handled",editorState:a}}if(e===_.DecreaseLineHeight){var r=Object(E.b)({editorState:i,method:"decrease"});if(r)return{status:"handled",editorState:r}}if(e===_.IncreaseLineHeight){var s=Object(E.b)({editorState:i,method:"increase"});if(s)return{status:"handled",editorState:s}}if(e===_.IncreaseLetterSpacing)if(i.getSelection().isCollapsed()){var l=m.a.getWordCaretSelection(i,"next");if(l)return{status:"handled",editorState:l}}else{var c=T({editorState:i,method:"increase"});if(c)return{status:"handled",editorState:c}}if(e===_.DecreaseLetterSpacing)if(i.getSelection().isCollapsed()){var d=m.a.getWordCaretSelection(i,"prev");if(d)return{status:"handled",editorState:d}}else{var h=T({editorState:i,method:"decrease"});if(h)return{status:"handled",editorState:h}}if(e===_.ToggleTypographyPanel){var p=n.controls.findControl("text_typography_new");if(p)return p.onClick.apply(p),{status:"handled",editorState:i}}if(e===_.ToggleLinkPanel){var g=n.controls.findControl("text_link_new");if(g)return g.onClick.apply(g),{status:"handled",editorState:i}}if(e===_.IncreaseFontSize)return{status:"handled",editorState:$({editorState:i,method:"increase"})};if(e===_.DecreaseFontSize)return{status:"handled",editorState:$({editorState:i,method:"decrease"})};if(e===_.AlignLeft||e===_.AlignRight||e===_.AlignCenter){var f=e===_.AlignLeft?C.a.AlignLeft:e===_.AlignRight?C.a.AlignRight:C.a.AlignCenter;return{status:"handled",editorState:Object(C.e)({editorState:i,align:f})}}if(e===_.SelectParagraph)return{status:"handled",editorState:m.a.selectCurrentBlock(i)};if(e===_.ToggleBold){var v=m.a.getCurrentInlineStyles(i,u.a.FontWeight);return{status:"handled",editorState:m.a.applyInlineStyle({editorState:i,key:u.a.FontWeight,value:v&&"700"===v[0]?M.b.fontWeight:"700"})}}if(e===_.ToggleItalic){var b=m.a.getCurrentInlineStyles(i,u.a.FontStyle);return{status:"handled",editorState:m.a.applyInlineStyle({editorState:i,key:u.a.FontStyle,value:b&&"italic"===b[0]?M.b.fontStyle:"italic"})}}if(e===_.ToggleUnderline){var y=m.a.getCurrentInlineStyles(i,u.a.Decoration);return{status:"handled",editorState:m.a.applyInlineStyle({editorState:i,key:u.a.Decoration,value:y&&"underline"===y[0]?"none":"underline"})}}}({action:t,editorState:R,workspace:y});if(e){var i=e.editorState,n=e.status;return B(i),n}return"not-handled"}})},X=Object(n.e)(d.m).withConfig({displayName:"TextConstructor___StyledBox"})(["user-select:none;"]),Z=Object(n.e)(d.m).withConfig({displayName:"TextConstructor___StyledBox2"})(["user-select:none;"]),J=Object(n.e)(d.m).withConfig({displayName:"TextConstructor___StyledBox3"})(["user-select:none;"]),Q=Object(n.e)(d.m).withConfig({displayName:"TextConstructor___StyledBox4"})(["user-select:none;"]),tt=function(t){var e=t.size,i=t.height,n=t.width,o=t.onClick;return(a.a.createElement(a.a.Fragment,null,a.a.createElement(X,{position:"absolute",top:0,left:0,width:n+2*e,height:e,onClick:o}),a.a.createElement(Z,{position:"absolute",bottom:0,left:0,width:n+2*e,height:e,onClick:o}),a.a.createElement(J,{position:"absolute",top:0,left:0,width:e,height:i+2*e,onClick:o}),a.a.createElement(Q,{position:"absolute",top:0,right:0,width:e,height:i+2*e,onClick:o})))},et=Object(n.e)(d.m).withConfig({displayName:"TextConstructor___StyledBox5"})(["width:calc(var(--workspace-inverse-zoom) * 100%);height:calc(var(--workspace-inverse-zoom) * 100%);zoom:var(--workspace-inverse-zoom);transform:scale(var(--workspace-zoom));transform-origin:left top;"]),it=Object(n.e)(d.m).withConfig({displayName:"TextConstructor___StyledBox6"})(["pointer-events:none;user-select:none;"]);e.b=function(){var t=Object(o.useContext)(j.a).model,e=t.useTextWidgetStore,i=t.fontStyles,n=t.isResizing,r=t.leaveEditMode,s=t.isEditMode,c=t.canControlsBeClosed,h=t.onIframeLoaded,u=W(e({partial:!1}),1)[0],p=Object(o.useContext)(l.BackboneContext).model,m=p.autosize,g=p.w,f=p.h,v=p.columns,b=W(Object(o.useState)(!1),2),y=b[0],_=b[1];Object(o.useEffect)((function(){(y||n)&&I.default.getFocusBack()}),[y,n]);var w=Object(o.useRef)(null),k=m&&(!v||v&&v.count<=1),S=k?500:0,x=k?{position:"absolute",top:-1*S,left:-1*S,width:"calc(100% + ".concat(2*S,"px)"),height:"calc(100% + ".concat(2*S,"px)")}:{},C=W(Object(o.useState)(!1),2),P=C[0],E=C[1],T=W(Object(o.useState)(!1),2),M=T[0],$=T[1];return Object(o.useEffect)((function(){s&&!P&&E(!0)}),[s]),a.a.createElement(K.Provider,{value:{ref:w}},a.a.createElement(O.a.Provider,{value:{isPaddingsEnabled:y,setIsPaddingsEnabled:_}},a.a.createElement(et,{height:"100%",width:"100%",position:"relative"},P&&a.a.createElement(d.tb,{ref:w,style:N({display:s?void 0:"none",pointerEvents:!s||y||n?"none":void 0,userSelect:"none"},x),head:a.a.createElement(a.a.Fragment,null,a.a.createElement("style",null,"\n                      body {\n                        margin: 0;\n                        height: 100vh;\n                        width: 100vw;\n                        overflow: hidden;\n                        box-sizing: border-box;\n                        padding: ".concat(S,"px;\n                      }\n\n                      .frame-root, .frame-content {\n                        height: 100%;\n                        width: 100%;\n                      }\n\n                      ol, ul {\n                        padding: 0;\n                        margin: 0;\n                      }\n                  ")),i.map((function(t,e){return"style"===t.tag?a.a.createElement("style",{key:e},"".concat(t.style)):"link"===t.tag?a.a.createElement("link",{key:e,rel:"stylesheet",type:t.type,href:t.href}):void 0}))),contentDidMount:function(){h(),$(!0)}},a.a.createElement(B.a,{mode:"constructor"}),k&&s&&a.a.createElement(tt,{size:S,height:f,width:g,onClick:function(){c()&&r()}}),a.a.createElement(Y,null)),s&&M?null:a.a.createElement(it,{height:"100%",width:"100%",position:"absolute",top:0,left:0},a.a.createElement(F.a,{editorState:u,isConstructorPreview:!0})))))}},v92f:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var n,o,a=i("rFsW"),r=i("f3SV"),s=i("I0kf");function l(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function c(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?l(Object(i),!0).forEach((function(e){d(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function d(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}!function(t){t.Default="default",t.TabletPortrait="tablet_portrait",t.PhonePortrait="phone_portrait"}(o||(o={}));var h=[{name:o.Default,min_scale_width:Object(s.a)("constructor.customViewportWidth")?769:1024,max_width:2048,width:1024,min_height:400,max_height:201600,caption:"Laptop & Tablet Landscape",shortcut:"1"},{name:o.TabletPortrait,width:768,min_height:926,max_height:201600,caption:"Tablet Portrait",shortcut:"2",deprecated:!0},{name:o.PhonePortrait,width:320,min_height:568,max_height:201600,caption:"Phone Portrait",shortcut:"3"}],u=["x","y","w","h","z","hidden","angle","flip_h","flip_v","pack_id","fixed_position","is_full_width","is_full_height","sticked","sticked_margin","animation","triggers"],p=(d(n={background:a.a.union(["color","opacity","selectedType","picture","slideshow"],u),picture:a.a.union(["picture","cropW","cropH","cropX","cropY","originalW","originalH","ratio","scale","pic_opacity","pic_color","border_size","border_color","border_radius","border_radius_max","border_radius_tl","border_radius_tr","border_radius_bl","border_radius_br","border_radius_independent","opacity","anchor_link_pos","preview_overlay_color"],u),slideshow:a.a.union(["images_h","captions_h","play_method"],u),text:Object(s.a)("constructor.textv3")?a.a.union(["styles","bgColor","columns","blocksMeta","entityMap"],u):a.a.union(["column_count","column_gap","bg_color","bg_opacity"],u),shape:a.a.union(["rasterUrl","raster2xUrl","borders","weight","anchor_link_pos","bg_color"],u),button:a.a.union(["text_w","text_h","em_w","anchor_link_pos","font-size","font-style","font-weight","font-family","color","color-opacity","letter-spacing","hover-color","hover-color-opacity","current-font-size","current-font-style","current-font-weight","current-font-family","current-color","current-color-opacity","current-letter-spacing","background-color","background-color-opacity","hover-background-color","hover-background-color-opacity","current-background-color","current-background-color-opacity","border-radius","border-width","border-color","border-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","current-border-radius","current-border-width","current-border-color","current-border-color-opacity"],u),hotspot:a.a.union(["borders","weight","anchor_link_pos"],u),form:a.a.union(["layout","style","style-colored-button-default","style-colored-button-hover","style-colored-fields","style-outlined-button-default","style-outlined-button-hover","style-outlined-fields","style-underlined-button-default","style-underlined-button-hover","style-underlined-fields"],u)},r.a.ecommerceCartBlockName,a.a.union(["text_w","text_h","em_w","background-color","background-color-opacity","border-radius","border-width","border-color","border-color-opacity","font-family","font-style","font-weight","color","color-opacity","font-size","letter-spacing","hover-background-color","hover-background-color-opacity","hover-border-width","hover-border-color","hover-border-color-opacity","hover-color","hover-color-opacity","hover-border-radius","hover-tansition-duration"],u)),d(n,r.a.addToCartBlockName,a.a.union(["layout","btn_w","btn_h","text_w","text_h","select_btn_margin","attributes_margin","background-color","background-color-opacity","border-radius","border-width","border-color","border-color-opacity","font-family","font-style","font-weight","font-size","color","color-opacity","letter-spacing","text-align","hover-tansition-duration","hover-background-color","hover-background-color-opacity","hover-border-radius","hover-border-width","hover-border-color","hover-border-color-opacity","hover-color","hover-color-opacity","attrs-background-color","attrs-background-color-opacity","attrs-border-radius","attrs-border-width","attrs-border-color","attrs-border-color-opacity","attrs-font-family","attrs-font-style","attrs-font-weight","attrs-font-size","attrs-color","attrs-color-opacity","attrs-letter-spacing","attrs-text-align","attrs-hover-background-color","attrs-hover-background-color-opacity","attrs-hover-border-radius","attrs-hover-border-width","attrs-hover-border-color","attrs-hover-border-color-opacity","attrs-hover-color","attrs-hover-color-opacity","attrs-icon-h","attrs-icon-w","attrs-text_w","attrs-text_h"],u)),d(n,"shots",a.a.union(["playbackType","scrollSpeed","scrollStartPoint","startPointOffset","scrollDelay","hoverDirection"],u)),n),m=a.a.map(h,(function(t){return"viewport_"+t.name})),g=a.a.without(m,"viewport_default"),f=h.reduce((function(t,e){return c(c({},t),{},d({},e.name,e))}),{});e.b={viewports:h,viewport_fields_common:u,viewport_fields:p,viewport_listall:m,viewport_list:g,widgetViewportFields:function(t){return p[t]||u},dictionary:f}},vIxw:function(t,e,i){"use strict";var n=i("rFsW"),o=i("OTSC"),a=i("WoDZ"),r=i("Wa0v"),s=i("Ragx"),l=i("C84a"),c=(i("WT2/"),i("KHd+")),d=Object(c.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M23.9917 12.9488C23.916 14.6685 22.7602 17.0232 20.5245 20.0118C18.2134 23.1338 16.2579 24.6946 14.6582 24.6946C13.6676 24.6946 12.8286 23.7444 12.1439 21.8427C11.6862 20.0998 11.2291 18.3571 10.7715 16.6143C10.2628 14.7138 9.71728 13.7624 9.13401 13.7624C9.00685 13.7624 8.56179 14.0404 7.79985 14.5944L7 13.5236C7.83895 12.7577 8.66668 11.9916 9.48098 11.2246C10.5999 10.2197 11.4399 9.6913 11.9997 9.63805C13.3228 9.50598 14.1371 10.4458 14.4428 12.4574C14.7729 14.6279 15.0016 15.978 15.1301 16.5064C15.5114 18.3072 15.931 19.2064 16.3894 19.2064C16.7453 19.2064 17.2797 18.6223 17.9924 17.4543C18.7042 16.2862 19.0856 15.3974 19.137 14.7868C19.2385 13.7787 18.857 13.2732 17.9924 13.2732C17.5852 13.2732 17.1658 13.3706 16.7342 13.5629C17.5696 10.7191 19.1659 9.33795 21.5221 9.41677C23.2688 9.47019 24.0923 10.6473 23.9917 12.9488Z"}})])}),[],!1,null,"644dd906",null).exports,h=(i("kr2/"),Object(c.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24.7728 12.5609C24.7728 12.5609 24.5969 11.3852 24.0572 10.8674C23.3727 10.1879 22.6055 10.1845 22.2536 10.1447C19.7348 9.97217 15.9564 9.97217 15.9564 9.97217H15.9486C15.9486 9.97217 12.1703 9.97217 9.65136 10.1447C9.2995 10.1845 8.53256 10.1879 7.84784 10.8674C7.30814 11.3852 7.13252 12.5609 7.13252 12.5609C7.13252 12.5609 6.95251 13.9416 6.95251 15.3223V16.6167C6.95251 17.9973 7.13252 19.378 7.13252 19.378C7.13252 19.378 7.30814 20.5537 7.84784 21.0715C8.53256 21.751 9.43199 21.7296 9.83259 21.8008C11.2726 21.9317 15.9525 21.9722 15.9525 21.9722C15.9525 21.9722 19.7348 21.9668 22.2536 21.7942C22.6055 21.7544 23.3727 21.751 24.0572 21.0715C24.5969 20.5537 24.7728 19.378 24.7728 19.378C24.7728 19.378 24.9525 17.9973 24.9525 16.6167V15.3223C24.9525 13.9416 24.7728 12.5609 24.7728 12.5609ZM14.0942 18.1852L14.0934 13.3914L18.9571 15.7967L14.0942 18.1852Z"}})])}),[],!1,null,"278f04fb",null).exports),u={components:{SearchIcon:r.a,ArrowIcon:s.a,XMarkIcon:l.a,VimeoLogo:d,YoutubeLogo:h},model:{event:"change:url",prop:"url"},props:{url:String,highlightOnError:Boolean,showSocial:!0,isVideoProcessed:!1,placeholder:{type:String,default:"Search or paste URL"}},data:function(){return{isError:!1}},computed:{searchUrl:{get:function(){return this.url},set:function(t){this.$emit("change:url",t)}},showIcon:function(){return Boolean(this.url)},isRemove:function(){return this.isVideoProcessed||this.isError},isUpload:function(){return this.isURL(this.url)&&!this.isVideoProcessed},highlightInput:function(){return this.highlightOnError&&this.isError}},methods:{onIconClick:function(t){this.isRemove?(this.$emit("change:url",null),this.$emit("remove")):this.processInputVideo()},onEnter:function(){this.processInputVideo()},processInputVideo:function(){this.url&&(this.isURL(this.url)?this.getVideoFromUrl(this.url):RM.views.searchYouTube&&RM.views.searchYouTube.show(this.url,{choose:this.uploadVideoFromSearch}))},parseStartTime:function(t){var e,i,a=0;return(e=o.default.queryUrlGetParam("t",t))?(i=e.match(/(\d+)(m?)(\d*)(s?)/),n.a.isEmpty(i)||!parseInt(i[1],10)?null:("m"===i[2].toLowerCase()?a+=60*parseInt(i[1],10):a+=parseInt(i[1],10),parseInt(i[3],10)&&(a+=parseInt(i[3],10)),a)):null},getVideoFromUrl:function(t){var e,i,o,r=t;if(i=a.a.isVimeo(r),!(e=a.a.isYoutube(r))&&!i)return this.$emit("wrongUrl"),this.isError=!0,void(this.highlightremovalTimeout=setTimeout(function(){this.isError=!1}.bind(this),200));o=this.parseStartTime(r);var s={url:r=r.replace(/\/?#?$/,""),provider_name:a.a.getVideoProvider(r)};o&&(s.start_time=o),e&&(s.video_id=a.a.getYoutubeIdFromUrl(r)),this.videoEmbedXHR&&this.videoEmbedXHR.abort(),this.videoEmbedXHR=a.a.getEmbedData(r,n.a.bind((function(t){this.url=t.url?t.url:this.url,a.a.getHighResVideoThumbnail({provider:s.provider_name,thumbnail_url:t.thumbnail_url}).then(n.a.bind((function(e){t.thumbnail_url=e,this.$emit("loaded",n.a.extend(t,s))}),this))}),this),n.a.bind((function(t,e,i){this.$emit("error",t,e,i)}),this)),this.$emit("dataObtained",s)},isURL:function(t){return/^http(s?):\/\//i.test(t)},onYoutubeClick:function(){RM.views.searchYouTube&&RM.views.searchYouTube.show("",{choose:this.uploadVideoFromSearch})},onVimeoClick:function(){RM.views.searchVimeo&&RM.views.searchVimeo.show("",{choose:this.uploadVideoFromSearch})},uploadVideoFromSearch:function(t){this.getVideoFromUrl(t)}}},p=(i("oR3H"),Object(c.a)(u,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-panel-search"},[i("div",{staticClass:"video-panel-input-wrapper"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchUrl,expression:"searchUrl"}],class:{"video-panel-input":!0,"has-icon":t.showIcon},attrs:{type:"text",spellcheck:"false",placeholder:t.placeholder},domProps:{value:t.searchUrl},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnter(e)},input:function(e){e.target.composing||(t.searchUrl=e.target.value)}}}),t._v(" "),t.showIcon?i("div",{staticClass:"video-panel-icon input-icon",class:{"is-remove":t.isRemove,"is-upload":t.isUpload},on:{click:t.onIconClick}},[t.isUpload||t.isRemove?t._e():i("search-icon"),t._v(" "),t.isUpload?i("arrow-icon"):t._e(),t._v(" "),t.isRemove?i("x-mark-icon"):t._e()],1):t._e(),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.highlightInput?i("div",{staticClass:"video-panel-error"}):t._e()])],1),t._v(" "),i("transition",{attrs:{name:"fade"}},[t.showSocial?i("div",{staticClass:"video-panel-social"},[i("div",{staticClass:"video-panel-social-icon video-panel-social-youtube",attrs:{title:"Youtube"},on:{click:t.onYoutubeClick}},[i("youtube-logo")],1),t._v(" "),i("div",{staticClass:"video-panel-social-icon video-panel-social-vimeo",attrs:{title:"Vimeo"},on:{click:t.onVimeoClick}},[i("vimeo-logo")],1)]):t._e()])],1)}),[],!1,null,null,null));e.a=p.exports},vetb:function(module,exports){module.exports={"template-constructor-control-anchor_picker":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="anchor-picker-wrapper">\n\t\t<div class="anchor-picker">\n\t\t\t<div class="popup">\n\t\t\t\t<span>Click</span>\n\t\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p}}},voD7:function(module,exports){module.exports={"template-constructor-control-shape_icon":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Icon" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="panel">\n\t\t<div class="search-block">\n\t\t\t<input class="search" type="text" placeholder="Search">\n\t\t\t<div class="loupe">\n\t\t\t\t<div class="rmpreloader hidden"><div class="arc"></div></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="separator"></div>\n\n\t\t<div class="common-wrapper">\n\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t<div class="resizable-content">\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t</div>\n\n\t\t</div>\n\n\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\t</div>\n';return __p},"template-constructor-control-shape_icon-item":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon-item">\n\t\t<div class="noun-icon" style="background-image: url('+(null==(__t=icon.preview_url_42)?"":__t)+');" '+(null==(__t=icon.id?'data-id="'+icon.id+'"':'data-rm_id="'+icon.rm_id+'"')?"":__t)+' data-url="'+(null==(__t=icon.icon_url)?"":__t)+'">\n\t</div>\n';return __p}}},vqZt:function(t,e,i){},vvfI:function(t,e,i){"use strict";i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var n=i("fueH"),o="textIndent",a=function(t){var e=t.editorState,i=t.block,a=n.a.getBlockData({editorState:e,block:i,key:o});return"number"==typeof a?a:void 0},r=function(t){var e=t.editorState,i=t.value,a=t.block;return n.a.setBlockData({editorState:e,block:a,key:o,value:i})},s=function(t){var e=t.editorState,i=t.method,n=a({editorState:e})||0,o=e.getSelection().toJS(),s=o.focusOffset,l=0===o.anchorOffset&&0===s;return"increase"===i&&l?r({editorState:e,value:n+28}):"decrease"===i&&l&&n>0?r({editorState:e,value:Math.max(0,n+-28)}):void 0}},"w+s/":function(t,e,i){"use strict";i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return s})),i.d(e,"b",(function(){return l}));var n=i("fueH");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a="paddings",r=function(t){var e=t.editorState,i=t.block,r=n.a.getBlockData({editorState:e,block:i,key:a});return"object"===o(r)?r:void 0},s=function(t){var e=t.block,i=t.editorState,o=t.paddings;return n.a.setBlockData({editorState:i,block:e,key:a,value:o})},l=function(t){var e=t.blockPaddings,i=t.stylePaddings;return{left:!(!i||!e)&&Boolean(i.left&&e.left),top:!(!i||!e)&&Boolean(i.top&&e.top),bottom:!(!i||!e)&&Boolean(i.bottom&&e.bottom),right:!(!i||!e)&&Boolean(i.right&&e.right)}}},w4Sg:function(module,exports){module.exports={"template-constructor-block-gmaps":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <div class="rm-search-block">\n        <div class="map-container"></div>\n        <div class="map-overlay"></div>\n        <div class="message-overlay invisible"></div>\n    </div>\n    <div class="rm-gmaps-key hidden">\n        <div class="key-wrapper">\n            <div>\n                <div class="key-legend">To use Google Maps widget you need a Google Maps API key. Learn how to get an API key <a href="http://help.readymag.com/hc/en-us/articles/360020526932-Google-Maps" rel="noreferrer noopener" target="_blank">here</a>.</div>\n                <div class="key-input-wrap">\n                    <input type="text" class="key-input" placeholder="Paste Google Maps API Key here" required minlength="39" maxlength="39">\n                    <button>Apply</button>\n                </div>\n            </div>\n        </div>\n    </div>\n';return __p},"template-constructor-block-gmaps-search-control":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n    <div class="rm-search-block">\n        <input type="text" class="rm-search source">\n        <input type="text" class="rm-search destination">;\n    </div>\n';return __p}}},w5C2:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return r})),i.d(e,"d",(function(){return l})),i.d(e,"c",(function(){return c}));var n=i("sn3M");function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r,s={fontSize:18,lineHeight:26,fontFamily:"Roboto",fontWeight:400,fontStyle:"normal",fontWeights:["n1","i1","n3","i3","n4","i4","n5","i5","n7","i7","n9","i9"]};!function(t){t.Unstyled="unstyled"}(r||(r={}));var l=a({},r.Unstyled,{element:"p"}),c=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},Object(n.a)({selector:'[data-block="true"], .widget-text-v3 p:not([class]), .widget-text-v3 p[class=""]',label:"Unstyled",styles:"\n      // // Дефолтные стили текста\n      // font-family: ".concat(s.fontFamily,";\n      // font-weight: ").concat(s.fontWeight,";\n      // font-size: ").concat(s.fontSize,"px;\n      // line-height: ").concat(s.lineHeight,"px;\n\n      // // Сбрасываем, чтобы пользователь сам управлял кернингом (автокернинг)\n      // font-kerning: none;\n    ")}))},wAEK:function(module,exports){module.exports={"template-export-pdf-typekit-substitution-news-gothic":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n<style id="export-pdf-typekit-substitution">\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/News Gothic Bold Italic/c6f4e54e-1d69-4559-b813-e2fc4ff29160-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic Bold Italic/c6f4e54e-1d69-4559-b813-e2fc4ff29160-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/News Gothic Bold/9aab62b7-bc6f-405a-ad75-227bcf89d9dc-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic Bold/9aab62b7-bc6f-405a-ad75-227bcf89d9dc-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/News Gothic Italic/6327ba72-bfd5-4038-9658-e3a4a95a5c98-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic Italic/6327ba72-bfd5-4038-9658-e3a4a95a5c98-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 400;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/News Gothic/915b0ec4-cd16-40de-883e-1d77c3d07840-3.woff") format("woff"),\n\t\t url("/fonts/webtype/News Gothic/915b0ec4-cd16-40de-883e-1d77c3d07840-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 400;\n}\n</style>\n';return __p},"template-export-pdf-typekit-substitution-georgia-pro":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n<style id="export-pdf-typekit-substitution">\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro Black/4ec59c91-f66b-4751-8456-e114e9e14673-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Black/4ec59c91-f66b-4751-8456-e114e9e14673-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 900;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro Bold Italic/6f283590-c3c2-416a-95c2-ca67d04aa929-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Bold Italic/6f283590-c3c2-416a-95c2-ca67d04aa929-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro Bold/6f633c58-c751-4d08-9cea-2b27f74f37de-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Bold/6f633c58-c751-4d08-9cea-2b27f74f37de-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 700;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro Italic/e3bc0ad4-bdaa-4467-82a0-d90f697b7266-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro Italic/e3bc0ad4-bdaa-4467-82a0-d90f697b7266-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 400;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro SemiBold Italic/0e025df5-ba54-4bbb-84b4-c5b337a5b55b-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro SemiBold Italic/0e025df5-ba54-4bbb-84b4-c5b337a5b55b-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 600;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro SemiBold/60fe12ce-0223-4a9a-8e5c-b3e7bd381bc4-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro SemiBold/60fe12ce-0223-4a9a-8e5c-b3e7bd381bc4-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 600;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Georgia Pro/b97bef32-c0cb-4ad3-b724-1204d229731c-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Georgia Pro/b97bef32-c0cb-4ad3-b724-1204d229731c-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 400;\n}\n</style>\n';return __p},"template-export-pdf-typekit-substitution-nitti":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n<style id="export-pdf-typekit-substitution">\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Nitti Light Italic/15aba0ec-4ceb-49e2-985c-a95134a60aed-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Nitti Light Italic/15aba0ec-4ceb-49e2-985c-a95134a60aed-4.svg#web") format("svg");\n\tfont-style: italic;\n\tfont-weight: 300;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Nitti Light/6fd7c5e9-3131-4cb6-a99e-da74343b1253-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Nitti Light/6fd7c5e9-3131-4cb6-a99e-da74343b1253-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 300;\n}\n@font-face {\n\tfont-family: "'+(null==(__t=id)?"":__t)+'";\n\tsrc: url("/fonts/webtype/Nitti Medium/9054f262-2d2d-480f-9360-4560f110243b-3.woff") format("woff"),\n\t\t url("/fonts/webtype/Nitti Medium/9054f262-2d2d-480f-9360-4560f110243b-4.svg#web") format("svg");\n\tfont-style: normal;\n\tfont-weight: 500;\n}\n</style>\n';return __p}}},wHgl:function(module,exports){module.exports={"template-constructor-helpers-animation_steps_add_button":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="add-button skip-rotate" title="Add Step">\n\t\t<div class="rhomb"></div>\n\n\t\t<div class="effect-popup js-steps-popup">\n\t\t\t<div class="effect-popup-caption">Add Step</div>\n\t\t\t<div class="effect-popup-item" data-value="use_move">Move</div>\n\t\t\t<div class="effect-popup-item" data-value="use_opacity">Opacity</div>\n\t\t\t<div class="effect-popup-item" data-value="use_rotate">Rotate</div>\n\t\t\t<div class="effect-popup-item" data-value="use_scale">Scale</div>\n\t\t\t<div class="corner-wrapper"><div class="corner"></div></div>\n\t\t</div>\n\t</div>\n\n';return __p}}},wrlV:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return a}));var n=function(t){if(t){return{"image/jpeg":"jpg","image/png":"png","image/bmp":"bmp","image/gif":"gif","image/svg+xml":"svg"}[t.toLowerCase()]}},o=function(t){return new Promise((function(e,i){var n=new Image;n.onload=function(){n.width&&n.height||i("Unable to get image dimensions");var t={width:n.width,height:n.height};n.remove(),e(t)},n.onerror=function(t){return i(t)},n.src=t}))},a=function(t){return new Promise((function(e,i){(function(t){return t?new Promise((function(e,i){try{var n=new FileReader;n.onloadend=function(){return e(n.result)},n.onerror=function(t){return i(t)},n.readAsDataURL(t)}catch(t){i(t)}})):Promise.reject("No file data")})(t).then((function(a){o(a).then((function(i){var o={width:i.width,height:i.height,type:t.type,size:t.size,ext:n(t.type),content:a};e(o)})).catch((function(t){return i(t)}))}))}))}},wxrA:function(module,exports){module.exports={"template-constructor-block-facebook-type_like_button":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="fb-like fb" data-href="'+(null==(__t=data.url?data.url:"http://readymag.com")?"":_.escape(__t))+'" '+(null==(__t=data.share_button||data.send_button?'data-share="true"':"")?"":__t)+' data-width="'+(null==(__t=data.w)?"":__t)+'" data-show-faces="'+(null==(__t=data.show_faces)?"":__t)+'" data-colorscheme="'+(null==(__t=data.theme)?"":__t)+'" data-layout="'+(null==(__t=data.layout)?"":__t)+'" data-type="data.type_like_button"></div>\n\t<div class="overlay"></div>\n';return __p},"template-constructor-block-facebook-type_page":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="fb-page fb" data-href="'+(null==(__t=data.url?data.url:"https://www.facebook.com/readymag")?"":_.escape(__t))+'" data-width="'+(null==(__t=data.w)?"":__t)+'" data-height="'+(null==(__t=data.h)?"":__t)+'" data-show-facepile="'+(null==(__t=data.show_faces)?"":__t)+'" data-colorscheme="'+(null==(__t=data.theme)?"":__t)+'" data-tabs="'+(null==(__t=data.show_stream?"timeline, events, messages":"")?"":__t)+'" data-show-border="true" data-small-header="'+(null==(__t=data.small_header)?"":__t)+'" data-adapt-container-width="true"></div>\n\t<div class="overlay"></div>\n';return __p},"template-constructor-block-facebook-type_comments":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="fb-comments fb" data-href="'+(null==(__t=data.url?data.url:"http://readymag.com")?"":_.escape(__t))+'" data-width="'+(null==(__t=data.w)?"":__t)+'" data-num-posts="'+(null==(__t=data.num_posts)?"":__t)+'" data-colorscheme="'+(null==(__t=data.theme)?"":__t)+'"></div>\n\t<div class="overlay"></div>\n';return __p}}},"x/B7":function(module,exports){module.exports={"template-constructor-help-tour":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="tour-bg">\n\t\t<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n\t\t\t<mask id="help-tour-bg-clip">\n\t\t\t\t<rect x="0" y="0" width="100%" height="100%" stroke="none" fill="white"></rect>\n\t\t\t\t<ellipse id="help-tour-bg-clip-ellipse-another" cx="0" cy="0" rx="40" ry="40" stroke="none" fill="white" ></ellipse>\n\t\t\t\t<ellipse id="help-tour-bg-clip-ellipse-main" cx="0" cy="0" rx="40" ry="40" stroke="none" fill="white" ></ellipse>\n\t\t\t</mask>\n\t\t\t<rect id="help-tour-bg" x="0" y="0" width="100%" height="100%" fill="rgba(0,0,0,0.6)" stroke="none" mask="url(#help-tour-bg-clip)"></rect>\n\t\t</svg>\n\t</div>\n\n\t<div class="cursor"></div>\n';return __p},"template-constructor-help-tour-welcome":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="tour-welcome">\n\t\t<div class="header">Welcome to R/m</div>\n\t\t<div class="message">Get on board with a helpful 15-step tour!</div>\n\t\t<div class="selector-wrapper">\n\t\t\t<div class="left">\n\t\t\t\t<div class="pic"></div>\n\t\t\t\t<div class="caption">Take a<br/>15-step tour</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="close"></div>\n\t</div>\n';return __p},"template-constructor-help-tour-step":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="tour-step">\n\t\t<div class="caption">'+(null==(__t=caption)?"":_.escape(__t))+'</div>\n\t\t<div class="text">'+(null==(__t=text)?"":__t)+'</div>\n\t\t<div class="bottom">\n\t\t\t<div class="back">Back</div>\n\t\t\t<div class="steps">'+(null==(__t=curStep)?"":_.escape(__t))+" of "+(null==(__t=totalStep)?"":_.escape(__t))+'</div>\n\t\t\t<div class="next">'+(null==(__t=curStep==totalStep?"End tour":"Next")?"":_.escape(__t))+'</div>\n\t\t</div>\n\t\t<div class="close"></div>\n\t\t',"none"!=corner&&(__p+='\n\t\t\t<div class="corner tp-'+(null==(__t=corner)?"":_.escape(__t))+'"></div>\n\t\t'),__p+="\n\t</div>\n";return __p}}},xka6:function(module,exports){module.exports={"template-constructor-control-form_content":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="icon noarrow" data-alt="Fields" data-alt-pos="left" data-alt-offset="9"></div>\n\n\t<div class="form-fields-panel panel js-panel">\n\t\t<div class="form-fields-header">Fields</div>\n\n\t\t<div class="form-fields-wrapper">\n\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t<div class="resizable-content js-fields-container"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t</div>\n\t\t\t<div class="js-settings-popup-container"></div>\n\t\t</div>\n\n\t\t<div class="form-fields-footer js-add-block">\n\t\t\t<div class="js-new-settings-container"></div>\n\t\t\t<div class="form-fields-add js-add" title="Add field"></div>\n\t\t</div>\n\n\t\t<div class="js-dropdown-panel-container"></div>\n\n\t\t<div class="resize-handle-top"></div>\n\t\t<div class="resize-handle-bottom"></div>\n\t</div>\n';return __p},"template-constructor-control-form_content-field":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="form-fields-item js-field form-fields-item-'+(null==(__t=tp)?"":__t)+" "+(null==(__t=isSortable?"js-sortable":"js-not-sortable")?"":__t)+'"\n\t     data-id="'+(null==(__t=id)?"":__t)+'" data-type="'+(null==(__t=tp)?"":__t)+'">\n\t\t',"dropdown"===tp?__p+='\n\t\t\t<div class="form-fields-caption-dropdown-helper">\n\t\t\t\t<div class="form-fields-caption-dropdown-mask js-dropdown-trigger"></div>\n\t\t\t\t<input type="text" name="" value="'+(null==(__t=text)?"":__t)+'" placeholder="'+(null==(__t=placeholder)?"":__t)+'" autocomplete="off" readonly="readonly"\n\t\t\t\t       class="form-fields-caption form-fields-caption-'+(null==(__t=tp)?"":__t)+" js-field-caption js-field-caption-"+(null==(__t=tp)?"":__t)+'"/>\n\t\t\t</div>\n\t\t':"captcha"===tp?__p+='\n\t\t\t<span class="form-invisible-mark">Invisible</span>\n\t\t':__p+='\n\t\t\t<input type="text" name="" value="'+(null==(__t=text)?"":__t)+'" placeholder="'+(null==(__t=placeholder)?"":__t)+'" autocomplete="off"\n\t\t\t\t       class="form-fields-caption form-fields-caption-'+(null==(__t=tp)?"":__t)+" "+(null==(__t=mode)?"":__t)+" js-field-caption js-field-caption-"+(null==(__t=tp)?"":__t)+'"/>\n\t\t',__p+="\n\t\t",showSettings&&(__p+='\n\t\t\t<div class="form-fields-type-token js-settings-trigger">'+(null==(__t=typeLetter)?"":__t)+"</div>\n\t\t"),__p+="\n\t\t",showDelete&&(__p+='\n\t\t\t<div class="form-fields-delete js-delete-field"></div>\n\t\t'),__p+="\n\t\t",showSubmitAfterArrow&&(__p+='\n\t\t\t<div class="form-fields-placeholder-selector '+(null==(__t=showRemoveArrow?"action-icon remove-icon":"js-submit-dropdown-trigger")?"":__t)+'">\n\t\t\t\t<div class="form-fields-placeholder-arrow"></div>\n\t\t\t</div>\n\t\t'),__p+="\n\t</div>\n";return __p},"template-constructor-control-form_content-settings":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="settings-popup transition-enable js-settings-popup '+(null==(__t=edit?"settings-popup-edit js-edit-settings":"settings-popup-add js-add-settings")?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'">\n\t\t<div class="settings-popup-types">\n\t\t\t',_.each(types,(function(t,e){__p+='\n\t\t\t\t<div class="settings-popup-type js-field-type'+(null==(__t=e===selectedType?" selected":"")?"":__t)+(null==(__t=e!==selectedType&&disabledTypes&&disabledTypes.length&&disabledTypes.includes(e)?" disabled":"")?"":__t)+'" data-value="'+(null==(__t=e)?"":__t)+'" data-action="'+(null==(__t=edit?"edit":"add")?"":__t)+'">\n\t\t\t\t\t'+(null==(__t=t)?"":__t)+"\n\t\t\t\t</div>\n\t\t\t"})),__p+="\n\t\t</div>\n\t\t",showOptionalSwitcher&&(__p+='\n\t\t\t<div class="settings-popup-optional">\n\t\t\t\t<div class="switcher-wrapper settings-popup-optional-switcher">\n\t\t\t\t\t<div class="switcher-caption settings-popup-optional-caption">Optional Field</div>\n\t\t\t\t\t<div class="switcher settings-popup-optional-value" data-type="optional"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'),__p+='\n\t\t<div class="corner-wrapper">\n\t\t\t<div class="corner"></div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-form_content-after-submit":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="submit-wrapper settings-popup js-settings-popup">\n\t\t<div class="settings-popup-types">\n\t\t\t',_.each(types,(function(t,e){__p+='\n\t\t\t\t<div class="settings-popup-type js-submit-field-type '+(null==(__t=e===selectedType?"selected":"")?"":__t)+'" data-value="'+(null==(__t=e)?"":__t)+'" >\n\t\t\t\t\t'+(null==(__t=t)?"":__t)+"\n\t\t\t\t</div>\n\t\t\t"})),__p+='\n\t\t</div>\n\n\t\t<div class="resizable-scroll-wrapper">\n\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t<div class="resizable-content">\n\t\t\t\t\t<div class="styles-wrapper"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="resizable-scroll"></div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-form_content-dropdown":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="dropdown-panel js-dropdown-panel">\n\t\t<div class="dropdown-content">\n\t\t\t<div class="dropdown-header form-fields-header js-dropdown-caption-container"></div>\n\n\t\t\t<div class="dropdown-wrapper">\n\t\t\t\t<div class="resizable-scroll-wrapper">\n\t\t\t\t\t<div class="resizable-content-wrapper">\n\t\t\t\t\t\t<div class="resizable-content js-dropdown-content">\n\t\t\t\t\t\t\t<div class="dropdown-options js-dropdown-options-container"></div>\n\t\t\t\t\t\t\t<div class="dropdown-add dropdown-option form-fields-item js-add-option">+ Add</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="resizable-scroll"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="dropdown-footer form-fields-footer">\n\t\t\t\t<div class="dropdown-save js-save-dropdown">Save</div>\n\t\t\t\t<div class="dropdown-cancel js-cancel-dropdown"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p},"template-constructor-control-form_content-dropdown-caption":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<input type="text" name="" value="'+(null==(__t=text)?"":__t)+'" placeholder="'+(null==(__t=placeholder)?"":__t)+'" autocomplete="off"\n\t\t\t\t\t\t       class="dropdown-caption-value form-fields-caption js-dropdown-caption"/>\n';return __p},"template-constructor-control-form_content-dropdown-option":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="form-fields-item dropdown-option js-dropdown-option js-sortable" data-value="'+(null==(__t=text)?"":__t)+'" data-number="'+(null==(__t=number)?"":__t)+'">\n\t\t<input type="text" name="" value="'+(null==(__t=text)?"":__t)+'" placeholder="'+(null==(__t=placeholder)?"":__t)+'" autocomplete="off" data-number="'+(null==(__t=number)?"":__t)+'"\n\t\t       class="dropdown-option-value form-fields-caption js-dropdown-option-value"/>\n\t\t<div class="dropdown-number form-fields-type-token">'+(null==(__t=number)?"":__t)+"</div>\n\t\t",showDelete&&(__p+='\n\t\t\t<div class="dropdown-option-delete form-fields-delete js-delete-option"></div>\n\t\t'),__p+="\n\t</div>\n";return __p}}},yWjQ:function(module,exports){module.exports={"template-common-slideshow-player":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\t<div class="common-slideshow environment-'+(null==(__t=tp)?"":_.escape(__t))+'">\n\t\t<div class="images no-rmswipe">\n\t\t\t<div class="images-wrapper">\n\t\t\t</div>\n\t\t\t<div class="fullscreen">\n\t\t\t\t<svg class="fullscreen-off" width="17px" height="17px" viewBox="0 0 17 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t\t\t<g id="Page-1" stroke="none" stroke-width="0.1" fill="none" fill-rule="evenodd">\n\t\t\t\t\t\t<g id="full-screen" transform="translate(-12.000000, -12.000000)" fill="#F4F4F4" fill-rule="nonzero">\n\t\t\t\t\t\t\t<g id="Arrows" transform="translate(12.000000, 12.000000)">\n\t\t\t\t\t\t\t\t<path d="M12.7571068,4.74264069 L10.2571068,7.24264069 C9.86658249,7.63316498 9.23341751,7.63316498 8.84289322,7.24264069 C8.45236893,6.8521164 8.45236893,6.21895142 8.84289322,5.82842712 L11.3428932,3.32842712 L9.72157288,1.70710678 C9.33104858,1.31658249 9.33104858,0.683417511 9.72157288,0.292893219 C9.90910925,0.10535684 10.1634632,-2.93098879e-14 10.4286797,-2.93098879e-14 L15.0144661,-2.93098879e-14 C15.5667508,-2.93098879e-14 16.0144661,0.44771525 16.0144661,1 L16.0144661,5.58578644 C16.0144661,6.13807119 15.5667508,6.58578644 15.0144661,6.58578644 C14.7492496,6.58578644 14.4948957,6.4804296 14.3073593,6.29289322 L12.7571068,4.74264069 Z" id="Combined-Shape"></path>\n\t\t\t\t\t\t\t\t<path d="M4.20710669,13.2426408 L1.70710669,15.7426408 C1.3165824,16.1331651 0.683417421,16.1331651 0.292893129,15.7426408 C-0.097631163,15.3521165 -0.097631163,14.7189515 0.292893129,14.3284272 L2.79289313,11.8284272 L1.17157279,10.2071069 C0.781048494,9.81658256 0.781048494,9.18341758 1.17157279,8.79289329 C1.35910916,8.60535691 1.61346308,8.50000007 1.87867957,8.50000007 L6.464466,8.50000007 C7.01675075,8.50000007 7.464466,8.94771532 7.464466,9.50000007 L7.464466,14.0857865 C7.464466,14.6380713 7.01675075,15.0857865 6.464466,15.0857865 C6.19924951,15.0857865 5.9448956,14.9804297 5.75735922,14.7928933 L4.20710669,13.2426408 Z" id="Combined-Shape" transform="translate(3.732233, 12.267767) rotate(180.000000) translate(-3.732233, -12.267767) "></path>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t\t<svg class="fullscreen-on" width="18px" height="18px" viewBox="0 0 18 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\t\t\t\t\t<g id="Page-1" stroke="none" stroke-width="0.1" fill="none" fill-rule="evenodd">\n\t\t\t\t\t\t<g id="full-screen" transform="translate(-11.000000, -11.000000)" fill="#F4F4F4" fill-rule="nonzero">\n\t\t\t\t\t\t\t<g id="Arrows" transform="translate(11.000000, 11.000000)">\n\t\t\t\t\t\t\t\t<path d="M14.2071067,5.24264078 L11.7071067,7.74264078 C11.3165824,8.13316507 10.6834174,8.13316507 10.2928931,7.74264078 C9.90236883,7.35211649 9.90236883,6.71895151 10.2928931,6.32842721 L12.7928931,3.82842721 L11.1715728,2.20710687 C10.7810485,1.81658258 10.7810485,1.1834176 11.1715728,0.792893312 C11.3591092,0.605356933 11.6134631,0.500000093 11.8786796,0.500000093 L16.464466,0.500000093 C17.0167507,0.500000093 17.464466,0.947715343 17.464466,1.50000009 L17.464466,6.08578653 C17.464466,6.63807128 17.0167507,7.08578653 16.464466,7.08578653 C16.1992495,7.08578653 15.9448956,6.98042969 15.7573592,6.79289331 L14.2071067,5.24264078 Z" id="Combined-Shape" transform="translate(13.732233, 4.267767) rotate(180.000000) translate(-13.732233, -4.267767) "></path>\n\t\t\t\t\t\t\t\t<path d="M4.70710678,14.7426407 L2.20710678,17.2426407 C1.81658249,17.633165 1.18341751,17.633165 0.792893219,17.2426407 C0.402368927,16.8521164 0.402368927,16.2189514 0.792893219,15.8284271 L3.29289322,13.3284271 L1.67157288,11.7071068 C1.28104858,11.3165825 1.28104858,10.6834175 1.67157288,10.2928932 C1.85910925,10.1053568 2.11346317,10 2.37867966,10 L6.96446609,10 C7.51675084,10 7.96446609,10.4477153 7.96446609,11 L7.96446609,15.5857864 C7.96446609,16.1380712 7.51675084,16.5857864 6.96446609,16.5857864 C6.6992496,16.5857864 6.44489569,16.4804296 6.25735931,16.2928932 L4.70710678,14.7426407 Z" id="Combined-Shape"></path>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t</g>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\t\t\t<div class="bottom-arrows">\n\t\t\t\t\t<div class="prev-picture-arrow-bottom arrow-bottom">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40">\n\t\t\t\t\t\t\t<path d="M23.5 11.5 L15.5 19.5 L23.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="counters-container">\n\t\t\t\t\t\t<div class="counters-numbers">\n\t\t\t\t\t\t\t<span class="counters-text-current">1</span>/<span class="counters-text-total">2</span>\n\t\t\t\t\t\t</div>\n\t\t\n\t\t\t\t\t\t<div class="counters-dots no-rmswipe">\n\t\t\t\t\t\t\t<div class="scroll-wrapper">\n\t\t\t\t\t\t\t\t<div class="items-wrapper has-horizontal-scroll">\n\t\t\t\t\t\t\t\t\t<div class="items">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="scroll"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="next-picture-arrow-bottom arrow-bottom">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40">\n\t\t\t\t\t\t\t<path d="M16.5 11.5 L24.5 19.5 L16.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="cursor"></div>\n\n\t\t\t<div class="prev-picture-arrow-middle arrow-middle">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40">\n\t\t\t\t\t<path d="M23.5 11.5 L15.5 19.5 L23.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path>\n\t\t\t\t</svg>\n\t\t\t</div>\n\n\n\t\t\t<div class="next-picture-arrow-middle arrow-middle">\n\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="40" height="40">\n\t\t\t\t\t<path d="M16.5 11.5 L24.5 19.5 L16.5 27.5" stroke-linejoin="round" stroke-linecap="round" style="fill:none; stroke:#ffffff; stroke-width:3px"></path>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="thumbnails no-rmswipe">\n\t\t\t<div class="scroll-wrapper">\n\t\t\t\t<div class="items-wrapper has-horizontal-scroll">\n\t\t\t\t\t<div class="items">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="scroll"></div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="captions">\n\t\t\t',"constructor"==tp&&(__p+='\n\t\t\t\t<textarea class="caption" maxlength="9999" placeholder="Type image caption here"></textarea>\n\t\t\t'),__p+="\n\t\t</div>\n\t</div>\n\n";return __p}}},yjKB:function(module,exports){module.exports={"template-constructor-pages-panel-settings-info":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n\t<div class="caption caption-title">Title</div>\n\t\x3c!--__magterm--\x3e\n\t<textarea class="textarea title" data-param="title" placeholder="Project Title" maxlength="128">'+(null==(__t=mag.title)?"":_.escape(__t))+'</textarea>\n\n\t<div class="caption caption-description">Description</div>\n\t<div class="description-wrapper">\n\t\t\x3c!--__magterm--\x3e\n\t\t<textarea class="textarea description" data-param="description" maxlength="2048" placeholder="Write a few words about this project.">'+(null==(__t=mag.description)?"":_.escape(__t))+'</textarea>\n\t\t<div class="description-scroll"></div>\n\t</div>\n\n\t<div class="caption caption-link">Link</div>\n\t<div class="link-wrapper">\n\t\t<span class="link-prefix">'+(null==(__t=mag.user&&mag.user.domain||Constants.readymag_host.split("//")[1])?"":_.escape(__t))+'</span>\n\t\t<span class="link-postfix">/</span>\n\t\t',mag.user&&mag.user.domain||(__p+='\n\t\t\t<span class="link-user">'+(null==(__t=mag.user&&mag.user.uri||"demo")?"":_.escape(__t))+'</span>\n\t\t\t<span class="link-postfix">/</span>\n\t\t'),__p+='\n\t\t<input class="input link" data-param="uri" placeholder="'+(null==(__t=mag.num_id)?"":_.escape(__t))+'" spellcheck="false" value="'+(null==(__t=mag.uri)?"":_.escape(__t))+'"/>\n\t\t<div class="link-status">\n\t\t\t<div class="context-panel link-status-panel">\n\t\t\t\t<div class="link-status-text selectable"></div>\n\t\t\t\t<div class="context-panel-corner"><div class="corner"></div></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="code-injection-wrapper">\n\t\t<div class="button-edit-code '+(null==(__t=hasProjectCode?"active":"")?"":_.escape(__t))+'">&lt;/&gt; Code Injection</div>\n\t\t<a href="http://help.readymag.com/hc/en-us/articles/360020844171-Code-injection" class="code-injection-learn-more" target="_blank">Learn More</a>\n\t</div>\n\n';return __p}}},z79a:function(t,e,i){"use strict";var n=i("xi34");window.iconSVGCache=[];var o=function(){};o.prototype={MAX_ICON_CACHE_SIZE:30,generateShapeSVG:function(t,e,i,o,a){var r,s=e.get("bg_color")||e.viewport_default&&e.viewport_default.bg_color,l=this.getRGBA(s||"ffffff",e.get("bg_opacity")),c=this.getRGBA(e.get("color"),e.get("opacity"));if("ellipse"==(a="hotspot"===e.get("type")?a||e.get("pin_type"):a||e.get("tp"))){var d=i/2,h=o/2,u=e.get("borders");r=O("ellipse",{cx:d,cy:h,rx:d,ry:h},l,c,u=Math.min(u,d,h),e.id+"_"+t,e.get("opacity"))}if("rectangle"==a||"polygon"==a){"hotspot"===e.get("type")&&(c=l="rgba(0, 0, 0, 0)");var p,m="rectangle"==a?4:e.get("sides"),g=(u=e.get("borders"),e.get("radius")||0),f=e.get("radius_rect_independent"),v={tlRadius:e.get("radius_rect_tl")||0,trRadius:e.get("radius_rect_tr")||0,blRadius:e.get("radius_rect_bl")||0,brRadius:e.get("radius_rect_br")||0},b=function(t,e,i,n){for(var o,a,r,s=2*Math.PI/t,l=Math.PI/2-(t%2==1?0:s/2),c=[],d=999999,h=-999999,u=999999,p=-999999,m=0;m<t;m++)o=l+m*s,a=.5+.5*Math.cos(o),r=.5-.5*Math.sin(o),c.push({x:a,y:r}),a<d&&(d=a),a>h&&(h=a),r<u&&(u=r),r>p&&(p=r);for(m=0;m<t;m++)c[m].x=(c[m].x-d)*(e/(h-d)),c[m].y=(c[m].y-u)*(i/(p-u)),c[m].x=Math.round(1e5*c[m].x)/1e5,c[m].y=Math.round(1e5*c[m].y)/1e5;return c}(m,i,o),y=function(t){if(!t)return 99999;for(var e,i=99999,n=t.length,o=0;o<n;o++){var a=t[o].x-t[(o+1)%n].x,r=t[o].y-t[(o+1)%n].y;(e=Math.sqrt(a*a+r*r))<i&&(i=e),t[o].side=e}return i}(b);r=O("path",{path:"rectangle"===a&&f?function(t,e){var i=t.tlRadius,n=t.trRadius,o=t.brRadius,a=t.blRadius,r=e.trTop,s=e.tlTop,l=e.tlLeft,c=e.blLeft,d=e.blBottom,h=e.brBottom,u=e.brRight,p=e.trRight;return"M ".concat(r.x," 0\n        L ").concat(s.x," ").concat(s.y,"\n        A ").concat(i," ").concat(i," 0 0 0 ").concat(l.x," ").concat(l.y,"\n        L ").concat(c.x," ").concat(c.y,"\n        A ").concat(a," ").concat(a," 0 0 0 ").concat(d.x," ").concat(d.y,"\n        L ").concat(h.x," ").concat(h.y,"\n        A ").concat(o," ").concat(o," 0 0 0 ").concat(u.x," ").concat(u.y,"\n        L ").concat(p.x," ").concat(p.y,"\n        A ").concat(n," ").concat(n," 0 0 0 ").concat(r.x," ").concat(r.y,"\n        Z")}(v,p=function(t,e,i){var n=e.trRadius,o=e.tlRadius,a=e.blRadius,r=e.brRadius;return n=Math.min(n,i/2),o=Math.min(o,i/2),a=Math.min(a,i/2),r=Math.min(r,i/2),{trTop:{x:t[0].x-n,y:t[0].y},tlTop:{x:t[1].x+o,y:t[1].y},tlLeft:{x:t[1].x,y:t[1].y+o},blLeft:{x:t[2].x,y:t[2].y-a},blBottom:{x:t[2].x+a,y:t[2].y},brBottom:{x:t[3].x-r,y:t[3].y},brRight:{x:t[3].x,y:t[3].y-r},trRight:{x:t[0].x,y:t[0].y+n}}}(b,v,y)):function(t,e,i){if(!t)return"";for(var n=t.length,o="",a=0;a<n;a++){var r=2*a+1,s=(2*a+2)%(2*n);if(o+=0==a?"M":"L",e){o+=e[r].x+" "+e[r].y+" ";var l=e[r].x-e[s].x,c=e[r].y-e[s].y,d=1/((l*l+c*c)/4)-1/(i*i),h=Math.sqrt(1/d);o+="A"+h+" "+h+" 0 0 0 "+e[s].x+" "+e[s].y+" "}else o+=t[a].x+" "+t[a].y+" "}return o+" Z "}(b,(p=function(t,e,i){if(!t)return{};if(e<=1e-4)return{};var n=[],o=t.length;e=Math.min(e,i/2);for(var a=0;a<o;a++){var r,s,l,c,d=t[a],h=t[(a+1)%o],u=t[a].side,p=(h.x-d.x)/u,m=(h.y-d.y)/u;r=d.x+p*e,s=d.y+m*e,l=h.x-p*e,c=h.y-m*e,r=Math.round(1e5*r)/1e5,s=Math.round(1e5*s)/1e5,l=Math.round(1e5*l)/1e5,c=Math.round(1e5*c)/1e5,n.push({x:r,y:s}),n.push({x:l,y:c})}return{points:n,radius:e}}(b,g,y)).points,p.radius)},l,c,u,e.id+"_"+t,e.get("opacity"))}if("line"==a){u=e.get("weight")-.5,h=Math.round(o/2)+(u%2==1?.5:0);var _,w=[13*u/3,2*u/3].join(" "),k=u>1?[.001,5*u/3].join(" "):[1,2].join(" "),S="dotted"==e.get("stroke")?u/2:0;if(_="M"+S+" "+h+" L"+i+" "+h,"solid"==e.get("stroke")&&(r='<path d="'+_+'" style="fill:none; stroke:'+l+";stroke-width:"+u+'"/>'),"double"==e.get("stroke"))r='<path d="'+("M"+S+" "+(h-u)+" L"+i+" "+(h-u))+'" style="fill:none; stroke:'+l+";stroke-width:"+u+'"/>',r+='<path d="'+("M"+S+" "+(h+u)+" L"+i+" "+(h+u))+'" style="fill:none; stroke:'+l+";stroke-width:"+u+'"/>';"dotted"==e.get("stroke")&&(r='<path d="'+_+'" stroke-linecap="round" stroke-dasharray="'+k+'" style=" fill:none; stroke:'+l+";stroke-width:"+u+'"/>'),"dashed"==e.get("stroke")&&(r='<path d="'+_+'" stroke-dasharray="'+w+'" style=" fill:none; stroke:'+l+";stroke-width:"+u+'"/>')}if("icon"==a){var x=this.iconData||this.current_icon_data;if(!x)return null;var C=x.$svg.clone();return C.css({width:"100%",height:"100%"}),l=this.getRGBA(s,1),C.find("*:not(.fixed-color)").each((function(){var t=Object(n.a)(this);t.css({fill:"","fill-opacity":""}),t.get(0).removeAttribute("fill"),t.get(0).removeAttribute("fill-opacity")})),C.get(0).setAttribute("fill",l),C.get(0).setAttribute("fill-opacity",e.get("bg_opacity")),C}return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+i+'px" height="'+o+'px">'+r+"</svg>";function O(t,e,i,n,o,a,r){var s="mask_"+a,l="clip_"+a,c="",d=2;return o>0&&r>.99&&(d=1),c="<defs>",o>0&&(c+='<mask id="'+s+'">',"path"==t&&(c+='<path d="'+e.path+'" style="fill:white; stroke:black; stroke-width:'+o*d+'"/>'),"ellipse"==t&&(c+='<ellipse cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'" style="fill:white; stroke:black; stroke-width:'+o*d+'"/>'),c+="</mask>"),c+='<clippath id="'+l+'">',"path"==t&&(c+='<path d="'+e.path+'"/>'),"ellipse"==t&&(c+='<ellipse cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'"/>'),c+="</clippath>",c+="</defs>","path"==t&&(c+='<path mask="url(#'+s+')" d="'+e.path+'" style="fill:'+i+'; stroke:none; stroke-width:0; pointer-events: visiblePainted;"/>'),"ellipse"==t&&(c+='<ellipse mask="url(#'+s+')" cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'" style="fill:'+i+'; stroke:none; stroke-width:0; pointer-events: visiblePainted;"/>'),0==o||("path"==t&&(c+='<path clip-path="url(#'+l+')" d="'+e.path+'" style="fill:none; stroke:'+n+"; stroke-width:"+2*o+'; pointer-events: visiblePainted;"/>'),"ellipse"==t&&(c+='<ellipse clip-path="url(#'+l+')" cx="'+e.cx+'" cy="'+e.cy+'" rx="'+e.rx+'" ry="'+e.ry+'" style="fill:none; stroke:'+n+"; stroke-width:"+2*o+'; pointer-events: visiblePainted;"/>')),c}},getRGBA:function(t,e){if(0==e)return"none";var i=[parseInt(t.substring(0,2),16),parseInt(t.substring(2,4),16),parseInt(t.substring(4,6),16)];return e>.99?"rgb("+i[0]+","+i[1]+","+i[2]+")":"rgba("+i[0]+","+i[1]+","+i[2]+", "+e+")"}},e.a=o},zMlX:function(t,e,i){"use strict";var n,o;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return r})),function(t){t.Smallcaps="smcp",t.StandardLigatures="liga",t.DiscretionaryLigatures="dlig",t.RequiredLigatures="rlig",t.HistoricalLigatures="hlig",t.Fractions="frac",t.Alternates="salt",t.StylisticSet01="ss01",t.StylisticSet02="ss02",t.StylisticSet03="ss03",t.StylisticSet04="ss04",t.StylisticSet05="ss05",t.StylisticSet06="ss06",t.StylisticSet07="ss07",t.StylisticSet08="ss08",t.StylisticSet09="ss09",t.StylisticSet10="ss10",t.StylisticSet11="ss11",t.StylisticSet12="ss12",t.StylisticSet13="ss13",t.StylisticSet14="ss14",t.StylisticSet15="ss15",t.StylisticSet16="ss16",t.StylisticSet17="ss17",t.StylisticSet18="ss18",t.StylisticSet19="ss19",t.StylisticSet20="ss20",t.LiningFigures="lnum",t.OldstyleFigures="onum",t.ProportionalFigures="pnum",t.TabularFigures="tnum"}(o||(o={}));var r=(a(n={},o.LiningFigures,"Lining Figures"),a(n,o.OldstyleFigures,"Oldstyle Figures"),a(n,o.ProportionalFigures,"Proportional Figures"),a(n,o.TabularFigures,"Tabular Figures"),n)},zWgA:function(t,e){var i={instagram:[/^\s*<blockquote\s+class=.instagram-media.*<\/blockquote>\s*<script.*src=.*instagram.+>.*<\/script>\s*$/gi],pinterest:[/^\s*<a.*data-pin-do=.*<\/a>([\s\S]*<script.*src=.*pinterest.+>.*<\/script>)?\s*$/i],facebookvideo:[/^\s*<div\s+id=.fb-root.*<\/div>[\s\S]*<script>.*src.*facebook.*sdk.*<\/script>[\s\S]*<div\s+class=.fb-video.*<\/div>\s*$/i],readymag:[/^\s*<a\s+class=.rm-mag-embed.*<\/a>[\s\S]*<script.+id=.readymag-embed-init.+><\/script>\s*$/i],ecommerce:[/^\s*<form\s+action=.*method=.*POST.+>[\s\S]*<script.*src=.*stripe.+>.*<\/script>[\s\S]*<\/form>\s*$/gim,/^\s*(<!--.*-->)?[\s\S]*<script.*src=.*stripe.+>[\s\S]*<\/script>[\s\S]*(<!--.*-->)?[\s\S]*<button .*>.*<\/button>[\s\S]*<div .*>.*<\/div>[\s\S]*<script>.*stripe.*<\/script>\s*$/gim,/^\s*<div\s+id=.+>[\s\S]*<\/div>[\s\S]*<script[\s\S]*scriptUrl[\s\S]*shopifycdn[\s\S]*>*<\/script>.*$/gim,/^\s*<script\s+src=.*gumroad.+><\/script>[\s\S]*<div\s+class=.gumroad-product-embed.+>[\s\S]*<\/div>\s*$/gim,/^\s*<script\s+src=.*gumroad.+><\/script>[\s\S]*<a\s+class=.gumroad-button.+>[\s\S]*<\/a>\s*$/gim,/^\s*<div\s+class=.*ecwid.+><\/div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*xProduct.*<\/script>\s*$/gim,/^\s*<div\s+class=.*ecsp.+><\/div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*xProduct.*<\/script>\s*$/gim,/^\s*<div\s+class=.*ec-cart-widget.+><\/div>[\s\S]*<div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*Ecwid.*<\/script>[\s\S]*<\/div>\s*$/gim,/^\s*<div\s+id=.*.+><\/div>[\s\S]*<script.+ecwid.+>.*<\/script>[\s\S]*<script.*>.*xProduct.*<\/script>[\s\S]*<\/div>\s*$/gim],gdpr:[/^\s*<a\s+href="https:\/\/www\.iubenda\.com\/privacy-policy\/\d+"[\w\d\s/:;.,'"=-]*>[\w\d\s/:;.,'"=-]*<\/a>\s*<script[\w\d\s/:;.,'"=-]*>\(function\s*\(w,d\)\s*{[\s\S]*s\.src="https:\/\/cdn\.iubenda\.com\/iubenda\.js";[\s\S]*}\)\([\w\s,]*\);<\/script\s*>\s*$/gim,/^\s*<script[\w\d\s/:;.,'="-]*src="https:\/\/consent\.cookiebot\.com\/[\w\d-]+\/cd\.js"[\w\d\s/:;.,'="-]*><\/script\s*>\s*$/gim,/^\s*<script\s*(type="text\/javascript"){0,1}\s*>\s*var\s+cpm\s*=\s*{};\s*\(function\(h,u,b\){[\w\d\s()[\]{}/.,:;="'-]+e\.src='https:\/\/cookiehub\.net(\/dev){0,1}\/c2\/[\w\d-]+\.js';[\w\d\s()[\]{}/.,:;="'-]+}\)\([\w\d\s,]+\);\s*<\/script\s*>\s*$/gim],video:[/^\s*<video[\s\S]*>[\s\S]*<\/video>\s*$/gim],iframe:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t.replace(/<!--[\s\S]*-->/gi,"");return/^\s*<iframe[\s\S]*>[\s\S]*<\/iframe>\s*$/i.test(e)}};t.exports=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=t.trim();for(var o in i){var a=i[o];if("function"==typeof a)return a(n,e)?o:"codeinjection";for(var r in a)if("function"==typeof(r=a[r])){if(r(n,e))return o}else{var s=new RegExp(r.source,r.flags);if(s.test(n.replace(/\n/g,"")))return o}}return"codeinjection"}},zZDe:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return r}));var n=i("q1tI"),o=i.n(n),a="BR_ENTITY",r={strategy:function(t,e,i){t.findEntityRanges((function(t){var e=t.getEntity();return null!==e&&i.getEntity(e).getType()===a}),e)},component:function(){return o.a.createElement("br",null)}}},zjto:function(t,e,i){"use strict";i.d(e,"h",(function(){return r}));var n=i("uxFs");i.d(e,"a",(function(){return n.b}));var o=i("sxjd");i.d(e,"b",(function(){return o.a}));var a=i("Jzj8");i.d(e,"c",(function(){return a.a})),i.d(e,"d",(function(){return a.h})),i.d(e,"e",(function(){return a.i})),i.d(e,"f",(function(){return a.j})),i.d(e,"g",(function(){return a.k}));i("mIwl");var r=3},zn5y:function(t,e,i){t.exports=i.p+"bfaa25fb1a2c3440827644a5a60aa268.svg"},zoxU:function(t,e,i){"use strict";var n=i("vqZt");i.n(n).a},zw1n:function(module,exports){module.exports={"template-common-button-widget":function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='\n\n    <div class="common-button" data-id="'+(null==(__t=data._id)?"":_.escape(__t))+'">\n\n        <div class="icon"></div>\n\n    </div>\n\n';return __p}}},zzMN:function(t,e,i){"use strict";var n=i("xi34"),o=i("q1z7"),a=i.n(o),r=i("rFsW"),s=i("OTSC"),l=i("f3SV"),c=i("DiDd"),d=i.n(c),h=i("phNm"),u=a.a.View.extend({selectIconRight:18,selectIconTextMargin:2,initialize:function(t){r.a.bindAll(this),this.data=t.data,this.$container=t.$container,this.environment=t.environment,this.block=t.block,this.eCommerceManager=t.eCommerceManager,this.template=d.a["template-common-add-to-cart-wrap"],this.product=null,this.selects=[],this.selectsMap={},this.attributes=[],this.selectsValues={},this.restrictions={},this.constraints={width:0,height:0},this.showSkus=!1,this.longestAttribute="",this.selectPadding=0,this.setData_debounced=r.a.debounce(this.setData,100),this.setModel_debounced=r.a.debounce(this.setModel,200),this.$container.html(this.template),this.setElement(this.$container.find(".add-to-cart-wrap")),this.$button=this.$el.find(".add-to-cart-button"),this.$buttonIcon=this.$button.find(".button-icon"),this.$errorBlock=this.$button.find(".add-to-cart-error-block"),this.$buttonText=this.$button.find(".button-text"),this.$attrsContainer=this.$el.find(".add-to-cart-attributes"),this.$sizesCalculatingBlock=this.$el.find(".sizes-calculating-block")},render:function(t){if(!this.rendered){if(this.provider=this.eCommerceManager.getConnectedProvider(),this.eCommerceManager.events.on("ecommerce:update:provider",this.onProviderChanged.bind(this)),!this.provider||"default"===this.data.selected_product_id)return this.rendered=!1,this.showSkus=!1,this.renderButton(this.data,t),this.generateIndividualStyleCSS(this.data),this.rendered=!0,this.recalcDimensions({width:this.data.w,height:this.data.h}),this.trigger("loaded"),void this.setMinimalDimensions();this.getProduct()}},destroy:function(){this.unbindDOMEvents(),this.eCommerceManager.events.off("ecommerce:update:provider",this.onProviderChanged.bind(this))},onProviderChanged:function(t){this.provider!==t&&(this.provider=t,this.rerender())},rerender:function(t){t&&(this.data=t),this.rendered=!1,this.render()},getProduct:function(){this.product=this.eCommerceManager.getProductById(this.data.selected_product_id),this.eCommerceManager.events.on("ecommerce:loadproducts:complete",this.getProduct.bind(this)),this.product?(this.showSkus=this.checkSkus(null,this.product),this.renderAttributes(this.data),this.renderButton(this.data),this.renderMargins(),"horizontal"===this.data.layout&&this.setHorizontalLayoutClass(),this.generateIndividualStyleCSS(this.data),this.rendered=!0,this.recalcDimensions({width:this.data.w,height:this.data.h}),this.trigger("loaded"),this.setMinimalDimensions(),this.bindDOMEvents()):(this.eCommerceManager.productsLoaded||this.eCommerceManager.productsLoadingError)&&(this.showSkus=!1,this.renderButton(this.data),this.generateIndividualStyleCSS(this.data),this.rendered=!0,this.recalcDimensions({width:this.data.w,height:this.data.h}),this.trigger("loaded"),this.setMinimalDimensions())},checkSkus:function(t,e){return!!this.provider&&(e?i=e:t?i=this.eCommerceManager.getProductById(t):this.data.selected_product_id&&"default"!==this.data.selected_product_id&&(i=this.eCommerceManager.getProductById(this.data.selected_product_id)),!!i&&(this.product=i,this.eCommerceManager.productHasActiveSku(i)));var i},renderButton:function(t,e){this.showSkus||(this.$attrsContainer.empty().css({"margin-bottom":0,"margin-right":0}),this.selects=[],this.selectsMap={},this.attributes=[]),this.$buttonText.val(t.text),"constructor"!==this.environment&&this.$button.addClass("viewer-button"),this.renderButtonIcon(t),e&&e.isNew||this.checkOutOfStock()},renderButtonIcon:function(t){if(t.icon_enabled){var e="left"===t.icon_pos?"row":"row-reverse";this.$button.css("flex-direction",e),this.$buttonIcon.css({display:"inline-block",height:t.icon_h,width:t.icon_w})}else this.$buttonIcon.css({display:"none"})},renderAttributes:function(t){var e=this;if(this.$attrsContainer.empty().css({"margin-bottom":0,"margin-right":0}),this.selects=[],this.selectsMap={},this.attributes=[],this.showSkus){var i=this.product?this.product:this.eCommerceManager.getProductById(t.selected_product_id);i&&(this.product||(this.product=i),("constructor"===this.environment||i.active)&&("constructor"!==this.environment&&this.calculateSelectRestrictions(),"stripe"===this.provider&&i.attributes.forEach((function(t){t.length>e.longestAttribute.length&&(e.longestAttribute=t);var i=e.renderStripeSelect(t);e.selects.push(i),e.selectsMap[t]=i,e.attributes.push(t)})),"ecwid"===this.provider&&i.options.forEach((function(t){if(e.eCommerceManager.isOptionValid(t)){t.name.length>e.longestAttribute.length&&(e.longestAttribute=t.name);var i=e.renderEcwidSelect(t);e.selects.push(i),e.selectsMap[t.name]=i,e.attributes.push(t.name)}}))))}},renderStripeSelect:function(t){var e;if("constructor"===this.environment){e=Object(n.a)("<select>",{class:"attributes-input",value:t}).attr("name",t);var i=Object(n.a)("<option>").attr("value",t).addClass("attributes-option default-option").text(t);e.append(i)}else e=Object(n.a)("<select>").attr("name",t).addClass("attributes-input"),this.renderSelectOptions(t,e,!0),e.on("change",this.onSelectChange.bind(this));return this.addSelectToPage(e,t),e},renderEcwidSelect:function(t){var e,i,o=(null===(e=t.nameTranslated)||void 0===e?void 0:e[this.eCommerceManager.userLocale])||t.name;if("constructor"===this.environment){i=Object(n.a)("<select>",{value:t.name}).attr("name",t.name).addClass("attributes-input");var a=Object(n.a)("<option>").attr("value",t.name).addClass("attributes-option default-option").text(o);i.append(a)}else i=Object(n.a)("<select>").attr("name",t.name).addClass("attributes-input"),this.renderEcwidSelectOptions(t.name,i,!0),i.on("change",this.onSelectChange.bind(this));return this.addSelectToPage(i,o),i},addSelectToPage:function(t,e){var i=Object(n.a)("<div>",{class:"select-container"});i.append('<div class="add-to-cart-error-block"></div>');var o=Object(n.a)("<input>",{type:"text",class:"fake-select",readonly:!0,tabindex:-1,value:e}),a=Object(n.a)('<svg class="select-dropdown-triangle" width="10px" height="16px" viewBox="0 0 10 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="dev" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="E-comm-W-01.4" transform="translate(-632.000000, -263.000000)" fill="#FFFFFF"><g transform="translate(494.500000, 247.000000)"><g><g transform="translate(136.000000, 15.500000)"><path d="M3.88579937,12.2407434 L8.34920863,8.41496403 C8.76853447,8.05554188 9.39983445,8.10410342 9.7592566,8.52342926 C9.91460784,8.70467237 10,8.93550936 10,9.17422064 L10,16.8257794 C10,17.3780641 9.55228475,17.8257794 9,17.8257794 C8.76128873,17.8257794 8.53045174,17.7403872 8.34920863,17.585036 L3.88579937,13.7592566 C3.46647353,13.3998345 3.41791199,12.7685345 3.77733414,12.3492086 C3.81065883,12.3103298 3.84692056,12.2740681 3.88579937,12.2407434 Z" id="arrow-copy" transform="translate(6.500000, 13.000000) scale(-1, -1) rotate(-270.000000) translate(-6.500000, -13.000000) "></path><path d="M3.88579937,3.2407434 L8.34920863,-0.585035966 C8.76853447,-0.944458116 9.39983445,-0.895896579 9.7592566,-0.476570737 C9.91460784,-0.295327627 10,-0.0644906353 10,0.174220637 L10,7.82577936 C10,8.37806411 9.55228475,8.82577936 9,8.82577936 C8.76128873,8.82577936 8.53045174,8.7403872 8.34920863,8.58503597 L3.88579937,4.7592566 C3.46647353,4.39983445 3.41791199,3.76853447 3.77733414,3.34920863 C3.81065883,3.31032982 3.84692056,3.27406809 3.88579937,3.2407434 Z" id="arrow-copy" transform="translate(6.500000, 4.000000) scale(-1, 1) rotate(-270.000000) translate(-6.500000, -4.000000) "></path></g></g></g></g></g></svg>');this.$attrsContainer.append(i),i.append(o,a,t),"constructor"===this.environment&&i.append(Object(n.a)("<div>",{class:"select-overlay"}))},renderSelectOptions:function(t,e,i){var o=this,a=this.getAllSelectOptions();e.empty();var r=Object(n.a)("<option>").attr("value","default").addClass("attributes-option default-option").text(t);e.append(r),a[t]&&a[t].forEach((function(i){var a=Object(n.a)("<option>").attr("value",i).addClass("attributes-option").text(i);o.restrictions[t]&&!o.restrictions[t].includes(i)&&a.attr("disabled",!0),e.append(a)})),i?this.selectsValues[t]="default":e.val(this.selectsValues[t])},renderEcwidSelectOptions:function(t,e,i){var o=this.getTranslatedOptions(t);e.empty();var a=Object(n.a)("<option>").attr("value","default").addClass("attributes-option default-option").text(o[t].tanslatedName);e.append(a),o[t]&&o[t].values.forEach((function(i){var a=Object(n.a)("<option>").attr("value",i).addClass("attributes-option").text(o[t].translatedValues[i]);e.append(a)})),i?this.selectsValues[t]="default":e.val(this.selectsValues[t])},getAllSelectOptions:function(){var t={};return"stripe"===this.provider&&this.product.articles.forEach((function(e){Object.keys(e.attributes).forEach((function(i){t[i]=t[i]||[],t[i].includes(e.attributes[i])||t[i].push(e.attributes[i])}))})),"ecwid"===this.provider&&this.product.options.forEach((function(e){t[e.name]=[],e.choices.forEach((function(i){return t[e.name].push(i.text)}))})),t},getTranslatedOptions:function(t){var e=this,i={};return this.product.options.forEach((function(n){var o;if(!t||n.name===t){var a=(null===(o=n.nameTranslated)||void 0===o?void 0:o[e.eCommerceManager.userLocale])||n.name;i[n.name]={tanslatedName:a,values:[],translatedValues:{}},n.choices.forEach((function(t){i[n.name].values.push(t.text);var o=t.textTranslated&&t.textTranslated[e.eCommerceManager.userLocale]?t.textTranslated[e.eCommerceManager.userLocale]:t.text;i[n.name].translatedValues[t.text]=o}))}})),i},calculateSelectRestrictions:function(){if("ecwid"===this.provider)return this.getAllSelectOptions();this.restrictions={};var t,e={},i=0;for(var n in this.selectsValues)"default"!==this.selectsValues[n]&&(e[n]=this.selectsValues[n],t=n,i+=1);this.product.articles.forEach(function(n){if(r.a.isMatch(n.attributes,e))for(var o in n.attributes)this.restrictions[o]?-1===this.restrictions[o].indexOf(n.attributes[o])&&this.restrictions[o].push(n.attributes[o]):this.restrictions[o]=[n.attributes[o]];1===i&&(this.restrictions[t]?-1===this.restrictions[t].indexOf(n.attributes[t])&&this.restrictions[t].push(n.attributes[t]):this.restrictions[t]=[n.attributes[t]])}.bind(this))},renderMargins:function(t){var e=t||this.data.layout;if(this.$attrsContainer.css({"margin-bottom":0,"margin-right":0}),this.showSkus&&this.selects.length){var i=this.selects.length-1;"horizontal"===e?(this.$attrsContainer.css({"margin-right":this.data.select_btn_margin}),this.selects.forEach(function(t,e){t.parent().css({"margin-bottom":0,"margin-right":e<i?this.data.attributes_margin:0})}.bind(this))):(this.$attrsContainer.css({"margin-bottom":this.data.select_btn_margin}),this.selects.forEach(function(t,e){t.parent().css({"margin-bottom":e<i?this.data.attributes_margin:0,"margin-right":0})}.bind(this)))}},generateIndividualStyleCSS:function(t,e,i){var n=e||"default",o=i||"both";"constructor"===this.environment?this.generateStyleCSS(t,n,o):(this.generateStyleCSS(t,n,o),this.generateHoverStyleCSS(t))},bindDOMEvents:function(){this.eCommerceManager.events.on("ecommerce:cartdata:changed",this.checkOutOfStock),"constructor"!==this.environment&&this.$button.on("click",this.onAddToCartClick)},unbindDOMEvents:function(){this.eCommerceManager.events.off("ecommerce:cartdata:changed",this.checkOutOfStock),"constructor"!==this.environment&&this.$button.off("click",this.onAddToCartClick)},getSimpleMinimalDimensions:function(){return this.showSkus?"vertical"===this.data.layout?{width:50,height:100}:{width:190,height:30}:{width:42,height:16}},getHorizontalTextMargin:function(t){return Math.ceil(t/4)},getVerticalTextMargin:function(t){return Math.ceil(t/6)},getHorizontalIconMargin:function(t){return Math.ceil(t/4)},getVerticalIconMargin:function(t){return Math.ceil(t/6)},getMinimalDimensions:function(){var t=0,e=0,i=this.data.icon_h+2*this.getVerticalIconMargin(this.data.icon_h);if("text"===this.data.tp?(t=this.data.text_w,e=this.data.text_h):"icon"===this.data.tp?(t=this.data.icon_w+2*this.getHorizontalIconMargin(this.data.icon_w),e=i):(t=this.data.text_w+this.data.icon_w+this.getHorizontalTextMargin(this.data["font-size"]),e=this.data.text_h>i?this.data.text_h:i),this.showSkus){var n=this.data["attrs-icon-h"]+2*this.getVerticalIconMargin(this.data["attrs-icon-h"]),o=this.data["attrs-text_w"]+2*this.getSelectsPadding(),a=this.data["attrs-text_h"]>n?this.data["attrs-text_h"]:n,r=t>o?t:o,s=e>a?e:a,l=(this.selects.length-1)*this.data.attributes_margin,c=0,d=0;return"vertical"===this.data.layout?(c=r,d=s*(this.selects.length+1)+l+this.data.select_btn_margin):(c=r*(this.selects.length+1)+l+this.data.select_btn_margin,d=s),{width:c,height:d}}return{width:t,height:e}},setMinimalDimensions:function(t,e){if(!r.a.isUndefined(t)&&!r.a.isUndefined(e))return this.constraints={width:t,height:e},void(this.block&&this.block.setSizeConstraints(t,e));if("constructor"===this.environment){var i=this.getMinimalDimensions();this.constraints=i,this.block.setSizeConstraints(i.width,i.height)}},recalcDimensions:function(t){if(this.rendered){var e=this.showSkus?this.data.select_btn_margin:0,i=this.showSkus?this.selects.length+1:1,n=this.showSkus?(this.selects.length-1)*this.data.attributes_margin:0;if("vertical"===this.data.layout){if(!t.height)return;var o=t.height-e-n,a=Math.round(o/i);this.$button.css({height:a+"px",width:"100%"}),this.showSkus&&this.selects.forEach((function(t){t.parent().css({height:a+"px",width:"100%"})}))}else{if(!t.width)return;var r=t.width-e-n,s=Math.round(r/i);this.$button.css({width:s+"px",height:"100%"}),this.showSkus&&this.selects.forEach((function(t){t.parent().css({width:s+"px",height:"100%"})}))}}},updateRecalcDimensionsOnProductChange:function(){var t=this.recalcDimensionsOnProductChange();this.block.updateBlockSizes(t)},recalcDimensionsOnProductChange:function(){var t,e,i=this.showSkus?this.data.select_btn_margin:0,n=this.showSkus?this.selects.length+1:1,o=this.showSkus?(this.selects.length-1)*this.data.attributes_margin:0,a=this.data.btn_h,r=this.data.btn_w;return"vertical"===this.data.layout?(t=a*n+o+i,e=r):(t=a,e=r*n+o+i),this.$button.css({height:a+"px",width:r+"px"}),this.showSkus&&this.selects.forEach((function(t){t.parent().css({height:a+"px",width:r+"px"})})),{width:e,height:t}},recalcWidgetSizesAfterChangeLayout:function(t){var e=t||this.data.layout,i=this.data.btn_h,n=this.data.btn_w,o=i,a=n;return this.showSkus&&("horizontal"===e?a=n+n*this.selects.length+this.data.select_btn_margin+this.data.attributes_margin*(this.selects.length-1):o=i+i*this.selects.length+this.data.select_btn_margin+this.data.attributes_margin*(this.selects.length-1)),this.block.updateBlockSizes({width:a,height:o}),{width:a,height:o}},isAllSelectsNotDefault:function(){var t=!0;for(var e in this.selectsValues)if("default"===this.selectsValues[e]){t=!1;break}return t},getArticleBySelectsValues:function(){return this.product?1===this.product.articles.length?this.product.articles[0]:this.product.articles.find(function(t){return r.a.isMatch(t.attributes,this.selectsValues)}.bind(this)):null},getProductPrice:function(){return this.product&&this.product.prices&&this.product.prices.length?this.product.prices.find((function(t){return t.active&&"per_unit"===t.billing_scheme})):null},onSelectChange:function(t){this.hideError();var e=Object(n.a)(t.target),i=e.find("option:selected"),o=e.attr("name");this.selectsValues[o]=e.val(),e.parent().find(".fake-select").attr("value","default"===e.val()?e.find("[value=default]").text():i.text()),this.calculateSelectRestrictions(),"stripe"===this.provider&&this.product.attributes.forEach(function(t){this.renderSelectOptions(t,this.selectsMap[t])}.bind(this))},onAddToCartClick:function(){var t=this;if(this.hideError(),this.product||this.showError(),this.isAllSelectsNotDefault()){var e=this.eCommerceManager.getProductForAddToCart(this.product,this.selectsValues);if(e){var i=this.eCommerceManager.addProductToCart(e);if(i instanceof h.a)return void(i.type===h.c.outOfStock?this.showOutOfStockError():this.showError());this.environment===l.a.environment.viewer&&RM.analytics&&RM.analytics.sendEvent("Item added to cart",e.id),Object.keys(this.selectsMap).forEach((function(e){var i=t.selectsMap[e];i.find("option").prop("selected",!1),i.find("option[value=default]").prop("selected",!0),t.selectsValues[e]="default",i.parent().find(".fake-select").attr("value",i.find("option[value=default]").text()),t.calculateSelectRestrictions()})),Object.keys(this.selectsMap).length&&"stripe"===this.provider&&this.product.attributes.forEach((function(e){return t.renderSelectOptions(e,t.selectsMap[e])}))}else this.showError()}else this.showError("select")},showError:function(t){"select"!==t?this.$button.addClass("add-to-cart-error"):this.selects.map((function(t){t.parents(".select-container").toggleClass("add-to-cart-error","default"===t.val())}))},showOutOfStockError:function(){this.showError(),this.$buttonText.val(this.eCommerceManager.getTextValue("out_of_stock"))},showInvalidError:function(){this.showError(),"constructor"===this.environment||RM.screenshot||this.$buttonText.val("No product")},checkOutOfStock:function(){if(!RM.screenshot){if(!this.product||void 0===this.eCommerceManager.checkProductActive(this.product.id))return this.showInvalidError();if("stripe"===this.provider){var t=this.getArticleBySelectsValues();if("constructor"!==this.environment&&!RM.screenshot&&t&&!this.eCommerceManager.checkItemQuantity(t))return this.showOutOfStockError()}if("ecwid"===this.provider){var e=this.eCommerceManager.isProductAvailable(this.eCommerceManager.getProductForAddToCart(this.product,this.selectsValues));if("constructor"!==this.environment&&!RM.screenshot&&!e)return this.showOutOfStockError()}this.$buttonText.val(this.data.text),this.hideError()}},hideError:function(){this.$button.removeClass("add-to-cart-error"),this.selects.map((function(t){return t.parents(".select-container").removeClass("add-to-cart-error")})),this.$buttonText.val(this.data.text)},onProductChange:function(t){t&&(this.data=t),this.rendered=!1,this.showSkus=this.checkSkus(this.data.selected_product_id),this.showSkus?this.product&&(this.renderAttributes(this.data),this.renderButton(this.data),this.renderMargins(),this.generateIndividualStyleCSS(this.data),this.rendered=!0,this.updateRecalcDimensionsOnProductChange()):(this.renderButton(this.data),this.generateIndividualStyleCSS(this.data),this.rendered=!0,this.updateRecalcDimensionsOnProductChange())},setHorizontalLayoutClass:function(){this.$el.hasClass("horizontal-layout")||this.$el.addClass("horizontal-layout")},removeHorizontalLayoutClass:function(){this.$el.hasClass("horizontal-layout")&&this.$el.removeClass("horizontal-layout")},onLayoutChange:function(t){if(this.rendered){this.data=t;var e=t.layout,i=this.recalcWidgetSizesAfterChangeLayout(e);this.renderMargins(e),"horizontal"===e?this.setHorizontalLayoutClass():this.removeHorizontalLayoutClass(),this.recalcDimensions(i),this.setMinimalDimensions()}},applyButtonTextSize:function(t){this.data=t,this.$buttonText.css({height:t.text_h+"px",width:t.text_w+"px"})},applyButtonIconSize:function(t){this.data=t,this.$buttonIcon.css({height:t.icon_h+"px",width:t.icon_w+"px"})},applyButtonIconPosition:function(t){this.data=t;var e="left"===t.icon_pos?"row":"row-reverse";this.$button.css("flex-direction",e)},applySelectsIconSize:function(t){var e=this;this.data=t,this.showSkus&&(this.selectPadding=t["attrs-icon-w"]+this.selectIconRight+this.selectIconTextMargin,this.selects.forEach((function(i){var n=i.parent();n.find(".fake-select").css({padding:"0 ".concat(e.selectPadding,"px")}),n.find(".select-dropdown-triangle").css({width:t["attrs-icon-w"]+"px",height:t["attrs-icon-h"]+"px"})})))},getButtonText:function(){return this.$buttonText.val().trim()},enterEditMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$buttonText.removeAttr("readonly").addClass("editing"),t.selectText?this.$buttonText.select():this.$buttonText.focus().setCursorPos(0),this.block.selectEditControl()},leaveEditMode:function(){this.$buttonText.blur().attr("readonly",!0).removeClass("editing")},setData:function(t){this.data=t},setModel:function(t,e){this.block.model.set(t),e&&this.block.model.save()},getColorForErrorBorder:function(t){return t.isBorderSet?s.default.getRGBA(t.border,t.borderOpacity/100):s.default.getRGBA(t.bg,t.bgOpacity/100)},getDropdownTriangleSizeFromFontSize:function(t){return{h:16*t/18,w:10*t/18}},getSelectsPadding:function(){return this.selectPadding},getLongestAttribute:function(){return this.longestAttribute},generateStyleCSS:function(t,e,i){function n(t){return(!e||"default"===e||"both"!==i&&"button"!==i?"":"hover-")+t}function o(t){return(!e||"default"===e||"both"!==i&&"selects"!==i?"attrs-":"attrs-hover-")+t}var a=this.getColorForErrorBorder({bg:t[n("background-color")],bgOpacity:t[n("background-color-opacity")],border:t[n("border-color")],borderOpacity:t[n("border-color-opacity")],isBorderSet:!!t[n("border-width")]});if(this.$errorBlock.css({borderColor:a}),this.$button.css({color:s.default.getRGBA(t[n("color")],t[n("color-opacity")]/100),"background-color":s.default.getRGBA(t[n("background-color")],t[n("background-color-opacity")]/100),"border-radius":t[n("border-radius")]+"px","box-shadow":s.default.getRGBA(t[n("border-color")],t[n("border-color-opacity")]/100)+"0px 0px 0px "+t[n("border-width")]+"px inset"}),"constructor"===this.environment)this.$button.find(".button-icon svg path").css({fill:s.default.getRGBA(t[n("icon_color")],t[n("icon_color_opacity")]/100)});else{var r=t[n("icon_raster2xUrl")]?t[n("icon_raster2xUrl")]:t[n("icon_rasterUrl")];r&&this.$buttonIcon.css({"background-image":"url("+r+")"})}this.$buttonText.css({width:t.text_w+"px",height:t.text_h+"px","line-height":t.text_h+"px","font-family":t[n("font-family")],"font-size":t[n("font-size")]+"px","font-weight":t[n("font-weight")],"font-style":t[n("font-style")],"letter-spacing":t[n("letter-spacing")],"text-align":t[n("text-align")]}),this.showSkus&&(this.selectPadding=t["attrs-icon-w"]+this.selectIconRight+this.selectIconTextMargin,this.selects.forEach(function(e){var i=e.parent();i.find(".add-to-cart-error-block").css({borderColor:a}),i.css({"background-color":s.default.getRGBA(t[o("background-color")],t[o("background-color-opacity")]/100),"border-radius":t[o("border-radius")]+"px","box-shadow":s.default.getRGBA(t[o("border-color")],t[o("border-color-opacity")]/100)+"0px 0px 0px "+t[o("border-width")]+"px inset"}),i.find(".fake-select").css({padding:"0 ".concat(this.selectPadding,"px"),"border-radius":t[o("border-radius")]+"px",color:s.default.getRGBA(t[o("color")],t[o("color-opacity")]/100),"font-family":t[o("font-family")],"font-size":t[o("font-size")]+"px","font-weight":t[o("font-weight")],"font-style":t[o("font-style")],"letter-spacing":t[o("letter-spacing")],"text-align":t[o("text-align")],"text-align-last":t[o("text-align")]}),i.find(".select-dropdown-triangle path").css({fill:s.default.getRGBA(t[o("color")],t[o("color-opacity")]/100)}),i.find(".select-dropdown-triangle").css({width:t["attrs-icon-w"],height:t["attrs-icon-h"]})}.bind(this)))},generateHoverStyleCSS:function(t){var e=this.$buttonText,i=this.$buttonIcon;this.$button.hover((function(){if(Object(n.a)(this).css({color:s.default.getRGBA(t["hover-color"],t["hover-color-opacity"]/100),"background-color":s.default.getRGBA(t["hover-background-color"],t["hover-background-color-opacity"]/100),"border-radius":t["hover-border-radius"]+"px","box-shadow":s.default.getRGBA(t["hover-border-color"],t["hover-border-color-opacity"]/100)+"0px 0px 0px "+t["hover-border-width"]+"px inset"}),"constructor"!==this.environment){var o=t["hover-icon_raster2xUrl"]?t["hover-icon_raster2xUrl"]:t["hover-icon_rasterUrl"];o&&i.css({"background-image":"url("+o+")"})}else Object(n.a)(this).find(".button-icon svg path").css({fill:s.default.getRGBA(t["hover-icon_color"],t["hover-icon_color_opacity"]/100)});e.css({"font-family":t["hover-font-family"],"font-size":t["hover-font-size"]+"px","font-weight":t["hover-font-weight"],"font-style":t["hover-font-style"],"letter-spacing":t["hover-letter-spacing"],"text-align":t["hover-text-align"]})}),(function(){if(Object(n.a)(this).css({color:s.default.getRGBA(t.color,t["color-opacity"]/100),"background-color":s.default.getRGBA(t["background-color"],t["background-color-opacity"]/100),"border-radius":t["border-radius"]+"px","box-shadow":s.default.getRGBA(t["border-color"],t["border-color-opacity"]/100)+"0px 0px 0px "+t["border-width"]+"px inset"}),"constructor"!==this.environment){var o=t.icon_raster2xUrl?t.icon_raster2xUrl:t.icon_rasterUrl;o&&i.css({"background-image":"url("+o+")"})}else Object(n.a)(this).find(".button-icon svg path").css({fill:s.default.getRGBA(t.color,t["color-opacity"]/100)});e.css({"font-family":t["font-family"],"font-size":t["font-size"]+"px","font-weight":t["font-weight"],"font-style":t["font-style"],"letter-spacing":t["letter-spacing"],"text-align":t["text-align"]})})),this.showSkus&&this.selects.forEach(function(e){e.hover((function(){Object(n.a)(this).parent().css({"background-color":s.default.getRGBA(t["attrs-hover-background-color"],t["attrs-hover-background-color-opacity"]/100),"border-radius":t["attrs-hover-border-radius"]+"px","box-shadow":s.default.getRGBA(t["attrs-hover-border-color"],t["attrs-hover-border-color-opacity"]/100)+"0px 0px 0px "+t["attrs-hover-border-width"]+"px inset"}),Object(n.a)(this).parent().find(".fake-select").css({"border-radius":t["attrs-hover-border-radius"]+"px",color:s.default.getRGBA(t["attrs-hover-color"],t["attrs-hover-color-opacity"]/100),"font-family":t["attrs-hover-font-family"],"font-size":t["attrs-hover-font-size"]+"px","font-weight":t["attrs-hover-font-weight"],"font-style":t["attrs-hover-font-style"],"letter-spacing":t["attrs-hover-letter-spacing"],"text-align":t["attrs-hover-text-align"],"text-align-last":t["attrs-hover-text-align"]}),Object(n.a)(this).parent().find(".select-dropdown-triangle path").css({fill:s.default.getRGBA(t["attrs-hover-color"],t["attrs-hover-color-opacity"]/100)})}),(function(){Object(n.a)(this).parent().css({"background-color":s.default.getRGBA(t["attrs-background-color"],t["attrs-background-color-opacity"]/100),"border-radius":t["attrs-border-radius"]+"px","box-shadow":s.default.getRGBA(t["attrs-border-color"],t["attrs-border-color-opacity"]/100)+"0px 0px 0px "+t["attrs-border-width"]+"px inset"}),Object(n.a)(this).parent().find(".fake-select").css({"border-radius":t["attrs-border-radius"]+"px",color:s.default.getRGBA(t["attrs-color"],t["attrs-color-opacity"]/100),"font-family":t["attrs-font-family"],"font-size":t["attrs-font-size"]+"px","font-weight":t["attrs-font-weight"],"font-style":t["attrs-font-style"],"letter-spacing":t["attrs-letter-spacing"],"text-align":t["attrs-text-align"],"text-align-last":t["attrs-text-align"]}),Object(n.a)(this).parent().find(".select-dropdown-triangle path").css({fill:s.default.getRGBA(t["attrs-color"],t["attrs-color-opacity"]/100)})})),setTimeout(function(){e.parent().css({transition:"all "+t["hover-tansition-duration"]+"s ease-out"}),e.parent().find(".fake-select").css({transition:"all "+t["hover-tansition-duration"]+"s ease-out"})}.bind(this),100),e.parent().find(".select-dropdown-triangle path").css({transition:"all "+t["hover-tansition-duration"]+"s ease-out"})}.bind(this)),setTimeout(function(){this.$button.css({transition:"all "+t["hover-tansition-duration"]+"s ease-out"}),e.css({transition:"all "+t["hover-tansition-duration"]+"s ease-out"}),i.css({transition:"all "+t["hover-tansition-duration"]+"s ease-out"})}.bind(this),100)}},{DEFAULT_ROW_HEIGHT:50,DEFAULT_ROW_WIDTH:168});e.a=u}}]);
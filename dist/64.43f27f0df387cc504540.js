(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[64,20],{821:function(e,t,n){"use strict";var r=n(662);t.useResizeEffect=void 0;var o=r(n(745)),i=n(352),a=r(n(822)),s=function(e){return e?{width:e.offsetWidth,height:e.offsetHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{width:0,height:0,scrollWidth:0,scrollHeight:0,offsetWidth:0,offsetHeight:0}};t.useResizeEffect=function(e,t){var n=(0,i.useState)(s(e.current)),r=(0,o.default)(n,2),c=r[0],l=r[1],u=(0,i.useCallback)((function(){e.current&&l(s(e.current))}),[e]);return(0,i.useLayoutEffect)((function(){if(e.current){u();var n=new a.default((function(){u()}));return t?n.unobserve(e.current):n.observe(e.current),function(){n.disconnect()}}}),[e,u,t]),c}},974:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});n(352);var r=n(624),o=n(666);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(e){var t=e||{},n=t.type,i=void 0===n?o.BM.None:n,s=t.color,c=void 0===s?"00000064":s,l=t.size,u=void 0===l?1:l,d=t.padding,g=void 0===d?0:d,m=(0,r.gn)(c),h=m.r,f=m.g,p=m.b,v=m.a,y="rgba(".concat(h,", ").concat(f,", ").concat(p,", ").concat(v,")"),w="repeat-x",b=u+g,S=b>0?"0 100%":"0 ".concat(100+b,"%"),M={textDecoration:"none",paddingBottom:Math.max(0,b)};switch(i){case o.BM.Solid:return a(a({},M),{},{background:"linear-gradient(to right, ".concat(y," 0%, ").concat(y," 100%) ").concat(S,"/1px ").concat(u,"px ").concat(w)});case o.BM.Dotted:return a(a({},M),{},{background:"linear-gradient(to right, ".concat(y," 0%, ").concat(y," 50%, transparent 50%, transparent 100%) ").concat(S,"/").concat(2*u,"px ").concat(u,"px ").concat(w)});case o.BM.Dashed:return a(a({},M),{},{background:"linear-gradient(to right, ".concat(y," 0%, ").concat(y," 66.6666%, transparent 66.6666%, transparent 100%) ").concat(S,"/").concat(3*u,"px ").concat(u,"px ").concat(w)});default:return a(a({},M),{},{background:"none"})}}},966:function(e,t,n){"use strict";n.d(t,{vY:function(){return m},$w:function(){return f}});var r=n(968),o=n(624),i=(n(344),n(666)),a=n(308),s=(n(967),n(668),n(620));n(657);function c(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(e,t){if(!e)return"";var n="number"==typeof t?t:100;return"".concat(e).concat((0,o.vx)(n))},m=function(e){var t=["none",0,"baseline"],n=["opacity"];return e.map((function(e){var i=e._name,l=e._caption,g=e.tag,m=(e._sort,c(e,["_name","_caption","tag","_sort"])),h=Object.keys(m).reduce((function(e,i){var a=(0,r.eV)(i),c=m[i];if(n.includes(i)||t.includes(c))return u({},e);if("textAlign"===a&&"start"===c)c="left";else if("color"===a){var l=m.opacity>0?parseFloat((m.opacity/100).toFixed(2)):1,g=(0,o.vK)(c,l);c=(0,o.tZ)(g)}else a.includes("padding")?c=parseInt(c):"fontWeight"===a&&"normal"===c&&(c=s.BX.fontWeight);return u(u({},e),{},d({},a,c))}),{});return h.paddingLeft=h.paddingLeft||0,h.paddingRight=h.paddingRight||0,h.paddingTop=h.paddingTop||0,h.paddingBottom=h.paddingBottom||0,{name:i,label:l,tag:g||a.ZP.AVAILABLE_TEXT_TAGS[0],cssProperties:h}}))},h=function(e,t){var n=function(e){return t?"".concat(t,"-").concat(e):e},r=void 0!==e[n("color")]?e[n("color")]:e.color,o=void 0!==e[n("opacity")]?e[n("opacity")]:e.opacity,a=void 0!==e[n("u-color")]?e[n("u-color")]:e["u-color"],s=void 0!==e[n("u-opacity")]?e[n("u-opacity")]:e["u-opacity"],c=void 0!==e[n("u-size")]?e[n("u-size")]:e["u-size"],l=void 0!==e[n("u-offset")]?e[n("u-offset")]:e["u-offset"],u=void 0!==e[n("u-style")]?e[n("u-style")]:e["u-style"];return{textColor:g(String("inherit"===r?e.color:r),Number("inherit"===o?e.opacity:o)),color:g(String("inherit"===a?e["u-color"]:a),Number("inherit"===s?e["u-opacity"]:s)),size:Number("inherit"===c?e["u-size"]:c),padding:Number("inherit"===l?e["u-offset"]:l),type:function(e){switch(e){case"none":return i.BM.None;case"dotted":return i.BM.Dotted;case"dashed":return i.BM.Dashed;case"solid":return i.BM.Solid}}(u)}},f=function(e){return e.map((function(e){return{name:e._name,label:e._caption,style:{link:h(e),hover:h(e,"hover"),current:h(e,"current")}}}))}},964:function(e,t,n){"use strict";n.d(t,{$Y:function(){return R},IB:function(){return D}});var r,o=n(352),i=n.n(o),a=n(600),s=n.n(a),c=n(636),l=n(965),u=n(966),d=n(657),g=n(646),m=n(639),h=n(969),f=n(641),p=n(974);function v(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||M(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||M(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P,x,E=(0,g.createGlobalStyle)(r||(P=["\n  ","\n  ","\n  ","\n  ","\n"],x||(x=P.slice(0)),r=Object.freeze(Object.defineProperties(P,{raw:{value:Object.freeze(x)}}))),(function(e){return e.blockStyles}),(function(e){return e.textStyleSheet}),(function(e){return e.linkStyleSheet}),(function(e){return e.listStyleSheet})),R=function(e){var t=e.mode,n=S((0,m.sJ)(),2),r=n[0],a=n[1],s=S((0,m.H$)(),2),g=s[0],y=s[1],M=S((0,m.SZ)(),2),j=M[0],P=M[1];(0,o.useEffect)((function(){if("constructor"===t){var e=[];if(!r.global.length&&!r.project.length){var n,o,i=window.ServerData.textStyles,s=l.j;if(!i||!i.project||!i.project.length){var m,h,f=null===(m=window.ServerData)||void 0===m||null===(h=m.editParams)||void 0===h?void 0:h.paragraph_styles;f&&(s=(0,u.vY)(f),e.push((0,c.Wf)({styles:s,projectId:window.ServerData.projectId})))}a({global:null!=i&&null!==(n=i.global)&&void 0!==n&&n.length?i.global:[],project:null!=i&&null!==(o=i.project)&&void 0!==o&&o.length?i.project:s})}if(!g.global.length&&!g.project.length){var p,v,w=window.ServerData.linkStyles,b=[d.TF];if(!w||!w.project||!w.project.length){var S=window.ServerData.editParams&&window.ServerData.editParams.link_styles;S&&(b=(0,u.$w)(S),e.push((0,c.pV)({styles:b,projectId:window.ServerData.projectId})))}y({global:null!=w&&null!==(p=w.global)&&void 0!==p&&p.length?w.global:[],project:null!=w&&null!==(v=w.project)&&void 0!==v&&v.length?w.project:b})}if(!j.global.length&&!j.project.length){var M,x,E=window.ServerData.listStyles;P({global:null!=E&&null!==(M=E.global)&&void 0!==M&&M.length?E.global:[],project:null!=E&&null!==(x=E.project)&&void 0!==x&&x.length?E.project:l.O})}e.length&&Promise.all(e)}if("viewer"===t||"screenshoter"===t){var R,D,O,T,k,_,C,I,Z,B,U,F,A,z,W,N,H,V,L,q,$,G,X,K,Y,J,Q="viewer"===t,ee=Q?(null===(R=window.ServerData)||void 0===R||null===(D=R.mags)||void 0===D||null===(O=D.mag)||void 0===O?void 0:O.textStyles)||(null===(T=window.RM)||void 0===T||null===(k=T.viewerRouter)||void 0===k||null===(_=k.mag)||void 0===_?void 0:_.textStyles):null===(C=window.ServerData)||void 0===C||null===(I=C.mag)||void 0===I?void 0:I.textStyles;if(ee)a({global:null!=ee&&null!==(Y=ee.global)&&void 0!==Y&&Y.length?ee.global:[],project:null!=ee&&null!==(J=ee.project)&&void 0!==J&&J.length?ee.project:l.j});var te,ne,re=Q?(null===(Z=window.ServerData)||void 0===Z||null===(B=Z.mags)||void 0===B||null===(U=B.mag)||void 0===U?void 0:U.linkStyles)||(null===(F=window.RM)||void 0===F||null===(A=F.viewerRouter)||void 0===A||null===(z=A.mag)||void 0===z?void 0:z.linkStyles):null===(W=window.ServerData)||void 0===W||null===(N=W.mag)||void 0===N?void 0:N.linkStyles;if(re)y({global:null!=re&&null!==(te=re.global)&&void 0!==te&&te.length?re.global:[],project:null!=re&&null!==(ne=re.project)&&void 0!==ne&&ne.length?re.project:[d.TF]});var oe,ie,ae=Q?(null===(H=window.ServerData)||void 0===H||null===(V=H.mags)||void 0===V||null===(L=V.mag)||void 0===L?void 0:L.listStyles)||(null===(q=window.RM)||void 0===q||null===($=q.viewerRouter)||void 0===$||null===(G=$.mag)||void 0===G?void 0:G.listStyles):null===(X=window.ServerData)||void 0===X||null===(K=X.mag)||void 0===K?void 0:K.listStyles;if(ae)P({global:null!=ae&&null!==(oe=ae.global)&&void 0!==oe&&oe.length?ae.global:[],project:null!=ae&&null!==(ie=ae.project)&&void 0!==ie&&ie.length?ae.project:l.O})}}),[]);var x=(0,o.useMemo)((function(){return Object.keys(h.T).map((function(e){return h.T[e].style})).join(" ")}),[h.T]),R=(0,o.useMemo)((function(){var e=function(e){var t,n=(t=e.cssProperties,Object.keys(t).reduce((function(e,n){var r=t[n];return"string"==typeof r&&r.includes("(")&&!r.includes(")")&&(r="".concat(r,")")),r&&"opacity"===n&&parseInt(String(r))>1&&(r=parseInt(String(r))/100),w(w({},e),{},b({},n,r))}),{}));return"justify"===(n.textAlign&&String(n.textAlign))&&(n.whiteSpace="normal")," .".concat(e.name," { ").concat((0,f.aR)(n)," } ")},t=r.global.map(e),n=r.project.map(e);return[].concat(v(t),v(n)).join(" ")}),[r]),D=(0,o.useMemo)((function(){var e=function(e){var t=w({},e.cssProperties);return t.display="inline-block"," .".concat(e.name," {\n        &-preview {\n          ").concat((0,f.aR)(e.cssProperties),"\n        }\n\n        div[data-offset-key]:before, & > li:before, &:before {\n          ").concat((0,f.aR)(t),"\n        }\n      } ")},t=j.global.map(e),n=j.project.map(e);return[].concat(v(t),v(n)).join(" ")}),[j]),O=(0,o.useMemo)((function(){var e=function(e){var t,n,r;return" .".concat(e.name," {\n      ").concat(null!==(t=e.style)&&void 0!==t&&t.link?"\n          // Стиль подчеркивания\n          ".concat((0,f.aR)((0,p.z)(e.style.link)),"\n          ").concat((0,f.aR)({color:e.style.link.textColor}),"\n          & * {\n            ").concat((0,f.aR)({color:e.style.link.textColor}),"\n          }"):"","\n\n      ").concat(null!==(n=e.style)&&void 0!==n&&n.hover?"\n          // Стиль подчеркивания при наведении\n          &.hover, &:hover {\n            ".concat((0,f.aR)((0,p.z)(e.style.hover)),"\n            ").concat((0,f.aR)({color:e.style.hover.textColor},!0),"\n            & * {\n              ").concat((0,f.aR)({color:e.style.hover.textColor},!0),"\n            }\n          }"):"","\n\n      ").concat(null!==(r=e.style)&&void 0!==r&&r.current?"\n          // Стиль подчеркивания для Current ссылки\n          &.current {\n            ".concat((0,f.aR)((0,p.z)(e.style.current)),"\n            ").concat((0,f.aR)({color:e.style.current.textColor}),"\n            & * {\n              ").concat((0,f.aR)({color:e.style.current.textColor}),"\n            }\n          }"):"","\n     } ")},t=g.global.map(e),n=g.project.map(e);return[].concat(v(t),v(n)).join(" ")}),[g]);return i().createElement(E,{blockStyles:x,textStyleSheet:R,linkStyleSheet:O,listStyleSheet:D})},D=function(e){var t="text-global-styles",n=document.querySelector("#".concat(t));n||((n=document.createElement("div")).id=t,document.body.appendChild(n)),s().render(i().createElement(R,{mode:e}),n)}},971:function(e,t,n){"use strict";n.r(t),n.d(t,{TextConstructorFrameContext:function(){return B},frameOverflowSize:function(){return H}});var r=n(646),o=n(352),i=n.n(o),a=n(323),s=n(802),c=n(660),l=n(445),u=n(972),d=n(351),g=n(666),m=n(641),h=n(621),f=n(970),p=n(659),v=n(670),y=n(964),w=n(341),b=n(645),S=n(639),M=n(623),j=n(620),P=n(694),x=n(821),E=n(698),R=n(973),D=n(696);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){return function(e){if(Array.isArray(e))return Z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var B=i().createContext({}),U=function(e){var t,n=e.readOnly,r=(0,o.useContext)(c.BackboneContext),y=r.model,w=r.modelSet,P=r.modelSave,E=(0,o.useContext)(p.x).model,R=E.useTextWidgetStore,D=E.isEditMode,O=E.workspace,I=E.selected,Z=E.isJustCreated,B=E.disableSelectionHighlight,U=C(R({partial:!1}),2),F=U[0],A=U[1],z=(0,o.useContext)(f.j).isPaddingsEnabled,W=(0,s.Z)(P,400).callback,N=(0,s.Z)((function(e){if(D&&e.getLastChangeType()){var t=d.Z.exportTextContent(e.getCurrentContent()),n=Object.keys(t),r=a.pick.apply(void 0,[y].concat(_(n))),o=(0,a.isEqual)(t,r);w(t),o||W()}}),20).callback;(0,o.useEffect)((function(){D&&Z&&setTimeout((function(){var e;null===(e=L.current)||void 0===e||e.focusEditor()}),0)}),[]),(0,o.useEffect)((function(){N(F)}),[F]);var H=(0,o.useMemo)((function(){return F.getSelection().getHasFocus()}),[F]),V=(0,o.useMemo)((function(){return D}),[D,H]),L=(0,o.useRef)(null),q=(0,x.useResizeEffect)(L).height;(0,o.useEffect)((function(){q>0&&q!==y.h&&D&&(!(y.columns&&y.columns.count>1)&&y.autosize&&(w({h:q}),W()))}),[q,y.autosize,y.columns]),(0,o.useEffect)((function(){Modernizr.firefox||D||F.getSelection().isCollapsed()||A(d.Z.clearSelection(F))}),[D]);var $=C((0,S.Qc)(),2),G=$[0],X=$[1];return(0,o.useEffect)((function(){var e=d.Z.getCurrentInlineStyles(F,M.f.FontFamily)[0]||j.BX.fontFamily,t=d.Z.getCurrentInlineStyles(F,M.f.FontWeight)[0]||j.BX.fontWeight,n=d.Z.getCurrentInlineStyles(F,M.f.FontStyle)[0]||j.BX.fontStyle;if(e&&t&&n){var r=(0,S.qi)({fontFamily:e,fontWeight:t,fontStyle:n});G[r]||d.Z.getFontFeatures({fontFamily:e,fontWeight:t,fontStyle:n}).then((function(e){if(e){var t=e.features,n=e.variations,o=e.characters;X(T(T({},G),{},k({},r,{features:t,variations:n,characters:o})))}}))}}),[F]),i().createElement(u.Z,{ref:L,isEditMode:D,bgColor:y.bgColor,selectionColor:y.selectionColor,textDirection:y.textDirection||g.m5.LTR,autosize:y.autosize,columns:y.columns,verticalAlign:y.verticalAlign,useBaseline:null===(t=y.flags)||void 0===t?void 0:t.baseline,shouldShowSelectionBorder:V,editorState:F,disableSelectionHighlight:B,blockStyleFn:function(e){var t=e.getType();return[t,(0,m.x6)({block:e}),(0,h.Wg)({block:e}),(0,b.nq)(t)?(0,b.XZ)({block:e}):void 0].filter((function(e){return e})).join(" ")},onChange:function(e){var t=e.getSelection(),n=e;n=d.Z.preserveBlockInlineStyles(n,F),n=(n=d.Z.forceSelection(n,d.Z.reverseSelection(t))).getSelection().isCollapsed()?n:d.Z.forceSelection(n,d.Z.fixSelection(n)),Modernizr.safari&&!t.isCollapsed()&&(n=l.EditorState.acceptSelection(n,n.getSelection())),A(n)},readOnly:!D||!I||n||z,keyBindingFn:v.ul,handleKeyCommand:function(e){var t=(0,v.Bg)({action:e,editorState:F,workspace:O});if(t){var n=t.editorState,r=t.status;return A(n),r}return"not-handled"}})},F=(0,r.default)(E.Box).withConfig({displayName:"TextConstructor___StyledBox",componentId:"lrt0oy-0"})(["user-select:none;"]),A=(0,r.default)(E.Box).withConfig({displayName:"TextConstructor___StyledBox2",componentId:"lrt0oy-1"})(["user-select:none;"]),z=(0,r.default)(E.Box).withConfig({displayName:"TextConstructor___StyledBox3",componentId:"lrt0oy-2"})(["user-select:none;"]),W=(0,r.default)(E.Box).withConfig({displayName:"TextConstructor___StyledBox4",componentId:"lrt0oy-3"})(["user-select:none;"]),N=function(e){var t=e.size,n=e.height,r=e.width,o=e.onClick;return i().createElement(i().Fragment,null,i().createElement(F,{position:"absolute",top:0,left:0,width:r+2*t,height:t,onClick:o}),i().createElement(A,{position:"absolute",bottom:0,left:0,width:r+2*t,height:t,onClick:o}),i().createElement(z,{position:"absolute",top:0,left:0,width:t,height:n+2*t,onClick:o}),i().createElement(W,{position:"absolute",top:0,right:0,width:t,height:n+2*t,onClick:o}))},H=500,V=(0,r.default)(E.Box).withConfig({displayName:"TextConstructor___StyledBox5",componentId:"lrt0oy-4"})(["width:calc(var(--workspace-inverse-zoom) * 100%);height:calc(var(--workspace-inverse-zoom) * 100%);zoom:var(--workspace-inverse-zoom);transform:scale(var(--workspace-zoom));transform-origin:left top;"]),L=(0,r.default)(E.Box).withConfig({displayName:"TextConstructor___StyledBox6",componentId:"lrt0oy-5"})(["pointer-events:none;user-select:none;"]);t.default=function(){var e=(0,o.useContext)(p.x).model,t=e.useTextWidgetStore,n=e.fontStyles,r=e.isResizing,a=e.leaveEditMode,s=e.isEditMode,l=e.canControlsBeClosed,u=e.onIframeLoaded,d=C(t({partial:!1}),1)[0],g=(0,o.useContext)(c.BackboneContext).model,m=g.w,h=g.h,v=C((0,o.useState)(!1),2),b=v[0],S=v[1];(0,o.useEffect)((function(){(b||r)&&w.default.getFocusBack()}),[b,r]);var M=(0,o.useRef)(null),j={position:"absolute",top:-1*H,left:-1*H,width:"calc(100% + ".concat(2*H,"px)"),height:"calc(100% + ".concat(2*H,"px)")},x=C((0,o.useState)(!1),2),E=x[0],O=x[1],k=C((0,o.useState)(!1),2),_=k[0],I=k[1];return(0,o.useEffect)((function(){s&&!E&&O(!0)}),[s]),i().createElement(B.Provider,{value:{ref:M}},i().createElement(f.j.Provider,{value:{isPaddingsEnabled:b,setIsPaddingsEnabled:S}},i().createElement(V,{height:"100%",width:"100%",position:"relative"},E&&i().createElement(R.ZP,{ref:M,style:T({display:s?void 0:"none",pointerEvents:!s||b||r?"none":void 0,userSelect:"none"},j),head:i().createElement(i().Fragment,null,i().createElement("style",null,"\n                      body {\n                        margin: 0;\n                        height: 100vh;\n                        width: 100vw;\n                        overflow: hidden;\n                        box-sizing: border-box;\n                        padding: ".concat(H,"px ").concat(H-D.E,"px;\n                      }\n\n                      ol, ul {\n                        padding: 0;\n                        margin: 0;\n                      }\n                  ")),n.map((function(e,t){return"style"===e.tag?i().createElement("style",{key:t},"".concat(e.style)):"link"===e.tag?i().createElement("link",{key:t,rel:"stylesheet",type:e.type,href:e.href}):void 0}))),contentDidMount:function(){u(),I(!0)}},i().createElement(y.$Y,{mode:"constructor"}),s&&i().createElement(N,{size:H,height:h,width:m,onClick:function(){l()&&a()}}),i().createElement(U,null)),s&&_?null:i().createElement(L,{height:"100%",width:"100%",position:"absolute",top:0,left:0},i().createElement(P.Z,{editorState:d,isConstructorPreview:!0})))))}},730:function(e,t,n){"use strict";var r;n.d(t,{j:function(){return r}}),function(e){e.UpgradeAccountToUse="upgradeAccountToUse",e.EcommHasInvalidAddToCartWidget="ecommHasInvalidAddToCartWidget",e.WorkspaceAnimationTriggerRemoved="workspaceAnimationTriggerRemoved",e.WorkspaceAnimationTriggerUnlinked="workspaceAnimationTriggerUnlinked",e.BottomBlocksToMove="bottomBlocksToMove",e.EduTipUseViewportsIcon="eduTipUseViewportsIcon",e.EduTipOnDeleteMobileWidget="eduTipOnDeleteMobileWidget",e.EduTipUseBundleDragTriangle="eduTipUseBundleDragTriangle",e.EduTipUseShortcutToChangeSizes="eduTipUseShortcutToChangeSizes",e.EduTipUseShortcutToMoveText="eduTipUseShortcutToMoveText",e.EduTipUseShortcutToCopyAnimation="eduTipUseShortcutToCopyAnimation",e.EduTipUseShortcutToEnableGuides="eduTipUseShortcutToEnableGuides",e.EduTipUseShortcutToEnableSizes="eduTipUseShortcutToEnableSizes",e.EduTipUseFix="eduTipUseFix",e.EduTipUseAbovePages="eduTipUseAbovePages",e.EduTipUseStylesForText="eduTipUseStylesForText",e.EduTipUseShortcutForGroup="eduTipUseShortcutForGroup",e.EduTipSetNamesForWidgets="eduTipSetNamesForWidgets",e.EduTipUseResrtorePanel="eduTipUseResrtorePanel",e.TextWidgetPasteWithoutFormatting="textWidgetPasteWithoutFormatting"}(r||(r={}))},1049:function(e,t,n){"use strict";n.r(t);var r=n(313),o=n(337),i=n.n(o),a=n(322),s=n(854),c=n(1050),l=n(341),u=n(308),d=n(964),g=n(351),m=n(636),h=n(324),f=n(1055),p=n(999);function v(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){v(i,r,o,a,s,"next",e)}function s(e){v(i,r,o,a,s,"throw",e)}a(void 0)}))}}var w,b,S,M,j,P=i().Router.extend({routes:{":user/:mag/num/:pageNum/":"startByPageNum",":user(/)(:mag)(/)(*pageUri)(/)":"start"},mags:{},initialize:function(){var e=this;if(window.RM.timing[u.qK.DomLoaded]=window.performance.timing.domLoading,window.RM.timing[u.qK.ScriptsLoaded]=window.performance.timing.domContentLoadedEventEnd,window.RM.timing[u.qK.RouterInit]=Date.now(),RM.common.isDomainViewer&&(RM.common.customDomainProfile?this.route(":mag(/)(*pageUri)(/)","start"):this.route("(*pageUri)(/)","start")),RM.common.isDownloadedSource&&(this.route("(*pageUri)(/)","start"),/msie [6-9]/i.test(navigator.userAgent)&&(location.href="sorry.html")),(0,r.Z)("html").toggleClass("viewer-embed-mode",!!RM.common.embedMode),a.Z.bindAll(this),this.environment=u.ZP.environment.viewer,this.started=!1,!RM.common.isDownloadedSource&&window.RM.data.usersLoader.me&&(this.me=window.RM.data.usersLoader.me),this.$mags_container=(0,r.Z)("#mags"),this.magsData=window.ServerData&&window.ServerData.mags,p.Z.init(window.ServerData&&window.ServerData.userPermissions),this.internalHistory=[],this.magsData){if(this.cachedMag=a.Z.clone(this.magsData.mag),!this.cachedMag||!this.cachedMag.user||!this.cachedMag.user._id)return;RM.common.isDownloadedSource||(this.cachedMag.user.isMe=this.me&&this.me.get("_id")==this.cachedMag.user._id),RM.common.isDomainViewer&&(this.magUri=this.cachedMag.uri,this.userUri=this.cachedMag.user&&this.cachedMag.user.uri)}RM.screenshot||n.e(19).then(n.bind(n,712)).then((function(t){var r,o,i=t.default;RM.analytics=RM.analytics||new i({router:e}),e.analytics=RM.analytics,e.analytics.setCustomDimensions({magId:e.mag&&e.mag.model&&e.mag.model.get("num_id")||e.mag&&e.mag.num_id,magCreatorId:e.mag&&e.mag.model&&e.mag.model.user.get("_id")||e.mag&&e.mag.user._id,pageType:"viewer",userId:e.me&&e.me.get("_id")}),RM.common.isDomainViewer||l.default.processCustomTrackingEventCookies();var a=u.ZP.stripe_live,s=!0===(null===(r=window.RM)||void 0===r||null===(o=r.common)||void 0===o?void 0:o.isDomainViewer);a&&!s&&n.e(50).then(n.bind(n,1129)).then((function(e){(0,e.getWebVitals)()}))})),this.isPreview||Modernizr.sessionstorage&&window.sessionStorage.removeItem("constructorViewport")},startByPageNum:function(e,t,n){this.start(e,t,null,n)},getPageUrlFromCodeExportLink:function(e){var t;if(!e)return e;if(null!==(t=window.RM.config)&&void 0!==t&&t.root){var n=window.RM.config.root;return"/"===n[0]&&(n=n.substr(1)),e.replace(n,"")}return e},start:function(e,t,o,s){var l=this;if(RM.common.isDomainViewer&&(this.magsData.magNotFound||this.magsData.domainNotFound||this.magsData.magNotPublished||this.magsData.subscriptionExpired))n.e(48).then(n.bind(n,1048)).then((function(e){new(0,e.default)({type:"domain-error",$container:(0,r.Z)("#service-pages"),templateData:{state:l.magsData}}).render()}));else if(isNaN(parseInt(s))&&(s=void 0),Modernizr.msie||Modernizr.msie11)n.e(17).then(n.bind(n,710)).then((function(e){new(0,e.default)({$parent:(0,r.Z)("body > .popups"),router:l,opts:{type:"type-browsers-viewer"}}).render()}));else{if(!s)if(RM.common.isDomainViewer&&!RM.common.customDomainProfile)parseInt(e,10)!=e&&e&&/^p\d+\/?$/i.test(e)?(o=null,t=e,e=null):(o=e,e=this.userUri,t=this.magUri),RM.common.isDownloadedSource&&(o=this.getPageUrlFromCodeExportLink(o));else if(RM.common.isDownloadedSource)o=this.getPageUrlFromCodeExportLink(e),e=null,t=null;else if(parseInt(e,10)==e||/^p\d+\/?$/i.test(e)){var u=t;t=e,o=u,e=null}else if(RM.common.customDomainProfile){u=t;t=e,o=u,e=this.userUri}else if(!t)return this.notFound();this.latestFragment=i().history.getFragment(),o=o||1,s&&(o=s);var d=e+"_"+t;if(this.username=e,this.started!=d||this.loaded==d)if(this.started=d,this.loaded!=this.started){if(this.cachedMag&&!a.Z.isEmpty(this.cachedMag))return this.cachedMag instanceof c.default||this.cachedMag.forbidden||this.cachedMag.is_suspended||(this.cachedMag=new c.default(this.cachedMag,this)),this.mag=this.cachedMag,void this.onPreloadMag(o,!!s);this._loadingMagDataXHR&&this._loadingMagDataXHR.abort(),this._loadingMagDataXHR=this.fetchData(this.username,t,{success:a.Z.bind((function(e){this.mag&&this.mag.num_id&&e&&e.num_id!=this.mag.num_id&&window.location.reload(),this.mag=new c.default(e,this),this.cachedMag=this.mag,this.onPreloadMag(o,!!s)}),this),error:this.notFound})}else this.go(o,{animation:!1,isPageNum:!!s})}},restartMag:(j=y(regeneratorRuntime.mark((function e(t){var n,r,o,i,s,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.currentPage,r=t.refetchOnlyPrivate,i=(o=void 0!==r&&r)?this.mag.pages.filter((function(e){return e.isPasswordProtected()})).map((function(e){return e.num_id})):void 0,e.next=4,this.fetchMagPages(i);case 4:(s=e.sent)&&(l=a.Z.clone(this.mag.aboveGlobalWidgetsData),this.mag.destroy(),this.mag=a.Z.clone(this.magsData.mag),this.mag.pages=o?this.mag.pages.map((function(e){var t=s.findIndex((function(t){return e._id===t._id}));return t<0?e:s[t]})):s,this.mag=new c.default(this.mag,this),this.mag.aboveGlobalWidgetsData=(l||[]).concat(this.mag.aboveGlobalWidgetsData),this.cachedMag=this.mag),this.onPreloadMag(n,!0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)}),fetchMagPages:(M=y(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Array.isArray(t)&&t.length?t.join(","):void 0,this._loadingPagesDataXHR&&this._loadingPagesDataXHR.abort(),this._loadingPagesDataXHR=r.Z.ajax({url:"/api/magpages/".concat(this.mag.num_id),method:"GET",data:n?{pages:n}:void 0,success:function(e){return e},error:function(e){return null},context:this}),e.abrupt("return",this._loadingPagesDataXHR);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)}),onPreloadMag:function(e,t){var n=this;(0,f.preloadWidgets)(l.default.usedWidgets(this.mag.pages||[],this.mag.aboveGlobalWidgetsData)).finally((function(){n.onLoadMag(e,t)}))},onLoadMag:function(e,t){var n,o=this;if(window.RM.timing[u.qK.MagLoaded]=Date.now(),this.loaded=this.started||!0,this.mag.forbidden)return this.requestMagPassword(this.latestFragment,a.Z.clone(this.mag)),delete this.cachedMag,delete this.loaded,void delete this.started;if(this.mag.is_suspended)this.showSuspended();else{var i=new Event(u.q7.ProjectInitialized,{bubbles:!0});document.dispatchEvent(i),!this.isPreview&&(g.Z.hasNewTextWidgets(window.ServerData&&window.ServerData.mags&&window.ServerData.mags.mag)||g.Z.hasNewTextWidgets(this.mag&&this.mag.model&&this.mag.model.attributes)||g.Z.someTextWidgets(this.mag.aboveGlobalWidgetsData))&&(0,d.IB)("viewer"),RM.common.isDownloadedSource||(r.Z.post("/api/countview/"+this.mag.num_id),RM.analytics&&(RM.analytics._triggerProjectView=!0)),this.mag._requested_page&&!t?(n=this.mag._requested_page,delete this.mag._requested_page):n=e,Modernizr.addTest("screenshot-mode",(function(){return RM.screenshot})),this.mag.render(),this.go(n,{animation:!1,isPageNum:t});var s=new Event(u.q7.ProjectRendered,{bubbles:!0});if(document.dispatchEvent(s),RM.common.mode="mag",this.analytics&&this.analytics.setCustomDimensions({magId:this.mag&&this.mag.model&&this.mag.model.get("num_id")||this.mag&&this.mag.num_id,magCreatorId:this.mag&&this.mag.model&&this.mag.model.user.get("_id")||this.mag&&this.mag.user._id,pageType:"viewer",userId:this.me&&this.me.get("_id")}),!this.isPreview){window.RM.timing[u.qK.MagRendered]=Date.now();var c=RM.viewerRouter.mag.currentPage.num;setTimeout((function(){window.RM.timing[u.qK.DomComplete]=window.performance.timing.domComplete;var e={};Object.keys(window.RM.timing).forEach((function(t){e[t]=RM.timing[t]-window.performance.timing.navigationStart}));var t=window.innerWidth,n=!h.Z.isDesktop||Modernizr.ismobile?Modernizr.isipad||t>=600?"tablet":"phone":"desktop";(0,m.bF)("frontend-rendering",{"project.numId":o.mag.num_id,"user.numId":o.mag.user.num_id,"project.viewport":o.mag.viewport,"project.startPage":c,"project.widgetsCount":a.Z.reduce(RM.viewerRouter.mag.pages,(function(e,t){return e+(t.widgets?t.widgets.length:0)}),0)+o.mag.aboveGlobalWidgets.length,device:n,timing:e})}),1e4)}}},getAnalyticsDimensions:function(){return{magId:this.mag&&this.mag.model&&this.mag.model.get("num_id")||this.mag&&this.mag.num_id,magCreatorId:this.mag&&this.mag.model&&this.mag.model.user.get("_id")||this.mag&&this.mag.user._id,pageType:"viewer",userId:this.me&&this.me.get("_id")}},fetchData:function(e,t,n){return(n=n||{}).url=e?"/api/readymag/"+e+"/"+t:"/api/readymag/"+t,r.Z.ajax(n)},sendReadyEvent:function(e){e=e||{},e=a.Z.defaults(e,{page:{}});var t=document.createElement("MyExtensionDataElement");t.setAttribute("width",e.page.width),t.setAttribute("height",e.page.height),t.setAttribute("_id",e.page._id),document.documentElement.appendChild(t);var n=document.createEvent("Events");if(e&&e.error?n.initEvent("MyErrorEvent",!0,!1):n.initEvent("MyExtensionEvent",!0,!1),t.dispatchEvent(n),window.loadNotifier){if(e.error)return window.loadNotifier({error:e.error});window.loadNotifier({width:e.page.width,height:e.page.height})}},setTitle:function(){if(this.mag&&this.mag.currentPage){var e=a.Z.extend({},this.mag.model.toJSON());e.user=this.mag.user,document.title=s.getFinalSEO(this.mag.currentPage,e,{customDomain:!!RM.common.isDomainViewer}).title}},trackPage:function(){RM.screenshot||a.Z.defer(a.Z.bind((function(){this.analytics&&this.analytics.trackPage()}),this))},go:function(e,t){if(e=e||1,t.isPageNum)return this.mag.showPage(e,t);var n=this.mag.getPageByPath(e)||{};this.mag.showPage(n.num||e,t)},goBack:function(){var e=this.internalHistory[this.internalHistory.length-2];e&&(e&&this.go(e,{skipInternalHistory:!0}),this.internalHistory.pop())},setUrlString:function(e){if(!this.noUrlRewrite&&(e=e||{},!RM.screenshot)){var t,n=this.mag.currentPage;if(t=RM.common.isDomainViewer&&!RM.common.customDomainProfile||RM.common.isDownloadedSource?"":RM.common.customDomainProfile?this.getMagUri(this.mag):this.username?this.mag.user.uri+"/"+(this.mag.uri||this.mag.num_id)+"/":this.isPreview?this.mag.num_id+"/":this.getMagUri(this.mag),this.isPreview&&(t+="preview/"),n&&"1"!=n.num&&(t+=(n.pagePath||n.uri||n.num.toString())+"/"),e.skipInternalHistory?RM.analytics&&RM.analytics.sendEvent("Back Link",t):this.internalHistory.push(n.num.toString()),t!==i().history.getFragment()){var r=(parseInt(a.Z.last(i().history.getFragment(),"/"))||1)==n.num||e.replace;RM.common.isDownloadedSource&&"/"!==a.Z.last(t)&&(t+="/"),RM.common.homepageRewrite||this.navigate(t,{replace:r})}}},getPreviousFragment:function(){return this.internalHistory[this.internalHistory.length-2]},getMagUri:function(e){return RM.common.customDomainProfile?(e.uri||e.num_id)+"/":RM.common.isDomainViewer?"":a.Z.isEmpty(e.user)?e.num_id+"/":e.user.uri+"/"+(e.uri||e.num_id)+"/"},getUserPermissions:function(){return this.userPermissions||[]},onError:function(){this.mag&&this.go(1,{animation:!1})},createLoginViewForIframe:function(e,t,o){var i=this;n.e(18).then(n.bind(n,1092)).then((function(n){new(0,n.default)({useNavigate:!1,$node:(0,r.Z)(e),router:i,joinCallback:t,errorMessages:o}).render()}))},createMagFromTemplate:(S=y(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(18).then(n.bind(n,1094));case 2:new(0,e.sent.default)({router:this,me:this.me,tp:t,templateID:r});case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)}),destroy:function(){this.cachedMag&&this.cachedMag.destroy(),this.magPasswordView&&this.magPasswordView.remove(),this.magSuspendedView&&this.magSuspendedView.remove()},requestMagPassword:(b=y(regeneratorRuntime.mark((function e(t,o){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.magPasswordView){e.next=6;break}return e.next=3,n.e(51).then(n.bind(n,1130));case 3:i=e.sent,a=i.default,this.magPasswordView=new a({router:this,$parent:(0,r.Z)("#mags")});case 6:this.magPasswordView.render({mag:o,mag_url:t});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)}),showSuspended:(w=y(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(48).then(n.bind(n,1048));case 2:t=e.sent,new(0,t.default)({type:"mag-suspended",$container:(0,r.Z)("#service-pages")}).render();case 6:case"end":return e.stop()}}),e)}))),function(){return w.apply(this,arguments)}),notFound:function(){a.Z.defer(y(regeneratorRuntime.mark((function e(){var t,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(48).then(n.bind(n,1048));case 2:t=e.sent,o=t.default,new o({type:"404",$container:(0,r.Z)("#service-pages")}).render();case 6:case"end":return e.stop()}}),e)}))))}});t.default=P}}]);
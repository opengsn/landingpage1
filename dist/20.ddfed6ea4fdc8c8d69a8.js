(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[20],{821:function(t,e,n){"use strict";var r=n(662);Object.defineProperty(e,"__esModule",{value:!0}),e.useResizeEffect=void 0;var o=r(n(745)),i=n(352),a=r(n(822)),l=function(t){return t?{width:t.offsetWidth,height:t.offsetHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight}:{width:0,height:0,scrollWidth:0,scrollHeight:0,offsetWidth:0,offsetHeight:0}};e.useResizeEffect=function(t,e){var n=(0,i.useState)(l(t.current)),r=(0,o.default)(n,2),c=r[0],u=r[1],s=(0,i.useCallback)((function(){t.current&&u(l(t.current))}),[t]);return(0,i.useLayoutEffect)((function(){if(t.current){s();var n=new a.default((function(){s()}));return e?n.unobserve(t.current):n.observe(t.current),function(){n.disconnect()}}}),[t,s,e]),c}},974:function(t,e,n){"use strict";n.d(e,{z:function(){return s}});var r=n(352),o=n.n(r),i=n(624),a=n(666);function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t){var e=t||{},n=e.type,r=void 0===n?a.BM.None:n,o=e.color,l=void 0===o?"00000064":o,u=e.size,s=void 0===u?1:u,p=e.padding,d=void 0===p?0:p,f=(0,i.gn)(l),g=f.r,y=f.g,v=f.b,b=f.a,h="rgba(".concat(g,", ").concat(y,", ").concat(v,", ").concat(b,")"),m="repeat-x",w=s+d,S=w>0?"0 100%":"0 ".concat(100+w,"%"),j={textDecoration:"none",paddingBottom:Math.max(0,w)};switch(r){case a.BM.Solid:return c(c({},j),{},{background:"linear-gradient(to right, ".concat(h," 0%, ").concat(h," 100%) ").concat(S,"/1px ").concat(s,"px ").concat(m)});case a.BM.Dotted:return c(c({},j),{},{background:"linear-gradient(to right, ".concat(h," 0%, ").concat(h," 50%, transparent 50%, transparent 100%) ").concat(S,"/").concat(2*s,"px ").concat(s,"px ").concat(m)});case a.BM.Dashed:return c(c({},j),{},{background:"linear-gradient(to right, ".concat(h," 0%, ").concat(h," 66.6666%, transparent 66.6666%, transparent 100%) ").concat(S,"/").concat(3*s,"px ").concat(s,"px ").concat(m)});default:return c(c({},j),{},{background:"none"})}};e.Z=0==n.j?function(t){if(!t)return o().createElement("div",{style:{width:"100%"}});var e=(0,r.useMemo)((function(){return s(t)}),[t.type,t.size,t.color,t.padding]);return o().createElement("div",{style:c(c({},e),{},{width:"100%"})})}:null},966:function(t,e,n){"use strict";n.d(e,{hO:function(){return w},Qu:function(){return S},vY:function(){return j},$w:function(){return O},k9:function(){return x}});var r=n(968),o=n(624),i=n(344),a=n(666),l=n(308),c=n(967),u=n(668),s=n(620),p=n(657);function d(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(t,e){if(!t)return"";var n="number"==typeof e?e:100;return"".concat(t).concat((0,o.vx)(n))},m=function(t,e){return c.Z.prototype.switchTextToViewport(t,e)},w=function(t,e){var n=v({},t),r=n.entityMap;return r&&Object.values(r).forEach((function(t){var n=t;n&&n.type===p.kM&&n.data&&!n.data.pageId&&n.data.type===p.dr.Page&&(n.data.pageId=e.getPageId(n.data.pageUri||n.data.pageNum))})),v(v({},n),{},{flags:v(v({},n.flags||{}),{},{updatedLinks:!0})})},S=function(t){var e=v({},t),n=e.text,r=(0,u.Gi)({str:n}),o=r.blocks,l=r.styles,c=r.entityMap,s=r.blocksMeta,p=o.map((function(t){return t.key})),d=Object.values(c).map((function(t){return t.data.id})),f={blocks:o,styles:l,entityMap:c,blocksMeta:s};if(e.viewport_phone_portrait){var g=m(n,i.sJ.PhonePortrait),y=(0,u.Gi)({str:g,blockKeys:p,entityKeys:d}),b=y.styles,w=y.blocksMeta,S=y.entityMap;f.viewport_phone_portrait={blocksMeta:w,entityMap:S,styles:b,bgColor:h(e.viewport_phone_portrait.bg_color,100*e.viewport_phone_portrait.bg_opacity),columns:{count:e.viewport_phone_portrait.column_count,gap:e.viewport_phone_portrait.column_gap}},e.viewport_phone_portrait=v(v({},e.viewport_phone_portrait),f.viewport_phone_portrait),e.viewport_phone_portrait.hasOwnProperty("hidden")||(e.viewport_phone_portrait.hidden=!1),delete e.viewport_phone_portrait.column_count,delete e.viewport_phone_portrait.column_gap,delete e.viewport_phone_portrait.bg_color,delete e.viewport_phone_portrait.bg_opacity}if(e.viewport_tablet_portrait){var j=m(n,i.sJ.TabletPortrait),_=(0,u.Gi)({str:j,blockKeys:p,entityKeys:d}),O=_.styles,x=_.blocksMeta,k=_.entityMap;f.viewport_tablet_portrait={blocksMeta:x,entityMap:k,styles:O,bgColor:h(e.viewport_tablet_portrait.bg_color,100*e.viewport_tablet_portrait.bg_opacity),columns:{count:e.viewport_tablet_portrait.column_count,gap:e.viewport_tablet_portrait.column_gap}},e.viewport_tablet_portrait=v(v({},e.viewport_tablet_portrait),f.viewport_tablet_portrait),e.viewport_tablet_portrait.hasOwnProperty("hidden")||(e.viewport_tablet_portrait.hidden=!1),delete e.viewport_tablet_portrait.column_count,delete e.viewport_tablet_portrait.column_gap,delete e.viewport_tablet_portrait.bg_color,delete e.viewport_tablet_portrait.bg_opacity}return e=v(v({},e),{},{autosize:e.autosize,verticalAlign:a.Rr.top,blocks:f.blocks,styles:f.styles,entityMap:f.entityMap,blocksMeta:f.blocksMeta,bgColor:h(e.bg_color,100*e.bg_opacity),columns:{count:e.column_count,gap:e.column_gap},version:3,column_count:void 0,column_gap:void 0,bg_color:void 0,bg_opacity:void 0,text:void 0})},j=function(t){var e=["none",0,"baseline"],n=["opacity"];return t.map((function(t){var i=t._name,a=t._caption,c=t.tag,u=(t._sort,g(t,["_name","_caption","tag","_sort"])),p=Object.keys(u).reduce((function(t,i){var a=(0,r.eV)(i),l=u[i];if(n.includes(i)||e.includes(l))return v({},t);if("textAlign"===a&&"start"===l)l="left";else if("color"===a){var c=u.opacity>0?parseFloat((u.opacity/100).toFixed(2)):1,p=(0,o.vK)(l,c);l=(0,o.tZ)(p)}else a.includes("padding")?l=parseInt(l):"fontWeight"===a&&"normal"===l&&(l=s.BX.fontWeight);return v(v({},t),{},b({},a,l))}),{});return p.paddingLeft=p.paddingLeft||0,p.paddingRight=p.paddingRight||0,p.paddingTop=p.paddingTop||0,p.paddingBottom=p.paddingBottom||0,{name:i,label:a,tag:c||l.ZP.AVAILABLE_TEXT_TAGS[0],cssProperties:p}}))},_=function(t,e){var n=function(t){return e?"".concat(e,"-").concat(t):t},r=void 0!==t[n("color")]?t[n("color")]:t.color,o=void 0!==t[n("opacity")]?t[n("opacity")]:t.opacity,i=void 0!==t[n("u-color")]?t[n("u-color")]:t["u-color"],l=void 0!==t[n("u-opacity")]?t[n("u-opacity")]:t["u-opacity"],c=void 0!==t[n("u-size")]?t[n("u-size")]:t["u-size"],u=void 0!==t[n("u-offset")]?t[n("u-offset")]:t["u-offset"],s=void 0!==t[n("u-style")]?t[n("u-style")]:t["u-style"];return{textColor:h(String("inherit"===r?t.color:r),Number("inherit"===o?t.opacity:o)),color:h(String("inherit"===i?t["u-color"]:i),Number("inherit"===l?t["u-opacity"]:l)),size:Number("inherit"===c?t["u-size"]:c),padding:Number("inherit"===u?t["u-offset"]:u),type:function(t){switch(t){case"none":return a.BM.None;case"dotted":return a.BM.Dotted;case"dashed":return a.BM.Dashed;case"solid":return a.BM.Solid}}(s)}},O=function(t){return t.map((function(t){return{name:t._name,label:t._caption,style:{link:_(t),hover:_(t,"hover"),current:_(t,"current")}}}))},x=function(t,e){/px/i.test(String(e["font-size"]))||(e["font-size"]+="px"),/px/i.test(String(e["letter-spacing"]))||(e["letter-spacing"]+="px"),/px/i.test(String(e["line-height"]))||(e["line-height"]+="px"),/#/i.test(String(e.color))||(e.color="#"+e.color),e.opacity=parseInt(String(e.opacity))/100,e.padding="10px 37px 0px";var n=Object.keys(e).reduce((function(t,n){return[].concat(d(t),["".concat(n,": ").concat(e[n])])}),[]).join(";"),r='<p style="'.concat(n,'">').concat(t,"</p>");return(0,u.Gi)({str:r})}},964:function(t,e,n){"use strict";n.d(e,{Sn:function(){return P},$Y:function(){return I},IB:function(){return A},vK:function(){return D}});var r,o=n(352),i=n.n(o),a=n(600),l=n.n(a),c=n(636),u=n(965),s=n(966),p=n(657),d=n(646),f=n(639),g=n(969),y=n(641),v=n(974);function b(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){w(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||j(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e,n,r,o,i,a){try{var l=t[i](a),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,o)}function x(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){O(i,r,o,a,l,"next",t)}function l(t){O(i,r,o,a,l,"throw",t)}a(void 0)}))}}var k,T,E,C,P=0==n.j?(k=x(regeneratorRuntime.mark((function t(){var e,n,r,o,i,a,l,s,d,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.RM.constructorRouter.mag.get("_id"),n=window.RM.constructorRouter.me&&window.RM.constructorRouter.me.get("_id"),e&&n){t.next=4;break}throw new Error("Cannot load text styles");case 4:return t.next=6,Promise.all([(0,c.$A)({projectId:e}),(0,c.mG)({userId:n}),(0,c.x3)({projectId:e}),(0,c.Cj)({userId:n}),(0,c.TM)({projectId:e}),(0,c.a8)({userId:n})]);case 6:return r=t.sent,o=S(r,6),i=o[0].data,a=o[1].data,l=o[2].data,s=o[3].data,d=o[4].data,f=o[5].data,t.abrupt("return",{textStyles:{global:a&&a.length?a:[],project:i&&i.length?i:u.j},linkStyles:{global:s&&s.length?s:[],project:l&&l.length?l:[p.TF]},listStyles:{global:f&&f.length?f:[],project:d&&d.length?d:u.O}});case 15:case"end":return t.stop()}}),t)}))),function(){return k.apply(this,arguments)}):null,M=(0,d.createGlobalStyle)(r||(T=["\n  ","\n  ","\n  ","\n  ","\n"],E||(E=T.slice(0)),r=Object.freeze(Object.defineProperties(T,{raw:{value:Object.freeze(E)}}))),(function(t){return t.blockStyles}),(function(t){return t.textStyleSheet}),(function(t){return t.linkStyleSheet}),(function(t){return t.listStyleSheet})),I=function(t){var e=t.mode,n=S((0,f.sJ)(),2),r=n[0],a=n[1],l=S((0,f.H$)(),2),d=l[0],h=l[1],j=S((0,f.SZ)(),2),_=j[0],O=j[1];(0,o.useEffect)((function(){if("constructor"===e){var t=[];if(!r.global.length&&!r.project.length){var n,o,i=window.ServerData.textStyles,l=u.j;if(!i||!i.project||!i.project.length){var f,g,y=null===(f=window.ServerData)||void 0===f||null===(g=f.editParams)||void 0===g?void 0:g.paragraph_styles;y&&(l=(0,s.vY)(y),t.push((0,c.Wf)({styles:l,projectId:window.ServerData.projectId})))}a({global:null!=i&&null!==(n=i.global)&&void 0!==n&&n.length?i.global:[],project:null!=i&&null!==(o=i.project)&&void 0!==o&&o.length?i.project:l})}if(!d.global.length&&!d.project.length){var v,b,m=window.ServerData.linkStyles,w=[p.TF];if(!m||!m.project||!m.project.length){var S=window.ServerData.editParams&&window.ServerData.editParams.link_styles;S&&(w=(0,s.$w)(S),t.push((0,c.pV)({styles:w,projectId:window.ServerData.projectId})))}h({global:null!=m&&null!==(v=m.global)&&void 0!==v&&v.length?m.global:[],project:null!=m&&null!==(b=m.project)&&void 0!==b&&b.length?m.project:w})}if(!_.global.length&&!_.project.length){var j,x,k=window.ServerData.listStyles;O({global:null!=k&&null!==(j=k.global)&&void 0!==j&&j.length?k.global:[],project:null!=k&&null!==(x=k.project)&&void 0!==x&&x.length?k.project:u.O})}t.length&&Promise.all(t)}if("viewer"===e||"screenshoter"===e){var T,E,C,P,M,I,A,D,B,R,z,U,F,W,Z,N,H,G,L,$,V,K,X,J,q,Y,Q="viewer"===e,tt=Q?(null===(T=window.ServerData)||void 0===T||null===(E=T.mags)||void 0===E||null===(C=E.mag)||void 0===C?void 0:C.textStyles)||(null===(P=window.RM)||void 0===P||null===(M=P.viewerRouter)||void 0===M||null===(I=M.mag)||void 0===I?void 0:I.textStyles):null===(A=window.ServerData)||void 0===A||null===(D=A.mag)||void 0===D?void 0:D.textStyles;if(tt)a({global:null!=tt&&null!==(q=tt.global)&&void 0!==q&&q.length?tt.global:[],project:null!=tt&&null!==(Y=tt.project)&&void 0!==Y&&Y.length?tt.project:u.j});var et,nt,rt=Q?(null===(B=window.ServerData)||void 0===B||null===(R=B.mags)||void 0===R||null===(z=R.mag)||void 0===z?void 0:z.linkStyles)||(null===(U=window.RM)||void 0===U||null===(F=U.viewerRouter)||void 0===F||null===(W=F.mag)||void 0===W?void 0:W.linkStyles):null===(Z=window.ServerData)||void 0===Z||null===(N=Z.mag)||void 0===N?void 0:N.linkStyles;if(rt)h({global:null!=rt&&null!==(et=rt.global)&&void 0!==et&&et.length?rt.global:[],project:null!=rt&&null!==(nt=rt.project)&&void 0!==nt&&nt.length?rt.project:[p.TF]});var ot,it,at=Q?(null===(H=window.ServerData)||void 0===H||null===(G=H.mags)||void 0===G||null===(L=G.mag)||void 0===L?void 0:L.listStyles)||(null===($=window.RM)||void 0===$||null===(V=$.viewerRouter)||void 0===V||null===(K=V.mag)||void 0===K?void 0:K.listStyles):null===(X=window.ServerData)||void 0===X||null===(J=X.mag)||void 0===J?void 0:J.listStyles;if(at)O({global:null!=at&&null!==(ot=at.global)&&void 0!==ot&&ot.length?at.global:[],project:null!=at&&null!==(it=at.project)&&void 0!==it&&it.length?at.project:u.O})}}),[]);var x=(0,o.useMemo)((function(){return Object.keys(g.T).map((function(t){return g.T[t].style})).join(" ")}),[g.T]),k=(0,o.useMemo)((function(){var t=function(t){var e,n=(e=t.cssProperties,Object.keys(e).reduce((function(t,n){var r=e[n];return"string"==typeof r&&r.includes("(")&&!r.includes(")")&&(r="".concat(r,")")),r&&"opacity"===n&&parseInt(String(r))>1&&(r=parseInt(String(r))/100),m(m({},t),{},w({},n,r))}),{}));return"justify"===(n.textAlign&&String(n.textAlign))&&(n.whiteSpace="normal")," .".concat(t.name," { ").concat((0,y.aR)(n)," } ")},e=r.global.map(t),n=r.project.map(t);return[].concat(b(e),b(n)).join(" ")}),[r]),T=(0,o.useMemo)((function(){var t=function(t){var e=m({},t.cssProperties);return e.display="inline-block"," .".concat(t.name," {\n        &-preview {\n          ").concat((0,y.aR)(t.cssProperties),"\n        }\n\n        div[data-offset-key]:before, & > li:before, &:before {\n          ").concat((0,y.aR)(e),"\n        }\n      } ")},e=_.global.map(t),n=_.project.map(t);return[].concat(b(e),b(n)).join(" ")}),[_]),E=(0,o.useMemo)((function(){var t=function(t){var e,n,r;return" .".concat(t.name," {\n      ").concat(null!==(e=t.style)&&void 0!==e&&e.link?"\n          // Стиль подчеркивания\n          ".concat((0,y.aR)((0,v.z)(t.style.link)),"\n          ").concat((0,y.aR)({color:t.style.link.textColor}),"\n          & * {\n            ").concat((0,y.aR)({color:t.style.link.textColor}),"\n          }"):"","\n\n      ").concat(null!==(n=t.style)&&void 0!==n&&n.hover?"\n          // Стиль подчеркивания при наведении\n          &.hover, &:hover {\n            ".concat((0,y.aR)((0,v.z)(t.style.hover)),"\n            ").concat((0,y.aR)({color:t.style.hover.textColor},!0),"\n            & * {\n              ").concat((0,y.aR)({color:t.style.hover.textColor},!0),"\n            }\n          }"):"","\n\n      ").concat(null!==(r=t.style)&&void 0!==r&&r.current?"\n          // Стиль подчеркивания для Current ссылки\n          &.current {\n            ".concat((0,y.aR)((0,v.z)(t.style.current)),"\n            ").concat((0,y.aR)({color:t.style.current.textColor}),"\n            & * {\n              ").concat((0,y.aR)({color:t.style.current.textColor}),"\n            }\n          }"):"","\n     } ")},e=d.global.map(t),n=d.project.map(t);return[].concat(b(e),b(n)).join(" ")}),[d]);return i().createElement(M,{blockStyles:x,textStyleSheet:k,linkStyleSheet:E,listStyleSheet:T})},A=function(t){var e="text-global-styles",n=document.querySelector("#".concat(e));n||((n=document.createElement("div")).id=e,document.body.appendChild(n)),l().render(i().createElement(I,{mode:t}),n)},D=0==n.j?(C=x(regeneratorRuntime.mark((function t(e){var n,r,o,i,a,l,u,s,p,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.newTextStyles,r=e.newLinkStyles,o=e.newListStyles,t.next=3,P();case 3:i=t.sent,n&&n.length&&(a=n.filter((function(t){return!i.textStyles.project.some((function(e){return e.name===t.name}))}))).length&&(l=[].concat(b(i.textStyles.project),b(a)),(0,f.JZ)({global:i.textStyles.global,project:l}),(0,c.Wf)({styles:l,projectId:window.ServerData.projectId})),o&&o.length&&(u=o.filter((function(t){return!i.listStyles.project.some((function(e){return e.name===t.name}))}))).length&&(s=[].concat(b(i.listStyles.project),b(u)),(0,f.CD)({global:i.listStyles.global,project:s}),(0,c.SV)({styles:s,projectId:window.ServerData.projectId})),r&&r.length&&(p=r.filter((function(t){return!i.linkStyles.project.some((function(e){return e.name===t.name}))}))).length&&(d=[].concat(b(i.linkStyles.project),b(p)),(0,f.PM)({global:i.linkStyles.global,project:d}),(0,c.pV)({styles:d,projectId:window.ServerData.projectId}));case 7:case"end":return t.stop()}}),t)}))),function(t){return C.apply(this,arguments)}):null},971:function(t,e,n){"use strict";n.r(e),n.d(e,{TextConstructorFrameContext:function(){return R},frameOverflowSize:function(){return H}});var r=n(646),o=n(352),i=n.n(o),a=n(323),l=n(802),c=n(660),u=n(445),s=n(972),p=n(351),d=n(666),f=n(641),g=n(621),y=n(970),v=n(659),b=n(670),h=n(964),m=n(341),w=n(645),S=n(639),j=n(623),_=n(620),O=n(694),x=n(821),k=n(698),T=n(973),E=n(696);function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){M(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||D(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(t,e)||D(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){if(t){if("string"==typeof t)return B(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var R=i().createContext({}),z=function(t){var e,n=t.readOnly,r=(0,o.useContext)(c.BackboneContext),h=r.model,m=r.modelSet,O=r.modelSave,k=(0,o.useContext)(v.x).model,T=k.useTextWidgetStore,E=k.isEditMode,C=k.workspace,D=k.selected,B=k.isJustCreated,R=k.disableSelectionHighlight,z=A(T({partial:!1}),2),U=z[0],F=z[1],W=(0,o.useContext)(y.j).isPaddingsEnabled,Z=(0,l.Z)(O,400).callback,N=(0,l.Z)((function(t){if(E&&t.getLastChangeType()){var e=p.Z.exportTextContent(t.getCurrentContent()),n=Object.keys(e),r=a.pick.apply(void 0,[h].concat(I(n))),o=(0,a.isEqual)(e,r);m(e),o||Z()}}),20).callback;(0,o.useEffect)((function(){E&&B&&setTimeout((function(){var t;null===(t=L.current)||void 0===t||t.focusEditor()}),0)}),[]),(0,o.useEffect)((function(){N(U)}),[U]);var H=(0,o.useMemo)((function(){return U.getSelection().getHasFocus()}),[U]),G=(0,o.useMemo)((function(){return E}),[E,H]),L=(0,o.useRef)(null),$=(0,x.useResizeEffect)(L).height;(0,o.useEffect)((function(){$>0&&$!==h.h&&E&&(!(h.columns&&h.columns.count>1)&&h.autosize&&(m({h:$}),Z()))}),[$,h.autosize,h.columns]),(0,o.useEffect)((function(){Modernizr.firefox||E||U.getSelection().isCollapsed()||F(p.Z.clearSelection(U))}),[E]);var V=A((0,S.Qc)(),2),K=V[0],X=V[1];return(0,o.useEffect)((function(){var t=p.Z.getCurrentInlineStyles(U,j.f.FontFamily)[0]||_.BX.fontFamily,e=p.Z.getCurrentInlineStyles(U,j.f.FontWeight)[0]||_.BX.fontWeight,n=p.Z.getCurrentInlineStyles(U,j.f.FontStyle)[0]||_.BX.fontStyle;if(t&&e&&n){var r=(0,S.qi)({fontFamily:t,fontWeight:e,fontStyle:n});K[r]||p.Z.getFontFeatures({fontFamily:t,fontWeight:e,fontStyle:n}).then((function(t){if(t){var e=t.features,n=t.variations,o=t.characters;X(P(P({},K),{},M({},r,{features:e,variations:n,characters:o})))}}))}}),[U]),i().createElement(s.Z,{ref:L,isEditMode:E,bgColor:h.bgColor,selectionColor:h.selectionColor,textDirection:h.textDirection||d.m5.LTR,autosize:h.autosize,columns:h.columns,verticalAlign:h.verticalAlign,useBaseline:null===(e=h.flags)||void 0===e?void 0:e.baseline,shouldShowSelectionBorder:G,editorState:U,disableSelectionHighlight:R,blockStyleFn:function(t){var e=t.getType();return[e,(0,f.x6)({block:t}),(0,g.Wg)({block:t}),(0,w.nq)(e)?(0,w.XZ)({block:t}):void 0].filter((function(t){return t})).join(" ")},onChange:function(t){var e=t.getSelection(),n=t;n=p.Z.preserveBlockInlineStyles(n,U),n=(n=p.Z.forceSelection(n,p.Z.reverseSelection(e))).getSelection().isCollapsed()?n:p.Z.forceSelection(n,p.Z.fixSelection(n)),Modernizr.safari&&!e.isCollapsed()&&(n=u.EditorState.acceptSelection(n,n.getSelection())),F(n)},readOnly:!E||!D||n||W,keyBindingFn:b.ul,handleKeyCommand:function(t){var e=(0,b.Bg)({action:t,editorState:U,workspace:C});if(e){var n=e.editorState,r=e.status;return F(n),r}return"not-handled"}})},U=(0,r.default)(k.Box).withConfig({displayName:"TextConstructor___StyledBox",componentId:"lrt0oy-0"})(["user-select:none;"]),F=(0,r.default)(k.Box).withConfig({displayName:"TextConstructor___StyledBox2",componentId:"lrt0oy-1"})(["user-select:none;"]),W=(0,r.default)(k.Box).withConfig({displayName:"TextConstructor___StyledBox3",componentId:"lrt0oy-2"})(["user-select:none;"]),Z=(0,r.default)(k.Box).withConfig({displayName:"TextConstructor___StyledBox4",componentId:"lrt0oy-3"})(["user-select:none;"]),N=function(t){var e=t.size,n=t.height,r=t.width,o=t.onClick;return i().createElement(i().Fragment,null,i().createElement(U,{position:"absolute",top:0,left:0,width:r+2*e,height:e,onClick:o}),i().createElement(F,{position:"absolute",bottom:0,left:0,width:r+2*e,height:e,onClick:o}),i().createElement(W,{position:"absolute",top:0,left:0,width:e,height:n+2*e,onClick:o}),i().createElement(Z,{position:"absolute",top:0,right:0,width:e,height:n+2*e,onClick:o}))},H=500,G=(0,r.default)(k.Box).withConfig({displayName:"TextConstructor___StyledBox5",componentId:"lrt0oy-4"})(["width:calc(var(--workspace-inverse-zoom) * 100%);height:calc(var(--workspace-inverse-zoom) * 100%);zoom:var(--workspace-inverse-zoom);transform:scale(var(--workspace-zoom));transform-origin:left top;"]),L=(0,r.default)(k.Box).withConfig({displayName:"TextConstructor___StyledBox6",componentId:"lrt0oy-5"})(["pointer-events:none;user-select:none;"]);e.default=function(){var t=(0,o.useContext)(v.x).model,e=t.useTextWidgetStore,n=t.fontStyles,r=t.isResizing,a=t.leaveEditMode,l=t.isEditMode,u=t.canControlsBeClosed,s=t.onIframeLoaded,p=A(e({partial:!1}),1)[0],d=(0,o.useContext)(c.BackboneContext).model,f=d.w,g=d.h,b=A((0,o.useState)(!1),2),w=b[0],S=b[1];(0,o.useEffect)((function(){(w||r)&&m.default.getFocusBack()}),[w,r]);var j=(0,o.useRef)(null),_={position:"absolute",top:-1*H,left:-1*H,width:"calc(100% + ".concat(2*H,"px)"),height:"calc(100% + ".concat(2*H,"px)")},x=A((0,o.useState)(!1),2),k=x[0],C=x[1],M=A((0,o.useState)(!1),2),I=M[0],D=M[1];return(0,o.useEffect)((function(){l&&!k&&C(!0)}),[l]),i().createElement(R.Provider,{value:{ref:j}},i().createElement(y.j.Provider,{value:{isPaddingsEnabled:w,setIsPaddingsEnabled:S}},i().createElement(G,{height:"100%",width:"100%",position:"relative"},k&&i().createElement(T.ZP,{ref:j,style:P({display:l?void 0:"none",pointerEvents:!l||w||r?"none":void 0,userSelect:"none"},_),head:i().createElement(i().Fragment,null,i().createElement("style",null,"\n                      body {\n                        margin: 0;\n                        height: 100vh;\n                        width: 100vw;\n                        overflow: hidden;\n                        box-sizing: border-box;\n                        padding: ".concat(H,"px ").concat(H-E.E,"px;\n                      }\n\n                      ol, ul {\n                        padding: 0;\n                        margin: 0;\n                      }\n                  ")),n.map((function(t,e){return"style"===t.tag?i().createElement("style",{key:e},"".concat(t.style)):"link"===t.tag?i().createElement("link",{key:e,rel:"stylesheet",type:t.type,href:t.href}):void 0}))),contentDidMount:function(){s(),D(!0)}},i().createElement(h.$Y,{mode:"constructor"}),l&&i().createElement(N,{size:H,height:g,width:f,onClick:function(){u()&&a()}}),i().createElement(z,null)),l&&I?null:i().createElement(L,{height:"100%",width:"100%",position:"absolute",top:0,left:0},i().createElement(O.Z,{editorState:p,isConstructorPreview:!0})))))}},730:function(t,e,n){"use strict";var r;n.d(e,{j:function(){return r}}),function(t){t.UpgradeAccountToUse="upgradeAccountToUse",t.EcommHasInvalidAddToCartWidget="ecommHasInvalidAddToCartWidget",t.WorkspaceAnimationTriggerRemoved="workspaceAnimationTriggerRemoved",t.WorkspaceAnimationTriggerUnlinked="workspaceAnimationTriggerUnlinked",t.BottomBlocksToMove="bottomBlocksToMove",t.EduTipUseViewportsIcon="eduTipUseViewportsIcon",t.EduTipOnDeleteMobileWidget="eduTipOnDeleteMobileWidget",t.EduTipUseBundleDragTriangle="eduTipUseBundleDragTriangle",t.EduTipUseShortcutToChangeSizes="eduTipUseShortcutToChangeSizes",t.EduTipUseShortcutToMoveText="eduTipUseShortcutToMoveText",t.EduTipUseShortcutToCopyAnimation="eduTipUseShortcutToCopyAnimation",t.EduTipUseShortcutToEnableGuides="eduTipUseShortcutToEnableGuides",t.EduTipUseShortcutToEnableSizes="eduTipUseShortcutToEnableSizes",t.EduTipUseFix="eduTipUseFix",t.EduTipUseAbovePages="eduTipUseAbovePages",t.EduTipUseStylesForText="eduTipUseStylesForText",t.EduTipUseShortcutForGroup="eduTipUseShortcutForGroup",t.EduTipSetNamesForWidgets="eduTipSetNamesForWidgets",t.EduTipUseResrtorePanel="eduTipUseResrtorePanel",t.TextWidgetPasteWithoutFormatting="textWidgetPasteWithoutFormatting"}(r||(r={}))}}]);